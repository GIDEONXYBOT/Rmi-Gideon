const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CommentsSection-DtMftqAU.js","./vendor-tm-Q2Jk-.js","./ui-BT4WTmIO.js","./utils-DI9M9ezF.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=Math.pow,o=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,l=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&o(e,n,t[n]);if(r)for(var n of r(t))i.call(t,n)&&o(e,n,t[n]);return e},c=(e,r)=>t(e,n(r)),d=(e,t)=>{var n={};for(var s in e)a.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&r)for(var s of r(e))t.indexOf(s)<0&&i.call(e,s)&&(n[s]=e[s]);return n},u=(e,t,n)=>o(e,"symbol"!=typeof t?t+"":t,n),h=(e,t,n)=>new Promise((r,a)=>{var i=e=>{try{o(n.next(e))}catch(bI){a(bI)}},s=e=>{try{o(n.throw(e))}catch(bI){a(bI)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,s);o((n=n.apply(e,t)).next())});import{a as p,b as m,g,r as f,u as x,c as y,R as v,d as b,e as w,f as N,h as S,H as j,i as _,j as A,N as C}from"./vendor-tm-Q2Jk-.js";import{C as M,a as k,D as E,L as T,M as P,b as D,T as R,c as I,d as O,S as B,e as L,f as F,U,F as z,g as H,h as G,i as V,j as $,k as W,l as Y,m as X,n as K,W as q,A as J,P as Q,o as Z,p as ee,q as te,r as ne,s as re,t as ae,H as ie,B as se,u as oe,v as le,X as ce,w as de,x as ue,y as he,z as pe,E as me,G as ge,I as fe,J as xe,K as ye,N as ve,O as be,Q as we,R as Ne,V as Se,Y as je,Z as _e,_ as Ae,$ as Ce,a0 as Me,a1 as ke,a2 as Ee,a3 as Te,a4 as Pe,a5 as De,a6 as Re,a7 as Ie,a8 as Oe,a9 as Be,aa as Le,ab as Fe,ac as Ue,ad as ze,ae as He,af as Ge,ag as Ve,ah as $e,ai as We,aj as Ye,ak as Xe,al as Ke,am as qe,an as Je,ao as Qe,ap as Ze,aq as et,ar as tt,as as nt,at as rt,au as at,av as it,aw as st,ax as ot,ay as lt,az as ct,aA as dt,aB as ut}from"./utils-DI9M9ezF.js";import{l as ht,a as pt}from"./ui-BT4WTmIO.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var mt,gt,ft={exports:{}},xt={};var yt,vt,bt,wt,Nt=(gt||(gt=1,ft.exports=function(){if(mt)return xt;mt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==n.key&&(a=""+n.key),"key"in n)for(var i in r={},n)"key"!==i&&(r[i]=n[i]);else r=n;return n=r.ref,{$$typeof:e,type:t,key:a,ref:void 0!==n?n:null,props:r}}return xt.Fragment=t,xt.jsx=n,xt.jsxs=n,xt}()),ft.exports),St={exports:{}},jt={},_t={exports:{}},At={};function Ct(){return vt||(vt=1,_t.exports=(yt||(yt=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<i&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],d=1,u=null,h=3,p=!1,m=!1,g=!1,f=!1,x="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var a=n(c);null!==a;){if(null===a.callback)r(c);else{if(!(a.startTime<=e))break;r(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function w(e){if(g=!1,b(e),!m)if(null!==n(l))m=!0,S||(S=!0,N());else{var t=n(c);null!==t&&T(w,t.startTime-e)}}var N,S=!1,j=-1,_=5,A=-1;function C(){return!(!f&&e.unstable_now()-A<_)}function M(){if(f=!1,S){var t=e.unstable_now();A=t;var a=!0;try{e:{m=!1,g&&(g=!1,y(j),j=-1),p=!0;var i=h;try{t:{for(b(t),u=n(l);null!==u&&!(u.expirationTime>t&&C());){var s=u.callback;if("function"==typeof s){u.callback=null,h=u.priorityLevel;var o=s(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof o){u.callback=o,b(t),a=!0;break t}u===n(l)&&r(l),b(t)}else r(l);u=n(l)}if(null!==u)a=!0;else{var d=n(c);null!==d&&T(w,d.startTime-t),a=!1}}break e}finally{u=null,h=i,p=!1}a=void 0}}finally{a?N():S=!1}}}if("function"==typeof v)N=function(){v(M)};else if("undefined"!=typeof MessageChannel){var k=new MessageChannel,E=k.port2;k.port1.onmessage=M,N=function(){E.postMessage(null)}}else N=function(){x(M,0)};function T(t,n){j=x(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_requestPaint=function(){f=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(r,a,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,r){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return r={id:d++,callback:a,priorityLevel:r,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(r.sortIndex=i,t(c,r),null===n(l)&&r===n(c)&&(g?(y(j),j=-1):g=!0,T(w,i-s))):(r.sortIndex=o,t(l,r),m||p||(m=!0,S||(S=!0,N()))),r},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(At)),At)),_t.exports}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Mt(){if(bt)return jt;bt=1;var e=Ct(),t=p(),n=m();function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function i(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function s(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function o(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function l(e){if(i(e)!==e)throw Error(r(188))}function c(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=c(e)))return t;e=e.sibling}return null}var d=Object.assign,u=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),b=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),C=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function k(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=M&&e[M]||e["@@iterator"])?e:null}var E=Symbol.for("react.client.reference");function T(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===E?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case f:return"Fragment";case y:return"Profiler";case x:return"StrictMode";case N:return"Suspense";case S:return"SuspenseList";case A:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case g:return"Portal";case b:return e.displayName||"Context";case v:return(e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:T(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return T(e(t))}catch(H7){}}return null}var P=Array.isArray,D=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},O=[],B=-1;function L(e){return{current:e}}function F(e){0>B||(e.current=O[B],O[B]=null,B--)}function U(e,t){B++,O[B]=e.current,e.current=t}var z,H,G=L(null),V=L(null),$=L(null),W=L(null);function Y(e,t){switch(U($,t),U(V,e),U(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=bu(t=vu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F(G),U(G,e)}function X(){F(G),F(V),F($)}function K(e){null!==e.memoizedState&&U(W,e);var t=G.current,n=bu(t,e.type);t!==n&&(U(V,e),U(G,n))}function q(e){V.current===e&&(F(G),F(V)),W.current===e&&(F(W),hh._currentValue=I)}function J(e){if(void 0===z)try{throw Error()}catch(H7){var t=H7.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||"",H=-1<H7.stack.indexOf("\n    at")?" (<anonymous>)":-1<H7.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+z+e+H}var Q=!1;function Z(e,t){if(!e||Q)return"";Q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(H7){var r=H7}Reflect.construct(e,[],n)}else{try{n.call()}catch(a){r=a}e.call(n.prototype)}}else{try{throw Error()}catch(i){r=i}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"==typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),s=i[0],o=i[1];if(s&&o){var l=s.split("\n"),c=o.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var d="\n"+l[r].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=r&&0<=a);break}}}finally{Q=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?J(n):""}function ee(e,t){switch(e.tag){case 26:case 27:case 5:return J(e.type);case 16:return J("Lazy");case 13:return e.child!==t&&null!==t?J("Suspense Fallback"):J("Suspense");case 19:return J("SuspenseList");case 0:case 15:return Z(e.type,!1);case 11:return Z(e.type.render,!1);case 1:return Z(e.type,!0);case 31:return J("Activity");default:return""}}function te(e){try{var t="",n=null;do{t+=ee(e,n),n=e,e=e.return}while(e);return t}catch(H7){return"\nError generating stack: "+H7.message+"\n"+H7.stack}}var ne=Object.prototype.hasOwnProperty,re=e.unstable_scheduleCallback,ae=e.unstable_cancelCallback,ie=e.unstable_shouldYield,se=e.unstable_requestPaint,oe=e.unstable_now,le=e.unstable_getCurrentPriorityLevel,ce=e.unstable_ImmediatePriority,de=e.unstable_UserBlockingPriority,ue=e.unstable_NormalPriority,he=e.unstable_LowPriority,pe=e.unstable_IdlePriority,me=e.log,ge=e.unstable_setDisableYieldValue,fe=null,xe=null;function ye(e){if("function"==typeof me&&ge(e),xe&&"function"==typeof xe.setStrictMode)try{xe.setStrictMode(fe,e)}catch(t){}}var ve=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(be(e)/we|0)|0},be=Math.log,we=Math.LN2;var Ne=256,Se=262144,je=4194304;function _e(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~i)?a=_e(r):0!==(s&=o)?a=_e(s):n||0!==(n=o&~e)&&(a=_e(n)):0!==(o=r&~i)?a=_e(o):0!==s?a=_e(s):n||0!==(n=r&~e)&&(a=_e(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&4194048&n)?t:a}function Ce(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Me(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ke(){var e=je;return!(62914560&(je<<=1))&&(je=4194304),e}function Ee(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Te(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Pe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-ve(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function De(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ve(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Re(e,t){var n=t&-t;return 0!==((n=42&n?1:Ie(n))&(e.suspendedLanes|t))?0:n}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Oe(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Be(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:Mh(e.type)}function Le(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}var Fe=Math.random().toString(36).slice(2),Ue="__reactFiber$"+Fe,ze="__reactProps$"+Fe,He="__reactContainer$"+Fe,Ge="__reactEvents$"+Fe,Ve="__reactListeners$"+Fe,$e="__reactHandles$"+Fe,We="__reactResources$"+Fe,Ye="__reactMarker$"+Fe;function Xe(e){delete e[Ue],delete e[ze],delete e[Ge],delete e[Ve],delete e[$e]}function Ke(e){var t=e[Ue];if(t)return t;for(var n=e.parentNode;n;){if(t=n[He]||n[Ue]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Lu(e);null!==e;){if(n=e[Ue])return n;e=Lu(e)}return t}n=(e=n).parentNode}return null}function qe(e){if(e=e[Ue]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Je(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(r(33))}function Qe(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ze(e){e[Ye]=!0}var et=new Set,tt={};function nt(e,t){rt(e,t),rt(e+"Capture",t)}function rt(e,t){for(tt[e]=t,e=0;e<t.length;e++)et.add(t[e])}var at=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},st={};function ot(e,t,n){if(a=t,ne.call(st,a)||!ne.call(it,a)&&(at.test(a)?st[a]=!0:(it[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function lt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ct(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){if(!e._valueTracker){var t=ut(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function mt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(bI){return e.body}}var gt=/[\n"\\]/g;function ft(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function xt(e,t,n,r,a,i,s,o){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?vt(e,s,dt(t)):null!=n?vt(e,s,dt(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o?e.name=""+dt(o):e.removeAttribute("name")}function yt(e,t,n,r,a,i,s,o){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=n){if(("submit"===i||"reset"===i)&&null==t)return void ht(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!=typeof(r=null!=r?r:a)&&"symbol"!=typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s),ht(e)}function vt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function wt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Nt(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function St(e,t,n,a){if(null==t){if(null!=a){if(null!=n)throw Error(r(92));if(P(a)){if(1<a.length)throw Error(r(93));a=a[0]}n=a}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(a=e.textContent)===n&&""!==a&&null!==a&&(e.value=a),ht(e)}function _t(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var At=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!=typeof n||0===n||At.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function kt(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(r(62));if(e=e.style,null!=n){for(var a in n)!n.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var i in t)a=t[i],t.hasOwnProperty(i)&&n[i]!==a&&Mt(e,i,a)}else for(var s in t)t.hasOwnProperty(s)&&Mt(e,s,t[s])}function Et(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Dt(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Rt(){}var It=null;function Ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Bt=null,Lt=null;function Ft(e){var t=qe(e);if(t&&(e=t.stateNode)){var n=e[ze]||null;e:switch(e=t.stateNode,t.type){case"input":if(xt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+ft(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var i=a[ze]||null;if(!i)throw Error(r(90));xt(a,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(a=n[t]).form===e.form&&pt(a)}break e;case"textarea":Nt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&wt(e,!!n.multiple,t,!1)}}}var Ut=!1;function zt(e,t,n){if(Ut)return e(t,n);Ut=!0;try{return e(t)}finally{if(Ut=!1,(null!==Bt||null!==Lt)&&(td(),Bt&&(t=Bt,e=Lt,Lt=Bt=null,Ft(t),e)))for(t=0;t<e.length;t++)Ft(e[t])}}function Ht(e,t){var n=e.stateNode;if(null===n)return null;var a=n[ze]||null;if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var Gt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Vt=!1;if(Gt)try{var $t={};Object.defineProperty($t,"passive",{get:function(){Vt=!0}}),window.addEventListener("test",$t,$t),window.removeEventListener("test",$t,$t)}catch(bI){Vt=!1}var Wt=null,Yt=null,Xt=null;function Kt(){if(Xt)return Xt;var e,t,n=Yt,r=n.length,a="value"in Wt?Wt.value:Wt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Xt=a.slice(e,1<t?1-t:void 0)}function qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function Qt(){return!1}function Zt(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Jt:Qt,this.isPropagationStopped=Qt,this}return d(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var en,tn,nn,rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},an=Zt(rn),sn=d({},rn,{view:0,detail:0}),on=Zt(sn),ln=d({},sn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nn&&(nn&&"mousemove"===e.type?(en=e.screenX-nn.screenX,tn=e.screenY-nn.screenY):tn=en=0,nn=e),en)},movementY:function(e){return"movementY"in e?e.movementY:tn}}),cn=Zt(ln),dn=Zt(d({},ln,{dataTransfer:0})),un=Zt(d({},sn,{relatedTarget:0})),hn=Zt(d({},rn,{animationName:0,elapsedTime:0,pseudoElement:0})),pn=Zt(d({},rn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),mn=Zt(d({},rn,{data:0})),gn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function vn(){return yn}var bn=Zt(d({},sn,{key:function(e){if(e.key){var t=gn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),wn=Zt(d({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=Zt(d({},sn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),Sn=Zt(d({},rn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=Zt(d({},ln,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),_n=Zt(d({},rn,{newState:0,oldState:0})),An=[9,13,27,32],Cn=Gt&&"CompositionEvent"in window,Mn=null;Gt&&"documentMode"in document&&(Mn=document.documentMode);var kn=Gt&&"TextEvent"in window&&!Mn,En=Gt&&(!Cn||Mn&&8<Mn&&11>=Mn),Tn=String.fromCharCode(32),Pn=!1;function Dn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var In=!1;var On={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!On[e.type]:"textarea"===t}function Ln(e,t,n,r){Bt?Lt?Lt.push(r):Lt=[r]:Bt=r,0<(t=iu(t,"onChange")).length&&(n=new an("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Fn=null,Un=null;function zn(e){Jd(e,0)}function Hn(e){if(pt(Je(e)))return e}function Gn(e,t){if("change"===e)return t}var Vn=!1;if(Gt){var $n;if(Gt){var Wn="oninput"in document;if(!Wn){var Yn=document.createElement("div");Yn.setAttribute("oninput","return;"),Wn="function"==typeof Yn.oninput}$n=Wn}else $n=!1;Vn=$n&&(!document.documentMode||9<document.documentMode)}function Xn(){Fn&&(Fn.detachEvent("onpropertychange",Kn),Un=Fn=null)}function Kn(e){if("value"===e.propertyName&&Hn(Un)){var t=[];Ln(t,Un,e,Ot(e)),zt(zn,t)}}function qn(e,t,n){"focusin"===e?(Xn(),Un=n,(Fn=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&Xn()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Hn(Un)}function Qn(e,t){if("click"===e)return Hn(t)}function Zn(e,t){if("input"===e||"change"===e)return Hn(t)}var er="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function tr(e,t){if(er(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!ne.call(t,a)||!er(e[a],t[a]))return!1}return!0}function nr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rr(e,t){var n,r=nr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=nr(r)}}function ar(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ar(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ir(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function sr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var or=Gt&&"documentMode"in document&&11>=document.documentMode,lr=null,cr=null,dr=null,ur=!1;function hr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ur||null==lr||lr!==mt(r)||("selectionStart"in(r=lr)&&sr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},dr&&tr(dr,r)||(dr=r,0<(r=iu(cr,"onSelect")).length&&(t=new an("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=lr)))}function pr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mr={animationend:pr("Animation","AnimationEnd"),animationiteration:pr("Animation","AnimationIteration"),animationstart:pr("Animation","AnimationStart"),transitionrun:pr("Transition","TransitionRun"),transitionstart:pr("Transition","TransitionStart"),transitioncancel:pr("Transition","TransitionCancel"),transitionend:pr("Transition","TransitionEnd")},gr={},fr={};function xr(e){if(gr[e])return gr[e];if(!mr[e])return e;var t,n=mr[e];for(t in n)if(n.hasOwnProperty(t)&&t in fr)return gr[e]=n[t];return e}Gt&&(fr=document.createElement("div").style,"AnimationEvent"in window||(delete mr.animationend.animation,delete mr.animationiteration.animation,delete mr.animationstart.animation),"TransitionEvent"in window||delete mr.transitionend.transition);var yr=xr("animationend"),vr=xr("animationiteration"),br=xr("animationstart"),wr=xr("transitionrun"),Nr=xr("transitionstart"),Sr=xr("transitioncancel"),jr=xr("transitionend"),_r=new Map,Ar="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(e,t){_r.set(e,t),nt(t,[e])}Ar.push("scrollEnd");var Mr="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},kr=[],Er=0,Tr=0;function Pr(){for(var e=Er,t=Tr=Er=0;t<e;){var n=kr[t];kr[t++]=null;var r=kr[t];kr[t++]=null;var a=kr[t];kr[t++]=null;var i=kr[t];if(kr[t++]=null,null!==r&&null!==a){var s=r.pending;null===s?a.next=a:(a.next=s.next,s.next=a),r.pending=a}0!==i&&Or(n,a,i)}}function Dr(e,t,n,r){kr[Er++]=e,kr[Er++]=t,kr[Er++]=n,kr[Er++]=r,Tr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Rr(e,t,n,r){return Dr(e,t,n,r),Br(e)}function Ir(e,t){return Dr(e,null,null,t),Br(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-ve(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function Br(e){if(50<Wc)throw Wc=0,Yc=null,Error(r(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Lr={};function Fr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(e,t,n,r){return new Fr(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Hr(e,t){var n=e.alternate;return null===n?((n=Ur(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Gr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vr(e,t,n,a,i,s){var o=0;if(a=e,"function"==typeof e)zr(e)&&(o=1);else if("string"==typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Ur(31,n,t,i)).elementType=A,e.lanes=s,e;case f:return $r(n.children,i,s,t);case x:o=8,i|=24;break;case y:return(e=Ur(12,n,t,2|i)).elementType=y,e.lanes=s,e;case N:return(e=Ur(13,n,t,i)).elementType=N,e.lanes=s,e;case S:return(e=Ur(19,n,t,i)).elementType=S,e.lanes=s,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case b:o=10;break e;case v:o=9;break e;case w:o=11;break e;case j:o=14;break e;case _:o=16,a=null;break e}o=29,n=Error(r(130,null===e?"null":typeof e,"")),a=null}return(t=Ur(o,n,t,i)).elementType=e,t.type=a,t.lanes=s,t}function $r(e,t,n,r){return(e=Ur(7,e,r,t)).lanes=n,e}function Wr(e,t,n){return(e=Ur(6,e,null,t)).lanes=n,e}function Yr(e){var t=Ur(18,null,null,0);return t.stateNode=e,t}function Xr(e,t,n){return(t=Ur(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Kr=new WeakMap;function qr(e,t){if("object"==typeof e&&null!==e){var n=Kr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:te(t)},Kr.set(e,t),t)}return{value:e,source:t,stack:te(t)}}var Jr=[],Qr=0,Zr=null,ea=0,ta=[],na=0,ra=null,aa=1,ia="";function sa(e,t){Jr[Qr++]=ea,Jr[Qr++]=Zr,Zr=e,ea=t}function oa(e,t,n){ta[na++]=aa,ta[na++]=ia,ta[na++]=ra,ra=e;var r=aa;e=ia;var a=32-ve(r)-1;r&=~(1<<a),n+=1;var i=32-ve(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,aa=1<<32-ve(t)+a|n<<a|r,ia=i+e}else aa=1<<i|n<<a|r,ia=e}function la(e){null!==e.return&&(sa(e,1),oa(e,1,0))}function ca(e){for(;e===Zr;)Zr=Jr[--Qr],Jr[Qr]=null,ea=Jr[--Qr],Jr[Qr]=null;for(;e===ra;)ra=ta[--na],ta[na]=null,ia=ta[--na],ta[na]=null,aa=ta[--na],ta[na]=null}function da(e,t){ta[na++]=aa,ta[na++]=ia,ta[na++]=ra,aa=t.id,ia=t.overflow,ra=e}var ua=null,ha=null,pa=!1,ma=null,ga=!1,fa=Error(r(519));function xa(e){throw Sa(qr(Error(r(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),fa}function ya(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ue]=e,t[ze]=r,n){case"dialog":Qd("cancel",t),Qd("close",t);break;case"iframe":case"object":case"embed":Qd("load",t);break;case"video":case"audio":for(n=0;n<Kd.length;n++)Qd(Kd[n],t);break;case"source":Qd("error",t);break;case"img":case"image":case"link":Qd("error",t),Qd("load",t);break;case"details":Qd("toggle",t);break;case"input":Qd("invalid",t),yt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Qd("invalid",t);break;case"textarea":Qd("invalid",t),St(t,r.value,r.defaultValue,r.children)}"string"!=typeof(n=r.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||uu(t.textContent,n)?(null!=r.popover&&(Qd("beforetoggle",t),Qd("toggle",t)),null!=r.onScroll&&Qd("scroll",t),null!=r.onScrollEnd&&Qd("scrollend",t),null!=r.onClick&&(t.onclick=Rt),t=!0):t=!1,t||xa(e,!0)}function va(e){for(ua=e.return;ua;)switch(ua.tag){case 5:case 31:case 13:return void(ga=!1);case 27:case 3:return void(ga=!0);default:ua=ua.return}}function ba(e){if(e!==ua)return!1;if(!pa)return va(e),pa=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||wu(e.type,e.memoizedProps)),t=!t),t&&ha&&xa(e),va(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));ha=Bu(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));ha=Bu(e)}else 27===n?(n=ha,Mu(e.type)?(e=Ou,Ou=null,ha=e):ha=n):ha=ua?Iu(e.stateNode.nextSibling):null;return!0}function wa(){ha=ua=null,pa=!1}function Na(){var e=ma;return null!==e&&(null===Pc?Pc=e:Pc.push.apply(Pc,e),ma=null),e}function Sa(e){null===ma?ma=[e]:ma.push(e)}var ja=L(null),_a=null,Aa=null;function Ca(e,t,n){U(ja,t._currentValue),t._currentValue=n}function Ma(e){e._currentValue=ja.current,F(ja)}function ka(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ea(e,t,n,a){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var o=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ka(s.return,n,e),a||(o=null);break e}s=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(r(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),ka(o,n,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function Ta(e,t,n,a){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(524288&i.flags)s=!0;else if(262144&i.flags)break;if(10===i.tag){var o=i.alternate;if(null===o)throw Error(r(387));if(null!==(o=o.memoizedProps)){var l=i.type;er(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===W.current){if(null===(o=i.alternate))throw Error(r(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(hh):e=[hh])}i=i.return}null!==e&&Ea(t,e,n,a),t.flags|=262144}function Pa(e){for(e=e.firstContext;null!==e;){if(!er(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Da(e){_a=e,Aa=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ra(e){return Oa(_a,e)}function Ia(e,t){return null===_a&&Da(e),Oa(e,t)}function Oa(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Aa){if(null===e)throw Error(r(308));Aa=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Aa=Aa.next=t;return n}var Ba="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},La=e.unstable_scheduleCallback,Fa=e.unstable_NormalPriority,Ua={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function za(){return{controller:new Ba,data:new Map,refCount:0}}function Ha(e){e.refCount--,0===e.refCount&&La(Fa,function(){e.controller.abort()})}var Ga=null,Va=0,$a=0,Wa=null;function Ya(){if(0===--Va&&null!==Ga){null!==Wa&&(Wa.status="fulfilled");var e=Ga;Ga=null,$a=0,Wa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Xa=D.S;D.S=function(e,t){Ic=oe(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Ga){var n=Ga=[];Va=0,$a=Vd(),Wa={status:"pending",value:void 0,then:function(e){n.push(e)}}}Va++,t.then(Ya,Ya)}(0,t),null!==Xa&&Xa(e,t)};var Ka=L(null);function qa(){var e=Ka.current;return null!==e?e:fc.pooledCache}function Ja(e,t){U(Ka,null===t?Ka.current:t.pool)}function Qa(){var e=qa();return null===e?null:{parent:Ua._currentValue,pool:e}}var Za=Error(r(460)),ei=Error(r(474)),ti=Error(r(542)),ni={then:function(){}};function ri(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ai(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Rt,Rt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e;default:if("string"==typeof t.status)t.then(Rt,Rt);else{if(null!==(e=fc)&&100<e.shellSuspendCounter)throw Error(r(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e}throw si=t,Za}}function ii(e){try{return(0,e._init)(e._payload)}catch(H7){if(null!==H7&&"object"==typeof H7&&"function"==typeof H7.then)throw si=H7,Za;throw H7}}var si=null;function oi(){if(null===si)throw Error(r(459));var e=si;return si=null,e}function li(e){if(e===Za||e===ti)throw Error(r(483))}var ci=null,di=0;function ui(e){var t=di;return di+=1,null===ci&&(ci=[]),ai(ci,e,t)}function hi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function pi(e,t){if(t.$$typeof===u)throw Error(r(525));throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function mi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Hr(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Wr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===f?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===_&&ii(a)===t.type)?(hi(t=i(t,n.props),n),t.return=e,t):(hi(t=Vr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Xr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function u(e,t,n,r,a){return null===t||7!==t.tag?((t=$r(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Wr(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case h:return hi(n=Vr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Xr(t,e.mode,n)).return=e,t;case _:return p(e,t=ii(t),n)}if(P(t)||k(t))return(t=$r(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return p(e,ui(t),n);if(t.$$typeof===b)return p(e,Ia(e,t),n);pi(e,t)}return null}function m(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case h:return n.key===a?c(e,t,n,r):null;case g:return n.key===a?d(e,t,n,r):null;case _:return m(e,t,n=ii(n),r)}if(P(n)||k(n))return null!==a?null:u(e,t,n,r,null);if("function"==typeof n.then)return m(e,t,ui(n),r);if(n.$$typeof===b)return m(e,t,Ia(e,n),r);pi(e,n)}return null}function x(e,t,n,r,a){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case h:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case g:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case _:return x(e,t,n,r=ii(r),a)}if(P(r)||k(r))return u(t,e=e.get(n)||null,r,a,null);if("function"==typeof r.then)return x(e,t,n,ui(r),a);if(r.$$typeof===b)return x(e,t,n,Ia(t,r),a);pi(t,r)}return null}function y(l,c,d,u){if("object"==typeof d&&null!==d&&d.type===f&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case h:e:{for(var v=d.key;null!==c;){if(c.key===v){if((v=d.type)===f){if(7===c.tag){n(l,c.sibling),(u=i(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===v||"object"==typeof v&&null!==v&&v.$$typeof===_&&ii(v)===c.type){n(l,c.sibling),hi(u=i(c,d.props),d),u.return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}d.type===f?((u=$r(d.props.children,l.mode,u,d.key)).return=l,l=u):(hi(u=Vr(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return o(l);case g:e:{for(v=d.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(l,c.sibling),(u=i(c,d.children||[])).return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}(u=Xr(d,l.mode,u)).return=l,l=u}return o(l);case _:return y(l,c,d=ii(d),u)}if(P(d))return function(r,i,o,l){for(var c=null,d=null,u=i,h=i=0,g=null;null!==u&&h<o.length;h++){u.index>h?(g=u,u=null):g=u.sibling;var f=m(r,u,o[h],l);if(null===f){null===u&&(u=g);break}e&&u&&null===f.alternate&&t(r,u),i=s(f,i,h),null===d?c=f:d.sibling=f,d=f,u=g}if(h===o.length)return n(r,u),pa&&sa(r,h),c;if(null===u){for(;h<o.length;h++)null!==(u=p(r,o[h],l))&&(i=s(u,i,h),null===d?c=u:d.sibling=u,d=u);return pa&&sa(r,h),c}for(u=a(u);h<o.length;h++)null!==(g=x(u,r,h,o[h],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?h:g.key),i=s(g,i,h),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(r,e)}),pa&&sa(r,h),c}(l,c,d,u);if(k(d)){if("function"!=typeof(v=k(d)))throw Error(r(150));return function(i,o,l,c){if(null==l)throw Error(r(151));for(var d=null,u=null,h=o,g=o=0,f=null,y=l.next();null!==h&&!y.done;g++,y=l.next()){h.index>g?(f=h,h=null):f=h.sibling;var v=m(i,h,y.value,c);if(null===v){null===h&&(h=f);break}e&&h&&null===v.alternate&&t(i,h),o=s(v,o,g),null===u?d=v:u.sibling=v,u=v,h=f}if(y.done)return n(i,h),pa&&sa(i,g),d;if(null===h){for(;!y.done;g++,y=l.next())null!==(y=p(i,y.value,c))&&(o=s(y,o,g),null===u?d=y:u.sibling=y,u=y);return pa&&sa(i,g),d}for(h=a(h);!y.done;g++,y=l.next())null!==(y=x(h,i,g,y.value,c))&&(e&&null!==y.alternate&&h.delete(null===y.key?g:y.key),o=s(y,o,g),null===u?d=y:u.sibling=y,u=y);return e&&h.forEach(function(e){return t(i,e)}),pa&&sa(i,g),d}(l,c,d=v.call(d),u)}if("function"==typeof d.then)return y(l,c,ui(d),u);if(d.$$typeof===b)return y(l,c,Ia(l,d),u);pi(l,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==c&&6===c.tag?(n(l,c.sibling),(u=i(c,d)).return=l,l=u):(n(l,c),(u=Wr(d,l.mode,u)).return=l,l=u),o(l)):n(l,c)}return function(e,t,n,r){try{di=0;var a=y(e,t,n,r);return ci=null,a}catch(H7){if(H7===Za||H7===ti)throw H7;var i=Ur(29,H7,null,e.mode);return i.lanes=r,i.return=e,i}}}var gi=mi(!0),fi=mi(!1),xi=!1;function yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&gc){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Br(e),Or(e,null,n),t}return Dr(e,r,t,n),Br(e)}function Ni(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,De(e,n)}}function Si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ji=!1;function _i(){if(ji){if(null!==Wa)throw Wa}}function Ai(e,t,n,r){ji=!1;var a=e.updateQueue;xi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var h=a.baseState;for(s=0,u=c=l=null,o=i;;){var p=-536870913&o.lane,m=p!==o.lane;if(m?(yc&p)===p:(r&p)===p){0!==p&&p===$a&&(ji=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=e,f=o;p=t;var x=n;switch(f.tag){case 1:if("function"==typeof(g=f.payload)){h=g.call(x,h,p);break e}h=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(p="function"==typeof(g=f.payload)?g.call(x,h,p):g))break e;h=d({},h,p);break e;case 2:xi=!0}}null!==(p=o.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=a.callbacks)?a.callbacks=[p]:m.push(p))}else m={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=m,l=h):u=u.next=m,s|=p;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(m=o).next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===i&&(a.shared.lanes=0),Ac|=s,e.lanes=s,e.memoizedState=h}}function Ci(e,t){if("function"!=typeof e)throw Error(r(191,e));e.call(t)}function Mi(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ci(n[e],t)}var ki=L(null),Ei=L(0);function Ti(e,t){U(Ei,e=jc),U(ki,t),jc=e|t.baseLanes}function Pi(){U(Ei,jc),U(ki,ki.current)}function Di(){jc=Ei.current,F(ki),F(Ei)}var Ri=L(null),Ii=null;function Oi(e){var t=e.alternate;U(zi,1&zi.current),U(Ri,e),null===Ii&&(null===t||null!==ki.current||null!==t.memoizedState)&&(Ii=e)}function Bi(e){U(zi,zi.current),U(Ri,e),null===Ii&&(Ii=e)}function Li(e){22===e.tag?(U(zi,zi.current),U(Ri,e),null===Ii&&(Ii=e)):Fi()}function Fi(){U(zi,zi.current),U(Ri,Ri.current)}function Ui(e){F(Ri),Ii===e&&(Ii=null),F(zi)}var zi=L(0);function Hi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Du(n)||Ru(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gi=0,Vi=null,$i=null,Wi=null,Yi=!1,Xi=!1,Ki=!1,qi=0,Ji=0,Qi=null,Zi=0;function es(){throw Error(r(321))}function ts(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!er(e[n],t[n]))return!1;return!0}function ns(e,t,n,r,a,i){return Gi=i,Vi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?yo:vo,Ki=!1,i=n(r,a),Ki=!1,Xi&&(i=as(t,n,r,a)),rs(e),i}function rs(e){D.H=xo;var t=null!==$i&&null!==$i.next;if(Gi=0,Wi=$i=Vi=null,Yi=!1,Ji=0,Qi=null,t)throw Error(r(300));null===e||Io||null!==(e=e.dependencies)&&Pa(e)&&(Io=!0)}function as(e,t,n,a){Vi=e;var i=0;do{if(Xi&&(Qi=null),Ji=0,Xi=!1,25<=i)throw Error(r(301));if(i+=1,Wi=$i=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}D.H=bo,s=t(n,a)}while(Xi);return s}function is(){var e=D.H,t=e.useState()[0];return t="function"==typeof t.then?us(t):t,e=e.useState()[0],(null!==$i?$i.memoizedState:null)!==e&&(Vi.flags|=1024),t}function ss(){var e=0!==qi;return qi=0,e}function os(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ls(e){if(Yi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Yi=!1}Gi=0,Wi=$i=Vi=null,Xi=!1,Ji=qi=0,Qi=null}function cs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wi?Vi.memoizedState=Wi=e:Wi=Wi.next=e,Wi}function ds(){if(null===$i){var e=Vi.alternate;e=null!==e?e.memoizedState:null}else e=$i.next;var t=null===Wi?Vi.memoizedState:Wi.next;if(null!==t)Wi=t,$i=e;else{if(null===e){if(null===Vi.alternate)throw Error(r(467));throw Error(r(310))}e={memoizedState:($i=e).memoizedState,baseState:$i.baseState,baseQueue:$i.baseQueue,queue:$i.queue,next:null},null===Wi?Vi.memoizedState=Wi=e:Wi=Wi.next=e}return Wi}function us(e){var t=Ji;return Ji+=1,null===Qi&&(Qi=[]),e=ai(Qi,e,t),t=Vi,null===(null===Wi?t.memoizedState:Wi.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?yo:vo),e}function hs(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return us(e);if(e.$$typeof===b)return Ra(e)}throw Error(r(438,String(e)))}function ps(e){var t=null,n=Vi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Vi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=C;return t.index++,n}function ms(e,t){return"function"==typeof t?t(e):t}function gs(e){return fs(ds(),$i,e)}function fs(e,t,n){var a=e.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=n;var i=e.baseQueue,s=a.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}t.baseQueue=i=s,a.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=o=null,c=null,d=t=i.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(yc&h)===h:(Gi&h)===h){var p=d.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===$a&&(u=!0);else{if((Gi&p)===p){d=d.next,p===$a&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,Vi.lanes|=p,Ac|=p}h=d.action,Ki&&n(s,h),s=d.hasEagerState?d.eagerState:n(s,h)}else p={lane:h,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=p,o=s):c=c.next=p,Vi.lanes|=h,Ac|=h;d=d.next}while(null!==d&&d!==t);if(null===c?o=s:c.next=l,!er(s,e.memoizedState)&&(Io=!0,u&&null!==(n=Wa)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,a.lastRenderedState=s}return null===i&&(a.lanes=0),[e.memoizedState,a.dispatch]}function xs(e){var t=ds(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);er(s,t.memoizedState)||(Io=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,a]}function ys(e,t,n){var a=Vi,i=ds(),s=pa;if(s){if(void 0===n)throw Error(r(407));n=n()}else n=t();var o=!er(($i||i).memoizedState,n);if(o&&(i.memoizedState=n,Io=!0),i=i.queue,Gs(ws.bind(null,a,i,e),[e]),i.getSnapshot!==t||o||null!==Wi&&1&Wi.memoizedState.tag){if(a.flags|=2048,Ls(9,{destroy:void 0},bs.bind(null,a,i,n,t),null),null===fc)throw Error(r(349));s||127&Gi||vs(a,t,n)}return n}function vs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Vi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function bs(e,t,n,r){t.value=n,t.getSnapshot=r,Ns(t)&&Ss(e)}function ws(e,t,n){return n(function(){Ns(t)&&Ss(e)})}function Ns(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!er(e,n)}catch(r){return!0}}function Ss(e){var t=Ir(e,2);null!==t&&qc(t,e,2)}function js(e){var t=cs();if("function"==typeof e){var n=e;if(e=n(),Ki){ye(!0);try{n()}finally{ye(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:e},t}function _s(e,t,n,r){return e.baseState=n,fs(e,$i,"function"==typeof r?r:ms)}function As(e,t,n,a,i){if(mo(e))throw Error(r(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==D.T?n(!0):s.isTransition=!1,a(s),null===(n=t.pending)?(s.next=t.pending=s,Cs(t,s)):(s.next=n.next,t.pending=n.next=s)}}function Cs(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=D.T,s={};D.T=s;try{var o=n(a,r),l=D.S;null!==l&&l(s,o),Ms(e,t,o)}catch(c){Es(e,t,c)}finally{null!==i&&null!==s.types&&(i.types=s.types),D.T=i}}else try{Ms(e,t,i=n(a,r))}catch(d){Es(e,t,d)}}function Ms(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){ks(e,t,n)},function(n){return Es(e,t,n)}):ks(e,t,n)}function ks(e,t,n){t.status="fulfilled",t.value=n,Ts(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Cs(e,n)))}function Es(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ts(t),t=t.next}while(t!==r)}e.action=null}function Ts(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ps(e,t){return t}function Ds(e,t){if(pa){var n=fc.formState;if(null!==n){e:{var r=Vi;if(pa){if(ha){t:{for(var a=ha,i=ga;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=Iu(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){ha=Iu(a.nextSibling),r="F!"===a.data;break e}}xa(r)}r=!1}r&&(t=n[0])}}return(n=cs()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:t},n.queue=r,n=uo.bind(null,Vi,r),r.dispatch=n,r=js(!1),i=po.bind(null,Vi,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=cs()).queue=a,n=As.bind(null,Vi,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function Rs(e){return Is(ds(),$i,e)}function Is(e,t,n){if(t=fs(e,t,Ps)[0],e=gs(ms)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var r=us(t)}catch(H7){if(H7===Za)throw ti;throw H7}else r=t;var a=(t=ds()).queue,i=a.dispatch;return n!==t.memoizedState&&(Vi.flags|=2048,Ls(9,{destroy:void 0},Os.bind(null,a,n),null)),[r,i,e]}function Os(e,t){e.action=t}function Bs(e){var t=ds(),n=$i;if(null!==n)return Is(t,n,e);ds(),t=t.memoizedState;var r=(n=ds()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ls(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Vi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fs(){return ds().memoizedState}function Us(e,t,n,r){var a=cs();Vi.flags|=e,a.memoizedState=Ls(1|t,{destroy:void 0},n,void 0===r?null:r)}function zs(e,t,n,r){var a=ds();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==$i&&null!==r&&ts(r,$i.memoizedState.deps)?a.memoizedState=Ls(t,i,n,r):(Vi.flags|=e,a.memoizedState=Ls(1|t,i,n,r))}function Hs(e,t){Us(8390656,8,e,t)}function Gs(e,t){zs(2048,8,e,t)}function Vs(e){var t=ds().memoizedState;return function(e){Vi.flags|=4;var t=Vi.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Vi.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(2&gc)throw Error(r(440));return t.impl.apply(void 0,arguments)}}function $s(e,t){return zs(4,2,e,t)}function Ws(e,t){return zs(4,4,e,t)}function Ys(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Xs(e,t,n){n=null!=n?n.concat([e]):null,zs(4,4,Ys.bind(null,t,e),n)}function Ks(){}function qs(e,t){var n=ds();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&ts(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Js(e,t){var n=ds();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&ts(t,r[1]))return r[0];if(r=e(),Ki){ye(!0);try{e()}finally{ye(!1)}}return n.memoizedState=[r,t],r}function Qs(e,t,n){return void 0===n||1073741824&Gi&&!(261930&yc)?e.memoizedState=t:(e.memoizedState=n,e=Kc(),Vi.lanes|=e,Ac|=e,n)}function Zs(e,t,n,r){return er(n,t)?n:null!==ki.current?(e=Qs(e,n,r),er(e,t)||(Io=!0),e):42&Gi&&(!(1073741824&Gi)||261930&yc)?(e=Kc(),Vi.lanes|=e,Ac|=e,t):(Io=!0,e.memoizedState=n)}function eo(e,t,n,r,a){var i=R.p;R.p=0!==i&&8>i?i:8;var s,o,l,c=D.T,d={};D.T=d,po(e,!1,t,n);try{var u=a(),h=D.S;if(null!==h&&h(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then){var p=(s=r,o=[],l={status:"pending",value:null,reason:null,then:function(e){o.push(e)}},u.then(function(){l.status="fulfilled",l.value=s;for(var e=0;e<o.length;e++)(0,o[e])(s)},function(e){for(l.status="rejected",l.reason=e,e=0;e<o.length;e++)(0,o[e])(void 0)}),l);ho(e,t,p,Xc())}else ho(e,t,r,Xc())}catch(m){ho(e,t,{then:function(){},status:"rejected",reason:m},Xc())}finally{R.p=i,null!==c&&null!==d.types&&(c.types=d.types),D.T=c}}function to(){}function no(e,t,n,a){if(5!==e.tag)throw Error(r(476));var i=ro(e).queue;eo(e,i,t,I,null===n?to:function(){return ao(e),n(a)})}function ro(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:I},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ao(e){var t=ro(e);null===t.next&&(t=e.alternate.memoizedState),ho(e,t.next.queue,{},Xc())}function io(){return Ra(hh)}function so(){return ds().memoizedState}function oo(){return ds().memoizedState}function lo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Xc(),r=wi(t,e=bi(n),n);return null!==r&&(qc(r,t,n),Ni(r,t,n)),t={cache:za()},void(e.payload=t)}t=t.return}}function co(e,t,n){var r=Xc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},mo(e)?go(t,n):null!==(n=Rr(e,t,n,r))&&(qc(n,e,r),fo(n,t,r))}function uo(e,t,n){ho(e,t,n,Xc())}function ho(e,t,n,r){var a={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(mo(e))go(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,er(o,s))return Dr(e,t,a,0),null===fc&&Pr(),!1}catch(l){}if(null!==(n=Rr(e,t,a,r)))return qc(n,e,r),fo(n,t,r),!0}return!1}function po(e,t,n,a){if(a={lane:2,revertLane:Vd(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},mo(e)){if(t)throw Error(r(479))}else null!==(t=Rr(e,n,a,2))&&qc(t,e,2)}function mo(e){var t=e.alternate;return e===Vi||null!==t&&t===Vi}function go(e,t){Xi=Yi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fo(e,t,n){if(4194048&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,De(e,n)}}var xo={readContext:Ra,use:hs,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useLayoutEffect:es,useInsertionEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useSyncExternalStore:es,useId:es,useHostTransitionStatus:es,useFormState:es,useActionState:es,useOptimistic:es,useMemoCache:es,useCacheRefresh:es};xo.useEffectEvent=es;var yo={readContext:Ra,use:hs,useCallback:function(e,t){return cs().memoizedState=[e,void 0===t?null:t],e},useContext:Ra,useEffect:Hs,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,Us(4194308,4,Ys.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){Us(4,2,e,t)},useMemo:function(e,t){var n=cs();t=void 0===t?null:t;var r=e();if(Ki){ye(!0);try{e()}finally{ye(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=cs();if(void 0!==n){var a=n(t);if(Ki){ye(!0);try{n(t)}finally{ye(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=co.bind(null,Vi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},cs().memoizedState=e},useState:function(e){var t=(e=js(e)).queue,n=uo.bind(null,Vi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ks,useDeferredValue:function(e,t){return Qs(cs(),e,t)},useTransition:function(){var e=js(!1);return e=eo.bind(null,Vi,e.queue,!0,!1),cs().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Vi,i=cs();if(pa){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===fc)throw Error(r(349));127&yc||vs(a,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Hs(ws.bind(null,a,s,e),[e]),a.flags|=2048,Ls(9,{destroy:void 0},bs.bind(null,a,s,n,t),null),n},useId:function(){var e=cs(),t=fc.identifierPrefix;if(pa){var n=ia;t="_"+t+"R_"+(n=(aa&~(1<<32-ve(aa)-1)).toString(32)+n),0<(n=qi++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Zi++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:io,useFormState:Ds,useActionState:Ds,useOptimistic:function(e){var t=cs();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=po.bind(null,Vi,!0,n),n.dispatch=t,[e,t]},useMemoCache:ps,useCacheRefresh:function(){return cs().memoizedState=lo.bind(null,Vi)},useEffectEvent:function(e){var t=cs(),n={impl:e};return t.memoizedState=n,function(){if(2&gc)throw Error(r(440));return n.impl.apply(void 0,arguments)}}},vo={readContext:Ra,use:hs,useCallback:qs,useContext:Ra,useEffect:Gs,useImperativeHandle:Xs,useInsertionEffect:$s,useLayoutEffect:Ws,useMemo:Js,useReducer:gs,useRef:Fs,useState:function(){return gs(ms)},useDebugValue:Ks,useDeferredValue:function(e,t){return Zs(ds(),$i.memoizedState,e,t)},useTransition:function(){var e=gs(ms)[0],t=ds().memoizedState;return["boolean"==typeof e?e:us(e),t]},useSyncExternalStore:ys,useId:so,useHostTransitionStatus:io,useFormState:Rs,useActionState:Rs,useOptimistic:function(e,t){return _s(ds(),0,e,t)},useMemoCache:ps,useCacheRefresh:oo};vo.useEffectEvent=Vs;var bo={readContext:Ra,use:hs,useCallback:qs,useContext:Ra,useEffect:Gs,useImperativeHandle:Xs,useInsertionEffect:$s,useLayoutEffect:Ws,useMemo:Js,useReducer:xs,useRef:Fs,useState:function(){return xs(ms)},useDebugValue:Ks,useDeferredValue:function(e,t){var n=ds();return null===$i?Qs(n,e,t):Zs(n,$i.memoizedState,e,t)},useTransition:function(){var e=xs(ms)[0],t=ds().memoizedState;return["boolean"==typeof e?e:us(e),t]},useSyncExternalStore:ys,useId:so,useHostTransitionStatus:io,useFormState:Bs,useActionState:Bs,useOptimistic:function(e,t){var n=ds();return null!==$i?_s(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ps,useCacheRefresh:oo};function wo(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:d({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}bo.useEffectEvent=Vs;var No={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Xc(),a=bi(r);a.payload=t,null!=n&&(a.callback=n),null!==(t=wi(e,a,r))&&(qc(t,e,r),Ni(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Xc(),a=bi(r);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=wi(e,a,r))&&(qc(t,e,r),Ni(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Xc(),r=bi(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=wi(e,r,n))&&(qc(t,e,n),Ni(t,e,n))}};function So(e,t,n,r,a,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!tr(n,r)||!tr(a,i))}function jo(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&No.enqueueReplaceState(t,t.state,null)}function _o(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=d({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function Ao(e){Mr(e)}function Co(e){console.error(e)}function Mo(e){Mr(e)}function ko(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Eo(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function To(e,t,n){return(n=bi(n)).tag=3,n.payload={element:null},n.callback=function(){ko(e,t)},n}function Po(e){return(e=bi(e)).tag=3,e}function Do(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Eo(t,n,r)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){Eo(t,n,r),"function"!=typeof a&&(null===Lc?Lc=new Set([this]):Lc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ro=Error(r(461)),Io=!1;function Oo(e,t,n,r){t.child=null===e?fi(t,null,n,r):gi(t,e.child,n,r)}function Bo(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return Da(t),r=ns(e,t,n,s,i,a),o=ss(),null===e||Io?(pa&&o&&la(t),t.flags|=1,Oo(e,t,r,a),t.child):(os(e,t,a),sl(e,t,a))}function Lo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!=typeof i||zr(i)||void 0!==i.defaultProps||null!==n.compare?((e=Vr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Fo(e,t,i,r,a))}if(i=e.child,!ol(e,a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:tr)(s,r)&&e.ref===t.ref)return sl(e,t,a)}return t.flags|=1,(e=Hr(i,r)).ref=t.ref,e.return=t,t.child=e}function Fo(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(tr(i,r)&&e.ref===t.ref){if(Io=!1,t.pendingProps=r=i,!ol(e,a))return t.lanes=e.lanes,sl(e,t,a);131072&e.flags&&(Io=!0)}}return Wo(e,t,n,r,a)}function Uo(e,t,n,r){var a=r.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(128&t.flags){if(i=null!==i?i.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;r=a&~i}else r=0,t.child=null;return Ho(e,t,i,n,r)}if(!(536870912&n))return r=t.lanes=536870912,Ho(e,t,null!==i?i.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ja(0,null!==i?i.cachePool:null),null!==i?Ti(t,i):Pi(),Li(t)}else null!==i?(Ja(0,i.cachePool),Ti(t,i),Fi(),t.memoizedState=null):(null!==e&&Ja(0,null),Pi(),Fi());return Oo(e,t,a,n),t.child}function zo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Ho(e,t,n,r,a){var i=qa();return i=null===i?null:{parent:Ua._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Ja(0,null),Pi(),Li(t),null!==e&&Ta(e,t,r,!0),t.childLanes=a,null}function Go(e,t){return(t=tl({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Vo(e,t,n){return gi(t,e.child,null,n),(e=Go(t,t.pendingProps)).flags|=2,Ui(t),t.memoizedState=null,e}function $o(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(r(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Wo(e,t,n,r,a){return Da(t),n=ns(e,t,n,r,void 0,a),r=ss(),null===e||Io?(pa&&r&&la(t),t.flags|=1,Oo(e,t,n,a),t.child):(os(e,t,a),sl(e,t,a))}function Yo(e,t,n,r,a,i){return Da(t),t.updateQueue=null,n=as(t,r,n,a),rs(e),r=ss(),null===e||Io?(pa&&r&&la(t),t.flags|=1,Oo(e,t,n,i),t.child):(os(e,t,i),sl(e,t,i))}function Xo(e,t,n,r,a){if(Da(t),null===t.stateNode){var i=Lr,s=n.contextType;"object"==typeof s&&null!==s&&(i=Ra(s)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=No,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},yi(t),s=n.contextType,i.context="object"==typeof s&&null!==s?Ra(s):Lr,i.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(wo(t,n,s,r),i.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(s=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&No.enqueueReplaceState(i,i.state,null),Ai(t,r,i,a),_i(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var o=t.memoizedProps,l=_o(n,o);i.props=l;var c=i.context,d=n.contextType;s=Lr,"object"==typeof d&&null!==d&&(s=Ra(d));var u=n.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o||c!==s)&&jo(t,i,r,s),xi=!1;var h=t.memoizedState;i.state=h,Ai(t,r,i,a),_i(),c=t.memoizedState,o||h!==c||xi?("function"==typeof u&&(wo(t,n,u,r),c=t.memoizedState),(l=xi||So(t,n,l,r,h,c,s))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=s,r=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,vi(e,t),d=_o(n,s=t.memoizedProps),i.props=d,u=t.pendingProps,h=i.context,c=n.contextType,l=Lr,"object"==typeof c&&null!==c&&(l=Ra(c)),(c="function"==typeof(o=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==u||h!==l)&&jo(t,i,r,l),xi=!1,h=t.memoizedState,i.state=h,Ai(t,r,i,a),_i();var p=t.memoizedState;s!==u||h!==p||xi||null!==e&&null!==e.dependencies&&Pa(e.dependencies)?("function"==typeof o&&(wo(t,n,o,r),p=t.memoizedState),(d=xi||So(t,n,d,r,h,p,l)||null!==e&&null!==e.dependencies&&Pa(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,p,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),i.props=r,i.state=p,i.context=l,r=d):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,$o(e,t),r=!!(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=gi(t,e.child,null,a),t.child=gi(t,null,n,a)):Oo(e,t,n,a),t.memoizedState=i.state,e=t.child):e=sl(e,t,a),e}function Ko(e,t,n,r){return wa(),t.flags|=256,Oo(e,t,n,r),t.child}var qo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jo(e){return{baseLanes:e,cachePool:Qa()}}function Qo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=kc),e}function Zo(e,t,n){var a,i=t.pendingProps,s=!1,o=!!(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&!!(2&zi.current)),a&&(s=!0,t.flags&=-129),a=!!(32&t.flags),t.flags&=-33,null===e){if(pa){if(s?Oi(t):Fi(),(e=ha)?null!==(e=null!==(e=Pu(e,ga))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ra?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},(n=Yr(e)).return=t,t.child=n,ua=t,ha=null):e=null,null===e)throw xa(t);return Ru(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,s?(Fi(),l=tl({mode:"hidden",children:l},s=t.mode),i=$r(i,s,n,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Jo(n),i.childLanes=Qo(e,a,n),t.memoizedState=qo,zo(null,i)):(Oi(t),el(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Oi(t),t.flags&=-257,t=nl(e,t,n)):null!==t.memoizedState?(Fi(),t.child=e.child,t.flags|=128,t=null):(Fi(),l=i.fallback,s=t.mode,i=tl({mode:"visible",children:i.children},s),(l=$r(l,s,n,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,gi(t,e.child,null,n),(i=t.child).memoizedState=Jo(n),i.childLanes=Qo(e,a,n),t.memoizedState=qo,t=zo(null,i));else if(Oi(t),Ru(l)){if(a=l.nextSibling&&l.nextSibling.dataset)var d=a.dgst;a=d,(i=Error(r(419))).stack="",i.digest=a,Sa({value:i,source:null,stack:null}),t=nl(e,t,n)}else if(Io||Ta(e,t,n,!1),a=0!==(n&e.childLanes),Io||a){if(null!==(a=fc)&&(0!==(i=Re(a,n))&&i!==c.retryLane))throw c.retryLane=i,Ir(e,i),qc(a,e,i),Ro;Du(l)||ld(),t=nl(e,t,n)}else Du(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ha=Iu(l.nextSibling),ua=t,pa=!0,ma=null,ga=!1,null!==e&&da(t,e),(t=el(t,i.children)).flags|=4096);return t}return s?(Fi(),l=i.fallback,s=t.mode,d=(c=e.child).sibling,(i=Hr(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?l=Hr(d,l):(l=$r(l,s,n,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,zo(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Jo(n):(null!==(s=l.cachePool)?(c=Ua._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=Qa(),l={baseLanes:l.baseLanes|n,cachePool:s}),i.memoizedState=l,i.childLanes=Qo(e,a,n),t.memoizedState=qo,zo(e.child,i)):(Oi(t),e=(n=e.child).sibling,(n=Hr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function el(e,t){return(t=tl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function tl(e,t){return(e=Ur(22,e,null,t)).lanes=0,e}function nl(e,t,n){return gi(t,e.child,null,n),(e=el(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function rl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ka(e.return,t,n)}function al(e,t,n,r,a,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,treeForkCount:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a,s.treeForkCount=i)}function il(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;r=r.children;var s=zi.current,o=!!(2&s);if(o?(s=1&s|2,t.flags|=128):s&=1,U(zi,s),Oo(e,t,r,n),r=pa?ea:0,!o&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&rl(e,n,t);else if(19===e.tag)rl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Hi(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),al(t,!1,a,n,i,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Hi(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}al(t,!0,n,null,i,r);break;case"together":al(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function sl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ac|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ta(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Hr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Hr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ol(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Pa(e))}function ll(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Io=!0;else{if(!(ol(e,n)||128&t.flags))return Io=!1,function(e,t,n){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),Ca(0,Ua,e.memoizedState.cache),wa();break;case 27:case 5:K(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:Ca(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Bi(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Oi(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Zo(e,t,n):(Oi(t),null!==(e=sl(e,t,n))?e.sibling:null);Oi(t);break;case 19:var a=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(Ta(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return il(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),U(zi,zi.current),r)break;return null;case 22:return t.lanes=0,Uo(e,t,n,t.pendingProps);case 24:Ca(0,Ua,e.memoizedState.cache)}return sl(e,t,n)}(e,t,n);Io=!!(131072&e.flags)}else Io=!1,pa&&1048576&t.flags&&oa(t,ea,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=ii(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var i=e.$$typeof;if(i===w){t.tag=11,t=Bo(null,t,e,a,n);break e}if(i===j){t.tag=14,t=Lo(null,t,e,a,n);break e}}throw t=T(e)||e,Error(r(306,t,""))}zr(e)?(a=_o(e,a),t.tag=1,t=Xo(null,t,e,a,n)):(t.tag=0,t=Wo(null,t,e,a,n))}return t;case 0:return Wo(e,t,t.type,t.pendingProps,n);case 1:return Xo(e,t,a=t.type,i=_o(a,t.pendingProps),n);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(r(387));a=t.pendingProps;var s=t.memoizedState;i=s.element,vi(e,t),Ai(t,a,null,n);var o=t.memoizedState;if(a=o.cache,Ca(0,Ua,a),a!==s.cache&&Ea(t,[Ua],n,!0),_i(),a=o.element,s.isDehydrated){if(s={element:a,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ko(e,t,a,n);break e}if(a!==i){Sa(i=qr(Error(r(424)),t)),t=Ko(e,t,a,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ha=Iu(e.firstChild),ua=t,pa=!0,ma=null,ga=!0,n=fi(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(wa(),a===i){t=sl(e,t,n);break e}Oo(e,t,a,n)}t=t.child}return t;case 26:return $o(e,t),null===e?(n=Yu(t.type,null,t.pendingProps,null))?t.memoizedState=n:pa||(n=t.type,e=t.pendingProps,(a=yu($.current).createElement(n))[Ue]=t,a[ze]=e,mu(a,n,e),Ze(a),t.stateNode=a):t.memoizedState=Yu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return K(t),null===e&&pa&&(a=t.stateNode=Fu(t.type,t.pendingProps,$.current),ua=t,ga=!0,i=ha,Mu(t.type)?(Ou=i,ha=Iu(a.firstChild)):ha=i),Oo(e,t,t.pendingProps.children,n),$o(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&pa&&((i=a=ha)&&(null!==(a=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=Iu(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,ga))?(t.stateNode=a,ua=t,ha=Iu(a.firstChild),ga=!1,i=!0):i=!1),i||xa(t)),K(t),i=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,a=s.children,wu(i,s)?a=null:null!==o&&wu(i,o)&&(t.flags|=32),null!==t.memoizedState&&(i=ns(e,t,is,null,null,n),hh._currentValue=i),$o(e,t),Oo(e,t,a,n),t.child;case 6:return null===e&&pa&&((e=n=ha)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Iu(e.nextSibling)))return null}return e}(n,t.pendingProps,ga))?(t.stateNode=n,ua=t,ha=null,e=!0):e=!1),e||xa(t)),null;case 13:return Zo(e,t,n);case 4:return Y(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=gi(t,null,a,n):Oo(e,t,a,n),t.child;case 11:return Bo(e,t,t.type,t.pendingProps,n);case 7:return Oo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Oo(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,Ca(0,t.type,a.value),Oo(e,t,a.children,n),t.child;case 9:return i=t.type._context,a=t.pendingProps.children,Da(t),a=a(i=Ra(i)),t.flags|=1,Oo(e,t,a,n),t.child;case 14:return Lo(e,t,t.type,t.pendingProps,n);case 15:return Fo(e,t,t.type,t.pendingProps,n);case 19:return il(e,t,n);case 31:return function(e,t,n){var a=t.pendingProps,i=!!(128&t.flags);if(t.flags&=-129,null===e){if(pa){if("hidden"===a.mode)return e=Go(t,a),t.lanes=536870912,zo(null,e);if(Bi(t),(e=ha)?null!==(e=null!==(e=Pu(e,ga))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ra?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},(n=Yr(e)).return=t,t.child=n,ua=t,ha=null):e=null,null===e)throw xa(t);return t.lanes=536870912,null}return Go(t,a)}var s=e.memoizedState;if(null!==s){var o=s.dehydrated;if(Bi(t),i)if(256&t.flags)t.flags&=-257,t=Vo(e,t,n);else{if(null===t.memoizedState)throw Error(r(558));t.child=e.child,t.flags|=128,t=null}else if(Io||Ta(e,t,n,!1),i=0!==(n&e.childLanes),Io||i){if(null!==(a=fc)&&0!==(o=Re(a,n))&&o!==s.retryLane)throw s.retryLane=o,Ir(e,o),qc(a,e,o),Ro;ld(),t=Vo(e,t,n)}else e=s.treeContext,ha=Iu(o.nextSibling),ua=t,pa=!0,ma=null,ga=!1,null!==e&&da(t,e),(t=Go(t,a)).flags|=4096;return t}return(e=Hr(e.child,{mode:a.mode,children:a.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Uo(e,t,n,t.pendingProps);case 24:return Da(t),a=Ra(Ua),null===e?(null===(i=qa())&&(i=fc,s=za(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:a,cache:i},yi(t),Ca(0,Ua,i)):(0!==(e.lanes&n)&&(vi(e,t),Ai(t,null,null,n),_i()),i=e.memoizedState,s=t.memoizedState,i.parent!==a?(i={parent:a,cache:a},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Ca(0,Ua,a)):(a=s.cache,Ca(0,Ua,a),a!==i.cache&&Ea(t,[Ua],n,!0))),Oo(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(r(156,t.tag))}function cl(e){e.flags|=4}function dl(e,t,n,r,a){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!id())throw si=ni,ei;e.flags|=8192}}else e.flags&=-16777217}function ul(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!sh(t)){if(!id())throw si=ni,ei;e.flags|=8192}}function hl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,Ec|=t)}function pl(e,t){if(!pa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ml(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function gl(e,t,n){var a=t.pendingProps;switch(ca(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ml(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Ma(Ua),X(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ba(t)?cl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,Na())),ml(t),null;case 26:var i=t.type,s=t.memoizedState;return null===e?(cl(t),null!==s?(ml(t),ul(t,s)):(ml(t),dl(t,i,0,0,n))):s?s!==e.memoizedState?(cl(t),ml(t),ul(t,s)):(ml(t),t.flags&=-16777217):((e=e.memoizedProps)!==a&&cl(t),ml(t),dl(t,i,0,0,n)),null;case 27:if(q(t),n=$.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&cl(t);else{if(!a){if(null===t.stateNode)throw Error(r(166));return ml(t),null}e=G.current,ba(t)?ya(t):(e=Fu(i,a,n),t.stateNode=e,cl(t))}return ml(t),null;case 5:if(q(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&cl(t);else{if(!a){if(null===t.stateNode)throw Error(r(166));return ml(t),null}if(s=G.current,ba(t))ya(t);else{var o=yu($.current);switch(s){case 1:s=o.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:s=o.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":s=o.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":s=o.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(s=o.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"==typeof a.is?o.createElement("select",{is:a.is}):o.createElement("select"),a.multiple?s.multiple=!0:a.size&&(s.size=a.size);break;default:s="string"==typeof a.is?o.createElement(i,{is:a.is}):o.createElement(i)}}s[Ue]=t,s[ze]=a;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)s.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=s;e:switch(mu(s,i,a),i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&cl(t)}}return ml(t),dl(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&cl(t);else{if("string"!=typeof a&&null===t.stateNode)throw Error(r(166));if(e=$.current,ba(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(i=ua))switch(i.tag){case 27:case 5:a=i.memoizedProps}e[Ue]=t,(e=!!(e.nodeValue===n||null!==a&&!0===a.suppressHydrationWarning||uu(e.nodeValue,n)))||xa(t,!0)}else(e=yu(e).createTextNode(a))[Ue]=t,t.stateNode=e}return ml(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(a=ba(t),null!==n){if(null===e){if(!a)throw Error(r(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(r(557));e[Ue]=t}else wa(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ml(t),e=!1}else n=Na(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Ui(t),t):(Ui(t),null);if(128&t.flags)throw Error(r(558))}return ml(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ba(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[Ue]=t}else wa(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ml(t),i=!1}else i=Na(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(Ui(t),t):(Ui(t),null)}return Ui(t),128&t.flags?(t.lanes=n,t):(n=null!==a,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(i=a.alternate.memoizedState.cachePool.pool),s=null,null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(s=a.memoizedState.cachePool.pool),s!==i&&(a.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),hl(t,t.updateQueue),ml(t),null);case 4:return X(),null===e&&tu(t.stateNode.containerInfo),ml(t),null;case 10:return Ma(t.type),ml(t),null;case 19:if(F(zi),null===(a=t.memoizedState))return ml(t),null;if(i=!!(128&t.flags),null===(s=a.rendering))if(i)pl(a,!1);else{if(0!==_c||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(s=Hi(e))){for(t.flags|=128,pl(a,!1),e=s.updateQueue,t.updateQueue=e,hl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Gr(n,e),n=n.sibling;return U(zi,1&zi.current|2),pa&&sa(t,a.treeForkCount),t.child}e=e.sibling}null!==a.tail&&oe()>Oc&&(t.flags|=128,i=!0,pl(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Hi(s))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,hl(t,e),pl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!s.alternate&&!pa)return ml(t),null}else 2*oe()-a.renderingStartTime>Oc&&536870912!==n&&(t.flags|=128,i=!0,pl(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=a.last)?e.sibling=s:t.child=s,a.last=s)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=oe(),e.sibling=null,n=zi.current,U(zi,i?1&n|2:1&n),pa&&sa(t,a.treeForkCount),e):(ml(t),null);case 22:case 23:return Ui(t),Di(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?!!(536870912&n)&&!(128&t.flags)&&(ml(t),6&t.subtreeFlags&&(t.flags|=8192)):ml(t),null!==(n=t.updateQueue)&&hl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&F(Ka),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ma(Ua),ml(t),null;case 25:case 30:return null}throw Error(r(156,t.tag))}function fl(e,t){switch(ca(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ma(Ua),X(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return q(t),null;case 31:if(null!==t.memoizedState){if(Ui(t),null===t.alternate)throw Error(r(340));wa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Ui(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));wa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return F(zi),null;case 4:return X(),null;case 10:return Ma(t.type),null;case 22:case 23:return Ui(t),Di(),null!==e&&F(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ma(Ua),null;default:return null}}function xl(e,t){switch(ca(t),t.tag){case 3:Ma(Ua),X();break;case 26:case 27:case 5:q(t);break;case 4:X();break;case 31:null!==t.memoizedState&&Ui(t);break;case 13:Ui(t);break;case 19:F(zi);break;case 10:Ma(t.type);break;case 22:case 23:Ui(t),Di(),null!==e&&F(Ka);break;case 24:Ma(Ua)}}function yl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,s=n.inst;r=i(),s.destroy=r}n=n.next}while(n!==a)}}catch(o){_d(t,t.return,o)}}function vl(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,a=t;var l=n,c=o;try{c()}catch(d){_d(a,l,d)}}}r=r.next}while(r!==i)}}catch(d){_d(t,t.return,d)}}function bl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Mi(t,n)}catch(r){_d(e,e.return,r)}}}function wl(e,t,n){n.props=_o(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){_d(e,t,r)}}function Nl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"==typeof n?e.refCleanup=n(r):n.current=r}}catch(a){_d(e,t,a)}}function Sl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r()}catch(a){_d(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(i){_d(e,t,i)}else n.current=null}function jl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){_d(e,e.return,a)}}function _l(e,t,n){try{var a=e.stateNode;!function(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,o=null,l=null,c=null,d=null,u=null;for(m in n){var h=n[m];if(n.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:a.hasOwnProperty(m)||hu(e,t,m,null,a,h)}}for(var p in a){var m=a[p];if(h=n[p],a.hasOwnProperty(p)&&(null!=m||null!=h))switch(p){case"type":s=m;break;case"name":i=m;break;case"checked":d=m;break;case"defaultChecked":u=m;break;case"value":o=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(r(137,t));break;default:m!==h&&hu(e,t,p,m,a,h)}}return void xt(e,o,l,c,d,u,s,i);case"select":for(s in m=o=l=p=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":m=c;default:a.hasOwnProperty(s)||hu(e,t,s,null,a,c)}for(i in a)if(s=a[i],c=n[i],a.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":p=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&hu(e,t,i,s,a,c)}return t=l,n=o,a=m,void(null!=p?wt(e,!!n,p,!1):!!a!=!!n&&(null!=t?wt(e,!!n,t,!0):wt(e,!!n,n?[]:"",!1)));case"textarea":for(l in m=p=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!a.hasOwnProperty(l))switch(l){case"value":case"children":break;default:hu(e,t,l,null,a,i)}for(o in a)if(i=a[o],s=n[o],a.hasOwnProperty(o)&&(null!=i||null!=s))switch(o){case"value":p=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(r(91));break;default:i!==s&&hu(e,t,o,i,a,s)}return void Nt(e,p,m);case"option":for(var g in n)if(p=n[g],n.hasOwnProperty(g)&&null!=p&&!a.hasOwnProperty(g))if("selected"===g)e.selected=!1;else hu(e,t,g,null,a,p);for(c in a)if(p=a[c],m=n[c],a.hasOwnProperty(c)&&p!==m&&(null!=p||null!=m))if("selected"===c)e.selected=p&&"function"!=typeof p&&"symbol"!=typeof p;else hu(e,t,c,p,a,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var f in n)p=n[f],n.hasOwnProperty(f)&&null!=p&&!a.hasOwnProperty(f)&&hu(e,t,f,null,a,p);for(d in a)if(p=a[d],m=n[d],a.hasOwnProperty(d)&&p!==m&&(null!=p||null!=m))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(r(137,t));break;default:hu(e,t,d,p,a,m)}return;default:if(Et(t)){for(var x in n)p=n[x],n.hasOwnProperty(x)&&void 0!==p&&!a.hasOwnProperty(x)&&pu(e,t,x,void 0,a,p);for(u in a)p=a[u],m=n[u],!a.hasOwnProperty(u)||p===m||void 0===p&&void 0===m||pu(e,t,u,p,a,m);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!a.hasOwnProperty(y)&&hu(e,t,y,null,a,p);for(h in a)p=a[h],m=n[h],!a.hasOwnProperty(h)||p===m||null==p&&null==m||hu(e,t,h,p,a,m)}(a,e.type,n,t),a[ze]=t}catch(i){_d(e,e.return,i)}}function Al(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Mu(e.type)||4===e.tag}function Cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Mu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ml(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Rt));else if(4!==r&&(27===r&&Mu(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Ml(e,t,n),e=e.sibling;null!==e;)Ml(e,t,n),e=e.sibling}function kl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Mu(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(kl(e,t,n),e=e.sibling;null!==e;)kl(e,t,n),e=e.sibling}function El(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);mu(t,r,n),t[Ue]=e,t[ze]=n}catch(i){_d(e,e.return,i)}}var Tl=!1,Pl=!1,Dl=!1,Rl="function"==typeof WeakSet?WeakSet:Set,Il=null;function Ol(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:ql(e,n),4&r&&yl(5,n);break;case 1:if(ql(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){_d(n,n.return,s)}else{var a=_o(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){_d(n,n.return,o)}}64&r&&bl(n),512&r&&Nl(n,n.return);break;case 3:if(ql(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Mi(e,t)}catch(s){_d(n,n.return,s)}}break;case 27:null===t&&4&r&&El(n);case 26:case 5:ql(e,n),null===t&&4&r&&jl(n),512&r&&Nl(n,n.return);break;case 12:ql(e,n);break;case 31:ql(e,n),4&r&&Hl(e,n);break;case 13:ql(e,n),4&r&&Gl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=kd.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Tl)){t=null!==t&&null!==t.memoizedState||Pl,a=Tl;var i=Pl;Tl=r,(Pl=t)&&!i?Ql(e,n,!!(8772&n.subtreeFlags)):ql(e,n),Tl=a,Pl=i}break;case 30:break;default:ql(e,n)}}function Bl(e){var t=e.alternate;null!==t&&(e.alternate=null,Bl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ll=null,Fl=!1;function Ul(e,t,n){for(n=n.child;null!==n;)zl(e,t,n),n=n.sibling}function zl(e,t,n){if(xe&&"function"==typeof xe.onCommitFiberUnmount)try{xe.onCommitFiberUnmount(fe,n)}catch(i){}switch(n.tag){case 26:Pl||Sl(n,t),Ul(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Pl||Sl(n,t);var r=Ll,a=Fl;Mu(n.type)&&(Ll=n.stateNode,Fl=!1),Ul(e,t,n),Uu(n.stateNode),Ll=r,Fl=a;break;case 5:Pl||Sl(n,t);case 6:if(r=Ll,a=Fl,Ll=null,Ul(e,t,n),Fl=a,null!==(Ll=r))if(Fl)try{(9===Ll.nodeType?Ll.body:"HTML"===Ll.nodeName?Ll.ownerDocument.body:Ll).removeChild(n.stateNode)}catch(s){_d(n,t,s)}else try{Ll.removeChild(n.stateNode)}catch(s){_d(n,t,s)}break;case 18:null!==Ll&&(Fl?(ku(9===(e=Ll).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Wh(e)):ku(Ll,n.stateNode));break;case 4:r=Ll,a=Fl,Ll=n.stateNode.containerInfo,Fl=!0,Ul(e,t,n),Ll=r,Fl=a;break;case 0:case 11:case 14:case 15:vl(2,n,t),Pl||vl(4,n,t),Ul(e,t,n);break;case 1:Pl||(Sl(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&wl(n,t,r)),Ul(e,t,n);break;case 21:Ul(e,t,n);break;case 22:Pl=(r=Pl)||null!==n.memoizedState,Ul(e,t,n),Pl=r;break;default:Ul(e,t,n)}}function Hl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wh(e)}catch(n){_d(t,t.return,n)}}}function Gl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wh(e)}catch(n){_d(t,t.return,n)}}function Vl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Rl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Rl),t;default:throw Error(r(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Ed.bind(null,e,t);t.then(r,r)}})}function $l(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var i=n[a],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Mu(l.type)){Ll=l.stateNode,Fl=!1;break e}break;case 5:Ll=l.stateNode,Fl=!1;break e;case 3:case 4:Ll=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(null===Ll)throw Error(r(160));zl(s,o,i),Ll=null,Fl=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Yl(t,e),t=t.sibling}var Wl=null;function Yl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:$l(t,e),Xl(e),4&a&&(vl(3,e,e.return),yl(3,e),vl(5,e,e.return));break;case 1:$l(t,e),Xl(e),512&a&&(Pl||null===n||Sl(n,n.return)),64&a&&Tl&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a))));break;case 26:var i=Wl;if($l(t,e),Xl(e),512&a&&(Pl||null===n||Sl(n,n.return)),4&a){var s=null!==n?n.memoizedState:null;if(a=e.memoizedState,null===n)if(null===a)if(null===e.stateNode){e:{a=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(a){case"title":(!(s=i.getElementsByTagName("title")[0])||s[Ye]||s[Ue]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(a),i.head.insertBefore(s,i.querySelector("head > title"))),mu(s,a,n),s[Ue]=e,Ze(s),a=s;break e;case"link":var o=ah("link","href",i).get(a+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}mu(s=i.createElement(a),a,n),i.head.appendChild(s);break;case"meta":if(o=ah("meta","content",i).get(a+(n.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}mu(s=i.createElement(a),a,n),i.head.appendChild(s);break;default:throw Error(r(468,a))}s[Ue]=e,Ze(s),a=s}e.stateNode=a}else ih(i,e.type,e.stateNode);else e.stateNode=Zu(i,a,e.memoizedProps);else s!==a?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===a?ih(i,e.type,e.stateNode):Zu(i,a,e.memoizedProps)):null===a&&null!==e.stateNode&&_l(e,e.memoizedProps,n.memoizedProps)}break;case 27:$l(t,e),Xl(e),512&a&&(Pl||null===n||Sl(n,n.return)),null!==n&&4&a&&_l(e,e.memoizedProps,n.memoizedProps);break;case 5:if($l(t,e),Xl(e),512&a&&(Pl||null===n||Sl(n,n.return)),32&e.flags){i=e.stateNode;try{_t(i,"")}catch(g){_d(e,e.return,g)}}4&a&&null!=e.stateNode&&_l(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&a&&(Dl=!0);break;case 6:if($l(t,e),Xl(e),4&a){if(null===e.stateNode)throw Error(r(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(g){_d(e,e.return,g)}}break;case 3:if(rh=null,i=Wl,Wl=Gu(t.containerInfo),$l(t,e),Wl=i,Xl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Wh(t.containerInfo)}catch(g){_d(e,e.return,g)}Dl&&(Dl=!1,Kl(e));break;case 4:a=Wl,Wl=Gu(e.stateNode.containerInfo),$l(t,e),Xl(e),Wl=a;break;case 12:default:$l(t,e),Xl(e);break;case 31:case 19:$l(t,e),Xl(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Vl(e,a)));break;case 13:$l(t,e),Xl(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Rc=oe()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Vl(e,a)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=Tl,u=Pl;if(Tl=d||i,Pl=u||c,$l(t,e),Pl=u,Tl=d,Xl(e),8192&a)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||Tl||Pl||Jl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,i)"function"==typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,p=null!=h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==p||"boolean"==typeof p?"":(""+p).trim()}}catch(g){_d(c,c.return,g)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(g){_d(c,c.return,g)}}}else if(18===t.tag){if(null===n){c=t;try{var m=c.stateNode;i?Eu(m,!0):Eu(c.stateNode,!1)}catch(g){_d(c,c.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(n=a.retryQueue)&&(a.retryQueue=null,Vl(e,n))));case 30:case 21:}}function Xl(e){var t=e.flags;if(2&t){try{for(var n,a=e.return;null!==a;){if(Al(a)){n=a;break}a=a.return}if(null==n)throw Error(r(160));switch(n.tag){case 27:var i=n.stateNode;kl(e,Cl(e),i);break;case 5:var s=n.stateNode;32&n.flags&&(_t(s,""),n.flags&=-33),kl(e,Cl(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;Ml(e,Cl(e),o);break;default:throw Error(r(161))}}catch(l){_d(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function ql(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ol(e,t.alternate,t),t=t.sibling}function Jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),Jl(t);break;case 1:Sl(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&wl(t,t.return,n),Jl(t);break;case 27:Uu(t.stateNode);case 26:case 5:Sl(t,t.return),Jl(t);break;case 22:null===t.memoizedState&&Jl(t);break;default:Jl(t)}e=e.sibling}}function Ql(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:Ql(a,i,n),yl(4,i);break;case 1:if(Ql(a,i,n),"function"==typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){_d(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)Ci(l[a],o)}catch(c){_d(r,r.return,c)}}n&&64&s&&bl(i),Nl(i,i.return);break;case 27:El(i);case 26:case 5:Ql(a,i,n),n&&null===r&&4&s&&jl(i),Nl(i,i.return);break;case 12:Ql(a,i,n);break;case 31:Ql(a,i,n),n&&4&s&&Hl(a,i);break;case 13:Ql(a,i,n),n&&4&s&&Gl(a,i);break;case 22:null===i.memoizedState&&Ql(a,i,n),Nl(i,i.return);break;case 30:break;default:Ql(a,i,n)}t=t.sibling}}function Zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ha(n))}function ec(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ha(e))}function tc(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)nc(e,t,n,r),t=t.sibling}function nc(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:tc(e,t,n,r),2048&a&&yl(9,t);break;case 1:case 31:case 13:default:tc(e,t,n,r);break;case 3:tc(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ha(e)));break;case 12:if(2048&a){tc(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;"function"==typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){_d(t,t.return,l)}}else tc(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,null!==t.memoizedState?2&i._visibility?tc(e,t,n,r):ac(e,t):2&i._visibility?tc(e,t,n,r):(i._visibility|=2,rc(e,t,n,r,!!(10256&t.subtreeFlags)||!1)),2048&a&&Zl(s,t);break;case 24:tc(e,t,n,r),2048&a&&ec(t.alternate,t)}}function rc(e,t,n,r,a){for(a=a&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:rc(i,s,o,l,a),yl(8,s);break;case 23:break;case 22:var d=s.stateNode;null!==s.memoizedState?2&d._visibility?rc(i,s,o,l,a):ac(i,s):(d._visibility|=2,rc(i,s,o,l,a)),a&&2048&c&&Zl(s.alternate,s);break;case 24:rc(i,s,o,l,a),a&&2048&c&&ec(s.alternate,s);break;default:rc(i,s,o,l,a)}t=t.sibling}}function ac(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:ac(n,r),2048&a&&Zl(r.alternate,r);break;case 24:ac(n,r),2048&a&&ec(r.alternate,r);break;default:ac(n,r)}t=t.sibling}}var ic=8192;function sc(e,t,n){if(e.subtreeFlags&ic)for(e=e.child;null!==e;)oc(e,t,n),e=e.sibling}function oc(e,t,n){switch(e.tag){case 26:sc(e,t,n),e.flags&ic&&null!==e.memoizedState&&function(e,t,n,r){if(!("stylesheet"!==n.type||"string"==typeof r.media&&!1===matchMedia(r.media).matches||4&n.state.loading)){if(null===n.instance){var a=Xu(r.href),i=t.querySelector(Ku(a));if(i)return null!==(t=i._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=lh.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void Ze(i);i=t.ownerDocument||t,r=qu(r),(a=zu.get(a))&&th(r,a),Ze(i=i.createElement("link"));var s=i;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),mu(i,"link",r),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(3&n.state.loading)&&(e.count++,n=lh.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Wl,e.memoizedState,e.memoizedProps);break;case 5:default:sc(e,t,n);break;case 3:case 4:var r=Wl;Wl=Gu(e.stateNode.containerInfo),sc(e,t,n),Wl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=ic,ic=16777216,sc(e,t,n),ic=r):sc(e,t,n))}}function lc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function cc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Il=r,hc(r,e)}lc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)dc(e),e=e.sibling}function dc(e){switch(e.tag){case 0:case 11:case 15:cc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:cc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,uc(e)):cc(e)}}function uc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Il=r,hc(r,e)}lc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),uc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,uc(t));break;default:uc(t)}e=e.sibling}}function hc(e,t){for(;null!==Il;){var n=Il;switch(n.tag){case 0:case 11:case 15:vl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ha(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Il=r;else e:for(n=e;null!==Il;){var a=(r=Il).sibling,i=r.return;if(Bl(r),r===n){Il=null;break e}if(null!==a){a.return=i,Il=a;break e}Il=i}}}var pc={getCacheForType:function(e){var t=Ra(Ua),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Ra(Ua).controller.signal}},mc="function"==typeof WeakMap?WeakMap:Map,gc=0,fc=null,xc=null,yc=0,vc=0,bc=null,wc=!1,Nc=!1,Sc=!1,jc=0,_c=0,Ac=0,Cc=0,Mc=0,kc=0,Ec=0,Tc=null,Pc=null,Dc=!1,Rc=0,Ic=0,Oc=1/0,Bc=null,Lc=null,Fc=0,Uc=null,zc=null,Hc=0,Gc=0,Vc=null,$c=null,Wc=0,Yc=null;function Xc(){return 2&gc&&0!==yc?yc&-yc:null!==D.T?Vd():Be()}function Kc(){if(0===kc)if(536870912&yc&&!pa)kc=536870912;else{var e=Se;!(3932160&(Se<<=1))&&(Se=262144),kc=e}return null!==(e=Ri.current)&&(e.flags|=32),kc}function qc(e,t,n){(e!==fc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(rd(e,0),ed(e,yc,kc,!1)),Te(e,n),2&gc&&e===fc||(e===fc&&(!(2&gc)&&(Cc|=n),4===_c&&ed(e,yc,kc,!1)),Bd(e))}function Jc(e,t,n){if(6&gc)throw Error(r(327));for(var a=!n&&!(127&t)&&0===(t&e.expiredLanes)||Ce(e,t),i=a?function(e,t){var n=gc;gc|=2;var a=sd(),i=od();fc!==e||yc!==t?(Bc=null,Oc=oe()+500,rd(e,t)):Nc=Ce(e,t);e:for(;;)try{if(0!==vc&&null!==xc){t=xc;var s=bc;t:switch(vc){case 1:vc=0,bc=null,md(e,t,s,1);break;case 2:case 9:if(ri(s)){vc=0,bc=null,pd(t);break}t=function(){2!==vc&&9!==vc||fc!==e||(vc=7),Bd(e)},s.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ri(s)?(vc=0,bc=null,pd(t)):(vc=0,bc=null,md(e,t,s,7));break;case 5:var o=null;switch(xc.tag){case 26:o=xc.memoizedState;case 5:case 27:var l=xc;if(o?sh(o):l.stateNode.complete){vc=0,bc=null;var c=l.sibling;if(null!==c)xc=c;else{var d=l.return;null!==d?(xc=d,gd(d)):xc=null}break t}}vc=0,bc=null,md(e,t,s,5);break;case 6:vc=0,bc=null,md(e,t,s,6);break;case 8:nd(),_c=6;break e;default:throw Error(r(462))}}ud();break}catch(u){ad(e,u)}return Aa=_a=null,D.H=a,D.A=i,gc=n,null!==xc?0:(fc=null,yc=0,Pr(),_c)}(e,t):cd(e,t,!0),s=a;;){if(0===i){Nc&&!a&&ed(e,t,0,!1);break}if(n=e.current.alternate,!s||Zc(n)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;i=Tc;var c=l.current.memoizedState.isDehydrated;if(c&&(rd(l,o).flags|=256),2!==(o=cd(l,o,!1))){if(Sc&&!c){l.errorRecoveryDisabledLanes|=s,Cc|=s,i=4;break e}s=Pc,Pc=i,null!==s&&(null===Pc?Pc=s:Pc.push.apply(Pc,s))}i=o}if(s=!1,2!==i)continue}}if(1===i){rd(e,0),ed(e,t,0,!0);break}e:{switch(a=e,s=i){case 0:case 1:throw Error(r(345));case 4:if((4194048&t)!==t)break;case 6:ed(a,t,kc,!wc);break e;case 2:Pc=null;break;case 3:case 5:break;default:throw Error(r(329))}if((62914560&t)===t&&10<(i=Rc+300-oe())){if(ed(a,t,kc,!wc),0!==Ae(a,0,!0))break e;Hc=t,a.timeoutHandle=Su(Qc.bind(null,a,n,Pc,Bc,Dc,t,kc,Cc,Ec,wc,s,"Throttled",-0,0),i)}else Qc(a,n,Pc,Bc,Dc,t,kc,Cc,Ec,wc,s,null,-0,0)}break}i=cd(e,t,!1),s=!1}Bd(e)}function Qc(e,t,n,r,a,i,s,o,l,c,d,u,h,p){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||!(16785408&~u)){oc(t,i,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rt});var m=(62914560&i)===i?Rc-oe():(4194048&i)===i?Ic-oe():0;if(m=function(e,t){return e.stylesheets&&0===e.count&&dh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&dh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===oh&&(oh=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var a=n[r],i=a.transferSize,s=a.initiatorType,o=a.duration;if(i&&o&&gu(s)){for(s=0,o=a.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>o)break;var d=l.transferSize,u=l.initiatorType;d&&gu(u)&&(s+=d*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--r,t+=8*(i+s)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&dh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>oh?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(a)}}:null}(u,m),null!==m)return Hc=i,e.cancelPendingCommit=m(xd.bind(null,e,t,i,n,r,a,s,o,l,d,u,null,h,p)),void ed(e,i,s,!c)}xd(e,t,i,n,r,a,s,o,l)}function Zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!er(i(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ed(e,t,n,r){t&=~Mc,t&=~Cc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-ve(a),s=1<<i;r[i]=-1,a&=~s}0!==n&&Pe(e,n,t)}function td(){return!!(6&gc)||(Ld(0),!1)}function nd(){if(null!==xc){if(0===vc)var e=xc.return;else Aa=_a=null,ls(e=xc),ci=null,di=0,e=xc;for(;null!==e;)xl(e.alternate,e),e=e.return;xc=null}}function rd(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,ju(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Hc=0,nd(),fc=e,xc=n=Hr(e.current,null),yc=t,vc=0,bc=null,wc=!1,Nc=Ce(e,t),Sc=!1,Ec=kc=Mc=Cc=Ac=_c=0,Pc=Tc=null,Dc=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-ve(r),i=1<<a;t|=e[a],r&=~i}return jc=t,Pr(),n}function ad(e,t){Vi=null,D.H=xo,t===Za||t===ti?(t=oi(),vc=3):t===ei?(t=oi(),vc=4):vc=t===Ro?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,bc=t,null===xc&&(_c=1,ko(e,qr(t,e.current)))}function id(){var e=Ri.current;return null===e||((4194048&yc)===yc?null===Ii:!!((62914560&yc)===yc||536870912&yc)&&e===Ii)}function sd(){var e=D.H;return D.H=xo,null===e?xo:e}function od(){var e=D.A;return D.A=pc,e}function ld(){_c=4,wc||(4194048&yc)!==yc&&null!==Ri.current||(Nc=!0),!(134217727&Ac)&&!(134217727&Cc)||null===fc||ed(fc,yc,kc,!1)}function cd(e,t,n){var r=gc;gc|=2;var a=sd(),i=od();fc===e&&yc===t||(Bc=null,rd(e,t)),t=!1;var s=_c;e:for(;;)try{if(0!==vc&&null!==xc){var o=xc,l=bc;switch(vc){case 8:nd(),s=6;break e;case 3:case 2:case 9:case 6:null===Ri.current&&(t=!0);var c=vc;if(vc=0,bc=null,md(e,o,l,c),n&&Nc){s=0;break e}break;default:c=vc,vc=0,bc=null,md(e,o,l,c)}}dd(),s=_c;break}catch(d){ad(e,d)}return t&&e.shellSuspendCounter++,Aa=_a=null,gc=r,D.H=a,D.A=i,null===xc&&(fc=null,yc=0,Pr()),s}function dd(){for(;null!==xc;)hd(xc)}function ud(){for(;null!==xc&&!ie();)hd(xc)}function hd(e){var t=ll(e.alternate,e,jc);e.memoizedProps=e.pendingProps,null===t?gd(e):xc=t}function pd(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Yo(n,t,t.pendingProps,t.type,void 0,yc);break;case 11:t=Yo(n,t,t.pendingProps,t.type.render,t.ref,yc);break;case 5:ls(t);default:xl(n,t),t=ll(n,t=xc=Gr(t,jc),jc)}e.memoizedProps=e.pendingProps,null===t?gd(e):xc=t}function md(e,t,n,a){Aa=_a=null,ls(t),ci=null,di=0;var i=t.return;try{if(function(e,t,n,a,i){if(n.flags|=32768,null!==a&&"object"==typeof a&&"function"==typeof a.then){if(null!==(t=n.alternate)&&Ta(t,n,i,!0),null!==(n=Ri.current)){switch(n.tag){case 31:case 13:return null===Ii?ld():null===n.alternate&&0===_c&&(_c=3),n.flags&=-257,n.flags|=65536,n.lanes=i,a===ni?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),Ad(e,a,i)),!1;case 22:return n.flags|=65536,a===ni?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),Ad(e,a,i)),!1}throw Error(r(435,n.tag))}return Ad(e,a,i),ld(),!1}if(pa)return null!==(t=Ri.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,a!==fa&&Sa(qr(e=Error(r(422),{cause:a}),n))):(a!==fa&&Sa(qr(t=Error(r(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,a=qr(a,n),Si(e,i=To(e.stateNode,a,i)),4!==_c&&(_c=2)),!1;var s=Error(r(520),{cause:a});if(s=qr(s,n),null===Tc?Tc=[s]:Tc.push(s),4!==_c&&(_c=2),null===t)return!0;a=qr(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,Si(n,e=To(n.stateNode,a,e)),!1;case 1:if(t=n.type,s=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===s||"function"!=typeof s.componentDidCatch||null!==Lc&&Lc.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,Do(i=Po(i),e,n,a),Si(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,yc))return _c=1,ko(e,qr(n,e.current)),void(xc=null)}catch(s){if(null!==i)throw xc=i,s;return _c=1,ko(e,qr(n,e.current)),void(xc=null)}32768&t.flags?(pa||1===a?e=!0:Nc||536870912&yc?e=!1:(wc=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=Ri.current)&&13===a.tag&&(a.flags|=16384))),fd(t,e)):gd(t)}function gd(e){var t=e;do{if(32768&t.flags)return void fd(t,wc);e=t.return;var n=gl(t.alternate,t,jc);if(null!==n)return void(xc=n);if(null!==(t=t.sibling))return void(xc=t);xc=t=e}while(null!==t);0===_c&&(_c=5)}function fd(e,t){do{var n=fl(e.alternate,e);if(null!==n)return n.flags&=32767,void(xc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(xc=e);xc=e=n}while(null!==e);_c=6,xc=null}function xd(e,t,n,a,i,s,o,l,c){e.cancelPendingCommit=null;do{Nd()}while(0!==Fc);if(6&gc)throw Error(r(327));if(null!==t){if(t===e.current)throw Error(r(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,a,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var d=31-ve(n),u=1<<d;o[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var p=h[d];null!==p&&(p.lane&=-536870913)}n&=~u}0!==r&&Pe(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,n,s|=Tr,o,l,c),e===fc&&(xc=fc=null,yc=0),zc=t,Uc=e,Hc=n,Gc=s,Vc=i,$c=a,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,re(ue,function(){return Sd(),null})):(e.callbackNode=null,e.callbackPriority=0),a=!!(13878&t.flags),13878&t.subtreeFlags||a){a=D.T,D.T=null,i=R.p,R.p=2,o=gc,gc|=4;try{!function(e,t){if(e=e.containerInfo,fu=wh,sr(e=ir(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var i=a.anchorOffset,s=a.focusNode;a=a.focusOffset;try{n.nodeType,s.nodeType}catch(f){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==s||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===i&&(l=o),p===s&&++u===a&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(xu={focusedElem:e,selectionRange:n},wh=!1,Il=t;null!==Il;)if(e=(t=Il).child,1028&t.subtreeFlags&&null!==e)e.return=t,Il=e;else for(;null!==Il;){switch(s=(t=Il).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,a=n.stateNode;try{var g=_o(n.type,i);e=a.getSnapshotBeforeUpdate(g,s),a.__reactInternalSnapshotBeforeUpdate=e}catch(x){_d(n,n.return,x)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))Tu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Tu(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(r(163))}if(null!==(e=t.sibling)){e.return=t.return,Il=e;break}Il=t.return}}(e,t)}finally{gc=o,R.p=i,D.T=a}}Fc=1,yd(),vd(),bd()}}function yd(){if(1===Fc){Fc=0;var e=Uc,t=zc,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=D.T,D.T=null;var r=R.p;R.p=2;var a=gc;gc|=4;try{Yl(t,e);var i=xu,s=ir(e.containerInfo),o=i.focusedElem,l=i.selectionRange;if(s!==o&&o&&o.ownerDocument&&ar(o.ownerDocument.documentElement,o)){if(null!==l&&sr(o)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var u=o.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var p=h.getSelection(),m=o.textContent.length,g=Math.min(l.start,m),f=void 0===l.end?g:Math.min(l.end,m);!p.extend&&g>f&&(s=f,f=g,g=s);var x=rr(o,g),y=rr(o,f);if(x&&y&&(1!==p.rangeCount||p.anchorNode!==x.node||p.anchorOffset!==x.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var v=u.createRange();v.setStart(x.node,x.offset),p.removeAllRanges(),g>f?(p.addRange(v),p.extend(y.node,y.offset)):(v.setEnd(y.node,y.offset),p.addRange(v))}}}}for(u=[],p=o;p=p.parentNode;)1===p.nodeType&&u.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof o.focus&&o.focus(),o=0;o<u.length;o++){var b=u[o];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}wh=!!fu,xu=fu=null}finally{gc=a,R.p=r,D.T=n}}e.current=t,Fc=2}}function vd(){if(2===Fc){Fc=0;var e=Uc,t=zc,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=D.T,D.T=null;var r=R.p;R.p=2;var a=gc;gc|=4;try{Ol(e,t.alternate,t)}finally{gc=a,R.p=r,D.T=n}}Fc=3}}function bd(){if(4===Fc||3===Fc){Fc=0,se();var e=Uc,t=zc,n=Hc,r=$c;10256&t.subtreeFlags||10256&t.flags?Fc=5:(Fc=0,zc=Uc=null,wd(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Lc=null),Oe(n),t=t.stateNode,xe&&"function"==typeof xe.onCommitFiberRoot)try{xe.onCommitFiberRoot(fe,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==r){t=D.T,a=R.p,R.p=2,D.T=null;try{for(var i=e.onRecoverableError,s=0;s<r.length;s++){var o=r[s];i(o.value,{componentStack:o.stack})}}finally{D.T=t,R.p=a}}3&Hc&&Nd(),Bd(e),a=e.pendingLanes,261930&n&&42&a?e===Yc?Wc++:(Wc=0,Yc=e):Wc=0,Ld(0)}}function wd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ha(t)))}function Nd(){return yd(),vd(),bd(),Sd()}function Sd(){if(5!==Fc)return!1;var e=Uc,t=Gc;Gc=0;var n=Oe(Hc),a=D.T,i=R.p;try{R.p=32>n?32:n,D.T=null,n=Vc,Vc=null;var s=Uc,o=Hc;if(Fc=0,zc=Uc=null,Hc=0,6&gc)throw Error(r(331));var l=gc;if(gc|=4,dc(s.current),nc(s,s.current,o,n),gc=l,Ld(0,!1),xe&&"function"==typeof xe.onPostCommitFiberRoot)try{xe.onPostCommitFiberRoot(fe,s)}catch(c){}return!0}finally{R.p=i,D.T=a,wd(e,t)}}function jd(e,t,n){t=qr(n,t),null!==(e=wi(e,t=To(e.stateNode,t,2),2))&&(Te(e,2),Bd(e))}function _d(e,t,n){if(3===e.tag)jd(e,e,n);else for(;null!==t;){if(3===t.tag){jd(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Lc||!Lc.has(r))){e=qr(n,e),null!==(r=wi(t,n=Po(2),2))&&(Do(n,r,t,e),Te(r,2),Bd(r));break}}t=t.return}}function Ad(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new mc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(Sc=!0,a.add(n),e=Cd.bind(null,e,t,n),t.then(e,e))}function Cd(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,fc===e&&(yc&n)===n&&(4===_c||3===_c&&(62914560&yc)===yc&&300>oe()-Rc?!(2&gc)&&rd(e,0):Mc|=n,Ec===yc&&(Ec=0)),Bd(e)}function Md(e,t){0===t&&(t=ke()),null!==(e=Ir(e,t))&&(Te(e,t),Bd(e))}function kd(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Md(e,n)}function Ed(e,t){var n=0;switch(e.tag){case 31:case 13:var a=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(r(314))}null!==a&&a.delete(t),Md(e,n)}var Td=null,Pd=null,Dd=!1,Rd=!1,Id=!1,Od=0;function Bd(e){e!==Pd&&null===e.next&&(null===Pd?Td=Pd=e:Pd=Pd.next=e),Rd=!0,Dd||(Dd=!0,Au(function(){6&gc?re(ce,Fd):Ud()}))}function Ld(e,t){if(!Id&&Rd){Id=!0;do{for(var n=!1,r=Td;null!==r;){if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var s=r.suspendedLanes,o=r.pingedLanes;i=(1<<31-ve(42|e)+1)-1,i=201326741&(i&=a&~(s&~o))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Gd(r,i))}else i=yc,!(3&(i=Ae(r,r===fc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ce(r,i)||(n=!0,Gd(r,i));r=r.next}}while(n);Id=!1}}function Fd(){Ud()}function Ud(){Rd=Dd=!1;var e=0;0!==Od&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Nu&&(Nu=e,!0);return Nu=null,!1}()&&(e=Od);for(var t=oe(),n=null,r=Td;null!==r;){var a=r.next,i=zd(r,t);0===i?(r.next=null,null===n?Td=a:n.next=a,null===a&&(Pd=n)):(n=r,(0!==e||3&i)&&(Rd=!0)),r=a}0!==Fc&&5!==Fc||Ld(e),0!==Od&&(Od=0)}function zd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var s=31-ve(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=Me(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}if(n=yc,n=Ae(e,e===(t=fc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&ae(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||Ce(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&ae(r),Oe(n)){case 2:case 8:n=de;break;case 32:default:n=ue;break;case 268435456:n=pe}return r=Hd.bind(null,e),n=re(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&ae(r),e.callbackPriority=2,e.callbackNode=null,2}function Hd(e,t){if(0!==Fc&&5!==Fc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Nd()&&e.callbackNode!==n)return null;var r=yc;return 0===(r=Ae(e,e===fc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jc(e,r,t),zd(e,oe()),null!=e.callbackNode&&e.callbackNode===n?Hd.bind(null,e):null)}function Gd(e,t){if(Nd())return null;Jc(e,t,!0)}function Vd(){if(0===Od){var e=$a;0===e&&(e=Ne,!(261888&(Ne<<=1))&&(Ne=256)),Od=e}return Od}function $d(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Dt(""+e)}function Wd(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Yd=0;Yd<Ar.length;Yd++){var Xd=Ar[Yd];Cr(Xd.toLowerCase(),"on"+(Xd[0].toUpperCase()+Xd.slice(1)))}Cr(yr,"onAnimationEnd"),Cr(vr,"onAnimationIteration"),Cr(br,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(wr,"onTransitionRun"),Cr(Nr,"onTransitionStart"),Cr(Sr,"onTransitionCancel"),Cr(jr,"onTransitionEnd"),rt("onMouseEnter",["mouseout","mouseover"]),rt("onMouseLeave",["mouseout","mouseover"]),rt("onPointerEnter",["pointerout","pointerover"]),rt("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kd));function Jd(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;i=o,a.currentTarget=c;try{i(a)}catch(d){Mr(d)}a.currentTarget=null,i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;i=o,a.currentTarget=c;try{i(a)}catch(d){Mr(d)}a.currentTarget=null,i=l}}}}function Qd(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var r=e+"__bubble";n.has(r)||(nu(t,e,2,!1),n.add(r))}function Zd(e,t,n){var r=0;t&&(r|=4),nu(n,e,r,t)}var eu="_reactListening"+Math.random().toString(36).slice(2);function tu(e){if(!e[eu]){e[eu]=!0,et.forEach(function(t){"selectionchange"!==t&&(qd.has(t)||Zd(t,!1,e),Zd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[eu]||(t[eu]=!0,Zd("selectionchange",!1,t))}}function nu(e,t,n,r){switch(Mh(t)){case 2:var a=Nh;break;case 8:a=Sh;break;default:a=jh}n=a.bind(null,t,n,e),a=void 0,!Vt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function ru(e,t,n,r,a){var s=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var l=r.stateNode.containerInfo;if(l===a)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===a)return;o=o.return}for(;null!==l;){if(null===(o=Ke(l)))return;if(5===(c=o.tag)||6===c||26===c||27===c){r=s=o;continue e}l=l.parentNode}}r=r.return}zt(function(){var r=s,a=Ot(n),o=[];e:{var l=_r.get(e);if(void 0!==l){var c=an,d=e;switch(e){case"keypress":if(0===qt(n))break e;case"keydown":case"keyup":c=bn;break;case"focusin":d="focus",c=un;break;case"focusout":d="blur",c=un;break;case"beforeblur":case"afterblur":c=un;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=dn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case yr:case vr:case br:c=hn;break;case jr:c=Sn;break;case"scroll":case"scrollend":c=on;break;case"wheel":c=jn;break;case"copy":case"cut":case"paste":c=pn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=wn;break;case"toggle":case"beforetoggle":c=_n}var u=!!(4&t),h=!u&&("scroll"===e||"scrollend"===e),p=u?null!==l?l+"Capture":null:l;u=[];for(var m,g=r;null!==g;){var f=g;if(m=f.stateNode,5!==(f=f.tag)&&26!==f&&27!==f||null===m||null===p||null!=(f=Ht(g,p))&&u.push(au(g,f,m)),h)break;g=g.return}0<u.length&&(l=new c(l,d,null,n,a),o.push({event:l,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===It||!(d=n.relatedTarget||n.fromElement)||!Ke(d)&&!d[He])&&(c||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=r,null!==(d=(d=n.relatedTarget||n.toElement)?Ke(d):null)&&(h=i(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=r),c!==d)){if(u=cn,f="onMouseLeave",p="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(u=wn,f="onPointerLeave",p="onPointerEnter",g="pointer"),h=null==c?l:Je(c),m=null==d?l:Je(d),(l=new u(f,g+"leave",c,n,a)).target=h,l.relatedTarget=m,f=null,Ke(a)===r&&((u=new u(p,g+"enter",d,n,a)).target=m,u.relatedTarget=h,f=u),h=f,c&&d)e:{for(u=su,g=d,m=0,f=p=c;f;f=u(f))m++;f=0;for(var x=g;x;x=u(x))f++;for(;0<m-f;)p=u(p),m--;for(;0<f-m;)g=u(g),f--;for(;m--;){if(p===g||null!==g&&p===g.alternate){u=p;break e}p=u(p),g=u(g)}u=null}else u=null;null!==c&&ou(o,l,c,u,!1),null!==d&&null!==h&&ou(o,h,d,u,!0)}if("select"===(c=(l=r?Je(r):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var y=Gn;else if(Bn(l))if(Vn)y=Zn;else{y=Jn;var v=qn}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?r&&Et(r.elementType)&&(y=Gn):y=Qn;switch(y&&(y=y(e,r))?Ln(o,y,n,a):(v&&v(e,l,r),"focusout"===e&&r&&"number"===l.type&&null!=r.memoizedProps.value&&vt(l,"number",l.value)),v=r?Je(r):window,e){case"focusin":(Bn(v)||"true"===v.contentEditable)&&(lr=v,cr=r,dr=null);break;case"focusout":dr=cr=lr=null;break;case"mousedown":ur=!0;break;case"contextmenu":case"mouseup":case"dragend":ur=!1,hr(o,n,a);break;case"selectionchange":if(or)break;case"keydown":case"keyup":hr(o,n,a)}var b;if(Cn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else In?Dn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(En&&"ko"!==n.locale&&(In||"onCompositionStart"!==w?"onCompositionEnd"===w&&In&&(b=Kt()):(Yt="value"in(Wt=a)?Wt.value:Wt.textContent,In=!0)),0<(v=iu(r,w)).length&&(w=new mn(w,e,null,n,a),o.push({event:w,listeners:v}),b?w.data=b:null!==(b=Rn(n))&&(w.data=b))),(b=kn?function(e,t){switch(e){case"compositionend":return Rn(t);case"keypress":return 32!==t.which?null:(Pn=!0,Tn);case"textInput":return(e=t.data)===Tn&&Pn?null:e;default:return null}}(e,n):function(e,t){if(In)return"compositionend"===e||!Cn&&Dn(e,t)?(e=Kt(),Xt=Yt=Wt=null,In=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return En&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=iu(r,"onBeforeInput")).length&&(v=new mn("onBeforeInput","beforeinput",null,n,a),o.push({event:v,listeners:w}),v.data=b)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=$d((a[ze]||null).action),s=r.submitter;s&&null!==(t=(t=s[ze]||null)?$d(t.formAction):s.getAttribute("formAction"))&&(i=t,s=null);var o=new an("action","action",null,r,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Od){var e=s?Wd(a,s):new FormData(a);no(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"==typeof i&&(o.preventDefault(),e=s?Wd(a,s):new FormData(a),no(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(o,e,r,n,a)}Jd(o,t)})}function au(e,t,n){return{instance:e,listener:t,currentTarget:n}}function iu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Ht(e,n))&&r.unshift(au(e,a,i)),null!=(a=Ht(e,t))&&r.push(au(e,a,i))),3===e.tag)return r;e=e.return}return[]}function su(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function ou(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Ht(n,i))&&s.unshift(au(n,c,l)):a||null!=(c=Ht(n,i))&&s.push(au(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var lu=/\r\n?/g,cu=/\u0000|\uFFFD/g;function du(e){return("string"==typeof e?e:""+e).replace(lu,"\n").replace(cu,"")}function uu(e,t){return t=du(t),du(e)===t}function hu(e,t,n,a,i,s){switch(n){case"children":"string"==typeof a?"body"===t||"textarea"===t&&""===a||_t(e,a):("number"==typeof a||"bigint"==typeof a)&&"body"!==t&&_t(e,""+a);break;case"className":lt(e,"class",a);break;case"tabIndex":lt(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":lt(e,n,a);break;case"style":kt(e,a,s);break;case"data":if("object"!==t){lt(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==a||"function"==typeof a||"symbol"==typeof a||"boolean"==typeof a){e.removeAttribute(n);break}a=Dt(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if("function"==typeof a){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof s&&("formAction"===n?("input"!==t&&hu(e,t,"name",i.name,i,null),hu(e,t,"formEncType",i.formEncType,i,null),hu(e,t,"formMethod",i.formMethod,i,null),hu(e,t,"formTarget",i.formTarget,i,null)):(hu(e,t,"encType",i.encType,i,null),hu(e,t,"method",i.method,i,null),hu(e,t,"target",i.target,i,null))),null==a||"symbol"==typeof a||"boolean"==typeof a){e.removeAttribute(n);break}a=Dt(""+a),e.setAttribute(n,a);break;case"onClick":null!=a&&(e.onclick=Rt);break;case"onScroll":null!=a&&Qd("scroll",e);break;case"onScrollEnd":null!=a&&Qd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!=typeof a||!("__html"in a))throw Error(r(61));if(null!=(n=a.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&"function"!=typeof a&&"symbol"!=typeof a;break;case"muted":e.muted=a&&"function"!=typeof a&&"symbol"!=typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"==typeof a||"boolean"==typeof a||"symbol"==typeof a){e.removeAttribute("xlink:href");break}n=Dt(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===a?e.setAttribute(n,""):!1!==a&&null!=a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":null==a||"function"==typeof a||"symbol"==typeof a||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Qd("beforetoggle",e),Qd("toggle",e),ot(e,"popover",a);break;case"xlinkActuate":ct(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":ct(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":ct(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":ct(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":ct(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":ct(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":ct(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":ct(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":ct(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":ot(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ot(e,n=Tt.get(n)||n,a)}}function pu(e,t,n,a,i,s){switch(n){case"style":kt(e,a,s);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!=typeof a||!("__html"in a))throw Error(r(61));if(null!=(n=a.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"children":"string"==typeof a?_t(e,a):("number"==typeof a||"bigint"==typeof a)&&_t(e,""+a);break;case"onScroll":null!=a&&Qd("scroll",e);break;case"onScrollEnd":null!=a&&Qd("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Rt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:tt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"==typeof(s=null!=(s=e[ze]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!=typeof a)?n in e?e[n]=a:!0===a?e.setAttribute(n,""):ot(e,n,a):("function"!=typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,i)))}}function mu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qd("error",e),Qd("load",e);var a,i=!1,s=!1;for(a in n)if(n.hasOwnProperty(a)){var o=n[a];if(null!=o)switch(a){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:hu(e,t,a,o,n,null)}}return s&&hu(e,t,"srcSet",n.srcSet,n,null),void(i&&hu(e,t,"src",n.src,n,null));case"input":Qd("invalid",e);var l=a=o=s=null,c=null,d=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(null!=u)switch(i){case"name":s=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":a=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(r(137,t));break;default:hu(e,t,i,u,n,null)}}return void yt(e,a,l,c,d,o,s,!1);case"select":for(s in Qd("invalid",e),i=o=a=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":a=l;break;case"defaultValue":o=l;break;case"multiple":i=l;default:hu(e,t,s,l,n,null)}return t=a,n=o,e.multiple=!!i,void(null!=t?wt(e,!!i,t,!1):null!=n&&wt(e,!!i,n,!0));case"textarea":for(o in Qd("invalid",e),a=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":i=l;break;case"defaultValue":s=l;break;case"children":a=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(r(91));break;default:hu(e,t,o,l,n,null)}return void St(e,i,s,a);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i;else hu(e,t,c,i,n,null);return;case"dialog":Qd("beforetoggle",e),Qd("toggle",e),Qd("cancel",e),Qd("close",e);break;case"iframe":case"object":Qd("load",e);break;case"video":case"audio":for(i=0;i<Kd.length;i++)Qd(Kd[i],e);break;case"image":Qd("error",e),Qd("load",e);break;case"details":Qd("toggle",e);break;case"embed":case"source":case"link":Qd("error",e),Qd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(i=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:hu(e,t,d,i,n,null)}return;default:if(Et(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(i=n[u])&&pu(e,t,u,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&hu(e,t,l,i,n,null))}function gu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fu=null,xu=null;function yu(e){return 9===e.nodeType?e:e.ownerDocument}function vu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function wu(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Nu=null;var Su="function"==typeof setTimeout?setTimeout:void 0,ju="function"==typeof clearTimeout?clearTimeout:void 0,_u="function"==typeof Promise?Promise:void 0,Au="function"==typeof queueMicrotask?queueMicrotask:void 0!==_u?function(e){return _u.resolve(null).then(e).catch(Cu)}:Su;function Cu(e){setTimeout(function(){throw e})}function Mu(e){return"head"===e}function ku(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===r)return e.removeChild(a),void Wh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Uu(e.ownerDocument.documentElement);else if("head"===n){Uu(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var s=i.nextSibling,o=i.nodeName;i[Ye]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=s}}else"body"===n&&Uu(e.ownerDocument.body);n=a}while(n);Wh(t)}function Eu(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Tu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Tu(n),Xe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Pu(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Iu(e.nextSibling)))return null}return e}function Du(e){return"$?"===e.data||"$~"===e.data}function Ru(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Iu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ou=null;function Bu(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Iu(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Lu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Fu(e,t,n){switch(t=yu(n),e){case"html":if(!(e=t.documentElement))throw Error(r(452));return e;case"head":if(!(e=t.head))throw Error(r(453));return e;case"body":if(!(e=t.body))throw Error(r(454));return e;default:throw Error(r(451))}}function Uu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var zu=new Map,Hu=new Set;function Gu(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Vu=R.d;R.d={f:function(){var e=Vu.f(),t=td();return e||t},r:function(e){var t=qe(e);null!==t&&5===t.tag&&"form"===t.type?ao(t):Vu.r(e)},D:function(e){Vu.D(e),Wu("dns-prefetch",e,null)},C:function(e,t){Vu.C(e,t),Wu("preconnect",e,t)},L:function(e,t,n){Vu.L(e,t,n);var r=$u;if(r&&e&&t){var a='link[rel="preload"][as="'+ft(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+ft(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+ft(n.imageSizes)+'"]')):a+='[href="'+ft(e)+'"]';var i=a;switch(t){case"style":i=Xu(e);break;case"script":i=Ju(e)}zu.has(i)||(e=d({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),zu.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Ku(i))||"script"===t&&r.querySelector(Qu(i))||(mu(t=r.createElement("link"),"link",e),Ze(t),r.head.appendChild(t)))}},m:function(e,t){Vu.m(e,t);var n=$u;if(n&&e){var r=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+ft(r)+'"][href="'+ft(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Ju(e)}if(!zu.has(i)&&(e=d({rel:"modulepreload",href:e},t),zu.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Qu(i)))return}mu(r=n.createElement("link"),"link",e),Ze(r),n.head.appendChild(r)}}},X:function(e,t){Vu.X(e,t);var n=$u;if(n&&e){var r=Qe(n).hoistableScripts,a=Ju(e),i=r.get(a);i||((i=n.querySelector(Qu(a)))||(e=d({src:e,async:!0},t),(t=zu.get(a))&&nh(e,t),Ze(i=n.createElement("script")),mu(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){Vu.S(e,t,n);var r=$u;if(r&&e){var a=Qe(r).hoistableStyles,i=Xu(e);t=t||"default";var s=a.get(i);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(Ku(i)))o.loading=5;else{e=d({rel:"stylesheet",href:e,"data-precedence":t},n),(n=zu.get(i))&&th(e,n);var l=s=r.createElement("link");Ze(l),mu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,eh(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:o},a.set(i,s)}}},M:function(e,t){Vu.M(e,t);var n=$u;if(n&&e){var r=Qe(n).hoistableScripts,a=Ju(e),i=r.get(a);i||((i=n.querySelector(Qu(a)))||(e=d({src:e,async:!0,type:"module"},t),(t=zu.get(a))&&nh(e,t),Ze(i=n.createElement("script")),mu(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var $u="undefined"==typeof document?null:document;function Wu(e,t,n){var r=$u;if(r&&"string"==typeof t&&t){var a=ft(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),Hu.has(a)||(Hu.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(mu(t=r.createElement("link"),"link",e),Ze(t),r.head.appendChild(t)))}}function Yu(e,t,n,a){var i,s,o,l,c=(c=$.current)?Gu(c):null;if(!c)throw Error(r(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Xu(n.href),(a=(n=Qe(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Xu(n.href);var d=Qe(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Ku(e)))&&!d._p&&(u.instance=d,u.state.loading=5),zu.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},zu.set(e,n),d||(i=c,s=e,o=n,l=u.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),mu(s,"link",o),Ze(s),i.head.appendChild(s))))),t&&null===a)throw Error(r(528,""));return u}if(t&&null!==a)throw Error(r(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Ju(n),(a=(n=Qe(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,e))}}function Xu(e){return'href="'+ft(e)+'"'}function Ku(e){return'link[rel="stylesheet"]['+e+"]"}function qu(e){return d({},e,{"data-precedence":e.precedence,precedence:null})}function Ju(e){return'[src="'+ft(e)+'"]'}function Qu(e){return"script[async]"+e}function Zu(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+ft(n.href)+'"]');if(a)return t.instance=a,Ze(a),a;var i=d({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ze(a=(e.ownerDocument||e).createElement("style")),mu(a,"style",i),eh(a,n.precedence,e),t.instance=a;case"stylesheet":i=Xu(n.href);var s=e.querySelector(Ku(i));if(s)return t.state.loading|=4,t.instance=s,Ze(s),s;a=qu(n),(i=zu.get(i))&&th(a,i),Ze(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),mu(s,"link",a),t.state.loading|=4,eh(s,n.precedence,e),t.instance=s;case"script":return s=Ju(n.src),(i=e.querySelector(Qu(s)))?(t.instance=i,Ze(i),i):(a=n,(i=zu.get(s))&&nh(a=d({},n),i),Ze(i=(e=e.ownerDocument||e).createElement("script")),mu(i,"link",a),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(r(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,eh(a,n.precedence,e));return t.instance}function eh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===t)i=o;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function th(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function nh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var rh=null;function ah(e,t,n){if(null===rh){var r=new Map,a=rh=new Map;a.set(n,r)}else(r=(a=rh).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Ye]||i[Ue]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var s=i.getAttribute(t)||"";s=e+s;var o=r.get(s);o?o.push(i):r.set(s,[i])}}return r}function ih(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function sh(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var oh=0;function lh(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)dh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ch=null;function dh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ch=new Map,t.forEach(uh,e),ch=null,lh.call(e))}function uh(e,t){if(!(4&t.state.loading)){var n=ch.get(e);if(n)var r=n.get(null);else{n=new Map,ch.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var s=a[i];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(a=t.instance).getAttribute("data-precedence"),(i=n.get(s)||r)===r&&n.set(null,a),n.set(s,a),this.count++,r=lh.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var hh={$$typeof:b,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function ph(e,t,n,r,a,i,s,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ee(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ee(0),this.hiddenUpdates=Ee(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function mh(e,t,n,r,a,i,s,o,l,c,d,u){return e=new ph(e,t,n,s,l,c,d,u,o),t=1,!0===i&&(t|=24),i=Ur(3,null,null,t),e.current=i,i.stateNode=e,(t=za()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},yi(i),e}function gh(e){return e?e=Lr:Lr}function fh(e,t,n,r,a,i){a=gh(a),null===r.context?r.context=a:r.pendingContext=a,(r=bi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=wi(e,r,t))&&(qc(n,0,t),Ni(n,e,t))}function xh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function yh(e,t){xh(e,t),(e=e.alternate)&&xh(e,t)}function vh(e){if(13===e.tag||31===e.tag){var t=Ir(e,67108864);null!==t&&qc(t,0,67108864),yh(e,67108864)}}function bh(e){if(13===e.tag||31===e.tag){var t=Xc(),n=Ir(e,t=Ie(t));null!==n&&qc(n,0,t),yh(e,t)}}var wh=!0;function Nh(e,t,n,r){var a=D.T;D.T=null;var i=R.p;try{R.p=2,jh(e,t,n,r)}finally{R.p=i,D.T=a}}function Sh(e,t,n,r){var a=D.T;D.T=null;var i=R.p;try{R.p=8,jh(e,t,n,r)}finally{R.p=i,D.T=a}}function jh(e,t,n,r){if(wh){var a=_h(r);if(null===a)ru(e,t,r,Ah,n),Bh(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Eh=Lh(Eh,e,t,n,r,a),!0;case"dragenter":return Th=Lh(Th,e,t,n,r,a),!0;case"mouseover":return Ph=Lh(Ph,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Dh.set(i,Lh(Dh.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Rh.set(i,Lh(Rh.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Bh(e,r),4&t&&-1<Oh.indexOf(e)){for(;null!==a;){var i=qe(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var s=_e(i.pendingLanes);if(0!==s){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-ve(s);o.entanglements[1]|=l,s&=~l}Bd(i),!(6&gc)&&(Oc=oe()+500,Ld(0))}}break;case 31:case 13:null!==(o=Ir(i,2))&&qc(o,0,2),td(),yh(i,2)}if(null===(i=_h(r))&&ru(e,t,r,Ah,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else ru(e,t,r,null,n)}}function _h(e){return Ch(e=Ot(e))}var Ah=null;function Ch(e){if(Ah=null,null!==(e=Ke(e))){var t=i(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=s(t)))return e;e=null}else if(31===n){if(null!==(e=o(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ah=e,null}function Mh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case ce:return 2;case de:return 8;case ue:case he:return 32;case pe:return 268435456;default:return 32}default:return 32}}var kh=!1,Eh=null,Th=null,Ph=null,Dh=new Map,Rh=new Map,Ih=[],Oh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bh(e,t){switch(e){case"focusin":case"focusout":Eh=null;break;case"dragenter":case"dragleave":Th=null;break;case"mouseover":case"mouseout":Ph=null;break;case"pointerover":case"pointerout":Dh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rh.delete(t.pointerId)}}function Lh(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=qe(t))&&vh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Fh(e){var t=Ke(e.target);if(null!==t){var n=i(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=s(n)))return e.blockedOn=t,void Le(e.priority,function(){bh(n)})}else if(31===t){if(null!==(t=o(n)))return e.blockedOn=t,void Le(e.priority,function(){bh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Uh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=_h(e.nativeEvent);if(null!==n)return null!==(t=qe(n))&&vh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);It=r,n.target.dispatchEvent(r),It=null,t.shift()}return!0}function zh(e,t,n){Uh(e)&&n.delete(t)}function Hh(){kh=!1,null!==Eh&&Uh(Eh)&&(Eh=null),null!==Th&&Uh(Th)&&(Th=null),null!==Ph&&Uh(Ph)&&(Ph=null),Dh.forEach(zh),Rh.forEach(zh)}function Gh(t,n){t.blockedOn===n&&(t.blockedOn=null,kh||(kh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Hh)))}var Vh=null;function $h(t){Vh!==t&&(Vh=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Vh===t&&(Vh=null);for(var e=0;e<t.length;e+=3){var n=t[e],r=t[e+1],a=t[e+2];if("function"!=typeof r){if(null===Ch(r||n))continue;break}var i=qe(n);null!==i&&(t.splice(e,3),e-=3,no(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Wh(e){function t(t){return Gh(t,e)}null!==Eh&&Gh(Eh,e),null!==Th&&Gh(Th,e),null!==Ph&&Gh(Ph,e),Dh.forEach(t),Rh.forEach(t);for(var n=0;n<Ih.length;n++){var r=Ih[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Ih.length&&null===(n=Ih[0]).blockedOn;)Fh(n),null===n.blockedOn&&Ih.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],s=a[ze]||null;if("function"==typeof i)s||$h(n);else if(s){var o=null;if(i&&i.hasAttribute("formAction")){if(a=i,s=i[ze]||null)o=s.formAction;else if(null!==Ch(a))continue}else o=s.action;"function"==typeof o?n[r+1]=o:(n.splice(r,3),r-=3),$h(n)}}}function Yh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var r=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function Xh(e){this._internalRoot=e}function Kh(e){this._internalRoot=e}Kh.prototype.render=Xh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));fh(t.current,Xc(),e,t,null,null)},Kh.prototype.unmount=Xh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fh(e.current,2,null,e,null,null),td(),t[He]=null}},Kh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Be();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ih.length&&0!==t&&t<Ih[n].priority;n++);Ih.splice(n,0,e),0===n&&Fh(e)}};var qh=t.version;if("19.2.0"!==qh)throw Error(r(527,qh,"19.2.0"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=i(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,a=t;;){var s=n.return;if(null===s)break;var o=s.alternate;if(null===o){if(null!==(a=s.return)){n=a;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return l(s),e;if(o===a)return l(s),t;o=o.sibling}throw Error(r(188))}if(n.return!==a.return)n=s,a=o;else{for(var c=!1,d=s.child;d;){if(d===n){c=!0,n=s,a=o;break}if(d===a){c=!0,a=s,n=o;break}d=d.sibling}if(!c){for(d=o.child;d;){if(d===n){c=!0,n=o,a=s;break}if(d===a){c=!0,a=o,n=s;break}d=d.sibling}if(!c)throw Error(r(189))}}if(n.alternate!==a)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?c(e):null)?null:e.stateNode};var Jh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qh.isDisabled&&Qh.supportsFiber)try{fe=Qh.inject(Jh),xe=Qh}catch(Zh){}}return jt.createRoot=function(e,t){if(!a(e))throw Error(r(299));var n=!1,i="",s=Ao,o=Co,l=Mo;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(s=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=mh(e,1,!1,null,0,n,i,null,s,o,l,Yh),e[He]=t.current,tu(e),new Xh(t)},jt.hydrateRoot=function(e,t,n){if(!a(e))throw Error(r(299));var i=!1,s="",o=Ao,l=Co,c=Mo,d=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(d=n.formState)),(t=mh(e,1,!0,t,0,i,s,d,o,l,c,Yh)).context=gh(null),n=t.current,(s=bi(i=Ie(i=Xc()))).callback=null,wi(n,s,i),n=i,t.current.lanes=n,Te(t,n),Bd(t),e[He]=t.current,tu(e),new Kh(t)},jt.version="19.2.0",jt}const kt=g((wt||(wt=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),St.exports=Mt()),St.exports)),Et=f.createContext({});function Tt(e){const t=f.useRef(null);return null===t.current&&(t.current=e()),t.current}const Pt="undefined"!=typeof window,Dt=Pt?f.useLayoutEffect:f.useEffect,Rt=f.createContext(null);function It(e,t){-1===e.indexOf(t)&&e.push(t)}function Ot(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Bt=(e,t,n)=>n>t?t:n<e?e:n;const Lt={},Ft=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Ut(e){return"object"==typeof e&&null!==e}const zt=e=>/^0[^.\s]+$/u.test(e);function Ht(e){let t;return()=>(void 0===t&&(t=e()),t)}const Gt=e=>e,Vt=(e,t)=>n=>t(e(n)),$t=(...e)=>e.reduce(Vt),Wt=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r};class Yt{constructor(){this.subscriptions=[]}add(e){return It(this.subscriptions,e),()=>Ot(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let a=0;a<r;a++){const r=this.subscriptions[a];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Xt=e=>1e3*e,Kt=e=>e/1e3;function qt(e,t){return t?e*(1e3/t):0}const Jt=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function Qt(e,t,n,r){if(e===t&&n===r)return Gt;const a=t=>function(e,t,n,r,a){let i,s,o=0;do{s=t+(n-t)/2,i=Jt(s,r,a)-e,i>0?n=s:t=s}while(Math.abs(i)>1e-7&&++o<12);return s}(t,0,1,e,n);return e=>0===e||1===e?e:Jt(a(e),t,r)}const Zt=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,en=e=>t=>1-e(1-t),tn=Qt(.33,1.53,.69,.99),nn=en(tn),rn=Zt(nn),an=e=>(e*=2)<1?.5*nn(e):.5*(2-Math.pow(2,-10*(e-1))),sn=e=>1-Math.sin(Math.acos(e)),on=en(sn),ln=Zt(sn),cn=Qt(.42,0,1,1),dn=Qt(0,0,.58,1),un=Qt(.42,0,.58,1),hn=e=>Array.isArray(e)&&"number"==typeof e[0],pn={linear:Gt,easeIn:cn,easeInOut:un,easeOut:dn,circIn:sn,circInOut:ln,circOut:on,backIn:nn,backInOut:rn,backOut:tn,anticipate:an},mn=e=>{if(hn(e)){e.length;const[t,n,r,a]=e;return Qt(t,n,r,a)}return"string"==typeof e?pn[e]:e},gn=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function fn(e,t){let n=!1,r=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,s=gn.reduce((e,t)=>(e[t]=function(e){let t=new Set,n=new Set,r=!1,a=!1;const i=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1};function o(t){i.has(t)&&(l.schedule(t),e()),t(s)}const l={schedule:(e,a=!1,s=!1)=>{const o=s&&r?t:n;return a&&i.add(e),o.has(e)||o.add(e),e},cancel:e=>{n.delete(e),i.delete(e)},process:e=>{s=e,r?a=!0:(r=!0,[t,n]=[n,t],t.forEach(o),t.clear(),r=!1,a&&(a=!1,l.process(e)))}};return l}(i),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:h,render:p,postRender:m}=s,g=()=>{const i=Lt.useManualTiming?a.timestamp:performance.now();n=!1,Lt.useManualTiming||(a.delta=r?1e3/60:Math.max(Math.min(i-a.timestamp,40),1)),a.timestamp=i,a.isProcessing=!0,o.process(a),l.process(a),c.process(a),d.process(a),u.process(a),h.process(a),p.process(a),m.process(a),a.isProcessing=!1,n&&t&&(r=!1,e(g))};return{schedule:gn.reduce((t,i)=>{const o=s[i];return t[i]=(t,i=!1,s=!1)=>(n||(n=!0,r=!0,a.isProcessing||e(g)),o.schedule(t,i,s)),t},{}),cancel:e=>{for(let t=0;t<gn.length;t++)s[gn[t]].cancel(e)},state:a,steps:s}}const{schedule:xn,cancel:yn,state:vn,steps:bn}=fn("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:Gt,!0);let wn;function Nn(){wn=void 0}const Sn={now:()=>(void 0===wn&&Sn.set(vn.isProcessing||Lt.useManualTiming?vn.timestamp:performance.now()),wn),set:e=>{wn=e,queueMicrotask(Nn)}},jn=e=>t=>"string"==typeof t&&t.startsWith(e),_n=jn("--"),An=jn("var(--"),Cn=e=>!!An(e)&&Mn.test(e.split("/*")[0].trim()),Mn=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,kn={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},En=c(l({},kn),{transform:e=>Bt(0,1,e)}),Tn=c(l({},kn),{default:1}),Pn=e=>Math.round(1e5*e)/1e5,Dn=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const Rn=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,In=(e,t)=>n=>Boolean("string"==typeof n&&Rn.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),On=(e,t,n)=>r=>{if("string"!=typeof r)return r;const[a,i,s,o]=r.match(Dn);return{[e]:parseFloat(a),[t]:parseFloat(i),[n]:parseFloat(s),alpha:void 0!==o?parseFloat(o):1}},Bn=c(l({},kn),{transform:e=>Math.round((e=>Bt(0,255,e))(e))}),Ln={test:In("rgb","red"),parse:On("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+Bn.transform(e)+", "+Bn.transform(t)+", "+Bn.transform(n)+", "+Pn(En.transform(r))+")"};const Fn={test:In("#"),parse:function(e){let t="",n="",r="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,r+=r,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:a?parseInt(a,16)/255:1}},transform:Ln.transform},Un=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),zn=Un("deg"),Hn=Un("%"),Gn=Un("px"),Vn=Un("vh"),$n=Un("vw"),Wn=(()=>c(l({},Hn),{parse:e=>Hn.parse(e)/100,transform:e=>Hn.transform(100*e)}))(),Yn={test:In("hsl","hue"),parse:On("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Hn.transform(Pn(t))+", "+Hn.transform(Pn(n))+", "+Pn(En.transform(r))+")"},Xn={test:e=>Ln.test(e)||Fn.test(e)||Yn.test(e),parse:e=>Ln.test(e)?Ln.parse(e):Yn.test(e)?Yn.parse(e):Fn.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?Ln.transform(e):Yn.transform(e),getAnimatableNone:e=>{const t=Xn.parse(e);return t.alpha=0,Xn.transform(t)}},Kn=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const qn="number",Jn="color",Qn=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zn(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},a=[];let i=0;const s=t.replace(Qn,e=>(Xn.test(e)?(r.color.push(i),a.push(Jn),n.push(Xn.parse(e))):e.startsWith("var(")?(r.var.push(i),a.push("var"),n.push(e)):(r.number.push(i),a.push(qn),n.push(parseFloat(e))),++i,"${}")).split("${}");return{values:n,split:s,indexes:r,types:a}}function er(e){return Zn(e).values}function tr(e){const{split:t,types:n}=Zn(e),r=t.length;return e=>{let a="";for(let i=0;i<r;i++)if(a+=t[i],void 0!==e[i]){const t=n[i];a+=t===qn?Pn(e[i]):t===Jn?Xn.transform(e[i]):e[i]}return a}}const nr=e=>"number"==typeof e?0:Xn.test(e)?Xn.getAnimatableNone(e):e;const rr={test:function(e){var t,n;return isNaN(e)&&"string"==typeof e&&((null==(t=e.match(Dn))?void 0:t.length)||0)+((null==(n=e.match(Kn))?void 0:n.length)||0)>0},parse:er,createTransformer:tr,getAnimatableNone:function(e){const t=er(e);return tr(e)(t.map(nr))}};function ar(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function ir(e,t){return n=>n>0?t:e}const sr=(e,t,n)=>e+(t-e)*n,or=(e,t,n)=>{const r=e*e,a=n*(t*t-r)+r;return a<0?0:Math.sqrt(a)},lr=[Fn,Ln,Yn];function cr(e){const t=(n=e,lr.find(e=>e.test(n)));var n;if(!Boolean(t))return!1;let r=t.parse(e);return t===Yn&&(r=function({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,n/=100;let a=0,i=0,s=0;if(t/=100){const r=n<.5?n*(1+t):n+t-n*t,o=2*n-r;a=ar(o,r,e+1/3),i=ar(o,r,e),s=ar(o,r,e-1/3)}else a=i=s=n;return{red:Math.round(255*a),green:Math.round(255*i),blue:Math.round(255*s),alpha:r}}(r)),r}const dr=(e,t)=>{const n=cr(e),r=cr(t);if(!n||!r)return ir(e,t);const a=l({},n);return e=>(a.red=or(n.red,r.red,e),a.green=or(n.green,r.green,e),a.blue=or(n.blue,r.blue,e),a.alpha=sr(n.alpha,r.alpha,e),Ln.transform(a))},ur=new Set(["none","hidden"]);function hr(e,t){return n=>sr(e,t,n)}function pr(e){return"number"==typeof e?hr:"string"==typeof e?Cn(e)?ir:Xn.test(e)?dr:fr:Array.isArray(e)?mr:"object"==typeof e?Xn.test(e)?dr:gr:ir}function mr(e,t){const n=[...e],r=n.length,a=e.map((e,n)=>pr(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=a[t](e);return n}}function gr(e,t){const n=l(l({},e),t),r={};for(const a in n)void 0!==e[a]&&void 0!==t[a]&&(r[a]=pr(e[a])(e[a],t[a]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const fr=(e,t)=>{const n=rr.createTransformer(t),r=Zn(e),a=Zn(t);return r.indexes.var.length===a.indexes.var.length&&r.indexes.color.length===a.indexes.color.length&&r.indexes.number.length>=a.indexes.number.length?ur.has(e)&&!a.values.length||ur.has(t)&&!r.values.length?function(e,t){return ur.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):$t(mr(function(e,t){var n;const r=[],a={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const s=t.types[i],o=e.indexes[s][a[s]],l=null!=(n=e.values[o])?n:0;r[i]=l,a[s]++}return r}(r,a),a.values),n):ir(e,t)};function xr(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return sr(e,t,n);return pr(e)(e,t)}const yr=e=>{const t=({timestamp:t})=>e(t);return{start:(e=!0)=>xn.update(t,e),stop:()=>yn(t),now:()=>vn.isProcessing?vn.timestamp:Sn.now()}},vr=(e,t,n=10)=>{let r="";const a=Math.max(Math.round(t/n),2);for(let i=0;i<a;i++)r+=Math.round(1e4*e(i/(a-1)))/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},br=2e4;function wr(e){let t=0;let n=e.next(t);for(;!n.done&&t<br;)t+=50,n=e.next(t);return t>=br?1/0:t}function Nr(e,t,n){const r=Math.max(t-5,0);return qt(n-e(r),t-r)}const Sr=100,jr=10,_r=1,Ar=0,Cr=800,Mr=.3,kr=.3,Er={granular:.01,default:2},Tr={granular:.005,default:.5},Pr=.01,Dr=10,Rr=.05,Ir=1,Or=.001;function Br({duration:e=Cr,bounce:t=Mr,velocity:n=Ar,mass:r=_r}){let a,i,s=1-t;s=Bt(Rr,Ir,s),e=Bt(Pr,Dr,Kt(e)),s<1?(a=t=>{const r=t*s,a=r*e,i=r-n,o=Fr(t,s),l=Math.exp(-a);return Or-i/o*l},i=t=>{const r=t*s*e,i=r*n+n,o=Math.pow(s,2)*Math.pow(t,2)*e,l=Math.exp(-r),c=Fr(Math.pow(t,2),s);return(-a(t)+Or>0?-1:1)*((i-o)*l)/c}):(a=t=>Math.exp(-t*e)*((t-n)*e+1)-.001,i=t=>Math.exp(-t*e)*(e*e*(n-t)));const o=function(e,t,n){let r=n;for(let a=1;a<Lr;a++)r-=e(r)/t(r);return r}(a,i,5/e);if(e=Xt(e),isNaN(o))return{stiffness:Sr,damping:jr,duration:e};{const t=Math.pow(o,2)*r;return{stiffness:t,damping:2*s*Math.sqrt(r*t),duration:e}}}const Lr=12;function Fr(e,t){return e*Math.sqrt(1-t*t)}const Ur=["duration","bounce"],zr=["stiffness","damping","mass"];function Hr(e,t){return t.some(t=>void 0!==e[t])}function Gr(e=kr,t=Mr){const n="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:a}=n;const i=n.keyframes[0],s=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:d,damping:u,mass:h,duration:p,velocity:m,isResolvedFromDuration:g}=function(e){let t=l({velocity:Ar,stiffness:Sr,damping:jr,mass:_r,isResolvedFromDuration:!1},e);if(!Hr(e,zr)&&Hr(e,Ur))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),a=r*r,i=2*Bt(.05,1,1-(e.bounce||0))*Math.sqrt(a);t=c(l({},t),{mass:_r,stiffness:a,damping:i})}else{const n=Br(e);t=c(l(l({},t),n),{mass:_r}),t.isResolvedFromDuration=!0}return t}(c(l({},n),{velocity:-Kt(n.velocity||0)})),f=m||0,x=u/(2*Math.sqrt(d*h)),y=s-i,v=Kt(Math.sqrt(d/h)),b=Math.abs(y)<5;let w;if(r||(r=b?Er.granular:Er.default),a||(a=b?Tr.granular:Tr.default),x<1){const e=Fr(v,x);w=t=>{const n=Math.exp(-x*v*t);return s-n*((f+x*v*y)/e*Math.sin(e*t)+y*Math.cos(e*t))}}else if(1===x)w=e=>s-Math.exp(-v*e)*(y+(f+v*y)*e);else{const e=v*Math.sqrt(x*x-1);w=t=>{const n=Math.exp(-x*v*t),r=Math.min(e*t,300);return s-n*((f+x*v*y)*Math.sinh(r)+e*y*Math.cosh(r))/e}}const N={calculatedDuration:g&&p||null,next:e=>{const t=w(e);if(g)o.done=e>=p;else{let n=0===e?f:0;x<1&&(n=0===e?Xt(f):Nr(w,e,t));const i=Math.abs(n)<=r,l=Math.abs(s-t)<=a;o.done=i&&l}return o.value=o.done?s:t,o},toString:()=>{const e=Math.min(wr(N),br),t=vr(t=>N.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return N}function Vr({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:s,min:o,max:l,restDelta:c=.5,restSpeed:d}){const u=e[0],h={done:!1,value:u},p=e=>void 0===o?l:void 0===l||Math.abs(o-e)<Math.abs(l-e)?o:l;let m=n*t;const g=u+m,f=void 0===s?g:s(g);f!==g&&(m=f-u);const x=e=>-m*Math.exp(-e/r),y=e=>f+x(e),v=e=>{const t=x(e),n=y(e);h.done=Math.abs(t)<=c,h.value=h.done?f:n};let b,w;const N=e=>{var t;(t=h.value,void 0!==o&&t<o||void 0!==l&&t>l)&&(b=e,w=Gr({keyframes:[h.value,p(h.value)],velocity:Nr(y,e,h.value),damping:a,stiffness:i,restDelta:c,restSpeed:d}))};return N(0),{calculatedDuration:null,next:e=>{let t=!1;return w||void 0!==b||(t=!0,v(e),N(e)),void 0!==b&&e>=b?w.next(e-b):(!t&&v(e),h)}}}function $r(e,t,{clamp:n=!0,ease:r,mixer:a}={}){const i=e.length;if(t.length,1===i)return()=>t[0];if(2===i&&t[0]===t[1])return()=>t[1];const s=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=function(e,t,n){const r=[],a=n||Lt.mix||xr,i=e.length-1;for(let s=0;s<i;s++){let n=a(e[s],e[s+1]);if(t){const e=Array.isArray(t)?t[s]||Gt:t;n=$t(e,n)}r.push(n)}return r}(t,r,a),l=o.length,c=n=>{if(s&&n<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(n<e[r+1]);r++);const a=Wt(e[r],e[r+1],n);return o[r](a)};return n?t=>c(Bt(e[0],e[i-1],t)):c}function Wr(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const a=Wt(0,t,r);e.push(sr(n,1,a))}}(t,e.length-1),t}function Yr({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const a=(e=>Array.isArray(e)&&"number"!=typeof e[0])(r)?r.map(mn):mn(r),i={done:!1,value:t[0]},s=function(e,t){return e.map(e=>e*t)}(n&&n.length===t.length?n:Wr(t),e),o=$r(s,t,{ease:Array.isArray(a)?a:(l=t,c=a,l.map(()=>c||un).splice(0,l.length-1))});var l,c;return{calculatedDuration:e,next:t=>(i.value=o(t),i.done=t>=e,i)}}Gr.applyToOptions=e=>{const t=function(e,t=100,n){const r=n(c(l({},e),{keyframes:[0,t]})),a=Math.min(wr(r),br);return{type:"keyframes",ease:e=>r.next(a*e).value/t,duration:Kt(a)}}(e,100,Gr);return e.ease=t.ease,e.duration=Xt(t.duration),e.type="keyframes",e};const Xr=e=>null!==e;function Kr(e,{repeat:t,repeatType:n="loop"},r,a=1){const i=e.filter(Xr),s=a<0||t&&"loop"!==n&&t%2==1?0:i.length-1;return s&&void 0!==r?r:i[s]}const qr={decay:Vr,inertia:Vr,tween:Yr,keyframes:Yr,spring:Gr};function Jr(e){"string"==typeof e.type&&(e.type=qr[e.type])}class Qr{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const Zr=e=>e/100;class ea extends Qr{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:n}=this.options;n&&n.updatedAt!==Sn.now()&&this.tick(Sn.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null==(t=(e=this.options).onStop)||t.call(e))},this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;Jr(e);const{type:t=Yr,repeat:n=0,repeatDelay:r=0,repeatType:a,velocity:i=0}=e;let{keyframes:s}=e;const o=t||Yr;o!==Yr&&"number"!=typeof s[0]&&(this.mixKeyframes=$t(Zr,xr(s[0],s[1])),s=[0,100]);const d=o(c(l({},e),{keyframes:s}));"mirror"===a&&(this.mirroredGenerator=o(c(l({},e),{keyframes:[...s].reverse(),velocity:-i}))),null===d.calculatedDuration&&(d.calculatedDuration=wr(d));const{calculatedDuration:u}=d;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:n,totalDuration:r,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:s,calculatedDuration:o}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:h,type:p,onUpdate:m,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const f=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?f<0:f>r;this.currentTime=Math.max(f,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let y=this.currentTime,v=n;if(d){const e=Math.min(this.currentTime,r)/s;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(n=1-n,h&&(n-=h/s)):"mirror"===u&&(v=i)),y=Bt(0,1,n)*s}const b=x?{done:!1,value:c[0]}:v.next(y);a&&(b.value=a(b.value));let{done:w}=b;x||null===o||(w=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const N=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return N&&p!==Vr&&(b.value=Kr(c,this.options,g,this.speed)),m&&m(b.value),N&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return Kt(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Kt(e)}get time(){return Kt(this.currentTime)}set time(e){var t;e=Xt(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null==(t=this.driver)||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Sn.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Kt(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:n=yr,startTime:r}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null==(t=(e=this.options).onPlay)||t.call(e);const a=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=a):null!==this.holdTime?this.startTime=a-this.holdTime:this.startTime||(this.startTime=null!=r?r:a),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Sn.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null==(t=(e=this.options).onComplete)||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null==(t=(e=this.options).onCancel)||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null==(t=this.driver)||t.stop(),e.observe(this)}}const ta=e=>180*e/Math.PI,na=e=>{const t=ta(Math.atan2(e[1],e[0]));return aa(t)},ra={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:na,rotateZ:na,skewX:e=>ta(Math.atan(e[1])),skewY:e=>ta(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},aa=e=>((e%=360)<0&&(e+=360),e),ia=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),sa=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),oa={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:ia,scaleY:sa,scale:e=>(ia(e)+sa(e))/2,rotateX:e=>aa(ta(Math.atan2(e[6],e[5]))),rotateY:e=>aa(ta(Math.atan2(-e[2],e[0]))),rotateZ:na,rotate:na,skewX:e=>ta(Math.atan(e[4])),skewY:e=>ta(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function la(e){return e.includes("scale")?1:0}function ca(e,t){if(!e||"none"===e)return la(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,a;if(n)r=oa,a=n;else{const t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=ra,a=t}if(!a)return la(t);const i=r[t],s=a[1].split(",").map(da);return"function"==typeof i?i(s):s[i]}function da(e){return parseFloat(e.trim())}const ua=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ha=(()=>new Set(ua))(),pa=e=>e===kn||e===Gn,ma=new Set(["x","y","z"]),ga=ua.filter(e=>!ma.has(e));const fa={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>ca(t,"x"),y:(e,{transform:t})=>ca(t,"y")};fa.translateX=fa.x,fa.translateY=fa.y;const xa=new Set;let ya=!1,va=!1,ba=!1;function wa(){if(va){const e=Array.from(xa).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return ga.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(([t,n])=>{var r;null==(r=e.getValue(t))||r.set(n)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}va=!1,ya=!1,xa.forEach(e=>e.complete(ba)),xa.clear()}function Na(){xa.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(va=!0)})}class Sa{constructor(e,t,n,r,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(xa.add(this),ya||(ya=!0,xn.read(Na),xn.resolveKeyframes(wa))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(null===e[0]){const a=null==r?void 0:r.get(),i=e[e.length-1];if(void 0!==a)e[0]=a;else if(n&&t){const r=n.readValue(t,i);null!=r&&(e[0]=r)}void 0===e[0]&&(e[0]=i),r&&void 0===a&&r.set(e[0])}!function(e){for(let t=1;t<e.length;t++)null!=e[t]||(e[t]=e[t-1])}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),xa.delete(this)}cancel(){"scheduled"===this.state&&(xa.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const ja=Ht(()=>void 0!==window.ScrollTimeline),_a={};function Aa(e,t){const n=Ht(e);return()=>{var e;return null!=(e=_a[t])?e:n()}}const Ca=Aa(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(bI){return!1}return!0},"linearEasing"),Ma=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,ka={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ma([0,.65,.55,1]),circOut:Ma([.55,0,1,.45]),backIn:Ma([.31,.01,.66,-.59]),backOut:Ma([.33,1.53,.69,.99])};function Ea(e,t){return e?"function"==typeof e?Ca()?vr(e,t):"ease-out":hn(e)?Ma(e):Array.isArray(e)?e.map(e=>Ea(e,t)||ka.easeOut):ka[e]:void 0}function Ta(e,t,n,{delay:r=0,duration:a=300,repeat:i=0,repeatType:s="loop",ease:o="easeOut",times:l}={},c=void 0){const d={[t]:n};l&&(d.offset=l);const u=Ea(o,a);Array.isArray(u)&&(d.easing=u);const h={delay:r,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:"reverse"===s?"alternate":"normal"};c&&(h.pseudoElement=c);return e.animate(d,h)}function Pa(e){return"function"==typeof e&&"applyToOptions"in e}class Da extends Qr{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:s,onComplete:o}=e;this.isPseudoElement=Boolean(a),this.allowFlatten=i,this.options=e,e.type;const l=function(e){var t=e,{type:n}=t,r=d(t,["type"]);return Pa(n)&&Ca()?n.applyToOptions(r):(null!=r.duration||(r.duration=300),null!=r.ease||(r.ease="easeOut"),r)}(e);this.animation=Ta(t,n,r,l,a),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const e=Kr(r,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null==o||o(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null==(t=(e=this.animation).finish)||t.call(e)}cancel(){try{this.animation.cancel()}catch(bI){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||null==(t=(e=this.animation).commitStyles)||t.call(e)}get duration(){var e,t;const n=(null==(t=null==(e=this.animation.effect)?void 0:e.getComputedTiming)?void 0:t.call(e).duration)||0;return Kt(Number(n))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Kt(e)}get time(){return Kt(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Xt(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var n;return this.allowFlatten&&(null==(n=this.animation.effect)||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&ja()?(this.animation.timeline=e,Gt):t(this)}}const Ra={anticipate:an,backInOut:rn,circInOut:ln};function Ia(e){"string"==typeof e.ease&&e.ease in Ra&&(e.ease=Ra[e.ease])}class Oa extends Da{constructor(e){Ia(e),Jr(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const n=this.options,{motionValue:r,onUpdate:a,onComplete:i,element:s}=n,o=d(n,["motionValue","onUpdate","onComplete","element"]);if(!r)return;if(void 0!==e)return void r.set(e);const u=new ea(c(l({},o),{autoplay:!1})),h=Xt(null!=(t=this.finishedTime)?t:this.time);r.setWithVelocity(u.sample(h-10).value,u.sample(h).value,10),u.stop()}}const Ba=(e,t)=>"zIndex"!==t&&(!("number"!=typeof e&&!Array.isArray(e))||!("string"!=typeof e||!rr.test(e)&&"0"!==e||e.startsWith("url(")));function La(e){e.duration=0,e.type="keyframes"}const Fa=new Set(["opacity","clipPath","filter","transform"]),Ua=Ht(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class za extends Qr{constructor(e){var t,n=e,{autoplay:r=!0,delay:a=0,type:i="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:c="loop",keyframes:u,name:h,motionValue:p,element:m}=n,g=d(n,["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"]);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null==(e=this.stopTimeline)||e.call(this)),null==(t=this.keyframeResolver)||t.cancel()},this.createdAt=Sn.now();const f=l({autoplay:r,delay:a,type:i,repeat:s,repeatDelay:o,repeatType:c,name:h,motionValue:p,element:m},g),x=(null==m?void 0:m.KeyframeResolver)||Sa;this.keyframeResolver=new x(u,(e,t,n)=>this.onKeyframesResolved(e,t,f,!n),h,p,m),null==(t=this.keyframeResolver)||t.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:a,type:i,velocity:s,delay:o,isHandoff:d,onUpdate:u}=n;this.resolvedAt=Sn.now(),function(e,t,n,r){const a=e[0];if(null===a)return!1;if("display"===t||"visibility"===t)return!0;const i=e[e.length-1],s=Ba(a,t),o=Ba(i,t);return!(!s||!o)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||Pa(n))&&r)}(e,a,i,s)||(!Lt.instantAnimations&&o||null==u||u(Kr(e,n,t)),e[0]=e[e.length-1],La(n),n.repeat=0);const h=r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,p=c(l({startTime:h,finalKeyframe:t},n),{keyframes:e}),m=!d&&function(e){var t;const{motionValue:n,name:r,repeatDelay:a,repeatType:i,damping:s,type:o}=e;if(!((null==(t=null==n?void 0:n.owner)?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return Ua()&&r&&Fa.has(r)&&("transform"!==r||!c)&&!l&&!a&&"mirror"!==i&&0!==s&&"inertia"!==o}(p)?new Oa(c(l({},p),{element:p.motionValue.owner.current})):new ea(p);m.finished.then(()=>this.notifyFinished()).catch(Gt),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||(null==(e=this.keyframeResolver)||e.resume(),ba=!0,Na(),wa(),ba=!1),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null==(e=this.keyframeResolver)||e.cancel()}}const Ha=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Ga(e,t,n=1){const[r,a]=function(e){const t=Ha.exec(e);if(!t)return[,];const[,n,r,a]=t;return[`--${null!=n?n:r}`,a]}(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const e=i.trim();return Ft(e)?parseFloat(e):e}return Cn(a)?Ga(a,t,n+1):a}function Va(e,t){var n,r;return null!=(r=null!=(n=null==e?void 0:e[t])?n:null==e?void 0:e.default)?r:e}const $a=new Set(["width","height","top","left","right","bottom",...ua]),Wa=e=>t=>t.test(e),Ya=[kn,Gn,Hn,zn,$n,Vn,{test:e=>"auto"===e,parse:e=>e}],Xa=e=>Ya.find(Wa(e));function Ka(e){return"number"==typeof e?0===e:null===e||("none"===e||"0"===e||zt(e))}const qa=new Set(["brightness","contrast","saturate","opacity"]);function Ja(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(Dn)||[];if(!r)return e;const a=n.replace(r,"");let i=qa.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+a+")"}const Qa=/\b([a-z-]*)\(.*?\)/gu,Za=c(l({},rr),{getAnimatableNone:e=>{const t=e.match(Qa);return t?t.map(Ja).join(" "):e}}),ei=c(l({},kn),{transform:Math.round}),ti=c(l({borderWidth:Gn,borderTopWidth:Gn,borderRightWidth:Gn,borderBottomWidth:Gn,borderLeftWidth:Gn,borderRadius:Gn,radius:Gn,borderTopLeftRadius:Gn,borderTopRightRadius:Gn,borderBottomRightRadius:Gn,borderBottomLeftRadius:Gn,width:Gn,maxWidth:Gn,height:Gn,maxHeight:Gn,top:Gn,right:Gn,bottom:Gn,left:Gn,padding:Gn,paddingTop:Gn,paddingRight:Gn,paddingBottom:Gn,paddingLeft:Gn,margin:Gn,marginTop:Gn,marginRight:Gn,marginBottom:Gn,marginLeft:Gn,backgroundPositionX:Gn,backgroundPositionY:Gn},{rotate:zn,rotateX:zn,rotateY:zn,rotateZ:zn,scale:Tn,scaleX:Tn,scaleY:Tn,scaleZ:Tn,skew:zn,skewX:zn,skewY:zn,distance:Gn,translateX:Gn,translateY:Gn,translateZ:Gn,x:Gn,y:Gn,z:Gn,perspective:Gn,transformPerspective:Gn,opacity:En,originX:Wn,originY:Wn,originZ:Gn}),{zIndex:ei,fillOpacity:En,strokeOpacity:En,numOctaves:ei}),ni=c(l({},ti),{color:Xn,backgroundColor:Xn,outlineColor:Xn,fill:Xn,stroke:Xn,borderColor:Xn,borderTopColor:Xn,borderRightColor:Xn,borderBottomColor:Xn,borderLeftColor:Xn,filter:Za,WebkitFilter:Za}),ri=e=>ni[e];function ai(e,t){let n=ri(e);return n!==Za&&(n=rr),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const ii=new Set(["auto","none","0"]);class si extends Sa{constructor(e,t,n,r,a){super(e,t,n,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let o=0;o<e.length;o++){let n=e[o];if("string"==typeof n&&(n=n.trim(),Cn(n))){const r=Ga(n,t.current);void 0!==r&&(e[o]=r),o===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!$a.has(n)||2!==e.length)return;const[r,a]=e,i=Xa(r),s=Xa(a);if(i!==s)if(pa(i)&&pa(s))for(let o=0;o<e.length;o++){const t=e[o];"string"==typeof t&&(e[o]=parseFloat(t))}else fa[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)(null===e[r]||Ka(e[r]))&&n.push(r);n.length&&function(e,t,n){let r,a=0;for(;a<e.length&&!r;){const t=e[a];"string"==typeof t&&!ii.has(t)&&Zn(t).values.length&&(r=e[a]),a++}if(r&&n)for(const i of t)e[i]=ai(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fa[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const i=r.length-1,s=r[i];r[i]=fa[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==s&&void 0===this.finalKeyframe&&(this.finalKeyframe=s),(null==(e=this.removedTransforms)?void 0:e.length)&&this.removedTransforms.forEach(([e,n])=>{t.getValue(e).set(n)}),this.resolveNoneKeyframes()}}const oi=(e,t)=>t&&"number"==typeof e?t.transform(e):e;function li(e){return Ut(e)&&"offsetHeight"in e}class ci{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{var t;const n=Sn.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(null==(t=this.events.change)||t.notify(this.current),this.dependents))for(const r of this.dependents)r.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=Sn.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Yt);const n=this.events[e].add(t);return"change"===e?()=>{n(),xn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null==(e=this.events.change)||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Sn.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return qt(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null==(e=this.dependents)||e.clear(),null==(t=this.events.destroy)||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function di(e,t){return new ci(e,t)}const{schedule:ui}=fn(queueMicrotask,!1),hi={x:!1,y:!1};function pi(){return hi.x||hi.y}function mi(e,t){const n=function(e,t,n){var r;if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document;const a=null!=(r=null==n?void 0:n[e])?r:t.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}(e),r=new AbortController;return[n,c(l({passive:!0},t),{signal:r.signal}),()=>r.abort()]}function gi(e){return!("touch"===e.pointerType||pi())}const fi=(e,t)=>!!t&&(e===t||fi(e,t.parentElement)),xi=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary,yi=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const vi=new WeakSet;function bi(e){return t=>{"Enter"===t.key&&e(t)}}function wi(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function Ni(e){return xi(e)&&!pi()}function Si(e,t,n={}){const[r,a,i]=mi(e,n),s=e=>{const r=e.currentTarget;if(!Ni(e))return;vi.add(r);const i=t(r,e),s=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),vi.has(r)&&vi.delete(r),Ni(e)&&"function"==typeof i&&i(e,{success:t})},o=e=>{s(e,r===window||r===document||n.useGlobalTarget||fi(r,e.target))},l=e=>{s(e,!1)};window.addEventListener("pointerup",o,a),window.addEventListener("pointercancel",l,a)};return r.forEach(e=>{var t;(n.useGlobalTarget?window:e).addEventListener("pointerdown",s,a),li(e)&&(e.addEventListener("focus",e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const r=bi(()=>{if(vi.has(n))return;wi(n,"down");const e=bi(()=>{wi(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>wi(n,"cancel"),t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)})(e,a)),t=e,yi.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),i}function ji(e){return Ut(e)&&"ownerSVGElement"in e}const _i=e=>Boolean(e&&e.getVelocity),Ai=[...Ya,Xn,rr],Ci=f.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Mi(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function ki(...e){return f.useCallback(function(...e){return t=>{let n=!1;const r=e.map(e=>{const r=Mi(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){const n=r[t];"function"==typeof n?n():Mi(e[t],null)}}}}(...e),e)}class Ei extends f.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,n=li(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Ti({children:e,isPresent:t,anchorX:n,root:r}){const a=f.useId(),i=f.useRef(null),s=f.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=f.useContext(Ci),l=ki(i,null==e?void 0:e.ref);return f.useInsertionEffect(()=>{const{width:e,height:l,top:c,left:d,right:u}=s.current;if(t||!i.current||!e||!l)return;const h="left"===n?`left: ${d}`:`right: ${u}`;i.current.dataset.motionPopId=a;const p=document.createElement("style");o&&(p.nonce=o);const m=null!=r?r:document.head;return m.appendChild(p),p.sheet&&p.sheet.insertRule(`\n          [data-motion-pop-id="${a}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${l}px !important;\n            ${h}px !important;\n            top: ${c}px !important;\n          }\n        `),()=>{m.contains(p)&&m.removeChild(p)}},[t]),Nt.jsx(Ei,{isPresent:t,childRef:i,sizeRef:s,children:f.cloneElement(e,{ref:l})})}const Pi=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:i,mode:s,anchorX:o,root:c})=>{const d=Tt(Di),u=f.useId();let h=!0,p=f.useMemo(()=>(h=!1,{id:u,initial:t,isPresent:n,custom:a,onExitComplete:e=>{d.set(e,!0);for(const t of d.values())if(!t)return;r&&r()},register:e=>(d.set(e,!1),()=>d.delete(e))}),[n,d,r]);return i&&h&&(p=l({},p)),f.useMemo(()=>{d.forEach((e,t)=>d.set(t,!1))},[n]),f.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),"popLayout"===s&&(e=Nt.jsx(Ti,{isPresent:n,anchorX:o,root:c,children:e})),Nt.jsx(Rt.Provider,{value:p,children:e})};function Di(){return new Map}function Ri(e=!0){const t=f.useContext(Rt);if(null===t)return[!0,null];const{isPresent:n,onExitComplete:r,register:a}=t,i=f.useId();f.useEffect(()=>{if(e)return a(i)},[e]);const s=f.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,s]:[!0]}const Ii=e=>e.key||"";function Oi(e){const t=[];return f.Children.forEach(e,e=>{f.isValidElement(e)&&t.push(e)}),t}const Bi=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:a=!0,mode:i="sync",propagate:s=!1,anchorX:o="left",root:l})=>{const[c,d]=Ri(s),u=f.useMemo(()=>Oi(e),[e]),h=s&&!c?[]:u.map(Ii),p=f.useRef(!0),m=f.useRef(u),g=Tt(()=>new Map),[x,y]=f.useState(u),[v,b]=f.useState(u);Dt(()=>{p.current=!1,m.current=u;for(let e=0;e<v.length;e++){const t=Ii(v[e]);h.includes(t)?g.delete(t):!0!==g.get(t)&&g.set(t,!1)}},[v,h.length,h.join("-")]);const w=[];if(u!==x){let e=[...u];for(let t=0;t<v.length;t++){const n=v[t],r=Ii(n);h.includes(r)||(e.splice(t,0,n),w.push(n))}return"wait"===i&&w.length&&(e=w),b(Oi(e)),y(u),null}const{forceRender:N}=f.useContext(Et);return Nt.jsx(Nt.Fragment,{children:v.map(e=>{const f=Ii(e),x=!(s&&!c)&&(u===v||h.includes(f));return Nt.jsx(Pi,{isPresent:x,initial:!(p.current&&!n)&&void 0,custom:t,presenceAffectsLayout:a,mode:i,root:l,onExitComplete:x?void 0:()=>{if(!g.has(f))return;g.set(f,!0);let e=!0;g.forEach(t=>{t||(e=!1)}),e&&(null==N||N(),b(m.current),s&&(null==d||d()),r&&r())},anchorX:o,children:e},f)})})},Li=f.createContext({strict:!1}),Fi={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ui={};for(const vre in Fi)Ui[vre]={isEnabled:e=>Fi[vre].some(t=>!!e[t])};const zi=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Hi(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||zi.has(e)}let Gi=e=>!Hi(e);try{"function"==typeof(Vi=require("@emotion/is-prop-valid").default)&&(Gi=e=>e.startsWith("on")?!Hi(e):Vi(e))}catch(bI){}var Vi;const $i=f.createContext({});function Wi(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function Yi(e){return"string"==typeof e||Array.isArray(e)}const Xi=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ki=["initial",...Xi];function qi(e){return Wi(e.animate)||Ki.some(t=>Yi(e[t]))}function Ji(e){return Boolean(qi(e)||e.variants)}function Qi(e){const{initial:t,animate:n}=function(e,t){if(qi(e)){const{initial:t,animate:n}=e;return{initial:!1===t||Yi(t)?t:void 0,animate:Yi(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,f.useContext($i));return f.useMemo(()=>({initial:t,animate:n}),[Zi(t),Zi(n)])}function Zi(e){return Array.isArray(e)?e.join(" "):e}function es(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ts={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e){if(!Gn.test(e))return e;e=parseFloat(e)}return`${es(e,t.target.x)}% ${es(e,t.target.y)}%`}},ns={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,a=rr.parse(e);if(a.length>5)return r;const i=rr.createTransformer(e),s="number"!=typeof a[0]?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;a[0+s]/=o,a[1+s]/=l;const c=sr(o,l,.5);return"number"==typeof a[2+s]&&(a[2+s]/=c),"number"==typeof a[3+s]&&(a[3+s]/=c),i(a)}},rs={borderRadius:c(l({},ts),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:ts,borderTopRightRadius:ts,borderBottomLeftRadius:ts,borderBottomRightRadius:ts,boxShadow:ns};function as(e,{layout:t,layoutId:n}){return ha.has(e)||e.startsWith("origin")||(t||void 0!==n)&&(!!rs[e]||"opacity"===e)}const is={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ss=ua.length;function os(e,t,n){const{style:r,vars:a,transformOrigin:i}=e;let s=!1,o=!1;for(const l in t){const e=t[l];if(ha.has(l))s=!0;else if(_n(l))a[l]=e;else{const t=oi(e,ti[l]);l.startsWith("origin")?(o=!0,i[l]=t):r[l]=t}}if(t.transform||(s||n?r.transform=function(e,t,n){let r="",a=!0;for(let i=0;i<ss;i++){const s=ua[i],o=e[s];if(void 0===o)continue;let l=!0;if(l="number"==typeof o?o===(s.startsWith("scale")?1:0):0===parseFloat(o),!l||n){const e=oi(o,ti[s]);l||(a=!1,r+=`${is[s]||s}(${e}) `),n&&(t[s]=e)}}return r=r.trim(),n?r=n(t,a?"":r):a&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:e="50%",originY:t="50%",originZ:n=0}=i;r.transformOrigin=`${e} ${t} ${n}`}}const ls=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function cs(e,t,n){for(const r in t)_i(t[r])||as(r,n)||(e[r]=t[r])}function ds(e,t){const n={};return cs(n,e.style||{},e),Object.assign(n,function({transformTemplate:e},t){return f.useMemo(()=>{const n={style:{},transform:{},transformOrigin:{},vars:{}};return os(n,t,e),Object.assign({},n.vars,n.style)},[t])}(e,t)),n}function us(e,t){const n={},r=ds(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const hs={offset:"stroke-dashoffset",array:"stroke-dasharray"},ps={offset:"strokeDashoffset",array:"strokeDasharray"};function ms(e,t,n,r,a){var i,s,o=t,{attrX:l,attrY:c,attrScale:u,pathLength:h,pathSpacing:p=1,pathOffset:m=0}=o;if(os(e,d(o,["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"]),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:g,style:f}=e;g.transform&&(f.transform=g.transform,delete g.transform),(f.transform||g.transformOrigin)&&(f.transformOrigin=null!=(i=g.transformOrigin)?i:"50% 50%",delete g.transformOrigin),f.transform&&(f.transformBox=null!=(s=null==a?void 0:a.transformBox)?s:"fill-box",delete g.transformBox),void 0!==l&&(g.x=l),void 0!==c&&(g.y=c),void 0!==u&&(g.scale=u),void 0!==h&&function(e,t,n=1,r=0,a=!0){e.pathLength=1;const i=a?hs:ps;e[i.offset]=Gn.transform(-r);const s=Gn.transform(t),o=Gn.transform(n);e[i.array]=`${s} ${o}`}(g,h,p,m,!1)}const gs=()=>c(l({},{style:{},transform:{},transformOrigin:{},vars:{}}),{attrs:{}}),fs=e=>"string"==typeof e&&"svg"===e.toLowerCase();function xs(e,t,n,r){const a=f.useMemo(()=>{const n=gs();return ms(n,t,fs(r),e.transformTemplate,e.style),c(l({},n.attrs),{style:l({},n.style)})},[t]);if(e.style){const t={};cs(t,e.style,e),a.style=l(l({},t),a.style)}return a}const ys=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function vs(e){return"string"==typeof e&&!e.includes("-")&&!!(ys.indexOf(e)>-1||/[A-Z]/u.test(e))}function bs(e,t,n,{latestValues:r},a,i=!1){const s=(vs(e)?xs:us)(t,r,a,e),o=function(e,t,n){const r={};for(const a in e)"values"===a&&"object"==typeof e.values||(Gi(a)||!0===n&&Hi(a)||!t&&!Hi(a)||e.draggable&&a.startsWith("onDrag"))&&(r[a]=e[a]);return r}(t,"string"==typeof e,i),d=e!==f.Fragment?c(l(l({},o),s),{ref:n}):{},{children:u}=t,h=f.useMemo(()=>_i(u)?u.get():u,[u]);return f.createElement(e,c(l({},d),{children:h}))}function ws(e){const t=[{},{}];return null==e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function Ns(e,t,n,r){if("function"==typeof t){const[a,i]=ws(r);t=t(void 0!==n?n:e.custom,a,i)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){const[a,i]=ws(r);t=t(void 0!==n?n:e.custom,a,i)}return t}function Ss(e){return _i(e)?e.get():e}function js(e,t,n,r){const a={},i=r(e,{});for(const d in i)a[d]=Ss(i[d]);let{initial:s,animate:o}=e;const l=qi(e),c=Ji(e);t&&c&&!l&&!1!==e.inherit&&(void 0===s&&(s=t.initial),void 0===o&&(o=t.animate));let u=!!n&&!1===n.initial;u=u||!1===s;const h=u?o:s;if(h&&"boolean"!=typeof h&&!Wi(h)){const t=Array.isArray(h)?h:[h];for(let n=0;n<t.length;n++){const r=Ns(e,t[n]);if(r){const e=r,{transitionEnd:t,transition:n}=e,i=d(e,["transitionEnd","transition"]);for(const r in i){let e=i[r];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(a[r]=e)}for(const r in t)a[r]=t[r]}}}return a}const _s=e=>(t,n)=>{const r=f.useContext($i),a=f.useContext(Rt),i=()=>function({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,a){return{latestValues:js(n,r,a,e),renderState:t()}}(e,t,r,a);return n?i():Tt(i)};function As(e,t,n){var r;const{style:a}=e,i={};for(const s in a)(_i(a[s])||t.style&&_i(t.style[s])||as(s,e)||void 0!==(null==(r=null==n?void 0:n.getValue(s))?void 0:r.liveStyle))&&(i[s]=a[s]);return i}const Cs=_s({scrapeMotionValuesFromProps:As,createRenderState:ls});function Ms(e,t,n){const r=As(e,t,n);for(const a in e)if(_i(e[a])||_i(t[a])){r[-1!==ua.indexOf(a)?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a]=e[a]}return r}const ks=_s({scrapeMotionValuesFromProps:Ms,createRenderState:gs}),Es=Symbol.for("motionComponentSymbol");function Ts(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Ps(e,t,n){return f.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&("function"==typeof n?n(r):Ts(n)&&(n.current=r))},[t])}const Ds=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Rs="data-"+Ds("framerAppearId"),Is=f.createContext({});function Os(e,t,n,r,a){var i,s;const{visualElement:o}=f.useContext($i),l=f.useContext(Li),c=f.useContext(Rt),d=f.useContext(Ci).reducedMotion,u=f.useRef(null);r=r||l.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:o,props:n,presenceContext:c,blockInitialAnimation:!!c&&!1===c.initial,reducedMotionConfig:d}));const h=u.current,p=f.useContext(Is);!h||h.projection||!a||"html"!==h.type&&"svg"!==h.type||function(e,t,n,r){const{layoutId:a,layout:i,drag:s,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Bs(e.parent)),e.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:Boolean(s)||o&&Ts(o),visualElement:e,animationType:"string"==typeof i?i:"both",initialPromotionConfig:r,crossfade:d,layoutScroll:l,layoutRoot:c})}(u.current,n,a,p);const m=f.useRef(!1);f.useInsertionEffect(()=>{h&&m.current&&h.update(n,c)});const g=n[Rs],x=f.useRef(Boolean(g)&&!(null==(i=window.MotionHandoffIsComplete)?void 0:i.call(window,g))&&(null==(s=window.MotionHasOptimisedAnimation)?void 0:s.call(window,g)));return Dt(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),x.current&&h.animationState&&h.animationState.animateChanges())}),f.useEffect(()=>{h&&(!x.current&&h.animationState&&h.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var e;null==(e=window.MotionHandoffMarkAsComplete)||e.call(window,g)}),x.current=!1),h.enteringChildren=void 0)}),h}function Bs(e){if(e)return!1!==e.options.allowProjection?e.projection:Bs(e.parent)}function Ls(e,{forwardMotionProps:t=!1}={},n,r){var a,i;n&&function(e){for(const t in e)Ui[t]=l(l({},Ui[t]),e[t])}(n);const s=vs(e)?ks:Cs;function o(n,a){let i;const o=c(l(l({},f.useContext(Ci)),n),{layoutId:Fs(n)}),{isStatic:d}=o,u=Qi(n),h=s(n,d);if(!d&&Pt){f.useContext(Li).strict;const t=function(e){const{drag:t,layout:n}=Ui;if(!t&&!n)return{};const r=l(l({},t),n);return{MeasureLayout:(null==t?void 0:t.isEnabled(e))||(null==n?void 0:n.isEnabled(e))?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(o);i=t.MeasureLayout,u.visualElement=Os(e,h,o,r,t.ProjectionNode)}return Nt.jsxs($i.Provider,{value:u,children:[i&&u.visualElement?Nt.jsx(i,l({visualElement:u.visualElement},o)):null,bs(e,n,Ps(h,u.visualElement,a),h,d,t)]})}o.displayName=`motion.${"string"==typeof e?e:`create(${null!=(i=null!=(a=e.displayName)?a:e.name)?i:""})`}`;const d=f.forwardRef(o);return d[Es]=e,d}function Fs({layoutId:e}){const t=f.useContext(Et).id;return t&&void 0!==e?t+"-"+e:e}function Us(e,t){if("undefined"==typeof Proxy)return Ls;const n=new Map,r=(n,r)=>Ls(n,r,e,t);return new Proxy((e,t)=>r(e,t),{get:(a,i)=>"create"===i?r:(n.has(i)||n.set(i,Ls(i,void 0,e,t)),n.get(i))})}function zs({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function Hs(e){return void 0===e||1===e}function Gs({scale:e,scaleX:t,scaleY:n}){return!Hs(e)||!Hs(t)||!Hs(n)}function Vs(e){return Gs(e)||$s(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function $s(e){return Ws(e.x)||Ws(e.y)}function Ws(e){return e&&"0%"!==e}function Ys(e,t,n){return n+t*(e-n)}function Xs(e,t,n,r,a){return void 0!==a&&(e=Ys(e,a,r)),Ys(e,n,r)+t}function Ks(e,t=0,n=1,r,a){e.min=Xs(e.min,t,n,r,a),e.max=Xs(e.max,t,n,r,a)}function qs(e,{x:t,y:n}){Ks(e.x,t.translate,t.scale,t.originPoint),Ks(e.y,n.translate,n.scale,n.originPoint)}const Js=.999999999999,Qs=1.0000000000001;function Zs(e,t){e.min=e.min+t,e.max=e.max+t}function eo(e,t,n,r,a=.5){Ks(e,t,n,sr(e.min,e.max,a),r)}function to(e,t){eo(e.x,t.x,t.scaleX,t.scale,t.originX),eo(e.y,t.y,t.scaleY,t.scale,t.originY)}function no(e,t){return zs(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const ro=()=>({x:{min:0,max:0},y:{min:0,max:0}}),ao={current:null},io={current:!1};const so=new WeakMap;const oo=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class lo{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:r,blockInitialAnimation:a,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Sa,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=Sn.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,xn.render(this.render,!1,!0))};const{latestValues:o,renderState:c}=i;this.latestValues=o,this.baseTarget=l({},o),this.initialValues=t.initial?l({},o):{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=s,this.blockInitialAnimation=Boolean(a),this.isControllingVariants=qi(t),this.isVariantNode=Ji(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(e&&e.current);const u=this.scrapeMotionValuesFromProps(t,{},this),{willChange:h}=u,p=d(u,["willChange"]);for(const l in p){const e=p[l];void 0!==o[l]&&_i(e)&&e.set(o[l])}}mount(e){var t;this.current=e,so.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),io.current||function(){if(io.current=!0,Pt)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ao.current=e.matches;e.addEventListener("change",t),t()}else ao.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||ao.current),null==(t=this.parent)||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),yn(this.notifyUpdate),yn(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null==(e=this.parent)||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),null!=this.enteringChildren||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=ha.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&xn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Ui){const t=Ui[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<oo.length;n++){const t=oo[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const a=t[r],i=n[r];if(_i(a))e.addValue(r,a);else if(_i(i))e.addValue(r,di(a,{owner:e}));else if(i!==a)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(a):t.hasAnimated||t.set(a)}else{const t=e.getStaticValue(r);e.addValue(r,di(void 0!==t?t:a,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=di(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!=(n=this.getBaseTargetFromProps(this.props,e))?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var a;return null!=r&&("string"==typeof r&&(Ft(r)||zt(r))?r=parseFloat(r):(a=r,!Ai.find(Wa(a))&&rr.test(t)&&(r=ai(e,t))),this.setBaseTarget(e,_i(r)?r.get():r)),_i(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let r;if("string"==typeof n||"object"==typeof n){const a=Ns(this.props,n,null==(t=this.presenceContext)?void 0:t.custom);a&&(r=a[e])}if(n&&void 0!==r)return r;const a=this.getBaseTargetFromProps(this.props,e);return void 0===a||_i(a)?void 0!==this.initialValues[e]&&void 0===r?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new Yt),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){ui.render(this.render)}}class co extends lo{constructor(){super(...arguments),this.KeyframeResolver=si}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;_i(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function uo(e,{style:t,vars:n},r,a){const i=e.style;let s;for(s in t)i[s]=t[s];for(s in null==a||a.applyProjectionStyles(i,r),n)i.setProperty(s,n[s])}class ho extends co{constructor(){super(...arguments),this.type="html",this.renderInstance=uo}readValueFromInstance(e,t){var n,r;if(ha.has(t))return(null==(n=this.projection)?void 0:n.isProjecting)?la(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return ca(n,t)})(e,t);{const n=(r=e,window.getComputedStyle(r)),a=(_n(t)?n.getPropertyValue(t):n[t])||0;return"string"==typeof a?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:t}){return no(e,t)}build(e,t,n){os(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return As(e,t,n)}}const po=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);class mo extends co{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ro}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(ha.has(t)){const e=ri(t);return e&&e.default||0}return t=po.has(t)?t:Ds(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return Ms(e,t,n)}build(e,t,n){ms(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){!function(e,t,n,r){uo(e,t,void 0,r);for(const a in t.attrs)e.setAttribute(po.has(a)?a:Ds(a),t.attrs[a])}(e,t,0,r)}mount(e){this.isSVGTag=fs(e.tagName),super.mount(e)}}const go=(e,t)=>vs(e)?new mo(t):new ho(t,{allowProjection:e!==f.Fragment});function fo(e,t,n){const r=e.getProps();return Ns(r,t,void 0!==n?n:r.custom,e)}const xo=e=>Array.isArray(e);function yo(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,di(n))}function vo(e){return xo(e)?e[e.length-1]||0:e}function bo(e,t){const n=e.getValue("willChange");if(r=n,Boolean(_i(r)&&r.add))return n.add(t);if(!n&&Lt.WillChange){const n=new Lt.WillChange("auto");e.addValue("willChange",n),n.add(t)}var r}function wo(e){return e.props[Rs]}const No=e=>null!==e;const So={type:"spring",stiffness:500,damping:25,restSpeed:10},jo={type:"keyframes",duration:.8},_o={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Ao=(e,{keyframes:t})=>t.length>2?jo:ha.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:So:_o;const Co=(e,t,n,r={},a,i)=>s=>{const o=Va(r,e)||{},u=o.delay||r.delay||0;let{elapsed:h=0}=r;h-=Xt(u);const p=c(l({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},o),{delay:-h,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{s(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:a});(function(e){var t=e,{when:n,delay:r,delayChildren:a,staggerChildren:i,staggerDirection:s,repeat:o,repeatType:l,repeatDelay:c,from:u,elapsed:h}=t,p=d(t,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"]);return!!Object.keys(p).length})(o)||Object.assign(p,Ao(e,p)),p.duration&&(p.duration=Xt(p.duration)),p.repeatDelay&&(p.repeatDelay=Xt(p.repeatDelay)),void 0!==p.from&&(p.keyframes[0]=p.from);let m=!1;if((!1===p.type||0===p.duration&&!p.repeatDelay)&&(La(p),0===p.delay&&(m=!0)),(Lt.instantAnimations||Lt.skipAnimations)&&(m=!0,La(p),p.delay=0),p.allowFlatten=!o.type&&!o.ease,m&&!i&&void 0!==t.get()){const e=function(e,{repeat:t,repeatType:n="loop"}){const r=e.filter(No);return r[t&&"loop"!==n&&t%2==1?0:r.length-1]}(p.keyframes,o);if(void 0!==e)return void xn.update(()=>{p.onUpdate(e),p.onComplete()})}return o.isSync?new ea(p):new za(p)};function Mo({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&!0!==t[n];return t[n]=!1,r}function ko(e,t,{delay:n=0,transitionOverride:r,type:a}={}){var i;let s=t,{transition:o=e.getDefaultTransition(),transitionEnd:c}=s,u=d(s,["transition","transitionEnd"]);r&&(o=r);const h=[],p=a&&e.animationState&&e.animationState.getState()[a];for(const d in u){const t=e.getValue(d,null!=(i=e.latestValues[d])?i:null),r=u[d];if(void 0===r||p&&Mo(p,d))continue;const a=l({delay:n},Va(o||{},d)),s=t.get();if(void 0!==s&&!t.isAnimating&&!Array.isArray(r)&&r===s&&!a.velocity)continue;let c=!1;if(window.MotionHandoffAnimation){const t=wo(e);if(t){const e=window.MotionHandoffAnimation(t,d,xn);null!==e&&(a.startTime=e,c=!0)}}bo(e,d),t.start(Co(d,t,r,e.shouldReduceMotion&&$a.has(d)?{type:!1}:a,e,c));const m=t.animation;m&&h.push(m)}return c&&Promise.all(h).then(()=>{xn.update(()=>{c&&function(e,t){let n=fo(e,t)||{},{transitionEnd:r={},transition:a={}}=n,i=d(n,["transitionEnd","transition"]);i=l(l({},i),r);for(const s in i)yo(e,s,vo(i[s]))}(e,c)})}),h}function Eo(e,t,n,r=0,a=1){const i=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),s=e.size,o=(s-1)*r;return"function"==typeof n?n(i,s):1===a?i*r:o-i*r}function To(e,t,n={}){var r;const a=fo(e,t,"exit"===n.type?null==(r=e.presenceContext)?void 0:r.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=a||{};n.transitionOverride&&(i=n.transitionOverride);const s=a?()=>Promise.all(ko(e,a,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(r=0)=>{const{delayChildren:a=0,staggerChildren:s,staggerDirection:o}=i;return function(e,t,n=0,r=0,a=0,i=1,s){const o=[];for(const d of e.variantChildren)d.notify("AnimationStart",t),o.push(To(d,t,c(l({},s),{delay:n+("function"==typeof r?0:r)+Eo(e.variantChildren,d,r,a,i)})).then(()=>d.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,r,a,s,o,n)}:()=>Promise.resolve(),{when:d}=i;if(d){const[e,t]="beforeChildren"===d?[s,o]:[o,s];return e().then(()=>t())}return Promise.all([s(),o(n.delay)])}function Po(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const Do=Ki.length;function Ro(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&Ro(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<Do;n++){const r=Ki[n],a=e.props[r];(Yi(a)||!1===a)&&(t[r]=a)}return t}const Io=[...Xi].reverse(),Oo=Xi.length;function Bo(e){return t=>Promise.all(t.map(({animation:t,options:n})=>function(e,t,n={}){let r;if(e.notify("AnimationStart",t),Array.isArray(t)){const a=t.map(t=>To(e,t,n));r=Promise.all(a)}else if("string"==typeof t)r=To(e,t,n);else{const a="function"==typeof t?fo(e,t,n.custom):t;r=Promise.all(ko(e,a,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}(e,t,n)))}function Lo(e){let t=Bo(e),n=zo(),r=!0;const a=t=>(n,r)=>{var a;const i=fo(e,r,"exit"===t?null==(a=e.presenceContext)?void 0:a.custom:void 0);if(i){const e=i,{transition:t,transitionEnd:r}=e,a=d(e,["transition","transitionEnd"]);n=l(l(l({},n),a),r)}return n};function i(i){const{props:s}=e,o=Ro(e.parent)||{},c=[],d=new Set;let u={},h=1/0;for(let t=0;t<Oo;t++){const p=Io[t],m=n[p],g=void 0!==s[p]?s[p]:o[p],f=Yi(g),x=p===i?m.isActive:null;!1===x&&(h=t);let y=g===o[p]&&g!==s[p]&&f;if(y&&r&&e.manuallyAnimateOnMount&&(y=!1),m.protectedKeys=l({},u),!m.isActive&&null===x||!g&&!m.prevProp||Wi(g)||"boolean"==typeof g)continue;const v=Fo(m.prevProp,g);let b=v||p===i&&m.isActive&&!y&&f||t>h&&f,w=!1;const N=Array.isArray(g)?g:[g];let S=N.reduce(a(p),{});!1===x&&(S={});const{prevResolvedValues:j={}}=m,_=l(l({},j),S),A=t=>{b=!0,d.has(t)&&(w=!0,d.delete(t)),m.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in _){const t=S[e],n=j[e];if(u.hasOwnProperty(e))continue;let r=!1;r=xo(t)&&xo(n)?!Po(t,n):t!==n,r?null!=t?A(e):d.add(e):void 0!==t&&d.has(e)?A(e):m.protectedKeys[e]=!0}m.prevProp=g,m.prevResolvedValues=S,m.isActive&&(u=l(l({},u),S)),r&&e.blockInitialAnimation&&(b=!1);const C=y&&v;b&&(!C||w)&&c.push(...N.map(t=>{const n={type:p};if("string"==typeof t&&r&&!C&&e.manuallyAnimateOnMount&&e.parent){const{parent:r}=e,a=fo(r,t);if(r.enteringChildren&&a){const{delayChildren:t}=a.transition||{};n.delay=Eo(r.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(d.size){const t={};if("boolean"!=typeof s.initial){const n=fo(e,Array.isArray(s.initial)?s.initial[0]:s.initial);n&&n.transition&&(t.transition=n.transition)}d.forEach(n=>{const r=e.getBaseTarget(n),a=e.getValue(n);a&&(a.liveStyle=!0),t[n]=null!=r?r:null}),c.push({animation:t})}let p=Boolean(c.length);return!r||!1!==s.initial&&s.initial!==s.animate||e.manuallyAnimateOnMount||(p=!1),r=!1,p?t(c):Promise.resolve()}return{animateChanges:i,setActive:function(t,r){var a;if(n[t].isActive===r)return Promise.resolve();null==(a=e.variantChildren)||a.forEach(e=>{var n;return null==(n=e.animationState)?void 0:n.setActive(t,r)}),n[t].isActive=r;const s=i(t);for(const e in n)n[e].protectedKeys={};return s},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=zo()}}}function Fo(e,t){return"string"==typeof t?t!==e:!!Array.isArray(t)&&!Po(t,e)}function Uo(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zo(){return{animate:Uo(!0),whileInView:Uo(),whileHover:Uo(),whileTap:Uo(),whileDrag:Uo(),whileFocus:Uo(),exit:Uo()}}class Ho{constructor(e){this.isMounted=!1,this.node=e}update(){}}let Go=0;const Vo={animation:{Feature:class extends Ho{constructor(e){super(e),e.animationState||(e.animationState=Lo(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Wi(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null==(e=this.unmountControls)||e.call(this)}}},exit:{Feature:class extends Ho{constructor(){super(...arguments),this.id=Go++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}};function $o(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function Wo(e){return{point:{x:e.pageX,y:e.pageY}}}function Yo(e,t,n,r){return $o(e,t,(e=>t=>xi(t)&&e(t,Wo(t)))(n),r)}function Xo(e){return e.max-e.min}function Ko(e,t,n,r=.5){e.origin=r,e.originPoint=sr(t.min,t.max,e.origin),e.scale=Xo(n)/Xo(t),e.translate=sr(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function qo(e,t,n,r){Ko(e.x,t.x,n.x,r?r.originX:void 0),Ko(e.y,t.y,n.y,r?r.originY:void 0)}function Jo(e,t,n){e.min=n.min+t.min,e.max=e.min+Xo(t)}function Qo(e,t,n){e.min=t.min-n.min,e.max=e.min+Xo(t)}function Zo(e,t,n){Qo(e.x,t.x,n.x),Qo(e.y,t.y,n.y)}function el(e){return[e("x"),e("y")]}const tl=({current:e})=>e?e.ownerDocument.defaultView:null,nl=(e,t)=>Math.abs(e-t);class rl{constructor(e,t,{transformPagePoint:n,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=sl(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=nl(e.x,t.x),r=nl(e.y,t.y);return Math.sqrt(s(n,2)+s(r,2))}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!n)return;const{point:r}=e,{timestamp:a}=vn;this.history.push(c(l({},r),{timestamp:a}));const{onStart:i,onMove:o}=this.handlers;t||(i&&i(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=al(t,this.transformPagePoint),xn.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:a}=this.handlers;if(this.dragSnapToOrigin&&a&&a(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const i=sl("pointercancel"===e.type?this.lastMoveEventInfo:al(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,i),r&&r(e,i)},!xi(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=r||window;const o=al(Wo(e),this.transformPagePoint),{point:d}=o,{timestamp:u}=vn;this.history=[c(l({},d),{timestamp:u})];const{onSessionStart:h}=t;h&&h(e,sl(o,this.history)),this.removeListeners=$t(Yo(this.contextWindow,"pointermove",this.handlePointerMove),Yo(this.contextWindow,"pointerup",this.handlePointerUp),Yo(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),yn(this.updatePoint)}}function al(e,t){return t?{point:t(e.point)}:e}function il(e,t){return{x:e.x-t.x,y:e.y-t.y}}function sl({point:e},t){return{point:e,delta:il(e,ll(t)),offset:il(e,ol(t)),velocity:cl(t,.1)}}function ol(e){return e[0]}function ll(e){return e[e.length-1]}function cl(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const a=ll(e);for(;n>=0&&(r=e[n],!(a.timestamp-r.timestamp>Xt(t)));)n--;if(!r)return{x:0,y:0};const i=Kt(a.timestamp-r.timestamp);if(0===i)return{x:0,y:0};const s={x:(a.x-r.x)/i,y:(a.y-r.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function dl(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function ul(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}const hl=.35;function pl(e,t,n){return{min:ml(e,t),max:ml(e,n)}}function ml(e,t){return"number"==typeof e?e:e[t]||0}const gl=new WeakMap;class fl{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:n}={}){const{presenceContext:r}=this.visualElement;if(r&&!1===r.isPresent)return;const{dragSnapToOrigin:a}=this.getProps();this.panSession=new rl(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Wo(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:r,onDragStart:a}=this.getProps();if(n&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(i=n)||"y"===i?hi[i]?null:(hi[i]=!0,()=>{hi[i]=!1}):hi.x||hi.y?null:(hi.x=hi.y=!0,()=>{hi.x=hi.y=!1}),!this.openDragLock))return;var i;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),el(e=>{let t=this.getAxisMotionValue(e).get()||0;if(Hn.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[e];if(r){t=Xo(r)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),a&&xn.postRender(()=>a(e,t)),bo(this.visualElement,"transform");const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:a,onDrag:i}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:s}=t;if(r&&null===this.currentDirection)return this.currentDirection=function(e,t=10){let n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(s),void(null!==this.currentDirection&&a&&a(this.currentDirection));this.updateAxis("x",t.point,s),this.updateAxis("y",t.point,s),this.visualElement.render(),i&&i(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>el(e=>{var t;return"paused"===this.getAnimationState(e)&&(null==(t=this.getAxisMotionValue(e).animation)?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:a,distanceThreshold:n,contextWindow:tl(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,r=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&xn.postRender(()=>s(n,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!xl(e,r,this.currentDirection))return;const a=this.getAxisMotionValue(e);let i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=function(e,{min:t,max:n},r){return void 0!==t&&e<t?e=r?sr(t,e,r.min):Math.max(e,t):void 0!==n&&e>n&&(e=r?sr(n,e,r.max):Math.min(e,n)),e}(i,this.constraints[e],this.elastic[e])),a.set(i)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null==(e=this.visualElement.projection)?void 0:e.layout,a=this.constraints;t&&Ts(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!r)&&function(e,{top:t,left:n,bottom:r,right:a}){return{x:dl(e.x,n,a),y:dl(e.y,t,r)}}(r.layoutBox,t),this.elastic=function(e=hl){return!1===e?e=0:!0===e&&(e=hl),{x:pl(e,"left","right"),y:pl(e,"top","bottom")}}(n),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&el(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Ts(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=function(e,t,n){const r=no(e,n),{scroll:a}=t;return a&&(Zs(r.x,a.offset.x),Zs(r.y,a.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let i=function(e,t){return{x:ul(e.x,t.x),y:ul(e.y,t.y)}}(r.layout.layoutBox,a);if(t){const e=t(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(i));this.hasMutatedConstraints=!!e,e&&(i=zs(e))}return i}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:s}=this.getProps(),o=this.constraints||{},c=el(s=>{if(!xl(s,t,this.currentDirection))return;let c=o&&o[s]||{};i&&(c={min:0,max:0});const d=r?200:1e6,u=r?40:1e7,h=l(l({type:"inertia",velocity:n?e[s]:0,bounceStiffness:d,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10},a),c);return this.startAxisValueAnimation(s,h)});return Promise.all(c).then(s)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return bo(this.visualElement,e),n.start(Co(e,n,0,t,this.visualElement,!1))}stopAnimation(){el(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){el(e=>{var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.pause()})}getAnimationState(e){var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){el(t=>{const{drag:n}=this.getProps();if(!xl(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(t);if(r&&r.layout){const{min:n,max:i}=r.layout.layoutBox[t];a.set(e[t]-sr(n,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Ts(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};el(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();r[e]=function(e,t){let n=.5;const r=Xo(e),a=Xo(t);return a>r?n=Wt(t.min,t.max-r,e.min):r>a&&(n=Wt(e.min,e.max-a,t.min)),Bt(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),el(t=>{if(!xl(t,e,null))return;const n=this.getAxisMotionValue(t),{min:a,max:i}=this.constraints[t];n.set(sr(a,i,r[t]))})}addListeners(){if(!this.visualElement.current)return;gl.set(this.visualElement,this);const e=Yo(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();Ts(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),xn.read(t);const a=$o(window,"resize",()=>this.scalePositionWithinConstraints()),i=n.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(el(t=>{const n=this.getAxisMotionValue(t);n&&(this.originPoint[t]+=e[t].translate,n.set(n.get()+e[t].translate))}),this.visualElement.render())});return()=>{a(),e(),r(),i&&i()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:i=hl,dragMomentum:s=!0}=e;return c(l({},e),{drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:a,dragElastic:i,dragMomentum:s})}}function xl(e,t,n){return!(!0!==t&&t!==e||null!==n&&n!==e)}const yl=e=>(t,n)=>{e&&xn.postRender(()=>e(t,n))};const vl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let bl=!1;class wl extends f.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:a}=e;a&&(t.group&&t.group.add(a),n&&n.register&&r&&n.register(a),bl&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions(c(l({},a.options),{onExitComplete:()=>this.safeToRemove()}))),vl.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:a}=this.props,{projection:i}=n;return i?(i.isPresent=a,bl=!0,r||e.layoutDependency!==t||void 0===t||e.isPresent!==a?i.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?i.promote():i.relegate()||xn.postRender(()=>{const e=i.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),ui.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;bl=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Nl(e){const[t,n]=Ri(),r=f.useContext(Et);return Nt.jsx(wl,c(l({},e),{layoutGroup:r,switchLayoutGroup:f.useContext(Is),isPresent:t,safeToRemove:n}))}const Sl=(e,t)=>e.depth-t.depth;class jl{constructor(){this.children=[],this.isDirty=!1}add(e){It(this.children,e),this.isDirty=!0}remove(e){Ot(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Sl),this.isDirty=!1,this.children.forEach(e)}}const _l=["TopLeft","TopRight","BottomLeft","BottomRight"],Al=_l.length,Cl=e=>"string"==typeof e?parseFloat(e):e,Ml=e=>"number"==typeof e||Gn.test(e);function kl(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const El=Pl(0,.5,on),Tl=Pl(.5,.95,Gt);function Pl(e,t,n){return r=>r<e?0:r>t?1:n(Wt(e,t,r))}function Dl(e,t){e.min=t.min,e.max=t.max}function Rl(e,t){Dl(e.x,t.x),Dl(e.y,t.y)}function Il(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Ol(e,t,n,r,a){return e=Ys(e-=t,1/n,r),void 0!==a&&(e=Ys(e,1/a,r)),e}function Bl(e,t,[n,r,a],i,s){!function(e,t=0,n=1,r=.5,a,i=e,s=e){Hn.test(t)&&(t=parseFloat(t),t=sr(s.min,s.max,t/100)-s.min);if("number"!=typeof t)return;let o=sr(i.min,i.max,r);e===i&&(o-=t),e.min=Ol(e.min,t,n,o,a),e.max=Ol(e.max,t,n,o,a)}(e,t[n],t[r],t[a],t.scale,i,s)}const Ll=["x","scaleX","originX"],Fl=["y","scaleY","originY"];function Ul(e,t,n,r){Bl(e.x,t,Ll,n?n.x:void 0,r?r.x:void 0),Bl(e.y,t,Fl,n?n.y:void 0,r?r.y:void 0)}function zl(e){return 0===e.translate&&1===e.scale}function Hl(e){return zl(e.x)&&zl(e.y)}function Gl(e,t){return e.min===t.min&&e.max===t.max}function Vl(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function $l(e,t){return Vl(e.x,t.x)&&Vl(e.y,t.y)}function Wl(e){return Xo(e.x)/Xo(e.y)}function Yl(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Xl{constructor(){this.members=[]}add(e){It(this.members,e),e.scheduleRender()}remove(e){if(Ot(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let r=t;r>=0;r--){const e=this.members[r];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Kl=["","X","Y","Z"];let ql=0;function Jl(e,t,n,r){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),r&&(r[e]=0))}function Ql(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=wo(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:r}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",xn,!(t||r))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&Ql(r)}function Zl({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:a}){return class{constructor(e={},n=(null==t?void 0:t())){this.id=ql++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(nc),this.nodes.forEach(cc),this.nodes.forEach(dc),this.nodes.forEach(rc)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=n?n.root||n:this,this.path=n?[...n.path,n]:[],this.parent=n,this.depth=n?n.depth+1:0;for(let t=0;t<this.path.length;t++)this.path[t].shouldResetTransform=!0;this.root===this&&(this.nodes=new jl)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Yt),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){const n=this.eventHandlers.get(e);n&&n.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;var n;this.isSVG=ji(t)&&!(ji(n=t)&&"svg"===n.tagName),this.instance=t;const{layoutId:r,layout:a,visualElement:i}=this.options;if(i&&!i.current&&i.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||r)&&(this.isLayoutDirty=!0),e){let n,r=0;const a=()=>this.root.updateBlockedByResize=!1;xn.read(()=>{r=window.innerWidth}),e(t,()=>{const e=window.innerWidth;e!==r&&(r=e,this.root.updateBlockedByResize=!0,n&&n(),n=function(e,t){const n=Sn.now(),r=({timestamp:a})=>{const i=a-n;i>=t&&(yn(r),e(i-t))};return xn.setup(r,!0),()=>yn(r)}(a,250),vl.hasAnimatedSinceResize&&(vl.hasAnimatedSinceResize=!1,this.nodes.forEach(lc)))})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&i&&(r||a)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:n,layout:r})=>{if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const a=this.options.transition||i.getDefaultTransition()||fc,{onLayoutAnimationStart:s,onLayoutAnimationComplete:o}=i.getProps(),d=!this.targetLayout||!$l(this.targetLayout,r),u=!t&&n;if(this.options.layoutRoot||this.resumeFrom||u||t&&(d||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const t=c(l({},Va(a,"layout")),{onPlay:s,onComplete:o});(i.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,u)}else t||lc(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),yn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(uc),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Ql(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let a=0;a<this.path.length;a++){const e=this.path[a];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(ic);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(sc);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(oc),this.nodes.forEach(ec),this.nodes.forEach(tc)):this.nodes.forEach(sc),this.clearAllSnapshots();const e=Sn.now();vn.delta=Bt(0,1e3/60,e-vn.timestamp),vn.timestamp=e,vn.isProcessing=!0,bn.update.process(vn),bn.preRender.process(vn),bn.render.process(vn),vn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ui.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(ac),this.sharedNodes.forEach(hc)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||Xo(this.snapshot.measuredBox.x)||Xo(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!a)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!Hl(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,i=r!==this.prevTransformTemplateValue;e&&this.instance&&(t||Vs(this.latestValues)||i)&&(a(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){const t=this.measurePageBox();let n=this.removeElementScroll(t);var r;return e&&(n=this.removeTransform(n)),vc((r=n).x),vc(r.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null==(e=this.scroll)?void 0:e.wasRoot)||this.path.some(wc))){const{scroll:e}=this.root;e&&(Zs(n.x,e.offset.x),Zs(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(Rl(n,e),null==(t=this.scroll)?void 0:t.wasRoot)return n;for(let r=0;r<this.path.length;r++){const t=this.path[r],{scroll:a,options:i}=t;t!==this.root&&a&&i.layoutScroll&&(a.wasRoot&&Rl(n,e),Zs(n.x,a.offset.x),Zs(n.y,a.offset.y))}return n}applyTransform(e,t=!1){const n={x:{min:0,max:0},y:{min:0,max:0}};Rl(n,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&to(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),Vs(e.latestValues)&&to(n,e.latestValues)}return Vs(this.latestValues)&&to(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};Rl(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!Vs(e.latestValues))continue;Gs(e.latestValues)&&e.updateSnapshot();const r=ro();Rl(r,e.measurePageBox()),Ul(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,r)}return Vs(this.latestValues)&&Ul(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=c(l(l({},this.options),e),{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){var t;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||(null==(t=this.parent)?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:a,layoutId:i}=this.options;if(!this.layout||!a&&!i)return;this.resolvedRelativeTargetAt=vn.timestamp;const s=this.getClosestProjectingParent();var o,l,c;(s&&this.linkedParentVersion!==s.layoutVersion&&!s.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(s&&s.layout?this.createRelativeTarget(s,this.layout.layoutBox,s.layout.layoutBox):this.removeRelativeTarget()),this.relativeTarget||this.targetDelta)&&(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,l=this.relativeTarget,c=this.relativeParent.target,Jo(o.x,l.x,c.x),Jo(o.y,l.y,c.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):Rl(this.target,this.layout.layoutBox),qs(this.target,this.targetDelta)):Rl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,s&&Boolean(s.resumingFrom)===Boolean(this.resumingFrom)&&!s.options.layoutScroll&&s.target&&1!==this.animationProgress?this.createRelativeTarget(s,this.target,s.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(this.parent&&!Gs(this.parent.latestValues)&&!$s(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(e,t,n){this.relativeParent=e,this.linkedParentVersion=e.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Zo(this.relativeTargetOrigin,t,n),Rl(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let r=!0;if((this.isProjectionDirty||(null==(e=this.parent)?void 0:e.isProjectionDirty))&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===vn.timestamp&&(r=!1),r)return;const{layout:a,layoutId:i}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!a&&!i)return;Rl(this.layoutCorrected,this.layout.layoutBox);const s=this.treeScale.x,o=this.treeScale.y;!function(e,t,n,r=!1){const a=n.length;if(!a)return;let i,s;t.x=t.y=1;for(let o=0;o<a;o++){i=n[o],s=i.projectionDelta;const{visualElement:a}=i.options;a&&a.props.style&&"contents"===a.props.style.display||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&to(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,qs(e,s)),r&&Vs(i.latestValues)&&to(e,i.latestValues))}t.x<Qs&&t.x>Js&&(t.x=1),t.y<Qs&&t.y>Js&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(Il(this.prevProjectionDelta.x,this.projectionDelta.x),Il(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),qo(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===s&&this.treeScale.y===o&&Yl(this.projectionDelta.x,this.prevProjectionDelta.x)&&Yl(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l))):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){var t;if(null==(t=this.options.visualElement)||t.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e,t=!1){const n=this.snapshot,r=n?n.latestValues:{},a=l({},this.latestValues),i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const s={x:{min:0,max:0},y:{min:0,max:0}},o=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,u=Boolean(o&&!d&&!0===this.options.crossfade&&!this.path.some(gc));let h;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;var l,c,p,m,g,f;pc(i.x,e.x,n),pc(i.y,e.y,n),this.setTargetDelta(i),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Zo(s,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,m=this.relativeTargetOrigin,g=s,f=n,mc(p.x,m.x,g.x,f),mc(p.y,m.y,g.y,f),h&&(l=this.relativeTarget,c=h,Gl(l.x,c.x)&&Gl(l.y,c.y))&&(this.isProjectionDirty=!1),h||(h={x:{min:0,max:0},y:{min:0,max:0}}),Rl(h,this.relativeTarget)),o&&(this.animationValues=a,function(e,t,n,r,a,i){var s,o,l,c;a?(e.opacity=sr(0,null!=(s=n.opacity)?s:1,El(r)),e.opacityExit=sr(null!=(o=t.opacity)?o:1,0,Tl(r))):i&&(e.opacity=sr(null!=(l=t.opacity)?l:1,null!=(c=n.opacity)?c:1,r));for(let d=0;d<Al;d++){const a=`border${_l[d]}Radius`;let i=kl(t,a),s=kl(n,a);void 0===i&&void 0===s||(i||(i=0),s||(s=0),0===i||0===s||Ml(i)===Ml(s)?(e[a]=Math.max(sr(Cl(i),Cl(s),r),0),(Hn.test(s)||Hn.test(i))&&(e[a]+="%")):e[a]=s)}(t.rotate||n.rotate)&&(e.rotate=sr(t.rotate||0,n.rotate||0,r))}(a,r,this.latestValues,n,u,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,n,r;this.notifyListeners("animationStart"),null==(t=this.currentAnimation)||t.stop(),null==(r=null==(n=this.resumingFrom)?void 0:n.currentAnimation)||r.stop(),this.pendingAnimation&&(yn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xn.update(()=>{vl.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=di(0)),this.currentAnimation=function(e,t,n){const r=_i(e)?e:di(e);return r.start(Co("",r,t,n)),r.animation}(this.motionValue,[0,1e3],c(l({},e),{velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:r,latestValues:a}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&bc(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=Xo(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const r=Xo(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}Rl(t,n),to(t,a),qo(this.projectionDeltaWithTransform,this.layoutCorrected,t,a)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Xl);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null==(e=this.getStack())?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null==(e=this.getStack())?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:n}={}){const r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const r={};n.z&&Jl("z",e,r,this.animationValues);for(let a=0;a<Kl.length;a++)Jl(`rotate${Kl[a]}`,e,r,this.animationValues),Jl(`skew${Kl[a]}`,e,r,this.animationValues);e.render();for(const a in r)e.setStaticValue(a,r[a]),this.animationValues&&(this.animationValues[a]=r[a]);e.scheduleRender()}applyProjectionStyles(e,t){var n,r;if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const a=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=Ss(null==t?void 0:t.pointerEvents)||"",void(e.transform=a?a(this.latestValues,""):"none");const i=this.getLead();if(!this.projectionDelta||!this.layout||!i.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Ss(null==t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!Vs(this.latestValues)&&(e.transform=a?a({},""):"none",this.hasProjected=!1));e.visibility="";const s=i.animationValues||i.latestValues;this.applyTransformsToTarget();let o=function(e,t,n){let r="";const a=e.x.translate/t.x,i=e.y.translate/t.y,s=(null==n?void 0:n.z)||0;if((a||i||s)&&(r=`translate3d(${a}px, ${i}px, ${s}px) `),1===t.x&&1===t.y||(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:e,rotate:t,rotateX:a,rotateY:i,skewX:s,skewY:o}=n;e&&(r=`perspective(${e}px) ${r}`),t&&(r+=`rotate(${t}deg) `),a&&(r+=`rotateX(${a}deg) `),i&&(r+=`rotateY(${i}deg) `),s&&(r+=`skewX(${s}deg) `),o&&(r+=`skewY(${o}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return 1===o&&1===l||(r+=`scale(${o}, ${l})`),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,s);a&&(o=a(s,o)),e.transform=o;const{x:l,y:c}=this.projectionDelta;e.transformOrigin=`${100*l.origin}% ${100*c.origin}% 0`,i.animationValues?e.opacity=i===this?null!=(r=null!=(n=s.opacity)?n:this.latestValues.opacity)?r:1:this.preserveOpacity?this.latestValues.opacity:s.opacityExit:e.opacity=i===this?void 0!==s.opacity?s.opacity:"":void 0!==s.opacityExit?s.opacityExit:0;for(const d in rs){if(void 0===s[d])continue;const{correct:t,applyTo:n,isCSSVariable:r}=rs[d],a="none"===o?s[d]:t(s[d],i);if(n){const t=n.length;for(let r=0;r<t;r++)e[n[r]]=a}else r?this.options.visualElement.renderState.vars[d]=a:e[d]=a}this.options.layoutId&&(e.pointerEvents=i===this?Ss(null==t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null==(t=e.currentAnimation)?void 0:t.stop()}),this.root.nodes.forEach(ic),this.root.sharedNodes.clear()}}}function ec(e){e.updateLayout()}function tc(e){var t;const n=(null==(t=e.resumeFrom)?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=e.layout,{animationType:a}=e.options,i=n.source!==e.layout.source;"size"===a?el(e=>{const r=i?n.measuredBox[e]:n.layoutBox[e],a=Xo(r);r.min=t[e].min,r.max=r.min+a}):bc(a,n.layoutBox,t)&&el(r=>{const a=i?n.measuredBox[r]:n.layoutBox[r],s=Xo(t[r]);a.max=a.min+s,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+s)});const s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};qo(s,t,n.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};i?qo(o,e.applyTransform(r,!0),n.measuredBox):qo(o,t,n.layoutBox);const l=!Hl(s);let c=!1;if(!e.resumeFrom){const r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:a,layout:i}=r;if(a&&i){const s={x:{min:0,max:0},y:{min:0,max:0}};Zo(s,n.layoutBox,a.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};Zo(o,t,i.layoutBox),$l(s,o)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=s,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:o,layoutDelta:s,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function nc(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function rc(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function ac(e){e.clearSnapshot()}function ic(e){e.clearMeasurements()}function sc(e){e.isLayoutDirty=!1}function oc(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function lc(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function cc(e){e.resolveTargetDelta()}function dc(e){e.calcProjection()}function uc(e){e.resetSkewAndRotation()}function hc(e){e.removeLeadSnapshot()}function pc(e,t,n){e.translate=sr(t.translate,0,n),e.scale=sr(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function mc(e,t,n,r){e.min=sr(t.min,n.min,r),e.max=sr(t.max,n.max,r)}function gc(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const fc={duration:.45,ease:[.4,0,.1,1]},xc=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),yc=xc("applewebkit/")&&!xc("chrome/")?Math.round:Gt;function vc(e){e.min=yc(e.min),e.max=yc(e.max)}function bc(e,t,n){return"position"===e||"preserve-aspect"===e&&(r=Wl(t),a=Wl(n),i=.2,!(Math.abs(r-a)<=i));var r,a,i}function wc(e){var t;return e!==e.root&&(null==(t=e.scroll)?void 0:t.wasRoot)}const Nc=Zl({attachResizeListener:(e,t)=>$o(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Sc={current:void 0},jc=Zl({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Sc.current){const e=new Nc({});e.mount(window),e.setOptions({layoutScroll:!0}),Sc.current=e}return Sc.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),_c={pan:{Feature:class extends Ho{constructor(){super(...arguments),this.removePointerDownListener=Gt}onPointerDown(e){this.session=new rl(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tl(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:yl(e),onStart:yl(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&xn.postRender(()=>r(e,t))}}}mount(){this.removePointerDownListener=Yo(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Ho{constructor(e){super(e),this.removeGroupControls=Gt,this.removeListeners=Gt,this.controls=new fl(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gt}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:jc,MeasureLayout:Nl}};function Ac(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);const a=r["onHover"+n];a&&xn.postRender(()=>a(t,Wo(t)))}function Cc(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);const a=r["onTap"+("End"===n?"":n)];a&&xn.postRender(()=>a(t,Wo(t)))}const Mc=new WeakMap,kc=new WeakMap,Ec=e=>{const t=Mc.get(e.target);t&&t(e)},Tc=e=>{e.forEach(Ec)};function Pc(e,t,n){const r=function(e){var t=e,{root:n}=t,r=d(t,["root"]);const a=n||document;kc.has(a)||kc.set(a,{});const i=kc.get(a),s=JSON.stringify(r);return i[s]||(i[s]=new IntersectionObserver(Tc,l({root:n},r))),i[s]}(t);return Mc.set(e,n),r.observe(e),()=>{Mc.delete(e),r.unobserve(e)}}const Dc={some:0,all:1};const Rc={inView:{Feature:class extends Ho{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:a}=e,i={root:t?t.current:void 0,rootMargin:n,threshold:"number"==typeof r?r:Dc[r]};return Pc(this.node.current,i,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,a&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),i=t?n:r;i&&i(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Ho{mount(){const{current:e}=this.node;e&&(this.unmount=Si(e,(e,t)=>(Cc(this.node,t,"Start"),(e,{success:t})=>Cc(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends Ho{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(bI){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=$t($o(this.node.current,"focus",()=>this.onFocus()),$o(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends Ho{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t,n={}){const[r,a,i]=mi(e,n),s=e=>{if(!gi(e))return;const{target:n}=e,r=t(n,e);if("function"!=typeof r||!n)return;const i=e=>{gi(e)&&(r(e),n.removeEventListener("pointerleave",i))};n.addEventListener("pointerleave",i,a)};return r.forEach(e=>{e.addEventListener("pointerenter",s,a)}),i}(e,(e,t)=>(Ac(this.node,t,"Start"),e=>Ac(this.node,e,"End"))))}unmount(){}}}},Ic={layout:{ProjectionNode:jc,MeasureLayout:Nl}},Oc=Us(l(l(l(l({},Vo),Rc),_c),Ic),go),Bc={initial:{opacity:0,y:20,scale:.98},in:{opacity:1,y:0,scale:1},out:{opacity:0,y:-20,scale:1.02}},Lc={type:"tween",ease:[.25,.46,.45,.94],duration:.25},Fc=({children:e})=>{const t=x();return Nt.jsx(Bi,{mode:"wait",initial:!1,children:Nt.jsx(Oc.div,{initial:"initial",animate:"in",exit:"out",variants:Bc,transition:Lc,className:"min-h-screen",children:e},t.pathname)})};function Uc(){const[e,t]=f.useState(null),[n,r]=f.useState(!1),a=!!(null==window?void 0:window.electronAPI);f.useEffect(()=>{a&&(window.electronAPI.onUpdateStatus(e=>{t(e),"available"!==e.status&&"ready"!==e.status||r(!0)}),window.electronAPI.onTriggerUpdateCheck(()=>{i()}))},[]);const i=()=>h(null,null,function*(){var e;if(null==(e=null==window?void 0:window.electronAPI)?void 0:e.checkForUpdate){t({status:"checking"}),r(!0);try{const e=yield window.electronAPI.checkForUpdate();e.success?e.updateAvailable||(t({status:"up-to-date"}),setTimeout(()=>r(!1),3e3)):t({status:"error",error:e.error})}catch(n){t({status:"error",error:n.message})}}});if(!a||!n||!e)return null;const s={checking:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",icon:Nt.jsx(T,{className:"animate-spin",size:20}),color:"text-blue-700 dark:text-blue-300",title:"Checking for updates..."},downloading:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",icon:Nt.jsx(E,{size:20}),color:"text-blue-700 dark:text-blue-300",title:`Downloading update... ${e.percent||0}%`},available:{bg:"bg-amber-50 dark:bg-amber-900/20",border:"border-amber-200 dark:border-amber-800",icon:Nt.jsx(M,{size:20}),color:"text-amber-700 dark:text-amber-300",title:`Update available: v${e.version}`,subtitle:"Downloading in background..."},ready:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:Nt.jsx(k,{size:20}),color:"text-green-700 dark:text-green-300",title:`Update ready: v${e.version}`,subtitle:"Restart to install",action:!0},"not-available":{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:Nt.jsx(k,{size:20}),color:"text-green-700 dark:text-green-300",title:"App is up to date",autoClose:!0},"up-to-date":{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:Nt.jsx(k,{size:20}),color:"text-green-700 dark:text-green-300",title:"App is up to date",autoClose:!0},error:{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-800",icon:Nt.jsx(M,{size:20}),color:"text-red-700 dark:text-red-300",title:"Update check failed",subtitle:e.error}},o=s[e.status]||s.error;return f.useEffect(()=>{if(o.autoClose){const e=setTimeout(()=>r(!1),3e3);return()=>clearTimeout(e)}},[e.status,o.autoClose]),Nt.jsx("div",{className:`fixed bottom-6 right-6 p-4 rounded-lg border-2 ${o.bg} ${o.border} shadow-lg z-50 max-w-sm`,children:Nt.jsxs("div",{className:"flex items-start gap-3",children:[Nt.jsx("div",{className:`flex-shrink-0 ${o.color}`,children:o.icon}),Nt.jsxs("div",{className:"flex-1 min-w-0",children:[Nt.jsx("h3",{className:`font-semibold ${o.color}`,children:o.title}),o.subtitle&&Nt.jsx("p",{className:`text-sm ${o.color} opacity-80`,children:o.subtitle}),"downloading"===e.status&&Nt.jsx("div",{className:"mt-2 w-full bg-gray-300 dark:bg-gray-700 rounded-full h-1.5",children:Nt.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all",style:{width:`${e.percent||0}%`}})}),o.action&&Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e;if(null==(e=null==window?void 0:window.electronAPI)?void 0:e.installUpdate)try{yield window.electronAPI.installUpdate()}catch(t){console.error("Install update failed:",t)}}),className:"mt-3 px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white text-sm font-semibold rounded transition",children:"Restart & Install"})]})]})})}function zc(){if("undefined"==typeof window)return"http://localhost:5000";const e="https://rmi-backend-zhdr.onrender.com";return console.log(" Using env variable API URL:",e),e}const Hc=zc();let Gc=null;function Vc(){if("undefined"==typeof window)return null;if(!Gc)try{const e=zc().replace(/^http/,"ws");console.log(" Connecting to Socket.IO:",e),Gc=ht(e,{transports:["websocket","polling"],timeout:1e4,forceNew:!0}),Gc.on("connect",()=>{console.log(" Socket connected:",Gc.id)}),Gc.on("disconnect",e=>{console.log(" Socket disconnected:",e)}),Gc.on("connect_error",e=>{console.error(" Socket connection error:",e)})}catch(e){return console.error(" Failed to initialize socket:",e),null}return Gc}const $c=f.createContext();function Wc({children:e}){const[t,n]=f.useState(null),[r,a]=f.useState(!0),[i,s]=f.useState(()=>{const e=localStorage.getItem("user");return e?JSON.parse(e):null}),[o,d]=f.useState(null);f.useEffect(()=>{if(!t)return;const e=o||(null==i?void 0:i.theme)||t.theme,n=document.documentElement;"dark"===e.mode?(n.classList.add("dark"),n.style.backgroundColor=e.darkBg,n.style.color=e.darkFont):(n.classList.remove("dark"),n.style.backgroundColor=e.lightBg,n.style.color=e.lightFont)},[t,o,i]),f.useEffect(()=>{(null==i?void 0:i.theme)&&d(i.theme)},[null==i?void 0:i._id]),f.useEffect(()=>{h(null,null,function*(){var e;try{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?45e3:3e4,t=yield pt.get(`${zc()}/api/settings`,{timeout:e});n(t.data)}catch(t){429!==(null==(e=t.response)?void 0:e.status)&&console.error(" Failed to fetch settings:",t.message),console.log(" Using default settings due to fetch failure"),n({theme:{mode:"dark",lightBg:"#ffffff",lightFont:"#000000",darkBg:"#1e1e1e",darkFont:"#ffffff"},baseSalaries:{teller:450,supervisor:600,admin:0,head_watcher:450,sub_watcher:400}})}finally{a(!1)}});const e=Vc();if(e)return e.on("settingsUpdated",e=>{console.log(" Settings updated (live):",e),n(e)}),e.on("settingsReset",e=>{console.log(" Settings reset (live):",e),n(e)}),e.on("newDayReset",e=>{console.log(" Scheduler event:",e.message)}),()=>{e.off("settingsUpdated"),e.off("settingsReset"),e.off("newDayReset")}},[]),f.useEffect(()=>{i?(localStorage.setItem("user",JSON.stringify(i)),localStorage.setItem("userName",i.name||i.username)):(localStorage.removeItem("user"),localStorage.removeItem("userName"))},[i]);return Nt.jsx($c.Provider,{value:{settings:t,updateSettings:e=>h(null,null,function*(){n(e);try{yield pt.put(`${zc()}/api/settings`,e)}catch(t){console.error(" Failed to update settings:",t)}}),loading:r,user:i,setUser:s,logout:()=>{s(null),localStorage.removeItem("token"),window.location.href="/login"},userTheme:o,updateUserTheme:e=>h(null,null,function*(){if(null==i?void 0:i._id){d(e);try{const t=localStorage.getItem("token");yield pt.put(`${zc()}/api/admin/users/${i._id}/theme`,{theme:e},{headers:{Authorization:`Bearer ${t}`}});const n=c(l({},i),{theme:e});s(n),localStorage.setItem("user",JSON.stringify(n))}catch(t){console.error(" Failed to update user theme:",t)}}})},children:e})}const Yc=f.createContext(),Xc=({children:e})=>{const[t,n]=f.useState([]),r=f.useCallback(e=>{const t=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n(n=>[...n,l({id:t},e)]),setTimeout(()=>{n(e=>e.filter(e=>e.id!==t))},4e3)},[]);return Nt.jsxs(Yc.Provider,{value:{showToast:r},children:[e,Nt.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>Nt.jsx("div",{className:"px-4 py-2 rounded-lg shadow-lg text-white transition-all duration-300 transform "+("success"===e.type?"bg-green-500":"error"===e.type?"bg-red-500":"warning"===e.type?"bg-yellow-400 text-black":"bg-blue-500"),children:e.message},e.id))})]})},Kc=()=>f.useContext(Yc),qc=f.createContext();function Jc({children:e}){const[t,n]=f.useState([]),[r,a]=f.useState(0),[i,s]=f.useState([]),[o,d]=f.useState([]),[u,p]=f.useState([]),[m,g]=f.useState([]),[x,y]=f.useState(null),[v,b]=f.useState(!1),w=f.useRef(null),N=f.useRef(null),S=f.useRef(null),j=f.useRef(0),_=(new Date).toISOString().split("T")[0],A=zc(),C=()=>{j.current=0},M=f.useCallback(()=>h(null,null,function*(){try{b(!0);const e=localStorage.getItem("token");if(!e)return console.error("No authentication token found"),void b(!1);const t=yield pt.get(`${A}/api/chicken-fight/fights/today`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&(n(t.data.fights||[]),a(t.data.fightNumber||0),S.current=(new Date).getTime())}catch(e){console.error("Error loading today's fights:",e);const t=localStorage.getItem(`chicken-fight-${_}`),r=localStorage.getItem(`chicken-fight-number-${_}`);if(t)try{n(JSON.parse(t))}catch(bI){console.error("Error parsing saved fights:",bI)}r&&a(parseInt(r)||0)}finally{b(!1)}}),[A,_]),k=f.useCallback(e=>h(null,null,function*(){var t,n,r,a;try{const t=localStorage.getItem("token");if(!t)return console.warn("No token available for recording results"),!1;console.log(" Recording results with new legs:",e);const n=yield pt.get(`${A}/api/chicken-fight/fights/today`,{headers:{Authorization:`Bearer ${t}`}});if(!n.data.success)return console.error("Failed to fetch current game data"),!1;const r=(n.data.game||{}).entryResults||[];console.log(" Existing results:",r),console.log(" New leg results:",e);const a=r.map(t=>{const n=e.find(e=>e.entryId===t.entryId);return n?c(l({},t),{legResults:[...t.legResults||[],...n.legResults||[]]}):t});for(const s of e)a.find(e=>e.entryId===s.entryId)||a.push(s);console.log(" Merged results:",a);const i=yield pt.put(`${A}/api/chicken-fight/game/results`,{gameDate:_,entryResults:a},{headers:{Authorization:`Bearer ${t}`}});return i.data.success?(console.log(" Results recorded to server successfully"),S.current=(new Date).getTime(),yield M(),!0):(console.error(" Server returned error:",i.data.message),!1)}catch(i){return console.error(" Error recording results:",i),401===(null==(t=i.response)?void 0:t.status)?console.error(" Authentication failed - token may be expired"):500===(null==(n=i.response)?void 0:n.status)?console.error(" Server error:",null==(a=null==(r=i.response)?void 0:r.data)?void 0:a.message):"ECONNABORTED"===i.code&&console.error(" Request timeout - server may be slow"),!1}}),[A,_,M]),E=f.useCallback(()=>h(null,null,function*(){try{const e=localStorage.getItem("token");if(!e)return console.warn("No token available for saving fights"),localStorage.setItem(`chicken-fight-${_}`,JSON.stringify(t)),void localStorage.setItem(`chicken-fight-number-${_}`,r.toString());(yield pt.post(`${A}/api/chicken-fight/fights/save`,{fights:t,fightNumber:r},{headers:{Authorization:`Bearer ${e}`}})).data.success&&(console.log(" Fights saved to server"),S.current=(new Date).getTime(),w.current&&w.current.connected&&(w.current.emit("fightsUpdated",{gameDate:_,fights:t,fightNumber:r}),console.log(" Socket event emitted to other clients"))),localStorage.setItem(`chicken-fight-${_}`,JSON.stringify(t)),localStorage.setItem(`chicken-fight-number-${_}`,r.toString())}catch(e){console.error("Error saving fights to backend:",e),localStorage.setItem(`chicken-fight-${_}`,JSON.stringify(t)),localStorage.setItem(`chicken-fight-number-${_}`,r.toString())}}),[t,r,_,A]),T=f.useCallback(()=>h(null,null,function*(){try{const e=localStorage.getItem("token");if(!e)return;const t=yield pt.get(`${A}/api/chicken-fight/entries`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&s(t.data.entries||[])}catch(e){console.error("Error loading entries:",e)}}),[A]),P=f.useCallback(()=>h(null,null,function*(){try{const e=localStorage.getItem("token");if(!e)return;const t=yield pt.get(`${A}/api/chicken-fight-registration/registrations?gameDate=${_}`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&d(t.data.registrations||[])}catch(e){console.error("Error loading registrations:",e)}}),[A,_]),D=f.useCallback(()=>h(null,null,function*(){var e,i,s,o,l;try{const e=localStorage.getItem("token");if(!e)return void console.warn("No auth token found for chicken fight sync");const i=yield pt.get(`${A}/api/chicken-fight/fights/today`,{headers:{Authorization:`Bearer ${e}`},timeout:1e4});if(i.data.success){C();const e=i.data.fights||[],s=i.data.fightNumber||0;JSON.stringify(e)===JSON.stringify(t)&&s===r||(console.log(" Syncing chicken fight data from server..."),n(e),a(s),S.current=(new Date).getTime())}}catch(c){429===(null==(e=c.response)?void 0:e.status)?(console.warn(" Rate limited - backing off requests"),N.current&&clearInterval(N.current),(yield h(null,null,function*(){return j.current<3&&(j.current++,console.log(`Retry ${j.current}/3`),!0)}))&&setTimeout(R,1e3*Math.pow(2,j.current))):401===(null==(i=c.response)?void 0:i.status)?(console.warn(" Auth token issue for chicken fight sync"),C()):500===(null==(s=c.response)?void 0:s.status)?(console.error(" Server error:",null==(l=null==(o=c.response)?void 0:o.data)?void 0:l.message),C()):"ECONNABORTED"===c.code?console.warn(" Request timeout - checking connectivity"):(console.debug("Sync check issue:",c.message),C())}}),[A,t,r]),R=f.useCallback(()=>{N.current&&clearInterval(N.current),document.hidden||(N.current=setInterval(()=>{D()},5e3))},[D]);f.useEffect(()=>{const e=A.replace("/api","");return w.current=ht(e,{namespace:"/chicken-fight",reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5,transports:["websocket","polling"],withCredentials:!0}),w.current.on("connect",()=>{console.log(" Connected to Chicken Fight socket"),w.current.emit("joinTodaysFights",{gameDate:_})}),w.current.on("disconnect",()=>{console.log(" Disconnected from Chicken Fight socket")}),w.current.on("connect_error",e=>{"timeout"!==e.message&&(console.error(" Socket.IO Connection Error:",e.message),console.error("Error details:",e))}),w.current.on("error",e=>{console.error(" Socket.IO Error:",e)}),w.current.on("fightsUpdated",e=>{console.log(" Fights updated via socket:",e),n(e.fights),a(e.fightNumber),C()}),w.current.on("resultsRecorded",e=>{console.log(" Results recorded via socket:",e),M(),C()}),w.current.on("entriesUpdated",e=>{console.log(" Entries updated via socket:",e),T(),C()}),w.current.on("registrationsUpdated",e=>{console.log(" Registrations updated via socket:",e),P(),C()}),()=>{w.current&&w.current.disconnect(),N.current&&clearInterval(N.current)}},[_,A,M,T,P,R]),f.useEffect(()=>{if(0===t.length&&0===r)return;const e=setTimeout(()=>{console.log(" Auto-saving fights..."),E()},1e3);return()=>clearTimeout(e)},[t,r,E]),f.useEffect(()=>{const e=()=>{document.hidden?(console.log(" Page hidden - pausing polling"),N.current&&(clearInterval(N.current),N.current=null)):(console.log(" Page visible - resuming polling"),R())};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[R]);const I={fights:t,setFights:n,fightNumber:r,setFightNumber:a,entries:i,setEntries:s,registrations:o,setRegistrations:d,historyDates:u,setHistoryDates:p,historyFights:m,setHistoryFights:g,selectedHistoryDate:x,setSelectedHistoryDate:y,today:_,syncing:v,loadHistoryDates:()=>{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);if(n&&n.startsWith("chicken-fight-")&&!n.includes("number")){const t=n.replace("chicken-fight-","");t===_||e.includes(t)||e.push(t)}}p(e.sort().reverse())},loadHistoryForDate:e=>h(null,null,function*(){try{const t=localStorage.getItem("token");if(!t){console.warn("No token available for loading history");const t=localStorage.getItem(`chicken-fight-${e}`);if(t)try{g(JSON.parse(t)),y(e)}catch(bI){console.error("Error parsing history fights:",bI)}return}const n=yield pt.get(`${A}/api/chicken-fight/fights/${e}`,{headers:{Authorization:`Bearer ${t}`}});if(n.data.success)return g(n.data.fights||[]),void y(e)}catch(n){console.error("Error loading history fights from backend:",n)}const t=localStorage.getItem(`chicken-fight-${e}`);if(t)try{g(JSON.parse(t)),y(e)}catch(bI){console.error("Error parsing history fights:",bI)}}),resetToday:()=>{n([]),a(0),d([]),localStorage.removeItem(`chicken-fight-${_}`),localStorage.removeItem(`chicken-fight-number-${_}`),E()},addFight:e=>{const i=[...t,e];n(i),a(r+1)},updateFight:(e,r)=>{const a=[...t];a[e]=r,n(a)},removeFight:e=>{const r=t.filter((t,n)=>n!==e);n(r)},loadTodaysFights:M,checkForUpdates:D,recordEntryResults:k};return Nt.jsx(qc.Provider,{value:I,children:e})}function Qc(){var e;const t=zc(),{user:n,settings:r}=f.useContext($c),a="dark"===(null==(e=null==r?void 0:r.theme)?void 0:e.mode),[i,s]=f.useState([]),[o,l]=f.useState(""),[c,d]=f.useState(!1),[u,p]=f.useState(0),[m,g]=f.useState([]),[x,y]=f.useState(null),[v,b]=f.useState(null),w=f.useRef(null),N=f.useRef(null),S=f.useRef(null),j=f.useRef(null);f.useEffect(()=>{(null==n?void 0:n._id)&&console.log(" Chat socket disabled - Socket.IO not available on backend")},[null==n?void 0:n._id]),f.useEffect(()=>{if(!n)return;h(null,null,function*(){try{const e=x?{userId:n._id,receiverId:x._id}:{},r=yield pt.get(`${t}/api/chat`,{params:e});s(r.data.messages||[]),_()}catch(bI){s([])}})},[n,x]),f.useEffect(()=>{const e=e=>{c&&w.current&&!w.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[c]);const _=()=>{N.current&&requestAnimationFrame(()=>{N.current.scrollIntoView({behavior:"smooth",block:"end"})})};f.useEffect(_,[i]);const A=f.useMemo(()=>{const e={};return i.forEach(t=>{const n=(e=>{const t=new Date(e),n=new Date;if(t.toDateString()===n.toDateString())return"Today";const r=new Date;return r.setDate(n.getDate()-1),t.toDateString()===r.toDateString()?"Yesterday":t.toLocaleDateString([],{month:"short",day:"numeric"})})(t.createdAt);e[n]||(e[n]=[]),e[n].push(t)}),e},[i]);f.useEffect(()=>{if(!c||!x)return;i.filter(e=>!e.seen&&e.receiverId===n._id).forEach(e=>{})},[c,i,x]);const C=e=>m.some(t=>t._id===e);return Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("audio",{ref:S,src:"/sounds/notification.mp3",preload:"auto",onError:e=>console.warn("Audio not loaded:",e.target.error)}),!c&&Nt.jsxs("button",{onClick:()=>{d(!0),p(0)},className:"!fixed !bottom-6 !right-6 z-[9999] bg-indigo-600 text-white p-4 rounded-full shadow-lg hover:bg-indigo-700 transition relative",children:[Nt.jsx(P,{className:"w-6 h-6"}),u>0&&Nt.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-xs px-1.5 py-0.5 rounded-full text-white font-semibold shadow",children:u})]}),c&&Nt.jsxs("div",{ref:w,className:`!fixed !bottom-20 !right-6 z-[9999] w-80 h-[470px] rounded-2xl shadow-2xl border backdrop-blur-lg ${a?"bg-gray-900/90 border-gray-700 text-gray-100":"bg-white/90 border-gray-300 text-gray-900"} flex flex-col`,children:[Nt.jsxs("div",{className:"flex flex-col p-3 rounded-t-2xl "+(a?"bg-gray-800":"bg-indigo-600 text-white"),children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("span",{className:"font-semibold tracking-wide flex items-center gap-2",children:[""," ",x?Nt.jsxs(Nt.Fragment,{children:["Chat with ",x.name,Nt.jsx(D,{size:10,className:C(x._id)?"text-green-400":"text-gray-400",fill:C(x._id)?"green":"gray"}),Nt.jsx("span",{className:"text-xs opacity-80",children:C(x._id)?"Online":"Offline"})]}):"Group Chat"]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[("admin"===n.role||"super_admin"===n.role)&&Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(("admin"===n.role||"super_admin"===n.role)&&confirm(" Delete all messages?"))try{yield pt.delete(`${t}/api/chat`),s([])}catch(e){console.error(" Delete failed:",e)}}),title:"Delete all",children:Nt.jsx(R,{size:18})}),Nt.jsx("button",{onClick:()=>d(!1),className:"font-bold hover:opacity-80",children:""})]})]}),Nt.jsxs("select",{value:(null==x?void 0:x._id)||"",onChange:e=>{const t=e.target.value,n=m.find(e=>e._id===t);y(n||null)},className:"mt-2 text-sm rounded-lg px-2 py-1 border "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white/25 text-white"),children:[Nt.jsx("option",{value:"",children:"Group Chat (All)"}),m.map(e=>Nt.jsxs("option",{value:e._id,children:[e.name," (",e.role,") "]},e._id))]})]}),Nt.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-4",children:[Object.keys(A).map(e=>Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-center text-xs mb-2 opacity-70 italic",children:e}),A[e].map(e=>{return Nt.jsx("div",{className:"flex "+(e.senderId===n._id?"justify-end":"justify-start"),children:Nt.jsxs("div",{className:"px-3 py-2 rounded-2xl max-w-[75%] break-words whitespace-pre-wrap "+(e.senderId===n._id?"bg-indigo-600 text-white":a?"bg-gray-700 text-gray-100":"bg-gray-200 text-gray-900"),children:[Nt.jsxs("p",{className:"text-xs opacity-70 mb-1",children:[e.senderName," (",e.role,")"]}),Nt.jsx("p",{className:"text-sm leading-snug",children:e.text}),Nt.jsxs("div",{className:"flex justify-between items-center mt-1 text-[10px] opacity-80",children:[Nt.jsxs("span",{children:[" ",(t=e.createdAt,new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))]}),e.senderId===n._id&&Nt.jsx("span",{className:"flex items-center gap-1",children:e.seen?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(I,{size:12,className:"text-blue-400"}),"Seen"]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(O,{size:12,className:"text-gray-300"}),"Sent"]})})]})]})},e._id);var t})]},e)),v&&Nt.jsxs("div",{className:"text-xs italic mt-1 "+(a?"text-white":"text-black"),children:[" ",v," is typing..."]}),Nt.jsx("div",{ref:N})]}),Nt.jsxs("form",{onSubmit:e=>h(null,null,function*(){if(e.preventDefault(),!o.trim())return;const r={_id:Date.now().toString(),senderId:n._id,senderName:n.name||"You",role:n.role||"user",receiverId:(null==x?void 0:x._id)||null,text:o.trim(),createdAt:new Date,seen:!1};try{yield pt.post(`${t}/api/chat`,r),s(e=>[...e,r]),l(""),_()}catch(a){console.error(" Send failed:",a)}}),className:"p-3 border-t flex gap-2",children:[Nt.jsx("textarea",{ref:j,value:o,onChange:e=>{l(e.target.value);const t=j.current;t&&(t.style.height="auto",t.style.height=`${t.scrollHeight}px`)},rows:1,placeholder:x?`Message ${x.name}...`:"Type message...",className:"flex-1 resize-none overflow-hidden px-3 py-2 rounded-lg border focus:ring-2 focus:ring-indigo-500 "+(a?"bg-gray-800 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-black placeholder-gray-500")}),Nt.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:Nt.jsx(B,{className:"w-4 h-4"})})]})]})]})}const Zc={super_admin:[{to:"/super_admin/dashboard",icon:Nt.jsx(F,{size:18}),text:"Dashboard"},{to:"/super_admin/manage-sidebars",icon:Nt.jsx(L,{size:18}),text:"Sidebar Control"}],admin:[{to:"/admin/dashboard",icon:Nt.jsx(F,{size:18}),text:"Dashboard"},{to:"/admin/supervisor-report",icon:Nt.jsx(U,{size:18}),text:"Supervisor Reports"},{to:"/admin/teller-reports",icon:Nt.jsx(z,{size:18}),text:"Teller Reports"},{to:"/admin/teller-reports/viewer",icon:Nt.jsx(H,{size:18}),text:"Reports Viewer"},{to:"/admin/teller-management",icon:Nt.jsx(U,{size:18}),text:"Teller Management"}],supervisor:[{to:"/supervisor/dashboard",icon:Nt.jsx(F,{size:18}),text:"Dashboard"}],teller:[{to:"/teller/dashboard",icon:Nt.jsx(F,{size:18}),text:"Dashboard"}]};function ed(){const[e,t]=f.useState(Zc),[n,r]=f.useState("admin"),[a,i]=f.useState(""),[s,o]=f.useState("");return Nt.jsxs("div",{className:"max-w-2xl mx-auto p-8",children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Sidebar Control (Super Admin)"}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"font-semibold mr-2",children:"Role:"}),Nt.jsx("select",{value:n,onChange:e=>r(e.target.value),className:"border rounded px-2 py-1",children:Object.keys(e).map(e=>Nt.jsx("option",{value:e,children:e},e))})]}),Nt.jsx("ul",{className:"mb-4",children:e[n].map((e,r)=>Nt.jsxs("li",{className:"flex items-center gap-2 mb-2",children:[Nt.jsx("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:e.to}),Nt.jsx("span",{className:"font-semibold",children:e.text}),Nt.jsx("button",{onClick:()=>(e=>{t(t=>c(l({},t),{[n]:t[n].filter((t,n)=>n!==e)}))})(r),className:"ml-2 px-2 py-1 text-xs bg-red-100 text-red-700 rounded",children:"Remove"})]},e.to+r))}),Nt.jsxs("div",{className:"flex gap-2 mb-4",children:[Nt.jsx("input",{value:a,onChange:e=>i(e.target.value),placeholder:"Link Text",className:"border rounded px-2 py-1"}),Nt.jsx("input",{value:s,onChange:e=>o(e.target.value),placeholder:"Path (e.g. /admin/new)",className:"border rounded px-2 py-1"}),Nt.jsx("button",{onClick:()=>{a&&s&&(t(e=>c(l({},e),{[n]:[...e[n],{to:s,icon:Nt.jsx(L,{size:18}),text:a}]})),i(""),o(""))},className:"px-3 py-1 bg-green-600 text-white rounded",children:"Add"})]}),Nt.jsx("p",{className:"text-xs text-gray-500",children:"Note: This is a demo UI. To persist changes, connect to backend or settings storage."})]})}function td({initialImage:e,onClose:t,onSaved:n,minWidth:r=128,minHeight:a=128}){const i=f.useRef(null),s=f.useRef(null),[o,c]=f.useState({x:0,y:0}),[d,u]=f.useState(!1),[p,m]=f.useState(null),[g,x]=f.useState(1),[y,v]=f.useState(!1),[b,w]=f.useState(!1),N=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),S=e=>{var t,n,r,a,i,s;u(!0),m({x:null!=(r=e.clientX)?r:null==(n=null==(t=e.touches)?void 0:t[0])?void 0:n.clientX,y:null!=(s=e.clientY)?s:null==(i=null==(a=e.touches)?void 0:a[0])?void 0:i.clientY,orig:l({},o)})},j=e=>{var t,n,r,a,i,s;if(!d||!p)return;const o=null!=(r=e.clientX)?r:null==(n=null==(t=e.touches)?void 0:t[0])?void 0:n.clientX,l=null!=(s=e.clientY)?s:null==(i=null==(a=e.touches)?void 0:a[0])?void 0:i.clientY,u=o-p.x,h=l-p.y;c({x:p.orig.x+u,y:p.orig.y+h})},_=()=>{u(!1),m(null)};f.useEffect(()=>(window.addEventListener("mouseup",_),window.addEventListener("touchend",_),()=>{window.removeEventListener("mouseup",_),window.removeEventListener("touchend",_)}),[]),f.useEffect(()=>{if(e){if(!e.startsWith("data:image/"))return console.error("Invalid data URL format"),void w(!0);const t=e.indexOf(",");if(-1===t||t>=e.length-10)return console.error("Data URL appears to be truncated or corrupted"),void w(!0);if(N){const t=new Image;return t.onload=()=>w(!1),t.onerror=()=>{console.error("Image failed to load on mobile device"),w(!0)},void(t.src=e)}const n=new Image;n.onload=()=>w(!1),n.onerror=()=>{console.error("Image failed to load in AvatarEditor:",e.substring(0,50)+"..."),w(!0)},n.src=e}},[e,N]);return Nt.jsx("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center bg-black/50",children:Nt.jsxs("div",{className:"w-[92%] max-w-2xl bg-white dark:bg-gray-800 rounded-lg p-4",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-3",children:[Nt.jsx("h3",{className:"text-lg font-semibold",children:N?"Confirm Profile Photo":"Edit Profile Photo"}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{className:"text-sm px-3 py-1 rounded",onClick:t,children:"Cancel"}),Nt.jsx("button",{className:"text-sm bg-indigo-600 text-white px-3 py-1 rounded disabled:bg-gray-400",onClick:()=>h(null,null,function*(){var l,c,d,u;v(!0);try{if(!e)throw new Error("No image provided");if(!e.startsWith("data:image/"))throw new Error("Invalid image format - expected data URL");if(b)throw new Error("Cannot save - image failed to load");const t=i.current,d=s.current;if(!t||!d)throw new Error("Missing elements");if(N){const t=e,r=localStorage.getItem("token"),a=yield pt.put(`${zc()}/api/users/me/avatar`,{image:t},{headers:{Authorization:`Bearer ${r}`},timeout:3e4});return void((null==(l=a.data)?void 0:l.success)&&n&&n(a.data))}const u=d.getBoundingClientRect(),p=t.naturalWidth,m=t.naturalHeight,f=t.width*g,x=t.height*g,y=Math.min(u.width,u.height),w=o.x+(u.width-f)/2,S=o.y+(u.height-x)/2,j=Math.max(0,-w/f*p),_=Math.max(0,-S/x*m),A=Math.min(p-j,y/f*p),C=Math.min(m-_,y/x*m);if(A<r||C<a)return v(!1),alert(`Cropped image too small. Minimum ${r}${a}px required.`);const M=512,k=document.createElement("canvas");k.width=M,k.height=M;const E=k.getContext("2d"),T=new Image;e.startsWith("data:")||(T.crossOrigin="anonymous"),T.src=e;try{yield new Promise((e,t)=>{T.onload=e,T.onerror=()=>t(new Error("Failed to load image for processing"))})}catch(h){throw console.error("Image loading error:",h),new Error("Cannot process image - the image file may be corrupted or in an unsupported format")}E.drawImage(T,j,_,A,C,0,0,M,M);const P=yield new Promise(e=>k.toBlob(e,"image/png",.9)),D=new FileReader,R=yield new Promise(e=>{D.onload=()=>e(D.result),D.readAsDataURL(P)}),I=localStorage.getItem("token"),O=yield pt.put(`${zc()}/api/users/me/avatar`,{image:R},{headers:{Authorization:`Bearer ${I}`}});(null==(c=O.data)?void 0:c.success)&&n&&n(O.data)}catch(p){console.error("Avatar save error",p);let e="Failed to save avatar";(null==(u=null==(d=p.response)?void 0:d.data)?void 0:u.message)?e=p.response.data.message:p.message?e+=": "+p.message:"ECONNABORTED"===p.code&&(e="Request timed out. Please try again."),alert(e)}finally{v(!1),t&&t()}}),disabled:y||b,children:y?"Saving":"Save"})]})]}),Nt.jsxs("div",{ref:s,className:"relative h-[360px] bg-gray-100 dark:bg-gray-700 rounded overflow-hidden touch-none select-none",onMouseDown:S,onMouseMove:j,onTouchStart:S,onTouchMove:j,children:[b?Nt.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-red-500 text-center p-4",children:Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-4xl mb-2",children:""}),Nt.jsx("div",{className:"font-semibold",children:"Image Error"}),Nt.jsx("div",{className:"text-sm",children:"The selected image file appears to be corrupted or in an unsupported format."}),Nt.jsx("button",{className:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm",onClick:t,children:"Close Editor"})]})}):Nt.jsx("img",{ref:i,src:e,alt:"to edit",className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{transform:`translate(-50%, -50%) translate(${o.x}px, ${o.y}px) scale(${g})`},onError:()=>w(!0)}),!b&&Nt.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:Nt.jsx("div",{className:"w-64 h-64 border-2 border-white/70 rounded-full shadow-xl backdrop-blur-sm",style:{boxSizing:"border-box"}})})]}),Nt.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[Nt.jsx("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:"Zoom"}),Nt.jsx("input",{type:"range",min:.5,max:3,step:.01,value:g,onChange:e=>x(Number(e.target.value)),className:"flex-1 disabled:opacity-50",disabled:b})]}),N&&Nt.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"On mobile devices, the image will be uploaded as-is without cropping for better performance."})]})})}function nd({role:e,children:t}){var n;const{user:r,settings:a,setUser:i}=f.useContext($c),s=e||(null==r?void 0:r.role)||"teller",{showToast:o}=Kc(),l=y(),c=x();null==(n=null==a?void 0:a.theme)||n.mode;const[d,u]=f.useState(0),[p,m]=f.useState(0),[g,v]=f.useState(!1),[b,w]=f.useState(!1),[N,S]=f.useState(0),j=f.useRef(null),_=f.useRef(null),[A,C]=f.useState(null),[M,k]=f.useState(!1),E=f.useRef(null),[T,P]=f.useState(!1),[D,R]=f.useState(!0),[I,O]=f.useState(!0);f.useRef(0),f.useRef(0);const B=()=>h(null,null,function*(){var e,t;if(null==r?void 0:r._id)try{w(!0);const t=zc(),n=(null==(e=(yield pt.get(`${t}/api/payroll/user/${r._id}`,{timeout:1e4})).data)?void 0:e.payrolls)||[],a=n[0],i=Number((null==a?void 0:a.totalSalary)||0);u(i);const s=n.reduce((e,t)=>t&&!t.withdrawn?e+Number(t.totalSalary||0):e,0);m(s)}catch(n){429!==(null==(t=n.response)?void 0:t.status)&&console.error("Payroll fetch error:",n.message),u(0),m(0)}finally{w(!1)}}),le=()=>h(null,null,function*(){var e,t;try{const t=zc(),n=localStorage.getItem("token"),r=n?{headers:{Authorization:`Bearer ${n}`}}:{};r.validateStatus=e=>e<500,r.timeout=1e4;const a=yield pt.get(`${t}/api/admin/pending-count`,r);if(403===a.status||401===a.status)return void S(0);S((null==(e=a.data)?void 0:e.pendingCount)||0)}catch(n){429!==(null==(t=n.response)?void 0:t.status)&&console.error("Pending count fetch error:",n.message),S(0)}});f.useEffect(()=>{(null==r?void 0:r._id)&&B(),le();const e=Vc();return e&&(e.on("userUpdated",le),e.on("userDeleted",le),e.on("payrollUpdated",B)),()=>{e&&(e.off("userUpdated",le),e.off("userDeleted",le),e.off("payrollUpdated",B))}},[null==r?void 0:r._id]),f.useEffect(()=>{const e=()=>{v(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const ce=e=>{var t;null==(t=null==e?void 0:e.stopPropagation)||t.call(e),l("/profile")},de=e=>h(null,null,function*(){var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;const r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(!(n.type.startsWith("image/")&&(!!r||["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/heic","image/heif"].includes(n.type.toLowerCase()))))return void o({type:"error",message:r?"Please select a valid image file":"Please select a valid image file (JPEG, PNG, GIF, or WebP)"});const a=r?5242880:10485760;if(n.size>a)return void o({type:"error",message:"Profile picture must be <= "+(r?"5MB":"10MB")});r&&o({type:"info",message:"Processing image..."});const i=new FileReader,s=setTimeout(()=>{i.abort(),o({type:"error",message:"Image processing timed out. Please try a smaller image."})},r?15e3:1e4);i.onload=()=>h(null,null,function*(){clearTimeout(s);const e=i.result;if(!e||!e.startsWith("data:image/"))return void o({type:"error",message:"Failed to read image file. Please try a different image."});if(r)return C(e),void k(!0);const t=new Image;t.onload=()=>{if(t.width<128||t.height<128)return void o({type:"error",message:"Image too small  requires at least 128128px"});Math.ceil(3*(e.length-e.indexOf(",")-1)/4)<8192?o({type:"error",message:"Image file too small  must be at least 8192 bytes"}):(C(e),k(!0))},t.onerror=()=>{o({type:"error",message:"Invalid image file - please select a valid image"})},t.src=e}),i.onerror=()=>{clearTimeout(s),o({type:"error",message:"Failed to read the selected file. Please try again."})},i.onabort=()=>{clearTimeout(s),o({type:"error",message:"Image processing was cancelled."})};try{i.readAsDataURL(n)}catch(l){clearTimeout(s),console.error("FileReader error:",l),o({type:"error",message:"Unable to process the selected file. Please try a different image."})}}),ue=e=>{const t=null==e?void 0:e.user;t&&(i(t),o({type:"success",message:"Profile picture updated"}))},he=()=>{localStorage.removeItem("token"),l("/login"),o({type:"info",message:"Logged out successfully"})},pe=e=>c.pathname.includes(e),me=c.pathname.includes("/login")||c.pathname.includes("/register"),ge={dashboard:{to:e=>`/${e}/dashboard`,icon:Nt.jsx(F,{size:18}),text:"Dashboard"},"supervisor-report":{to:e=>`/${e}/supervisor-report`,icon:Nt.jsx(U,{size:18}),text:"Supervisor Reports"},"teller-reports":{to:e=>`/${e}/teller-reports`,icon:Nt.jsx(z,{size:18}),text:"Teller Reports"},"teller-reports-viewer":{to:e=>`/${e}/teller-reports/viewer`,icon:Nt.jsx(H,{size:18}),text:"Reports Viewer"},"teller-management":{to:e=>`/${e}/teller-management`,icon:Nt.jsx(U,{size:18}),text:"Teller Management",roles:["admin","super_admin","supervisor"]},"staff-performance":{to:e=>`/${e}/staff-performance`,icon:Nt.jsx(X,{size:18}),text:"Staff Performance",roles:["supervisor"]},"teller-overview":{to:e=>`/${e}/teller-overview`,icon:Nt.jsx(X,{size:18}),text:"Teller Overview",roles:["admin","super_admin"]},report:{to:e=>`/${e}/report`,icon:Nt.jsx(H,{size:18}),text:"Admin Report",roles:["admin","super_admin"]},cashflow:{to:e=>`/${e}/cashflow`,icon:Nt.jsx(oe,{size:18}),text:"Cash Flow"},payroll:{to:e=>`/${e}/payroll`,icon:Nt.jsx(Z,{size:18}),text:"Payroll Management"},"payroll-fixer":{to:e=>`/${e}/payroll-fixer`,icon:Nt.jsx(Z,{size:18}),text:"Payroll Base Salary Fixer",roles:["admin","super_admin"]},withdrawals:{to:e=>`/${e}/withdrawals`,icon:Nt.jsx(Z,{size:18}),text:"Withdrawal Approvals"},employees:{to:e=>`/${e}/employees`,icon:Nt.jsx(se,{size:18}),text:"Employees",roles:["admin","super_admin"]},"user-approval":{to:e=>`/${e}/user-approval`,icon:Nt.jsx(U,{size:18}),text:"User Approval",dynamicBadge:!0,roles:["admin","super_admin"]},salary:{to:e=>`/${e}/salary`,icon:Nt.jsx(Z,{size:18}),text:"My Salary",roles:["admin","super_admin"]},"suggested-schedule":{to:e=>`/${e}/suggested-schedule`,icon:Nt.jsx(W,{size:18}),text:"Suggested Schedule"},history:{to:e=>`/${e}/history`,icon:Nt.jsx(ie,{size:18}),text:"History"},"teller-month":{to:e=>`/${e}/teller-month`,icon:Nt.jsx(ae,{size:18}),text:"Teller of Month"},users:{to:e=>"/users",icon:Nt.jsx(U,{size:18}),text:"People",roles:["admin","super_admin","supervisor","teller","declarator","supervisor_teller"]},deployments:{to:e=>`/${e}/deployments`,icon:Nt.jsx(re,{size:18}),text:"Deployment Management",roles:["declarator","admin","super_admin","supervisor","supervisor_teller","teller"]},settings:{to:e=>`/${e}/settings`,icon:Nt.jsx(L,{size:18}),text:"Settings"},"menu-config":{to:e=>`/${e}/menu-config`,icon:Nt.jsx(ne,{size:18}),text:"Menu Permissions",roles:["admin","super_admin"]},"manage-sidebars":{to:e=>`/${e}/manage-sidebars`,icon:Nt.jsx(L,{size:18}),text:"Sidebar Control",roles:["admin","super_admin"]},"live-map":{to:e=>`/${e}/live-map`,icon:Nt.jsx(te,{size:18}),text:"Live Map",roles:["admin","super_admin","declarator"]},"map-editor":{to:e=>`/${e}/map-editor`,icon:Nt.jsx(L,{size:18}),text:"Map Editor",roles:["admin","super_admin","declarator"]},"teller-betting":{to:e=>`/${e}/teller-betting`,icon:Nt.jsx(K,{size:18}),text:"Teller Betting Data",roles:["admin","super_admin"]},"manage-betting":{to:e=>`/${e}/manage-betting`,icon:Nt.jsx(L,{size:18}),text:"Manage Betting Data",roles:["admin","super_admin"]},"teller-mappings":{to:e=>`/${e}/teller-mappings`,icon:Nt.jsx(ee,{size:18}),text:"Teller Mappings",roles:["super_admin"]},"betting-analytics":{to:e=>`/${e}/betting-analytics`,icon:Nt.jsx(X,{size:18}),text:"Betting Analytics",roles:["admin","super_admin"]},"betting-event-report":{to:e=>`/${e}/betting-event-report`,icon:Nt.jsx(K,{size:18}),text:"Betting Event Report",roles:["super_admin","admin","supervisor","teller"]},"key-performance-indicator":{to:e=>`/${e}/key-performance-indicator`,icon:Nt.jsx(X,{size:18}),text:"Key Performance Indicator",roles:["admin","super_admin","supervisor"]},"teller-salary-calculation":{to:e=>`/${e}/teller-salary-calculation`,icon:Nt.jsx(Z,{size:18}),text:"Teller Salary Calculation",roles:["admin","super_admin","supervisor"]},"chicken-fight":{to:e=>`/${e}/chicken-fight`,icon:Nt.jsx(K,{size:18}),text:"Chicken Fight",roles:["admin","super_admin","supervisor","declarator"]},"chicken-fight-entries":{to:e=>`/${e}/chicken-fight-entries`,icon:Nt.jsx(L,{size:18}),text:"Manage Entries",roles:["admin","super_admin","supervisor","declarator"]},"chicken-fight-results":{to:e=>`/${e}/chicken-fight-results`,icon:Nt.jsx(Q,{size:18}),text:"Edit/Delete Results",roles:["admin","super_admin","supervisor","declarator"]},"live-chicken-fight-dashboard":{to:e=>`/${e}/live-chicken-fight-dashboard`,icon:Nt.jsx(J,{size:18}),text:"Live Dashboard",roles:["super_admin"]},"live-cockfight-camera":{to:e=>`/${e}/live-cockfight-camera`,icon:Nt.jsx(Y,{size:18}),text:"Live Camera",roles:["admin","super_admin","supervisor","declarator"]},"betting-capture-screen":{to:e=>`/${e}/betting-capture-screen`,icon:Nt.jsx(Y,{size:18}),text:"Betting Capture",roles:["admin","super_admin","supervisor","teller","declarator"]},"stream-broadcaster":{to:e=>`/${e}/stream-broadcaster`,icon:Nt.jsx(q,{size:18}),text:"Stream Broadcaster",roles:["admin","super_admin","supervisor","teller","declarator"]},"financial-summary":{to:e=>`/${e}/financial-summary`,icon:Nt.jsx(K,{size:18}),text:"Financial Summary",roles:["admin","super_admin"]},leaderboard:{to:e=>`/${e}/leaderboard`,icon:Nt.jsx(X,{size:18}),text:"External Leaderboard",roles:["admin","super_admin"]},"gta-leaderboard":{to:e=>`/${e}/gta-leaderboard`,icon:Nt.jsx(X,{size:18}),text:"GTA LEADERBOARDS",roles:["admin","super_admin"]},"betting-event-reports":{to:e=>`/${e}/betting-event-reports`,icon:Nt.jsx(X,{size:18}),text:"Betting Event Reports",roles:["admin","super_admin"]},"gta-betting-event-report":{to:e=>`/${e}/gta-betting-event-report`,icon:Nt.jsx(X,{size:18}),text:"GTA Betting Event Report",roles:["admin","super_admin"]},"workplace-schedule":{to:e=>`/${e}/workplace-schedule`,icon:Nt.jsx(W,{size:18}),text:"Workplace Schedule",roles:["admin","super_admin"]},"gta-teller-management":{to:e=>`/${e}/gta-teller-management`,icon:Nt.jsx(U,{size:18}),text:"GTA Teller Management",roles:["admin","super_admin"]},upload:{to:e=>"/upload",icon:Nt.jsx(Y,{size:18}),text:"Upload",roles:["admin","super_admin","supervisor","teller","declarator","supervisor_teller"]},feed:{to:e=>"/feed",icon:Nt.jsx(z,{size:18}),text:"Feed",roles:["admin","super_admin","supervisor","teller","declarator","supervisor_teller"]},chat:{to:e=>`/${e}/chat`,icon:Nt.jsx(z,{size:18}),text:"Chat/Messages"},"attendance-scheduler":{to:e=>`/${e}/attendance-scheduler`,icon:Nt.jsx(W,{size:18}),text:"Attendance Scheduler",roles:["admin","super_admin","supervisor"]},assistant:{to:e=>`/${e}/assistant`,icon:Nt.jsx(U,{size:18}),text:"Admin Assistant",roles:["admin","super_admin"]}},fe={"supervisor-reports":"supervisor-report","teller-report":"teller-reports","submit-report":"teller-reports",schedule:"suggested-schedule","teller-of-month":"teller-month",users:"user-approval",approvals:"user-approval"},xe={super_admin:["dashboard","upload","feed","users","supervisor-report","teller-reports","teller-reports-viewer","teller-management","teller-overview","report","cashflow","user-approval","withdrawals","employees","salary","payroll","history","teller-month","suggested-schedule","attendance-scheduler","deployments","assistant","menu-config","manage-sidebars","live-map","map-editor","teller-betting","manage-betting","betting-analytics","betting-event-report","chicken-fight","chicken-fight-entries","live-chicken-fight-dashboard","live-cockfight-camera","betting-capture-screen","stream-broadcaster","key-performance-indicator","financial-summary","leaderboard","gta-leaderboard","betting-event-reports","gta-betting-event-report","workplace-schedule","gta-teller-management","settings"],admin:["dashboard","upload","users","supervisor-report","teller-reports","teller-reports-viewer","teller-management","teller-overview","report","cashflow","payroll","withdrawals","employees","user-approval","salary","history","teller-month","suggested-schedule","attendance-scheduler","deployments","assistant","map-editor","teller-betting","manage-betting","menu-config","manage-sidebars","betting-event-report","chicken-fight","chicken-fight-entries","live-cockfight-camera","betting-capture-screen","stream-broadcaster","key-performance-indicator","financial-summary","leaderboard","gta-leaderboard","betting-event-reports","gta-betting-event-report","workplace-schedule","gta-teller-management","settings"],supervisor:["dashboard","upload","feed","users","supervisor-report","teller-reports","teller-reports-viewer","teller-management","staff-performance","teller-month","history","payroll","suggested-schedule","key-performance-indicator","deployments","live-map","betting-event-report","chicken-fight","chicken-fight-entries","live-cockfight-camera","betting-capture-screen","stream-broadcaster"],supervisor_teller:["dashboard","upload","feed","users","supervisor-report","teller-reports","teller-reports-viewer","teller-management","staff-performance","teller-month","history","payroll","suggested-schedule","deployments","live-map","betting-event-report","chicken-fight","chicken-fight-entries","live-cockfight-camera","betting-capture-screen","stream-broadcaster"],teller:["dashboard","upload","feed","users","teller-reports","history","payroll","teller-month","suggested-schedule","deployments","live-map","betting-event-report","betting-capture-screen","stream-broadcaster"],declarator:["dashboard","upload","feed","users","deployments","suggested-schedule","live-map","map-editor","settings","chicken-fight","chicken-fight-entries","live-cockfight-camera","betting-capture-screen","stream-broadcaster"]},[ye,ve]=f.useState(!1),[be,we]=f.useState({});return f.useEffect(()=>{let e=!1;function t(){return h(this,null,function*(){try{const t=zc(),n=yield pt.get(`${t}/api/menu-permissions`);if(e)return;const r={};n.data.forEach(e=>{r[e.role]=e.menuItems||[]}),we(r)}catch(t){console.warn("Menu permissions fetch failed, using fallbacks:",t.message)}finally{e||ve(!0)}})}t();const n=Vc();return n&&n.on("menuPermissionsUpdated",t),()=>{e=!0,n&&n.off("menuPermissionsUpdated",t)}},[]),Nt.jsxs("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-gray-950",children:[T&&Nt.jsx("div",{className:"md:hidden fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm z-30",onClick:()=>{P(!1),R(!0)}}),T&&Nt.jsxs("aside",{ref:E,className:"fixed md:hidden sidebar-mobile z-40 h-screen w-64 \r\n          bg-white dark:bg-gray-900 border-r dark:border-gray-700 flex flex-col shadow-lg overflow-y-auto",children:[Nt.jsxs("div",{className:"px-4 pt-4 pb-3 border-b dark:border-gray-700 flex-shrink-0",children:[Nt.jsxs("div",{className:"flex items-center gap-3 cursor-pointer hover:opacity-80 transition",onClick:()=>l(`/${s}/dashboard`),title:"Go to Dashboard",children:[Nt.jsxs("div",{className:"relative",children:[(null==r?void 0:r.avatarUrl)?Nt.jsx("img",{src:`${zc()}${r.avatarUrl}?t=${Date.now()}`,alt:"avatar",onClick:e=>{ce(e)},className:"h-12 w-12 rounded-full object-cover cursor-pointer border-2 border-white dark:border-gray-900",onError:e=>{e.target.src=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><circle cx="24" cy="24" r="24" fill="#e5e7eb"/><circle cx="24" cy="18" r="8" fill="#9ca3af"/><path d="M8 40c0-8.8 7.2-16 16-16s16 7.2 16 16" fill="#9ca3af"/></svg>')}`}}):Nt.jsx(G,{onClick:e=>ce(e),className:"h-12 w-12 text-indigo-500 flex-shrink-0 cursor-pointer"}),M&&Nt.jsx(td,{initialImage:A,onClose:()=>{k(!1),C(null)},onSaved:e=>{ue(e),k(!1),C(null)}}),Nt.jsx("input",{ref:j,onChange:de,accept:"image/*",type:"file",className:"hidden"}),Nt.jsx("input",{ref:_,onChange:de,accept:"image/*",capture:"environment",type:"file",className:"hidden"})]}),Nt.jsxs("div",{className:"flex-1 min-w-0",children:[Nt.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200 text-base leading-tight truncate",children:(null==r?void 0:r.name)||(null==r?void 0:r.username)||"User"}),Nt.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:null==r?void 0:r.role})]})]}),Nt.jsx("div",{onClick:()=>{l("admin"===s?"/admin/salary":`/${s}/payroll`)},className:"mt-4 cursor-pointer group",children:Nt.jsxs("div",{className:"rounded-xl p-4 bg-gradient-to-r from-indigo-600 via-purple-600 to-fuchsia-600 text-white shadow hover:shadow-md transition relative overflow-hidden",children:[Nt.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_30%_30%,#ffffff,transparent)]"}),Nt.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-[11px] font-semibold tracking-wider text-indigo-100",children:"TOTAL BALANCE"}),Nt.jsx("div",{className:"mt-1 text-2xl font-bold",children:b?Nt.jsx("span",{className:"animate-pulse",children:""}):`${p.toLocaleString(void 0,{maximumFractionDigits:2})}`})]}),Nt.jsxs("div",{className:"text-xs text-indigo-100 text-right",children:[Nt.jsx("div",{className:"opacity-80",children:"Unwithdrawn"}),Nt.jsx("div",{className:"group-hover:underline",children:"View Details "})]})]})]})})]}),Nt.jsxs("nav",{className:"mt-4 space-y-1 text-sm flex-1 overflow-y-auto px-2 pb-4 scrollbar-thin scrollbar-thumb-gray-400 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent",children:[!ye&&Nt.jsx("div",{className:"text-xs px-3 py-1 text-gray-500 dark:text-gray-400",children:"Loading menu"}),ye&&(()=>{const e="admin"===(null==r?void 0:r.username),t=((null==r?void 0:r.username)||"").toLowerCase().includes("alfonso"),n=null==r?void 0:r.role,a=e&&(be.super_admin&&be.super_admin.length||xe.super_admin&&xe.super_admin.length)?"super_admin":n;let i=be[a]&&be[a].length?be[a]:xe[a]||[];const s="true"===localStorage.getItem("superAdminStrict");if("super_admin"===a&&!s){const e=Object.keys(ge),t=new Set(i);for(const n of e)t.has(n)||(i.push(n),t.add(n))}const o=i.map(e=>fe[e]||e),l=new Set,c=o.filter(e=>!l.has(e)&&(l.add(e),!0)),d="true"===localStorage.getItem("showExperimentalMenus");return c.filter(e=>ge[e]).filter(e=>d||"super_admin"===a||!1!==ge[e].enabled).filter(e=>{const n=ge[e].roles;return!(!t||"suggested-schedule"!==e&&"attendance-scheduler"!==e)||(!n||n.includes(a))}).map(e=>{const t=ge[e],n="function"==typeof t.to?t.to(null==r?void 0:r.role):t.to,a=t.dynamicBadge?N||0:void 0;return Nt.jsx(rd,{to:n,icon:t.icon,text:t.text,active:pe(n.replace(/\/.*/,"")),badge:a,expanded:!0},e)})})()]}),Nt.jsx("div",{className:"border-t dark:border-gray-700 mt-auto flex-shrink-0",children:Nt.jsx("button",{onClick:he,className:"w-full py-3 text-center text-sm text-gray-500 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-800 hover:text-red-600 transition",children:"Logout"})})]}),!g&&Nt.jsxs("aside",{ref:E,className:"hidden md:flex md:fixed md:sticky md:top-0 sidebar-fixed z-40 h-screen flex-col shadow-lg md:shadow-none overflow-y-auto bg-white dark:bg-gray-900 border-r dark:border-gray-700 transition-all duration-300 "+(I?"w-64":"w-20"),children:[Nt.jsxs("div",{className:"px-4 pt-4 pb-3 border-b dark:border-gray-700 flex-shrink-0",children:[Nt.jsx("div",{className:"flex justify-end mb-2",children:Nt.jsx("button",{onClick:()=>O(!I),className:"p-1.5 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-gray-600 dark:text-gray-300",title:I?"Collapse sidebar":"Expand sidebar",children:I?Nt.jsx(V,{size:20}):Nt.jsx($,{size:20})})}),Nt.jsxs("div",{className:"flex items-center gap-3 cursor-pointer hover:opacity-80 transition",onClick:()=>l(`/${s}/dashboard`),title:"Go to Dashboard",children:[Nt.jsxs("div",{className:"relative",children:[(null==r?void 0:r.avatarUrl)?Nt.jsx("img",{src:`${zc()}${r.avatarUrl}?t=${Date.now()}`,alt:"avatar",onClick:e=>{ce(e)},className:"h-12 w-12 rounded-full object-cover cursor-pointer border-2 border-white dark:border-gray-900",onError:e=>{e.target.src=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><circle cx="24" cy="24" r="24" fill="#e5e7eb"/><circle cx="24" cy="18" r="8" fill="#9ca3af"/><path d="M8 40c0-8.8 7.2-16 16-16s16 7.2 16 16" fill="#9ca3af"/></svg>')}`}}):Nt.jsx(G,{onClick:e=>ce(e),className:"h-12 w-12 text-indigo-500 flex-shrink-0 cursor-pointer"}),M&&Nt.jsx(td,{initialImage:A,onClose:()=>{k(!1),C(null)},onSaved:e=>{ue(e),k(!1),C(null)}}),Nt.jsx("input",{ref:j,onChange:de,accept:"image/*",type:"file",className:"hidden"}),Nt.jsx("input",{ref:_,onChange:de,accept:"image/*",capture:"environment",type:"file",className:"hidden"})]}),I&&Nt.jsxs("div",{className:"flex-1 min-w-0",children:[Nt.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200 text-base leading-tight truncate",children:(null==r?void 0:r.name)||(null==r?void 0:r.username)||"User"}),Nt.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400",children:null==r?void 0:r.role})]})]}),Nt.jsx("div",{onClick:()=>{l("admin"===s?"/admin/salary":`/${s}/payroll`)},className:"mt-4 cursor-pointer group",children:I&&Nt.jsxs("div",{className:"rounded-xl p-4 bg-gradient-to-r from-indigo-600 via-purple-600 to-fuchsia-600 text-white shadow hover:shadow-md transition relative overflow-hidden",children:[Nt.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_30%_30%,#ffffff,transparent)]"}),Nt.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-[11px] font-semibold tracking-wider text-indigo-100",children:"TOTAL BALANCE"}),Nt.jsx("div",{className:"mt-1 text-2xl font-bold",children:b?Nt.jsx("span",{className:"animate-pulse",children:""}):`${p.toLocaleString(void 0,{maximumFractionDigits:2})}`})]}),Nt.jsxs("div",{className:"text-xs text-indigo-100 text-right",children:[Nt.jsx("div",{className:"opacity-80",children:"Unwithdrawn"}),Nt.jsx("div",{className:"group-hover:underline",children:"View Details "})]})]})]})})]}),Nt.jsxs("nav",{className:"mt-4 space-y-1 text-sm flex-1 overflow-y-auto px-2 pb-4 scrollbar-thin scrollbar-thumb-gray-400 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent",children:[!ye&&Nt.jsx("div",{className:"text-xs px-3 py-1 text-gray-500 dark:text-gray-400",children:"Loading menu"}),ye&&(()=>{const e="admin"===(null==r?void 0:r.username),t=((null==r?void 0:r.username)||"").toLowerCase().includes("alfonso"),n=null==r?void 0:r.role,a=e&&(be.super_admin&&be.super_admin.length||xe.super_admin&&xe.super_admin.length)?"super_admin":n;let i=be[a]&&be[a].length?be[a]:xe[a]||[];const s="true"===localStorage.getItem("superAdminStrict");if("super_admin"===a&&!s){const e=Object.keys(ge),t=new Set(i);for(const n of e)t.has(n)||(i.push(n),t.add(n))}const o=i.map(e=>fe[e]||e),l=new Set,c=o.filter(e=>!l.has(e)&&(l.add(e),!0)),d="true"===localStorage.getItem("showExperimentalMenus");return c.filter(e=>ge[e]).filter(e=>d||"super_admin"===a||!1!==ge[e].enabled).filter(e=>{const n=ge[e].roles;return!(!t||"suggested-schedule"!==e&&"attendance-scheduler"!==e)||(!n||n.includes(a))}).map(e=>{const t=ge[e],n="function"==typeof t.to?t.to(null==r?void 0:r.role):t.to,a=t.dynamicBadge?N||0:void 0;return Nt.jsx(rd,{to:n,icon:t.icon,text:t.text,active:pe(n.replace(/\/.*/,"")),badge:a,expanded:I},e)})})()]}),Nt.jsx("div",{className:"border-t dark:border-gray-700 mt-auto flex-shrink-0",children:Nt.jsx("button",{onClick:he,className:"w-full py-3 text-center text-sm text-gray-500 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-800 hover:text-red-600 transition",children:"Logout"})})]}),D&&Nt.jsx("button",{onClick:()=>{P(!0),R(!1)},className:"md:hidden fixed top-4 left-3 z-50 bg-indigo-600 text-white p-2 rounded-full shadow-lg focus:outline-none transition-transform duration-300",children:Nt.jsx("span",{className:"transform transition-transform duration-300 rotate-0",children:""})}),Nt.jsxs("main",{className:"flex-1 h-screen overflow-y-auto bg-gray-50 dark:bg-gray-950 md:ml-0 relative",style:{marginLeft:"0"},children:[Nt.jsx("div",{className:"min-h-full w-full",children:t}),!me&&r&&Nt.jsx(ad,{children:Nt.jsx(Qc,{user:r})})]})]})}function rd({to:e,icon:t,text:n,active:r,badge:a,expanded:i}){const s=y();return Nt.jsxs("div",{onClick:()=>s(e),className:"flex items-center gap-3 px-3 py-2.5 cursor-pointer rounded-lg transition-all relative group "+(r?"bg-indigo-100 dark:bg-indigo-700 text-indigo-700 dark:text-white font-medium shadow-sm":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 hover:translate-x-1"),title:n,children:[Nt.jsx("span",{className:"flex-shrink-0",children:t}),i&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("span",{className:"truncate flex-1",children:n}),a>0&&Nt.jsx("span",{className:"flex-shrink-0 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:a})]}),!i&&Nt.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-50",children:n})]})}function ad({children:e}){const[t,n]=f.useState({x:window.innerWidth-90,y:window.innerHeight-140}),r=f.useRef(!1),a=f.useRef({x:0,y:0});f.useEffect(()=>{const e=()=>{const e=window.innerWidth-80,t=window.innerHeight-80;n(n=>({x:Math.max(10,Math.min(n.x,e)),y:Math.max(10,Math.min(n.y,t))}))};return window.addEventListener("resize",e),window.addEventListener("scroll",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e),window.removeEventListener("orientationchange",e)}},[]);const i=e=>{if(!r.current)return;const t=e.clientX-a.current.x,i=e.clientY-a.current.y;n({x:Math.max(10,Math.min(t,window.innerWidth-80)),y:Math.max(10,Math.min(i,window.innerHeight-80))})},s=()=>{r.current=!1,c(),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)},o=e=>{if(!r.current)return;e.preventDefault();const t=e.touches[0],i=t.clientX-a.current.x,s=t.clientY-a.current.y;n({x:Math.max(10,Math.min(i,window.innerWidth-80)),y:Math.max(10,Math.min(s,window.innerHeight-80))})},l=()=>{r.current=!1,c(),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",l)},c=()=>{n(e=>({x:e.x<window.innerWidth/2?10:window.innerWidth-80,y:Math.max(10,Math.min(e.y,window.innerHeight-80))}))};return Nt.jsx("div",{onMouseDown:e=>{r.current=!0,a.current={x:e.clientX-t.x,y:e.clientY-t.y},document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)},onTouchStart:e=>{r.current=!0;const n=e.touches[0];a.current={x:n.clientX-t.x,y:n.clientY-t.y},document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("touchend",l)},style:{position:"fixed",left:`${t.x}px`,top:`${t.y}px`,zIndex:99999,cursor:"grab",touchAction:"none",transition:r.current?"none":"all 0.25s ease-out",filter:"drop-shadow(0 4px 8px rgba(0,0,0,0.25))"},children:e})}let id=class extends v.Component{constructor(e){super(e),u(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?Nt.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-6",children:Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8 max-w-md w-full text-center",children:[Nt.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),Nt.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Oops! Something went wrong"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"We encountered an unexpected error. Please try refreshing the page or contact support if the problem persists."}),!1,Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsx("button",{onClick:this.handleReset,className:"w-full bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:"Try Again"}),Nt.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Refresh Page"}),Nt.jsx("button",{onClick:()=>window.location.href="/",className:"w-full bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-700 transition-colors",children:"Go to Home"})]})]})}):this.props.children}};const sd=({children:e,delay:t=0,duration:n=.4})=>Nt.jsx(Oc.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:n,delay:t,ease:[.25,.46,.45,.94]},children:e}),od=({children:e,delay:t=0})=>Nt.jsx(Oc.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.4,delay:t,ease:[.25,.46,.45,.94]},children:e}),ld=({children:e,staggerDelay:t=.1})=>Nt.jsx(Oc.div,{initial:"hidden",animate:"visible",variants:{hidden:{},visible:{transition:{staggerChildren:t}}},children:e}),cd=({children:e})=>Nt.jsx(Oc.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,ease:[.25,.46,.45,.94]}}},children:e}),dd=({children:e,scale:t=1.05})=>Nt.jsx(Oc.div,{whileHover:{scale:t},whileTap:{scale:.95},transition:{duration:.2},children:e}),ud=({children:e})=>Nt.jsx(Oc.div,{animate:{scale:[1,1.05,1],opacity:[1,.8,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e}),hd=({children:e,delay:t=0})=>Nt.jsx(Oc.div,{initial:{opacity:0,scale:.3},animate:{opacity:1,scale:1},transition:{duration:.4,delay:t,ease:[.68,-.55,.265,1.55]},children:e});function pd(){const{setUser:e}=f.useContext($c),[t,n]=f.useState(""),[r,a]=f.useState(""),[i,s]=f.useState(""),o=y();return Nt.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-indigo-50 to-blue-100 dark:from-gray-900 dark:to-gray-800 px-4",children:[Nt.jsx(od,{children:Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-xl shadow-2xl w-full max-w-md card-hover",children:[Nt.jsx(sd,{children:Nt.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-6 text-center text-indigo-600 dark:text-indigo-400",children:"RMI Teller Report System"})}),i&&Nt.jsx(hd,{children:Nt.jsx("p",{className:"text-red-500 text-sm mb-3 text-center bg-red-50 dark:bg-red-900/20 p-2 rounded-md",children:i})}),Nt.jsxs("form",{onSubmit:n=>h(null,null,function*(){var a,i,l,c;n.preventDefault(),s("");const d=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(console.log(" Frontend login attempt:",{username:t,passwordLength:r.length,isMobile:d,userAgent:navigator.userAgent,apiUrl:zc(),windowLocation:window.location.href}),!t||!r)return void s("Please enter both username and password.");const u=t.trim(),h=r.trim();if(0!==u.length&&0!==h.length)try{const t={username:u,password:h},n=zc();console.log(" Sending login request to:",`${n}/api/auth/login`),console.log(" Payload:",{username:u,passwordLength:h.length}),console.log(" Current hostname:",window.location.hostname),console.log(" API URL from getApiUrl():",n);const r=d?15e3:3e4,a=yield pt.post(`${n}/api/auth/login`,t,{timeout:r,headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});console.log(" Login response:",a.data);const{token:i,user:l}=a.data;if(!i||!l)return console.error(" Missing token or user in response"),void s("Invalid response from server.");localStorage.setItem("token",i),localStorage.setItem("user",JSON.stringify(l)),localStorage.setItem("userName",l.name||l.username),e(l),console.log(" Login successful  redirecting to feed page",l.role),o("/feed")}catch(p){console.error(" Login failed:",(null==(a=p.response)?void 0:a.data)||p.message),console.error(" Full error:",p),"NETWORK_ERROR"===p.code||p.message.includes("Network Error")?s("Network connection failed. Please check your WiFi connection."):"ECONNABORTED"===p.code||p.message.includes("timeout")?s("Request timed out. Please try again."):404===(null==(i=p.response)?void 0:i.status)?s("Server not found. Please check network connection."):s((null==(c=null==(l=p.response)?void 0:l.data)?void 0:c.message)||"Login failed. Please try again.")}else s("Username and password cannot be empty.")}),className:"space-y-4",children:[Nt.jsx(sd,{delay:.1,children:Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"login-username",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Username"}),Nt.jsx("input",{id:"login-username",name:"username",type:"text",value:t,onChange:e=>n(e.target.value),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 focus-ring text-base transition-all duration-200",required:!0,autoComplete:"username",autoCapitalize:"none",autoCorrect:"off",spellCheck:"false"})]})}),Nt.jsx(sd,{delay:.2,children:Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"login-password",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Password"}),Nt.jsx("input",{id:"login-password",name:"password",type:"password",value:r,onChange:e=>a(e.target.value),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 focus-ring text-base transition-all duration-200",required:!0,autoComplete:"current-password",autoCapitalize:"none",autoCorrect:"off",spellCheck:"false",inputMode:"text"})]})}),Nt.jsx(sd,{delay:.3,children:Nt.jsx(dd,{children:Nt.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-3 rounded-lg btn-effect hover:bg-indigo-700 transition-all duration-200 text-base font-medium shadow-lg",children:"Login"})})}),Nt.jsx(sd,{delay:.4,children:Nt.jsxs("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400 mt-4",children:["Dont have an account?"," ",Nt.jsx("button",{type:"button",onClick:()=>o("/register"),className:"text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 transition-colors duration-200 font-medium",children:"Sign up"})]})})]})]})}),Nt.jsx(sd,{delay:.6,children:Nt.jsx("p",{className:"mt-6 text-sm text-gray-600 dark:text-gray-400",children:" Gideonbot.XY  All Rights Reserved"})})]})}function md(){const[e,t]=f.useState({username:"",password:"",confirmPassword:"",name:"",role:"teller"}),[n,r]=f.useState(""),[a,i]=f.useState(""),s=y(),o=Hc,d=n=>{t(c(l({},e),{[n.target.name]:n.target.value}))};return Nt.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100 dark:bg-gray-900 px-4",children:[Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-lg shadow-xl w-full max-w-md",children:[Nt.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-6 text-center text-indigo-600 dark:text-indigo-400",children:"Register Account"}),n&&Nt.jsx("p",{className:"text-red-500 text-sm mb-3 text-center",children:n}),a&&Nt.jsx("p",{className:"text-green-500 text-sm mb-3 text-center",children:a}),Nt.jsxs("form",{onSubmit:t=>h(null,null,function*(){var n,a,l;if(t.preventDefault(),r(""),i(""),console.log(" Registration attempt:",{username:e.username,role:e.role}),e.password===e.confirmPassword)try{const t={username:e.username.trim(),password:e.password,name:e.name.trim(),role:e.role};console.log(" Sending registration to:",`${o}/api/auth/register`);const n=yield pt.post(`${o}/api/auth/register`,t);console.log(" Registration response:",n.data),i(" Registration successful! Waiting for admin approval."),setTimeout(()=>s("/login"),2e3)}catch(c){console.error(" Registration failed:",(null==(n=c.response)?void 0:n.data)||c.message),console.error(" Full error:",c),r((null==(l=null==(a=c.response)?void 0:a.data)?void 0:l.message)||"Registration error")}else r("Passwords do not match")}),className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Full Name"}),Nt.jsx("input",{id:"name",name:"name",type:"text",value:e.name,onChange:d,className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 text-base",required:!0,autoComplete:"name"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"username",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Username"}),Nt.jsx("input",{id:"username",name:"username",type:"text",value:e.username,onChange:d,className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 text-base",required:!0,autoComplete:"username",autoCapitalize:"none",autoCorrect:"off",spellCheck:"false"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Password"}),Nt.jsx("input",{id:"password",name:"password",type:"password",value:e.password,onChange:d,className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 text-base",required:!0,autoComplete:"new-password"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Confirm Password"}),Nt.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:e.confirmPassword,onChange:d,className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 text-base",required:!0,autoComplete:"new-password"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{htmlFor:"role",className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Role"}),Nt.jsxs("select",{id:"role",name:"role",value:e.role,onChange:d,className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 text-base",children:[Nt.jsx("option",{value:"teller",children:"Teller"}),Nt.jsx("option",{value:"supervisor",children:"Supervisor"}),Nt.jsx("option",{value:"supervisor_teller",children:"Supervisor/Teller"}),Nt.jsx("option",{value:"declarator",children:"Declarator"}),Nt.jsx("option",{value:"admin",children:"Admin"})]})]}),Nt.jsx("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-2.5 rounded-md hover:bg-indigo-700 transition text-base font-medium",children:"Register"}),Nt.jsxs("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400 mt-3",children:["Already have an account?"," ",Nt.jsx("button",{type:"button",onClick:()=>s("/login"),className:"text-indigo-600 dark:text-indigo-400 hover:underline",children:"Login"})]})]})]}),Nt.jsx("p",{className:"mt-6 text-sm text-gray-600 dark:text-gray-400",children:" Gideonbot.XY  All Rights Reserved"})]})}function gd(){const[e,t]=f.useState({}),[n,r]=f.useState({}),a=`http://${window.location.hostname}:5000`;f.useEffect(()=>{const e={userAgent:navigator.userAgent,currentUrl:window.location.href,hostname:window.location.hostname,origin:window.location.origin,apiUrl:`http://${window.location.hostname}:5000`,screenSize:`${window.screen.width}x${window.screen.height}`,isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),localStorage:{hasToken:!!localStorage.getItem("token"),hasUser:!!localStorage.getItem("user")}};t(e)},[]);return Nt.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:Nt.jsxs("div",{className:"max-w-4xl mx-auto",children:[Nt.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:" Mobile Debug Page"}),Nt.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-3",children:" Device Information"}),Nt.jsxs("div",{className:"space-y-2 text-sm",children:[Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Mobile Device:"})," ",e.isMobile?"Yes":"No"]}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Screen Size:"})," ",e.screenSize]}),Nt.jsxs("p",{className:"text-red-600",children:[Nt.jsx("strong",{children:" Hostname:"})," ",e.hostname]}),Nt.jsxs("p",{className:"text-blue-600",children:[Nt.jsx("strong",{children:"Origin:"})," ",e.origin]}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Current URL:"})," ",e.currentUrl]}),Nt.jsxs("p",{className:"text-green-600",children:[Nt.jsx("strong",{children:"API URL:"})," ",e.apiUrl]}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"User Agent:"})," ",Nt.jsx("span",{className:"break-all",children:e.userAgent})]}),Nt.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:Nt.jsxs("p",{className:"text-xs text-yellow-800",children:[Nt.jsx("strong",{children:" Important:"}),' If hostname shows "localhost", access this page via your network IP instead:',Nt.jsx("br",{}),"Try: ",Nt.jsx("strong",{className:"text-blue-600",children:"http://192.168.254.128:5173/mobile-debug"})]})})]})]}),Nt.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-3",children:" Connection Tests"}),Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){const e={};try{const t=yield fetch(`${a}/api/health`),n=yield t.json();e.health={success:!0,data:n}}catch(t){e.health={success:!1,error:t.message}}try{const t=yield fetch(`${a}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"test",password:"test"})});e.loginEndpoint={success:!0,status:t.status}}catch(t){e.loginEndpoint={success:!1,error:t.message}}r(e)}),className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"Test Backend Connection"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){try{const e=yield fetch(`${a}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"12345"})}),t=yield e.json();e.ok?r(e=>c(l({},e),{realLogin:{success:!0,user:t.user}})):r(e=>c(l({},e),{realLogin:{success:!1,error:t.message}}))}catch(e){r(t=>c(l({},t),{realLogin:{success:!1,error:e.message}}))}}),className:"w-full bg-green-500 text-white p-2 rounded hover:bg-green-600",children:"Test Admin Login (admin/12345)"})]})]}),Object.keys(n).length>0&&Nt.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-3",children:" Test Results"}),Nt.jsxs("div",{className:"space-y-4",children:[n.health&&Nt.jsxs("div",{className:"p-3 rounded "+(n.health.success?"bg-green-100":"bg-red-100"),children:[Nt.jsx("strong",{children:"Health Check:"})," ",n.health.success?" Success":" Failed",Nt.jsx("pre",{className:"text-xs mt-1",children:JSON.stringify(n.health,null,2)})]}),n.loginEndpoint&&Nt.jsxs("div",{className:"p-3 rounded "+(n.loginEndpoint.success?"bg-green-100":"bg-red-100"),children:[Nt.jsx("strong",{children:"Login Endpoint:"})," ",n.loginEndpoint.success?" Reachable":" Failed",Nt.jsx("pre",{className:"text-xs mt-1",children:JSON.stringify(n.loginEndpoint,null,2)})]}),n.realLogin&&Nt.jsxs("div",{className:"p-3 rounded "+(n.realLogin.success?"bg-green-100":"bg-red-100"),children:[Nt.jsx("strong",{children:"Real Login Test:"})," ",n.realLogin.success?" Success":" Failed",Nt.jsx("pre",{className:"text-xs mt-1",children:JSON.stringify(n.realLogin,null,2)})]})]})]}),Nt.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-3",children:" Instructions"}),Nt.jsxs("div",{className:"text-sm space-y-2",children:[Nt.jsx("p",{children:"1. Run connection tests to verify backend accessibility"}),Nt.jsx("p",{children:"2. If tests pass, try login with credentials:"}),Nt.jsxs("p",{className:"ml-4",children:[Nt.jsx("strong",{children:"Username:"})," admin"]}),Nt.jsxs("p",{className:"ml-4",children:[Nt.jsx("strong",{children:"Password:"})," 12345"]}),Nt.jsx("p",{children:"3. Check browser console for detailed logs"}),Nt.jsx("p",{children:"4. If still failing, check WiFi connection and try different browser"})]})]})]})})}function fd(){const[e,t]=f.useState([]),[n,r]=f.useState(!0);return f.useEffect(()=>{h(null,null,function*(){var e;const n=[],a=zc(),i=Date.now();try{const e=yield pt.get(`${a}/api/health`,{timeout:3e3}),t=Date.now()-i;n.push({name:"Health Check",status:" PASS",duration:`${t}ms`,data:e.data})}catch(l){const e=Date.now()-i;n.push({name:"Health Check",status:" FAIL",duration:`${e}ms`,error:l.message,code:l.code})}const s=Date.now();try{const e=yield pt.get(`${a}/api/settings`,{timeout:1e4}),t=Date.now()-s;n.push({name:"Settings Endpoint",status:" PASS",duration:`${t}ms`,hasData:!!e.data})}catch(l){const t=Date.now()-s;n.push({name:"Settings Endpoint",status:" FAIL",duration:`${t}ms`,error:l.message,code:l.code,statusCode:null==(e=l.response)?void 0:e.status})}n.push({name:"API URL Resolution",status:" INFO",apiUrl:a,hostname:window.location.hostname,protocol:window.location.protocol});const o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);n.push({name:"Device Detection",status:" INFO",isMobile:o,userAgent:navigator.userAgent.substring(0,100)}),t(n),r(!1)})},[]),Nt.jsxs("div",{style:{padding:"20px",fontFamily:"monospace",backgroundColor:"#1e1e1e",color:"#00ff00",minHeight:"100vh"},children:[Nt.jsx("h1",{children:" Backend Connectivity Test"}),n?Nt.jsx("p",{children:"Testing..."}):Nt.jsx("div",{children:e.map((e,t)=>Nt.jsxs("div",{style:{marginBottom:"20px",padding:"10px",border:"1px solid #444",borderRadius:"4px"},children:[Nt.jsx("h3",{children:e.name}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Status:"})," ",e.status]}),e.duration&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Duration:"})," ",e.duration]}),e.error&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Error:"})," ",e.error]}),e.code&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Error Code:"})," ",e.code]}),e.statusCode&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"HTTP Status:"})," ",e.statusCode]}),e.apiUrl&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"API URL:"})," ",e.apiUrl]}),e.hostname&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Hostname:"})," ",e.hostname]}),void 0!==e.isMobile&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Is Mobile:"})," ",e.isMobile?"YES":"NO"]}),e.userAgent&&Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"User Agent:"})," ",e.userAgent,"..."]}),e.data&&Nt.jsx("pre",{style:{overflow:"auto",maxHeight:"200px",backgroundColor:"#111"},children:JSON.stringify(e.data,null,2)})]},t))})]})}function xd(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=xd(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function yd(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=xd(e))&&(r&&(r+=" "),r+=t);return r}var vd=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function bd(e){return"string"==typeof e&&vd.includes(e)}var wd=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Nd(e){return"string"==typeof e&&wd.includes(e)}function Sd(e){return"string"==typeof e&&e.startsWith("data-")}function jd(e){var t=Object.entries(e).filter(e=>{var[t]=e;return Nd(t)||Sd(t)});return Object.fromEntries(t)}function _d(e){return null==e?null:f.isValidElement(e)&&"object"==typeof e.props&&null!==e.props?jd(e.props):"object"!=typeof e||Array.isArray(e)?null:jd(e)}function Ad(e){var t=Object.entries(e).filter(e=>{var[t]=e;return Nd(t)||Sd(t)||bd(t)});return Object.fromEntries(t)}var Cd=["children","width","height","viewBox","className","style","title","desc"];function Md(){return Md=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Md.apply(null,arguments)}var kd=f.forwardRef((e,t)=>{var{children:n,width:r,height:a,viewBox:i,className:s,style:o,title:l,desc:c}=e,d=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Cd),u=i||{width:r,height:a,x:0,y:0},h=yd("recharts-surface",s);return f.createElement("svg",Md({},Ad(d),{className:h,width:r,height:a,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height),ref:t}),f.createElement("title",null,l),f.createElement("desc",null,c),n)}),Ed=["children","className"];function Td(){return Td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Td.apply(null,arguments)}var Pd=f.forwardRef((e,t)=>{var{children:n,className:r}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Ed),i=yd("recharts-layer",r);return f.createElement("g",Td({className:i},Ad(a),{ref:t}),n)}),Dd=f.createContext(null);function Rd(e){return function(){return e}}const Id=Math.cos,Od=Math.sin,Bd=Math.sqrt,Ld=Math.PI,Fd=2*Ld,Ud=Math.PI,zd=2*Ud,Hd=1e-6,Gd=zd-Hd;function Vd(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}let $d=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Vd:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Vd;const n=s(10,t);return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,a,i){this._append`C${+e},${+t},${+n},${+r},${this._x1=+a},${this._y1=+i}`}arcTo(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error(`negative radius: ${a}`);let i=this._x1,s=this._y1,o=n-e,l=r-t,c=i-e,d=s-t,u=c*c+d*d;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(u>Hd)if(Math.abs(d*o-l*c)>Hd&&a){let h=n-i,p=r-s,m=o*o+l*l,g=h*h+p*p,f=Math.sqrt(m),x=Math.sqrt(u),y=a*Math.tan((Ud-Math.acos((m+u-g)/(2*f*x)))/2),v=y/x,b=y/f;Math.abs(v-1)>Hd&&this._append`L${e+v*c},${t+v*d}`,this._append`A${a},${a},0,0,${+(d*h>c*p)},${this._x1=e+b*o},${this._y1=t+b*l}`}else this._append`L${this._x1=e},${this._y1=t}`;else;}arc(e,t,n,r,a,i){if(e=+e,t=+t,i=!!i,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(r),o=n*Math.sin(r),l=e+s,c=t+o,d=1^i,u=i?r-a:a-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Hd||Math.abs(this._y1-c)>Hd)&&this._append`L${l},${c}`,n&&(u<0&&(u=u%zd+zd),u>Gd?this._append`A${n},${n},0,1,${d},${e-s},${t-o}A${n},${n},0,1,${d},${this._x1=l},${this._y1=c}`:u>Hd&&this._append`A${n},${n},0,${+(u>=Ud)},${d},${this._x1=e+n*Math.cos(a)},${this._y1=t+n*Math.sin(a)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function Wd(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new $d(t)}function Yd(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Xd(e){this._context=e}function Kd(e){return new Xd(e)}function qd(e){return e[0]}function Jd(e){return e[1]}function Qd(e,t){var n=Rd(!0),r=null,a=Kd,i=null,s=Wd(o);function o(o){var l,c,d,u=(o=Yd(o)).length,h=!1;for(null==r&&(i=a(d=s())),l=0;l<=u;++l)!(l<u&&n(c=o[l],l,o))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(c,l,o),+t(c,l,o));if(d)return i=null,d+""||null}return e="function"==typeof e?e:void 0===e?qd:Rd(e),t="function"==typeof t?t:void 0===t?Jd:Rd(t),o.x=function(t){return arguments.length?(e="function"==typeof t?t:Rd(+t),o):e},o.y=function(e){return arguments.length?(t="function"==typeof e?e:Rd(+e),o):t},o.defined=function(e){return arguments.length?(n="function"==typeof e?e:Rd(!!e),o):n},o.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),o):r},o}function Zd(e,t,n){var r=null,a=Rd(!0),i=null,s=Kd,o=null,l=Wd(c);function c(c){var d,u,h,p,m,g=(c=Yd(c)).length,f=!1,x=new Array(g),y=new Array(g);for(null==i&&(o=s(m=l())),d=0;d<=g;++d){if(!(d<g&&a(p=c[d],d,c))===f)if(f=!f)u=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),h=d-1;h>=u;--h)o.point(x[h],y[h]);o.lineEnd(),o.areaEnd()}f&&(x[d]=+e(p,d,c),y[d]=+t(p,d,c),o.point(r?+r(p,d,c):x[d],n?+n(p,d,c):y[d]))}if(m)return o=null,m+""||null}function d(){return Qd().defined(a).curve(s).context(i)}return e="function"==typeof e?e:void 0===e?qd:Rd(+e),t="function"==typeof t?t:Rd(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Jd:Rd(+n),c.x=function(t){return arguments.length?(e="function"==typeof t?t:Rd(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:Rd(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Rd(+e),c):r},c.y=function(e){return arguments.length?(t="function"==typeof e?e:Rd(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"==typeof e?e:Rd(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:Rd(+e),c):n},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(n)},c.lineX1=function(){return d().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"==typeof e?e:Rd(!!e),c):a},c.curve=function(e){return arguments.length?(s=e,null!=i&&(o=s(i)),c):s},c.context=function(e){return arguments.length?(null==e?i=o=null:o=s(i=e),c):i},c}Xd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};class eu{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}const tu={draw(e,t){const n=Bd(t/Ld);e.moveTo(n,0),e.arc(0,0,n,0,Fd)}},nu={draw(e,t){const n=Bd(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},ru=Bd(1/3),au=2*ru,iu={draw(e,t){const n=Bd(t/au),r=n*ru;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},su={draw(e,t){const n=Bd(t),r=-n/2;e.rect(r,r,n,n)}},ou=Od(Ld/10)/Od(7*Ld/10),lu=Od(Fd/10)*ou,cu=-Id(Fd/10)*ou,du={draw(e,t){const n=Bd(.8908130915292852*t),r=lu*n,a=cu*n;e.moveTo(0,-n),e.lineTo(r,a);for(let i=1;i<5;++i){const t=Fd*i/5,s=Id(t),o=Od(t);e.lineTo(o*n,-s*n),e.lineTo(s*r-o*a,o*r+s*a)}e.closePath()}},uu=Bd(3),hu={draw(e,t){const n=-Bd(t/(3*uu));e.moveTo(0,2*n),e.lineTo(-uu*n,-n),e.lineTo(uu*n,-n),e.closePath()}},pu=-.5,mu=Bd(3)/2,gu=1/Bd(12),fu=3*(gu/2+1),xu={draw(e,t){const n=Bd(t/fu),r=n/2,a=n*gu,i=r,s=n*gu+n,o=-i,l=s;e.moveTo(r,a),e.lineTo(i,s),e.lineTo(o,l),e.lineTo(pu*r-mu*a,mu*r+pu*a),e.lineTo(pu*i-mu*s,mu*i+pu*s),e.lineTo(pu*o-mu*l,mu*o+pu*l),e.lineTo(pu*r+mu*a,pu*a-mu*r),e.lineTo(pu*i+mu*s,pu*s-mu*i),e.lineTo(pu*o+mu*l,pu*l-mu*o),e.closePath()}};function yu(){}function vu(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function bu(e){this._context=e}function wu(e){this._context=e}function Nu(e){this._context=e}function Su(e){this._context=e}function ju(e){return e<0?-1:1}function _u(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),s=(n-e._y1)/(a||r<0&&-0),o=(i*a+s*r)/(r+a);return(ju(i)+ju(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function Au(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Cu(e,t,n){var r=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,a+o*t,i-o,s-o*n,i,s)}function Mu(e){this._context=e}function ku(e){this._context=new Eu(e)}function Eu(e){this._context=e}function Tu(e){this._context=e}function Pu(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Du(e,t){this._context=e,this._t=t}function Ru(e,t){if((a=e.length)>1)for(var n,r,a,i=1,s=e[t[0]],o=s.length;i<a;++i)for(r=s,s=e[t[i]],n=0;n<o;++n)s[n][1]+=s[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function Iu(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Ou(e,t){return e[t]}function Bu(e){const t=[];return t.key=e,t}bu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:vu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:vu(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},wu.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:vu(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Nu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:vu(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Su.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Mu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Cu(this,this._t0,Au(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Cu(this,Au(this,n=_u(this,e,t)),n);break;default:Cu(this,this._t0,n=_u(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(ku.prototype=Object.create(Mu.prototype)).point=function(e,t){Mu.prototype.point.call(this,t,e)},Eu.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},Tu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Pu(e),a=Pu(t),i=0,s=1;s<n;++i,++s)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[s],t[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Du.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Lu,Fu={},Uu={};function zu(){return Lu||(Lu=1,e=Uu,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isUnsafeProperty=function(e){return"__proto__"===e}),Uu;var e}var Hu,Gu={};function Vu(){return Hu||(Hu=1,e=Gu,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}),Gu;var e}var $u,Wu={};function Yu(){return $u||($u=1,e=Wu,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.toKey=function(e){var t;return"string"==typeof e||"symbol"==typeof e?e:Object.is(null==(t=null==e?void 0:e.valueOf)?void 0:t.call(e),-0)?"-0":String(e)}),Wu;var e}var Xu,Ku,qu,Ju,Qu,Zu={},eh={};function th(){return Xu||(Xu=1,e=eh,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.toString=function e(t){if(null==t)return"";if("string"==typeof t)return t;if(Array.isArray(t))return t.map(e).join(",");const n=String(t);return"0"===n&&Object.is(Number(t),-0)?"-0":n}),eh;var e}function nh(){return Ku||(Ku=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=th(),n=Yu();e.toPath=function(e){if(Array.isArray(e))return e.map(n.toKey);if("symbol"==typeof e)return[e];const r=[],a=(e=t.toString(e)).length;if(0===a)return r;let i=0,s="",o="",l=!1;for(46===e.charCodeAt(0)&&(r.push(""),i++);i<a;){const t=e[i];o?"\\"===t&&i+1<a?(i++,s+=e[i]):t===o?o="":s+=t:l?'"'===t||"'"===t?o=t:"]"===t?(l=!1,r.push(s),s=""):s+=t:"["===t?(l=!0,s&&(r.push(s),s="")):"."===t?s&&(r.push(s),s=""):s+=t,i++}return s&&r.push(s),r}}(Zu)),Zu}function rh(){return qu||(qu=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zu(),n=Vu(),r=Yu(),a=nh();e.get=function e(i,s,o){if(null==i)return o;switch(typeof s){case"string":{if(t.isUnsafeProperty(s))return o;const r=i[s];return void 0===r?n.isDeepKey(s)?e(i,a.toPath(s),o):o:r}case"number":case"symbol":{"number"==typeof s&&(s=r.toKey(s));const e=i[s];return void 0===e?o:e}default:{if(Array.isArray(s))return function(e,n,r){if(0===n.length)return r;let a=e;for(let i=0;i<n.length;i++){if(null==a)return r;if(t.isUnsafeProperty(n[i]))return r;a=a[n[i]]}if(void 0===a)return r;return a}(i,s,o);if(s=Object.is(null==s?void 0:s.valueOf(),-0)?"-0":String(s),t.isUnsafeProperty(s))return o;const e=i[s];return void 0===e?o:e}}}}(Fu)),Fu}function ah(){return Qu?Ju:(Qu=1,Ju=rh().get)}const ih=g(ah());var sh=e=>0===e?0:e>0?1:-1,oh=e=>"number"==typeof e&&e!=+e,lh=e=>"string"==typeof e&&e.indexOf("%")===e.length-1,ch=e=>("number"==typeof e||e instanceof Number)&&!oh(e),dh=e=>ch(e)||"string"==typeof e,uh=0,hh=e=>{var t=++uh;return"".concat(e||"").concat(t)},ph=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!ch(e)&&"string"!=typeof e)return r;if(lh(e)){if(null==t)return r;var i=e.indexOf("%");n=t*parseFloat(e.slice(0,i))/100}else n=+e;return oh(n)&&(n=r),a&&null!=t&&n>t&&(n=t),n},mh=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1};function gh(e,t,n){return ch(e)&&ch(t)?e+n*(t-e):t}function fh(e,t,n){if(e&&e.length)return e.find(e=>e&&("function"==typeof t?t(e):ih(e,t))===n)}var xh=e=>null==e,yh=e=>xh(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),vh=["type","size","sizeType"];function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bh.apply(null,arguments)}function wh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wh(Object(n),!0).forEach(function(t){Sh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wh(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jh={symbolCircle:tu,symbolCross:nu,symbolDiamond:iu,symbolSquare:su,symbolStar:du,symbolTriangle:hu,symbolWye:xu},_h=Math.PI/180,Ah=e=>{var{type:t="circle",size:n=64,sizeType:r="area"}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,vh),i=Nh(Nh({},a),{},{type:t,size:n,sizeType:r}),o="circle";"string"==typeof t&&(o=t);var{className:l,cx:c,cy:d}=i,u=Ad(i);return c===+c&&d===+d&&n===+n?f.createElement("path",bh({},u,{className:yd("recharts-symbols",l),transform:"translate(".concat(c,", ").concat(d,")"),d:(()=>{var e=(e=>{var t="symbol".concat(yh(e));return jh[t]||tu})(o),t=function(e,t){let n=null,r=Wd(a);function a(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"==typeof e?e:Rd(e||tu),t="function"==typeof t?t:Rd(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"==typeof t?t:Rd(t),a):e},a.size=function(e){return arguments.length?(t="function"==typeof e?e:Rd(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type(e).size(((e,t,n)=>{if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*_h;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*s(Math.tan(r),2));case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}})(n,r,o)),a=t();if(null!==a)return a})()})):null};Ah.registerSymbol=(e,t)=>{jh["symbol".concat(yh(e))]=t};var Ch=(e,t)=>{if(!e||"function"==typeof e||"boolean"==typeof e)return null;var n=e;if(f.isValidElement(e)&&(n=e.props),"object"!=typeof n&&"function"!=typeof n)return null;var r={};return Object.keys(n).forEach(e=>{bd(e)&&(r[e]=t=>n[e](n,t))}),r},Mh=(e,t,n)=>{if(null===e||"object"!=typeof e&&"function"!=typeof e)return null;var r=null;return Object.keys(e).forEach(a=>{var i=e[a];bd(a)&&"function"==typeof i&&(r||(r={}),r[a]=((e,t,n)=>r=>(e(t,n,r),null))(i,t,n))}),r};function kh(){return kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kh.apply(null,arguments)}function Eh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Th(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ph=32;class Dh extends f.PureComponent{renderIcon(e,t){var{inactiveColor:n}=this.props,r=16,a=Ph/6,i=Ph/3,s=e.inactive?n:e.color,o=null!=t?t:e.type;if("none"===o)return null;if("plainline"===o)return f.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:r,x2:Ph,y2:r,className:"recharts-legend-icon"});if("line"===o)return f.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(r,"h").concat(i,"\n            A").concat(a,",").concat(a,",0,1,1,").concat(2*i,",").concat(r,"\n            H").concat(Ph,"M").concat(2*i,",").concat(r,"\n            A").concat(a,",").concat(a,",0,1,1,").concat(i,",").concat(r),className:"recharts-legend-icon"});if("rect"===o)return f.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(4,"h").concat(Ph,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(f.isValidElement(e.legendIcon)){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Eh(Object(n),!0).forEach(function(t){Th(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eh(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e);return delete l.legendIcon,f.cloneElement(e.legendIcon,l)}return f.createElement(Ah,{fill:s,cx:r,cy:r,size:Ph,sizeType:"diameter",type:o})}renderItems(){var{payload:e,iconSize:t,layout:n,formatter:r,inactiveColor:a,iconType:i}=this.props,s={x:0,y:0,width:Ph,height:Ph},o={display:"horizontal"===n?"inline-block":"block",marginRight:10},l={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((e,n)=>{var c=e.formatter||r,d=yd({"recharts-legend-item":!0,["legend-item-".concat(n)]:!0,inactive:e.inactive});if("none"===e.type)return null;var u=e.inactive?a:e.color,h=c?c(e.value,e,n):e.value;return f.createElement("li",kh({className:d,style:o,key:"legend-item-".concat(n)},Mh(this.props,e,n)),f.createElement(kd,{width:t,height:t,viewBox:s,style:l,"aria-label":"".concat(h," legend icon")},this.renderIcon(e,i)),f.createElement("span",{className:"recharts-legend-item-text",style:{color:u}},h))})}render(){var{payload:e,layout:t,align:n}=this.props;if(!e||!e.length)return null;var r={padding:0,margin:0,textAlign:"horizontal"===t?n:"left"};return f.createElement("ul",{className:"recharts-default-legend",style:r},this.renderItems())}}Th(Dh,"displayName","Legend"),Th(Dh,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Rh,Ih={},Oh={};function Bh(){return Rh||(Rh=1,e=Oh,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.uniqBy=function(e,t){const n=new Map;for(let r=0;r<e.length;r++){const a=e[r],i=t(a);n.has(i)||n.set(i,a)}return Array.from(n.values())}),Oh;var e}var Lh,Fh={};function Uh(){return Lh||(Lh=1,e=Fh,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.identity=function(e){return e}),Fh;var e}var zh,Hh,Gh={},Vh={},$h={};function Wh(){return zh||(zh=1,e=$h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}),$h;var e}function Yh(){return Hh||(Hh=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wh();e.isArrayLike=function(e){return null!=e&&"function"!=typeof e&&t.isLength(e.length)}}(Vh)),Vh}var Xh,Kh,qh={};function Jh(){return Xh||(Xh=1,e=qh,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isObjectLike=function(e){return"object"==typeof e&&null!==e}),qh;var e}function Qh(){return Kh||(Kh=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yh(),n=Jh();e.isArrayLikeObject=function(e){return n.isObjectLike(e)&&t.isArrayLike(e)}}(Gh)),Gh}var Zh,ep={},tp={};function np(){return Zh||(Zh=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rh();e.property=function(e){return function(n){return t.get(n,e)}}}(tp)),tp}var rp,ap={},ip={},sp={},op={};function lp(){return rp||(rp=1,e=op,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isObject=function(e){return null!==e&&("object"==typeof e||"function"==typeof e)}),op;var e}var cp,dp={};function up(){return cp||(cp=1,e=dp,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isPrimitive=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e}),dp;var e}var hp,pp,mp,gp={};function fp(){return hp||(hp=1,e=gp,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.eq=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}),gp;var e}function xp(){return pp||(pp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lp(),n=up(),r=fp();function a(e,o,c,d){if(o===e)return!0;switch(typeof o){case"object":return function(e,t,r,a){if(null==t)return!0;if(Array.isArray(t))return i(e,t,r,a);if(t instanceof Map)return function(e,t,n,r){if(0===t.size)return!0;if(!(e instanceof Map))return!1;for(const[a,i]of t.entries()){if(!1===n(e.get(a),i,a,e,t,r))return!1}return!0}(e,t,r,a);if(t instanceof Set)return s(e,t,r,a);const o=Object.keys(t);if(null==e)return 0===o.length;if(0===o.length)return!0;if(null==a?void 0:a.has(t))return a.get(t)===e;null==a||a.set(t,e);try{for(let i=0;i<o.length;i++){const s=o[i];if(!n.isPrimitive(e)&&!(s in e))return!1;if(void 0===t[s]&&void 0!==e[s])return!1;if(null===t[s]&&null!==e[s])return!1;if(!r(e[s],t[s],s,e,t,a))return!1}return!0}finally{null==a||a.delete(t)}}(e,o,c,d);case"function":return Object.keys(o).length>0?a(e,l({},o),c,d):r.eq(e,o);default:return t.isObject(e)?"string"!=typeof o||""===o:r.eq(e,o)}}function i(e,t,n,r){if(0===t.length)return!0;if(!Array.isArray(e))return!1;const a=new Set;for(let i=0;i<t.length;i++){const s=t[i];let o=!1;for(let l=0;l<e.length;l++){if(a.has(l))continue;let c=!1;if(n(e[l],s,i,e,t,r)&&(c=!0),c){a.add(l),o=!0;break}}if(!o)return!1}return!0}function s(e,t,n,r){return 0===t.size||e instanceof Set&&i([...e],[...t],n,r)}e.isMatchWith=function e(t,n,r){return"function"!=typeof r?e(t,n,()=>{}):a(t,n,function e(t,n,i,s,o,l){const c=r(t,n,i,s,o,l);return void 0!==c?Boolean(c):a(t,n,e,l)},new Map)},e.isSetMatch=s}(sp)),sp}function yp(){return mp||(mp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xp();e.isMatch=function(e,n){return t.isMatchWith(e,n,()=>{})}}(ip)),ip}var vp,bp={},wp={},Np={};function Sp(){return vp||(vp=1,e=Np,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}),Np;var e}var jp,_p={};function Ap(){return jp||(jp=1,e=_p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}),_p;var e}var Cp,Mp={};function kp(){return Cp||(Cp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});e.argumentsTag="[object Arguments]",e.arrayBufferTag="[object ArrayBuffer]",e.arrayTag="[object Array]",e.bigInt64ArrayTag="[object BigInt64Array]",e.bigUint64ArrayTag="[object BigUint64Array]",e.booleanTag="[object Boolean]",e.dataViewTag="[object DataView]",e.dateTag="[object Date]",e.errorTag="[object Error]",e.float32ArrayTag="[object Float32Array]",e.float64ArrayTag="[object Float64Array]",e.functionTag="[object Function]",e.int16ArrayTag="[object Int16Array]",e.int32ArrayTag="[object Int32Array]",e.int8ArrayTag="[object Int8Array]",e.mapTag="[object Map]",e.numberTag="[object Number]",e.objectTag="[object Object]",e.regexpTag="[object RegExp]",e.setTag="[object Set]",e.stringTag="[object String]",e.symbolTag="[object Symbol]",e.uint16ArrayTag="[object Uint16Array]",e.uint32ArrayTag="[object Uint32Array]",e.uint8ArrayTag="[object Uint8Array]",e.uint8ClampedArrayTag="[object Uint8ClampedArray]"}(Mp)),Mp}var Ep,Tp,Pp,Dp,Rp={};function Ip(){return Ep||(Ep=1,e=Rp,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}),Rp;var e}function Op(){return Tp||(Tp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sp(),n=Ap(),r=kp(),a=up(),i=Ip();function s(e,t,l,c=new Map,d=void 0){const u=null==d?void 0:d(e,t,l,c);if(void 0!==u)return u;if(a.isPrimitive(e))return e;if(c.has(e))return c.get(e);if(Array.isArray(e)){const t=new Array(e.length);c.set(e,t);for(let n=0;n<e.length;n++)t[n]=s(e[n],n,l,c,d);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;c.set(e,t);for(const[n,r]of e)t.set(n,s(r,n,l,c,d));return t}if(e instanceof Set){const t=new Set;c.set(e,t);for(const n of e)t.add(s(n,void 0,l,c,d));return t}if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(i.isTypedArray(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);c.set(e,t);for(let n=0;n<e.length;n++)t[n]=s(e[n],n,l,c,d);return t}if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return c.set(e,t),o(t,e,l,c,d),t}if("undefined"!=typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return c.set(e,t),o(t,e,l,c,d),t}if("undefined"!=typeof Blob&&e instanceof Blob){const t=new Blob([e],{type:e.type});return c.set(e,t),o(t,e,l,c,d),t}if(e instanceof Error){const t=new e.constructor;return c.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,o(t,e,l,c,d),t}if(e instanceof Boolean){const t=new Boolean(e.valueOf());return c.set(e,t),o(t,e,l,c,d),t}if(e instanceof Number){const t=new Number(e.valueOf());return c.set(e,t),o(t,e,l,c,d),t}if(e instanceof String){const t=new String(e.valueOf());return c.set(e,t),o(t,e,l,c,d),t}if("object"==typeof e&&function(e){switch(n.getTag(e)){case r.argumentsTag:case r.arrayTag:case r.arrayBufferTag:case r.dataViewTag:case r.booleanTag:case r.dateTag:case r.float32ArrayTag:case r.float64ArrayTag:case r.int8ArrayTag:case r.int16ArrayTag:case r.int32ArrayTag:case r.mapTag:case r.numberTag:case r.objectTag:case r.regexpTag:case r.setTag:case r.stringTag:case r.symbolTag:case r.uint8ArrayTag:case r.uint8ClampedArrayTag:case r.uint16ArrayTag:case r.uint32ArrayTag:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return c.set(e,t),o(t,e,l,c,d),t}return e}function o(e,n,r=e,a,i){const o=[...Object.keys(n),...t.getSymbols(n)];for(let t=0;t<o.length;t++){const l=o[t],c=Object.getOwnPropertyDescriptor(e,l);(null==c||c.writable)&&(e[l]=s(n[l],l,r,a,i))}}e.cloneDeepWith=function(e,t){return s(e,void 0,e,new Map,t)},e.cloneDeepWithImpl=s,e.copyProperties=o}(wp)),wp}function Bp(){return Pp||(Pp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Op();e.cloneDeep=function(e){return t.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}}(bp)),bp}function Lp(){return Dp||(Dp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yp(),n=Bp();e.matches=function(e){return e=n.cloneDeep(e),n=>t.isMatch(n,e)}}(ap)),ap}var Fp,Up,zp={},Hp={},Gp={};function Vp(){return Fp||(Fp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Op(),n=kp();e.cloneDeepWith=function(e,r){return t.cloneDeepWith(e,(a,i,s,o)=>{const l=null==r?void 0:r(a,i,s,o);if(void 0!==l)return l;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case n.numberTag:case n.stringTag:case n.booleanTag:{const n=new e.constructor(null==e?void 0:e.valueOf());return t.copyProperties(n,e),n}case n.argumentsTag:{const n={};return t.copyProperties(n,e),n.length=e.length,n[Symbol.iterator]=e[Symbol.iterator],n}default:return}})}}(Gp)),Gp}function $p(){return Up||(Up=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vp();e.cloneDeep=function(e){return t.cloneDeepWith(e)}}(Hp)),Hp}var Wp,Yp={},Xp={};function Kp(){return Wp||(Wp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;e.isIndex=function(e,n=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<n;case"symbol":return!1;case"string":return t.test(e)}}}(Xp)),Xp}var qp,Jp,Qp,Zp,em,tm,nm,rm={};function am(){return qp||(qp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ap();e.isArguments=function(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===t.getTag(e)}}(rm)),rm}function im(){return Jp||(Jp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vu(),n=Kp(),r=am(),a=nh();e.has=function(e,i){let s;if(s=Array.isArray(i)?i:"string"==typeof i&&t.isDeepKey(i)&&null==(null==e?void 0:e[i])?a.toPath(i):[i],0===s.length)return!1;let o=e;for(let t=0;t<s.length;t++){const e=s[t];if(null==o||!Object.hasOwn(o,e)){if(!((Array.isArray(o)||r.isArguments(o))&&n.isIndex(e)&&e<o.length))return!1}o=o[e]}return!0}}(Yp)),Yp}function sm(){return Qp||(Qp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yp(),n=Yu(),r=$p(),a=rh(),i=im();e.matchesProperty=function(e,s){switch(typeof e){case"object":Object.is(null==e?void 0:e.valueOf(),-0)&&(e="-0");break;case"number":e=n.toKey(e)}return s=r.cloneDeep(s),function(n){const r=a.get(n,e);return void 0===r?i.has(n,e):void 0===s?void 0===r:t.isMatch(r,s)}}}(zp)),zp}function om(){return Zp||(Zp=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Uh(),n=np(),r=Lp(),a=sm();e.iteratee=function(e){if(null==e)return t.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&2===e.length?a.matchesProperty(e[0],e[1]):r.matches(e);case"string":case"symbol":case"number":return n.property(e)}}}(ep)),ep}function lm(){return nm?tm:(nm=1,tm=(em||(em=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bh(),n=Uh(),r=Qh(),a=om();e.uniqBy=function(e,i=n.identity){return r.isArrayLikeObject(e)?t.uniqBy(Array.from(e),a.iteratee(i)):[]}}(Ih)),Ih).uniqBy)}const cm=g(lm());function dm(e,t,n){return!0===t?cm(e,n):"function"==typeof t?cm(e,t):e}var um,hm,pm,mm,gm={exports:{}},fm={},xm={exports:{}},ym={};function vm(){return hm||(hm=1,xm.exports=function(){if(um)return ym;um=1;var e=p(),t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useState,r=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function s(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!t(e,r)}catch(a){return!0}}var o="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var o=t(),l=n({inst:{value:o,getSnapshot:t}}),c=l[0].inst,d=l[1];return a(function(){c.value=o,c.getSnapshot=t,s(c)&&d({inst:c})},[e,o,t]),r(function(){return s(c)&&d({inst:c}),e(function(){s(c)&&d({inst:c})})},[e]),i(o),o};return ym.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:o,ym}()),xm.exports}
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bm=(mm||(mm=1,gm.exports=function(){if(pm)return fm;pm=1;var e=p(),t=vm(),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,o=e.useDebugValue;return fm.useSyncExternalStoreWithSelector=function(e,t,l,c,d){var u=a(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=s(function(){function e(e){if(!i){if(i=!0,r=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return a=t}return a=e}if(t=a,n(r,e))return t;var s=c(e);return void 0!==d&&d(t,s)?(r=e,t):(r=e,a=s)}var r,a,i=!1,s=void 0===l?null:l;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]},[t,l,c,d]);var p=r(e,u[0],u[1]);return i(function(){h.hasValue=!0,h.value=p},[p]),o(p),p},fm}()),gm.exports);const wm=g(bm);var Nm=f.createContext(null),Sm=e=>e,jm=()=>{var e=f.useContext(Nm);return e?e.store.dispatch:Sm},_m=()=>{},Am=()=>_m,Cm=(e,t)=>e===t;function Mm(e){var t=f.useContext(Nm);return bm.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Am,t?t.store.getState:_m,t?t.store.getState:_m,t?e:_m,Cm)}var km=e=>Array.isArray(e)?e:[e];function Em(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(e=>"function"==typeof e)){const n=e.map(e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}var Tm="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Pm(){return{s:0,v:void 0,o:null,p:null}}function Dm(e,t={}){let n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let a,i=0;function s(){var t,s;let o=n;const{length:l}=arguments;for(let e=0,n=l;e<n;e++){const t=arguments[e];if("function"==typeof t||"object"==typeof t&&null!==t){let e=o.o;null===e&&(o.o=e=new WeakMap);const n=e.get(t);void 0===n?(o=Pm(),e.set(t,o)):o=n}else{let e=o.p;null===e&&(o.p=e=new Map);const n=e.get(t);void 0===n?(o=Pm(),e.set(t,o)):o=n}}const c=o;let d;if(1===o.s)d=o.v;else if(d=e.apply(null,arguments),i++,r){const e=null!=(s=null==(t=null==a?void 0:a.deref)?void 0:t.call(a))?s:a;null!=e&&r(e,d)&&(d=e,0!==i&&i--);a="object"==typeof d&&null!==d||"function"==typeof d?new Tm(d):d}return c.s=1,c.v=d,d}return s.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function Rm(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,a=0,i={},s=e.pop();"object"==typeof s&&(i=s,s=e.pop()),function(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}(s,`createSelector expects an output function after the inputs, but received: [${typeof s}]`);const o=l(l({},n),i),{memoize:c,memoizeOptions:d=[],argsMemoize:u=Dm,argsMemoizeOptions:h=[]}=o,p=km(d),m=km(h),g=Em(e),f=c(function(){return r++,s.apply(null,arguments)},...p),x=u(function(){a++;const e=function(e,t){const n=[],{length:r}=e;for(let a=0;a<r;a++)n.push(e[a].apply(null,t));return n}(g,arguments);return t=f.apply(null,e),t},...m);return Object.assign(x,{resultFunc:s,memoizedResultFunc:f,dependencies:g,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:c,argsMemoize:u})};return Object.assign(r,{withTypes:()=>r}),r}var Im,Om=Rm(Dm),Bm=Object.assign((e,t=Om)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e);return t(n.map(t=>e[t]),(...e)=>e.reduce((e,t,r)=>(e[n[r]]=t,e),{}))},{withTypes:()=>Bm}),Lm={},Fm={},Um={};function zm(){return Im||(Im=1,function(e){function t(e){return"symbol"==typeof e?1:null===e?2:void 0===e?3:e!=e?4:0}Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});e.compareValues=(e,n,r)=>{if(e!==n){const a=t(e),i=t(n);if(a===i&&0===a){if(e<n)return"desc"===r?1:-1;if(e>n)return"desc"===r?-1:1}return"desc"===r?i-a:a-i}return 0}}(Um)),Um}var Hm,Gm,Vm,$m={},Wm={};function Ym(){return Hm||(Hm=1,e=Wm,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isSymbol=function(e){return"symbol"==typeof e||e instanceof Symbol}),Wm;var e}function Xm(){return Gm||(Gm=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ym(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;e.isKey=function(e,a){return!Array.isArray(e)&&(!("number"!=typeof e&&"boolean"!=typeof e&&null!=e&&!t.isSymbol(e))||("string"==typeof e&&(r.test(e)||!n.test(e))||null!=a&&Object.hasOwn(a,e)))}}($m)),$m}function Km(){return Vm||(Vm=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zm(),n=Xm(),r=nh();e.orderBy=function(e,a,i,s){if(null==e)return[];i=s?void 0:i,Array.isArray(e)||(e=Object.values(e)),Array.isArray(a)||(a=null==a?[null]:[a]),0===a.length&&(a=[null]),Array.isArray(i)||(i=null==i?[]:[i]),i=i.map(e=>String(e));const o=(e,t)=>{let n=e;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n},l=a.map(e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"==typeof e||Array.isArray(e)||n.isKey(e)?e:{key:e,path:r.toPath(e)}));return e.map(e=>({original:e,criteria:l.map(t=>((e,t)=>null==t||null==e?t:"object"==typeof e&&"key"in e?Object.hasOwn(t,e.key)?t[e.key]:o(t,e.path):"function"==typeof e?e(t):Array.isArray(e)?o(t,e):"object"==typeof t?t[e]:t)(t,e))})).slice().sort((e,n)=>{for(let r=0;r<l.length;r++){const a=t.compareValues(e.criteria[r],n.criteria[r],i[r]);if(0!==a)return a}return 0}).map(e=>e.original)}}(Fm)),Fm}var qm,Jm={};function Qm(){return qm||(qm=1,e=Jm,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.flatten=function(e,t=1){const n=[],r=Math.floor(t),a=(e,t)=>{for(let i=0;i<e.length;i++){const s=e[i];Array.isArray(s)&&t<r?a(s,t+1):n.push(s)}};return a(e,0),n}),Jm;var e}var Zm,eg,tg,ng,rg={};function ag(){return Zm||(Zm=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kp(),n=Yh(),r=lp(),a=fp();e.isIterateeCall=function(e,i,s){return!!r.isObject(s)&&(!!("number"==typeof i&&n.isArrayLike(s)&&t.isIndex(i)&&i<s.length||"string"==typeof i&&i in s)&&a.eq(s[i],e))}}(rg)),rg}function ig(){return ng?tg:(ng=1,tg=(eg||(eg=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Km(),n=Qm(),r=ag();e.sortBy=function(e,...a){const i=a.length;return i>1&&r.isIterateeCall(e,a[0],a[1])?a=[]:i>2&&r.isIterateeCall(a[0],a[1],a[2])&&(a=[a[0]]),t.orderBy(e,n.flatten(a),["asc"])}}(Lm)),Lm).sortBy)}const sg=g(ig());var og=e=>e.legend.settings,lg=Om([e=>e.legend.payload,og],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?sg(r,n):r});function cg(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,n]=f.useState({height:0,left:0,top:0,width:0}),r=f.useCallback(e=>{if(null!=e){var r=e.getBoundingClientRect(),a={height:r.height,left:r.left,top:r.top,width:r.width};(Math.abs(a.height-t.height)>1||Math.abs(a.left-t.left)>1||Math.abs(a.top-t.top)>1||Math.abs(a.width-t.width)>1)&&n({height:a.height,left:a.left,top:a.top,width:a.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,r]}function dg(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ug=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),hg=()=>Math.random().toString(36).substring(7).split("").join("."),pg={INIT:`@@redux/INIT${hg()}`,REPLACE:`@@redux/REPLACE${hg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${hg()}`};function mg(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function gg(e,t,n){if("function"!=typeof e)throw new Error(dg(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(dg(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(dg(1));return n(gg)(e,t)}let r=e,a=t,i=new Map,s=i,o=0,l=!1;function c(){s===i&&(s=new Map,i.forEach((e,t)=>{s.set(t,e)}))}function d(){if(l)throw new Error(dg(3));return a}function u(e){if("function"!=typeof e)throw new Error(dg(4));if(l)throw new Error(dg(5));let t=!0;c();const n=o++;return s.set(n,e),function(){if(t){if(l)throw new Error(dg(6));t=!1,c(),s.delete(n),i=null}}}function h(e){if(!mg(e))throw new Error(dg(7));if(void 0===e.type)throw new Error(dg(8));if("string"!=typeof e.type)throw new Error(dg(17));if(l)throw new Error(dg(9));try{l=!0,a=r(a,e)}finally{l=!1}return(i=s).forEach(e=>{e()}),e}h({type:pg.INIT});return{dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error(dg(10));r=e,h({type:pg.REPLACE})},[ug]:function(){const e=u;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(dg(11));function n(){const e=t;e.next&&e.next(d())}n();return{unsubscribe:e(n)}},[ug](){return this}}}}}function fg(e){const t=Object.keys(e),n={};for(let i=0;i<t.length;i++){const r=t[i];"function"==typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let a;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if(void 0===n(void 0,{type:pg.INIT}))throw new Error(dg(12));if(void 0===n(void 0,{type:pg.PROBE_UNKNOWN_ACTION()}))throw new Error(dg(13))})}(n)}catch(bI){a=bI}return function(e={},t){if(a)throw a;let i=!1;const s={};for(let a=0;a<r.length;a++){const o=r[a],l=n[o],c=e[o],d=l(c,t);if(void 0===d)throw t&&t.type,new Error(dg(14));s[o]=d,i=i||d!==c}return i=i||r.length!==Object.keys(e).length,i?s:e}}function xg(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce((e,t)=>(...n)=>e(t(...n)))}function yg(e){return mg(e)&&"type"in e&&"string"==typeof e.type}var vg=Symbol.for("immer-nothing"),bg=Symbol.for("immer-draftable"),wg=Symbol.for("immer-state");function Ng(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Sg=Object.getPrototypeOf;function jg(e){return!!e&&!!e[wg]}function _g(e){var t;return!!e&&(Mg(e)||Array.isArray(e)||!!e[bg]||!!(null==(t=e.constructor)?void 0:t[bg])||Dg(e)||Rg(e))}var Ag=Object.prototype.constructor.toString(),Cg=new WeakMap;function Mg(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!=typeof n)return!1;let r=Cg.get(n);return void 0===r&&(r=Function.toString.call(n),Cg.set(n,r)),r===Ag}function kg(e,t,n=!0){if(0===Eg(e)){(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,r)=>t(r,n,e))}function Eg(e){const t=e[wg];return t?t.type_:Array.isArray(e)?1:Dg(e)?2:Rg(e)?3:0}function Tg(e,t){return 2===Eg(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Pg(e,t,n){const r=Eg(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Dg(e){return e instanceof Map}function Rg(e){return e instanceof Set}function Ig(e){return e.copy_||e.base_}function Og(e,t){if(Dg(e))return new Map(e);if(Rg(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Mg(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[wg];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(Sg(e),t)}{const t=Sg(e);if(null!==t&&n)return l({},e);const r=Object.create(t);return Object.assign(r,e)}}function Bg(e,t=!1){return Fg(e)||jg(e)||!_g(e)||(Eg(e)>1&&Object.defineProperties(e,{set:Lg,add:Lg,clear:Lg,delete:Lg}),Object.freeze(e),t&&Object.values(e).forEach(e=>Bg(e,!0))),e}var Lg={value:function(){Ng(2)}};function Fg(e){return null===e||"object"!=typeof e||Object.isFrozen(e)}var Ug,zg={};function Hg(e){const t=zg[e];return t||Ng(0),t}function Gg(){return Ug}function Vg(e,t){t&&(Hg("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function $g(e){Wg(e),e.drafts_.forEach(Xg),e.drafts_=null}function Wg(e){e===Ug&&(Ug=e.parent_)}function Yg(e){return Ug={drafts_:[],parent_:Ug,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Xg(e){const t=e[wg];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Kg(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[wg].modified_&&($g(t),Ng(4)),_g(e)&&(e=qg(t,e),t.parent_||Qg(t,e)),t.patches_&&Hg("Patches").generateReplacementPatches_(n[wg].base_,e,t.patches_,t.inversePatches_)):e=qg(t,n,[]),$g(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==vg?e:void 0}function qg(e,t,n){if(Fg(t))return t;const r=e.immer_.shouldUseStrictIteration(),a=t[wg];if(!a)return kg(t,(r,i)=>Jg(e,a,t,r,i,n),r),t;if(a.scope_!==e)return t;if(!a.modified_)return Qg(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const t=a.copy_;let i=t,s=!1;3===a.type_&&(i=new Set(t),t.clear(),s=!0),kg(i,(r,i)=>Jg(e,a,t,r,i,n,s),r),Qg(e,t,!1),n&&e.patches_&&Hg("Patches").generatePatches_(a,n,e.patches_,e.inversePatches_)}return a.copy_}function Jg(e,t,n,r,a,i,s){if(null==a)return;if("object"!=typeof a&&!s)return;const o=Fg(a);if(!o||s){if(jg(a)){const s=qg(e,a,i&&t&&3!==t.type_&&!Tg(t.assigned_,r)?i.concat(r):void 0);if(Pg(n,r,s),!jg(s))return;e.canAutoFreeze_=!1}else s&&n.add(a);if(_g(a)&&!o){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[r]===a&&o)return;qg(e,a),t&&t.scope_.parent_||"symbol"==typeof r||!(Dg(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||Qg(e,a)}}}function Qg(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Bg(t,n)}var Zg={get(e,t){if(t===wg)return e;const n=Ig(e);if(!Tg(n,t))return function(e,t,n){var r;const a=nf(t,n);return a?"value"in a?a.value:null==(r=a.get)?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!_g(r)?r:r===tf(e.base_,t)?(af(e),e.copy_[t]=sf(r,e)):r},has:(e,t)=>t in Ig(e),ownKeys:e=>Reflect.ownKeys(Ig(e)),set(e,t,n){const r=nf(Ig(e),t);if(null==r?void 0:r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=tf(Ig(e),t),a=null==r?void 0:r[wg];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,r)&&(void 0!==n||Tg(e.base_,t)))return!0;af(e),rf(e)}return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==tf(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,af(e),rf(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Ig(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){Ng(11)},getPrototypeOf:e=>Sg(e.base_),setPrototypeOf(){Ng(12)}},ef={};function tf(e,t){const n=e[wg];return(n?Ig(n):e)[t]}function nf(e,t){if(!(t in e))return;let n=Sg(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Sg(n)}}function rf(e){e.modified_||(e.modified_=!0,e.parent_&&rf(e.parent_))}function af(e){e.copy_||(e.copy_=Og(e.base_,e.scope_.immer_.useStrictShallowCopy_))}kg(Zg,(e,t)=>{ef[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),ef.deleteProperty=function(e,t){return ef.set.call(this,e,t,void 0)},ef.set=function(e,t,n){return Zg.set.call(this,e[0],t,n,e[0])};function sf(e,t){const n=Dg(e)?Hg("MapSet").proxyMap_(e,t):Rg(e)?Hg("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Gg(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,i=Zg;n&&(a=[r],i=ef);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return r.draft_=o,r.revoke_=s,o}(e,t);return(t?t.scope_:Gg()).drafts_.push(n),n}function of(e){return jg(e)||Ng(10),lf(e)}function lf(e){if(!_g(e)||Fg(e))return e;const t=e[wg];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Og(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=Og(e,!0);return kg(n,(e,t)=>{Pg(n,e,lf(t))},r),t&&(t.finalized_=!1),n}var cf=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const r=this;return function(e=n,...a){return r.produce(e,e=>t.call(this,e,...a))}}let r;if("function"!=typeof t&&Ng(6),void 0!==n&&"function"!=typeof n&&Ng(7),_g(e)){const a=Yg(this),i=sf(e,void 0);let s=!0;try{r=t(i),s=!1}finally{s?$g(a):Wg(a)}return Vg(a,n),Kg(r,a)}if(!e||"object"!=typeof e){if(r=t(e),void 0===r&&(r=e),r===vg&&(r=void 0),this.autoFreeze_&&Bg(r,!0),n){const t=[],a=[];Hg("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}Ng(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,r;return[this.produce(e,t,(e,t)=>{n=e,r=t}),n,r]},"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof(null==e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"==typeof(null==e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){_g(e)||Ng(8),jg(e)&&(e=of(e));const t=Yg(this),n=sf(e,void 0);return n[wg].isManual_=!0,Wg(t),n}finishDraft(e,t){const n=e&&e[wg];n&&n.isManual_||Ng(9);const{scope_:r}=n;return Vg(r,t),Kg(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=Hg("Patches").applyPatches_;return jg(e)?r(e,t):this.produce(e,e=>r(e,t))}},df=cf.produce,uf=cf.setUseStrictIteration.bind(cf);function hf(e){return({dispatch:t,getState:n})=>r=>a=>"function"==typeof a?a(t,n,e):r(a)}var pf=hf(),mf=hf,gf="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?xg:xg.apply(null,arguments)};function ff(e,t){function n(...n){if(t){let r=t(...n);if(!r)throw new Error(ux(0));return l(l({type:e,payload:r.payload},"meta"in r&&{meta:r.meta}),"error"in r&&{error:r.error})}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>yg(t)&&t.type===e,n}var xf=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function yf(e){return _g(e)?df(e,()=>{}):e}function vf(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var bf="RTK_autoBatch",wf=()=>e=>({payload:e,meta:{[bf]:!0}}),Nf=e=>t=>{setTimeout(t,e)},Sf=(e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let a=!0,i=!1,s=!1;const o=new Set,l="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:Nf(10):"callback"===e.type?e.queueNotification:Nf(e.timeout),c=()=>{s=!1,i&&(i=!1,o.forEach(e=>e()))};return Object.assign({},r,{subscribe(e){const t=r.subscribe(()=>a&&e());return o.add(e),()=>{t(),o.delete(e)}},dispatch(e){var t;try{return a=!(null==(t=null==e?void 0:e.meta)?void 0:t[bf]),i=!a,i&&(s||(s=!0,l(c))),r.dispatch(e)}finally{a=!0}}})};function jf(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=null!=e?e:{};let i=new xf;return t&&(function(e){return"boolean"==typeof e}(t)?i.push(pf):i.push(mf(t.extraArgument))),i},{reducer:n,middleware:r,devTools:a=!0,preloadedState:i,enhancers:s}=e||{};let o,d;if("function"==typeof n)o=n;else{if(!mg(n))throw new Error(ux(1));o=fg(n)}d="function"==typeof r?r(t):t();let u=xg;a&&(u=gf(l({trace:!1},"object"==typeof a&&a)));const h=function(...e){return t=>(n,r)=>{const a=t(n,r);let i=()=>{throw new Error(dg(15))};const s={getState:a.getState,dispatch:(e,...t)=>i(e,...t)},o=e.map(e=>e(s));return i=xg(...o)(a.dispatch),c(l({},a),{dispatch:i})}}(...d),p=(e=>function(t){const{autoBatch:n=!0}=null!=t?t:{};let r=new xf(e);return n&&r.push(Sf("object"==typeof n?n:void 0)),r})(h);return gg(o,i,u(..."function"==typeof s?s(p):p()))}function _f(e){const t={},n=[];let r;const a={addCase(e,n){const r="string"==typeof e?e:e.type;if(!r)throw new Error(ux(28));if(r in t)throw new Error(ux(29));return t[r]=n,a},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),a),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),a),addDefaultCase:e=>(r=e,a)};return e(a),[t,n,r]}uf(!1);var Af=(e=21)=>{let t="",n=e;for(;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},Cf=Symbol.for("rtk-slice-createasyncthunk");function Mf(e,t){return`${e}/${t}`}function kf({creators:e}={}){var t;const n=null==(t=null==e?void 0:e.asyncThunk)?void 0:t[Cf];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error(ux(11));const a=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return l({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},i=Object.keys(a),s={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},o={addCase(e,t){const n="string"==typeof e?e:e.type;if(!n)throw new Error(ux(12));if(n in s.sliceCaseReducersByType)throw new Error(ux(13));return s.sliceCaseReducersByType[n]=t,o},addMatcher:(e,t)=>(s.sliceMatchers.push({matcher:e,reducer:t}),o),exposeAction:(e,t)=>(s.actionCreators[e]=t,o),exposeCaseReducer:(e,t)=>(s.sliceCaseReducersByName[e]=t,o)};function u(){const[t={},n=[],r]="function"==typeof e.extraReducers?_f(e.extraReducers):[e.extraReducers],a=l(l({},t),s.sliceCaseReducersByType);return function(e,t){let n,[r,a,i]=_f(t);if(function(e){return"function"==typeof e}(e))n=()=>yf(e());else{const t=yf(e);n=()=>t}function s(e=n(),t){let s=[r[t.type],...a.filter(({matcher:e})=>e(t)).map(({reducer:e})=>e)];return 0===s.filter(e=>!!e).length&&(s=[i]),s.reduce((e,n)=>{if(n){if(jg(e)){const r=n(e,t);return void 0===r?e:r}if(_g(e))return df(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return s.getInitialState=n,s}(e.initialState,e=>{for(let t in a)e.addCase(t,a[t]);for(let t of s.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}i.forEach(r=>{const i=a[r],s={reducerName:r,type:Mf(t,r),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(i)?function({type:e,reducerName:t,createNotation:n},r,a){let i,s;if("reducer"in r){if(n&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(r))throw new Error(ux(17));i=r.reducer,s=r.prepare}else i=r;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?ff(e,s):ff(e))}(s,i,o):function({type:e,reducerName:t},n,r,a){if(!a)throw new Error(ux(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:l,settled:c,options:d}=n,u=a(e,i,d);r.exposeAction(t,u),s&&r.addCase(u.fulfilled,s);o&&r.addCase(u.pending,o);l&&r.addCase(u.rejected,l);c&&r.addMatcher(u.settled,c);r.exposeCaseReducer(t,{fulfilled:s||Pf,pending:o||Pf,rejected:l||Pf,settled:c||Pf})}(s,i,o,n)});const h=e=>e,p=new Map,m=new WeakMap;let g;function f(e,t){return g||(g=u()),g(e,t)}function x(){return g||(g=u()),g.getInitialState()}function y(t,n=!1){function r(e){let a=e[t];return void 0===a&&n&&(a=vf(m,r,x)),a}function a(t=h){const r=vf(p,n,()=>new WeakMap);return vf(r,t,()=>{var r;const a={};for(const[i,s]of Object.entries(null!=(r=e.selectors)?r:{}))a[i]=Ef(s,t,()=>vf(m,t,x),n);return a})}return{reducerPath:t,getSelectors:a,get selectors(){return a(r)},selectSlice:r}}const v=c(l({name:t,reducer:f,actions:s.actionCreators,caseReducers:s.sliceCaseReducersByName,getInitialState:x},y(r)),{injectInto(e,t={}){var n=t,{reducerPath:a}=n,i=d(n,["reducerPath"]);const s=null!=a?a:r;return e.inject({reducerPath:s,reducer:f},i),l(l({},v),y(s,!0))}});return v}}function Ef(e,t,n,r){function a(a,...i){let s=t(a);return void 0===s&&r&&(s=n()),e(s,...i)}return a.unwrapped=e,a}var Tf=kf();function Pf(){}var Df="listener",Rf="completed",If="cancelled",Of=`task-${If}`,Bf=`task-${Rf}`,Lf=`${Df}-${If}`,Ff=`${Df}-${Rf}`,Uf=class{constructor(e){u(this,"name","TaskAbortError"),u(this,"message"),this.code=e,this.message=`task ${If} (reason: ${e})`}},zf=(e,t)=>{if("function"!=typeof e)throw new TypeError(ux(32))},Hf=()=>{},Gf=(e,t=Hf)=>(e.catch(t),e),Vf=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),$f=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Wf=e=>{if(e.aborted){const{reason:t}=e;throw new Uf(t)}};function Yf(e,t){let n=Hf;return new Promise((r,a)=>{const i=()=>a(new Uf(e.reason));e.aborted?i():(n=Vf(e,i),t.finally(()=>n()).then(r,a))}).finally(()=>{n=Hf})}var Xf=e=>t=>Gf(Yf(e,t).then(t=>(Wf(e),t))),Kf=e=>{const t=Xf(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:qf}=Object,Jf={},Qf="listenerMiddleware",Zf=(e,t)=>(n,r)=>{zf(n);const a=new AbortController;var i;i=a,Vf(e,()=>$f(i,e.reason));const s=(o=()=>h(null,null,function*(){Wf(e),Wf(a.signal);const t=yield n({pause:Xf(a.signal),delay:Kf(a.signal),signal:a.signal});return Wf(a.signal),t}),l=()=>$f(a,Bf),h(null,null,function*(){try{return yield Promise.resolve(),{status:"ok",value:yield o()}}catch(e){return{status:e instanceof Uf?"cancelled":"rejected",error:e}}finally{null==l||l()}}));var o,l;return(null==r?void 0:r.autoJoin)&&t.push(s.catch(Hf)),{result:Xf(e)(s),cancel(){$f(a,Of)}}},ex=(e,t)=>(n,r)=>Gf(((n,r)=>h(null,null,function*(){Wf(t);let a=()=>{};const i=[new Promise((t,r)=>{let i=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});a=()=>{i(),r()}})];null!=r&&i.push(new Promise(e=>setTimeout(e,r,null)));try{const e=yield Yf(t,Promise.race(i));return Wf(t),e}finally{a()}}))(n,r)),tx=e=>{let{type:t,actionCreator:n,matcher:r,predicate:a,effect:i}=e;if(t)a=ff(t).match;else if(n)t=n.type,a=n.match;else if(r)a=r;else if(!a)throw new Error(ux(21));return zf(i),{predicate:a,type:t,effect:i}},nx=qf(e=>{const{type:t,predicate:n,effect:r}=tx(e);return{id:Af(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(ux(22))}}},{withTypes:()=>nx}),rx=(e,t)=>{const{type:n,effect:r,predicate:a}=tx(t);return Array.from(e.values()).find(e=>("string"==typeof n?e.type===n:e.predicate===a)&&e.effect===r)},ax=e=>{e.pending.forEach(e=>{$f(e,Lf)})},ix=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},sx=qf(ff(`${Qf}/add`),{withTypes:()=>sx}),ox=ff(`${Qf}/removeAll`),lx=qf(ff(`${Qf}/remove`),{withTypes:()=>lx}),cx=(...e)=>{console.error(`${Qf}/error`,...e)},dx=(e={})=>{const t=new Map,n=new Map,{extra:r,onError:a=cx}=e;zf(a);const i=e=>{var n;return(e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),(null==t?void 0:t.cancelActive)&&ax(e)}))(null!=(n=rx(t,e))?n:nx(e))};qf(i,{withTypes:()=>i});const s=e=>{const n=rx(t,e);return n&&(n.unsubscribe(),e.cancelActive&&ax(n)),!!n};qf(s,{withTypes:()=>s});const o=(e,s,o,l)=>h(null,null,function*(){const c=new AbortController,d=ex(i,c.signal),u=[];try{e.pending.add(c),(e=>{var t;const r=null!=(t=n.get(e))?t:0;n.set(e,r+1)})(e),yield Promise.resolve(e.effect(s,qf({},o,{getOriginalState:l,condition:(e,t)=>d(e,t).then(Boolean),take:d,delay:Kf(c.signal),pause:Xf(c.signal),extra:r,signal:c.signal,fork:Zf(c.signal,u),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,n)=>{e!==c&&($f(e,Lf),n.delete(e))})},cancel:()=>{$f(c,Lf),e.pending.delete(c)},throwIfCancelled:()=>{Wf(c.signal)}})))}catch(h){h instanceof Uf||ix(a,h,{raisedBy:"effect"})}finally{yield Promise.all(u),$f(c,Ff),(e=>{var t;const r=null!=(t=n.get(e))?t:1;1===r?n.delete(e):n.set(e,r-1)})(e),e.pending.delete(c)}}),l=((e,t)=>()=>{for(const e of t.keys())ax(e);e.clear()})(t,n);return{middleware:e=>n=>r=>{if(!yg(r))return n(r);if(sx.match(r))return i(r.payload);if(ox.match(r))return void l();if(lx.match(r))return s(r.payload);let c=e.getState();const d=()=>{if(c===Jf)throw new Error(ux(23));return c};let u;try{if(u=n(r),t.size>0){const n=e.getState(),i=Array.from(t.values());for(const t of i){let i=!1;try{i=t.predicate(r,n,c)}catch(h){i=!1,ix(a,h,{raisedBy:"predicate"})}i&&o(t,r,e,d)}}}finally{c=Jf}return u},startListening:i,stopListening:s,clearListeners:l}};function ux(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var hx=Tf({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,a,i;e.margin.top=null!==(n=t.payload.top)&&void 0!==n?n:0,e.margin.right=null!==(r=t.payload.right)&&void 0!==r?r:0,e.margin.bottom=null!==(a=t.payload.bottom)&&void 0!==a?a:0,e.margin.left=null!==(i=t.payload.left)&&void 0!==i?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:px,setLayout:mx,setChartSize:gx,setScale:fx}=hx.actions,xx=hx.reducer;function yx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yx(Object(n),!0).forEach(function(t){bx(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function bx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wx=Math.PI/180,Nx=e=>180*e/Math.PI,Sx=(e,t,n,r)=>({x:e+Math.cos(-wx*r)*n,y:t+Math.sin(-wx*r)*n}),jx=(e,t)=>{var{x:n,y:r}=e,{cx:a,cy:i}=t,o=((e,t)=>{var{x:n,y:r}=e,{x:a,y:i}=t;return Math.sqrt(s(n-a,2)+s(r-i,2))})({x:n,y:r},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var l=(n-a)/o,c=Math.acos(l);return r>i&&(c=2*Math.PI-c),{radius:o,angle:Nx(c),angleInRadian:c}},_x=(e,t)=>{var{startAngle:n,endAngle:r}=t,a=Math.floor(n/360),i=Math.floor(r/360);return e+360*Math.min(a,i)},Ax=(e,t)=>{var{x:n,y:r}=e,{radius:a,angle:i}=jx({x:n,y:r},t),{innerRadius:s,outerRadius:o}=t;if(a<s||a>o)return null;if(0===a)return null;var l,{startAngle:c,endAngle:d}=(e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),a=Math.floor(n/360),i=Math.min(r,a);return{startAngle:t-360*i,endAngle:n-360*i}})(t),u=i;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;l=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;l=u>=d&&u<=c}return l?vx(vx({},t),{},{radius:a,angle:_x(u,t)}):null};function Cx(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function Mx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function kx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mx(Object(n),!0).forEach(function(t){Ex(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ex(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tx(e,t,n){return xh(e)||xh(t)?n:dh(t)?ih(e,t,n):"function"==typeof t?t(e):n}var Px=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,Dx=(e,t,n,r)=>{if(r)return e.map(e=>e.coordinate);var a,i,s=e.map(e=>(e.coordinate===t&&(a=!0),e.coordinate===n&&(i=!0),e.coordinate));return a||s.push(t),i||s.push(n),s},Rx=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:a,range:i,scale:s,realScaleType:o,isCategorical:l,categoricalDomain:c,tickCount:d,ticks:u,niceTicks:h,axisType:p}=e;if(!s)return null;var m="scaleBand"===o&&s.bandwidth?s.bandwidth()/2:2,g="category"===a&&s.bandwidth?s.bandwidth()/m:0;return g="angleAxis"===p&&i&&i.length>=2?2*sh(i[0]-i[1])*g:g,u||h?(u||h||[]).map((e,t)=>{var n=r?r.indexOf(e):e;return{coordinate:s(n)+g,value:e,offset:g,index:t}}).filter(e=>!oh(e.coordinate)):l&&c?c.map((e,t)=>({coordinate:s(e)+g,value:e,index:t,offset:g})):s.ticks&&null!=d?s.ticks(d).map((e,t)=>({coordinate:s(e)+g,value:e,offset:g,index:t})):s.domain().map((e,t)=>({coordinate:s(e)+g,value:r?r[e]:e,index:t,offset:g}))},Ix=1e-4,Ox={sign:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,i=0,s=0;s<t;++s){var o=oh(e[s][n][1])?e[s][n][0]:e[s][n][1];o>=0?(e[s][n][0]=a,e[s][n][1]=a+o,a=e[s][n][1]):(e[s][n][0]=i,e[s][n][1]=i+o,i=e[s][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,a,i=0,s=e[0].length;i<s;++i){for(a=n=0;n<r;++n)a+=e[n][i][1]||0;if(a)for(n=0;n<r;++n)e[n][i][1]/=a}Ru(e,t)}},none:Ru,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],i=a.length;r<i;++r){for(var s=0,o=0;s<n;++s)o+=e[s][r][1]||0;a[r][1]+=a[r][0]=-o/2}Ru(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,i=0,s=1;s<r;++s){for(var o=0,l=0,c=0;o<a;++o){for(var d=e[t[o]],u=d[s][1]||0,h=(u-(d[s-1][1]||0))/2,p=0;p<o;++p){var m=e[t[p]];h+=(m[s][1]||0)-(m[s-1][1]||0)}l+=u,c+=h*u}n[s-1][1]+=n[s-1][0]=i,l&&(i-=c/l)}n[s-1][1]+=n[s-1][0]=i,Ru(e,t)}},positive:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,i=0;i<t;++i){var s=oh(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=0,e[i][n][1]=0)}}},Bx=(e,t,n)=>{var r=Ox[n],a=function(){var e=Rd([]),t=Iu,n=Ru,r=Ou;function a(a){var i,s,o=Array.from(e.apply(this,arguments),Bu),l=o.length,c=-1;for(const e of a)for(i=0,++c;i<l;++i)(o[i][c]=[0,+r(e,o[i].key,c,a)]).data=e;for(i=0,s=Yd(t(o));i<l;++i)o[s[i]].index=i;return n(o,s),o}return a.keys=function(t){return arguments.length?(e="function"==typeof t?t:Rd(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"==typeof e?e:Rd(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?Iu:"function"==typeof e?e:Rd(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?Ru:e,a):n},a}().keys(t).value((e,t)=>+Tx(e,t,0)).order(Iu).offset(r);return a(e)};function Lx(e){var{axis:t,ticks:n,bandSize:r,entry:a,index:i,dataKey:s}=e;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!xh(a[t.dataKey])){var o=fh(n,"value",a[t.dataKey]);if(o)return o.coordinate+r/2}return n[i]?n[i].coordinate+r/2:null}var l=Tx(a,xh(s)?t.dataKey:s);return xh(l)?null:t.scale(l)}var Fx=e=>{var{axis:t,ticks:n,offset:r,bandSize:a,entry:i,index:s}=e;if("category"===t.type)return n[s]?n[s].coordinate+r:null;var o=Tx(i,t.dataKey,t.scale.domain()[s]);return xh(o)?null:t.scale(o)-a/2+r},Ux=(e,t,n)=>{var r;if(null!=e)return[(r=Object.keys(e).reduce((r,a)=>{var i=e[a],{stackedData:s}=i,o=s.reduce((e,r)=>{var a,i=Cx(r,t,n),s=(a=i.flat(2).filter(ch),[Math.min(...a),Math.max(...a)]);return[Math.min(e[0],s[0]),Math.max(e[1],s[1])]},[1/0,-1/0]);return[Math.min(o[0],r[0]),Math.max(o[1],r[1])]},[1/0,-1/0]))[0]===1/0?0:r[0],r[1]===-1/0?0:r[1]]},zx=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Hx=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Gx=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=sg(t,e=>e.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var l=a[s],c=a[s-1];i=Math.min((l.coordinate||0)-(c.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0};function Vx(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:a,name:i}=e;return kx(kx({},t),{},{dataKey:n,payload:r,value:a,name:i})}function $x(e,t){return e?String(e):"string"==typeof t?t:void 0}var Wx=e=>e.layout.width,Yx=e=>e.layout.height,Xx=e=>e.layout.scale,Kx=e=>e.layout.margin,qx=Om(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Jx=Om(e=>e.cartesianAxis.yAxis,e=>Object.values(e));function Qx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Zx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qx(Object(n),!0).forEach(function(t){ey(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ey(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ty,ny,ry,ay,iy,sy=Om([Wx,Yx,Kx,e=>e.brush.height,function(e){return Jx(e).reduce((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"==typeof t.width?t.width:60),0)},function(e){return Jx(e).reduce((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"==typeof t.width?t.width:60),0)},function(e){return qx(e).reduce((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},function(e){return qx(e).reduce((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},og,e=>e.legend.size],(e,t,n,r,a,i,s,o,l,c)=>{var d={left:(n.left||0)+a,right:(n.right||0)+i},u=Zx(Zx({},{top:(n.top||0)+s,bottom:(n.bottom||0)+o}),d),h=u.bottom;u.bottom+=r,u=((e,t,n)=>{if(t&&n){var{width:r,height:a}=n,{align:i,verticalAlign:s,layout:o}=t;if(("vertical"===o||"horizontal"===o&&"middle"===s)&&"center"!==i&&ch(e[i]))return kx(kx({},e),{},{[i]:e[i]+(r||0)});if(("horizontal"===o||"vertical"===o&&"center"===i)&&"middle"!==s&&ch(e[s]))return kx(kx({},e),{},{[s]:e[s]+(a||0)})}return e})(u,l,c);var p=e-u.left-u.right,m=t-u.top-u.bottom;return Zx(Zx({brushBottom:h},u),{},{width:Math.max(p,0),height:Math.max(m,0)})}),oy=Om(sy,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ly=Om(Wx,Yx,(e,t)=>({x:0,y:0,width:e,height:t})),cy=f.createContext(null),dy=()=>null!=f.useContext(cy),uy=e=>e.brush,hy=Om([uy,sy,Kx],(e,t,n)=>({height:e.height,x:ch(e.x)?e.x:t.left,y:ch(e.y)?e.y:t.top+t.height+t.brushBottom-((null==n?void 0:n.bottom)||0),width:ch(e.width)?e.width:t.width})),py={},my={},gy={};function fy(){return ty||(ty=1,e=gy,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.debounce=function(e,t,{signal:n,edges:r}={}){let a,i=null;const s=null!=r&&r.includes("leading"),o=null==r||r.includes("trailing"),l=()=>{null!==i&&(e.apply(a,i),a=void 0,i=null)};let c=null;const d=()=>{null!=c&&clearTimeout(c),c=setTimeout(()=>{c=null,o&&l(),u()},t)},u=()=>{null!==c&&(clearTimeout(c),c=null),a=void 0,i=null},h=function(...e){if(null==n?void 0:n.aborted)return;a=this,i=e;const t=null==c;d(),s&&t&&l()};return h.schedule=d,h.cancel=u,h.flush=()=>{l()},null==n||n.addEventListener("abort",u,{once:!0}),h}),gy;var e}function xy(){return ny||(ny=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fy();e.debounce=function(e,n=0,r={}){"object"!=typeof r&&(r={});const{leading:a=!1,trailing:i=!0,maxWait:s}=r,o=Array(2);let l;a&&(o[0]="leading"),i&&(o[1]="trailing");let c=null;const d=t.debounce(function(...t){l=e.apply(this,t),c=null},n,{edges:o}),u=function(...t){return null!=s&&(null===c&&(c=Date.now()),Date.now()-c>=s)?(l=e.apply(this,t),c=Date.now(),d.cancel(),d.schedule(),l):(d.apply(this,t),l)};return u.cancel=d.cancel,u.flush=()=>(d.flush(),l),u}}(my)),my}function yy(){return iy?ay:(iy=1,ay=(ry||(ry=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xy();e.throttle=function(e,n=0,r={}){const{leading:a=!0,trailing:i=!0}=r;return t.debounce(e,n,{leading:a,maxWait:n,trailing:i})}}(py)),py).throttle)}const vy=g(yy());var by=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]},wy=(e,t,n)=>{var{width:r="100%",height:a="100%",aspect:i,maxHeight:s}=n,o=lh(r)?e:Number(r),l=lh(a)?t:Number(a);return i&&i>0&&(o?l=o/i:l&&(o=l*i),s&&l>s&&(l=s)),{calculatedWidth:o,calculatedHeight:l}},Ny={width:0,height:0,overflow:"visible"},Sy={width:0,overflowX:"visible"},jy={height:0,overflowY:"visible"},_y={},Ay=e=>{var{width:t,height:n}=e,r=lh(t),a=lh(n);return r&&a?Ny:r?Sy:a?jy:_y};function Cy(e){return Number.isFinite(e)}function My(e){return"number"==typeof e&&e>0&&Number.isFinite(e)}function ky(){return ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ky.apply(null,arguments)}function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ty(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ey(Object(n),!0).forEach(function(t){Py(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Py(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dy=f.createContext({width:-1,height:-1});function Ry(e){var{children:t,width:n,height:r}=e,a=f.useMemo(()=>({width:n,height:r}),[n,r]);return n<=0||r<=0?null:f.createElement(Dy.Provider,{value:a},t)}var Iy=()=>f.useContext(Dy),Oy=f.forwardRef((e,t)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:o,maxHeight:l,children:c,debounce:d=0,id:u,className:h,onResize:p,style:m={}}=e,g=f.useRef(null),x=f.useRef();x.current=p,f.useImperativeHandle(t,()=>g.current);var[y,v]=f.useState({containerWidth:r.width,containerHeight:r.height}),b=f.useCallback((e,t)=>{v(n=>{var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]);f.useEffect(()=>{var e=e=>{var t,{width:n,height:r}=e[0].contentRect;b(n,r),null===(t=x.current)||void 0===t||t.call(x,n,r)};d>0&&(e=vy(e,d,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=g.current.getBoundingClientRect();return b(n,r),t.observe(g.current),()=>{t.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:N}=y;by(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:S,calculatedHeight:j}=wy(w,N,{width:a,height:i,aspect:n,maxHeight:l});return by(S>0||j>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",S,j,a,i,s,o,n),f.createElement("div",{id:u?"".concat(u):void 0,className:yd("recharts-responsive-container",h),style:Ty(Ty({},m),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:l}),ref:g},f.createElement("div",{style:Ay({width:a,height:i})},f.createElement(Ry,{width:S,height:j},c)))}),By=f.forwardRef((e,t)=>{var n=Iy();if(My(n.width)&&My(n.height))return e.children;var{width:r,height:a}=function(e){var{width:t,height:n,aspect:r}=e,a=t,i=n;return void 0===a&&void 0===i?(a="100%",i="100%"):void 0===a?a=r&&r>0?void 0:"100%":void 0===i&&(i=r&&r>0?void 0:"100%"),{width:a,height:i}}({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=wy(void 0,void 0,{width:r,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return ch(i)&&ch(s)?f.createElement(Ry,{width:i,height:s},e.children):f.createElement(Oy,ky({},e,{width:r,height:a,ref:t}))}),Ly=()=>{var e,t=dy(),n=Mm(oy),r=Mm(hy),a=null===(e=Mm(uy))||void 0===e?void 0:e.padding;return t&&r&&a?{width:r.width-a.left-a.right,height:r.height-a.top-a.bottom,x:a.left,y:a.top}:n},Fy={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Uy=()=>{var e;return null!==(e=Mm(sy))&&void 0!==e?e:Fy},zy=()=>Mm(Wx),Hy=()=>Mm(Yx),Gy=e=>e.layout.layoutType,Vy=()=>Mm(Gy),$y=e=>{var t=jm(),n=dy(),{width:r,height:a}=e,i=Iy(),s=r,o=a;return i&&(s=i.width>0?i.width:r,o=i.height>0?i.height:a),f.useEffect(()=>{!n&&My(s)&&My(o)&&t(gx({width:s,height:o}))},[t,n,s,o]),null},Wy=Tf({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:wf()},removeLegendPayload:{reducer(e,t){var n=of(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:wf()}}}),{setLegendSize:Yy,setLegendSettings:Xy,addLegendPayload:Ky,removeLegendPayload:qy}=Wy.actions,Jy=Wy.reducer,Qy=["contextPayload"];function Zy(){return Zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zy.apply(null,arguments)}function ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ev(Object(n),!0).forEach(function(t){nv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ev(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rv(e){return e.value}function av(e){var{contextPayload:t}=e,n=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Qy),r=dm(t,e.payloadUniqBy,rv),a=tv(tv({},n),{},{payload:r});return f.isValidElement(e.content)?f.cloneElement(e.content,a):"function"==typeof e.content?f.createElement(e.content,a):f.createElement(Dh,a)}function iv(e){var t=jm();return f.useEffect(()=>{t(Xy(e))},[t,e]),null}function sv(e){var t=jm();return f.useEffect(()=>(t(Yy(e)),()=>{t(Yy({width:0,height:0}))}),[t,e]),null}function ov(e){var t=Mm(lg),n=f.useContext(Dd),r=Mm(e=>e.layout.margin),{width:a,height:i,wrapperStyle:s,portal:o}=e,[l,c]=cg([t]),d=zy(),u=Hy();if(null==d||null==u)return null;var h=d-(r.left||0)-(r.right||0),p=lv.getWidthOrHeight(e.layout,i,a,h),m=o?s:tv(tv({position:"absolute",width:(null==p?void 0:p.width)||a||"auto",height:(null==p?void 0:p.height)||i||"auto"},function(e,t,n,r,a,i){var s,o,{layout:l,align:c,verticalAlign:d}=t;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(s="center"===c&&"vertical"===l?{left:((r||0)-i.width)/2}:"right"===c?{right:n&&n.right||0}:{left:n&&n.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(o="middle"===d?{top:((a||0)-i.height)/2}:"bottom"===d?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),tv(tv({},s),o)}(s,e,r,d,u,l)),s),g=null!=o?o:n;if(null==g)return null;var x=f.createElement("div",{className:"recharts-legend-wrapper",style:m,ref:c},f.createElement(iv,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),f.createElement(sv,{width:l.width,height:l.height}),f.createElement(av,Zy({},e,p,{margin:r,chartWidth:d,chartHeight:u,contextPayload:t})));return b.createPortal(x,g)}class lv extends f.PureComponent{static getWidthOrHeight(e,t,n,r){return"vertical"===e&&ch(t)?{height:t}:"horizontal"===e?{width:n||r}:null}render(){return f.createElement(ov,this.props)}}function cv(){return cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cv.apply(null,arguments)}function dv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function uv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dv(Object(n),!0).forEach(function(t){hv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pv(e){return Array.isArray(e)&&dh(e[0])&&dh(e[1])?e.join(" ~ "):e}nv(lv,"displayName","Legend"),nv(lv,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});var mv=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:r={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:c,label:d,labelFormatter:u,accessibilityLayer:h=!1}=e,p=uv({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),m=uv({margin:0},a),g=!xh(d),x=g?d:"",y=yd("recharts-default-tooltip",l),v=yd("recharts-tooltip-label",c);g&&u&&null!=i&&(x=u(d,i));var b=h?{role:"status","aria-live":"assertive"}:{};return f.createElement("div",cv({className:y,style:p},b),f.createElement("p",{className:v,style:m},f.isValidElement(x)?x:"".concat(x)),(()=>{if(i&&i.length){var e=(o?sg(i,o):i).map((e,n)=>{if("none"===e.type)return null;var a=e.formatter||s||pv,{value:o,name:l}=e,c=o,d=l;if(a){var u=a(o,l,e,n,i);if(Array.isArray(u))[c,d]=u;else{if(null==u)return null;c=u}}var h=uv({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},r);return f.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(n),style:h},dh(d)?f.createElement("span",{className:"recharts-tooltip-item-name"},d):null,dh(d)?f.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,f.createElement("span",{className:"recharts-tooltip-item-value"},c),f.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return f.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},gv="recharts-tooltip-wrapper",fv={visibility:"hidden"};function xv(e){var{coordinate:t,translateX:n,translateY:r}=e;return yd(gv,{["".concat(gv,"-right")]:ch(n)&&t&&ch(t.x)&&n>=t.x,["".concat(gv,"-left")]:ch(n)&&t&&ch(t.x)&&n<t.x,["".concat(gv,"-bottom")]:ch(r)&&t&&ch(t.y)&&r>=t.y,["".concat(gv,"-top")]:ch(r)&&t&&ch(t.y)&&r<t.y})}function yv(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=e;if(i&&ch(i[r]))return i[r];var d=n[r]-o-(a>0?a:0),u=n[r]+a;if(t[r])return s[r]?d:u;var h=l[r];return null==h?0:s[r]?d<h?Math.max(u,h):Math.max(d,h):null==c?0:u+o>h+c?Math.max(d,h):Math.max(u,h)}function vv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vv(Object(n),!0).forEach(function(t){wv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Nv extends f.PureComponent{constructor(){super(...arguments),wv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),wv(this,"handleKeyDown",e=>{var t,n,r,a;"Escape"===e.key&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(t=null===(n=this.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==t?t:0,y:null!==(r=null===(a=this.props.coordinate)||void 0===a?void 0:a.y)&&void 0!==r?r:0}})})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}render(){var{active:e,allowEscapeViewBox:t,animationDuration:n,animationEasing:r,children:a,coordinate:i,hasPayload:s,isAnimationActive:o,offset:l,position:c,reverseDirection:d,useTranslate3d:u,viewBox:h,wrapperStyle:p,lastBoundingBox:m,innerRef:g,hasPortalFromProps:x}=this.props,{cssClasses:y,cssProperties:v}=function(e){var t,n,r,{allowEscapeViewBox:a,coordinate:i,offsetTopLeft:s,position:o,reverseDirection:l,tooltipBox:c,useTranslate3d:d,viewBox:u}=e;return t=c.height>0&&c.width>0&&i?function(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:n=yv({allowEscapeViewBox:a,coordinate:i,key:"x",offsetTopLeft:s,position:o,reverseDirection:l,tooltipDimension:c.width,viewBox:u,viewBoxDimension:u.width}),translateY:r=yv({allowEscapeViewBox:a,coordinate:i,key:"y",offsetTopLeft:s,position:o,reverseDirection:l,tooltipDimension:c.height,viewBox:u,viewBoxDimension:u.height}),useTranslate3d:d}):fv,{cssProperties:t,cssClasses:xv({translateX:n,translateY:r,coordinate:i})}}({allowEscapeViewBox:t,coordinate:i,offsetTopLeft:l,position:c,reverseDirection:d,tooltipBox:{height:m.height,width:m.width},useTranslate3d:u,viewBox:h}),b=x?{}:bv(bv({transition:o&&e?"transform ".concat(n,"ms ").concat(r):void 0},v),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&s?"visible":"hidden",position:"absolute",top:0,left:0}),w=bv(bv({},b),{},{visibility:!this.state.dismissed&&e&&s?"visible":"hidden"},p);return f.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:w,ref:g},a)}}var Sv=!1,jv=!("undefined"!=typeof window&&window.document&&Boolean(window.document.createElement)&&window.setTimeout),_v=()=>Mm(e=>e.rootProps.accessibilityLayer);function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Av.apply(null,arguments)}function Cv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cv(Object(n),!0).forEach(function(t){kv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function kv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ev={curveBasisClosed:function(e){return new wu(e)},curveBasisOpen:function(e){return new Nu(e)},curveBasis:function(e){return new bu(e)},curveBumpX:function(e){return new eu(e,!0)},curveBumpY:function(e){return new eu(e,!1)},curveLinearClosed:function(e){return new Su(e)},curveLinear:Kd,curveMonotoneX:function(e){return new Mu(e)},curveMonotoneY:function(e){return new ku(e)},curveNatural:function(e){return new Tu(e)},curveStep:function(e){return new Du(e,.5)},curveStepAfter:function(e){return new Du(e,1)},curveStepBefore:function(e){return new Du(e,0)}},Tv=e=>Cy(e.x)&&Cy(e.y),Pv=e=>e.x,Dv=e=>e.y,Rv=e=>{var t,{type:n="linear",points:r=[],baseLine:a,layout:i,connectNulls:s=!1}=e,o=((e,t)=>{if("function"==typeof e)return e;var n="curve".concat(yh(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?Ev[n]||Kd:Ev["".concat(n).concat("vertical"===t?"Y":"X")]})(n,i),l=s?r.filter(Tv):r;if(Array.isArray(a)){var c=s?a.filter(e=>Tv(e)):a,d=l.map((e,t)=>Mv(Mv({},e),{},{base:c[t]}));return(t="vertical"===i?Zd().y(Dv).x1(Pv).x0(e=>e.base.x):Zd().x(Pv).y1(Dv).y0(e=>e.base.y)).defined(Tv).curve(o),t(d)}return(t="vertical"===i&&ch(a)?Zd().y(Dv).x1(Pv).x0(a):ch(a)?Zd().x(Pv).y1(Dv).y0(a):Qd().x(Pv).y(Dv)).defined(Tv).curve(o),t(l)},Iv=e=>{var{className:t,points:n,path:r,pathRef:a}=e;if(!(n&&n.length||r))return null;var i=n&&n.length?Rv(e):r;return f.createElement("path",Av({},jd(e),Ch(e),{className:yd("recharts-curve",t),d:null===i?void 0:i,ref:a}))},Ov=["x","y","top","left","width","height","className"];function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bv.apply(null,arguments)}function Lv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Fv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Uv=(e,t,n,r,a,i)=>"M".concat(e,",").concat(a,"v").concat(r,"M").concat(i,",").concat(t,"h").concat(n),zv=e=>{var{x:t=0,y:n=0,top:r=0,left:a=0,width:i=0,height:s=0,className:o}=e,l=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Ov),c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lv(Object(n),!0).forEach(function(t){Fv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({x:t,y:n,top:r,left:a,width:i,height:s},l);return ch(t)&&ch(n)&&ch(i)&&ch(s)&&ch(r)&&ch(a)?f.createElement("path",Bv({},Ad(c),{className:yd("recharts-cross",o),d:Uv(t,n,i,s,r,a)})):null};function Hv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Gv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vv(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hv(Object(n),!0).forEach(function(t){Gv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e),r=t;return Object.keys(t).reduce((e,t)=>(void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t]),e),n)}function $v(){}function Wv(e){return null!=e}function Yv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yv(Object(n),!0).forEach(function(t){Kv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Kv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qv=(e,t,n)=>e.map(e=>{return"".concat((r=e,r.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())))," ").concat(t,"ms ").concat(n);var r}).join(","),Jv=(e,t)=>Object.keys(t).reduce((n,r)=>Xv(Xv({},n),{},{[r]:e(r,t[r])}),{});function Qv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Zv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qv(Object(n),!0).forEach(function(t){eb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tb=(e,t,n)=>e+(t-e)*n,nb=e=>{var{from:t,to:n}=e;return t!==n},rb=(e,t,n)=>{var r=Jv((t,n)=>{if(nb(n)){var[r,a]=e(n.from,n.to,n.velocity);return Zv(Zv({},n),{},{from:r,velocity:a})}return n},t);return n<1?Jv((e,t)=>nb(t)?Zv(Zv({},t),{},{velocity:tb(t.velocity,r[e].velocity,n),from:tb(t.from,r[e].from,n)}):t,t):rb(e,r,n-1)};function ab(e,t,n,r,a,i){var s,o=r.reduce((n,r)=>Zv(Zv({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}}),{}),l=null,c=r=>{s||(s=r);var d=(r-s)/n.dt;o=rb(n,o,d),a(Zv(Zv(Zv({},e),t),Jv((e,t)=>t.from,o))),s=r,Object.values(o).filter(nb).length&&(l=i.setTimeout(c))};return()=>(l=i.setTimeout(c),()=>{l()})}const ib=(e,t,n,r,a,i)=>{var s,o,l=(s=e,o=t,[Object.keys(s),Object.keys(o)].reduce((e,t)=>e.filter(e=>t.includes(e))));return!0===n.isStepper?ab(e,t,n,l,a,i):function(e,t,n,r,a,i,s){var o,l=null,c=a.reduce((n,r)=>Zv(Zv({},n),{},{[r]:[e[r],t[r]]}),{}),d=a=>{o||(o=a);var u=(a-o)/r,h=Jv((e,t)=>tb(...t,n(u)),c);if(i(Zv(Zv(Zv({},e),t),h)),u<1)l=s.setTimeout(d);else{var p=Jv((e,t)=>tb(...t,n(1)),c);i(Zv(Zv(Zv({},e),t),p))}};return()=>(l=s.setTimeout(d),()=>{l()})}(e,t,n,r,l,a,i)};var sb=1e-4,ob=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],lb=(e,t)=>e.map((e,n)=>e*s(t,n)).reduce((e,t)=>e+t),cb=(e,t)=>n=>{var r=ob(e,t);return lb(r,n)},db=function(){for(var e,t,n,r,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];if(1===i.length)switch(i[0]){case"linear":[e,n,t,r]=[0,0,1,1];break;case"ease":[e,n,t,r]=[.25,.1,.25,1];break;case"ease-in":[e,n,t,r]=[.42,0,1,1];break;case"ease-out":[e,n,t,r]=[.42,0,.58,1];break;case"ease-in-out":[e,n,t,r]=[0,0,.58,1];break;default:var o=i[0].split("(");"cubic-bezier"===o[0]&&4===o[1].split(")")[0].split(",").length&&([e,n,t,r]=o[1].split(")")[0].split(",").map(e=>parseFloat(e)))}else 4===i.length&&([e,n,t,r]=i);var l,c,d=cb(e,t),u=cb(n,r),h=(l=e,c=t,e=>{var t=[...ob(l,c).map((e,t)=>e*t).slice(1),0];return lb(t,e)}),p=e=>e>1?1:e<0?0:e,m=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var a=d(n)-t,i=h(n);if(Math.abs(a-t)<sb||i<sb)return u(n);n=p(n-a/i)}return u(n)};return m.isStepper=!1,m},ub=e=>{if("string"==typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return db(e);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:n=8,dt:r=17}=e,a=(e,a,i)=>{var s=i+(-(e-a)*t-i*n)*r/1e3,o=i*r/1e3+e;return Math.abs(o-a)<sb&&Math.abs(s)<sb?[a,0]:[o,s]};return a.isStepper=!0,a.dt=r,a}();default:if("cubic-bezier"===e.split("(")[0])return db(e)}return"function"==typeof e?e:null};class hb{setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=performance.now(),r=null,a=i=>{i-n>=t?e(i):"function"==typeof requestAnimationFrame&&(r=requestAnimationFrame(a))};return r=requestAnimationFrame(a),()=>{cancelAnimationFrame(r)}}}function pb(){return e=new hb,t=()=>null,n=!1,r=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var s=i,[o,...l]=s;return"number"==typeof o?void(r=e.setTimeout(a.bind(null,l),o)):(a(o),void(r=e.setTimeout(a.bind(null,l))))}"string"==typeof i&&t(i),"object"==typeof i&&t(i),"function"==typeof i&&i()}},{stop:()=>{n=!0},start:e=>{n=!1,r&&(r(),r=null),a(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e};var e,t,n,r,a}var mb=f.createContext(pb);var gb={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},fb={t:0},xb={t:1};function yb(e){var t,n,r,a=Vv(e,gb),{isActive:i,canBegin:s,duration:o,easing:l,begin:c,onAnimationEnd:d,onAnimationStart:u,children:h}=a,p=(t=a.animationId,n=a.animationManager,r=f.useContext(mb),f.useMemo(()=>null!=n?n:r(t),[t,n,r])),[m,g]=f.useState(i?fb:xb),x=f.useRef(null);return f.useEffect(()=>{i||g(xb)},[i]),f.useEffect(()=>{if(!i||!s)return $v;var e=ib(fb,xb,ub(l),o,g,p.getTimeoutController());return p.start([u,c,()=>{x.current=e()},o,d]),()=>{p.stop(),x.current&&x.current(),d()}},[i,s,o,l,c,u,d,p]),h(m.t)}function vb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",n=f.useRef(hh(t)),r=f.useRef(e);return r.current!==e&&(n.current=hh(t),r.current=e),n.current}var bb=["radius"],wb=["radius"];function Nb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nb(Object(n),!0).forEach(function(t){jb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function jb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _b(){return _b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_b.apply(null,arguments)}function Ab(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Cb=(e,t,n,r,a)=>{var i,s=Math.min(Math.abs(n)/2,Math.abs(r)/2),o=r>=0?1:-1,l=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0;if(s>0&&a instanceof Array){for(var d=[0,0,0,0],u=0;u<4;u++)d[u]=a[u]>s?s:a[u];i="M".concat(e,",").concat(t+o*d[0]),d[0]>0&&(i+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),i+="L ".concat(e+n-l*d[1],",").concat(t),d[1]>0&&(i+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,",\n        ").concat(e+n,",").concat(t+o*d[1])),i+="L ".concat(e+n,",").concat(t+r-o*d[2]),d[2]>0&&(i+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,",\n        ").concat(e+n-l*d[2],",").concat(t+r)),i+="L ".concat(e+l*d[3],",").concat(t+r),d[3]>0&&(i+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+r-o*d[3])),i+="Z"}else if(s>0&&a===+a&&a>0){var h=Math.min(s,a);i="M ".concat(e,",").concat(t+o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,"\n            L ").concat(e+n-l*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n,",").concat(t+o*h,"\n            L ").concat(e+n,",").concat(t+r-o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n-l*h,",").concat(t+r,"\n            L ").concat(e+l*h,",").concat(t+r,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+r-o*h," Z")}else i="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return i},Mb={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},kb=e=>{var t=Vv(e,Mb),n=f.useRef(null),[r,a]=f.useState(-1);f.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&a(e)}catch(t){}},[]);var{x:i,y:s,width:o,height:l,radius:c,className:d}=t,{animationEasing:u,animationDuration:h,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:g}=t,x=f.useRef(o),y=f.useRef(l),v=f.useRef(i),b=f.useRef(s),w=vb(f.useMemo(()=>({x:i,y:s,width:o,height:l,radius:c}),[i,s,o,l,c]),"rectangle-");if(i!==+i||s!==+s||o!==+o||l!==+l||0===o||0===l)return null;var N=yd("recharts-rectangle",d);if(!g){var S=Ad(t),{radius:j}=S,_=Ab(S,bb);return f.createElement("path",_b({},_,{radius:"number"==typeof c?c:void 0,className:N,d:Cb(i,s,o,l,c)}))}var A=x.current,C=y.current,M=v.current,k=b.current,E="0px ".concat(-1===r?1:r,"px"),T="".concat(r,"px 0px"),P=qv(["strokeDasharray"],h,"string"==typeof u?u:void 0);return f.createElement(yb,{animationId:w,key:w,canBegin:r>0,duration:h,easing:u,isActive:g,begin:p},e=>{var r,a=gh(A,o,e),d=gh(C,l,e),u=gh(M,i,e),h=gh(k,s,e);n.current&&(x.current=a,y.current=d,v.current=u,b.current=h),r=m?e>0?{transition:P,strokeDasharray:T}:{strokeDasharray:E}:{strokeDasharray:T};var p=Ad(t),{radius:g}=p,w=Ab(p,wb);return f.createElement("path",_b({},w,{radius:"number"==typeof c?c:void 0,className:N,d:Cb(u,h,a,d,c),ref:n,style:Sb(Sb({},r),t.style)}))})};function Eb(e){var{cx:t,cy:n,radius:r,startAngle:a,endAngle:i}=e;return{points:[Sx(t,n,r,a),Sx(t,n,r,i)],cx:t,cy:n,radius:r,startAngle:a,endAngle:i}}function Tb(){return Tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tb.apply(null,arguments)}var Pb=e=>{var{cx:t,cy:n,radius:r,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:l}=e,c=o*(s?1:-1)+r,d=Math.asin(o/c)/wx,u=l?a:a+i*d,h=l?a-i*d:a;return{center:Sx(t,n,c,u),circleTangency:Sx(t,n,r,u),lineTangency:Sx(t,n,c*Math.cos(d*wx),h),theta:d}},Db=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:i,endAngle:s}=e,o=((e,t)=>sh(t-e)*Math.min(Math.abs(t-e),359.999))(i,s),l=i+o,c=Sx(t,n,a,i),d=Sx(t,n,a,l),u="M ".concat(c.x,",").concat(c.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(o)>180),",").concat(+(i>l),",\n    ").concat(d.x,",").concat(d.y,"\n  ");if(r>0){var h=Sx(t,n,r,i),p=Sx(t,n,r,l);u+="L ".concat(p.x,",").concat(p.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(o)>180),",").concat(+(i<=l),",\n            ").concat(h.x,",").concat(h.y," Z")}else u+="L ".concat(t,",").concat(n," Z");return u},Rb={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Ib=e=>{var t=Vv(e,Rb),{cx:n,cy:r,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d,className:u}=t;if(i<a||c===d)return null;var h,p=yd("recharts-sector",u),m=i-a,g=ph(s,m,0,!0);return h=g>0&&Math.abs(c-d)<360?(e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:c}=e,d=sh(c-l),{circleTangency:u,lineTangency:h,theta:p}=Pb({cx:t,cy:n,radius:a,angle:l,sign:d,cornerRadius:i,cornerIsExternal:o}),{circleTangency:m,lineTangency:g,theta:f}=Pb({cx:t,cy:n,radius:a,angle:c,sign:-d,cornerRadius:i,cornerIsExternal:o}),x=o?Math.abs(l-c):Math.abs(l-c)-p-f;if(x<0)return s?"M ".concat(h.x,",").concat(h.y,"\n        a").concat(i,",").concat(i,",0,0,1,").concat(2*i,",0\n        a").concat(i,",").concat(i,",0,0,1,").concat(2*-i,",0\n      "):Db({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:l,endAngle:c});var y="M ".concat(h.x,",").concat(h.y,"\n    A").concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(u.x,",").concat(u.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(x>180),",").concat(+(d<0),",").concat(m.x,",").concat(m.y,"\n    A").concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(g.x,",").concat(g.y,"\n  ");if(r>0){var{circleTangency:v,lineTangency:b,theta:w}=Pb({cx:t,cy:n,radius:r,angle:l,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:N,lineTangency:S,theta:j}=Pb({cx:t,cy:n,radius:r,angle:c,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),_=o?Math.abs(l-c):Math.abs(l-c)-w-j;if(_<0&&0===i)return"".concat(y,"L").concat(t,",").concat(n,"Z");y+="L".concat(S.x,",").concat(S.y,"\n      A").concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(_>180),",").concat(+(d>0),",").concat(v.x,",").concat(v.y,"\n      A").concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,"Z")}else y+="L".concat(t,",").concat(n,"Z");return y})({cx:n,cy:r,innerRadius:a,outerRadius:i,cornerRadius:Math.min(g,m/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}):Db({cx:n,cy:r,innerRadius:a,outerRadius:i,startAngle:c,endAngle:d}),f.createElement("path",Tb({},Ad(t),{className:p,d:h}))};function Ob(e,t,n){var r,a,i,s;if("horizontal"===e)i=r=t.x,a=n.top,s=n.top+n.height;else if("vertical"===e)s=a=t.y,r=n.left,i=n.left+n.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return Eb(t);var{cx:o,cy:l,innerRadius:c,outerRadius:d,angle:u}=t,h=Sx(o,l,c,u),p=Sx(o,l,d,u);r=h.x,a=h.y,i=p.x,s=p.y}return[{x:r,y:a},{x:i,y:s}]}var Bb,Lb,Fb,Ub,zb,Hb={},Gb={},Vb={};function $b(){return Bb||(Bb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ym();e.toNumber=function(e){return t.isSymbol(e)?NaN:Number(e)}}(Vb)),Vb}function Wb(){return Lb||(Lb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$b();e.toFinite=function(e){if(!e)return 0===e?e:0;if((e=t.toNumber(e))===1/0||e===-1/0){return(e<0?-1:1)*Number.MAX_VALUE}return e==e?e:0}}(Gb)),Gb}function Yb(){return zb?Ub:(zb=1,Ub=(Fb||(Fb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ag(),n=Wb();e.range=function(e,r,a){a&&"number"!=typeof a&&t.isIterateeCall(e,r,a)&&(r=a=void 0),e=n.toFinite(e),void 0===r?(r=e,e=0):r=n.toFinite(r),a=void 0===a?e<r?1:-1:n.toFinite(a);const i=Math.max(Math.ceil((r-e)/(a||1)),0),s=new Array(i);for(let t=0;t<i;t++)s[t]=e,e+=a;return s}}(Hb)),Hb).range)}const Xb=g(Yb());function Kb(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function qb(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jb(e){let t,n,r;function a(e,r,a=0,i=e.length){if(a<i){if(0!==t(r,r))return i;do{const t=a+i>>>1;n(e[t],r)<0?a=t+1:i=t}while(a<i)}return a}return 2!==e.length?(t=Kb,n=(t,n)=>Kb(e(t),n),r=(t,n)=>e(t)-n):(t=e===Kb||e===qb?e:Qb,n=e,r=e),{left:a,center:function(e,t,n=0,i=e.length){const s=a(e,t,n,i-1);return s>n&&r(e[s-1],t)>-r(e[s],t)?s-1:s},right:function(e,r,a=0,i=e.length){if(a<i){if(0!==t(r,r))return i;do{const t=a+i>>>1;n(e[t],r)<=0?a=t+1:i=t}while(a<i)}return a}}}function Qb(){return 0}function Zb(e){return null===e?NaN:+e}const ew=Jb(Kb).right;Jb(Zb).center;class tw extends Map{constructor(e,t=rw){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(nw(this,e))}has(e){return super.has(nw(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){const r=t(n);e.has(r)&&(n=e.get(r),e.delete(r));return n}(this,e))}}function nw({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function rw(e){return null!==e&&"object"==typeof e?e.valueOf():e}function aw(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}const iw=Math.sqrt(50),sw=Math.sqrt(10),ow=Math.sqrt(2);function lw(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),i=r/Math.pow(10,a),s=i>=iw?10:i>=sw?5:i>=ow?2:1;let o,l,c;return a<0?(c=Math.pow(10,-a)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=n&&n<2?lw(e,t,2*n):[o,l,c]}function cw(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[a,i,s]=r?lw(t,e,n):lw(e,t,n);if(!(i>=a))return[];const o=i-a+1,l=new Array(o);if(r)if(s<0)for(let c=0;c<o;++c)l[c]=(i-c)/-s;else for(let c=0;c<o;++c)l[c]=(i-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(a+c)/-s;else for(let c=0;c<o;++c)l[c]=(a+c)*s;return l}function dw(e,t,n){return lw(e=+e,t=+t,n=+n)[2]}function uw(e,t,n){n=+n;const r=(t=+t)<(e=+e),a=r?dw(t,e,n):dw(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function hw(e,t){let n;for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);return n}function pw(e,t){let n;for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);return n}function mw(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=void 0===a?aw:function(e=Kb){if(e===Kb)return aw;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}(a);r>n;){if(r-n>600){const i=r-n+1,s=t-n+1,o=Math.log(i),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(i-l)/i)*(s-i/2<0?-1:1);mw(e,t,Math.max(n,Math.floor(t-s*l/i+c)),Math.min(r,Math.floor(t+(i-s)*l/i+c)),a)}const i=e[t];let s=n,o=r;for(gw(e,n,t),a(e[r],i)>0&&gw(e,n,r);s<o;){for(gw(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}0===a(e[n],i)?gw(e,n,o):(++o,gw(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function gw(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function fw(e,t,n=Zb){if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),s=+n(e[i],i,e);return s+(+n(e[i+1],i+1,e)-s)*(a-i)}}function xw(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function yw(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const vw=Symbol("implicit");function bw(){var e=new tw,t=[],n=[],r=vw;function a(a){let i=e.get(a);if(void 0===i){if(r!==vw)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new tw;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return bw(t,n).unknown(r)},xw.apply(a,arguments),a}function ww(){var e,t,n=bw().unknown(void 0),r=n.domain,a=n.range,i=0,s=1,o=!1,l=0,c=0,d=.5;function u(){var n=r().length,u=s<i,h=u?s:i,p=u?i:s;e=(p-h)/Math.max(1,n-l+2*c),o&&(e=Math.floor(e)),h+=(p-h-e*(n-l))*d,t=e*(1-l),o&&(h=Math.round(h),t=Math.round(t));var m=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(n).map(function(t){return h+e*t});return a(u?m.reverse():m)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),u()):r()},n.range=function(e){return arguments.length?([i,s]=e,i=+i,s=+s,u()):[i,s]},n.rangeRound=function(e){return[i,s]=e,i=+i,s=+s,o=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,u()):o},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},n.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),u()):d},n.copy=function(){return ww(r(),[i,s]).round(o).paddingInner(l).paddingOuter(c).align(d)},xw.apply(u(),arguments)}function Nw(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Nw(t())},e}function Sw(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function jw(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _w(){}var Aw=.7,Cw=1/Aw,Mw="\\s*([+-]?\\d+)\\s*",kw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ew="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tw=/^#([0-9a-f]{3,8})$/,Pw=new RegExp(`^rgb\\(${Mw},${Mw},${Mw}\\)$`),Dw=new RegExp(`^rgb\\(${Ew},${Ew},${Ew}\\)$`),Rw=new RegExp(`^rgba\\(${Mw},${Mw},${Mw},${kw}\\)$`),Iw=new RegExp(`^rgba\\(${Ew},${Ew},${Ew},${kw}\\)$`),Ow=new RegExp(`^hsl\\(${kw},${Ew},${Ew}\\)$`),Bw=new RegExp(`^hsla\\(${kw},${Ew},${Ew},${kw}\\)$`),Lw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Fw(){return this.rgb().formatHex()}function Uw(){return this.rgb().formatRgb()}function zw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Tw.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Hw(t):3===n?new $w(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Gw(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Gw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Pw.exec(e))?new $w(t[1],t[2],t[3],1):(t=Dw.exec(e))?new $w(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Rw.exec(e))?Gw(t[1],t[2],t[3],t[4]):(t=Iw.exec(e))?Gw(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ow.exec(e))?Jw(t[1],t[2]/100,t[3]/100,1):(t=Bw.exec(e))?Jw(t[1],t[2]/100,t[3]/100,t[4]):Lw.hasOwnProperty(e)?Hw(Lw[e]):"transparent"===e?new $w(NaN,NaN,NaN,0):null}function Hw(e){return new $w(e>>16&255,e>>8&255,255&e,1)}function Gw(e,t,n,r){return r<=0&&(e=t=n=NaN),new $w(e,t,n,r)}function Vw(e,t,n,r){return 1===arguments.length?((a=e)instanceof _w||(a=zw(a)),a?new $w((a=a.rgb()).r,a.g,a.b,a.opacity):new $w):new $w(e,t,n,null==r?1:r);var a}function $w(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Ww(){return`#${qw(this.r)}${qw(this.g)}${qw(this.b)}`}function Yw(){const e=Xw(this.opacity);return`${1===e?"rgb(":"rgba("}${Kw(this.r)}, ${Kw(this.g)}, ${Kw(this.b)}${1===e?")":`, ${e})`}`}function Xw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Kw(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qw(e){return((e=Kw(e))<16?"0":"")+e.toString(16)}function Jw(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Zw(e,t,n,r)}function Qw(e){if(e instanceof Zw)return new Zw(e.h,e.s,e.l,e.opacity);if(e instanceof _w||(e=zw(e)),!e)return new Zw;if(e instanceof Zw)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,o=i-a,l=(i+a)/2;return o?(s=t===i?(n-r)/o+6*(n<r):n===i?(r-t)/o+2:(t-n)/o+4,o/=l<.5?i+a:2-i-a,s*=60):o=l>0&&l<1?0:s,new Zw(s,o,l,e.opacity)}function Zw(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function eN(e){return(e=(e||0)%360)<0?e+360:e}function tN(e){return Math.max(0,Math.min(1,e||0))}function nN(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Sw(_w,zw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Fw,formatHex:Fw,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qw(this).formatHsl()},formatRgb:Uw,toString:Uw}),Sw($w,Vw,jw(_w,{brighter(e){return e=null==e?Cw:Math.pow(Cw,e),new $w(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Aw:Math.pow(Aw,e),new $w(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $w(Kw(this.r),Kw(this.g),Kw(this.b),Xw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ww,formatHex:Ww,formatHex8:function(){return`#${qw(this.r)}${qw(this.g)}${qw(this.b)}${qw(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Yw,toString:Yw})),Sw(Zw,function(e,t,n,r){return 1===arguments.length?Qw(e):new Zw(e,t,n,null==r?1:r)},jw(_w,{brighter(e){return e=null==e?Cw:Math.pow(Cw,e),new Zw(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Aw:Math.pow(Aw,e),new Zw(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new $w(nN(e>=240?e-240:e+120,a,r),nN(e,a,r),nN(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new Zw(eN(this.h),tN(this.s),tN(this.l),Xw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xw(this.opacity);return`${1===e?"hsl(":"hsla("}${eN(this.h)}, ${100*tN(this.s)}%, ${100*tN(this.l)}%${1===e?")":`, ${e})`}`}}));const rN=e=>()=>e;function aN(e){return 1===(e=+e)?iN:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):rN(isNaN(t)?n:t)}}function iN(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):rN(isNaN(e)?t:e)}const sN=function e(t){var n=aN(t);function r(e,t){var r=n((e=Vw(e)).r,(t=Vw(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),s=iN(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function oN(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function lN(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),s=new Array(r);for(n=0;n<a;++n)i[n]=gN(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<a;++n)s[n]=i[n](e);return s}}function cN(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function dN(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function uN(e,t){var n,r={},a={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=gN(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var hN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pN=new RegExp(hN.source,"g");function mN(e,t){var n,r,a,i=hN.lastIndex=pN.lastIndex=0,s=-1,o=[],l=[];for(e+="",t+="";(n=hN.exec(e))&&(r=pN.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:dN(n,r)})),i=pN.lastIndex;return i<t.length&&(a=t.slice(i),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)o[(n=l[r]).i]=n.x(e);return o.join("")})}function gN(e,t){var n,r=typeof t;return null==t||"boolean"===r?rN(t):("number"===r?dN:"string"===r?(n=zw(t))?(t=n,sN):mN:t instanceof zw?sN:t instanceof Date?cN:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?oN:Array.isArray(t)?lN:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?uN:dN)(e,t)}function fN(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function xN(e){return+e}var yN=[0,1];function vN(e){return e}function bN(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function wN(e,t,n){var r=e[0],a=e[1],i=t[0],s=t[1];return a<r?(r=bN(a,r),i=n(s,i)):(r=bN(r,a),i=n(i,s)),function(e){return i(r(e))}}function NN(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)a[s]=bN(e[s],e[s+1]),i[s]=n(t[s],t[s+1]);return function(t){var n=ew(e,t,1,r)-1;return i[n](a[n](t))}}function SN(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jN(){var e,t,n,r,a,i,s=yN,o=yN,l=gN,c=vN;function d(){var e,t,n,l=Math.min(s.length,o.length);return c!==vN&&(e=s[0],t=s[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?NN:wN,a=i=null,u}function u(t){return null==t||isNaN(t=+t)?n:(a||(a=r(s.map(e),o,l)))(e(c(t)))}return u.invert=function(n){return c(t((i||(i=r(o,s.map(e),dN)))(n)))},u.domain=function(e){return arguments.length?(s=Array.from(e,xN),d()):s.slice()},u.range=function(e){return arguments.length?(o=Array.from(e),d()):o.slice()},u.rangeRound=function(e){return o=Array.from(e),l=fN,d()},u.clamp=function(e){return arguments.length?(c=!!e||vN,d()):c!==vN},u.interpolate=function(e){return arguments.length?(l=e,d()):l},u.unknown=function(e){return arguments.length?(n=e,u):n},function(n,r){return e=n,t=r,d()}}function _N(){return jN()(vN,vN)}function AN(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function CN(e){return(e=AN(Math.abs(e)))?e[1]:NaN}var MN,kN=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function EN(e){if(!(t=kN.exec(e)))throw new Error("invalid format: "+e);var t;return new TN({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function TN(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function PN(e,t){var n=AN(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}EN.prototype=TN.prototype,TN.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const DN={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>PN(100*e,t),r:PN,s:function(e,t){var n=AN(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(MN=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,s=r.length;return i===s?r:i>s?r+new Array(i-s+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+AN(e,Math.max(0,t+i-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function RN(e){return e}var IN,ON,BN,LN=Array.prototype.map,FN=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function UN(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?RN:(t=LN.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],s=0,o=t[0],l=0;a>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),i.push(e.substring(a-=o,a+o)),!((l+=o+1)>r));)o=t[s=(s+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?RN:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(LN.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",d=void 0===e.nan?"NaN":e.nan+"";function u(e){var t=(e=EN(e)).fill,n=e.align,u=e.sign,h=e.symbol,p=e.zero,m=e.width,g=e.comma,f=e.precision,x=e.trim,y=e.type;"n"===y?(g=!0,y="g"):DN[y]||(void 0===f&&(f=12),x=!0,y="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var v="$"===h?a:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===h?i:/[%p]/.test(y)?l:"",w=DN[y],N=/[defgprs%]/.test(y);function S(e){var a,i,l,h=v,S=b;if("c"===y)S=w(e)+S,e="";else{var j=(e=+e)<0||1/e<0;if(e=isNaN(e)?d:w(Math.abs(e),f),x&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),j&&0===+e&&"+"!==u&&(j=!1),h=(j?"("===u?u:c:"-"===u||"("===u?"":u)+h,S=("s"===y?FN[8+MN/3]:"")+S+(j&&"("===u?")":""),N)for(a=-1,i=e.length;++a<i;)if(48>(l=e.charCodeAt(a))||l>57){S=(46===l?s+e.slice(a+1):e.slice(a))+S,e=e.slice(0,a);break}}g&&!p&&(e=r(e,1/0));var _=h.length+e.length+S.length,A=_<m?new Array(m-_+1).join(t):"";switch(g&&p&&(e=r(A+e,A.length?m-S.length:1/0),A=""),n){case"<":e=h+e+S+A;break;case"=":e=h+A+e+S;break;case"^":e=A.slice(0,_=A.length>>1)+h+e+S+A.slice(_);break;default:e=A+h+e+S}return o(e)}return f=void 0===f?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,f)):Math.max(0,Math.min(20,f)),S.toString=function(){return e+""},S}return{format:u,formatPrefix:function(e,t){var n=u(((e=EN(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(CN(t)/3))),a=Math.pow(10,-r),i=FN[8+r/3];return function(e){return n(a*e)+i}}}}function zN(e,t,n,r){var a,i=uw(e,t,n);switch((r=EN(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(CN(t)/3)))-CN(Math.abs(e)))}(i,s))||(r.precision=a),BN(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,CN(t)-CN(e))+1}(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-CN(Math.abs(e)))}(i))||(r.precision=a-2*("%"===r.type))}return ON(r)}function HN(e){var t=e.domain;return e.ticks=function(e){var n=t();return cw(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return zN(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),s=0,o=i.length-1,l=i[s],c=i[o],d=10;for(c<l&&(a=l,l=c,c=a,a=s,s=o,o=a);d-- >0;){if((a=dw(l,c,n))===r)return i[s]=l,i[o]=c,t(i);if(a>0)l=Math.floor(l/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;l=Math.ceil(l*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function GN(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],s=e[a];return s<i&&(n=r,r=a,a=n,n=i,i=s,s=n),e[r]=t.floor(i),e[a]=t.ceil(s),e}function VN(e){return Math.log(e)}function $N(e){return Math.exp(e)}function WN(e){return-Math.log(-e)}function YN(e){return-Math.exp(-e)}function XN(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KN(e){return(t,n)=>-e(-t,n)}function qN(e){const t=e(VN,$N),n=t.domain;let r,a,i=10;function s(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(i),a=function(e){return 10===e?XN:e===Math.E?Math.exp:t=>Math.pow(e,t)}(i),n()[0]<0?(r=KN(r),a=KN(a),e(WN,YN)):e(VN,$N),t}return t.base=function(e){return arguments.length?(i=+e,s()):i},t.domain=function(e){return arguments.length?(n(e),s()):n()},t.ticks=e=>{const t=n();let s=t[0],o=t[t.length-1];const l=o<s;l&&([s,o]=[o,s]);let c,d,u=r(s),h=r(o);const p=null==e?10:+e;let m=[];if(!(i%1)&&h-u<p){if(u=Math.floor(u),h=Math.ceil(h),s>0){for(;u<=h;++u)for(c=1;c<i;++c)if(d=u<0?c/a(-u):c*a(u),!(d<s)){if(d>o)break;m.push(d)}}else for(;u<=h;++u)for(c=i-1;c>=1;--c)if(d=u>0?c/a(-u):c*a(u),!(d<s)){if(d>o)break;m.push(d)}2*m.length<p&&(m=cw(s,o,p))}else m=cw(u,h,Math.min(h-u,p)).map(a);return l?m.reverse():m},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===i?"s":","),"function"!=typeof n&&(i%1||null!=(n=EN(n)).precision||(n.trim=!0),n=ON(n)),e===1/0)return n;const s=Math.max(1,i*e/t.ticks().length);return e=>{let t=e/a(Math.round(r(e)));return t*i<i-.5&&(t*=i),t<=s?n(e):""}},t.nice=()=>n(GN(n(),{floor:e=>a(Math.floor(r(e))),ceil:e=>a(Math.ceil(r(e)))})),t}function JN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function QN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ZN(e){var t=1,n=e(JN(t),QN(t));return n.constant=function(n){return arguments.length?e(JN(t=+n),QN(t)):t},HN(n)}function eS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function tS(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function nS(e){return e<0?-e*e:e*e}function rS(e){var t=e(vN,vN),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(vN,vN):.5===n?e(tS,nS):e(eS(n),eS(1/n)):n},HN(t)}function aS(){var e=rS(jN());return e.copy=function(){return SN(e,aS()).exponent(e.exponent())},xw.apply(e,arguments),e}function iS(e){return Math.sign(e)*e*e}IN=UN({thousands:",",grouping:[3],currency:["$",""]}),ON=IN.format,BN=IN.formatPrefix;const sS=new Date,oS=new Date;function lS(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,r,i)=>{const s=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return s;let o;do{s.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return s},a.filter=n=>lS(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(a.count=(t,r)=>(sS.setTime(+t),oS.setTime(+r),e(sS),e(oS),Math.floor(n(sS,oS))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?t=>r(t)%e===0:t=>a.count(0,t)%e===0):a:null)),a}const cS=lS(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);cS.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?lS(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):cS:null),cS.range;const dS=1e3,uS=6e4,hS=36e5,pS=864e5,mS=6048e5,gS=2592e6,fS=31536e6,xS=lS(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*dS)},(e,t)=>(t-e)/dS,e=>e.getUTCSeconds());xS.range;const yS=lS(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*dS)},(e,t)=>{e.setTime(+e+t*uS)},(e,t)=>(t-e)/uS,e=>e.getMinutes());yS.range;const vS=lS(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*uS)},(e,t)=>(t-e)/uS,e=>e.getUTCMinutes());vS.range;const bS=lS(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*dS-e.getMinutes()*uS)},(e,t)=>{e.setTime(+e+t*hS)},(e,t)=>(t-e)/hS,e=>e.getHours());bS.range;const wS=lS(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*hS)},(e,t)=>(t-e)/hS,e=>e.getUTCHours());wS.range;const NS=lS(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*uS)/pS,e=>e.getDate()-1);NS.range;const SS=lS(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/pS,e=>e.getUTCDate()-1);SS.range;const jS=lS(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/pS,e=>Math.floor(e/pS));function _S(e){return lS(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*uS)/mS)}jS.range;const AS=_S(0),CS=_S(1),MS=_S(2),kS=_S(3),ES=_S(4),TS=_S(5),PS=_S(6);function DS(e){return lS(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/mS)}AS.range,CS.range,MS.range,kS.range,ES.range,TS.range,PS.range;const RS=DS(0),IS=DS(1),OS=DS(2),BS=DS(3),LS=DS(4),FS=DS(5),US=DS(6);RS.range,IS.range,OS.range,BS.range,LS.range,FS.range,US.range;const zS=lS(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth());zS.range;const HS=lS(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth());HS.range;const GS=lS(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());GS.every=e=>isFinite(e=Math.floor(e))&&e>0?lS(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null,GS.range;const VS=lS(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());function $S(e,t,n,r,a,i){const s=[[xS,1,dS],[xS,5,5e3],[xS,15,15e3],[xS,30,3e4],[i,1,uS],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,hS],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,pS],[r,2,1728e5],[n,1,mS],[t,1,gS],[t,3,7776e6],[e,1,fS]];function o(t,n,r){const a=Math.abs(n-t)/r,i=Jb(([,,e])=>e).right(s,a);if(i===s.length)return e.every(uw(t/fS,n/fS,r));if(0===i)return cS.every(Math.max(uw(t,n,r),1));const[o,l]=s[a/s[i-1][2]<s[i][2]/a?i-1:i];return o.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const a=n&&"function"==typeof n.range?n:o(e,t,n),i=a?a.range(e,+t+1):[];return r?i.reverse():i},o]}VS.every=e=>isFinite(e=Math.floor(e))&&e>0?lS(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null,VS.range;const[WS,YS]=$S(VS,HS,RS,jS,wS,vS),[XS,KS]=$S(GS,zS,AS,NS,bS,yS);function qS(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function JS(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function QS(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var ZS,ej,tj,nj={"-":"",_:" ",0:"0"},rj=/^\s*\d+/,aj=/^%/,ij=/[\\^$*+?|[\]().{}]/g;function sj(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function oj(e){return e.replace(ij,"\\$&")}function lj(e){return new RegExp("^(?:"+e.map(oj).join("|")+")","i")}function cj(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function dj(e,t,n){var r=rj.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function uj(e,t,n){var r=rj.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function hj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function pj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function mj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function gj(e,t,n){var r=rj.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function fj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function xj(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function yj(e,t,n){var r=rj.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function vj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function bj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function wj(e,t,n){var r=rj.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Nj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Sj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function jj(e,t,n){var r=rj.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function _j(e,t,n){var r=rj.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Aj(e,t,n){var r=rj.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Cj(e,t,n){var r=aj.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Mj(e,t,n){var r=rj.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function kj(e,t,n){var r=rj.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Ej(e,t){return sj(e.getDate(),t,2)}function Tj(e,t){return sj(e.getHours(),t,2)}function Pj(e,t){return sj(e.getHours()%12||12,t,2)}function Dj(e,t){return sj(1+NS.count(GS(e),e),t,3)}function Rj(e,t){return sj(e.getMilliseconds(),t,3)}function Ij(e,t){return Rj(e,t)+"000"}function Oj(e,t){return sj(e.getMonth()+1,t,2)}function Bj(e,t){return sj(e.getMinutes(),t,2)}function Lj(e,t){return sj(e.getSeconds(),t,2)}function Fj(e){var t=e.getDay();return 0===t?7:t}function Uj(e,t){return sj(AS.count(GS(e)-1,e),t,2)}function zj(e){var t=e.getDay();return t>=4||0===t?ES(e):ES.ceil(e)}function Hj(e,t){return e=zj(e),sj(ES.count(GS(e),e)+(4===GS(e).getDay()),t,2)}function Gj(e){return e.getDay()}function Vj(e,t){return sj(CS.count(GS(e)-1,e),t,2)}function $j(e,t){return sj(e.getFullYear()%100,t,2)}function Wj(e,t){return sj((e=zj(e)).getFullYear()%100,t,2)}function Yj(e,t){return sj(e.getFullYear()%1e4,t,4)}function Xj(e,t){var n=e.getDay();return sj((e=n>=4||0===n?ES(e):ES.ceil(e)).getFullYear()%1e4,t,4)}function Kj(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+sj(t/60|0,"0",2)+sj(t%60,"0",2)}function qj(e,t){return sj(e.getUTCDate(),t,2)}function Jj(e,t){return sj(e.getUTCHours(),t,2)}function Qj(e,t){return sj(e.getUTCHours()%12||12,t,2)}function Zj(e,t){return sj(1+SS.count(VS(e),e),t,3)}function e_(e,t){return sj(e.getUTCMilliseconds(),t,3)}function t_(e,t){return e_(e,t)+"000"}function n_(e,t){return sj(e.getUTCMonth()+1,t,2)}function r_(e,t){return sj(e.getUTCMinutes(),t,2)}function a_(e,t){return sj(e.getUTCSeconds(),t,2)}function i_(e){var t=e.getUTCDay();return 0===t?7:t}function s_(e,t){return sj(RS.count(VS(e)-1,e),t,2)}function o_(e){var t=e.getUTCDay();return t>=4||0===t?LS(e):LS.ceil(e)}function l_(e,t){return e=o_(e),sj(LS.count(VS(e),e)+(4===VS(e).getUTCDay()),t,2)}function c_(e){return e.getUTCDay()}function d_(e,t){return sj(IS.count(VS(e)-1,e),t,2)}function u_(e,t){return sj(e.getUTCFullYear()%100,t,2)}function h_(e,t){return sj((e=o_(e)).getUTCFullYear()%100,t,2)}function p_(e,t){return sj(e.getUTCFullYear()%1e4,t,4)}function m_(e,t){var n=e.getUTCDay();return sj((e=n>=4||0===n?LS(e):LS.ceil(e)).getUTCFullYear()%1e4,t,4)}function g_(){return"+0000"}function f_(){return"%"}function x_(e){return+e}function y_(e){return Math.floor(+e/1e3)}function v_(e){return new Date(e)}function b_(e){return e instanceof Date?+e:+new Date(+e)}function w_(e,t,n,r,a,i,s,o,l,c){var d=_N(),u=d.invert,h=d.domain,p=c(".%L"),m=c(":%S"),g=c("%I:%M"),f=c("%I %p"),x=c("%a %d"),y=c("%b %d"),v=c("%B"),b=c("%Y");function w(e){return(l(e)<e?p:o(e)<e?m:s(e)<e?g:i(e)<e?f:r(e)<e?a(e)<e?x:y:n(e)<e?v:b)(e)}return d.invert=function(e){return new Date(u(e))},d.domain=function(e){return arguments.length?h(Array.from(e,b_)):h().map(v_)},d.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},d.tickFormat=function(e,t){return null==t?w:c(t)},d.nice=function(e){var n=h();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(GN(n,e)):d},d.copy=function(){return SN(d,w_(e,t,n,r,a,i,s,o,l,c))},d}function N_(){var e,t,n,r,a,i=0,s=1,o=vN,l=!1;function c(t){return null==t||isNaN(t=+t)?a:o(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var n,r;return arguments.length?([n,r]=t,o=e(n,r),c):[o(0),o(1)]}}return c.domain=function(a){return arguments.length?([i,s]=a,e=r(i=+i),t=r(s=+s),n=e===t?0:1/(t-e),c):[i,s]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(o=e,c):o},c.range=d(gN),c.rangeRound=d(fN),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(s),n=e===t?0:1/(t-e),c}}function S_(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function j_(){var e=rS(N_());return e.copy=function(){return S_(e,j_()).exponent(e.exponent())},yw.apply(e,arguments)}function __(){var e,t,n,r,a,i,s,o=0,l=.5,c=1,d=1,u=vN,h=!1;function p(e){return isNaN(e=+e)?s:(e=.5+((e=+i(e))-t)*(d*e<d*t?r:a),u(h?Math.max(0,Math.min(1,e)):e))}function m(e){return function(t){var n,r,a;return arguments.length?([n,r,a]=t,u=function(e,t){void 0===t&&(t=e,e=gN);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}(e,[n,r,a]),p):[u(0),u(.5),u(1)]}}return p.domain=function(s){return arguments.length?([o,l,c]=s,e=i(o=+o),t=i(l=+l),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),d=t<e?-1:1,p):[o,l,c]},p.clamp=function(e){return arguments.length?(h=!!e,p):h},p.interpolator=function(e){return arguments.length?(u=e,p):u},p.range=m(gN),p.rangeRound=m(fN),p.unknown=function(e){return arguments.length?(s=e,p):s},function(s){return i=s,e=s(o),t=s(l),n=s(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),d=t<e?-1:1,p}}function A_(){var e=rS(__());return e.copy=function(){return S_(e,A_()).exponent(e.exponent())},yw.apply(e,arguments)}!function(e){ZS=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=lj(a),d=cj(a),u=lj(i),h=cj(i),p=lj(s),m=cj(s),g=lj(o),f=cj(o),x=lj(l),y=cj(l),v={a:function(e){return s[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:Ej,e:Ej,f:Ij,g:Wj,G:Xj,H:Tj,I:Pj,j:Dj,L:Rj,m:Oj,M:Bj,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:x_,s:y_,S:Lj,u:Fj,U:Uj,V:Hj,w:Gj,W:Vj,x:null,X:null,y:$j,Y:Yj,Z:Kj,"%":f_},b={a:function(e){return s[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:qj,e:qj,f:t_,g:h_,G:m_,H:Jj,I:Qj,j:Zj,L:e_,m:n_,M:r_,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:x_,s:y_,S:a_,u:i_,U:s_,V:l_,w:c_,W:d_,x:null,X:null,y:u_,Y:p_,Z:g_,"%":f_},w={a:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=m.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=x.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=f.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return j(e,t,n,r)},d:bj,e:bj,f:Aj,g:fj,G:gj,H:Nj,I:Nj,j:wj,L:_j,m:vj,M:Sj,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=d.get(r[0].toLowerCase()),n+r[0].length):-1},q:yj,Q:Mj,s:kj,S:jj,u:uj,U:hj,V:pj,w:dj,W:mj,x:function(e,t,r){return j(e,n,t,r)},X:function(e,t,n){return j(e,r,t,n)},y:fj,Y:gj,Z:xj,"%":Cj};function N(e,t){return function(n){var r,a,i,s=[],o=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++o<c;)37===e.charCodeAt(o)&&(s.push(e.slice(l,o)),null!=(a=nj[r=e.charAt(++o)])?r=e.charAt(++o):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),s.push(r),l=o+1);return s.push(e.slice(l,o)),s.join("")}}function S(e,t){return function(n){var r,a,i=QS(1900,void 0,1);if(j(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=JS(QS(i.y,0,1))).getUTCDay(),r=a>4||0===a?IS.ceil(r):IS(r),r=SS.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=qS(QS(i.y,0,1))).getDay(),r=a>4||0===a?CS.ceil(r):CS(r),r=NS.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?JS(QS(i.y,0,1)).getUTCDay():qS(QS(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,JS(i)):qS(i)}}function j(e,t,n,r){for(var a,i,s=0,o=t.length,l=n.length;s<o;){if(r>=l)return-1;if(37===(a=t.charCodeAt(s++))){if(a=t.charAt(s++),!(i=w[a in nj?t.charAt(s++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return v.x=N(n,v),v.X=N(r,v),v.c=N(t,v),b.x=N(n,b),b.X=N(r,b),b.c=N(t,b),{format:function(e){var t=N(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=N(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}(e),ej=ZS.format,ZS.parse,tj=ZS.utcFormat,ZS.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});const C_=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ww,scaleDiverging:function e(){var t=HN(__()(vN));return t.copy=function(){return S_(t,e())},yw.apply(t,arguments)},scaleDivergingLog:function e(){var t=qN(__()).domain([.1,1,10]);return t.copy=function(){return S_(t,e()).base(t.base())},yw.apply(t,arguments)},scaleDivergingPow:A_,scaleDivergingSqrt:function(){return A_.apply(null,arguments).exponent(.5)},scaleDivergingSymlog:function e(){var t=ZN(__());return t.copy=function(){return S_(t,e()).constant(t.constant())},yw.apply(t,arguments)},scaleIdentity:function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,xN),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,xN):[0,1],HN(r)},scaleImplicit:vw,scaleLinear:function e(){var t=_N();return t.copy=function(){return SN(t,e())},xw.apply(t,arguments),HN(t)},scaleLog:function e(){const t=qN(jN()).domain([1,10]);return t.copy=()=>SN(t,e()).base(t.base()),xw.apply(t,arguments),t},scaleOrdinal:bw,scalePoint:function(){return Nw(ww.apply(null,arguments).paddingInner(1))},scalePow:aS,scaleQuantile:function e(){var t,n=[],r=[],a=[];function i(){var e=0,t=Math.max(1,r.length);for(a=new Array(t-1);++e<t;)a[e-1]=fw(n,e/t);return s}function s(e){return null==e||isNaN(e=+e)?t:r[ew(a,e)]}return s.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},s.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(Kb),i()},s.range=function(e){return arguments.length?(r=Array.from(e),i()):r.slice()},s.unknown=function(e){return arguments.length?(t=e,s):t},s.quantiles=function(){return a.slice()},s.copy=function(){return e().domain(n).range(r).unknown(t)},xw.apply(s,arguments)},scaleQuantize:function e(){var t,n=0,r=1,a=1,i=[.5],s=[0,1];function o(e){return null!=e&&e<=e?s[ew(i,e,0,a)]:t}function l(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*r-(e-a)*n)/(a+1);return o}return o.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,l()):[n,r]},o.range=function(e){return arguments.length?(a=(s=Array.from(e)).length-1,l()):s.slice()},o.invertExtent=function(e){var t=s.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,i[0]]:t>=a?[i[a-1],r]:[i[t-1],i[t]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return e().domain([n,r]).range(s).unknown(t)},xw.apply(HN(o),arguments)},scaleRadial:function e(){var t,n=_N(),r=[0,1],a=!1;function i(e){var r=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(n(e));return isNaN(r)?t:a?Math.round(r):r}return i.invert=function(e){return n.invert(iS(e))},i.domain=function(e){return arguments.length?(n.domain(e),i):n.domain()},i.range=function(e){return arguments.length?(n.range((r=Array.from(e,xN)).map(iS)),i):r.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(a=!!e,i):a},i.clamp=function(e){return arguments.length?(n.clamp(e),i):n.clamp()},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e(n.domain(),r).round(a).clamp(n.clamp()).unknown(t)},xw.apply(i,arguments),HN(i)},scaleSequential:function e(){var t=HN(N_()(vN));return t.copy=function(){return S_(t,e())},yw.apply(t,arguments)},scaleSequentialLog:function e(){var t=qN(N_()).domain([1,10]);return t.copy=function(){return S_(t,e()).base(t.base())},yw.apply(t,arguments)},scaleSequentialPow:j_,scaleSequentialQuantile:function e(){var t=[],n=vN;function r(e){if(null!=e&&!isNaN(e=+e))return n((ew(t,e,1)-1)/(t.length-1))}return r.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(Kb),r},r.interpolator=function(e){return arguments.length?(n=e,r):n},r.range=function(){return t.map((e,r)=>n(r/(t.length-1)))},r.quantiles=function(e){return Array.from({length:e+1},(n,r)=>function(e,t){if((n=(e=Float64Array.from(function*(e){for(let t of e)null!=t&&(t=+t)>=t&&(yield t)}(e))).length)&&!isNaN(t=+t)){if(t<=0||n<2)return pw(e);if(t>=1)return hw(e);var n,r=(n-1)*t,a=Math.floor(r),i=hw(mw(e,a).subarray(0,a+1));return i+(pw(e.subarray(a+1))-i)*(r-a)}}(t,r/e))},r.copy=function(){return e(n).domain(t)},yw.apply(r,arguments)},scaleSequentialSqrt:function(){return j_.apply(null,arguments).exponent(.5)},scaleSequentialSymlog:function e(){var t=ZN(N_());return t.copy=function(){return S_(t,e()).constant(t.constant())},yw.apply(t,arguments)},scaleSqrt:function(){return aS.apply(null,arguments).exponent(.5)},scaleSymlog:function e(){var t=ZN(jN());return t.copy=function(){return SN(t,e()).constant(t.constant())},xw.apply(t,arguments)},scaleThreshold:function e(){var t,n=[.5],r=[0,1],a=1;function i(e){return null!=e&&e<=e?r[ew(n,e,0,a)]:t}return i.domain=function(e){return arguments.length?(n=Array.from(e),a=Math.min(n.length,r.length-1),i):n.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(n.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(n).range(r).unknown(t)},xw.apply(i,arguments)},scaleTime:function(){return xw.apply(w_(XS,KS,GS,zS,AS,NS,bS,yS,xS,ej).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},scaleUtc:function(){return xw.apply(w_(WS,YS,VS,HS,RS,SS,wS,vS,xS,tj).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},tickFormat:zN},Symbol.toStringTag,{value:"Module"}));var M_=e=>e.chartData,k_=Om([M_],e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),E_=(e,t,n,r)=>r?k_(e):M_(e);function T_(e){if(Array.isArray(e)&&2===e.length){var[t,n]=e;if(Cy(t)&&Cy(n))return!0}return!1}function P_(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function D_(e,t){if(t&&"function"!=typeof e&&Array.isArray(e)&&2===e.length){var n,r,[a,i]=e;if(Cy(a))n=a;else if("function"==typeof a)return;if(Cy(i))r=i;else if("function"==typeof i)return;var s=[n,r];if(T_(s))return s}}var R_,I_=1e9,O_=!0,B_="[DecimalError] ",L_=B_+"Invalid argument: ",F_=B_+"Exponent out of range: ",U_=Math.floor,z_=Math.pow,H_=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,G_=1e7,V_=9007199254740991,$_=U_(1286742750677284.5),W_={};function Y_(e,t){var n,r,a,i,s,o,l,c,d=e.constructor,u=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),O_?rA(t,u):t;if(l=e.d,c=t.d,s=e.e,a=t.e,l=l.slice(),i=s-a){for(i<0?(r=l,i=-i,o=c.length):(r=c,a=s,o=l.length),i>(o=(s=Math.ceil(u/7))>o?s+1:o+1)&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((o=l.length)-(i=c.length)<0&&(i=o,r=c,c=l,l=r),n=0;i;)n=(l[--i]=l[i]+c[i]+n)/G_|0,l[i]%=G_;for(n&&(l.unshift(n),++a),o=l.length;0==l[--o];)l.pop();return t.d=l,t.e=a,O_?rA(t,u):t}function X_(e,t,n){if(e!==~~e||e<t||e>n)throw Error(L_+e)}function K_(e){var t,n,r,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)(n=7-(r=e[t]+"").length)&&(i+=eA(n)),i+=r;(n=7-(r=(s=e[t])+"").length)&&(i+=eA(n))}else if(0===s)return"0";for(;s%10==0;)s/=10;return i+s}W_.absoluteValue=W_.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},W_.comparedTo=W_.cmp=function(e){var t,n,r,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(t=0,n=(r=i.d.length)<(a=e.d.length)?r:a;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return r===a?0:r>a^i.s<0?1:-1},W_.decimalPlaces=W_.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},W_.dividedBy=W_.div=function(e){return q_(this,new this.constructor(e))},W_.dividedToIntegerBy=W_.idiv=function(e){var t=this.constructor;return rA(q_(this,new t(e),0,1),t.precision)},W_.equals=W_.eq=function(e){return!this.cmp(e)},W_.exponent=function(){return Q_(this)},W_.greaterThan=W_.gt=function(e){return this.cmp(e)>0},W_.greaterThanOrEqualTo=W_.gte=function(e){return this.cmp(e)>=0},W_.isInteger=W_.isint=function(){return this.e>this.d.length-2},W_.isNegative=W_.isneg=function(){return this.s<0},W_.isPositive=W_.ispos=function(){return this.s>0},W_.isZero=function(){return 0===this.s},W_.lessThan=W_.lt=function(e){return this.cmp(e)<0},W_.lessThanOrEqualTo=W_.lte=function(e){return this.cmp(e)<1},W_.logarithm=W_.log=function(e){var t,n=this,r=n.constructor,a=r.precision,i=a+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(R_))throw Error(B_+"NaN");if(n.s<1)throw Error(B_+(n.s?"NaN":"-Infinity"));return n.eq(R_)?new r(0):(O_=!1,t=q_(tA(n,i),tA(e,i),i),O_=!0,rA(t,a))},W_.minus=W_.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aA(t,e):Y_(t,(e.s=-e.s,e))},W_.modulo=W_.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(B_+"NaN");return n.s?(O_=!1,t=q_(n,e,0,1).times(e),O_=!0,n.minus(t)):rA(new r(n),a)},W_.naturalExponential=W_.exp=function(){return J_(this)},W_.naturalLogarithm=W_.ln=function(){return tA(this)},W_.negated=W_.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},W_.plus=W_.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Y_(t,e):aA(t,(e.s=-e.s,e))},W_.precision=W_.sd=function(e){var t,n,r,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(L_+e);if(t=Q_(a)+1,n=7*(r=a.d.length-1)+1,r=a.d[r]){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},W_.squareRoot=W_.sqrt=function(){var e,t,n,r,a,i,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(B_+"NaN")}for(e=Q_(o),O_=!1,0==(a=Math.sqrt(+o))||a==1/0?(((t=K_(o.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=U_((e+1)/2)-(e<0||e%2),r=new l(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new l(a.toString()),a=s=(n=l.precision)+3;;)if(r=(i=r).plus(q_(o,i,s+2)).times(.5),K_(i.d).slice(0,s)===(t=K_(r.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&"4999"==t){if(rA(i,n+1,0),i.times(i).eq(o)){r=i;break}}else if("9999"!=t)break;s+=4}return O_=!0,rA(r,n)},W_.times=W_.mul=function(e){var t,n,r,a,i,s,o,l,c,d=this,u=d.constructor,h=d.d,p=(e=new u(e)).d;if(!d.s||!e.s)return new u(0);for(e.s*=d.s,n=d.e+e.e,(l=h.length)<(c=p.length)&&(i=h,h=p,p=i,s=l,l=c,c=s),i=[],r=s=l+c;r--;)i.push(0);for(r=c;--r>=0;){for(t=0,a=l+r;a>r;)o=i[a]+p[r]*h[a-r-1]+t,i[a--]=o%G_|0,t=o/G_|0;i[a]=(i[a]+t)%G_|0}for(;!i[--s];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,O_?rA(e,u.precision):e},W_.toDecimalPlaces=W_.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(X_(e,0,I_),void 0===t?t=r.rounding:X_(t,0,8),rA(n,e+Q_(n)+1,t))},W_.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=iA(r,!0):(X_(e,0,I_),void 0===t?t=a.rounding:X_(t,0,8),n=iA(r=rA(new a(r),e+1,t),!0,e+1)),n},W_.toFixed=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?iA(a):(X_(e,0,I_),void 0===t?t=i.rounding:X_(t,0,8),n=iA((r=rA(new i(a),e+Q_(a)+1,t)).abs(),!1,e+Q_(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},W_.toInteger=W_.toint=function(){var e=this,t=e.constructor;return rA(new t(e),Q_(e)+1,t.rounding)},W_.toNumber=function(){return+this},W_.toPower=W_.pow=function(e){var t,n,r,a,i,s,o=this,l=o.constructor,c=+(e=new l(e));if(!e.s)return new l(R_);if(!(o=new l(o)).s){if(e.s<1)throw Error(B_+"Infinity");return o}if(o.eq(R_))return o;if(r=l.precision,e.eq(R_))return rA(o,r);if(s=(t=e.e)>=(n=e.d.length-1),i=o.s,s){if((n=c<0?-c:c)<=V_){for(a=new l(R_),t=Math.ceil(r/7+4),O_=!1;n%2&&sA((a=a.times(o)).d,t),0!==(n=U_(n/2));)sA((o=o.times(o)).d,t);return O_=!0,e.s<0?new l(R_).div(a):rA(a,r)}}else if(i<0)throw Error(B_+"NaN");return i=i<0&&1&e.d[Math.max(t,n)]?-1:1,o.s=1,O_=!1,a=e.times(tA(o,r+12)),O_=!0,(a=J_(a)).s=i,a},W_.toPrecision=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?r=iA(a,(n=Q_(a))<=i.toExpNeg||n>=i.toExpPos):(X_(e,1,I_),void 0===t?t=i.rounding:X_(t,0,8),r=iA(a=rA(new i(a),e,t),e<=(n=Q_(a))||n<=i.toExpNeg,e)),r},W_.toSignificantDigits=W_.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(X_(e,1,I_),void 0===t?t=n.rounding:X_(t,0,8)),rA(new n(this),e,t)},W_.toString=W_.valueOf=W_.val=W_.toJSON=W_[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Q_(e),n=e.constructor;return iA(e,t<=n.toExpNeg||t>=n.toExpPos)};var q_=function(){function e(e,t){var n,r=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+r,e[a]=n%G_|0,r=n/G_|0;return r&&e.unshift(r),e}function t(e,t,n,r){var a,i;if(n!=r)i=n>r?1:-1;else for(a=i=0;a<n;a++)if(e[a]!=t[a]){i=e[a]>t[a]?1:-1;break}return i}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*G_+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,i,s){var o,l,c,d,u,h,p,m,g,f,x,y,v,b,w,N,S,j,_=r.constructor,A=r.s==a.s?1:-1,C=r.d,M=a.d;if(!r.s)return new _(r);if(!a.s)throw Error(B_+"Division by zero");for(l=r.e-a.e,S=M.length,w=C.length,m=(p=new _(A)).d=[],c=0;M[c]==(C[c]||0);)++c;if(M[c]>(C[c]||0)&&--l,(y=null==i?i=_.precision:s?i+(Q_(r)-Q_(a))+1:i)<0)return new _(0);if(y=y/7+2|0,c=0,1==S)for(d=0,M=M[0],y++;(c<w||d)&&y--;c++)v=d*G_+(C[c]||0),m[c]=v/M|0,d=v%M|0;else{for((d=G_/(M[0]+1)|0)>1&&(M=e(M,d),C=e(C,d),S=M.length,w=C.length),b=S,f=(g=C.slice(0,S)).length;f<S;)g[f++]=0;(j=M.slice()).unshift(0),N=M[0],M[1]>=G_/2&&++N;do{d=0,(o=t(M,g,S,f))<0?(x=g[0],S!=f&&(x=x*G_+(g[1]||0)),(d=x/N|0)>1?(d>=G_&&(d=G_-1),1==(o=t(u=e(M,d),g,h=u.length,f=g.length))&&(d--,n(u,S<h?j:M,h))):(0==d&&(o=d=1),u=M.slice()),(h=u.length)<f&&u.unshift(0),n(g,u,f),-1==o&&(o=t(M,g,S,f=g.length))<1&&(d++,n(g,S<f?j:M,f)),f=g.length):0===o&&(d++,g=[0]),m[c++]=d,o&&g[0]?g[f++]=C[b]||0:(g=[C[b]],f=1)}while((b++<w||void 0!==g[0])&&y--)}return m[0]||m.shift(),p.e=l,rA(p,s?i+Q_(p)+1:i)}}();function J_(e,t){var n,r,a,i,s,o=0,l=0,c=e.constructor,d=c.precision;if(Q_(e)>16)throw Error(F_+Q_(e));if(!e.s)return new c(R_);for(O_=!1,s=d,i=new c(.03125);e.abs().gte(.1);)e=e.times(i),l+=5;for(s+=Math.log(z_(2,l))/Math.LN10*2+5|0,n=r=a=new c(R_),c.precision=s;;){if(r=rA(r.times(e),s),n=n.times(++o),K_((i=a.plus(q_(r,n,s))).d).slice(0,s)===K_(a.d).slice(0,s)){for(;l--;)a=rA(a.times(a),s);return c.precision=d,null==t?(O_=!0,rA(a,d)):a}a=i}}function Q_(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function Z_(e,t,n){if(t>e.LN10.sd())throw O_=!0,n&&(e.precision=n),Error(B_+"LN10 precision limit exceeded");return rA(new e(e.LN10),t)}function eA(e){for(var t="";e--;)t+="0";return t}function tA(e,t){var n,r,a,i,s,o,l,c,d,u=1,h=e,p=h.d,m=h.constructor,g=m.precision;if(h.s<1)throw Error(B_+(h.s?"NaN":"-Infinity"));if(h.eq(R_))return new m(0);if(null==t?(O_=!1,c=g):c=t,h.eq(10))return null==t&&(O_=!0),Z_(m,c);if(c+=10,m.precision=c,r=(n=K_(p)).charAt(0),i=Q_(h),!(Math.abs(i)<15e14))return l=Z_(m,c+2,g).times(i+""),h=tA(new m(r+"."+n.slice(1)),c-10).plus(l),m.precision=g,null==t?(O_=!0,rA(h,g)):h;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=K_((h=h.times(e)).d)).charAt(0),u++;for(i=Q_(h),r>1?(h=new m("0."+n),i++):h=new m(r+"."+n.slice(1)),o=s=h=q_(h.minus(R_),h.plus(R_),c),d=rA(h.times(h),c),a=3;;){if(s=rA(s.times(d),c),K_((l=o.plus(q_(s,new m(a),c))).d).slice(0,c)===K_(o.d).slice(0,c))return o=o.times(2),0!==i&&(o=o.plus(Z_(m,c+2,g).times(i+""))),o=q_(o,new m(u),c),m.precision=g,null==t?(O_=!0,rA(o,g)):o;o=l,a+=2}}function nA(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(r,a)){if(a-=r,n=n-r-1,e.e=U_(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=7;r<a;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),O_&&(e.e>$_||e.e<-$_))throw Error(F_+n)}else e.s=0,e.e=0,e.d=[0];return e}function rA(e,t,n){var r,a,i,s,o,l,c,d,u=e.d;for(s=1,i=u[0];i>=10;i/=10)s++;if((r=t-s)<0)r+=7,a=t,c=u[d=0];else{if((d=Math.ceil((r+1)/7))>=(i=u.length))return e;for(c=i=u[d],s=1;i>=10;i/=10)s++;a=(r%=7)-7+s}if(void 0!==n&&(o=c/(i=z_(10,s-a-1))%10|0,l=t<0||void 0!==u[d+1]||c%i,l=n<4?(o||l)&&(0==n||n==(e.s<0?3:2)):o>5||5==o&&(4==n||l||6==n&&(r>0?a>0?c/z_(10,s-a):0:u[d-1])%10&1||n==(e.s<0?8:7))),t<1||!u[0])return l?(i=Q_(e),u.length=1,t=t-i-1,u[0]=z_(10,(7-t%7)%7),e.e=U_(-t/7)||0):(u.length=1,u[0]=e.e=e.s=0),e;if(0==r?(u.length=d,i=1,d--):(u.length=d+1,i=z_(10,7-r),u[d]=a>0?(c/z_(10,s-a)%z_(10,a)|0)*i:0),l)for(;;){if(0==d){(u[0]+=i)==G_&&(u[0]=1,++e.e);break}if(u[d]+=i,u[d]!=G_)break;u[d--]=0,i=1}for(r=u.length;0===u[--r];)u.pop();if(O_&&(e.e>$_||e.e<-$_))throw Error(F_+Q_(e));return e}function aA(e,t){var n,r,a,i,s,o,l,c,d,u,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),O_?rA(t,p):t;if(l=e.d,u=t.d,r=t.e,c=e.e,l=l.slice(),s=c-r){for((d=s<0)?(n=l,s=-s,o=u.length):(n=u,r=c,o=l.length),s>(a=Math.max(Math.ceil(p/7),o)+2)&&(s=a,n.length=1),n.reverse(),a=s;a--;)n.push(0);n.reverse()}else{for((d=(a=l.length)<(o=u.length))&&(o=a),a=0;a<o;a++)if(l[a]!=u[a]){d=l[a]<u[a];break}s=0}for(d&&(n=l,l=u,u=n,t.s=-t.s),o=l.length,a=u.length-o;a>0;--a)l[o++]=0;for(a=u.length;a>s;){if(l[--a]<u[a]){for(i=a;i&&0===l[--i];)l[i]=G_-1;--l[i],l[a]+=G_}l[a]-=u[a]}for(;0===l[--o];)l.pop();for(;0===l[0];l.shift())--r;return l[0]?(t.d=l,t.e=r,O_?rA(t,p):t):new h(0)}function iA(e,t,n){var r,a=Q_(e),i=K_(e.d),s=i.length;return t?(n&&(r=n-s)>0?i=i.charAt(0)+"."+i.slice(1)+eA(r):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+eA(-a-1)+i,n&&(r=n-s)>0&&(i+=eA(r))):a>=s?(i+=eA(a+1-s),n&&(r=n-a-1)>0&&(i=i+"."+eA(r))):((r=a+1)<s&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-s)>0&&(a+1===s&&(i+="."),i+=eA(r))),e.s<0?"-"+i:i}function sA(e,t){if(e.length>t)return e.length=t,!0}function oA(e){if(!e||"object"!=typeof e)throw Error(B_+"Object expected");var t,n,r,a=["precision",1,I_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(r=e[n=a[t]])){if(!(U_(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(L_+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(L_+n+": "+r);this[n]=new this(r)}return this}var lA=function e(t){var n,r,a;function i(e){var t=this;if(!(t instanceof i))return new i(e);if(t.constructor=i,e instanceof i)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"==typeof e){if(0*e!=0)throw Error(L_+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):nA(t,e.toString())}if("string"!=typeof e)throw Error(L_+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!H_.test(e))throw Error(L_+e);nA(t,e)}if(i.prototype=W_,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=e,i.config=i.set=oA,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return i.config(t),i}({precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"});R_=new lA(1);const cA=lA;var dA=e=>e,uA={},hA=e=>e===uA,pA=e=>function t(){return 0===arguments.length||1===arguments.length&&hA(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},mA=(e,t)=>1===e?t:pA(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r.filter(e=>e!==uA).length;return i>=e?t(...r):mA(e-i,pA(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var i=r.map(e=>hA(e)?n.shift():e);return t(...i,...n)}))}),gA=e=>mA(e.length,e),fA=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},xA=gA((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e)),yA=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),vA=e=>{var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t&&a.every((e,n)=>{var r;return e===(null===(r=t)||void 0===r?void 0:r[n])})?n:(t=a,n=e(...a))}};function bA(e){return 0===e?1:Math.floor(new cA(e).abs().log(10).toNumber())+1}function wA(e,t,n){for(var r=new cA(e),a=0,i=[];r.lt(t)&&a<1e5;)i.push(r.toNumber()),r=r.add(n),a++;return i}gA((e,t,n)=>{var r=+e;return r+n*(+t-r)}),gA((e,t,n)=>{var r=t-+e;return(n-e)/(r=r||1/0)}),gA((e,t,n)=>{var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});var NA=e=>{var[t,n]=e,[r,a]=[t,n];return t>n&&([r,a]=[n,t]),[r,a]},SA=(e,t,n)=>{if(e.lte(0))return new cA(0);var r=bA(e.toNumber()),a=new cA(10).pow(r),i=e.div(a),s=1!==r?.05:.1,o=new cA(Math.ceil(i.div(s).toNumber())).add(n).mul(s).mul(a);return new cA(t?o.toNumber():Math.ceil(o.toNumber()))},jA=(e,t,n)=>{var r=new cA(1),a=new cA(e);if(!a.isint()&&n){var i=Math.abs(e);i<1?(r=new cA(10).pow(bA(e)-1),a=new cA(Math.floor(a.div(r).toNumber())).mul(r)):i>1&&(a=new cA(Math.floor(e)))}else 0===e?a=new cA(Math.floor((t-1)/2)):n||(a=new cA(Math.floor(e)));var s=Math.floor((t-1)/2);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return dA;var r=t.reverse(),a=r[0],i=r.slice(1);return function(){return i.reduce((e,t)=>t(e),a(...arguments))}}(xA(e=>a.add(new cA(e-s).mul(r)).toNumber()),fA)(0,t)},_A=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new cA(0),tickMin:new cA(0),tickMax:new cA(0)};var i,s=SA(new cA(t).sub(e).div(n-1),r,a);i=e<=0&&t>=0?new cA(0):(i=new cA(e).add(t).div(2)).sub(new cA(i).mod(s));var o=Math.ceil(i.sub(e).div(s).toNumber()),l=Math.ceil(new cA(t).sub(i).div(s).toNumber()),c=o+l+1;return c>n?_A(e,t,n,r,a+1):(c<n&&(l=t>0?l+(n-c):l,o=t>0?o:o+(n-c)),{step:s,tickMin:i.sub(new cA(o).mul(s)),tickMax:i.add(new cA(l).mul(s))})};var AA=vA(function(e){var[t,n]=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Math.max(r,2),[s,o]=NA([t,n]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...fA(0,r-1).map(()=>1/0)]:[...fA(0,r-1).map(()=>-1/0),o];return t>n?yA(l):l}if(s===o)return jA(s,r,a);var{step:c,tickMin:d,tickMax:u}=_A(s,o,i,a,0),h=wA(d,u.add(new cA(.1).mul(c)),c);return t>n?yA(h):h}),CA=vA(function(e,t){var[n,r]=e,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[i,s]=NA([n,r]);if(i===-1/0||s===1/0)return[n,r];if(i===s)return[i];var o=Math.max(t,2),l=SA(new cA(s).sub(i).div(o-1),a,0),c=[...wA(new cA(i),new cA(s),l),s];return!1===a&&(c=c.map(e=>Math.round(e))),n>r?yA(c):c}),MA=e=>e.rootProps.maxBarSize,kA=e=>e.rootProps.barCategoryGap,EA=e=>e.rootProps.stackOffset,TA=e=>e.options.chartName,PA=e=>e.rootProps.syncId,DA=e=>e.rootProps.syncMethod,RA=e=>e.options.eventEmitter,IA=0,OA="auto",BA=!0,LA=!1,FA=!0,UA=0,zA="auto",HA=!0,GA=5,VA=(e,t)=>{if(e&&t)return null!=e&&e.reversed?[t[1],t[0]]:t},$A={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:IA,includeHidden:!1,name:void 0,reversed:!1,scale:OA,tick:BA,tickCount:void 0,ticks:void 0,type:"category",unit:void 0},WA={allowDataOverflow:LA,allowDecimals:!1,allowDuplicatedCategory:FA,dataKey:void 0,domain:void 0,id:UA,includeHidden:!1,name:void 0,reversed:!1,scale:zA,tick:HA,tickCount:GA,ticks:void 0,type:"number",unit:void 0},YA={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,dataKey:void 0,domain:void 0,id:IA,includeHidden:!1,name:void 0,reversed:!1,scale:OA,tick:BA,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},XA={allowDataOverflow:LA,allowDecimals:!1,allowDuplicatedCategory:FA,dataKey:void 0,domain:void 0,id:UA,includeHidden:!1,name:void 0,reversed:!1,scale:zA,tick:HA,tickCount:GA,ticks:void 0,type:"category",unit:void 0},KA=(e,t)=>null!=e.polarAxis.angleAxis[t]?e.polarAxis.angleAxis[t]:"radial"===e.layout.layoutType?YA:$A,qA=(e,t)=>null!=e.polarAxis.radiusAxis[t]?e.polarAxis.radiusAxis[t]:"radial"===e.layout.layoutType?XA:WA,JA=e=>e.polarOptions,QA=Om([Wx,Yx,sy],function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2}),ZA=Om([JA,QA],(e,t)=>{if(null!=e)return ph(e.innerRadius,t,0)}),eC=Om([JA,QA],(e,t)=>{if(null!=e)return ph(e.outerRadius,t,.8*t)}),tC=Om([JA],e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]});Om([KA,tC],VA);var nC=Om([QA,ZA,eC],(e,t,n)=>{if(null!=e&&null!=t&&null!=n)return[t,n]});Om([qA,nC],VA);var rC=Om([Gy,JA,ZA,eC,Wx,Yx],(e,t,n,r,a,i)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=n&&null!=r){var{cx:s,cy:o,startAngle:l,endAngle:c}=t;return{cx:ph(s,a,a/2),cy:ph(o,i,i/2),innerRadius:n,outerRadius:r,startAngle:l,endAngle:c,clockWise:!1}}}),aC=(e,t)=>t,iC=(e,t,n)=>n;function sC(e){return null==e?void 0:e.id}var oC=e=>{var t=Gy(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},lC=e=>e.tooltip.settings.axisId,cC=e=>{var t=oC(e),n=lC(e);return MC(e,t,n)},dC=Om([cC],e=>null==e?void 0:e.dataKey);function uC(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=n,s=new Map;return e.forEach(e=>{var t,n=null!==(t=e.data)&&void 0!==t?t:r;if(null!=n&&0!==n.length){var o=sC(e);n.forEach((t,n)=>{var r,l=null==i||a?n:String(Tx(t,i,null)),c=Tx(t,e.dataKey,0);r=s.has(l)?s.get(l):{},Object.assign(r,{[o]:c}),s.set(l,r)})}}),Array.from(s.values())}function hC(e){return null!=e.stackId&&null!=e.dataKey}var pC=(e,t)=>e===t||null!=e&&null!=t&&(e[0]===t[0]&&e[1]===t[1]);function mC(e,t){return!(!Array.isArray(e)||!Array.isArray(t)||0!==e.length||0!==t.length)||e===t}function gC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gC(Object(n),!0).forEach(function(t){xC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yC=[0,"auto"],vC={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},bC=(e,t)=>e.cartesianAxis.xAxis[t],wC=(e,t)=>{var n=bC(e,t);return null==n?vC:n},NC={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:yC,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},SC=(e,t)=>e.cartesianAxis.yAxis[t],jC=(e,t)=>{var n=SC(e,t);return null==n?NC:n},_C={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},AC=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return null==n?_C:n},CC=(e,t,n)=>{switch(t){case"xAxis":return wC(e,n);case"yAxis":return jC(e,n);case"zAxis":return AC(e,n);case"angleAxis":return KA(e,n);case"radiusAxis":return qA(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},MC=(e,t,n)=>{switch(t){case"xAxis":return wC(e,n);case"yAxis":return jC(e,n);case"angleAxis":return KA(e,n);case"radiusAxis":return qA(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},kC=e=>e.graphicalItems.cartesianItems.some(e=>"bar"===e.type)||e.graphicalItems.polarItems.some(e=>"radialBar"===e.type);function EC(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var TC=e=>e.graphicalItems.cartesianItems,PC=Om([aC,iC],EC),DC=(e,t,n)=>e.filter(n).filter(e=>!0===(null==t?void 0:t.includeHidden)||!e.hide),RC=Om([TC,CC,PC],DC,{memoizeOptions:{resultEqualityCheck:mC}}),IC=Om([RC],e=>e.filter(e=>"area"===e.type||"bar"===e.type).filter(hC)),OC=e=>e.filter(e=>!("stackId"in e)||void 0===e.stackId),BC=Om([RC],OC),LC=e=>e.map(e=>e.data).filter(Boolean).flat(1),FC=Om([RC],LC,{memoizeOptions:{resultEqualityCheck:mC}}),UC=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:a}=t;return e.length>0?e:n.slice(r,a+1)},zC=Om([FC,E_],UC),HC=(e,t,n)=>null!=(null==t?void 0:t.dataKey)?e.map(e=>({value:Tx(e,t.dataKey)})):n.length>0?n.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:Tx(e,t)}))):e.map(e=>({value:e})),GC=Om([zC,CC,RC],HC);function VC(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function $C(e){if(dh(e)||e instanceof Date){var t=Number(e);if(Cy(t))return t}}function WC(e){if(Array.isArray(e)){var t=[$C(e[0]),$C(e[1])];return T_(t)?t:void 0}var n=$C(e);if(null!=n)return[n,n]}function YC(e){return e.map($C).filter(Wv)}var XC=Om([IC,E_,cC],uC),KC=(e,t,n)=>{var r=t.reduce((e,t)=>(null==t.stackId||(null==e[t.stackId]&&(e[t.stackId]=[]),e[t.stackId].push(t)),e),{});return Object.fromEntries(Object.entries(r).map(t=>{var[r,a]=t,i=a.map(sC);return[r,{stackedData:Bx(e,i,n),graphicalItems:a}]}))},qC=Om([XC,IC,EA],KC),JC=(e,t,n,r)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(null==r&&"zAxis"!==n){var s=Ux(e,a,i);if(null==s||0!==s[0]||0!==s[1])return s}},QC=Om([CC],e=>e.allowDataOverflow),ZC=e=>{var t;if(null==e||!("domain"in e))return yC;if(null!=e.domain)return e.domain;if(null!=e.ticks){if("number"===e.type){var n=YC(e.ticks);return[Math.min(...n),Math.max(...n)]}if("category"===e.type)return e.ticks.map(String)}return null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:yC},eM=Om([CC],ZC),tM=Om([eM,QC],D_),nM=Om([qC,M_,aC,tM],JC,{memoizeOptions:{resultEqualityCheck:pC}}),rM=e=>e.errorBars,aM=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);if(0!==r.length){var a=r.flat();return[Math.min(...a),Math.max(...a)]}},iM=(e,t,n,r,a)=>{var i,s;if(n.length>0&&e.forEach(e=>{n.forEach(n=>{var o,l,c=null===(o=r[n.id])||void 0===o?void 0:o.filter(e=>VC(a,e)),d=Tx(e,null!==(l=t.dataKey)&&void 0!==l?l:n.dataKey),u=function(e,t,n){return!n||"number"!=typeof t||oh(t)?[]:n.length?YC(n.flatMap(n=>{var r,a,i=Tx(e,n.dataKey);if(Array.isArray(i)?[r,a]=i:r=a=i,Cy(r)&&Cy(a))return[t-r,t+a]})):[]}(e,d,c);if(u.length>=2){var h=Math.min(...u),p=Math.max(...u);(null==i||h<i)&&(i=h),(null==s||p>s)&&(s=p)}var m=WC(d);null!=m&&(i=null==i?m[0]:Math.min(i,m[0]),s=null==s?m[1]:Math.max(s,m[1]))})}),null!=(null==t?void 0:t.dataKey)&&e.forEach(e=>{var n=WC(Tx(e,t.dataKey));null!=n&&(i=null==i?n[0]:Math.min(i,n[0]),s=null==s?n[1]:Math.max(s,n[1]))}),Cy(i)&&Cy(s))return[i,s]},sM=Om([zC,CC,BC,rM,aC],iM,{memoizeOptions:{resultEqualityCheck:pC}});function oM(e){var{value:t}=e;if(dh(t)||t instanceof Date)return t}var lM=e=>e.referenceElements.dots,cM=(e,t,n)=>e.filter(e=>"extendDomain"===e.ifOverflow).filter(e=>"xAxis"===t?e.xAxisId===n:e.yAxisId===n),dM=Om([lM,aC,iC],cM),uM=e=>e.referenceElements.areas,hM=Om([uM,aC,iC],cM),pM=e=>e.referenceElements.lines,mM=Om([pM,aC,iC],cM),gM=(e,t)=>{var n=YC(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},fM=Om(dM,aC,gM),xM=(e,t)=>{var n=YC(e.flatMap(e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2]));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},yM=Om([hM,aC],xM),vM=(e,t)=>{var n=YC(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},bM=Om(mM,aC,vM),wM=Om(fM,bM,yM,(e,t,n)=>aM(e,n,t)),NM=(e,t,n,r,a,i,s,o)=>null!=n?n:function(e,t,n){if(n||null!=t){if("function"==typeof e&&null!=t)try{var r=e(t,n);if(T_(r))return P_(r,t,n)}catch(p){}if(Array.isArray(e)&&2===e.length){var a,i,[s,o]=e;if("auto"===s)null!=t&&(a=Math.min(...t));else if(ch(s))a=s;else if("function"==typeof s)try{null!=t&&(a=s(null==t?void 0:t[0]))}catch(m){}else if("string"==typeof s&&zx.test(s)){var l=zx.exec(s);if(null==l||null==t)a=void 0;else{var c=+l[1];a=t[0]-c}}else a=null==t?void 0:t[0];if("auto"===o)null!=t&&(i=Math.max(...t));else if(ch(o))i=o;else if("function"==typeof o)try{null!=t&&(i=o(null==t?void 0:t[1]))}catch(g){}else if("string"==typeof o&&Hx.test(o)){var d=Hx.exec(o);if(null==d||null==t)i=void 0;else{var u=+d[1];i=t[1]+u}}else i=null==t?void 0:t[1];var h=[a,i];if(T_(h))return null==t?h:P_(h,t,n)}}}(t,"vertical"===s&&"xAxis"===o||"horizontal"===s&&"yAxis"===o?aM(r,i,a):aM(i,a),e.allowDataOverflow),SM=Om([CC,eM,tM,nM,sM,wM,Gy,aC],NM,{memoizeOptions:{resultEqualityCheck:pC}}),jM=[0,1],_M=(e,t,n,r,a,i,s)=>{if(null!=e&&null!=n&&0!==n.length||void 0!==s){var{dataKey:o,type:l}=e,c=Px(t,i);return c&&null==o?Xb(0,n.length):"category"===l?((e,t,n)=>{var r=e.map(oM).filter(e=>null!=e);return n&&(null==t.dataKey||t.allowDuplicatedCategory&&mh(r))?Xb(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))})(r,e,c):"expand"===a?jM:s}},AM=Om([CC,Gy,zC,GC,EA,aC,SM],_M),CM=(e,t,n,r,a)=>{if(null!=e){var{scale:i,type:s}=e;if("auto"===i)return"radial"===t&&"radiusAxis"===a?"band":"radial"===t&&"angleAxis"===a?"linear":"category"===s&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?"point":"category"===s?"band":"linear";if("string"==typeof i){var o="scale".concat(yh(i));return o in C_?o:"point"}}},MM=Om([CC,Gy,kC,TA,aC],CM);function kM(e,t,n,r){if(null!=n&&null!=r){if("function"==typeof e.scale)return e.scale.copy().domain(n).range(r);var a=function(e){if(null!=e){if(e in C_)return C_[e]();var t="scale".concat(yh(e));return t in C_?C_[t]():void 0}}(t);if(null!=a){var i=a.domain(n).range(r);return(e=>{var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-Ix,i=Math.max(r[0],r[1])+Ix,s=e(t[0]),o=e(t[n-1]);(s<a||s>i||o<a||o>i)&&e.domain([t[0],t[n-1]])}})(i),i}}}var EM=(e,t,n)=>{var r=ZC(t);if("auto"===n||"linear"===n)return null!=t&&t.tickCount&&Array.isArray(r)&&("auto"===r[0]||"auto"===r[1])&&T_(e)?AA(e,t.tickCount,t.allowDecimals):null!=t&&t.tickCount&&"number"===t.type&&T_(e)?CA(e,t.tickCount,t.allowDecimals):void 0},TM=Om([AM,MC,MM],EM),PM=(e,t,n,r)=>{if("angleAxis"!==r&&"number"===(null==e?void 0:e.type)&&T_(t)&&Array.isArray(n)&&n.length>0){var a=t[0],i=n[0],s=t[1],o=n[n.length-1];return[Math.min(a,i),Math.max(s,o)]}return t},DM=Om([CC,AM,TM,aC],PM),RM=Om(GC,CC,(e,t)=>{if(t&&"number"===t.type){var n=1/0,r=Array.from(YC(e.map(e=>e.value))).sort((e,t)=>e-t);if(r.length<2)return 1/0;var a=r[r.length-1]-r[0];if(0===a)return 1/0;for(var i=0;i<r.length-1;i++){var s=r[i+1]-r[i];n=Math.min(n,s)}return n/a}}),IM=Om(RM,Gy,kA,sy,(e,t,n,r)=>r,(e,t,n,r,a)=>{if(!Cy(e))return 0;var i="vertical"===t?r.height:r.width;if("gap"===a)return e*i/2;if("no-gap"===a){var s=ph(n,e*i),o=e*i/2;return o-s-(o-s)/i*s}return 0}),OM=Om(wC,(e,t)=>{var n=wC(e,t);return null==n||"string"!=typeof n.padding?0:IM(e,"xAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{left:0,right:0};var{padding:a}=e;return"string"==typeof a?{left:t,right:t}:{left:(null!==(n=a.left)&&void 0!==n?n:0)+t,right:(null!==(r=a.right)&&void 0!==r?r:0)+t}}),BM=Om(jC,(e,t)=>{var n=jC(e,t);return null==n||"string"!=typeof n.padding?0:IM(e,"yAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{top:0,bottom:0};var{padding:a}=e;return"string"==typeof a?{top:t,bottom:t}:{top:(null!==(n=a.top)&&void 0!==n?n:0)+t,bottom:(null!==(r=a.bottom)&&void 0!==r?r:0)+t}}),LM=Om([sy,OM,hy,uy,(e,t,n)=>n],(e,t,n,r,a)=>{var{padding:i}=r;return a?[i.left,n.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),FM=Om([sy,Gy,BM,hy,uy,(e,t,n)=>n],(e,t,n,r,a,i)=>{var{padding:s}=a;return i?[r.height-s.bottom,s.top]:"horizontal"===t?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),UM=(e,t,n,r)=>{var a;switch(t){case"xAxis":return LM(e,n,r);case"yAxis":return FM(e,n,r);case"zAxis":return null===(a=AC(e,n))||void 0===a?void 0:a.range;case"angleAxis":return tC(e);case"radiusAxis":return nC(e,n);default:return}},zM=Om([CC,UM],VA),HM=Om([CC,MM,DM,zM],kM);function GM(e,t){return e.id<t.id?-1:e.id>t.id?1:0}Om([RC,rM,aC],(e,t,n)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>VC(n,e)));var VM=(e,t)=>t,$M=(e,t,n)=>n,WM=Om(qx,VM,$M,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(GM)),YM=Om(Jx,VM,$M,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(GM)),XM=(e,t)=>({width:e.width,height:t.height}),KM=Om(sy,wC,XM),qM=Om(Yx,sy,WM,VM,$M,(e,t,n,r,a)=>{var i,s={};return n.forEach(n=>{var o=XM(t,n);null==i&&(i=((e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}})(t,r,e));var l="top"===r&&!a||"bottom"===r&&a;s[n.id]=i-Number(l)*o.height,i+=(l?-1:1)*o.height}),s}),JM=Om(Wx,sy,YM,VM,$M,(e,t,n,r,a)=>{var i,s={};return n.forEach(n=>{var o=((e,t)=>({width:"number"==typeof t.width?t.width:60,height:e.height}))(t,n);null==i&&(i=((e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}})(t,r,e));var l="left"===r&&!a||"right"===r&&a;s[n.id]=i-Number(l)*o.width,i+=(l?-1:1)*o.width}),s}),QM=Om([sy,wC,(e,t)=>{var n=wC(e,t);if(null!=n)return qM(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var a=null==n?void 0:n[r];return null==a?{x:e.left,y:0}:{x:e.left,y:a}}}),ZM=Om([sy,jC,(e,t)=>{var n=jC(e,t);if(null!=n)return JM(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var a=null==n?void 0:n[r];return null==a?{x:0,y:e.top}:{x:a,y:e.top}}}),ek=Om(sy,jC,(e,t)=>({width:"number"==typeof t.width?t.width:60,height:e.height})),tk=(e,t,n)=>{switch(t){case"xAxis":return KM(e,n).width;case"yAxis":return ek(e,n).height;default:return}},nk=(e,t,n,r)=>{if(null!=n){var{allowDuplicatedCategory:a,type:i,dataKey:s}=n,o=Px(e,r),l=t.map(e=>e.value);return s&&o&&"category"===i&&a&&mh(l)?l:void 0}},rk=Om([Gy,GC,CC,aC],nk),ak=(e,t,n,r)=>{if(null!=n&&null!=n.dataKey){var{type:a,scale:i}=n;return!Px(e,r)||"number"!==a&&"auto"===i?void 0:t.map(e=>e.value)}},ik=Om([Gy,GC,MC,aC],ak),sk=Om([Gy,(e,t,n)=>{switch(t){case"xAxis":return wC(e,n);case"yAxis":return jC(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},MM,HM,rk,ik,UM,TM,aC],(e,t,n,r,a,i,s,o,l)=>{if(null==t)return null;var c=Px(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:i,duplicateDomain:a,isCategorical:c,niceTicks:o,range:s,realScaleType:n,scale:r}}),ok=Om([Gy,MC,MM,HM,TM,UM,rk,ik,aC],(e,t,n,r,a,i,s,o,l)=>{if(null!=t&&null!=r){var c=Px(e,l),{type:d,ticks:u,tickCount:h}=t,p="scaleBand"===n&&"function"==typeof r.bandwidth?r.bandwidth()/2:2,m="category"===d&&r.bandwidth?r.bandwidth()/p:0;m="angleAxis"===l&&null!=i&&i.length>=2?2*sh(i[0]-i[1])*m:m;var g=u||a;return g?g.map((e,t)=>{var n=s?s.indexOf(e):e;return{index:t,coordinate:r(n)+m,value:e,offset:m}}).filter(e=>!oh(e.coordinate)):c&&o?o.map((e,t)=>({coordinate:r(e)+m,value:e,index:t,offset:m})):r.ticks?r.ticks(h).map(e=>({coordinate:r(e)+m,value:e,offset:m})):r.domain().map((e,t)=>({coordinate:r(e)+m,value:s?s[e]:e,index:t,offset:m}))}}),lk=Om([Gy,MC,HM,UM,rk,ik,aC],(e,t,n,r,a,i,s)=>{if(null!=t&&null!=n&&null!=r&&r[0]!==r[1]){var o=Px(e,s),{tickCount:l}=t,c=0;return c="angleAxis"===s&&(null==r?void 0:r.length)>=2?2*sh(r[0]-r[1])*c:c,o&&i?i.map((e,t)=>({coordinate:n(e)+c,value:e,index:t,offset:c})):n.ticks?n.ticks(l).map(e=>({coordinate:n(e)+c,value:e,offset:c})):n.domain().map((e,t)=>({coordinate:n(e)+c,value:a?a[e]:e,index:t,offset:c}))}}),ck=Om(CC,HM,(e,t)=>{if(null!=e&&null!=t)return fC(fC({},e),{},{scale:t})}),dk=Om([CC,MM,AM,zM],kM);Om((e,t,n)=>AC(e,n),dk,(e,t)=>{if(null!=e&&null!=t)return fC(fC({},e),{},{scale:t})});var uk=Om([Gy,qx,Jx],(e,t,n)=>{switch(e){case"horizontal":return t.some(e=>e.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(e=>e.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),hk=e=>e.options.defaultTooltipEventType,pk=e=>e.options.validateTooltipEventTypes;function mk(e,t,n){if(null==e)return t;var r=e?"axis":"item";return null==n?t:n.includes(r)?r:t}function gk(e,t){return mk(t,hk(e),pk(e))}var fk=(e,t)=>{var n,r=Number(t);if(!oh(r)&&null!=t)return r>=0?null==e||null===(n=e[r])||void 0===n?void 0:n.value:void 0},xk={active:!1,index:null,dataKey:void 0,coordinate:void 0},yk=Tf({name:"tooltip",initialState:{itemInteraction:{click:xk,hover:xk},axisInteraction:{click:xk,hover:xk},keyboardInteraction:xk,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:wf()},removeTooltipEntrySettings:{reducer(e,t){var n=of(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:wf()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:vk,removeTooltipEntrySettings:bk,setTooltipSettingsState:wk,setActiveMouseOverItemIndex:Nk,mouseLeaveItem:Sk,mouseLeaveChart:jk,setActiveClickItemIndex:_k,setMouseOverAxisIndex:Ak,setMouseClickAxisIndex:Ck,setSyncInteraction:Mk,setKeyboardInteraction:kk}=yk.actions,Ek=yk.reducer;function Tk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Pk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tk(Object(n),!0).forEach(function(t){Dk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Dk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rk=(e,t,n,r)=>{if(null==t)return xk;var a=function(e,t,n){return"axis"===t?"click"===n?e.axisInteraction.click:e.axisInteraction.hover:"click"===n?e.itemInteraction.click:e.itemInteraction.hover}(e,t,n);if(null==a)return xk;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var i=!0===e.settings.active;if(null!=a.index){if(i)return Pk(Pk({},a),{},{active:!0})}else if(null!=r)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return Pk(Pk({},xk),{},{coordinate:a.coordinate})},Ik=(e,t)=>{var n=null==e?void 0:e.index;if(null==n)return null;var r=Number(n);if(!Cy(r))return n;var a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(0,Math.min(r,a)))},Ok=(e,t,n,r,a,i,s,o)=>{if(null!=i&&null!=o){var l=s[0],c=null==l?void 0:o(l.positions,i);if(null!=c)return c;var d=null==a?void 0:a[Number(i)];if(d)return"horizontal"===n?{x:d.coordinate,y:(r.top+t)/2}:{x:(r.left+e)/2,y:d.coordinate}}},Bk=(e,t,n,r)=>{return"axis"===t?e.tooltipItemPayloads:0===e.tooltipItemPayloads.length?[]:null==(a="hover"===n?e.itemInteraction.hover.dataKey:e.itemInteraction.click.dataKey)&&null!=r?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(e=>{var t;return(null===(t=e.settings)||void 0===t?void 0:t.dataKey)===a});var a},Lk=e=>e.options.tooltipPayloadSearcher,Fk=e=>e.tooltip;function Uk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function zk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uk(Object(n),!0).forEach(function(t){Hk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Hk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gk=(e,t,n,r,a,i,s)=>{if(null!=t&&null!=i){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:d}=n;return e.reduce((e,n)=>{var u,h,p,{dataDefinedOnItem:m,settings:g}=n,f=function(e,t){return null!=e?e:t}(m,o),x=Array.isArray(f)?Cx(f,c,d):f,y=null!==(u=null==g?void 0:g.dataKey)&&void 0!==u?u:r,v=null==g?void 0:g.nameKey;(h=r&&Array.isArray(x)&&!Array.isArray(x[0])&&"axis"===s?fh(x,r,a):i(x,t,l,v),Array.isArray(h))?h.forEach(t=>{var n=zk(zk({},g),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(Vx({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:Tx(t.payload,t.dataKey),name:t.name}))}):e.push(Vx({tooltipEntrySettings:g,dataKey:y,payload:h,value:Tx(h,y),name:null!==(p=Tx(h,v))&&void 0!==p?p:null==g?void 0:g.name}));return e},[])}},Vk=Om([cC,Gy,kC,TA,oC],CM),$k=Om([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Wk=Om([oC,lC],EC),Yk=Om([$k,cC,Wk],DC,{memoizeOptions:{resultEqualityCheck:mC}}),Xk=Om([Yk],e=>e.filter(hC)),Kk=Om([Yk],LC,{memoizeOptions:{resultEqualityCheck:mC}}),qk=Om([Kk,M_],UC),Jk=Om([Xk,M_,cC],uC),Qk=Om([qk,cC,Yk],HC),Zk=Om([cC],ZC),eE=Om([cC],e=>e.allowDataOverflow),tE=Om([Zk,eE],D_),nE=Om([Yk],e=>e.filter(hC)),rE=Om([Jk,nE,EA],KC),aE=Om([rE,M_,oC,tE],JC),iE=Om([Yk],OC),sE=Om([qk,cC,iE,rM,oC],iM,{memoizeOptions:{resultEqualityCheck:pC}}),oE=Om([lM,oC,lC],cM),lE=Om([oE,oC],gM),cE=Om([uM,oC,lC],cM),dE=Om([cE,oC],xM),uE=Om([pM,oC,lC],cM),hE=Om([uE,oC],vM),pE=Om([lE,hE,dE],aM),mE=Om([cC,Zk,tE,aE,sE,pE,Gy,oC],NM),gE=Om([cC,Gy,qk,Qk,EA,oC,mE],_M),fE=Om([gE,cC,Vk],EM),xE=Om([cC,gE,fE,oC],PM),yE=e=>{var t=oC(e),n=lC(e);return UM(e,t,n,!1)},vE=Om([cC,yE],VA),bE=Om([cC,Vk,xE,vE],kM),wE=Om([Gy,Qk,cC,oC],nk),NE=Om([Gy,Qk,cC,oC],ak),SE=Om([Gy,cC,Vk,bE,yE,wE,NE,oC],(e,t,n,r,a,i,s,o)=>{if(t){var{type:l}=t,c=Px(e,o);if(r){var d="scaleBand"===n&&r.bandwidth?r.bandwidth()/2:2,u="category"===l&&r.bandwidth?r.bandwidth()/d:0;return u="angleAxis"===o&&null!=a&&(null==a?void 0:a.length)>=2?2*sh(a[0]-a[1])*u:u,c&&s?s.map((e,t)=>({coordinate:r(e)+u,value:e,index:t,offset:u})):r.domain().map((e,t)=>({coordinate:r(e)+u,value:i?i[e]:e,index:t,offset:u}))}}}),jE=Om([hk,pk,e=>e.tooltip.settings],(e,t,n)=>mk(n.shared,e,t)),_E=e=>e.tooltip.settings.trigger,AE=e=>e.tooltip.settings.defaultIndex,CE=Om([Fk,jE,_E,AE],Rk),ME=Om([CE,qk],Ik),kE=Om([SE,ME],fk),EE=Om([CE],e=>{if(e)return e.dataKey}),TE=Om([Fk,jE,_E,AE],Bk),PE=Om([Wx,Yx,Gy,sy,SE,AE,TE,Lk],Ok),DE=Om([CE,PE],(e,t)=>null!=e&&e.coordinate?e.coordinate:t),RE=Om([CE],e=>e.active),IE=Om([TE,ME,M_,dC,kE,Lk,jE],Gk),OE=Om([IE],e=>{if(null!=e){var t=e.map(e=>e.payload).filter(e=>null!=e);return Array.from(new Set(t))}});function BE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BE(Object(n),!0).forEach(function(t){FE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function FE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var UE=()=>{var e=Mm(cC),t=Mm(SE),n=Mm(bE);return Gx(LE(LE({},e),{},{scale:n}),t)},zE=(e,t)=>t,HE=(e,t,n)=>n,GE=(e,t,n,r)=>r,VE=Om(SE,e=>sg(e,e=>e.coordinate)),$E=Om([Fk,zE,HE,GE],Rk),WE=Om([$E,qk],Ik),YE=Om([Fk,zE,HE,GE],Bk),XE=Om([Wx,Yx,Gy,sy,SE,GE,YE,Lk],Ok),KE=Om([$E,XE],(e,t)=>{var n;return null!==(n=e.coordinate)&&void 0!==n?n:t}),qE=Om(SE,WE,fk),JE=Om([YE,WE,M_,dC,qE,Lk,zE],Gk),QE=Om([$E],e=>({isActive:e.active,activeIndex:e.index}));function ZE(){return ZE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZE.apply(null,arguments)}function eT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eT(Object(n),!0).forEach(function(t){nT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rT(e){var t,n,{coordinate:r,payload:a,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:d,chartName:u}=e,h=r,p=a,m=i;if(!c||!h||"ScatterChart"!==u&&"axis"!==d)return null;if("ScatterChart"===u)t=h,n=zv;else if("BarChart"===u)t=function(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-a:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-a,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(l,h,s,o),n=kb;else if("radial"===l){var{cx:g,cy:x,radius:y,startAngle:v,endAngle:b}=Eb(h);t={cx:g,cy:x,startAngle:v,endAngle:b,innerRadius:y,outerRadius:y},n=Ib}else t={points:Ob(l,h,s)},n=Iv;var w="object"==typeof c&&"className"in c?c.className:void 0,N=tT(tT(tT(tT({stroke:"#ccc",pointerEvents:"none"},s),t),_d(c)),{},{payload:p,payloadIndex:m,className:yd("recharts-tooltip-cursor",w)});return f.isValidElement(c)?f.cloneElement(c,N):f.createElement(n,N)}function aT(e){var t=UE(),n=Uy(),r=Vy(),a=Mm(TA);return f.createElement(rT,ZE({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:r,tooltipAxisBandSize:t,chartName:a}))}var iT,sT=f.createContext(null),oT={exports:{}};var lT=(iT||(iT=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new a(r,i||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,i=r.length,s=new Array(i);a<i;a++)s[a]=r[a].fn;return s},o.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,a,i,s){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,a),!0;case 5:return d.fn.call(d.context,t,r,a,i),!0;case 6:return d.fn.call(d.context,t,r,a,i,s),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var h,p=d.length;for(c=0;c<p;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,r);break;case 4:d[c].fn.call(d[c].context,t,r,a);break;default:if(!l)for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];d[c].fn.apply(d[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,r,a){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||a&&!o.once||r&&o.context!==r||s(this,i);else{for(var l=0,c=[],d=o.length;l<d;l++)(o[l].fn!==t||a&&!o[l].once||r&&o[l].context!==r)&&c.push(o[l]);c.length?this._events[i]=1===c.length?c[0]:c:s(this,i)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(oT)),oT.exports);var cT=new(g(lT)),dT="recharts.syncEvent.tooltip",uT="recharts.syncEvent.brush";function hT(e,t){if(t){var n=Number.parseInt(t,10);if(!oh(n))return null==e?void 0:e[n]}}var pT=Tf({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),mT=pT.reducer,{createEventEmitter:gT}=pT.actions;function fT(e){return e.tooltip.syncInteraction}var xT=Tf({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload)return e.dataStartIndex=0,void(e.dataEndIndex=0);t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;null!=n&&(e.dataStartIndex=n),null!=r&&(e.dataEndIndex=r)}}}),{setChartData:yT,setDataStartEndIndexes:vT,setComputedData:bT}=xT.actions,wT=xT.reducer,NT=["x","y"];function ST(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ST(Object(n),!0).forEach(function(t){_T(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ST(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _T(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AT=()=>{};function CT(){var e=Mm(PA),t=Mm(RA),n=jm(),r=Mm(DA),a=Mm(SE),i=Vy(),s=Ly(),o=Mm(e=>e.rootProps.className);f.useEffect(()=>{if(null==e)return AT;var o=(o,l,c)=>{var d;if(t!==c&&e===o)if("index"!==r){if(null!=a){var u;if("function"==typeof r){var h={activeTooltipIndex:null==l.payload.index?void 0:Number(l.payload.index),isTooltipActive:l.payload.active,activeIndex:null==l.payload.index?void 0:Number(l.payload.index),activeLabel:l.payload.label,activeDataKey:l.payload.dataKey,activeCoordinate:l.payload.coordinate},p=r(a,h);u=a[p]}else"value"===r&&(u=a.find(e=>String(e.value)===l.payload.label));var{coordinate:m}=l.payload;if(null!=u&&!1!==l.payload.active&&null!=m&&null!=s){var{x:g,y:f}=m,x=Math.min(g,s.x+s.width),y=Math.min(f,s.y+s.height),v={x:"horizontal"===i?u.coordinate:x,y:"horizontal"===i?y:u.coordinate},b=Mk({active:l.payload.active,coordinate:v,dataKey:l.payload.dataKey,index:String(u.index),label:l.payload.label,sourceViewBox:l.payload.sourceViewBox});n(b)}else n(Mk({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}))}}else if(s&&null!=l&&null!==(d=l.payload)&&void 0!==d&&d.coordinate&&l.payload.sourceViewBox){var w=l.payload.coordinate,{x:N,y:S}=w,j=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(w,NT),{x:_,y:A,width:C,height:M}=l.payload.sourceViewBox,k=jT(jT({},j),{},{x:s.x+(C?(N-_)/C:0)*s.width,y:s.y+(M?(S-A)/M:0)*s.height});n(jT(jT({},l),{},{payload:jT(jT({},l.payload),{},{coordinate:k})}))}else n(l)};return cT.on(dT,o),()=>{cT.off(dT,o)}},[o,n,t,e,r,a,i,s])}function MT(){var e=jm();f.useEffect(()=>{e(gT())},[e]),CT(),function(){var e=Mm(PA),t=Mm(RA),n=jm();f.useEffect(()=>{if(null==e)return AT;var r=(r,a,i)=>{t!==i&&e===r&&n(vT(a))};return cT.on(uT,r),()=>{cT.off(uT,r)}},[n,t,e])}()}function kT(e,t,n,r,a,i){var s=Mm(n=>((e,t,n)=>{if(null!=t){var r=Fk(e);return"axis"===t?"hover"===n?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:"hover"===n?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}})(n,e,t)),o=Mm(RA),l=Mm(PA),c=Mm(DA),d=Mm(fT),u=null==d?void 0:d.active,h=Ly();f.useEffect(()=>{if(!u&&null!=l&&null!=o){var e=Mk({active:i,coordinate:n,dataKey:s,index:a,label:"number"==typeof r?String(r):r,sourceViewBox:h});cT.emit(dT,l,e,o)}},[u,n,s,a,r,o,l,c,i,h])}function ET(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function TT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ET(Object(n),!0).forEach(function(t){PT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ET(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function PT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DT(e){return e.dataKey}var RT=[],IT={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!jv,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function OT(e){var t=Vv(e,IT),{active:n,allowEscapeViewBox:r,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:l,offset:c,payloadUniqBy:d,position:u,reverseDirection:h,useTranslate3d:p,wrapperStyle:m,cursor:g,shared:x,trigger:y,defaultIndex:v,portal:w,axisId:N}=t,S=jm(),j="number"==typeof v?String(v):v;f.useEffect(()=>{S(wk({shared:x,trigger:y,axisId:N,active:n,defaultIndex:j}))},[S,x,y,N,n,j]);var _=Ly(),A=_v(),C=function(e){return Mm(t=>gk(t,e))}(x),{activeIndex:M,isActive:k}=Mm(e=>QE(e,C,y,j)),E=Mm(e=>JE(e,C,y,j)),T=Mm(e=>qE(e,C,y,j)),P=Mm(e=>KE(e,C,y,j)),D=E,R=f.useContext(sT),I=null!=n?n:k,[O,B]=cg([D,I]),L="axis"===C?T:void 0;kT(C,y,P,L,M,I);var F=null!=w?w:R;if(null==F)return null;var U=null!=D?D:RT;I||(U=RT),o&&U.length&&(U=dm(D.filter(e=>null!=e.value&&(!0!==e.hide||t.includeHidden)),d,DT));var z=U.length>0,H=f.createElement(Nv,{allowEscapeViewBox:r,animationDuration:a,animationEasing:i,isAnimationActive:l,active:I,coordinate:P,hasPayload:z,offset:c,position:u,reverseDirection:h,useTranslate3d:p,viewBox:_,wrapperStyle:m,lastBoundingBox:O,innerRef:B,hasPortalFromProps:Boolean(w)},function(e,t){return f.isValidElement(e)?f.cloneElement(e,t):"function"==typeof e?f.createElement(e,t):f.createElement(mv,t)}(s,TT(TT({},t),{},{payload:U,label:L,active:I,coordinate:P,accessibilityLayer:A})));return f.createElement(f.Fragment,null,b.createPortal(H,F),I&&f.createElement(aT,{cursor:g,tooltipEventType:C,coordinate:P,payload:D,index:M}))}var BT=e=>null;function LT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}BT.displayName="Cell";function FT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function UT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zT=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?FT(Object(n),!0).forEach(function(t){UT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},{cacheSize:2e3,enableCache:!0}),HT=new class{constructor(e){LT(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(zT.cacheSize),GT={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},VT="recharts_measurement_span";var $T=(e,t)=>{try{var n=document.getElementById(VT);n||((n=document.createElement("span")).setAttribute("id",VT),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,GT,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch(a){return{width:0,height:0}}},WT=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e||jv)return{width:0,height:0};if(!zT.enableCache)return $T(e,t);var n=function(e,t){var n=t.fontSize||"",r=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}(e,t),r=HT.get(n);if(r)return r;var a=$T(e,t);return HT.set(n,a),a},YT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,KT=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,qT=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,JT={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},QT=Object.keys(JT),ZT="NaN";class eP{static parse(e){var t,[,n,r]=null!==(t=qT.exec(e))&&void 0!==t?t:[];return new eP(parseFloat(n),null!=r?r:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,oh(e)&&(this.unit=""),""===t||KT.test(t)||(this.num=NaN,this.unit=""),QT.includes(t)&&(this.num=function(e,t){return e*JT[t]}(e,t),this.unit="px")}add(e){return this.unit!==e.unit?new eP(NaN,""):new eP(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new eP(NaN,""):new eP(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new eP(NaN,""):new eP(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new eP(NaN,""):new eP(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return oh(this.num)}}function tP(e){if(e.includes(ZT))return ZT;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,a,i]=null!==(n=YT.exec(t))&&void 0!==n?n:[],s=eP.parse(null!=r?r:""),o=eP.parse(null!=i?i:""),l="*"===a?s.multiply(o):s.divide(o);if(l.isNaN())return ZT;t=t.replace(YT,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,h]=null!==(c=XT.exec(t))&&void 0!==c?c:[],p=eP.parse(null!=d?d:""),m=eP.parse(null!=h?h:""),g="+"===u?p.add(m):p.subtract(m);if(g.isNaN())return ZT;t=t.replace(XT,g.toString())}return t}var nP=/\(([^()]*)\)/;function rP(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t,n=e;null!=(t=nP.exec(n));){var[,r]=t;n=n.replace(nP,tP(r))}return n}(t),t=tP(t)}function aP(e){var t=function(e){try{return rP(e)}catch(t){return ZT}}(e.slice(5,-1));return t===ZT?"":t}var iP=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],sP=["dx","dy","angle","className","breakAll"];function oP(){return oP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oP.apply(null,arguments)}function lP(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var cP=/[ \f\n\r\t\v\u2028\u2029]+/,dP=e=>{var{children:t,breakAll:n,style:r}=e;try{var a=[];return xh(t)||(a=n?t.toString().split(""):t.toString().split(cP)),{wordsWithComputedWidth:a.map(e=>({word:e,width:WT(e,r).width})),spaceWidth:n?0:WT("",r).width}}catch(i){return null}},uP=e=>[{words:xh(e)?[]:e.toString().split(cP)}],hP=e=>{var{width:t,scaleToFit:n,children:r,style:a,breakAll:i,maxLines:s}=e;if((t||n)&&!jv){var o=dP({breakAll:i,children:r,style:a});if(!o)return uP(r);var{wordsWithComputedWidth:l,spaceWidth:c}=o;return((e,t,n,r,a)=>{var{maxLines:i,children:s,style:o,breakAll:l}=e,c=ch(i),d=s,u=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((e,t)=>{var{word:i,width:s}=t,o=e[e.length-1];if(o&&(null==r||a||o.width+s+n<Number(r)))o.words.push(i),o.width+=s+n;else{var l={words:[i],width:s};e.push(l)}return e},[])},h=u(t),p=e=>e.reduce((e,t)=>e.width>t.width?e:t);if(!c||a)return h;if(!(h.length>i||p(h).width>Number(r)))return h;for(var m,g=e=>{var t=d.slice(0,e),n=dP({breakAll:l,style:o,children:t+""}).wordsWithComputedWidth,a=u(n);return[a.length>i||p(a).width>Number(r),a]},f=0,x=d.length-1,y=0;f<=x&&y<=d.length-1;){var v=Math.floor((f+x)/2),b=v-1,[w,N]=g(b),[S]=g(v);if(w||S||(f=v+1),w&&S&&(x=v-1),!w&&S){m=N;break}y++}return m||h})({breakAll:i,children:r,maxLines:s,style:a},l,c,t,n)}return uP(r)},pP="#808080",mP=f.forwardRef((e,t)=>{var{x:n=0,y:r=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:c=pP}=e,d=lP(e,iP),u=f.useMemo(()=>hP({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:h,dy:p,angle:m,className:g,breakAll:x}=d,y=lP(d,sP);if(!dh(n)||!dh(r)||0===u.length)return null;var v,b=n+(ch(h)?h:0),w=r+(ch(p)?p:0);switch(l){case"start":v=aP("calc(".concat(i,")"));break;case"middle":v=aP("calc(".concat((u.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:v=aP("calc(".concat(u.length-1," * -").concat(a,")"))}var N=[];if(s){var S=u[0].width,{width:j}=d;N.push("scale(".concat(ch(j)?j/S:1,")"))}return m&&N.push("rotate(".concat(m,", ").concat(b,", ").concat(w,")")),N.length&&(y.transform=N.join(" ")),f.createElement("text",oP({},Ad(y),{ref:t,x:b,y:w,className:yd("recharts-text",g),textAnchor:o,fill:c.includes("url")?pP:c}),u.map((e,t)=>{var n=e.words.join(x?"":" ");return f.createElement("tspan",{x:b,dy:0===t?v:a,key:"".concat(n,"-").concat(t)},n)}))});mP.displayName="Text";var gP=["labelRef"];function fP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fP(Object(n),!0).forEach(function(t){yP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function yP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vP(){return vP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vP.apply(null,arguments)}var bP=f.createContext(null),wP=e=>{var{x:t,y:n,width:r,height:a,children:i}=e,s=f.useMemo(()=>({x:t,y:n,width:r,height:a}),[t,n,r,a]);return f.createElement(bP.Provider,{value:s},i)},NP=()=>{var e=f.useContext(bP),t=Ly();return e||t},SP=f.createContext(null),jP=e=>null!=e&&"function"==typeof e,_P=(e,t,n,r,a)=>{var i,s,{offset:o,className:l}=e,{cx:c,cy:d,innerRadius:u,outerRadius:h,startAngle:p,endAngle:m,clockWise:g}=a,x=(u+h)/2,y=((e,t)=>sh(t-e)*Math.min(Math.abs(t-e),360))(p,m),v=y>=0?1:-1;switch(t){case"insideStart":i=p+v*o,s=g;break;case"insideEnd":i=m-v*o,s=!g;break;case"end":i=m+v*o,s=g;break;default:throw new Error("Unsupported position ".concat(t))}s=y<=0?s:!s;var b=Sx(c,d,x,i),w=Sx(c,d,x,i+359*(s?1:-1)),N="M".concat(b.x,",").concat(b.y,"\n    A").concat(x,",").concat(x,",0,1,").concat(s?0:1,",\n    ").concat(w.x,",").concat(w.y),S=xh(e.id)?hh("recharts-radial-line-"):e.id;return f.createElement("text",vP({},r,{dominantBaseline:"central",className:yd("recharts-radial-bar-label",l)}),f.createElement("defs",null,f.createElement("path",{id:S,d:N})),f.createElement("textPath",{xlinkHref:"#".concat(S)},n))},AP=e=>"cx"in e&&ch(e.cx),CP={offset:5};function MP(e){var t,n,r=Vv(e,CP),{viewBox:a,position:i,value:s,children:o,content:l,className:c="",textBreakAll:d,labelRef:u}=r,h=(t=f.useContext(SP),n=Mm(rC),t||n),p=NP(),m=a||("center"===i?p:null!=h?h:p);if(!m||xh(s)&&xh(o)&&!f.isValidElement(l)&&"function"!=typeof l)return null;var g,x=xP(xP({},r),{},{viewBox:m});if(f.isValidElement(l)){var{labelRef:y}=x,v=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(x,gP);return f.cloneElement(l,v)}if("function"==typeof l){if(g=f.createElement(l,x),f.isValidElement(g))return g}else g=(e=>{var{value:t,formatter:n}=e,r=xh(e.children)?t:e.children;return"function"==typeof n?n(r):r})(r);var b=AP(m),w=Ad(r);if(b&&("insideStart"===i||"insideEnd"===i||"end"===i))return _P(r,i,g,w,m);var N=b?((e,t,n)=>{var{cx:r,cy:a,innerRadius:i,outerRadius:s,startAngle:o,endAngle:l}=e,c=(o+l)/2;if("outside"===n){var{x:d,y:u}=Sx(r,a,s+t,c);return{x:d,y:u,textAnchor:d>=r?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(i+s)/2,{x:p,y:m}=Sx(r,a,h,c);return{x:p,y:m,textAnchor:"middle",verticalAnchor:"middle"}})(m,r.offset,r.position):((e,t)=>{var n,{parentViewBox:r,offset:a,position:i}=e;null==r||AP(r)||(n=r);var{x:s,y:o,width:l,height:c}=t,d=c>=0?1:-1,u=d*a,h=d>0?"end":"start",p=d>0?"start":"end",m=l>=0?1:-1,g=m*a,f=m>0?"end":"start",x=m>0?"start":"end";if("top"===i)return xP(xP({},{x:s+l/2,y:o-d*a,textAnchor:"middle",verticalAnchor:h}),n?{height:Math.max(o-n.y,0),width:l}:{});if("bottom"===i)return xP(xP({},{x:s+l/2,y:o+c+u,textAnchor:"middle",verticalAnchor:p}),n?{height:Math.max(n.y+n.height-(o+c),0),width:l}:{});if("left"===i){var y={x:s-g,y:o+c/2,textAnchor:f,verticalAnchor:"middle"};return xP(xP({},y),n?{width:Math.max(y.x-n.x,0),height:c}:{})}if("right"===i){var v={x:s+l+g,y:o+c/2,textAnchor:x,verticalAnchor:"middle"};return xP(xP({},v),n?{width:Math.max(n.x+n.width-v.x,0),height:c}:{})}var b=n?{width:l,height:c}:{};return"insideLeft"===i?xP({x:s+g,y:o+c/2,textAnchor:x,verticalAnchor:"middle"},b):"insideRight"===i?xP({x:s+l-g,y:o+c/2,textAnchor:f,verticalAnchor:"middle"},b):"insideTop"===i?xP({x:s+l/2,y:o+u,textAnchor:"middle",verticalAnchor:p},b):"insideBottom"===i?xP({x:s+l/2,y:o+c-u,textAnchor:"middle",verticalAnchor:h},b):"insideTopLeft"===i?xP({x:s+g,y:o+u,textAnchor:x,verticalAnchor:p},b):"insideTopRight"===i?xP({x:s+l-g,y:o+u,textAnchor:f,verticalAnchor:p},b):"insideBottomLeft"===i?xP({x:s+g,y:o+c-u,textAnchor:x,verticalAnchor:h},b):"insideBottomRight"===i?xP({x:s+l-g,y:o+c-u,textAnchor:f,verticalAnchor:h},b):i&&"object"==typeof i&&(ch(i.x)||lh(i.x))&&(ch(i.y)||lh(i.y))?xP({x:s+ph(i.x,l),y:o+ph(i.y,c),textAnchor:"end",verticalAnchor:"end"},b):xP({x:s+l/2,y:o+c/2,textAnchor:"middle",verticalAnchor:"middle"},b)})(r,m);return f.createElement(mP,vP({ref:u,className:yd("recharts-label",c)},w,N,{breakAll:d}),g)}MP.displayName="Label";function kP(e){var{label:t,labelRef:n}=e;return((e,t,n)=>{if(!e)return null;var r={viewBox:t,labelRef:n};return!0===e?f.createElement(MP,vP({key:"label-implicit"},r)):dh(e)?f.createElement(MP,vP({key:"label-implicit",value:e},r)):f.isValidElement(e)?e.type===MP?f.cloneElement(e,xP({key:"label-implicit"},r)):f.createElement(MP,vP({key:"label-implicit",content:e},r)):jP(e)?f.createElement(MP,vP({key:"label-implicit",content:e},r)):e&&"object"==typeof e?f.createElement(MP,vP({},e,{key:"label-implicit"},r)):null})(t,NP(),n)||null}var EP,TP={},PP={};function DP(){return EP||(EP=1,e=PP,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.last=function(e){return e[e.length-1]}),PP;var e}var RP,IP,OP,BP,LP={};function FP(){return RP||(RP=1,e=LP,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}),LP;var e}function UP(){return BP?OP:(BP=1,OP=(IP||(IP=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DP(),n=FP(),r=Yh();e.last=function(e){if(r.isArrayLike(e))return t.last(n.toArray(e))}}(TP)),TP).last)}const zP=g(UP());var HP=["valueAccessor"],GP=["dataKey","clockWise","id","textBreakAll"];function VP(){return VP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VP.apply(null,arguments)}function $P(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var WP=e=>Array.isArray(e.value)?zP(e.value):e.value,YP=f.createContext(void 0),XP=YP.Provider,KP=f.createContext(void 0);function qP(e){var{valueAccessor:t=WP}=e,n=$P(e,HP),{dataKey:r,clockWise:a,id:i,textBreakAll:s}=n,o=$P(n,GP),l=f.useContext(YP),c=f.useContext(KP),d=l||c;return d&&d.length?f.createElement(Pd,{className:"recharts-label-list"},d.map((e,a)=>{var l,c=xh(r)?t(e,a):Tx(e&&e.payload,r),d=xh(i)?{}:{id:"".concat(i,"-").concat(a)};return f.createElement(MP,VP({key:"label-".concat(a)},Ad(e),o,d,{fill:null!==(l=n.fill)&&void 0!==l?l:e.fill,parentViewBox:e.parentViewBox,value:c,textBreakAll:s,viewBox:e.viewBox,index:a}))})):null}function JP(e){var{label:t}=e;return t?!0===t?f.createElement(qP,{key:"labelList-implicit"}):f.isValidElement(t)||jP(t)?f.createElement(qP,{key:"labelList-implicit",content:t}):"object"==typeof t?f.createElement(qP,VP({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function QP(){return QP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},QP.apply(null,arguments)}KP.Provider,qP.displayName="LabelList";var ZP,eD,tD=e=>{var{cx:t,cy:n,r:r,className:a}=e,i=yd("recharts-dot",a);return t===+t&&n===+n&&r===+r?f.createElement("circle",QP({},jd(e),Ch(e),{className:i,cx:t,cy:n,r:r})):null},nD=Tf({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:rD,removeRadiusAxis:aD,addAngleAxis:iD,removeAngleAxis:sD}=nD.actions,oD=nD.reducer,lD={exports:{}},cD={};function dD(){if(ZP)return cD;ZP=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.for("react.view_transition"),p=Symbol.for("react.client.reference");function m(p){if("object"==typeof p&&null!==p){var m=p.$$typeof;switch(m){case e:switch(p=p.type){case n:case a:case r:case l:case c:case h:return p;default:switch(p=p&&p.$$typeof){case s:case o:case u:case d:case i:return p;default:return m}}case t:return m}}}return cD.ContextConsumer=i,cD.ContextProvider=s,cD.Element=e,cD.ForwardRef=o,cD.Fragment=n,cD.Lazy=u,cD.Memo=d,cD.Portal=t,cD.Profiler=a,cD.StrictMode=r,cD.Suspense=l,cD.SuspenseList=c,cD.isContextConsumer=function(e){return m(e)===i},cD.isContextProvider=function(e){return m(e)===s},cD.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===e},cD.isForwardRef=function(e){return m(e)===o},cD.isFragment=function(e){return m(e)===n},cD.isLazy=function(e){return m(e)===u},cD.isMemo=function(e){return m(e)===d},cD.isPortal=function(e){return m(e)===t},cD.isProfiler=function(e){return m(e)===a},cD.isStrictMode=function(e){return m(e)===r},cD.isSuspense=function(e){return m(e)===l},cD.isSuspenseList=function(e){return m(e)===c},cD.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===a||e===r||e===l||e===c||"object"==typeof e&&null!==e&&(e.$$typeof===u||e.$$typeof===d||e.$$typeof===s||e.$$typeof===i||e.$$typeof===o||e.$$typeof===p||void 0!==e.getModuleId)},cD.typeOf=m,cD}function uD(){return eD||(eD=1,lD.exports=dD()),lD.exports}var hD=uD(),pD=e=>"string"==typeof e?e:e?e.displayName||e.name||"Component":"",mD=null,gD=null,fD=e=>{if(e===mD&&Array.isArray(gD))return gD;var t=[];return f.Children.forEach(e,e=>{xh(e)||(hD.isFragment(e)?t=t.concat(fD(e.props.children)):t.push(e))}),gD=t,mD=e,t};var xD,yD,vD,bD=e=>!e||"object"!=typeof e||!("clipDot"in e)||Boolean(e.clipDot),wD={};function ND(){return vD?yD:(vD=1,yD=(xD||(xD=1,e=wD,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),e.isPlainObject=function(e){var t;if("object"!=typeof e)return!1;if(null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){const n=e[Symbol.toStringTag];return null!=n&&!!(null==(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))?void 0:t.writable)&&e.toString()===`[object ${n}]`}let n=e;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}),wD).isPlainObject);var e}const SD=g(ND());function jD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jD(Object(n),!0).forEach(function(t){AD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function AD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CD(){return CD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CD.apply(null,arguments)}var MD=(e,t,n,r,a)=>{var i,s=n-r;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+n,",").concat(t),i+="L ".concat(e+n-s/2,",").concat(t+a),i+="L ".concat(e+n-s/2-r,",").concat(t+a),i+="L ".concat(e,",").concat(t," Z")},kD={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ED=e=>{var t=Vv(e,kD),{x:n,y:r,upperWidth:a,lowerWidth:i,height:s,className:o}=t,{animationEasing:l,animationDuration:c,animationBegin:d,isUpdateAnimationActive:u}=t,h=f.useRef(null),[p,m]=f.useState(-1),g=f.useRef(a),x=f.useRef(i),y=f.useRef(s),v=f.useRef(n),b=f.useRef(r),w=vb(e,"trapezoid-");if(f.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var e=h.current.getTotalLength();e&&m(e)}catch(t){}},[]),n!==+n||r!==+r||a!==+a||i!==+i||s!==+s||0===a&&0===i||0===s)return null;var N=yd("recharts-trapezoid",o);if(!u)return f.createElement("g",null,f.createElement("path",CD({},Ad(t),{className:N,d:MD(n,r,a,i,s)})));var S=g.current,j=x.current,_=y.current,A=v.current,C=b.current,M="0px ".concat(-1===p?1:p,"px"),k="".concat(p,"px 0px"),E=qv(["strokeDasharray"],c,l);return f.createElement(yb,{animationId:w,key:w,canBegin:p>0,duration:c,easing:l,isActive:u,begin:d},e=>{var o=gh(S,a,e),l=gh(j,i,e),c=gh(_,s,e),d=gh(A,n,e),u=gh(C,r,e);h.current&&(g.current=o,x.current=l,y.current=c,v.current=d,b.current=u);var p=e>0?{transition:E,strokeDasharray:k}:{strokeDasharray:M};return f.createElement("path",CD({},Ad(t),{className:N,d:MD(d,u,o,l,c),ref:h,style:_D(_D({},p),t.style)}))})},TD=["option","shapeType","propTransformer","activeClassName","isActive"];function PD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function DD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PD(Object(n),!0).forEach(function(t){RD(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PD(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function RD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ID(e,t){return DD(DD({},t),e)}function OD(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return f.createElement(kb,n);case"trapezoid":return f.createElement(ED,n);case"sector":return f.createElement(Ib,n);case"symbols":if(function(e){return"symbols"===e}(t))return f.createElement(Ah,n);break;default:return null}}function BD(e){var t,{option:n,shapeType:r,propTransformer:a=ID,activeClassName:i="recharts-active-shape",isActive:s}=e,o=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,TD);if(f.isValidElement(n))t=f.cloneElement(n,DD(DD({},o),function(e){return f.isValidElement(e)?e.props:e}(n)));else if("function"==typeof n)t=n(o);else if(SD(n)&&"boolean"!=typeof n){var l=a(n,o);t=f.createElement(OD,{shapeType:r,elementProps:l})}else{var c=o;t=f.createElement(OD,{shapeType:r,elementProps:c})}return s?f.createElement(Pd,{className:i},t):t}var LD=(e,t)=>{var n=jm();return(r,a)=>i=>{null==e||e(r,a,i),n(Nk({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},FD=e=>{var t=jm();return(n,r)=>a=>{null==e||e(n,r,a),t(Sk())}},UD=(e,t)=>{var n=jm();return(r,a)=>i=>{null==e||e(r,a,i),n(_k({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function zD(e){var{fn:t,args:n}=e,r=jm(),a=dy();return f.useLayoutEffect(()=>{if(!a){var e=t(n);return r(vk(e)),()=>{r(bk(e))}}},[t,n,r,a]),null}var HD,GD=()=>{};function VD(e){var{legendPayload:t}=e,n=jm(),r=dy();return f.useLayoutEffect(()=>r?GD:(n(Ky(t)),()=>{n(qy(t))}),[n,r,t]),null}var $D=null!==(HD=w["useId".toString()])&&void 0!==HD?HD:()=>{var[e]=f.useState(()=>hh("uid-"));return e};var WD=f.createContext(void 0),YD=e=>{var t,n,r,{id:a,type:i,children:s}=e,o=(t="recharts-".concat(i),n=a,r=$D(),n||(t?"".concat(t,"-").concat(r):r));return f.createElement(WD.Provider,{value:o},s(o))},XD=Tf({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:wf()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:r}=t.payload,a=of(e).cartesianItems.indexOf(n);a>-1&&(e.cartesianItems[a]=r)},prepare:wf()},removeCartesianGraphicalItem:{reducer(e,t){var n=of(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:wf()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:wf()},removePolarGraphicalItem:{reducer(e,t){var n=of(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:wf()}}}),{addCartesianGraphicalItem:KD,replaceCartesianGraphicalItem:qD,removeCartesianGraphicalItem:JD,addPolarGraphicalItem:QD,removePolarGraphicalItem:ZD}=XD.actions,eR=XD.reducer;function tR(e){var t=jm(),n=f.useRef(null);return f.useLayoutEffect(()=>{null===n.current?t(KD(e)):n.current!==e&&t(qD({prev:n.current,next:e})),n.current=e},[t,e]),f.useLayoutEffect(()=>()=>{n.current&&(t(JD(n.current)),n.current=null)},[t]),null}function nR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nR(Object(n),!0).forEach(function(t){aR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function aR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iR=Tf({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:wf()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:wf()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:wf()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:wf()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:wf()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:wf()},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload,a=e.yAxis[n];if(a){var i=a.widthHistory||[];if(3===i.length&&i[0]===i[2]&&r===i[1]&&r!==a.width&&Math.abs(r-i[0])<=1)return;var s=[...i,r].slice(-3);e.yAxis[n]=rR(rR({},e.yAxis[n]),{},{width:r,widthHistory:s})}}}}),{addXAxis:sR,removeXAxis:oR,addYAxis:lR,removeYAxis:cR,addZAxis:dR,removeZAxis:uR,updateYAxisWidth:hR}=iR.actions,pR=iR.reducer,mR=Om([sy],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),gR=Om([mR,Wx,Yx],(e,t,n)=>{if(e&&null!=t&&null!=n)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),fR=()=>Mm(gR);function xR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function yR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xR(Object(n),!0).forEach(function(t){vR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bR(e){var{points:t,mainColor:n,activeDot:r,itemDataKey:a}=e,i=Mm(ME),s=Mm(OE);if(null==t||null==s)return null;var o=t.find(e=>s.includes(e.payload));return xh(o)?null:(e=>{var{point:t,childIndex:n,mainColor:r,activeDot:a,dataKey:i}=e;if(!1===a||null==t.x||null==t.y)return null;var s,o=yR(yR({index:n,dataKey:i,cx:t.x,cy:t.y,r:4,fill:null!=r?r:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},_d(a)),Ch(a));return s=f.isValidElement(a)?f.cloneElement(a,o):"function"==typeof a?a(o):f.createElement(tD,o),f.createElement(Pd,{className:"recharts-active-dot"},s)})({point:o,childIndex:Number(i),mainColor:n,dataKey:a,activeDot:r})}var wR=["x","y"];function NR(){return NR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NR.apply(null,arguments)}function SR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SR(Object(n),!0).forEach(function(t){_R(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _R(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AR(e,t){var{x:n,y:r}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,wR),i="".concat(n),s=parseInt(i,10),o="".concat(r),l=parseInt(o,10),c="".concat(t.height||a.height),d=parseInt(c,10),u="".concat(t.width||a.width),h=parseInt(u,10);return jR(jR(jR(jR(jR({},t),a),s?{x:s}:{}),l?{y:l}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function CR(e){return f.createElement(BD,NR({shapeType:"rectangle",propTransformer:AR,activeClassName:"recharts-active-bar"},e))}var MR=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(n,r)=>{if(ch(e))return e;var a=ch(n)||xh(n);return a?e(n,r):(a||function(){throw new Error("Invariant failed")}(),t)}},kR=Tf({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:a}=t.payload;e[n]&&(e[n]=e[n].map(e=>e.dataKey===r.dataKey&&e.direction===r.direction?a:e))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(e=>e.dataKey!==r.dataKey||e.direction!==r.direction))}}}),{addErrorBar:ER,replaceErrorBar:TR,removeErrorBar:PR}=kR.actions,DR=kR.reducer,RR=["children"];var IR={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},OR=f.createContext(IR);function BR(e){var{children:t}=e,n=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,RR);return f.createElement(OR.Provider,{value:n},t)}function LR(e,t){var n,r,a=Mm(t=>wC(t,e)),i=Mm(e=>jC(e,t)),s=null!==(n=null==a?void 0:a.allowDataOverflow)&&void 0!==n?n:vC.allowDataOverflow,o=null!==(r=null==i?void 0:i.allowDataOverflow)&&void 0!==r?r:NC.allowDataOverflow;return{needClip:s||o,needClipX:s,needClipY:o}}function FR(e){var{xAxisId:t,yAxisId:n,clipPathId:r}=e,a=fR(),{needClipX:i,needClipY:s,needClip:o}=LR(t,n);if(!o)return null;var{x:l,y:c,width:d,height:u}=a;return f.createElement("clipPath",{id:"clipPath-".concat(r)},f.createElement("rect",{x:i?l:l-d/2,y:s?c:c-u/2,width:i?d:2*d,height:s?u:2*u}))}var UR=["onMouseEnter","onMouseLeave","onClick"],zR=["value","background","tooltipPosition"],HR=["id"],GR=["onMouseEnter","onClick","onMouseLeave"];function VR(){return VR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VR.apply(null,arguments)}function $R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function WR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$R(Object(n),!0).forEach(function(t){YR(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$R(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function YR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XR(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var KR=e=>{var{dataKey:t,name:n,fill:r,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:r,value:$x(n,t),payload:e}]};function qR(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:a,name:i,hide:s,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:a,dataKey:t,nameKey:void 0,name:$x(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:o}}}function JR(e){var t=Mm(ME),{data:n,dataKey:r,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:o,onClick:l}=i,c=XR(i,UR),d=LD(s,r),u=FD(o),h=UD(l,r);if(!a||null==n)return null;var p=_d(a);return f.createElement(f.Fragment,null,n.map((e,n)=>{var{value:i,background:s,tooltipPosition:o}=e,l=XR(e,zR);if(!s)return null;var m=d(e,n),g=u(e,n),x=h(e,n),y=WR(WR(WR(WR(WR({option:a,isActive:String(n)===t},l),{},{fill:"#eee"},s),p),Mh(c,e,n)),{},{onMouseEnter:m,onMouseLeave:g,onClick:x,dataKey:r,index:n,className:"recharts-bar-background-rectangle"});return f.createElement(CR,VR({key:"background-bar-".concat(n)},y))}))}function QR(e){var{showLabels:t,children:n,rects:r}=e,a=null==r?void 0:r.map(e=>{var t={x:e.x,y:e.y,width:e.width,height:e.height};return WR(WR({},t),{},{value:e.value,payload:e.payload,parentViewBox:e.parentViewBox,viewBox:t,fill:e.fill})});return f.createElement(XP,{value:t?a:void 0},n)}function ZR(e){var{shape:t,activeBar:n,baseProps:r,entry:a,index:i,dataKey:s}=e,o=Mm(ME),l=Mm(EE),c=n&&String(i)===o&&(null==l||s===l),d=c?n:t;return f.createElement(CR,VR({},r,{name:String(r.name)},a,{isActive:c,option:d,index:i,dataKey:s}))}function eI(e){var{shape:t,baseProps:n,entry:r,index:a,dataKey:i}=e;return f.createElement(CR,VR({},n,{name:String(n.name)},r,{isActive:!1,option:t,index:a,dataKey:i}))}function tI(e){var{data:t,props:n}=e,r=jd(n),{id:a}=r,i=XR(r,HR),{shape:s,dataKey:o,activeBar:l}=n,{onMouseEnter:c,onClick:d,onMouseLeave:u}=n,h=XR(n,GR),p=LD(c,o),m=FD(u),g=UD(d,o);return t?f.createElement(f.Fragment,null,t.map((e,t)=>f.createElement(Pd,VR({key:"rectangle-".concat(null==e?void 0:e.x,"-").concat(null==e?void 0:e.y,"-").concat(null==e?void 0:e.value,"-").concat(t),className:"recharts-bar-rectangle"},Mh(h,e,t),{onMouseEnter:p(e,t),onMouseLeave:m(e,t),onClick:g(e,t)}),l?f.createElement(ZR,{shape:s,activeBar:l,baseProps:i,entry:e,index:t,dataKey:o}):f.createElement(eI,{shape:s,baseProps:i,entry:e,index:t,dataKey:o})))):null}function nI(e){var{props:t,previousRectanglesRef:n}=e,{data:r,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l,onAnimationEnd:c,onAnimationStart:d}=t,u=n.current,h=vb(t,"recharts-bar-"),[p,m]=f.useState(!1),g=!p,x=f.useCallback(()=>{"function"==typeof c&&c(),m(!1)},[c]),y=f.useCallback(()=>{"function"==typeof d&&d(),m(!0)},[d]);return f.createElement(QR,{showLabels:g,rects:r},f.createElement(yb,{animationId:h,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:x,onAnimationStart:y,key:h},e=>{var i=1===e?r:null==r?void 0:r.map((t,n)=>{var r=u&&u[n];if(r)return WR(WR({},t),{},{x:gh(r.x,t.x,e),y:gh(r.y,t.y,e),width:gh(r.width,t.width,e),height:gh(r.height,t.height,e)});if("horizontal"===a){var i=gh(0,t.height,e);return WR(WR({},t),{},{y:t.y+t.height-i,height:i})}var s=gh(0,t.width,e);return WR(WR({},t),{},{width:s})});return e>0&&(n.current=null!=i?i:null),null==i?null:f.createElement(Pd,null,f.createElement(tI,{props:t,data:i}))}),f.createElement(JP,{label:t.label}),t.children)}function rI(e){var t=f.useRef(null);return f.createElement(nI,{previousRectanglesRef:t,props:e})}var aI=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:Tx(e,t)}};class iI extends f.PureComponent{render(){var{hide:e,data:t,dataKey:n,className:r,xAxisId:a,yAxisId:i,needClip:s,background:o,id:l}=this.props;if(e||null==t)return null;var c=yd("recharts-bar",r),d=l;return f.createElement(Pd,{className:c,id:l},s&&f.createElement("defs",null,f.createElement(FR,{clipPathId:d,xAxisId:a,yAxisId:i})),f.createElement(Pd,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(d,")"):void 0},f.createElement(JR,{data:t,dataKey:n,background:o,allOtherBarProps:this.props}),f.createElement(rI,this.props)))}}var sI={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!jv,legendType:"rect",minPointSize:0,xAxisId:0,yAxisId:0};function oI(e){var t,n,r,a,i,{xAxisId:s,yAxisId:o,hide:l,legendType:c,minPointSize:d,activeBar:u,animationBegin:h,animationDuration:p,animationEasing:m,isAnimationActive:g}=e,{needClip:x}=LR(s,o),y=Vy(),v=dy(),b=(t=e.children,n=BT,r=[],a=[],a=Array.isArray(n)?n.map(e=>pD(e)):[pD(n)],fD(t).forEach(e=>{var t=ih(e,"type.displayName")||ih(e,"type.name");-1!==a.indexOf(t)&&r.push(e)}),r),w=Mm(t=>AI(t,s,o,v,e.id,b));if("vertical"!==y&&"horizontal"!==y)return null;var N=null==w?void 0:w[0];return i=null==N||null==N.height||null==N.width?0:"vertical"===y?N.height/2:N.width/2,f.createElement(BR,{xAxisId:s,yAxisId:o,data:w,dataPointFormatter:aI,errorBarOffset:i},f.createElement(iI,VR({},e,{layout:y,needClip:x,data:w,xAxisId:s,yAxisId:o,hide:l,legendType:c,minPointSize:d,activeBar:u,animationBegin:h,animationDuration:p,animationEasing:m,isAnimationActive:g})))}function lI(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:a,bandSize:i,xAxis:s,yAxis:o,xAxisTicks:l,yAxisTicks:c,stackedData:d,displayedData:u,offset:h,cells:p,parentViewBox:m}=e,g="horizontal"===t?o:s,f=d?g.scale.domain():null,x=(e=>{var{numericAxis:t}=e,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]})({numericAxis:g});return u.map((e,u)=>{var g,y,v,b,w,N;d?g=((e,t)=>{if(!t||2!==t.length||!ch(t[0])||!ch(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ch(e[0])||e[0]<n)&&(a[0]=n),(!ch(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a})(d[u],f):(g=Tx(e,n),Array.isArray(g)||(g=[x,g]));var S=MR(r,0)(g[1],u);if("horizontal"===t){var j,[_,A]=[o.scale(g[0]),o.scale(g[1])];y=Fx({axis:s,ticks:l,bandSize:i,offset:a.offset,entry:e,index:u}),v=null!==(j=null!=A?A:_)&&void 0!==j?j:void 0,b=a.size;var C=_-A;if(w=oh(C)?0:C,N={x:y,y:h.top,width:b,height:h.height},Math.abs(S)>0&&Math.abs(w)<Math.abs(S)){var M=sh(w||S)*(Math.abs(S)-Math.abs(w));v-=M,w+=M}}else{var[k,E]=[s.scale(g[0]),s.scale(g[1])];if(y=k,v=Fx({axis:o,ticks:c,bandSize:i,offset:a.offset,entry:e,index:u}),b=E-k,w=a.size,N={x:h.left,y:v,width:h.width,height:w},Math.abs(S)>0&&Math.abs(b)<Math.abs(S))b+=sh(b||S)*(Math.abs(S)-Math.abs(b))}return null==y||null==v||null==b||null==w?null:WR(WR({},e),{},{x:y,y:v,width:b,height:w,value:d?g:g[1],payload:e,background:N,tooltipPosition:{x:y+b/2,y:v+w/2},parentViewBox:m},p&&p[u]&&p[u].props)}).filter(Boolean)}function cI(e){var t=Vv(e,sI),n=dy();return f.createElement(YD,{id:t.id,type:"bar"},e=>{return f.createElement(f.Fragment,null,f.createElement(VD,{legendPayload:KR(t)}),f.createElement(zD,{fn:qR,args:t}),f.createElement(tR,{type:"bar",id:e,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:(r=t.stackId,null==r?void 0:String(r)),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),f.createElement(oI,VR({},t,{id:e})));var r})}var dI=f.memo(cI);function uI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uI(Object(n),!0).forEach(function(t){pI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}dI.displayName="Bar";var mI=Om([TC,(e,t,n,r,a)=>a],(e,t)=>e.filter(e=>"bar"===e.type).find(e=>e.id===t)),gI=Om([mI],e=>null==e?void 0:e.maxBarSize),fI=(e,t,n)=>{var r=null!=n?n:e;if(!xh(r))return ph(r,t,0)},xI=Om([Gy,TC,(e,t)=>t,(e,t,n)=>n,(e,t,n,r)=>r],(e,t,n,r,a)=>t.filter(t=>"horizontal"===e?t.xAxisId===n:t.yAxisId===r).filter(e=>e.isPanorama===a).filter(e=>!1===e.hide).filter(e=>"bar"===e.type)),yI=Om([xI,e=>e.rootProps.barSize,(e,t,n)=>"horizontal"===Gy(e)?tk(e,"xAxis",t):tk(e,"yAxis",n)],(e,t,n)=>{var r=e.filter(hC),a=e.filter(e=>null==e.stackId),i=r.reduce((e,t)=>(e[t.stackId]||(e[t.stackId]=[]),e[t.stackId].push(t),e),{});return[...Object.entries(i).map(e=>{var[r,a]=e;return{stackId:r,dataKeys:a.map(e=>e.dataKey),barSize:fI(t,n,a[0].barSize)}}),...a.map(e=>({stackId:void 0,dataKeys:[e.dataKey].filter(e=>null!=e),barSize:fI(t,n,e.barSize)}))]}),vI=(e,t,n,r)=>{var a,i;return"horizontal"===Gy(e)?(a=ck(e,"xAxis",t,r),i=lk(e,"xAxis",t,r)):(a=ck(e,"yAxis",n,r),i=lk(e,"yAxis",n,r)),Gx(a,i)};var bI,wI,NI,SI=Om([yI,MA,e=>e.rootProps.barGap,kA,(e,t,n,r,a)=>{var i,s,o=mI(e,t,n,r,a);if(null!=o){var l,c,d=Gy(e),u=MA(e),{maxBarSize:h}=o,p=xh(h)?u:h;return"horizontal"===d?(l=ck(e,"xAxis",t,r),c=lk(e,"xAxis",t,r)):(l=ck(e,"yAxis",n,r),c=lk(e,"yAxis",n,r)),null!==(i=null!==(s=Gx(l,c,!0))&&void 0!==s?s:p)&&void 0!==i?i:0}},vI,gI],(e,t,n,r,a,i,s)=>{var o=xh(s)?t:s,l=function(e,t,n,r,a){var i=r.length;if(!(i<1)){var s,o=ph(e,n,0,!0),l=[];if(Cy(r[0].barSize)){var c=!1,d=n/i,u=r.reduce((e,t)=>e+(t.barSize||0),0);(u+=(i-1)*o)>=n&&(u-=(i-1)*o,o=0),u>=n&&d>0&&(c=!0,u=i*(d*=.9));var h={offset:((n-u)/2|0)-o,size:0};s=r.reduce((e,t)=>{var n,r=[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:h.offset+h.size+o,size:c?d:null!==(n=t.barSize)&&void 0!==n?n:0}}];return h=r[r.length-1].position,r},l)}else{var p=ph(t,n,0,!0);n-2*p-(i-1)*o<=0&&(o=0);var m=(n-2*p-(i-1)*o)/i;m>1&&(m>>=0);var g=Cy(a)?Math.min(m,a):m;s=r.reduce((e,t,n)=>[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:p+(m+o)*n+(m-g)/2,size:g}}],l)}return s}}(n,r,a!==i?a:i,e,o);return a!==i&&null!=l&&(l=l.map(e=>hI(hI({},e),{},{position:hI(hI({},e.position),{},{offset:e.position.offset-a/2})}))),l}),jI=Om([SI,mI],(e,t)=>{if(null!=e&&null!=t){var n=e.find(e=>e.stackId===t.stackId&&null!=t.dataKey&&e.dataKeys.includes(t.dataKey));if(null!=n)return n.position}}),_I=Om([(e,t,n,r)=>"horizontal"===Gy(e)?qC(e,"yAxis",n,r):qC(e,"xAxis",t,r),mI],(e,t)=>{var n=sC(t);if(e&&null!=n&&null!=t){var{stackId:r}=t;if(null!=r){var a=e[r];if(a){var{stackedData:i}=a;if(i)return i.find(e=>e.key===n)}}}}),AI=Om([sy,ly,(e,t,n,r)=>ck(e,"xAxis",t,r),(e,t,n,r)=>ck(e,"yAxis",n,r),(e,t,n,r)=>lk(e,"xAxis",t,r),(e,t,n,r)=>lk(e,"yAxis",n,r),jI,Gy,E_,vI,_I,mI,(e,t,n,r,a,i)=>i],(e,t,n,r,a,i,s,o,l,c,d,u,h)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:g}=l;if(null!=u&&null!=s&&null!=t&&("horizontal"===o||"vertical"===o)&&null!=n&&null!=r&&null!=a&&null!=i&&null!=c){var f,{data:x}=u;if(null!=(f=null!=x&&x.length>0?x:null==p?void 0:p.slice(m,g+1)))return lI({layout:o,barSettings:u,pos:s,parentViewBox:t,bandSize:c,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:f,offset:e,cells:h})}}),CI=e=>{var{chartData:t}=e,n=jm(),r=dy();return f.useEffect(()=>r?()=>{}:(n(yT(t)),()=>{n(yT(void 0))}),[t,n,r]),null},MI={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},kI=Tf({name:"brush",initialState:MI,reducers:{setBrushSettings:(e,t)=>null==t.payload?MI:t.payload}}),{setBrushSettings:EI}=kI.actions,TI=kI.reducer;class PI{static create(e){return new PI(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:t,position:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==e){if(n)switch(n){case"start":default:return this.scale(e);case"middle":var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r;case"end":var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}if(t){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}return this.scale(e)}}isInRange(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}bI=PI,NI=1e-4,(wI=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(wI="EPS"))in bI?Object.defineProperty(bI,wI,{value:NI,enumerable:!0,configurable:!0,writable:!0}):bI[wI]=NI;var DI=Tf({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=of(e).dots.findIndex(e=>e===t.payload);-1!==n&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=of(e).areas.findIndex(e=>e===t.payload);-1!==n&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=of(e).lines.findIndex(e=>e===t.payload);-1!==n&&e.lines.splice(n,1)}}}),{addDot:RI,removeDot:II,addArea:OI,removeArea:BI,addLine:LI,removeLine:FI}=DI.actions,UI=DI.reducer,zI=f.createContext(void 0),HI=e=>{var{children:t}=e,[n]=f.useState("".concat(hh("recharts"),"-clip")),r=fR();if(null==r)return null;var{x:a,y:i,width:s,height:o}=r;return f.createElement(zI.Provider,{value:n},f.createElement("defs",null,f.createElement("clipPath",{id:n},f.createElement("rect",{x:a,y:i,height:o,width:s}))),t)};function GI(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function VI(e,t,n){if(t<1)return[];if(1===t&&void 0===n)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function $I(e,t,n){return function(e){var{width:t,height:n}=e,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),a=r*Math.PI/180,i=Math.atan(n/t),s=a>i&&a<Math.PI-i?n/Math.sin(a):t/Math.cos(a);return Math.abs(s)}({width:e.width+t.width,height:e.height+t.height},n)}function WI(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var i=n();return e*(t-e*i/2-r)>=0&&e*(t+e*i/2-a)<=0}function YI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function XI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YI(Object(n),!0).forEach(function(t){KI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function KI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qI(e,t,n){var r,{tick:a,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:h}=e;if(!i||!i.length||!a)return[];if(ch(c)||jv)return null!==(r=function(e,t){return VI(e,t+1)}(i,ch(c)?c:0))&&void 0!==r?r:[];var p=[],m="top"===l||"bottom"===l?"width":"height",g=u&&"width"===m?WT(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},f=(e,r)=>{var a="function"==typeof d?d(e.value,r):e.value;return"width"===m?$I(WT(a,{fontSize:t,letterSpacing:n}),g,h):WT(a,{fontSize:t,letterSpacing:n})[m]},x=i.length>=2?sh(i[1].coordinate-i[0].coordinate):1,y=function(e,t,n){var r="width"===n,{x:a,y:i,width:s,height:o}=e;return 1===t?{start:r?a:i,end:r?a+s:i+o}:{start:r?a+s:i+o,end:r?a:i}}(s,x,m);return"equidistantPreserveStart"===c?function(e,t,n,r,a){for(var i,s=(r||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,h=function(){var t=null==r?void 0:r[c];if(void 0===t)return{v:VI(r,d)};var i,s=c,h=()=>(void 0===i&&(i=n(t,s)),i),p=t.coordinate,m=0===c||WI(e,p,h,u,l);m||(c=0,u=o,d+=1),m&&(u=p+e*(h()/2+a),c+=d)};d<=s.length;)if(i=h())return i.v;return[]}(x,y,f,i,o):(p="preserveStart"===c||"preserveStartEnd"===c?function(e,t,n,r,a,i){var s=(r||[]).slice(),o=s.length,{start:l,end:c}=t;if(i){var d=r[o-1],u=n(d,o-1),h=e*(d.coordinate+e*u/2-c);s[o-1]=d=XI(XI({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),WI(e,d.tickCoord,()=>u,l,c)&&(c=d.tickCoord-e*(u/2+a),s[o-1]=XI(XI({},d),{},{isShow:!0}))}for(var p=i?o-1:o,m=function(t){var r,i=s[t],o=()=>(void 0===r&&(r=n(i,t)),r);if(0===t){var d=e*(i.coordinate-e*o()/2-l);s[t]=i=XI(XI({},i),{},{tickCoord:d<0?i.coordinate-d*e:i.coordinate})}else s[t]=i=XI(XI({},i),{},{tickCoord:i.coordinate});WI(e,i.tickCoord,o,l,c)&&(l=i.tickCoord+e*(o()/2+a),s[t]=XI(XI({},i),{},{isShow:!0}))},g=0;g<p;g++)m(g);return s}(x,y,f,i,o,"preserveStartEnd"===c):function(e,t,n,r,a){for(var i=(r||[]).slice(),s=i.length,{start:o}=t,{end:l}=t,c=function(t){var r,c=i[t],d=()=>(void 0===r&&(r=n(c,t)),r);if(t===s-1){var u=e*(c.coordinate+e*d()/2-l);i[t]=c=XI(XI({},c),{},{tickCoord:u>0?c.coordinate-u*e:c.coordinate})}else i[t]=c=XI(XI({},c),{},{tickCoord:c.coordinate});WI(e,c.tickCoord,d,o,l)&&(l=c.tickCoord-e*(d()/2+a),i[t]=XI(XI({},c),{},{isShow:!0}))},d=s-1;d>=0;d--)c(d);return i}(x,y,f,i,o),p.filter(e=>e.isShow))}var JI=["axisLine","width","height","className","hide","ticks"],QI=["viewBox"],ZI=["viewBox"];function eO(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function tO(){return tO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tO.apply(null,arguments)}function nO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nO(Object(n),!0).forEach(function(t){aO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function aO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iO={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function sO(e){var{x:t,y:n,width:r,height:a,orientation:i,mirror:s,axisLine:o,otherSvgProps:l}=e;if(!o)return null;var c=rO(rO(rO({},l),jd(o)),{},{fill:"none"});if("top"===i||"bottom"===i){var d=+("top"===i&&!s||"bottom"===i&&s);c=rO(rO({},c),{},{x1:t,y1:n+d*a,x2:t+r,y2:n+d*a})}else{var u=+("left"===i&&!s||"right"===i&&s);c=rO(rO({},c),{},{x1:t+u*r,y1:n,x2:t+u*r,y2:n+a})}return f.createElement("line",tO({},c,{className:yd("recharts-cartesian-axis-line",ih(o,"className"))}))}function oO(e){var t,{option:n,tickProps:r,value:a}=e,i=yd(r.className,"recharts-cartesian-axis-tick-value");if(f.isValidElement(n))t=f.cloneElement(n,rO(rO({},r),{},{className:i}));else if("function"==typeof n)t=n(rO(rO({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";"boolean"!=typeof n&&(s=yd(s,null==n?void 0:n.className)),t=f.createElement(mP,tO({},r,{className:s}),a)}return t}function lO(e){var{ticks:t=[],tick:n,tickLine:r,stroke:a,tickFormatter:i,unit:s,padding:o,tickTextProps:l,orientation:c,mirror:d,x:u,y:h,width:p,height:m,tickSize:g,tickMargin:x,fontSize:y,letterSpacing:v,getTicksConfig:b,events:w}=e,N=qI(rO(rO({},b),{},{ticks:t}),y,v),S=function(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}(c,d),j=function(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}(c,d),_=jd(b),A=_d(n),C={};"object"==typeof r&&(C=r);var M=rO(rO({},_),{},{fill:"none"},C),k=N.map((e,t)=>{var{line:y,tick:v}=function(e,t,n,r,a,i,s,o,l){var c,d,u,h,p,m,g=o?-1:1,f=e.tickSize||s,x=ch(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":c=d=e.coordinate,m=(u=(h=n+ +!o*a)-g*f)-g*l,p=x;break;case"left":u=h=e.coordinate,p=(c=(d=t+ +!o*r)-g*f)-g*l,m=x;break;case"right":u=h=e.coordinate,p=(c=(d=t+ +o*r)+g*f)+g*l,m=x;break;default:c=d=e.coordinate,m=(u=(h=n+ +o*a)+g*f)+g*l,p=x}return{line:{x1:c,y1:u,x2:d,y2:h},tick:{x:p,y:m}}}(e,u,h,p,m,c,g,d,x),b=rO(rO(rO(rO({textAnchor:S,verticalAnchor:j},_),{},{stroke:"none",fill:a},A),v),{},{index:t,payload:e,visibleTicksCount:N.length,tickFormatter:i,padding:o},l);return f.createElement(Pd,tO({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},Mh(w,e,t)),r&&f.createElement("line",tO({},M,y,{className:yd("recharts-cartesian-axis-tick-line",ih(r,"className"))})),n&&f.createElement(oO,{option:n,tickProps:b,value:"".concat("function"==typeof i?i(e.value,t):e.value).concat(s||"")}))});return k.length>0?f.createElement("g",{className:"recharts-cartesian-axis-ticks"},k):null}var cO=f.forwardRef((e,t)=>{var{axisLine:n,width:r,height:a,className:i,hide:s,ticks:o}=e,l=eO(e,JI),[c,d]=f.useState(""),[u,h]=f.useState(""),p=f.useRef(null);f.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var t;return(e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(e=>{if(e){var t=e.getBoundingClientRect();t.width>s&&(s=t.width)}});var o=n?n.getBoundingClientRect().width:0,l=s+(a+i)+o+(n?r:0);return Math.round(l)}return 0})({ticks:p.current,label:null===(t=e.labelRef)||void 0===t?void 0:t.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var m=f.useCallback(e=>{if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=t;var n=t[0];if(n){var r=window.getComputedStyle(n),a=r.fontSize,i=r.letterSpacing;a===c&&i===u||(d(a),h(i))}}},[c,u]);return s||null!=r&&r<=0||null!=a&&a<=0?null:f.createElement(Pd,{className:yd("recharts-cartesian-axis",i),ref:m},f.createElement(sO,{x:e.x,y:e.y,width:r,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:jd(e)}),f.createElement(lO,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:c,letterSpacing:u,getTicksConfig:e,events:l}),f.createElement(wP,{x:e.x,y:e.y,width:e.width,height:e.height},f.createElement(kP,{label:e.label,labelRef:e.labelRef}),e.children))}),dO=f.memo(cO,(e,t)=>{var{viewBox:n}=e,r=eO(e,QI),{viewBox:a}=t,i=eO(t,ZI);return GI(n,a)&&GI(r,i)}),uO=f.forwardRef((e,t)=>{var n=Vv(e,iO);return f.createElement(dO,tO({},n,{ref:t}))});uO.displayName="CartesianAxis";var hO=["x1","y1","x2","y2","key"],pO=["offset"],mO=["xAxisId","yAxisId"],gO=["xAxisId","yAxisId"];function fO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fO(Object(n),!0).forEach(function(t){yO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function yO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vO(){return vO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vO.apply(null,arguments)}function bO(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var wO=e=>{var{fill:t}=e;if(!t||"none"===t)return null;var{fillOpacity:n,x:r,y:a,width:i,height:s,ry:o}=e;return f.createElement("rect",{x:r,y:a,ry:o,width:i,height:s,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function NO(e,t){var n;if(f.isValidElement(e))n=f.cloneElement(e,t);else if("function"==typeof e)n=e(t);else{var{x1:r,y1:a,x2:i,y2:s,key:o}=t,l=jd(bO(t,hO)),{offset:c}=l,d=bO(l,pO);n=f.createElement("line",vO({},d,{x1:r,y1:a,x2:i,y2:s,fill:"none",key:o}))}return n}function SO(e){var{x:t,width:n,horizontal:r=!0,horizontalPoints:a}=e;if(!r||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,o=bO(e,mO),l=a.map((e,a)=>{var i=xO(xO({},o),{},{x1:t,y1:e,x2:t+n,y2:e,key:"line-".concat(a),index:a});return NO(r,i)});return f.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function jO(e){var{y:t,height:n,vertical:r=!0,verticalPoints:a}=e;if(!r||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,o=bO(e,gO),l=a.map((e,a)=>{var i=xO(xO({},o),{},{x1:e,y1:t,x2:e,y2:t+n,key:"line-".concat(a),index:a});return NO(r,i)});return f.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function _O(e){var{horizontalFill:t,fillOpacity:n,x:r,y:a,width:i,height:s,horizontalPoints:o,horizontal:l=!0}=e;if(!l||!t||!t.length)return null;var c=o.map(e=>Math.round(e+a-a)).sort((e,t)=>e-t);a!==c[0]&&c.unshift(0);var d=c.map((e,o)=>{var l=!c[o+1]?a+s-e:c[o+1]-e;if(l<=0)return null;var d=o%t.length;return f.createElement("rect",{key:"react-".concat(o),y:e,x:r,height:l,width:i,stroke:"none",fill:t[d],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function AO(e){var{vertical:t=!0,verticalFill:n,fillOpacity:r,x:a,y:i,width:s,height:o,verticalPoints:l}=e;if(!t||!n||!n.length)return null;var c=l.map(e=>Math.round(e+a-a)).sort((e,t)=>e-t);a!==c[0]&&c.unshift(0);var d=c.map((e,t)=>{var l=!c[t+1]?a+s-e:c[t+1]-e;if(l<=0)return null;var d=t%n.length;return f.createElement("rect",{key:"react-".concat(t),x:e,y:i,width:l,height:o,stroke:"none",fill:n[d],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var CO=(e,t)=>{var{xAxis:n,width:r,height:a,offset:i}=e;return Dx(qI(xO(xO(xO({},iO),n),{},{ticks:Rx(n),viewBox:{x:0,y:0,width:r,height:a}})),i.left,i.left+i.width,t)},MO=(e,t)=>{var{yAxis:n,width:r,height:a,offset:i}=e;return Dx(qI(xO(xO(xO({},iO),n),{},{ticks:Rx(n),viewBox:{x:0,y:0,width:r,height:a}})),i.top,i.top+i.height,t)},kO={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function EO(e){var t=zy(),n=Hy(),r=Uy(),a=xO(xO({},Vv(e,kO)),{},{x:ch(e.x)?e.x:r.left,y:ch(e.y)?e.y:r.top,width:ch(e.width)?e.width:r.width,height:ch(e.height)?e.height:r.height}),{xAxisId:i,yAxisId:s,x:o,y:l,width:c,height:d,syncWithTicks:u,horizontalValues:h,verticalValues:p}=a,m=dy(),g=Mm(e=>sk(e,"xAxis",i,m)),x=Mm(e=>sk(e,"yAxis",s,m));if(!ch(c)||c<=0||!ch(d)||d<=0||!ch(o)||o!==+o||!ch(l)||l!==+l)return null;var y=a.verticalCoordinatesGenerator||CO,v=a.horizontalCoordinatesGenerator||MO,{horizontalPoints:b,verticalPoints:w}=a;if(!(b&&b.length||"function"!=typeof v)){var N=h&&h.length,S=v({yAxis:x?xO(xO({},x),{},{ticks:N?h:x.ticks}):void 0,width:t,height:n,offset:r},!!N||u);by(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(b=S)}if(!(w&&w.length||"function"!=typeof y)){var j=p&&p.length,_=y({xAxis:g?xO(xO({},g),{},{ticks:j?p:g.ticks}):void 0,width:t,height:n,offset:r},!!j||u);by(Array.isArray(_),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(w=_)}return f.createElement("g",{className:"recharts-cartesian-grid"},f.createElement(wO,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),f.createElement(_O,vO({},a,{horizontalPoints:b})),f.createElement(AO,vO({},a,{verticalPoints:w})),f.createElement(SO,vO({},a,{offset:r,horizontalPoints:b,xAxis:g,yAxis:x})),f.createElement(jO,vO({},a,{offset:r,verticalPoints:w,xAxis:g,yAxis:x})))}EO.displayName="CartesianGrid";var TO=(e,t,n,r)=>ck(e,"xAxis",t,r),PO=(e,t,n,r)=>lk(e,"xAxis",t,r),DO=(e,t,n,r)=>ck(e,"yAxis",n,r),RO=(e,t,n,r)=>lk(e,"yAxis",n,r),IO=Om([Gy,TO,DO,PO,RO],(e,t,n,r,a)=>Px(e,"xAxis")?Gx(t,r,!1):Gx(n,a,!1));function OO(e){return"line"===e.type}var BO=Om([TC,(e,t,n,r,a)=>a],(e,t)=>e.filter(OO).find(e=>e.id===t)),LO=Om([Gy,TO,DO,PO,RO,BO,IO,E_],(e,t,n,r,a,i,s,o)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:d}=o;if(null!=i&&null!=t&&null!=n&&null!=r&&null!=a&&0!==r.length&&0!==a.length&&null!=s){var u,{dataKey:h,data:p}=i;if(null!=(u=null!=p&&p.length>0?p:null==l?void 0:l.slice(c,d+1)))return function(e){var{layout:t,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:o,displayedData:l}=e;return l.map((e,l)=>{var c=Tx(e,s);if("horizontal"===t)return{x:Lx({axis:n,ticks:a,bandSize:o,entry:e,index:l}),y:xh(c)?null:r.scale(c),value:c,payload:e};var d=xh(c)?null:n.scale(c),u=Lx({axis:r,ticks:i,bandSize:o,entry:e,index:l});return null==d||null==u?null:{x:d,y:u,value:c,payload:e}}).filter(Boolean)}({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:a,dataKey:h,bandSize:s,displayedData:u})}});var FO=["id"],UO=["type","layout","connectNulls","needClip"],zO=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function HO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function GO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HO(Object(n),!0).forEach(function(t){VO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function VO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $O(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function WO(){return WO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WO.apply(null,arguments)}var YO=e=>{var{dataKey:t,name:n,stroke:r,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:r,value:$x(n,t),payload:e}]};function XO(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,fill:i,name:s,hide:o,unit:l}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:$x(s,t),hide:o,type:e.tooltipType,color:e.stroke,unit:l}}}var KO=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function qO(e,t){for(var n=e.length%2!=0?[...e,0]:e,r=[],a=0;a<t;++a)r=[...r,...n];return r}function JO(e){var{clipPathId:t,points:n,props:r}=e,{dot:a,dataKey:i,needClip:s}=r;if(!function(e,t){return null!=e&&(!!t||1===e.length)}(n,a))return null;var o,{id:l}=r,c=$O(r,FO),d=bD(a),u=jd(c),h=null==(o=a)?null:f.isValidElement(o)?Ad(o.props):"object"!=typeof o||Array.isArray(o)?null:Ad(o),p=n.map((e,t)=>{var r=GO(GO(GO({key:"dot-".concat(t),r:3},u),h),{},{index:t,cx:e.x,cy:e.y,dataKey:i,value:e.value,payload:e.payload,points:n});return function(e,t){var n;if(f.isValidElement(e))n=f.cloneElement(e,t);else if("function"==typeof e)n=e(t);else{var r=yd("recharts-line-dot","boolean"!=typeof e?e.className:"");n=f.createElement(tD,WO({},t,{className:r}))}return n}(a,r)}),m={clipPath:s?"url(#clipPath-".concat(d?"":"dots-").concat(t,")"):void 0};return f.createElement(Pd,WO({className:"recharts-line-dots",key:"dots"},m),p)}function QO(e){var{showLabels:t,children:n,points:r}=e,a=f.useMemo(()=>null==r?void 0:r.map(e=>{var t={x:e.x,y:e.y,width:0,height:0};return GO(GO({},t),{},{value:e.value,payload:e.payload,viewBox:t,parentViewBox:void 0,fill:void 0})}),[r]);return f.createElement(XP,{value:t?a:null},n)}function ZO(e){var{clipPathId:t,pathRef:n,points:r,strokeDasharray:a,props:i}=e,{type:s,layout:o,connectNulls:l,needClip:c}=i,d=GO(GO({},Ad($O(i,UO))),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(t,")"):void 0,points:r,type:s,layout:o,connectNulls:l,strokeDasharray:null!=a?a:i.strokeDasharray});return f.createElement(f.Fragment,null,(null==r?void 0:r.length)>1&&f.createElement(Iv,WO({},d,{pathRef:n})),f.createElement(JO,{points:r,clipPathId:t,props:i}))}function eB(e){var{clipPathId:t,props:n,pathRef:r,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:o,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,animateNewValues:h,width:p,height:m,onAnimationEnd:g,onAnimationStart:x}=n,y=a.current,v=vb(n,"recharts-line-"),[b,w]=f.useState(!1),N=!b,S=f.useCallback(()=>{"function"==typeof g&&g(),w(!1)},[g]),j=f.useCallback(()=>{"function"==typeof x&&x(),w(!0)},[x]),_=function(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}(r.current),A=i.current;return f.createElement(QO,{points:s,showLabels:N},n.children,f.createElement(yb,{animationId:v,begin:c,duration:d,isActive:l,easing:u,onAnimationEnd:S,onAnimationStart:j,key:v},e=>{var c,d=gh(A,_+A,e),u=Math.min(d,_);if(l)if(o){var g="".concat(o).split(/[,\s]+/gim).map(e=>parseFloat(e));c=((e,t,n)=>{var r=n.reduce((e,t)=>e+t);if(!r)return KO(t,e);for(var a=Math.floor(e/r),i=e%r,s=t-e,o=[],l=0,c=0;l<n.length;c+=n[l],++l)if(c+n[l]>i){o=[...n.slice(0,l),i-c];break}var d=o.length%2==0?[0,s]:[s];return[...qO(n,a),...o,...d].map(e=>"".concat(e,"px")).join(", ")})(u,_,g)}else c=KO(_,u);else c=null==o?void 0:String(o);if(y){var x=y.length/s.length,v=1===e?s:s.map((t,n)=>{var r=Math.floor(n*x);if(y[r]){var a=y[r];return GO(GO({},t),{},{x:gh(a.x,t.x,e),y:gh(a.y,t.y,e)})}return GO(GO({},t),{},h?{x:gh(2*p,t.x,e),y:gh(m/2,t.y,e)}:{x:t.x,y:t.y})});return a.current=v,f.createElement(ZO,{props:n,points:v,clipPathId:t,pathRef:r,strokeDasharray:c})}return e>0&&_>0&&(a.current=s,i.current=u),f.createElement(ZO,{props:n,points:s,clipPathId:t,pathRef:r,strokeDasharray:c})}),f.createElement(JP,{label:n.label}))}function tB(e){var{clipPathId:t,props:n}=e,r=f.useRef(null),a=f.useRef(0),i=f.useRef(null);return f.createElement(eB,{props:n,clipPathId:t,previousPointsRef:r,longestAnimatedLengthRef:a,pathRef:i})}var nB=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Tx(e.payload,t)});class rB extends f.Component{render(){var{hide:e,dot:t,points:n,className:r,xAxisId:a,yAxisId:i,top:s,left:o,width:l,height:c,id:d,needClip:u}=this.props;if(e)return null;var h=yd("recharts-line",r),p=d,{r:m,strokeWidth:g}=function(e){var t=_d(e);if(null!=t){var{r:n,strokeWidth:r}=t,a=Number(n),i=Number(r);return(Number.isNaN(a)||a<0)&&(a=3),(Number.isNaN(i)||i<0)&&(i=2),{r:a,strokeWidth:i}}return{r:3,strokeWidth:2}}(t),x=bD(t),y=2*m+g;return f.createElement(f.Fragment,null,f.createElement(Pd,{className:h},u&&f.createElement("defs",null,f.createElement(FR,{clipPathId:p,xAxisId:a,yAxisId:i}),!x&&f.createElement("clipPath",{id:"clipPath-dots-".concat(p)},f.createElement("rect",{x:o-y/2,y:s-y/2,width:l+y,height:c+y}))),f.createElement(BR,{xAxisId:a,yAxisId:i,data:n,dataPointFormatter:nB,errorBarOffset:0},f.createElement(tB,{props:this.props,clipPathId:p}))),f.createElement(bR,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var aB={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!jv,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function iB(e){var t=Vv(e,aB),{activeDot:n,animateNewValues:r,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:o,dot:l,hide:c,isAnimationActive:d,label:u,legendType:h,xAxisId:p,yAxisId:m,id:g}=t,x=$O(t,zO),{needClip:y}=LR(p,m),v=fR(),b=Vy(),w=dy(),N=Mm(e=>LO(e,p,m,w,g));if("horizontal"!==b&&"vertical"!==b||null==N||null==v)return null;var{height:S,width:j,x:_,y:A}=v;return f.createElement(rB,WO({},x,{id:g,connectNulls:o,dot:l,activeDot:n,animateNewValues:r,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:d,hide:c,label:u,legendType:h,xAxisId:p,yAxisId:m,points:N,layout:b,height:S,width:j,left:_,top:A,needClip:y}))}function sB(e){var t=Vv(e,aB),n=dy();return f.createElement(YD,{id:t.id,type:"line"},e=>f.createElement(f.Fragment,null,f.createElement(VD,{legendPayload:YO(t)}),f.createElement(zD,{fn:XO,args:t}),f.createElement(tR,{type:"line",id:e,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),f.createElement(iB,WO({},t,{id:e}))))}var oB=f.memo(sB);oB.displayName="Line";var lB=["dangerouslySetInnerHTML","ticks"],cB=["id"],dB=["domain"],uB=["domain"];function hB(){return hB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hB.apply(null,arguments)}function pB(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function mB(e){var t=jm();return f.useLayoutEffect(()=>(t(sR(e)),()=>{t(oR(e))}),[e,t]),null}var gB=e=>{var{xAxisId:t,className:n}=e,r=Mm(ly),a=dy(),i="xAxis",s=Mm(e=>HM(e,i,t,a)),o=Mm(e=>ok(e,i,t,a)),l=Mm(e=>KM(e,t)),c=Mm(e=>QM(e,t)),d=Mm(e=>bC(e,t));if(null==l||null==c||null==d)return null;var{dangerouslySetInnerHTML:u,ticks:h}=e,p=pB(e,lB),{id:m}=d,g=pB(d,cB);return f.createElement(uO,hB({},p,g,{scale:s,x:c.x,y:c.y,width:l.width,height:l.height,className:yd("recharts-".concat(i," ").concat(i),n),viewBox:r,ticks:o}))},fB={allowDataOverflow:vC.allowDataOverflow,allowDecimals:vC.allowDecimals,allowDuplicatedCategory:vC.allowDuplicatedCategory,height:vC.height,hide:!1,mirror:vC.mirror,orientation:vC.orientation,padding:vC.padding,reversed:vC.reversed,scale:vC.scale,tickCount:vC.tickCount,type:vC.type,xAxisId:0},xB=e=>{var t,n,r,a,i,s=Vv(e,fB);return f.createElement(f.Fragment,null,f.createElement(mB,{interval:null!==(t=s.interval)&&void 0!==t?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:null!==(n=s.includeHidden)&&void 0!==n&&n,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:null!==(r=s.angle)&&void 0!==r?r:0,minTickGap:null!==(a=s.minTickGap)&&void 0!==a?a:5,tick:null===(i=s.tick)||void 0===i||i,tickFormatter:s.tickFormatter}),f.createElement(gB,s))},yB=(e,t)=>{var{domain:n}=e,r=pB(e,dB),{domain:a}=t;return!!GI(r,pB(t,uB))&&(Array.isArray(n)&&2===n.length&&Array.isArray(a)&&2===a.length?n[0]===a[0]&&n[1]===a[1]:GI({domain:n},{domain:a}))},vB=f.memo(xB,yB);vB.displayName="XAxis";var bB=["dangerouslySetInnerHTML","ticks"],wB=["id"],NB=["domain"],SB=["domain"];function jB(){return jB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jB.apply(null,arguments)}function _B(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function AB(e){var t=jm();return f.useLayoutEffect(()=>(t(lR(e)),()=>{t(cR(e))}),[e,t]),null}var CB=e=>{var{yAxisId:t,className:n,width:r,label:a}=e,i=f.useRef(null),s=f.useRef(null),o=Mm(ly),l=dy(),c=jm(),d="yAxis",u=Mm(e=>HM(e,d,t,l)),h=Mm(e=>ek(e,t)),p=Mm(e=>ZM(e,t)),m=Mm(e=>ok(e,d,t,l)),g=Mm(e=>SC(e,t));if(f.useLayoutEffect(()=>{if("auto"===r&&h&&!jP(a)&&!f.isValidElement(a)&&null!=g){var e=i.current;if(e){var n=e.getCalculatedWidth();Math.round(h.width)!==Math.round(n)&&c(hR({id:t,width:n}))}}},[m,h,c,a,t,r,g]),null==h||null==p||null==g)return null;var{dangerouslySetInnerHTML:x,ticks:y}=e,v=_B(e,bB),{id:b}=g,w=_B(g,wB);return f.createElement(uO,jB({},v,w,{ref:i,labelRef:s,scale:u,x:p.x,y:p.y,tickTextProps:"auto"===r?{width:void 0}:{width:r},width:h.width,height:h.height,className:yd("recharts-".concat(d," ").concat(d),n),viewBox:o,ticks:m}))},MB={allowDataOverflow:NC.allowDataOverflow,allowDecimals:NC.allowDecimals,allowDuplicatedCategory:NC.allowDuplicatedCategory,hide:!1,mirror:NC.mirror,orientation:NC.orientation,padding:NC.padding,reversed:NC.reversed,scale:NC.scale,tickCount:NC.tickCount,type:NC.type,width:NC.width,yAxisId:0},kB=e=>{var t,n,r,a,i,s=Vv(e,MB);return f.createElement(f.Fragment,null,f.createElement(AB,{interval:null!==(t=s.interval)&&void 0!==t?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:null!==(n=s.includeHidden)&&void 0!==n&&n,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:null!==(r=s.angle)&&void 0!==r?r:0,minTickGap:null!==(a=s.minTickGap)&&void 0!==a?a:5,tick:null===(i=s.tick)||void 0===i||i,tickFormatter:s.tickFormatter}),f.createElement(CB,s))},EB=(e,t)=>{var{domain:n}=e,r=_B(e,NB),{domain:a}=t;return!!GI(r,_B(t,SB))&&(Array.isArray(n)&&2===n.length&&Array.isArray(a)&&2===a.length?n[0]===a[0]&&n[1]===a[1]:GI({domain:n},{domain:a}))},TB=f.memo(kB,EB);TB.displayName="YAxis";var PB,DB,RB={exports:{}},IB={};DB||(DB=1,RB.exports=function(){if(PB)return IB;PB=1;var e=p(),t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useSyncExternalStore,r=e.useRef,a=e.useEffect,i=e.useMemo,s=e.useDebugValue;return IB.useSyncExternalStoreWithSelector=function(e,o,l,c,d){var u=r(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=i(function(){function e(e){if(!a){if(a=!0,n=e,e=c(e),void 0!==d&&h.hasValue){var i=h.value;if(d(i,e))return r=i}return r=e}if(i=r,t(n,e))return i;var s=c(e);return void 0!==d&&d(i,s)?(n=e,i):(n=e,r=s)}var n,r,a=!1,i=void 0===l?null:l;return[function(){return e(o())},null===i?void 0:function(){return e(i())}]},[o,l,c,d]);var p=n(e,u[0],u[1]);return a(function(){h.hasValue=!0,h.value=p},[p]),s(p),p},IB}()),RB.exports;var OB={notify(){},get:()=>[]};var BB=(()=>!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement))(),LB=(()=>"undefined"!=typeof navigator&&"ReactNative"===navigator.product)(),FB=(()=>BB||LB?f.useLayoutEffect:f.useEffect)(),UB=Symbol.for("react-redux-context"),zB="undefined"!=typeof globalThis?globalThis:{};function HB(){var e;if(!f.createContext)return{};const t=null!=(e=zB[UB])?e:zB[UB]=new Map;let n=t.get(f.createContext);return n||(n=f.createContext(null),t.set(f.createContext,n)),n}var GB=HB();var VB=function(e){const{children:t,context:n,serverState:r,store:a}=e,i=f.useMemo(()=>{const e=function(e){let t,n=OB,r=0,a=!1;function i(){l.onStateChange&&l.onStateChange()}function s(){r++,t||(t=e.subscribe(i),n=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){(()=>{let t=e;for(;t;)t.callback(),t=t.next})()},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){r&&null!==e&&(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}())}function o(){r--,t&&0===r&&(t(),t=void 0,n.clear(),n=OB)}const l={addNestedSub:function(e){s();const t=n.subscribe(e);let r=!1;return()=>{r||(r=!0,t(),o())}},notifyNestedSubs:function(){n.notify()},handleChangeWrapper:i,isSubscribed:function(){return a},trySubscribe:function(){a||(a=!0,s())},tryUnsubscribe:function(){a&&(a=!1,o())},getListeners:()=>n};return l}(a);return{store:a,subscription:e,getServerState:r?()=>r:void 0}},[a,r]),s=f.useMemo(()=>a.getState(),[a]);FB(()=>{const{subscription:e}=i;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==a.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[i,s]);const o=n||GB;return f.createElement(o.Provider,{value:i},t)},$B=Om([(e,t)=>t,Gy,rC,oC,vE,SE,VE,sy],(e,t,n,r,a,i,s,o)=>{if(e&&t&&r&&a&&i){var l=function(e,t,n,r,a){return"horizontal"===n||"vertical"===n?e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height?{x:e,y:t}:null:r?Ax({x:e,y:t},r):null}(e.chartX,e.chartY,t,n,o);if(l){var c=((e,t)=>"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius)(l,t),d=((e,t,n,r,a)=>{var i,s=-1,o=null!==(i=null==t?void 0:t.length)&&void 0!==i?i:0;if(o<=1||null==e)return 0;if("angleAxis"===r&&null!=a&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c=l>0?n[l-1].coordinate:n[o-1].coordinate,d=n[l].coordinate,u=l>=o-1?n[0].coordinate:n[l+1].coordinate,h=void 0;if(sh(d-c)!==sh(u-d)){var p=[];if(sh(u-d)===sh(a[1]-a[0])){h=u;var m=d+a[1]-a[0];p[0]=Math.min(m,(m+c)/2),p[1]=Math.max(m,(m+c)/2)}else{h=c;var g=u+a[1]-a[0];p[0]=Math.min(d,(g+d)/2),p[1]=Math.max(d,(g+d)/2)}var f=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>f[0]&&e<=f[1]||e>=p[0]&&e<=p[1]){({index:s}=n[l]);break}}else{var x=Math.min(c,u),y=Math.max(c,u);if(e>(x+d)/2&&e<=(y+d)/2){({index:s}=n[l]);break}}}else if(t)for(var v=0;v<o;v++)if(0===v&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v>0&&v<o-1&&e>(t[v].coordinate+t[v-1].coordinate)/2&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v===o-1&&e>(t[v].coordinate+t[v-1].coordinate)/2){({index:s}=t[v]);break}return s})(c,s,i,r,a),u=((e,t,n,r)=>{var a=t.find(e=>e&&e.index===n);if(a){if("horizontal"===e)return{x:a.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:a.coordinate};if("centric"===e){var i=a.coordinate,{radius:s}=r;return kx(kx(kx({},r),Sx(r.cx,r.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:l}=r;return kx(kx(kx({},r),Sx(r.cx,r.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}})(t,i,d,l);return{activeIndex:String(d),activeCoordinate:u}}}}),WB=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},YB=ff("mouseClick"),XB=dx();XB.startListening({actionCreator:YB,effect:(e,t)=>{var n=e.payload,r=$B(t.getState(),WB(n));null!=(null==r?void 0:r.activeIndex)&&t.dispatch(Ck({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var KB=ff("mouseMove"),qB=dx();qB.startListening({actionCreator:KB,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=gk(r,r.tooltip.settings.shared),i=$B(r,WB(n));"axis"===a&&(null!=(null==i?void 0:i.activeIndex)?t.dispatch(Ak({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(jk()))}});var JB={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},QB=Tf({name:"rootProps",initialState:JB,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!==(n=t.payload.barGap)&&void 0!==n?n:JB.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),ZB=QB.reducer,{updateOptions:eL}=QB.actions,tL=Tf({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:nL}=tL.actions,rL=tL.reducer,aL=ff("keyDown"),iL=ff("focus"),sL=dx();sL.startListening({actionCreator:aL,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip,a=e.payload;if("ArrowRight"===a||"ArrowLeft"===a||"Enter"===a){var i=Number(Ik(r,qk(n))),s=SE(n);if("Enter"!==a){var o=i+("ArrowRight"===a?1:-1)*("left-to-right"===uk(n)?1:-1);if(!(null==s||o>=s.length||o<0)){var l=XE(n,"axis","hover",String(o));t.dispatch(kk({active:!0,activeIndex:o.toString(),activeDataKey:void 0,activeCoordinate:l}))}}else{var c=XE(n,"axis","hover",String(r.index));t.dispatch(kk({active:!r.active,activeIndex:r.index,activeDataKey:r.dataKey,activeCoordinate:c}))}}}}}),sL.startListening({actionCreator:iL,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&null==r.index){var a=XE(n,"axis","hover",String("0"));t.dispatch(kk({activeDataKey:void 0,active:!0,activeIndex:"0",activeCoordinate:a}))}}}});var oL=ff("externalEvent"),lL=dx();lL.startListening({actionCreator:oL,effect:(e,t)=>{if(null!=e.payload.handler){var n=t.getState(),r={activeCoordinate:DE(n),activeDataKey:EE(n),activeIndex:ME(n),activeLabel:kE(n),activeTooltipIndex:ME(n),isTooltipActive:RE(n)};e.payload.handler(r,e.payload.reactEvent)}}});var cL=Om([Fk],e=>e.tooltipItemPayloads),dL=Om([cL,Lk,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var a=e.find(e=>e.settings.dataKey===r);if(null!=a){var{positions:i}=a;if(null!=i)return t(i,n)}}),uL=ff("touchMove"),hL=dx();hL.startListening({actionCreator:uL,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=gk(r,r.tooltip.settings.shared);if("axis"===a){var i=$B(r,WB({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));null!=(null==i?void 0:i.activeIndex)&&t.dispatch(Ak({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if("item"===a){var s,o=n.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute("data-recharts-item-index"),d=null!==(s=l.getAttribute("data-recharts-item-data-key"))&&void 0!==s?s:void 0,u=dL(t.getState(),c,d);t.dispatch(Nk({activeDataKey:d,activeIndex:c,activeCoordinate:u}))}}});var pL=fg({brush:TI,cartesianAxis:pR,chartData:wT,errorBars:DR,graphicalItems:eR,layout:xx,legend:Jy,options:mT,polarAxis:oD,polarOptions:rL,referenceElements:UI,rootProps:ZB,tooltip:Ek});function mL(e){var{preloadedState:t,children:n,reduxStoreName:r}=e,a=dy(),i=f.useRef(null);if(a)return n;null==i.current&&(i.current=function(e){return jf({reducer:pL,preloadedState:e,middleware:e=>e({serializableCheck:!1}).concat([XB.middleware,qB.middleware,sL.middleware,lL.middleware,hL.middleware]),enhancers:e=>{var t=e;return"function"==typeof e&&(t=e()),t.concat(Sf({type:"raf"}))},devTools:Sv})}(t));var s=Nm;return f.createElement(VB,{context:s,store:i.current},n)}function gL(e){var{layout:t,margin:n}=e,r=jm(),a=dy();return f.useEffect(()=>{a||(r(mx(t)),r(px(n)))},[r,a,t,n]),null}function fL(e){var t=jm();return f.useEffect(()=>{t(eL(e))},[t,e]),null}var xL=["children"];function yL(){return yL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yL.apply(null,arguments)}var vL={width:"100%",height:"100%",display:"block"},bL=f.forwardRef((e,t)=>{var n=zy(),r=Hy(),a=_v();if(!My(n)||!My(r))return null;var i,s,{children:o,otherAttributes:l,title:c,desc:d}=e;return i="number"==typeof l.tabIndex?l.tabIndex:a?0:void 0,s="string"==typeof l.role?l.role:a?"application":void 0,f.createElement(kd,yL({},l,{title:c,desc:d,role:s,tabIndex:i,width:n,height:r,style:vL,ref:t}),o)}),wL=e=>{var{children:t}=e,n=Mm(hy);if(!n)return null;var{width:r,height:a,y:i,x:s}=n;return f.createElement(kd,{width:r,height:a,x:s,y:i},t)},NL=f.forwardRef((e,t)=>{var{children:n}=e,r=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,xL);return dy()?f.createElement(wL,null,n):f.createElement(bL,yL({ref:t},r),n)});function SL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?SL(Object(n),!0).forEach(function(t){_L(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _L(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AL(){return AL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AL.apply(null,arguments)}var CL=()=>(MT(),null);function ML(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var kL=f.forwardRef((e,t)=>{var n,r,a=f.useRef(null),[i,s]=f.useState({containerWidth:ML(null===(n=e.style)||void 0===n?void 0:n.width),containerHeight:ML(null===(r=e.style)||void 0===r?void 0:r.height)}),o=f.useCallback((e,t)=>{s(n=>{var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]),l=f.useCallback(e=>{if("function"==typeof t&&t(e),null!=e){var{width:n,height:r}=e.getBoundingClientRect();o(n,r);var i=new ResizeObserver(e=>{var{width:t,height:n}=e[0].contentRect;o(t,n)});i.observe(e),a.current=i}},[t,o]);return f.useEffect(()=>()=>{var e=a.current;null!=e&&e.disconnect()},[o]),f.createElement(f.Fragment,null,f.createElement($y,{width:i.containerWidth,height:i.containerHeight}),f.createElement("div",AL({ref:l},e)))}),EL=f.forwardRef((e,t)=>{var{width:n,height:r}=e,[a,i]=f.useState({containerWidth:ML(n),containerHeight:ML(r)}),s=f.useCallback((e,t)=>{i(n=>{var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]),o=f.useCallback(e=>{if("function"==typeof t&&t(e),null!=e){var{width:n,height:r}=e.getBoundingClientRect();s(n,r)}},[t,s]);return f.createElement(f.Fragment,null,f.createElement($y,{width:a.containerWidth,height:a.containerHeight}),f.createElement("div",AL({ref:o},e)))}),TL=f.forwardRef((e,t)=>{var{width:n,height:r}=e;return f.createElement(f.Fragment,null,f.createElement($y,{width:n,height:r}),f.createElement("div",AL({ref:t},e)))}),PL=f.forwardRef((e,t)=>{var{width:n,height:r}=e;return lh(n)||lh(r)?f.createElement(EL,AL({},e,{ref:t})):f.createElement(TL,AL({},e,{ref:t}))});var DL=f.forwardRef((e,t)=>{var{children:n,className:r,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:c,onMouseLeave:d,onMouseMove:u,onMouseUp:h,onTouchEnd:p,onTouchMove:m,onTouchStart:g,style:x,width:y,responsive:v,dispatchTouchEvents:b=!0}=e,w=f.useRef(null),N=jm(),[S,j]=f.useState(null),[_,A]=f.useState(null),C=function(){var e=jm(),[t,n]=f.useState(null),r=Mm(Xx);return f.useEffect(()=>{if(null!=t){var n=t.getBoundingClientRect().width/t.offsetWidth;Cy(n)&&n!==r&&e(fx(n))}},[t,e,r]),n}(),M=Iy(),k=(null==M?void 0:M.width)>0?M.width:y,E=(null==M?void 0:M.height)>0?M.height:a,T=f.useCallback(e=>{C(e),"function"==typeof t&&t(e),j(e),A(e),null!=e&&(w.current=e)},[C,t,j,A]),P=f.useCallback(e=>{N(YB(e)),N(oL({handler:i,reactEvent:e}))},[N,i]),D=f.useCallback(e=>{N(KB(e)),N(oL({handler:c,reactEvent:e}))},[N,c]),R=f.useCallback(e=>{N(jk()),N(oL({handler:d,reactEvent:e}))},[N,d]),I=f.useCallback(e=>{N(KB(e)),N(oL({handler:u,reactEvent:e}))},[N,u]),O=f.useCallback(()=>{N(iL())},[N]),B=f.useCallback(e=>{N(aL(e.key))},[N]),L=f.useCallback(e=>{N(oL({handler:s,reactEvent:e}))},[N,s]),F=f.useCallback(e=>{N(oL({handler:o,reactEvent:e}))},[N,o]),U=f.useCallback(e=>{N(oL({handler:l,reactEvent:e}))},[N,l]),z=f.useCallback(e=>{N(oL({handler:h,reactEvent:e}))},[N,h]),H=f.useCallback(e=>{N(oL({handler:g,reactEvent:e}))},[N,g]),G=f.useCallback(e=>{b&&N(uL(e)),N(oL({handler:m,reactEvent:e}))},[N,b,m]),V=f.useCallback(e=>{N(oL({handler:p,reactEvent:e}))},[N,p]),$=function(e){return!0===e?kL:PL}(v);return f.createElement(sT.Provider,{value:S},f.createElement(Dd.Provider,{value:_},f.createElement($,{width:null!=k?k:null==x?void 0:x.width,height:null!=E?E:null==x?void 0:x.height,className:yd("recharts-wrapper",r),style:jL({position:"relative",cursor:"default",width:k,height:E},x),onClick:P,onContextMenu:L,onDoubleClick:F,onFocus:O,onKeyDown:B,onMouseDown:U,onMouseEnter:D,onMouseLeave:R,onMouseMove:I,onMouseUp:z,onTouchEnd:V,onTouchMove:G,onTouchStart:H,ref:T},f.createElement(CL,null),n)))}),RL=["width","height","responsive","children","className","style","compact","title","desc"];var IL=f.forwardRef((e,t)=>{var{width:n,height:r,responsive:a,children:i,className:s,style:o,compact:l,title:c,desc:d}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,RL),h=jd(u);return l?f.createElement(f.Fragment,null,f.createElement($y,{width:n,height:r}),f.createElement(NL,{otherAttributes:h,title:c,desc:d},i)):f.createElement(DL,{className:s,style:o,width:n,height:r,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},f.createElement(NL,{otherAttributes:h,title:c,desc:d,ref:t},f.createElement(HI,null,i)))});function OL(){return OL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OL.apply(null,arguments)}var BL={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index",responsive:!1},LL=f.forwardRef(function(e,t){var n,r=Vv(e.categoricalChartProps,BL),{chartName:a,defaultTooltipEventType:i,validateTooltipEventTypes:s,tooltipPayloadSearcher:o,categoricalChartProps:l}=e,c={chartName:a,defaultTooltipEventType:i,validateTooltipEventTypes:s,tooltipPayloadSearcher:o,eventEmitter:void 0};return f.createElement(mL,{preloadedState:{options:c},reduxStoreName:null!==(n=l.id)&&void 0!==n?n:a},f.createElement(CI,{chartData:l.data}),f.createElement(gL,{layout:r.layout,margin:r.margin}),f.createElement(fL,{accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className}),f.createElement(IL,OL({},r,{ref:t})))}),FL=["axis"],UL=f.forwardRef((e,t)=>f.createElement(LL,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:FL,tooltipPayloadSearcher:hT,categoricalChartProps:e,ref:t})),zL=["axis","item"],HL=f.forwardRef((e,t)=>f.createElement(LL,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:zL,tooltipPayloadSearcher:hT,categoricalChartProps:e,ref:t}));const GL=zc();function VL(){var e;const{user:t,settings:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),[i,s]=f.useState(!1),[o,l]=f.useState(""),[c,d]=f.useState(""),[u,p]=f.useState("Personal"),[m,g]=f.useState(!1),[x,y]=f.useState([]),[v,b]=f.useState([]),[w,N]=f.useState(!1),S=()=>h(null,null,function*(){try{const e=localStorage.getItem("token"),t=yield pt.get(`${GL}/api/schedule/planned-absences`,{headers:{Authorization:`Bearer ${e}`}});b(t.data.absences||[])}catch(e){console.error("Failed to fetch absences:",e)}});f.useEffect(()=>{"teller"!==(null==t?void 0:t.role)&&"supervisor_teller"!==(null==t?void 0:t.role)||S()},[t]);return"teller"!==(null==t?void 0:t.role)&&"supervisor_teller"!==(null==t?void 0:t.role)?null:Nt.jsxs("div",{className:"rounded-lg shadow p-4 mb-8 "+(a?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(W,{className:"w-5 h-5 text-orange-500"})," Plan Absence"]}),Nt.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-orange-600 text-white hover:bg-orange-700",children:[Nt.jsx(le,{className:"w-4 h-4"})," Plan Absence"]})]}),0===v.length?Nt.jsxs("div",{className:"text-center py-6 text-gray-400",children:[Nt.jsx(M,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),Nt.jsx("p",{children:"No absences planned. You will be available for all scheduled shifts."})]}):Nt.jsx("div",{className:"space-y-3",children:v.map(e=>{var t;return Nt.jsx("div",{className:"p-4 rounded-lg border "+(a?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:Nt.jsxs("div",{className:"flex items-start justify-between",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsxs("p",{className:"font-semibold text-orange-600",children:[new Date(e.startDate).toLocaleDateString(),"  ",new Date(e.endDate).toLocaleDateString()]}),Nt.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Reason: ",Nt.jsx("span",{className:"font-medium",children:e.reason})]}),e.isRecurring&&Nt.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Recurring: ",null==(t=e.daysOfWeek)?void 0:t.join(", ")]})]}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(window.confirm("Cancel this absence plan?"))try{const e=localStorage.getItem("token");yield pt.delete(`${GL}/api/schedule/cancel-absence/${t}`,{headers:{Authorization:`Bearer ${e}`}}),r({type:"success",message:"Absence cancelled"}),S()}catch(e){console.error("Failed to cancel absence:",e),r({type:"error",message:"Failed to cancel absence"})}});var t},className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg",title:"Cancel this absence plan",children:Nt.jsx(R,{className:"w-4 h-4"})})]})},e._id)})}),i&&Nt.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:Nt.jsxs("div",{className:"rounded-2xl shadow-lg p-6 w-full max-w-md "+(a?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[Nt.jsx(W,{className:"w-5 h-5 text-orange-500"}),"Plan Your Absence"]}),Nt.jsx("button",{onClick:()=>s(!1),className:"text-gray-500 hover:text-gray-700",children:Nt.jsx(ce,{className:"w-5 h-5"})})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Start Date"}),Nt.jsx("input",{type:"date",value:o,onChange:e=>l(e.target.value),className:"w-full p-2 border rounded-lg "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"End Date"}),Nt.jsx("input",{type:"date",value:c,onChange:e=>d(e.target.value),className:"w-full p-2 border rounded-lg "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason"}),Nt.jsxs("select",{value:u,onChange:e=>p(e.target.value),className:"w-full p-2 border rounded-lg "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"),children:[Nt.jsx("option",{value:"Personal",children:"Personal"}),Nt.jsx("option",{value:"Sick",children:"Sick Leave"}),Nt.jsx("option",{value:"Vacation",children:"Vacation"}),Nt.jsx("option",{value:"Family",children:"Family Matter"}),Nt.jsx("option",{value:"Other",children:"Other"})]})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("input",{type:"checkbox",id:"recurring",checked:m,onChange:e=>g(e.target.checked),className:"rounded"}),Nt.jsx("label",{htmlFor:"recurring",className:"text-sm font-medium",children:"Recurring (same days every week)"})]}),m&&Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Days"}),Nt.jsx("div",{className:"grid grid-cols-4 gap-2",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(e=>Nt.jsx("button",{onClick:()=>(e=>{x.includes(e)?y(x.filter(t=>t!==e)):y([...x,e])})(e),className:"py-2 px-3 text-xs rounded-lg font-medium transition "+(x.includes(e)?"bg-orange-600 text-white":a?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:e.slice(0,3)},e))})]}),Nt.jsxs("div",{className:"flex gap-3 mt-6",children:[Nt.jsx("button",{onClick:()=>s(!1),className:"flex-1 px-4 py-2 rounded-lg bg-gray-500 text-white hover:opacity-90",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(o&&c)if(m&&0===x.length)r({type:"error",message:"Please select at least one day for recurring absence"});else try{N(!0);const e=localStorage.getItem("token");yield pt.post(`${GL}/api/schedule/plan-absence`,{startDate:o,endDate:c,reason:u,daysOfWeek:x,isRecurring:m},{headers:{Authorization:`Bearer ${e}`}}),r({type:"success",message:"Absence planned successfully!"}),S(),l(""),d(""),p("Personal"),g(!1),y([]),s(!1)}catch(e){console.error("Failed to plan absence:",e),r({type:"error",message:"Failed to plan absence"})}finally{N(!1)}else r({type:"error",message:"Please select start and end dates"})}),disabled:w,className:"flex-1 px-4 py-2 rounded-lg bg-orange-600 text-white hover:bg-orange-700 disabled:opacity-50",children:w?"Planning...":"Plan Absence"})]})]})]})})]})}function $L({value:e}){return"number"==typeof e?`${e.toLocaleString(void 0,{maximumFractionDigits:0})}`:"0"}function WL({overrideRole:e}){var t;const{settings:n,user:r}=f.useContext($c),{showToast:a}=(null==Kc?void 0:Kc())||{},i=(null==n?void 0:n.theme)||{},s="dark"===(null==(t=null==n?void 0:n.theme)?void 0:t.mode),o=e||(null==r?void 0:r.role)||"teller",d=(null==r?void 0:r._id)||(null==r?void 0:r.id)||null,[u,p]=f.useState(!0),[m,g]=f.useState({totalTellers:0,totalSupervisors:0,reportsCount:0,totalCashflow:0,totalPayroll:0}),[x,y]=f.useState([]),[v,b]=f.useState([]),[w,N]=f.useState([]),S=s?i.darkBg||"#071026":i.lightBg||"#f8fafc",j=s?"#0b1220":"#fff",_=s?i.darkFont||"#e5e7eb":i.lightFont||"#111827",A=()=>h(null,null,function*(){var e,t;p(!0);try{const n=zc(),[r,a,i,s]=yield Promise.allSettled([pt.get(`${n}/api/users`),pt.get(`${n}/api/cashflow/summary/daily`).catch(()=>({data:[]})),pt.get(`${n}/api/payroll/all`),pt.get(`${n}/api/teller-reports/all`)]);if("fulfilled"===r.status&&Array.isArray(r.value.data)){const e=r.value.data;g(t=>c(l({},t),{totalTellers:e.filter(e=>"teller"===e.role).length,totalSupervisors:e.filter(e=>"supervisor"===e.role).length}))}if("fulfilled"===a.status&&Array.isArray(a.value.data)){const e=a.value.data;y(e);const t=e.reduce((e,t)=>e+(Number(t.income)||0)-(Number(t.expense)||0),0);g(e=>c(l({},e),{totalCashflow:t}))}else y([]);if("fulfilled"===i.status&&(null==(e=i.value.data)?void 0:e.payrolls)){const e=i.value.data.payrolls;let t=0;if("teller"===o&&d)t=e.filter(e=>{var t;return(null==(t=e.user)?void 0:t._id)===d||e.user===d}).reduce((e,t)=>e+(Number(t.totalSalary)||0),0);else if("supervisor"===o&&d){const n=("fulfilled"===r.status?r.value.data:[]).filter(e=>{var t;return e.supervisorId&&(e.supervisorId===d||(null==(t=e.supervisorId)?void 0:t._id)===d)}).map(e=>e._id||e.id);t=e.filter(e=>{var t;return n.includes((null==(t=e.user)?void 0:t._id)||e.user)}).reduce((e,t)=>e+(Number(t.totalSalary)||0),0)}else t=e.reduce((e,t)=>e+(Number(t.totalSalary)||0),0);const n=new Map;e.forEach(e=>{const t=e.createdAt?new Date(e.createdAt):new Date,r=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`,a=n.get(r)||0;n.set(r,a+(Number(e.totalSalary)||0))});const a=Array.from(n.entries()).sort((e,t)=>e[0]<t[0]?-1:1).map(([e,t])=>({month:e,totalSalary:t}));b(a),g(e=>c(l({},e),{totalPayroll:t}))}else b([]);if("fulfilled"===s.status&&Array.isArray(null==(t=s.value.data)?void 0:t.reports)){const e=s.value.data.reports;if(g(t=>c(l({},t),{reportsCount:e.length})),"teller"===o&&d){const t=e.filter(e=>{var t;return e.tellerId===d||(null==(t=e.tellerId)?void 0:t._id)===d});N(t)}else if("supervisor"===o&&d){const t=e.filter(e=>{var t;return e.supervisorId===d||(null==(t=e.supervisorId)?void 0:t._id)===d});N(t)}else N([])}}catch(n){console.error("Dashboard: fetchAll error",n),a&&a({type:"error",message:"Failed to load dashboard data"})}finally{p(!1)}});f.useEffect(()=>{A();const e=()=>{a&&a({type:"info",message:"Dashboard updated"}),A()},t=Vc();return t&&(t.on("reportUpdated",e),t.on("cashflowUpdated",e),t.on("payrollUpdated",e),t.on("userUpdated",e)),()=>{t&&(t.off("reportUpdated",e),t.off("cashflowUpdated",e),t.off("payrollUpdated",e),t.off("userUpdated",e))}},[d]);const C=f.useMemo(()=>"admin"===o?[{title:"Tellers",value:m.totalTellers,subtitle:"Active Tellers"},{title:"Supervisors",value:m.totalSupervisors,subtitle:"Active Supervisors"},{title:"Reports",value:m.reportsCount,subtitle:"Today / This Month"},{title:"Cashflow",value:$L({value:m.totalCashflow}),subtitle:"Net cashflow"},{title:"Payroll",value:$L({value:m.totalPayroll}),subtitle:"Total payroll cost"}]:"supervisor"===o?[{title:"My Tellers",value:w.length,subtitle:"Team size"},{title:"Verified Reports",value:m.reportsCount,subtitle:"Verified / Pending"},{title:"Team Over",value:$L({value:w.reduce((e,t)=>e+(t.over||0),0)}),subtitle:"Sum of over"},{title:"Team Short",value:$L({value:w.reduce((e,t)=>e+(t.short||0),0)}),subtitle:"Sum of short"},{title:"Team Payroll",value:$L({value:m.totalPayroll}),subtitle:"Estimated payroll"}]:[{title:"My Reports",value:m.reportsCount,subtitle:"Submitted"},{title:"My Over",value:$L({value:w.reduce((e,t)=>e+(t.over||0),0)}),subtitle:"Total over"},{title:"My Short",value:$L({value:w.reduce((e,t)=>e+(t.short||0),0)}),subtitle:"Total short"},{title:"My Salary",value:$L({value:m.totalPayroll}),subtitle:"Recent payroll"},{title:"Points",value:"",subtitle:"Teller of the Month points"}],[o,m,w]);function M({item:e,index:t}){return Nt.jsx(cd,{children:Nt.jsx(dd,{children:Nt.jsxs("div",{className:"p-4 rounded-lg shadow-sm card-hover cursor-pointer transition-all duration-300 hover:shadow-lg",style:{background:j,color:_},children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:e.subtitle}),Nt.jsxs("div",{className:"flex items-end justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-lg font-bold mb-1",children:e.title}),Nt.jsx("div",{className:"text-2xl font-extrabold",children:e.value})]}),Nt.jsxs("div",{className:"text-3xl opacity-20",children:[0===t&&"",1===t&&"",2===t&&"",3===t&&"",4===t&&""]})]})]})})})}return u?Nt.jsx("div",{style:{background:S,minHeight:"70vh",color:_},className:"p-6",children:Nt.jsxs("div",{className:"animate-pulse space-y-4 max-w-6xl mx-auto",children:[Nt.jsx("div",{className:"h-6 bg-gray-300 dark:bg-gray-700 rounded w-1/3"}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mt-4",children:Array.from({length:5}).map((e,t)=>Nt.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-800 rounded"},t))})]})}):Nt.jsx("div",{style:{background:S,color:_,minHeight:"80vh"},className:"p-6",children:Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsxs(sd,{className:"flex items-center justify-between mb-6",children:[Nt.jsxs("div",{children:[Nt.jsxs("h1",{className:"text-2xl font-bold",children:["Welcome back",(null==r?void 0:r.name)?`, ${r.name}`:""]}),Nt.jsx("p",{className:"text-sm text-gray-400",children:"Overview & live metrics"})]}),Nt.jsx("div",{className:"text-sm text-gray-400",children:Nt.jsxs("div",{children:["Role: ",Nt.jsx("span",{className:"font-semibold",children:o})]})})]}),Nt.jsx(ld,{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:C.map((e,t)=>Nt.jsx(M,{item:e,index:t},t))}),Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Nt.jsx(sd,{delay:.2,children:Nt.jsxs("div",{className:"p-4 rounded-lg shadow card-hover",style:{background:j,minWidth:0},children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Nt.jsx("h2",{className:"font-semibold",children:"Cashflow (Daily)"}),Nt.jsx("div",{className:"text-sm text-gray-400",children:"Income vs Expense"})]}),Nt.jsx("div",{style:{width:"100%",height:320},children:x&&x.length>0?Nt.jsx(By,{children:Nt.jsxs(UL,{data:x,children:[Nt.jsx(EO,{strokeDasharray:"3 3"}),Nt.jsx(vB,{dataKey:"date",tick:{fill:_}}),Nt.jsx(TB,{tick:{fill:_}}),Nt.jsx(OT,{}),Nt.jsx(lv,{}),Nt.jsx(oB,{type:"monotone",dataKey:"income",stroke:"#10b981",strokeWidth:2}),Nt.jsx(oB,{type:"monotone",dataKey:"expense",stroke:"#ef4444",strokeWidth:2})]})}):Nt.jsx("div",{className:"text-center text-gray-400 py-20",children:"No cashflow data"})})]})}),Nt.jsx(sd,{delay:.4,children:Nt.jsxs("div",{className:"p-4 rounded-lg shadow card-hover",style:{background:j,minWidth:0},children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Nt.jsx("h2",{className:"font-semibold",children:"Payroll Trend (Monthly)"}),Nt.jsx("div",{className:"text-sm text-gray-400",children:"Total payroll per month"})]}),Nt.jsx("div",{style:{width:"100%",height:320},children:v&&v.length>0?Nt.jsx(By,{children:Nt.jsxs(HL,{data:v,children:[Nt.jsx(EO,{strokeDasharray:"3 3"}),Nt.jsx(vB,{dataKey:"month",tick:{fill:_}}),Nt.jsx(TB,{tick:{fill:_}}),Nt.jsx(OT,{}),Nt.jsx(lv,{}),Nt.jsx(dI,{dataKey:"totalSalary",fill:"#6366f1"})]})}):Nt.jsx("div",{className:"text-center text-gray-400 py-20",children:"No payroll data"})})]})})]}),Nt.jsxs("div",{className:"mt-6",children:["admin"===o&&Nt.jsxs("div",{className:"p-4 rounded-lg shadow",style:{background:j},children:[Nt.jsx("h3",{className:"font-semibold mb-2",children:"Quick Actions"}),Nt.jsxs("div",{className:"flex gap-2 flex-wrap",children:[Nt.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white",children:"View Reports"}),Nt.jsx("button",{className:"px-3 py-2 rounded bg-emerald-600 text-white",children:"Open Cashflow"}),Nt.jsx("button",{className:"px-3 py-2 rounded bg-yellow-500 text-white",children:"Payroll Management"})]})]}),"supervisor"===o&&Nt.jsxs("div",{className:"p-4 rounded-lg shadow",style:{background:j},children:[Nt.jsx("h3",{className:"font-semibold mb-2",children:"Team Overview"}),Nt.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Active Tellers"}),Nt.jsx("div",{className:"font-bold text-xl",children:w.length})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Team Over"}),Nt.jsx("div",{className:"font-bold text-xl",children:$L({value:w.reduce((e,t)=>e+(t.over||0),0)})})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Team Short"}),Nt.jsx("div",{className:"font-bold text-xl",children:$L({value:w.reduce((e,t)=>e+(t.short||0),0)})})]})]})]}),"teller"===o&&Nt.jsxs("div",{children:[Nt.jsx(VL,{}),Nt.jsxs("div",{className:"p-4 rounded-lg shadow mt-6",style:{background:j},children:[Nt.jsx("h3",{className:"font-semibold mb-2",children:"Personal Summary"}),Nt.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Reports"}),Nt.jsx("div",{className:"font-bold",children:m.reportsCount})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Over"}),Nt.jsx("div",{className:"font-bold",children:$L({value:w.reduce((e,t)=>e+(t.over||0),0)})})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Short"}),Nt.jsx("div",{className:"font-bold",children:$L({value:w.reduce((e,t)=>e+(t.short||0),0)})})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xs text-gray-400",children:"Salary"}),Nt.jsx("div",{className:"font-bold",children:$L({value:m.totalPayroll})})]})]})]})]})]})]})})}function YL(e=""){const t=e.replace(//g,"PHP "),n=[];for(let r=0;r<t.length;r++){const e=t.charCodeAt(r);n.push(255&e)}return n}function XL(){var e,t;const{user:n,settings:r}=f.useContext($c),{showToast:a}=Kc(),i="dark"===(null==(e=null==r?void 0:r.theme)?void 0:e.mode),s=Vc();f.useEffect(()=>{const e=e=>{console.error(" GLOBAL ERROR CAUGHT:",e),console.error(" Error stack:",e.stack),console.error(" Error details:",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno})},t=e=>{console.error(" UNHANDLED PROMISE REJECTION:",e.reason),console.error(" Promise:",e.promise)};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),console.log(" MOBILE VIEWPORT DEBUG:",{innerWidth:window.innerWidth,innerHeight:window.innerHeight,screenWidth:window.screen.width,screenHeight:window.screen.height,devicePixelRatio:window.devicePixelRatio,userAgent:navigator.userAgent,touchSupport:"ontouchstart"in window,isMobile:/Mobile|Android|iPhone|iPad/.test(navigator.userAgent)}),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[]);const[o,d]=f.useState({systemBalance:"",d1000:"",d500:"",d200:"",d100:"",d50:"",d20:"",coins:"",short:"",over:""}),[u,p]=f.useState(!1),[m,g]=f.useState(null),[x,y]=f.useState(!0),[v,b]=f.useState(!1),[w,N]=f.useState(""),[S,j]=f.useState([]),[_,A]=f.useState(null),[C,M]=f.useState(!1),[k,E]=f.useState(()=>{const e=localStorage.getItem("tellerPrinters");return e?JSON.parse(e):[]}),T=e=>""===e||null==e?0:Number(e),P=1e3*T(o.d1000)+500*T(o.d500)+200*T(o.d200)+100*T(o.d100)+50*T(o.d50)+20*T(o.d20)+T(o.coins);f.useEffect(()=>{const e=T(o.systemBalance),t=P-e;d(e||P?t>0?e=>c(l({},e),{over:t.toFixed(2),short:""}):t<0?e=>c(l({},e),{short:Math.abs(t).toFixed(2),over:""}):e=>c(l({},e),{short:"",over:""}):e=>c(l({},e),{short:"",over:""}))},[o.systemBalance,o.d1000,o.d500,o.d200,o.d100,o.d50,o.d20,o.coins]),f.useEffect(()=>{h(null,null,function*(){if(null==n?void 0:n._id)try{console.log(" Fetching active capital for user:",n._id);const e=(yield pt.get(`${zc()}/api/teller-management/capital/${n._id}`)).data;e&&"active"===e.status?(g(e),console.log(" Active capital found:",e)):(g(null),console.log(" No active capital found for user"))}catch(e){console.error(" Failed to fetch active capital:",e),g(null)}finally{y(!1)}else y(!1)})},[null==n?void 0:n._id]);const D=e=>{const{name:t,value:n}=e.target;console.log(` Form change detected: ${t} = "${n}"`),d(e=>c(l({},e),{[t]:n}))},R=e=>{var t,n;console.log(" VALIDATING USER FOR SUBMISSION:"),console.log(" User Details:",{userId:null==e?void 0:e._id,userName:(null==e?void 0:e.name)||(null==e?void 0:e.username),userEmail:null==e?void 0:e.email,userRole:null==e?void 0:e.role,supervisorId:null==e?void 0:e.supervisorId,supervisorName:(null==(t=null==e?void 0:e.supervisor)?void 0:t.name)||(null==e?void 0:e.supervisorName),userStatus:null==e?void 0:e.status,userApproved:null==e?void 0:e.approved,hasPayroll:!!(null==e?void 0:e.payroll),userCreated:null==e?void 0:e.createdAt,userUpdated:null==e?void 0:e.updatedAt,timestamp:(new Date).toISOString()});const r=[],a=[];if(!e)return r.push("No user object"),{valid:!1,issues:r,warnings:a};e._id||r.push("Missing user ID"),"teller"!==e.role&&r.push(`Invalid role: ${e.role} (expected: teller)`),!1===e.approved&&r.push("User not approved"),"inactive"!==e.status&&"disabled"!==e.status||r.push(`User status: ${e.status}`),m||r.push("No active capital assigned - cannot submit reports"),e.supervisorId||(null==(n=e.supervisor)?void 0:n._id)||(a.push("Supervisor ID missing from user record (possible database sync issue)"),console.log(` DATABASE SYNC ISSUE: ${e.name} missing supervisorId in user record`),console.log(" NOTE: User may appear in supervisor reports but supervisorId not synced to user record"),console.log(" SOLUTION: Backend should dynamically assign supervisor or sync database"),console.log(" ALLOWING SUBMISSION: Mobile validation should not block due to sync issues"));const i=0===r.length;return console.log(" VALIDATION RESULT:",{valid:i,blockingIssues:r.length,warningsCount:a.length,issues:r,warnings:a,hasActiveCapital:!!m}),{valid:i,issues:r,warnings:a}},[I,O]=f.useState(0),B=()=>h(null,null,function*(){var e,t,i,l,c,h,m,g,f,x,y,v,b,w,N;if(console.log(" HANDLESUBMIT CALLED - ENTRY POINT"),console.log(" CRITICAL CHECK: Loading state at entry:",u),u)return void console.log(" CRITICAL: DOUBLE SUBMISSION BLOCKED - loading is true");if(console.log(" Starting handleSubmit function..."),console.log(" Current user:",n),console.log(" Current form state:",o),console.log(" API URL:",zc()),console.log(" Settings:",r),console.log(" Window location:",window.location.href),console.log(" Network status:",navigator.onLine?"Online":"Offline"),console.log(" Device info:",{userAgent:navigator.userAgent,isMobile:/Mobile|Android|iPhone|iPad/.test(navigator.userAgent),screenWidth:window.screen.width,screenHeight:window.screen.height,windowWidth:window.innerWidth,windowHeight:window.innerHeight}),console.log(" Step 1: User validation"),!n)return console.error(" User validation failed - user is null/undefined"),alert(" ERROR: User session not found.\n\nPlease refresh the page and log in again."),a({type:"error",message:" User session not found. Please log in again."});if(!n._id)return console.error(" User validation failed - no user._id. User object:",n),alert(" ERROR: User ID missing.\n\nPlease refresh the page and try again."),a({type:"error",message:" User ID missing. Please refresh and try again."});if(console.log(" User role check:",n.role),console.log(" User supervisor:",n.supervisorId||n.supervisor),"teller"!==n.role)return console.error(" User role validation failed - not a teller. Role:",n.role),alert(` ERROR: Only tellers can submit reports.\n\nYour role: ${n.role}\n\nContact admin if this is incorrect.`),a({type:"error",message:` Only tellers can submit reports. Your role: ${n.role}`});if(console.log(" Step 1 passed: User validation"),console.log(" Step 2: Form validation"),console.log(" System balance:",o.systemBalance,typeof o.systemBalance),!o.systemBalance||""===o.systemBalance||"0"===o.systemBalance||isNaN(Number(o.systemBalance)))return console.error(" System balance validation failed:",o.systemBalance),console.error(" Validation details:",{isEmpty:!o.systemBalance,isEmptyString:""===o.systemBalance,isZero:"0"===o.systemBalance,isNaN:isNaN(Number(o.systemBalance)),actualValue:o.systemBalance,actualType:typeof o.systemBalance}),alert(` SYSTEM BALANCE ERROR\n\nCurrent value: "${o.systemBalance}"\nType: ${typeof o.systemBalance}\n\nPlease enter a valid number greater than 0 for system balance.\n\nExample: 15000`),p(!1),a({type:"error",message:" Please enter a valid system balance (numbers only)"});console.log(" Checking denominations...");const S=o.d1000||o.d500||o.d200||o.d100||o.d50||o.d20||o.coins;if(console.log(" Denomination check:",{d1000:o.d1000,d500:o.d500,d200:o.d200,d100:o.d100,d50:o.d50,d20:o.d20,coins:o.coins,hasAny:S}),!S)return console.error(" No denomination data provided. Form:",o),alert(" ERROR: No cash counted.\n\nPlease enter at least one denomination amount."),a({type:"error",message:" Please count and enter at least one denomination"});console.log(" Step 2 passed: Form validation"),console.log(" Step 3: API connectivity test");try{console.log(" Testing API connectivity to:",`${zc()}/api/settings`);const e=yield pt.get(`${zc()}/api/settings`);console.log(" API connectivity confirmed:",e.status)}catch(j){return console.error(" API connectivity failed:",j),alert(` ERROR: Cannot connect to server.\n\nError: ${j.message}\n\nCheck your internet connection.`),a({type:"error",message:" Cannot connect to server. Check your internet connection."})}console.log(" Step 3 passed: API connectivity"),console.log(" All validations passed, preparing payload..."),console.log(" Step 4: Cash calculation"),console.log(" Cash on hand calculation:",{d1000_count:T(o.d1000),d1000_value:1e3*T(o.d1000),d500_count:T(o.d500),d500_value:500*T(o.d500),d200_count:T(o.d200),d200_value:200*T(o.d200),d100_count:T(o.d100),d100_value:100*T(o.d100),d50_count:T(o.d50),d50_value:50*T(o.d50),d20_count:T(o.d20),d20_value:20*T(o.d20),coins:T(o.coins),total_cashOnHand:P}),console.log(" Step 4 passed: Cash calculation");try{console.log(" Step 5: Setting loading state and creating payload"),p(!0),console.log(" Loading state set to true");const r={tellerId:n._id,tellerName:n.name||n.username,supervisorId:n.supervisorId||(null==(e=n.supervisor)?void 0:e._id)||null,supervisorName:(null==(t=n.supervisor)?void 0:t.name)||n.supervisorName||"",date:(new Date).toISOString(),systemBalance:T(o.systemBalance),cashOnHand:P,short:T(o.short),over:T(o.over),d1000:T(o.d1000),d500:T(o.d500),d200:T(o.d200),d100:T(o.d100),d50:T(o.d50),d20:T(o.d20),coins:T(o.coins)};console.log(" Step 5 passed: Payload created"),console.log(" Step 6: Final payload review"),console.log(" Original Form Data:",JSON.stringify(o,null,2)),console.log(" Final Payload to Submit:",JSON.stringify(r,null,2)),console.log(" User context:",{_id:n._id,name:n.name,username:n.username,role:n.role,supervisorId:n.supervisorId,supervisor:n.supervisor}),console.log(" Step 7: Making API call"),console.log(" API URL:",`${zc()}/api/teller-reports/create`),console.log(" Axios default headers:",pt.defaults.headers);const i=yield pt.post(`${zc()}/api/teller-reports/create`,r);console.log(" Step 7 passed: API call successful"),console.log(" Full API response:",{status:i.status,statusText:i.statusText,data:i.data,headers:i.headers}),console.log(" Step 8: Post-submission actions"),console.log(" Emitting socket event..."),s?(s.emit("tellerReportCreated",r),console.log(" Socket event emitted successfully")):console.log(" Socket disabled - skipping live notification"),console.log(" Showing success toast..."),a({type:"success",message:" Report submitted successfully! Your teller report has been sent for supervisor review."}),console.log(" Showing success alert..."),alert(" REPORT SUBMITTED SUCCESSFULLY!\n\n Your teller report has been submitted and is now pending supervisor verification.\n\n Thank you for your submission!"),console.log(" Refetching active capital after submission..."),fetchActiveCapital(),console.log(" Clearing form..."),d({systemBalance:"",d1000:"",d500:"",d200:"",d100:"",d50:"",d20:"",coins:"",short:"",over:""}),console.log(" Step 8 passed: Post-submission actions completed"),console.log(" Report submission completed successfully - ALL STEPS PASSED")}catch(_){console.log(" Step X: ERROR HANDLING"),console.error(" SUBMISSION FAILED - Error during submission:",_),console.error(" Error name:",_.name),console.error(" Error message:",_.message),console.error(" Error code:",_.code),console.error(" Error response:",_.response),console.error(" Error response status:",null==(i=_.response)?void 0:i.status),console.error(" Error response data:",null==(l=_.response)?void 0:l.data),console.error(" Error response headers:",null==(c=_.response)?void 0:c.headers),console.error(" Full error object:",JSON.stringify(_,Object.getOwnPropertyNames(_),2));let e=" Failed to submit report",t="";400===(null==(h=_.response)?void 0:h.status)?(e=` Validation Error: ${(null==(m=_.response.data)?void 0:m.error)||"Invalid data provided"}`,t=` VALIDATION ERROR\n\n${(null==(g=_.response.data)?void 0:g.error)||"The data you entered is invalid."}\n\nPlease check your entries and try again.`):401===(null==(f=_.response)?void 0:f.status)?(e=" Authentication Error: Please log in again",t=" AUTHENTICATION ERROR\n\nYour login session has expired.\n\nPlease refresh the page and log in again."):403===(null==(x=_.response)?void 0:x.status)?(e=" Permission Error: You don't have permission to submit reports",t=" PERMISSION ERROR\n\nYou don't have permission to submit reports.\n\nContact your supervisor or admin."):500===(null==(y=_.response)?void 0:y.status)?(e=" Server Error: Please try again later or contact support",t=" SERVER ERROR\n\nThe server encountered an error.\n\nPlease try again in a few minutes or contact technical support."):"NETWORK_ERROR"!==_.code&&_.response?(e=` Error: ${(null==(b=null==(v=_.response)?void 0:v.data)?void 0:b.error)||_.message}`,t=` SUBMISSION ERROR\n\nError: ${(null==(N=null==(w=_.response)?void 0:w.data)?void 0:N.error)||_.message}\n\nPlease try again or contact support.`):(e=" Network Error: Check your internet connection and try again",t=" NETWORK ERROR\n\nCannot connect to the server.\n\nPlease check your internet connection and try again."),console.log(" Error message to show user:",e),console.log(" Alert message to show user:",t),a({type:"error",message:e}),alert(t||`${e}\n\nIf this problem continues, please contact technical support.`),console.log(" ERROR HANDLING COMPLETED")}finally{console.log(" FINALLY BLOCK - Setting loading to false"),p(!1),console.log(" Loading state reset to false")}}),L=e=>""===e||null==e?"":Number(e).toLocaleString(),F=e=>h(null,null,function*(){try{console.log(" Connecting to printer:",e);if(!window.confirm(` PRINTER CONFIRMATION\n\nYou are about to connect to:\nPrinter: ${e.name}\nMAC Address: ${e.serialNumber}\nType: ${e.type.toUpperCase()}\n\n IMPORTANT: Make sure this is YOUR assigned printer!\nPrinting to another teller's printer may cause confusion.\n\nIs this your correct printer?`))return void a({type:"info",message:"Printer selection cancelled"});if("bluetooth"===e.type&&e.bluetoothDevice)try{console.log(" Testing Bluetooth connection..."),e.bluetoothDevice.gatt.connected||(yield e.bluetoothDevice.gatt.connect());const t=yield e.bluetoothDevice.gatt.getPrimaryServices();console.log(" Found services:",t.length),e.connected=!0,a({type:"success",message:` Connected to ${e.name}! Found ${t.length} services.`})}catch(t){console.error(" Bluetooth connection test failed:",t),a({type:"warning",message:`Cannot connect to ${e.name}. Will use for browser printing only.`}),e.connected=!1}A(e);const n=c(l({},e),{bluetoothDevice:void 0}),r=[...k.filter(t=>t.id!==e.id),n];E(r),localStorage.setItem("tellerPrinters",JSON.stringify(r)),a({type:"success",message:` Selected printer: ${e.name}`})}catch(n){console.error(" Printer selection error:",n),a({type:"error",message:"Failed to select printer: "+n.message})}}),U=S.filter(e=>{const t=w.toLowerCase(),n=e.name.toLowerCase(),r=(e.serialNumber||"").toLowerCase(),a=(e.macAddress||"").toLowerCase(),i=r.replace(/[:-]/g,""),s=a.replace(/[:-]/g,""),o=t.replace(/[:-]/g,"");return n.includes(t)||r.includes(t)||a.includes(t)||i.includes(o)||s.includes(o)}),H=()=>h(null,null,function*(){try{const s=T(o.systemBalance),l=P-s,c=l>0?l:0,d=l<0?Math.abs(l):0;console.log(" Starting print process...");const u={orgName:(null==r?void 0:r.systemName)||"RMI Teller Report",tellerName:(null==n?void 0:n.name)||(null==n?void 0:n.username)||"",dateStr:(new Date).toLocaleString(),systemBalance:s,cashOnHand:P,d:{d1000:T(o.d1000),d500:T(o.d500),d200:T(o.d200),d100:T(o.d100),d50:T(o.d50),d20:T(o.d20),coins:T(o.coins)},over:c,short:d};if(_&&"bluetooth"===_.type&&_.bluetoothDevice)try{console.log(" Attempting Bluetooth print to:",_.name);const t=_.bluetoothDevice;t.gatt.connected||(console.log(" Connecting to Bluetooth device..."),yield t.gatt.connect()),console.log(" Connected to Bluetooth device");const n=function({orgName:e="RMI Teller Report",tellerName:t="",dateStr:n=(new Date).toLocaleString(),systemBalance:r=0,cashOnHand:a=0,d:i={d1000:0,d500:0,d200:0,d100:0,d50:0,d20:0,coins:0},over:s=0,short:o=0}){const l=[],c=(...e)=>l.push(...e),d=()=>c(10),u=e=>c(27,97,2&e),h=()=>c(27,69,1),p=()=>c(27,69,0),m=()=>{c(...YL("--------------------------------")),d()},g=(e="")=>{c(...YL(e)),d()},f=(e="",t="",n="")=>String(e).padEnd(10)+String(t).padStart(6)+String(n).padStart(12),x=(e="",t="")=>{const n=Math.max(1,32-e.length-t.length);return e+" ".repeat(n)+t};c(27,64),u(1),h(),c(29,33,17),g(e.toUpperCase()),c(29,33,0),p(),d(),u(0),g(x("SV:","")),g(x("TELLER:",(t||"").toUpperCase())),g(x("DATE:",n)),g(x("SYSTEM BALANCE:",Number(r).toLocaleString())),g(x("CASH ON HAND:",Number(a).toLocaleString())),g(x("OVER:",s?Number(s).toLocaleString():"0")),g(x("SHORT:",o?Number(o).toLocaleString():"0")),d(),u(1),h(),g("DENOMINATION"),p(),u(0),g(f("","PCS","TOTAL")),m();const y=Number(i.d1000||0),v=Number(i.d500||0),b=Number(i.d200||0),w=Number(i.d100||0),N=Number(i.d50||0),S=Number(i.d20||0),j=Number(i.coins||0);return g(f("1000x",y.toString(),(1e3*y).toLocaleString())),g(f("500x",v.toString(),(500*v).toLocaleString())),g(f("200x",b.toString(),(200*b).toLocaleString())),g(f("100x",w.toString(),(100*w).toLocaleString())),g(f("50x",N.toString(),(50*N).toLocaleString())),g(f("20x",S.toString(),(20*S).toLocaleString())),g(f("COINS","",j.toLocaleString())),m(),g(f("TOTAL","",Number(a).toLocaleString())),d(),u(1),g("Thank you"),u(0),c(27,100,4),c(29,86,0),new Uint8Array(l)}(u),r=yield t.gatt.getPrimaryServices();console.log(" Available services:",r.length);for(let i of r)try{const e=yield i.getCharacteristics();for(let t of e)if(t.properties.write||t.properties.writeWithoutResponse){console.log(" Found writable characteristic:",t.uuid);const e=20;for(let r=0;r<n.length;r+=e){const a=n.slice(r,r+e);yield t.writeValue(a),yield new Promise(e=>setTimeout(e,50))}return void a({type:"success",message:` Printed to ${_.name} via Bluetooth!`})}}catch(e){console.log(" Error checking characteristics:",e.message)}console.log(" No writable characteristics found")}catch(t){console.error(" Bluetooth print failed:",t),a({type:"warning",message:`Bluetooth print failed: ${t.message}. Using browser print...`})}if(navigator.share)try{const e=G(u);return yield navigator.share({title:"Teller Report",text:e}),void a({type:"success",message:"Receipt shared successfully!"})}catch(i){console.log(" Web Share failed:",i.message)}console.log(" Using browser print dialog"),(()=>{const e=T(o.systemBalance),t=P-e,a=t>0?t:0,i=t<0?Math.abs(t):0,s=(new Date).toLocaleString(),l=((null==n?void 0:n.name)||(null==n?void 0:n.username)||"").toUpperCase(),c=`<!doctype html>\n      <html>\n        <head>\n          <meta charset="utf-8" />\n          <title>Teller Report</title>\n          <style>\n            @page { size: 58mm auto; margin: 2mm; }\n            body { \n              width: 58mm; \n              font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; \n              font-size: 10px;\n              line-height: 1.2;\n            }\n            .center { text-align: center; }\n            .bold { font-weight: bold; }\n            .line { border-top: 1px solid #000; margin: 4px 0; }\n            pre { \n              white-space: pre-wrap; \n              word-wrap: break-word; \n              margin: 1px 0;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              font-size: 9px;\n            }\n            td {\n              padding: 1px 2px;\n              border: 1px solid #000;\n            }\n            .header-section {\n              margin-bottom: 8px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="center bold">${((null==r?void 0:r.systemName)||"RMI Teller Report").toUpperCase()}</div>\n          <br>\n          \n          <div class="header-section">\n            <pre>SV:</pre>\n            <pre>TELLER:                  ${l}</pre>\n            <pre>DATE:                    ${s}</pre>\n            <pre>SYSTEM BALANCE:          ${e.toLocaleString()}</pre>\n            <pre>CASH ON HAND:            ${P.toLocaleString()}</pre>\n            <pre>OVER:                    ${a.toLocaleString()}</pre>\n            <pre>SHORT:                   ${i.toLocaleString()}</pre>\n          </div>\n\n          <div class="center bold">DENOMINATION</div>\n          <table>\n            <tr>\n              <td style="width: 40%"></td>\n              <td style="width: 25%; text-align: center;"><strong>PCS</strong></td>\n              <td style="width: 35%; text-align: center;"><strong>TOTAL</strong></td>\n            </tr>\n            <tr>\n              <td>1000x</td>\n              <td style="text-align: right;">${T(o.d1000)}</td>\n              <td style="text-align: right;">${(1e3*T(o.d1000)).toLocaleString()}</td>\n            </tr>\n            <tr>\n              <td>500x</td>\n              <td style="text-align: right;">${T(o.d500)}</td>\n              <td style="text-align: right;">${(500*T(o.d500)).toLocaleString()}</td>\n            </tr>\n            <tr>\n              <td>200x</td>\n              <td style="text-align: right;">${T(o.d200)}</td>\n              <td style="text-align: right;">${(200*T(o.d200)).toLocaleString()}</td>\n            </tr>\n            <tr>\n              <td>100x</td>\n              <td style="text-align: right;">${T(o.d100)}</td>\n              <td style="text-align: right;">${(100*T(o.d100)).toLocaleString()}</td>\n            </tr>\n            <tr>\n              <td>50x</td>\n              <td style="text-align: right;">${T(o.d50)}</td>\n              <td style="text-align: right;">${(50*T(o.d50)).toLocaleString()}</td>\n            </tr>\n            <tr>\n              <td>20x</td>\n              <td style="text-align: right;">${T(o.d20)}</td>\n              <td style="text-align: right;">${(20*T(o.d20)).toLocaleString()}</td>\n            </tr>\n            <tr>\n              <td>COINS</td>\n              <td style="text-align: right;"></td>\n              <td style="text-align: right;">${T(o.coins).toLocaleString()}</td>\n            </tr>\n            <tr style="border-top: 2px solid #000;">\n              <td><strong>TOTAL</strong></td>\n              <td style="text-align: right;"></td>\n              <td style="text-align: right;"><strong>${P.toLocaleString()}</strong></td>\n            </tr>\n          </table>\n\n          <div class="center" style="margin-top: 8px;">Thank you</div>\n          \n          <script>\n            window.onload = function(){\n              window.print();\n              setTimeout(() => window.close(), 300);\n            }\n          <\/script>\n        </body>\n      </html>`,d=window.open("","_blank","width=320,height=540");d&&(d.document.open(),d.document.write(c),d.document.close())})(),a({type:"success",message:"Print dialog opened"})}catch(s){console.error(" Print failed:",s),a({type:"error",message:"Print failed: "+s.message})}}),G=e=>{const t="-".repeat(32);return`\n${e.orgName.toUpperCase()}\nTELLER REPORT\n${e.dateStr}\n${t}\nTELLER: ${e.tellerName}\nSYSTEM BALANCE: ${e.systemBalance.toLocaleString()}\nCASH ON HAND: ${e.cashOnHand.toLocaleString()}\n${t}\n1000 x ${e.d.d1000} = ${(1e3*e.d.d1000).toLocaleString()}\n500 x ${e.d.d500} = ${(500*e.d.d500).toLocaleString()}\n200 x ${e.d.d200} = ${(200*e.d.d200).toLocaleString()}\n100 x ${e.d.d100} = ${(100*e.d.d100).toLocaleString()}\n50 x ${e.d.d50} = ${(50*e.d.d50).toLocaleString()}\n20 x ${e.d.d20} = ${(20*e.d.d20).toLocaleString()}\nCOINS: ${e.d.coins.toLocaleString()}\n${t}\nTOTAL: ${e.cashOnHand.toLocaleString()}\nOVER: ${e.over.toLocaleString()}\nSHORT: ${e.short.toLocaleString()}\n${t}\nThank you\n`.trim()};return Nt.jsxs("div",{className:"p-6 min-h-screen "+(i?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[Nt.jsx(z,{className:"text-indigo-500"}),Nt.jsx("h1",{className:"text-2xl font-semibold",children:"Teller Report"}),Nt.jsxs("div",{className:"ml-auto text-xs text-gray-500",children:["API: ",zc()," | User: ",(null==n?void 0:n.username)||"Not logged in"," | Socket: ",(null==s?void 0:s.connected)?"":""]})]}),Nt.jsxs("div",{className:"rounded-xl p-5 mb-6 border shadow "+(i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("h2",{className:"font-semibold mb-3",children:" Financial Summary"}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[" Enter your ",Nt.jsx("strong",{children:"System Balance"})," from your terminal/system. Cash On Hand is auto-calculated from denominations below."]}),Nt.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1 font-medium text-blue-600 dark:text-blue-400 cursor-pointer",children:" System Balance (from terminal)"}),Nt.jsx("input",{name:"systemBalance",type:"number",value:o.systemBalance,onChange:D,className:"input-box border-blue-300 focus:border-blue-500",placeholder:"Enter actual system balance",step:"0.01",autoComplete:"off"}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"From your system/terminal"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1 font-medium text-indigo-600 dark:text-indigo-400",children:" Cash On Hand (counted)"}),Nt.jsx("input",{readOnly:!0,value:L(P),className:"input-box bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 font-semibold"}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-calculated from bills/coins"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1 font-medium text-red-500",children:" Short (missing cash)"}),Nt.jsx("input",{readOnly:!0,value:o.short?L(o.short):"",className:"input-box bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 font-semibold",placeholder:"0.00"}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When physical cash < system"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1 font-medium text-green-500",children:" Over (excess cash)"}),Nt.jsx("input",{readOnly:!0,value:o.over?L(o.over):"",className:"input-box bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 font-semibold",placeholder:"0.00"}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"When physical cash > system"})]})]}),o.systemBalance&&P>0&&Nt.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:[Nt.jsx("h3",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:" Calculation Breakdown:"}),Nt.jsxs("div",{className:"text-sm space-y-1",children:[Nt.jsxs("div",{children:[" System Balance: ",L(o.systemBalance)]}),Nt.jsxs("div",{children:[" Cash On Hand (counted): ",L(P)]}),Nt.jsx("div",{className:"font-medium",children:P>T(o.systemBalance)?` Over: ${L(P-T(o.systemBalance))} (You have MORE than expected)`:P<T(o.systemBalance)?` Short: ${L(T(o.systemBalance)-P)} (You have LESS than expected)`:" Perfect Balance! No shortage or overage."})]})]})]}),Nt.jsxs("div",{className:"rounded-xl p-5 border shadow "+(i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("h2",{className:"font-semibold mb-3",children:" Physical Cash Count (Denominations)"}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[" Count your actual physical bills and coins. Enter the ",Nt.jsx("strong",{children:"number of pieces"})," for each denomination."]}),Nt.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-4",children:[["d1000","d500","d200","d100","d50","d20"].map(e=>Nt.jsxs("div",{children:[Nt.jsxs("label",{className:"block text-sm mb-1 font-medium text-green-600 dark:text-green-400 cursor-pointer",children:[" ",e.replace("d","")," bills"]}),Nt.jsx("input",{type:"number",name:e,value:o[e],onChange:D,className:"input-box border-green-300 focus:border-green-500",placeholder:"0",min:"0",autoComplete:"off"}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o[e]?`= ${(parseInt(o[e])*parseInt(e.replace("d",""))).toLocaleString()}`:"pieces"})]},e)),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1 font-medium text-green-600 dark:text-green-400 cursor-pointer",children:" Coins (total value)"}),Nt.jsx("input",{type:"number",name:"coins",value:o.coins,onChange:D,className:"input-box border-green-300 focus:border-green-500",placeholder:"0",min:"0",step:"0.01",autoComplete:"off"}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total peso value of all coins"})]})]}),!x&&!m&&Nt.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:Nt.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[Nt.jsx("span",{className:"text-lg",children:""}),Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"font-semibold",children:"No Active Capital"}),Nt.jsx("p",{className:"text-sm",children:"You cannot submit teller reports without active capital assigned by your supervisor. Please contact your supervisor to receive capital before submitting your report."})]})]})}),!x&&m&&Nt.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:Nt.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[Nt.jsx("span",{className:"text-lg",children:""}),Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"font-semibold",children:"Active Capital Available"}),Nt.jsxs("p",{className:"text-sm",children:["Base: ",(null==(t=m.amount)?void 0:t.toLocaleString())||0,m.totalAdditional>0&&` + Additional: ${m.totalAdditional.toLocaleString()}`,m.totalRemitted>0&&` - Remitted: ${m.totalRemitted.toLocaleString()}`]})]})]})}),Nt.jsxs("div",{className:"flex flex-wrap gap-3",children:[Nt.jsx("button",{onClick:()=>{alert(" SUBMIT CLICKED!"),console.log(" Submit button clicked!"),(e=>{h(null,null,function*(){var t;console.log(" HANDLESUBMIT ENTRY - Function called successfully!");try{const e=Date.now();if(e-I<300)return void console.log(" BLOCKED: Double-click detected, ignoring");O(e),console.log("CRITICAL: Mobile submit wrapper called");const t=R(n);if(console.log(" USER VALIDATION RESULT:",t),!t.valid)return console.log("CRITICAL: BLOCKED - User validation failed:",t.issues),void alert(` SUBMISSION BLOCKED\n\nUser: ${(null==n?void 0:n.name)||"Unknown"}\n\nIssues found:\n${t.issues.join("\n")}\n\nContact your supervisor or administrator.`);console.log(" User validation passed, calling handleSubmit"),console.log(" CURRENT FORM DATA:",o)}catch(r){return alert(` ERROR in handleMobileSubmit entry: ${r.message}`),void console.error("ERROR in handleMobileSubmit entry:",r)}if(console.log("CRITICAL: Event details:",{type:null==e?void 0:e.type,target:null==(t=null==e?void 0:e.target)?void 0:t.tagName,isMobile:/Mobile|Android|iPhone|iPad/.test(navigator.userAgent),touchSupported:"ontouchstart"in window,loading:u,user:!!n,userId:null==n?void 0:n._id,userRole:null==n?void 0:n.role}),u)return console.log(" CRITICAL: BLOCKED - Already loading, aborting submission"),void alert(" Please wait - submission in progress");if(!n)return console.log(" CRITICAL: BLOCKED - No user found, aborting submission"),void alert(" ERROR: No user session\n\nPlease refresh the page and log in again.");if(!n._id)return console.log(" CRITICAL: BLOCKED - No user ID found, aborting submission"),void alert(" ERROR: No user ID\n\nPlease refresh the page and log in again.");console.log(" CRITICAL: All preliminary checks passed, proceeding to handleSubmit"),p(!0),console.log(" CRITICAL: Loading set to true");try{/Mobile|Android|iPhone|iPad/.test(navigator.userAgent)?(console.log(" CRITICAL: Mobile device detected - adding 150ms delay"),setTimeout(()=>{console.log(" CRITICAL: Mobile delay complete, calling handleSubmit"),B()},150)):(console.log(" CRITICAL: Desktop device - calling handleSubmit immediately"),B())}catch(r){console.error(" CRITICAL ERROR in handleMobileSubmit:",r),p(!1),alert(` CRITICAL ERROR\n\n${r.message}\n\nPlease try again or contact support.`)}})})()},disabled:u||!x&&!m,className:"btn-mobile flex items-center gap-2 text-white bg-blue-600 hover:bg-blue-700 active:bg-blue-800 disabled:bg-gray-400 disabled:cursor-not-allowed",type:"button",children:u?"Loading...":"Submit Report"}),Nt.jsxs("button",{type:"button",onClick:()=>b(!v),className:"btn-mobile flex items-center gap-2 text-white bg-purple-600 hover:bg-purple-700 active:bg-purple-800",title:"Find and connect to thermal printers",children:[" ",Nt.jsx(de,{}),"Find Printer"]}),Nt.jsxs("button",{type:"button",onClick:_?()=>h(null,null,function*(){if(_)try{console.log(" Printing with selected printer:",_),H(),a({type:"success",message:`Print sent to ${_.name} (${_.serialNumber})`})}catch(e){console.error(" Print error:",e),a({type:"error",message:"Print failed: "+e.message})}else a({type:"warning",message:"Please select a printer first"})}):H,className:"btn-mobile flex items-center gap-2 text-white bg-slate-700 hover:bg-slate-800 active:bg-slate-900",title:_?`Print with ${_.name}`:"Auto print (RawBT if available, else browser)",children:[Nt.jsx(de,{}),_?`Print (${_.serialNumber})`:"Print (58mm)"]}),Nt.jsx("button",{type:"button",onClick:()=>{const e=T(o.systemBalance),t=P-e,i=t>0?t:0,s=t<0?Math.abs(t):0,l={orgName:(null==r?void 0:r.systemName)||"RMI Teller Report",tellerName:(null==n?void 0:n.name)||(null==n?void 0:n.username)||"",dateStr:(new Date).toLocaleString(),systemBalance:e,cashOnHand:P,d:{d1000:T(o.d1000),d500:T(o.d500),d200:T(o.d200),d100:T(o.d100),d50:T(o.d50),d20:T(o.d20),coins:T(o.coins)},over:i,short:s},c=G(l);h(null,null,function*(){try{if(navigator.share)return yield navigator.share({title:"Teller Report",text:c}),void a({type:"success",message:"Receipt shared successfully!"});if(navigator.clipboard&&navigator.clipboard.writeText)return yield navigator.clipboard.writeText(c),void a({type:"success",message:"Receipt copied to clipboard!"});const t=document.createElement("textarea");t.value=c,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{const e=document.execCommand("copy");if(document.body.removeChild(t),e)return void a({type:"success",message:"Receipt copied to clipboard!"});throw new Error("Copy command failed")}catch(e){throw document.body.removeChild(t),e}}catch(t){console.log(" All copy methods failed:",t),alert("Receipt Text (please copy manually):\n\n"+c),a({type:"info",message:"Receipt displayed in popup - please copy manually"})}})},className:"btn-mobile flex items-center gap-2 text-white bg-green-600 hover:bg-green-700 active:bg-green-800",title:"Generate receipt as text (no Bluetooth needed)",children:" Copy Receipt Text"}),Nt.jsx("button",{type:"button",onClick:()=>h(null,null,function*(){var e,t,r,a;if(!(null==n?void 0:n._id))return console.error(" Cannot run diagnostic - no user ID"),void alert(" No user found for diagnostic");console.log(" Running simplified diagnostic...");const i=R(n);let s=" MOBILE SUBMISSION DIAGNOSTIC REPORT\n\n";s+=` User: ${n.name||n.username}\n`,s+=` User ID: ${n._id}\n`,s+=` Role: ${n.role}\n`,s+=` Device: ${/Mobile|Android|iPhone|iPad/.test(navigator.userAgent)?"Mobile":"Desktop"}\n`,s+=` Status: ${n.status||"Unknown"}\n\n`,s+=" REQUIREMENTS CHECK:\n",s+=` Has User ID: ${n._id?"YES":"NO"}\n`,s+=` Teller Role: ${"teller"===n.role?"YES":"NO"}\n`,s+=` User Approved: ${!1!==n.approved?"YES":"NO"}\n`,s+=` Active Status: ${"inactive"!==n.status&&"disabled"!==n.status?"YES":"NO"}\n`,s+=` Has Active Capital: ${m?"YES":"NO"}\n`,s+=` Has Supervisor: ${n.supervisorId||(null==(e=n.supervisor)?void 0:e._id)?"YES":"NO"}\n\n`,m?(s+=` Active Capital: ${m.amount||0}`,m.totalAdditional&&(s+=` + ${m.totalAdditional}`),m.totalRemitted&&(s+=` - ${m.totalRemitted}`),s+="\n"):s+=" Active Capital: NONE\n",((null==(t=n.supervisor)?void 0:t.name)||n.supervisorName)&&(s+=` Supervisor: ${(null==(r=n.supervisor)?void 0:r.name)||n.supervisorName}\n\n`),i.valid?(s+=" RESULT: You CAN submit reports!\n",s+=" All critical validation checks passed.\n\n",i.warnings&&i.warnings.length>0&&(s+=" WARNINGS (non-blocking):\n",i.warnings.forEach((e,t)=>{s+=`${t+1}. ${e}\n`}),s+="\n")):(s+=" RESULT: Cannot submit reports\n\n",s+=" CRITICAL ISSUES TO FIX:\n",i.issues.forEach((e,t)=>{s+=`${t+1}. ${e}\n`}),s+="\n Contact your supervisor or administrator to resolve these issues.\n\n"),!n.supervisorId&&(null==(a=i.warnings)?void 0:a.some(e=>e.includes("database sync")))&&(s+=" SUPERVISOR ASSIGNMENT:\n",s+=" Your reports are automatically assigned to your supervisor\n",s+=" System handles supervisor assignment dynamically\n",s+=" No action needed from you\n\n"),s+=" System Status: All systems operational\n",s+=" Ready for report submission!\n\n",console.log(" Local diagnostic complete:",i),alert(s)}),className:"btn-mobile flex items-center gap-2 text-white bg-orange-600 hover:bg-orange-700 active:bg-orange-800",title:"Check if you can submit reports",children:" Check Status"})]})]}),v&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:Nt.jsxs("div",{className:"rounded-xl p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsx("h2",{className:"text-xl font-semibold flex items-center gap-2",children:" Printer Finder"}),Nt.jsx("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:""})]}),_&&Nt.jsx("div",{className:"p-3 rounded mb-4 "+(i?"bg-green-900/20 border border-green-500":"bg-green-50 border border-green-200"),children:Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("div",{children:[Nt.jsxs("p",{className:"font-medium text-green-600 dark:text-green-400",children:[" Selected: ",_.name]}),Nt.jsxs("p",{className:"text-sm text-gray-600",children:["Serial: ",_.serialNumber," | Type: ",_.type]})]}),Nt.jsx("button",{onClick:()=>A(null),className:"text-red-500 hover:text-red-700 text-sm",children:"Remove"})]})}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:" Search by Name or Serial Number"}),Nt.jsx("input",{type:"text",value:w,onChange:e=>N(e.target.value),placeholder:"Type MAC address (e.g., 10:22:4B:3C:75) or printer name...",className:"w-full p-3 border rounded-lg "+(i?"bg-gray-700 border-gray-600 placeholder-gray-400":"bg-white border-gray-300 placeholder-gray-500")}),Nt.jsxs("div",{className:"flex items-center justify-between mt-1",children:[Nt.jsxs("p",{className:"text-xs text-gray-500",children:[" Tip: Type ",Nt.jsx("code",{className:"bg-gray-200 dark:bg-gray-700 px-1 rounded",children:"10:22:4B:3C:75"})," to find your printer"]}),(w.includes("10:22:4B:3C:75")||w.includes("10224B3C75"))&&Nt.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:" Searching for your printer!"})]})]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){M(!0),j([]);try{if(console.log(" Starting thermal printer scan..."),!navigator.bluetooth)return a({type:"error",message:"Web Bluetooth not supported. Use Chrome, Edge, or Opera on desktop/mobile."}),void M(!1);if(!(yield navigator.bluetooth.getAvailability()))return a({type:"warning",message:"Bluetooth not available. Please enable Bluetooth in your device settings."}),void M(!1);const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||window.location.hostname.startsWith("192.168.")||window.location.hostname.startsWith("10.")||window.location.hostname.startsWith("172.");if(!window.isSecureContext&&!e)return a({type:"error",message:"Bluetooth requires HTTPS. Use localhost for testing or deploy over HTTPS."}),void M(!1);a({type:"info",message:"Scanning for thermal printers... Select your printer when prompted."});const t=yield navigator.bluetooth.requestDevice({filters:[{services:["000018f0-0000-1000-8000-00805f9b34fb"]},{services:["00001101-0000-1000-8000-00805f9b34fb"]},{services:["49535343-fe7d-4ae5-8fa9-9fafd205e455"]},{services:["0000180a-0000-1000-8000-00805f9b34fb"]},{namePrefix:"Print"},{namePrefix:"Printer"},{namePrefix:"Thermal"},{namePrefix:"Receipt"},{namePrefix:"POS"},{namePrefix:"TM-"},{namePrefix:"RP-"},{namePrefix:"xPrint"},{namePrefix:"58"},{namePrefix:"80"},{namePrefix:"Star"},{namePrefix:"Citizen"},{namePrefix:"Epson"}],optionalServices:["000018f0-0000-1000-8000-00805f9b34fb","00001101-0000-1000-8000-00805f9b34fb","49535343-fe7d-4ae5-8fa9-9fafd205e455","0000180f-0000-1000-8000-00805f9b34fb","0000180a-0000-1000-8000-00805f9b34fb"]});if(t){console.log(" User selected device:",t);let e=null,n=t.id||"Unknown";if(t.name){const n=[/([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})/,/([0-9A-Fa-f]{4}[:-]){2}([0-9A-Fa-f]{4})/,/([0-9A-Fa-f]{2}){6}/];for(const r of n){const n=t.name.match(r);if(n){e=n[0].toUpperCase().replace(/[:-]/g,":");break}}}if(!e&&t.id){const n=t.id.replace(/[^0-9A-Fa-f]/g,"");if(n.length>=12){const t=n.slice(-12).match(/.{2}/g);t&&6===t.length&&(e=t.join(":").toUpperCase())}}const r={id:"bt_"+Date.now(),name:t.name||"Thermal Printer",type:"bluetooth",connected:!1,serialNumber:e||n,macAddress:e,bluetoothDevice:t,vendorId:t.vendorId||null,productId:t.productId||null};j([r]),A(r),a({type:"success",message:`Found thermal printer: ${t.name||"Unknown Printer"}`})}else a({type:"info",message:"No printer selected. Try scanning again."})}catch(e){console.error(" Bluetooth operation failed:",e),console.log("Error name:",e.name),console.log("Error message:",e.message);let t="Bluetooth scan failed. ";switch(e.name){case"NotFoundError":t+="No thermal printers found. Make sure your printer is turned on and in pairing mode.";break;case"NotSupportedError":t+="Bluetooth not supported in this context. Try HTTPS.";break;case"SecurityError":t+="Bluetooth access denied. Check browser permissions.";break;case"NotAllowedError":t+="Bluetooth permission denied.";break;case"InvalidStateError":t+="Bluetooth not available. Check system Bluetooth settings.";break;default:t+=e.message||"Unknown error."}a({type:"warning",message:t})}finally{M(!1)}}),disabled:C,className:"w-full btn-mobile flex items-center justify-center gap-2 text-white bg-indigo-600 hover:bg-indigo-700",children:C?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{className:"w-4 h-4 animate-spin"}),"Scanning for Bluetooth devices..."]}):Nt.jsx(Nt.Fragment,{children:" Scan for Bluetooth Printers"})}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:" Make sure your Bluetooth printer is turned on and discoverable"}),Nt.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1 text-center",children:" You'll be prompted to select your printer from the Bluetooth dialog"})]}),k.length>0&&Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("h3",{className:"font-medium mb-2",children:" Saved Printers"}),Nt.jsx("div",{className:"space-y-2",children:k.map(e=>Nt.jsx("div",{className:"p-3 rounded border cursor-pointer transition-colors "+((null==_?void 0:_.id)===e.id?i?"bg-indigo-900/30 border-indigo-500":"bg-indigo-50 border-indigo-300":i?"bg-gray-700 border-gray-600 hover:bg-gray-600":"bg-gray-50 border-gray-200 hover:bg-gray-100"),onClick:()=>A(e),children:Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("p",{className:"font-medium",children:e.name}),Nt.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Nt.jsxs("span",{className:"text-sm font-mono bg-green-100 dark:bg-green-900 px-2 py-1 rounded text-green-700 dark:text-green-300",children:["MAC: ",e.serialNumber]}),Nt.jsx("span",{className:"text-xs text-gray-500 uppercase",children:e.type})]})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:t=>{t.stopPropagation(),F(e)},className:"text-green-600 hover:text-green-700 text-sm",children:"Connect"}),Nt.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=k.filter(t=>t.id!==e);E(t),localStorage.setItem("tellerPrinters",JSON.stringify(t)),(null==_?void 0:_.id)===e&&A(null)})(e.id)},className:"text-red-500 hover:text-red-700 text-sm",children:"Remove"})]})]})},e.id))})]}),Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Nt.jsx("h3",{className:"font-medium",children:" Available Printers"}),Nt.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 px-2 py-1 rounded",children:" Check Serial Number!"})]}),Nt.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-3 mb-3",children:[Nt.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[Nt.jsx("span",{className:"font-semibold",children:" Important:"})," Multiple printers detected. Verify the ",Nt.jsx("strong",{children:"serial number"})," matches your assigned printer to avoid printing to another teller's printer."]}),Nt.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:["Your printer MAC: ",Nt.jsx("span",{className:"font-mono bg-yellow-100 dark:bg-yellow-800 px-1 rounded",children:"10:22:4B:3C:75"})]})]}),0===U.length?Nt.jsx("p",{className:"text-gray-500 text-center py-4",children:w?"No printers found matching your search.":"No printers found. Click 'Scan for Printers' to search."}):Nt.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:U.map(e=>{const t="10:22:4B:3C:75"===e.serialNumber||"10:22:4B:3C:75"===e.macAddress;return Nt.jsx("div",{className:"p-3 rounded border cursor-pointer transition-colors "+(t?i?"bg-green-900/30 border-green-500 ring-2 ring-green-400":"bg-green-50 border-green-300 ring-2 ring-green-400":(null==_?void 0:_.id)===e.id?i?"bg-indigo-900/30 border-indigo-500":"bg-indigo-50 border-indigo-300":i?"bg-gray-700 border-gray-600 hover:bg-gray-600":"bg-gray-50 border-gray-200 hover:bg-gray-100"),onClick:()=>F(e),children:Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("p",{className:"font-medium",children:e.name}),t&&Nt.jsx("span",{className:"text-xs bg-green-600 text-white px-2 py-1 rounded-full",children:"YOUR PRINTER"})]}),Nt.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Nt.jsxs("span",{className:"text-sm font-mono px-2 py-1 rounded "+(t?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 font-bold":"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300"),children:["MAC: ",e.serialNumber]}),e.macAddress&&e.macAddress!==e.serialNumber&&Nt.jsxs("span",{className:"text-xs text-gray-500 font-mono",children:["Alt: ",e.macAddress]}),e.vendorId&&Nt.jsxs("span",{className:"text-xs text-gray-500",children:["VID: ",e.vendorId.toString(16).toUpperCase()]}),Nt.jsx("span",{className:"text-xs text-gray-500 uppercase",children:e.type})]})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{className:"w-3 h-3 rounded-full "+(e.connected?"bg-green-500":"bg-gray-400")}),Nt.jsx("span",{className:"text-xs mr-2",children:e.connected?"Connected":"Available"}),Nt.jsx("button",{onClick:t=>{t.stopPropagation(),F(e)},className:"px-3 py-1 text-xs rounded-md font-medium transition-colors "+((null==_?void 0:_.id)===e.id?"bg-green-600 text-white hover:bg-green-700":"bg-blue-600 text-white hover:bg-blue-700"),children:(null==_?void 0:_.id)===e.id?" Selected":" Connect"})]})]})},e.id)})})]}),Nt.jsxs("div",{className:"mt-4 p-3 rounded text-xs "+(i?"bg-blue-900/20 text-blue-300":"bg-blue-50 text-blue-600"),children:[Nt.jsx("p",{className:"font-medium mb-1",children:" Instructions:"}),Nt.jsxs("ul",{className:"space-y-1",children:[Nt.jsx("li",{children:" Search for your printer by name or MAC address"}),Nt.jsx("li",{children:' Click "Scan for Printers" to find nearby Bluetooth devices'}),Nt.jsx("li",{children:" Select a printer to save it for future use"}),Nt.jsx("li",{children:" Your selected printer will be used for all prints"})]})]}),!("bluetooth"in navigator)&&Nt.jsxs("div",{className:"mt-2 p-3 rounded text-xs "+(i?"bg-red-900/20 text-red-300":"bg-red-50 text-red-600"),children:[Nt.jsx("p",{className:"font-medium mb-1",children:" Bluetooth Not Available:"}),Nt.jsxs("ul",{className:"space-y-1",children:[Nt.jsx("li",{children:" Use Chrome, Edge, or Opera browser"}),Nt.jsx("li",{children:" Ensure site is accessed via HTTPS"}),Nt.jsx("li",{children:" Enable Bluetooth on your device"}),Nt.jsx("li",{children:" Try on Windows 10+, Android, or macOS"})]})]}),"bluetooth"in navigator&&Nt.jsxs("div",{className:"mt-2 p-3 rounded text-xs "+(i?"bg-green-900/20 text-green-300":"bg-green-50 text-green-600"),children:[Nt.jsx("p",{className:"font-medium mb-1",children:" Bluetooth Available:"}),Nt.jsxs("ul",{className:"space-y-1",children:[Nt.jsx("li",{children:" Turn on your thermal printer"}),Nt.jsx("li",{children:" Make printer discoverable/pairing mode"}),Nt.jsx("li",{children:" Click scan and select from browser dialog"}),Nt.jsx("li",{children:" If no devices appear, check printer manual"})]})]})]})})]})}function KL({selected:e,onCancel:t,onSave:n}){var r,a,i,s;const[o,d]=f.useState({systemBalance:null!=(r=e.systemBalance)?r:"",cashOnHand:null!=(a=e.cashOnHand)?a:"",over:null!=(i=e.over)?i:"",short:null!=(s=e.short)?s:"",date:e.createdAt?new Date(e.createdAt).toISOString().slice(0,10):e.date?new Date(e.date).toISOString().slice(0,10):"",remarks:e.remarks||""}),u=e=>{const{name:t,value:n}=e.target;d(e=>{const r=c(l({},e),{[t]:n});if("systemBalance"===t||"cashOnHand"===t){const{over:e,short:t}=((e,t)=>{const n=Number(e||0),r=Number(t||0),a=Number((r-n).toFixed(2));return isNaN(a)?{over:"",short:""}:a>0?{over:a.toFixed(2),short:""}:a<0?{over:"",short:Math.abs(a).toFixed(2)}:{over:"",short:""}})(r.systemBalance,r.cashOnHand);r.over=e,r.short=t}return r})};return Nt.jsxs("form",{onSubmit:e=>{e.preventDefault(),n(o)},className:"space-y-4 p-4 border rounded bg-gray-50 dark:bg-gray-900",children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Edit Teller Report"}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"System Balance"}),Nt.jsx("input",{type:"number",name:"systemBalance",value:o.systemBalance,onChange:u,className:"input-box w-full"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"Cash On Hand"}),Nt.jsx("input",{type:"number",name:"cashOnHand",value:o.cashOnHand,onChange:u,className:"input-box w-full"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"Over"}),Nt.jsx("input",{type:"number",name:"over",value:o.over,onChange:u,className:"input-box w-full"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"Short"}),Nt.jsx("input",{type:"number",name:"short",value:o.short,onChange:u,className:"input-box w-full"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"Date"}),Nt.jsx("input",{type:"date",name:"date",value:o.date,onChange:u,className:"input-box w-full"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"Remarks"}),Nt.jsx("input",{type:"text",name:"remarks",value:o.remarks,onChange:u,className:"input-box w-full"})]}),Nt.jsxs("div",{className:"flex gap-3 mt-4",children:[Nt.jsx("button",{type:"submit",className:"bg-green-600 text-white px-4 py-2 rounded",children:"Save"}),Nt.jsx("button",{type:"button",className:"bg-gray-400 text-white px-4 py-2 rounded",onClick:t,children:"Cancel"})]})]})}function qL(){var e,t;const{user:n,settings:r}=f.useContext($c),{showToast:a}=Kc(),i="dark"===(null==(e=null==r?void 0:r.theme)?void 0:e.mode),[s,o]=f.useState([]),[d,u]=f.useState(null),[p,m]=f.useState(!1),[g,x]=f.useState(!1),[y,v]=f.useState(!1),[b,w]=f.useState(""),[N,S]=f.useState({date:"",enabled:!1}),[j,_]=f.useState("all"),[A,C]=f.useState(1),M=f.useMemo(()=>{let e=0,t=0;for(const r of s)e+=Number(r.systemBalance||0),t+=Number(r.cashOnHand||r.totalFromDenom||0);const n=t-e;return{totalSystemBalance:e,totalCashOnHand:t,totalOver:n>0?n:0,totalShort:n<0?Math.abs(n):0}},[s]),k=f.useMemo(()=>{let e=s;if(b.trim()){const t=b.toLowerCase();e=e.filter(e=>(e.tellerName||"").toLowerCase().includes(t))}return"short"===j?e=e.filter(e=>Number(e.short||0)>0):"over"===j&&(e=e.filter(e=>Number(e.over||0)>0)),e},[s,b,j]),E=e=>{var t,n,r,a,i,s,o,c,d,u,h,p,m,g,f,x,y,v,b,w,N,S,j,_,A,C,M,k,E,T,P,D,R,I,O,B,L,F,U;if(!e)return null;const z=l({},e);z.userId=e.userId||e.tellerId||z.userId,z._id=e._id||z._id,z.verified=null!=(n=null!=(t=e.verified)?t:e.isVerified)&&n,z.approved=null!=(a=null!=(r=e.approved)?r:e.isApproved)&&a,z.tellerName=e.tellerName||(null==(i=e.tellerId)?void 0:i.name)||(null==(s=e.tellerId)?void 0:s.username)||z.tellerName,z.pcs1000=Number(null!=(u=null!=(d=null!=(c=null!=(o=e.pcs1000)?o:e.pcs_1000)?c:e.d1000)?d:e.pcs1000)?u:0),z.pcs500=Number(null!=(m=null!=(p=null!=(h=e.pcs500)?h:e.pcs_500)?p:e.d500)?m:0),z.pcs200=Number(null!=(x=null!=(f=null!=(g=e.pcs200)?g:e.pcs_200)?f:e.d200)?x:0),z.pcs100=Number(null!=(b=null!=(v=null!=(y=e.pcs100)?y:e.pcs_100)?v:e.d100)?b:0),z.pcs50=Number(null!=(S=null!=(N=null!=(w=e.pcs50)?w:e.pcs_50)?N:e.d50)?S:0),z.pcs20=Number(null!=(A=null!=(_=null!=(j=e.pcs20)?j:e.pcs_20)?_:e.d20)?A:0),z.coins=Number(null!=(M=null!=(C=e.coins)?C:e.pcsCoins)?M:0),z.shortPaymentTerms=Number(null!=(k=e.shortPaymentTerms)?k:1),z.d1000=z.pcs1000,z.d500=z.pcs500,z.d200=z.pcs200,z.d100=z.pcs100,z.d50=z.pcs50,z.d20=z.pcs20,z.totalFromDenom=Number(null!=(T=null!=(E=e.totalFromDenom)?E:e.totalDenomination)?T:0)||1e3*z.pcs1000+500*z.pcs500+200*z.pcs200+100*z.pcs100+50*z.pcs50+20*z.pcs20+z.coins,z.cashOnHand=Number(null!=(R=null!=(D=null!=(P=e.cashOnHand)?P:e.cash_on_hand)?D:e.totalFromDenom)?R:z.totalFromDenom);const H=Number(null!=(O=null!=(I=e.systemBalance)?I:e.system_balance)?O:0);return null==e.short&&null==e.over?H>0?z.cashOnHand>H?(z.over=(z.cashOnHand-H).toFixed(2),z.short=""):z.cashOnHand<H?(z.short=(H-z.cashOnHand).toFixed(2),z.over=""):(z.short="",z.over=""):(z.short=null!=(B=z.short)?B:"",z.over=null!=(L=z.over)?L:""):(z.short=Number(null!=(F=e.short)?F:0),z.over=Number(null!=(U=e.over)?U:0)),z},T=()=>h(null,null,function*(){var e,t,r,i;try{x(!0);const a=new URLSearchParams;N.enabled&&N.date&&a.append("date",N.date);const i=a.toString(),s=i?`?${i}`:"";if("admin"===(null==n?void 0:n.role)||"super_admin"===(null==n?void 0:n.role)){const t=yield pt.get(`${zc()}/api/teller-reports/all${s}`),n=(Array.isArray(t.data)?t.data:(null==(e=t.data)?void 0:e.reports)||[]).map(e=>{var t;const n=(null==(t=e.tellerId)?void 0:t._id)||e.tellerId||e.userId;return E(c(l({},e),{userId:n}))}).filter(e=>e.userId);o(n)}else if("supervisor"===(null==n?void 0:n.role)){const e=yield pt.get(`${zc()}/api/teller-reports/supervisor/${n._id}${s}`),a=(Array.isArray(e.data)?e.data:(null==(t=e.data)?void 0:t.tellers)||(null==(r=e.data)?void 0:r.reports)||[]).map(e=>{var t;const n=(null==(t=e.tellerId)?void 0:t._id)||e.tellerId||e.userId;return E(c(l({},e),{userId:n}))}).filter(e=>e.userId);o(a)}else o([])}catch(s){console.error("Failed to fetch teller list:",(null==(i=null==s?void 0:s.response)?void 0:i.data)||s.message,s),a({type:"error",message:"Failed to load tellers"})}finally{x(!1)}});f.useEffect(()=>{T();const e=()=>{T(),(null==d?void 0:d._id)&&P(d._id)},t=Vc();if(t)return t.on("reportUpdated",e),t.on("tellerReportCreated",e),t.on("tellerManagementUpdated",e),t.on("reportDeleted",e),()=>{t.off("reportUpdated",e),t.off("tellerReportCreated",e),t.off("tellerManagementUpdated",e),t.off("reportDeleted",e)}},[null==n?void 0:n._id]);const P=e=>h(null,null,function*(){var t;try{m(!0);const t=s.find(t=>t._id===e);if(t){const e=E(t);u(e),C(Number(e.shortPaymentTerms)||1)}else{const t=yield pt.get(`${zc()}/api/teller-reports/report/${e}`),n=t.data?E(t.data):null;u(n),C(Number(null==n?void 0:n.shortPaymentTerms)||1)}}catch(n){console.error("Failed to fetch details:",(null==(t=null==n?void 0:n.response)?void 0:t.data)||n.message),a({type:"error",message:"Failed to load details"})}finally{m(!1)}});return Nt.jsxs("div",{className:"flex gap-6 p-6 min-h-screen "+(i?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"w-80 bg-white dark:bg-gray-800 border rounded p-3 overflow-y-auto",children:[Nt.jsxs("div",{className:"p-3 rounded mb-3 "+(i?"bg-gray-700":"bg-gray-100"),children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[Nt.jsx(W,{className:"w-4 h-4"}),Nt.jsx("span",{className:"font-medium text-sm",children:"Date Filter"}),Nt.jsxs("label",{className:"ml-auto flex items-center gap-2",children:[Nt.jsx("input",{type:"checkbox",checked:N.enabled,onChange:e=>S(t=>c(l({},t),{enabled:e.target.checked})),className:"rounded"}),Nt.jsx("span",{className:"text-xs",children:"Enable"})]})]}),Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Date:"}),Nt.jsx("input",{type:"date",value:N.date,onChange:e=>S(t=>c(l({},t),{date:e.target.value})),disabled:!N.enabled,className:`w-full text-xs p-2 border rounded ${i?"bg-gray-800 border-gray-600":"bg-white border-gray-300"} ${N.enabled?"":"opacity-50"}`})]}),Nt.jsxs("button",{onClick:()=>T(),disabled:!N.enabled,className:"w-full text-xs px-3 py-2 rounded flex items-center justify-center gap-2 "+(N.enabled?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:[Nt.jsx(he,{className:"w-3 h-3"}),"Apply Filter"]})]})]}),Nt.jsx("div",{className:"mb-3",children:Nt.jsxs("div",{className:"relative",children:[Nt.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 "+(i?"text-gray-400":"text-gray-500")}),Nt.jsx("input",{type:"text",placeholder:"Search by teller name...",value:b,onChange:e=>w(e.target.value),className:"w-full text-sm pl-10 pr-4 py-2 border rounded "+(i?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300")})]})}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Filter by:"}),Nt.jsxs("select",{value:j,onChange:e=>_(e.target.value),className:"w-full text-sm p-2 border rounded "+(i?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"all",children:"All Reports"}),Nt.jsx("option",{value:"short",children:"Short Only"}),Nt.jsx("option",{value:"over",children:"Over Only"})]})]}),Nt.jsxs("div",{className:"p-3 rounded mb-3 "+(i?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"text-xs font-medium mb-2",children:"Aggregated Totals"}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Nt.jsx("div",{children:"System Balance:"}),Nt.jsxs("div",{className:"text-right",children:["",Number(M.totalSystemBalance||0).toLocaleString()]}),Nt.jsx("div",{children:"Cash On Hand:"}),Nt.jsxs("div",{className:"text-right",children:["",Number(M.totalCashOnHand||0).toLocaleString()]}),Nt.jsx("div",{children:"Over:"}),Nt.jsxs("div",{className:"text-right text-green-600",children:["",Number(M.totalOver||0).toLocaleString()]}),Nt.jsx("div",{children:"Short:"}),Nt.jsxs("div",{className:"text-right text-red-600",children:["",Number(M.totalShort||0).toLocaleString()]})]})]}),Nt.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Nt.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[Nt.jsx(me,{})," Tellers"]}),("admin"===(null==n?void 0:n.role)||"super_admin"===(null==n?void 0:n.role))&&Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t,n;if(window.confirm("Approve all currently listed reports?"))try{for(const n of s){if(!n.userId)continue;const r=null==(t=null==(e=(yield pt.get(`${zc()}/api/teller-reports/teller/${n.userId}`)).data)?void 0:e.reports)?void 0:t[0];(null==r?void 0:r._id)&&(yield pt.put(`${zc()}/api/teller-reports/report/${r._id}/approve`))}a({type:"success",message:"All reports approved"}),T()}catch(r){console.error("Approve all failed:",(null==(n=null==r?void 0:r.response)?void 0:n.data)||r.message),a({type:"error",message:"Failed to approve all"})}}),className:"text-xs bg-green-600 px-2 py-1 rounded text-white",children:"Approve All"})]}),g?Nt.jsx("div",{className:"py-6 text-center",children:"Loading..."}):Nt.jsx("div",{className:"space-y-2",children:0===k.length?Nt.jsx("div",{className:"text-sm text-gray-500",children:b?"No tellers match your search.":"No teller reports found."}):k.map(e=>{const t=e._id?`${e.userId}-${e._id}`:`${e.userId}`;return Nt.jsxs("div",{onClick:()=>P(e._id),className:`p-3 rounded cursor-pointer border ${(null==d?void 0:d._id)===e._id?"bg-indigo-600 text-white":i?"bg-gray-800":"bg-white"} `,children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("div",{className:"font-medium",children:e.tellerName||e.tellerName}),Nt.jsx("div",{className:"text-sm",children:e.verified?Nt.jsx("span",{className:"text-green-300",children:"Verified"}):e.approved?Nt.jsx("span",{className:"text-indigo-300",children:"Approved"}):Nt.jsx("span",{className:"text-yellow-400",children:"Pending"})})]}),Nt.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Cash: ",Number(e.cashOnHand||e.totalFromDenom||0).toLocaleString()]}),Nt.jsx("div",{className:"text-xs opacity-60 mt-1",children:new Date(e.createdAt||e.date).toLocaleDateString()})]},t)})})]}),Nt.jsx("div",{className:"flex-1",children:Nt.jsxs("div",{className:"rounded p-4 border "+(i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("div",{children:[Nt.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[Nt.jsx(z,{})," Teller Report"]}),Nt.jsx("div",{className:"text-sm text-gray-400",children:"Select a teller on the left to view details"})]}),Nt.jsx("div",{className:"flex gap-2",children:d&&Nt.jsxs(Nt.Fragment,{children:["supervisor"===(null==n?void 0:n.role)&&!d.verified&&Nt.jsxs("button",{onClick:()=>(d._id,h(null,null,function*(){var e;try{if(!(null==d?void 0:d._id))return a({type:"error",message:"No report selected"});yield pt.put(`${zc()}/api/teller-reports/report/${d._id}/verify`),a({type:"success",message:"Report verified"}),u(e=>c(l({},e),{verified:!0,isVerified:!0,isPending:!1})),T()}catch(t){console.error("Verify failed:",(null==(e=null==t?void 0:t.response)?void 0:e.data)||t.message),a({type:"error",message:"Failed to verify"})}})),className:"bg-green-600 px-3 py-1 rounded text-white flex items-center gap-2",children:[Nt.jsx(O,{})," Verify"]}),("admin"===(null==n?void 0:n.role)||"super_admin"===(null==n?void 0:n.role))&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("button",{onClick:()=>v(!0),className:"bg-blue-600 px-3 py-1 rounded text-white flex items-center gap-2",children:"Edit"}),Nt.jsx("button",{onClick:()=>(d._id,h(null,null,function*(){var e;try{if(!(null==d?void 0:d._id))return a({type:"error",message:"No report selected"});yield pt.put(`${zc()}/api/teller-reports/report/${d._id}/approve`),a({type:"success",message:"Report approved"}),u(e=>c(l({},e),{approved:!0,isApproved:!0,isPending:!1})),T()}catch(t){console.error("Approve failed:",(null==(e=null==t?void 0:t.response)?void 0:e.data)||t.message),a({type:"error",message:"Failed to approve"})}})),className:"bg-indigo-600 px-3 py-1 rounded text-white flex items-center gap-2",children:"Approve"}),Nt.jsxs("button",{onClick:()=>(d._id,h(null,null,function*(){var e;try{if(!(null==d?void 0:d._id))return a({type:"error",message:"No report selected"});yield pt.put(`${zc()}/api/teller-reports/report/${d._id}/unlock`),a({type:"success",message:"Report unlocked"}),T(),P(d._id)}catch(t){console.error("Unlock failed:",(null==(e=null==t?void 0:t.response)?void 0:e.data)||t.message),a({type:"error",message:"Failed to unlock"})}})),className:"bg-yellow-500 px-3 py-1 rounded text-white flex items-center gap-2",children:[Nt.jsx(ge,{})," Unlock"]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e;if(!(null==d?void 0:d._id))return void a({type:"error",message:"No report selected"});if(window.confirm("Delete this report? This cannot be undone."))try{yield pt.delete(`${zc()}/api/teller-reports/${d._id}`,{data:{adminId:null==n?void 0:n._id,reason:"Admin delete from Reports Viewer"}}),a({type:"info",message:"Report deleted"});const e=d.userId;u(null),T(),e&&P(e)}catch(t){console.error("Delete failed:",(null==(e=null==t?void 0:t.response)?void 0:e.data)||t.message),a({type:"error",message:"Failed to delete report"})}}),className:"bg-red-700 px-3 py-1 rounded text-white flex items-center gap-2",children:[Nt.jsx(R,{})," Delete"]})]})]})})]}),p?Nt.jsx("div",{children:"Loading details..."}):d?y?Nt.jsx(KL,{selected:d,onCancel:()=>v(!1),onSave:e=>h(null,null,function*(){try{yield pt.put(`${zc()}/api/reports/teller/${d._id}`,e),a({type:"success",message:"Report updated"}),v(!1),T(),P(d.userId)}catch(t){a({type:"error",message:"Failed to update report"})}})}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"mb-2",children:[Nt.jsx("strong",{children:"Teller:"})," ",d.tellerName||d.userId]}),Nt.jsxs("div",{className:"mb-2",children:[Nt.jsx("strong",{children:"Date:"})," ",(e=>{if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}catch(bI){return"-"}})(d.createdAt||d.date)]}),Nt.jsxs("div",{className:"mb-2",children:[Nt.jsx("strong",{children:"System Balance:"})," ",Number(d.systemBalance||0).toLocaleString()]}),Nt.jsxs("div",{className:"mb-2",children:[Nt.jsx("strong",{children:"Cash On Hand:"})," ",Number(d.cashOnHand||d.totalFromDenom||0).toLocaleString()]}),Nt.jsxs("div",{className:"mb-2",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("strong",{children:"Short:"}),Nt.jsxs("span",{className:"text-red-600",children:["",Number(d.short||0).toLocaleString()]})]}),"super_admin"===(null==n?void 0:n.role)&&d.short>0&&Nt.jsxs("div",{className:"flex flex-col gap-1 mt-1 ml-4",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("label",{className:"text-xs text-gray-500",children:"Payment Terms (weeks):"}),Nt.jsx("input",{type:"number",min:"1",value:A,onChange:e=>{const t=Math.max(1,Number(e.target.value)||1);C(t)},onBlur:e=>{var t,n;t=d._id,n=e.target.value,h(null,null,function*(){var e;try{const e=Number(n||1);if(e<1)return a({type:"warning",message:"Payment terms must be at least 1"}),void C((null==d?void 0:d.shortPaymentTerms)||1);if(e===((null==d?void 0:d.shortPaymentTerms)||1))return;yield pt.put(`${zc()}/api/reports/teller/${t}`,{shortPaymentTerms:e}),a({type:"success",message:`Payment terms set to ${e} weeks`}),d&&u(c(l({},d),{shortPaymentTerms:e})),T()}catch(r){console.error("Update payment terms failed:",(null==(e=null==r?void 0:r.response)?void 0:e.data)||r.message),a({type:"error",message:"Failed to update payment terms"}),(null==d?void 0:d.shortPaymentTerms)&&C(Number(d.shortPaymentTerms)||1)}})},className:"w-20 px-2 py-1 text-xs rounded border "+(i?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-300")})]}),Nt.jsxs("div",{className:"text-xs",children:[Nt.jsx("span",{className:"text-gray-500",children:"Weekly deduction:"}),Nt.jsxs("span",{className:"ml-1 font-semibold "+(i?"text-red-400":"text-red-600"),children:["",(Number(d.short||0)/A).toFixed(2)]}),Nt.jsxs("span",{className:"text-gray-500 ml-1",children:["per week for ",A," ",1===A?"week":"weeks"]})]})]})]}),Nt.jsxs("div",{className:"mb-2",children:[Nt.jsx("strong",{children:"Over:"})," ",Number(d.over||0).toLocaleString()]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"mb-2",children:Nt.jsx("strong",{children:"Denominations"})}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Nt.jsxs("div",{children:["1000: ",Number(d.pcs1000||d.d1000||0)]}),Nt.jsxs("div",{children:["500: ",Number(d.pcs500||d.d500||0)]}),Nt.jsxs("div",{children:["200: ",Number(d.pcs200||d.d200||0)]}),Nt.jsxs("div",{children:["100: ",Number(d.pcs100||d.d100||0)]}),Nt.jsxs("div",{children:["50: ",Number(d.pcs50||d.d50||0)]}),Nt.jsxs("div",{children:["20: ",Number(d.pcs20||d.d20||0)]}),Nt.jsxs("div",{children:["Coins: ",Number(d.coins||d.pcsCoins||0).toLocaleString()]}),Nt.jsxs("div",{children:["Total Denomination: ",Number(d.totalFromDenom||d.totalDenomination||0).toLocaleString()]})]})]})]}),Nt.jsxs("div",{className:"mt-4",children:[Nt.jsx("label",{className:"block text-sm mb-1",children:"Admin - Total Bet (manual)"}),Nt.jsxs("div",{className:"flex gap-2 items-center",children:[Nt.jsx("input",{defaultValue:null!=(t=d.totalBet)?t:"",onBlur:e=>{return t=d.userId,n=e.target.value,h(null,null,function*(){var e;try{yield pt.put(`${zc()}/api/reports/supervisor/update-bet/${t}`,{totalBet:Number(n||0)}),a({type:"success",message:"Total Bet updated"}),T(),P(t)}catch(r){console.error("Update total bet failed:",(null==(e=null==r?void 0:r.response)?void 0:e.data)||r.message),a({type:"error",message:"Failed to update Total Bet"})}});var t,n},className:"input-box w-48",type:"number"}),Nt.jsx("div",{className:"text-sm text-gray-500",children:"Points = TotalBet / 1000 (calculated on backend)"})]})]}),Nt.jsxs("div",{className:"mt-6 flex gap-3",children:[d.verified&&Nt.jsx("div",{className:"px-3 py-1 bg-green-600 text-white rounded",children:"Verified"}),d.approved&&Nt.jsx("div",{className:"px-3 py-1 bg-indigo-600 text-white rounded",children:"Approved"}),!d.verified&&!d.approved&&Nt.jsx("div",{className:"px-3 py-1 bg-yellow-400 text-black rounded",children:"Pending"})]})]}):Nt.jsx("div",{className:"text-sm text-gray-400",children:"Pick a teller to view their latest report."})]})})]})}function JL(){var e;const{user:t,settings:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),[i,s]=f.useState([]),[o,l]=f.useState(!0),[c,d]=f.useState(null),[u,p]=f.useState(""),[m,g]=f.useState("");f.useEffect(()=>{(null==t?void 0:t._id)&&x()},[null==t?void 0:t._id]);const x=()=>h(null,null,function*(){var e;try{l(!0);const n=new URLSearchParams;u&&n.append("fromDate",u),m&&n.append("toDate",m);const r=n.toString()?`?${n.toString()}`:"",a=yield pt.get(`${zc()}/api/teller-reports/teller/${t._id}${r}`);s((null==(e=a.data)?void 0:e.reports)||[])}catch(n){console.error("Error fetching reports:",n),r({type:"error",message:"Failed to load reports"})}finally{l(!1)}}),y=f.useMemo(()=>({totalReports:i.length,totalOver:i.reduce((e,t)=>e+(t.over||0),0),totalShort:i.reduce((e,t)=>e+(t.short||0),0),avgSystemBalance:i.length>0?i.reduce((e,t)=>e+(t.systemBalance||0),0)/i.length:0}),[i]),v=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},b=e=>`${(e||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`;return Nt.jsxs("div",{className:"p-6 min-h-screen "+(a?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[Nt.jsx(z,{className:"w-6 h-6"}),"My Report History"]}),Nt.jsx("p",{className:"text-sm opacity-70 mt-1",children:"View your submitted teller reports"})]}),Nt.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[Nt.jsx("div",{className:"p-4 rounded-lg shadow "+(a?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Total Reports"}),Nt.jsx("div",{className:"text-2xl font-bold",children:y.totalReports})]}),Nt.jsx(z,{className:"w-8 h-8 opacity-50"})]})}),Nt.jsx("div",{className:"p-4 rounded-lg shadow "+(a?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Total Over"}),Nt.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:b(y.totalOver)})]}),Nt.jsx(K,{className:"w-8 h-8 text-green-600 dark:text-green-400"})]})}),Nt.jsx("div",{className:"p-4 rounded-lg shadow "+(a?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Total Short"}),Nt.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:b(y.totalShort)})]}),Nt.jsx(fe,{className:"w-8 h-8 text-red-600 dark:text-red-400"})]})}),Nt.jsx("div",{className:"p-4 rounded-lg shadow "+(a?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Avg Balance"}),Nt.jsx("div",{className:"text-2xl font-bold",children:b(y.avgSystemBalance)})]}),Nt.jsx(xe,{className:"w-8 h-8 opacity-50"})]})})]}),Nt.jsx("div",{className:"p-4 rounded-lg shadow mb-6 "+(a?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex flex-col sm:flex-row items-end gap-3",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"From Date"}),Nt.jsx("input",{type:"date",value:u,onChange:e=>p(e.target.value),className:"w-full p-2 rounded border "+(a?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})]}),Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"To Date"}),Nt.jsx("input",{type:"date",value:m,onChange:e=>g(e.target.value),className:"w-full p-2 rounded border "+(a?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})]}),Nt.jsxs("button",{onClick:x,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 flex items-center gap-2",children:[Nt.jsx(W,{className:"w-4 h-4"}),"Filter"]}),(u||m)&&Nt.jsx("button",{onClick:()=>{p(""),g(""),x()},className:"px-4 py-2 rounded "+(a?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Clear"})]})}),Nt.jsx("div",{className:"rounded-lg shadow overflow-hidden "+(a?"bg-gray-800":"bg-white"),children:Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:""+(a?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-3 text-left",children:"Date"}),Nt.jsx("th",{className:"p-3 text-left",children:"Supervisor"}),Nt.jsx("th",{className:"p-3 text-right",children:"System Balance"}),Nt.jsx("th",{className:"p-3 text-right",children:"Cash on Hand"}),Nt.jsx("th",{className:"p-3 text-right",children:"Over"}),Nt.jsx("th",{className:"p-3 text-right",children:"Short"}),Nt.jsx("th",{className:"p-3 text-center",children:"Status"}),Nt.jsx("th",{className:"p-3 text-center",children:"Actions"})]})}),Nt.jsx("tbody",{children:o?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:8,className:"p-6 text-center opacity-70",children:"Loading reports..."})}):0===i.length?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:8,className:"p-6 text-center opacity-70",children:"No reports found for the selected period."})}):i.map(e=>Nt.jsxs("tr",{className:"border-t "+(a?"border-gray-700 hover:bg-gray-750":"border-gray-200 hover:bg-gray-50"),children:[Nt.jsx("td",{className:"p-3",children:v(e.date||e.createdAt)}),Nt.jsx("td",{className:"p-3",children:e.supervisorName||"N/A"}),Nt.jsx("td",{className:"p-3 text-right font-medium",children:b(e.systemBalance)}),Nt.jsx("td",{className:"p-3 text-right font-medium",children:b(e.cashOnHand)}),Nt.jsx("td",{className:"p-3 text-right text-green-600 dark:text-green-400 font-semibold",children:e.over>0?b(e.over):"-"}),Nt.jsx("td",{className:"p-3 text-right text-red-600 dark:text-red-400 font-semibold",children:e.short>0?b(e.short):"-"}),Nt.jsx("td",{className:"p-3 text-center",children:Nt.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(e.isApproved?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-100":e.isVerified?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-100":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-100"),children:e.isApproved?"Approved":e.isVerified?"Verified":"Pending"})}),Nt.jsx("td",{className:"p-3 text-center",children:Nt.jsxs("button",{onClick:()=>d(e),className:"px-3 py-1 rounded text-xs flex items-center gap-1 mx-auto "+(a?"bg-gray-700 hover:bg-gray-600 text-gray-100":"bg-gray-100 hover:bg-gray-200 text-gray-800"),children:[Nt.jsx(ye,{className:"w-3 h-3"}),"View"]})})]},e._id))})]})})}),c&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",children:Nt.jsxs("div",{className:"w-full max-w-2xl rounded-xl p-6 "+(a?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h3",{className:"text-lg font-semibold",children:"Report Details"}),Nt.jsx("button",{onClick:()=>d(null),className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700",children:""})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Date"}),Nt.jsx("div",{className:"font-semibold",children:v(c.date||c.createdAt)})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Supervisor"}),Nt.jsx("div",{className:"font-semibold",children:c.supervisorName||"N/A"})]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"System Balance"}),Nt.jsx("div",{className:"text-lg font-bold",children:b(c.systemBalance)})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Cash on Hand"}),Nt.jsx("div",{className:"text-lg font-bold",children:b(c.cashOnHand)})]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Over"}),Nt.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:b(c.over)})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Short"}),Nt.jsx("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:b(c.short)})]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70 mb-2",children:"Denominations"}),Nt.jsxs("div",{className:"grid grid-cols-4 gap-2 text-sm",children:[Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"1000"}),Nt.jsx("div",{className:"font-semibold",children:c.d1000||0})]}),Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"500"}),Nt.jsx("div",{className:"font-semibold",children:c.d500||0})]}),Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"200"}),Nt.jsx("div",{className:"font-semibold",children:c.d200||0})]}),Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"100"}),Nt.jsx("div",{className:"font-semibold",children:c.d100||0})]}),Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"50"}),Nt.jsx("div",{className:"font-semibold",children:c.d50||0})]}),Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"20"}),Nt.jsx("div",{className:"font-semibold",children:c.d20||0})]}),Nt.jsxs("div",{className:"p-2 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"opacity-70",children:"Coins"}),Nt.jsx("div",{className:"font-semibold",children:b(c.coins)})]})]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70 mb-1",children:"Status"}),Nt.jsx("span",{className:"px-3 py-1 rounded-full text-sm "+(c.isApproved?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-100":c.isVerified?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-100":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-100"),children:c.isApproved?" Approved":c.isVerified?" Verified":" Pending"})]}),c.remarks&&Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm opacity-70 mb-1",children:"Remarks"}),Nt.jsx("div",{className:"p-3 rounded "+(a?"bg-gray-700":"bg-gray-100"),children:c.remarks})]})]}),Nt.jsx("div",{className:"mt-6 flex justify-end",children:Nt.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Close"})})]})})]})}var QL,ZL={exports:{}};var eF=(QL||(QL=1,"undefined"!=typeof self&&self,ZL.exports=function(e){return function(){var t={155:function(t){t.exports=e}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};r.r(a),r.d(a,{useReactToPrint:function(){return g}});var i=r(155);const s="printWindow";function o({level:e="error",messages:t,suppressErrors:n=!1}){n||("error"===e?console.error(t):"warning"===e?console.warn(t):console.debug(t))}function l(e,t){if(t||!e){const e=document.getElementById(s);e&&document.body.removeChild(e)}}function c(e){return e instanceof Error?e:new Error("Unknown Error")}function d(e,t){const{documentTitle:n,onAfterPrint:r,onPrintError:a,preserveAfterPrint:i,print:s,suppressErrors:d}=t;setTimeout(()=>{var t,u;if(e.contentWindow){let h=function(){null==r||r(),l(i)};if(e.contentWindow.focus(),s)s(e).then(h).catch(e=>{a?a("print",c(e)):o({messages:["An error was thrown by the specified `print` function"],suppressErrors:d})});else{if(e.contentWindow.print){const r=null!==(u=null===(t=e.contentDocument)||void 0===t?void 0:t.title)&&void 0!==u?u:"",a=e.ownerDocument.title;n&&(e.ownerDocument.title=n,e.contentDocument&&(e.contentDocument.title=n)),e.contentWindow.print(),n&&(e.ownerDocument.title=a,e.contentDocument&&(e.contentDocument.title=r))}else o({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:d});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(e=>{var t,n;return(null!==(n=null!==(t=navigator.userAgent)&&void 0!==t?t:navigator.vendor)&&void 0!==n?n:"opera"in window&&window.opera).match(e)})?setTimeout(h,500):h()}}else o({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:d})},500)}function u(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null);let r=n.nextNode();for(;r;)t.push(r),r=n.nextNode();return t}function h(e,t,n){const r=u(e),a=u(t);if(r.length===a.length)for(let i=0;i<r.length;i++){const e=r[i],t=a[i],s=e.shadowRoot;if(null!==s){const e=t.attachShadow({mode:s.mode});e.innerHTML=s.innerHTML,h(s,e,n)}}else o({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",e,t],suppressErrors:n})}const p='\n    @page {\n        /* Remove browser default header (title) and footer (url) */\n        margin: 0;\n    }\n    @media print {\n        body {\n            /* Tell browsers to print background colors */\n            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */\n            print-color-adjust: exact; /* Firefox/Safari */\n            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */\n        }\n    }\n';function m(e,t,n,r){var a,i,s,l,u;const{contentNode:m,clonedContentNode:g,clonedImgNodes:f,clonedVideoNodes:x,numResourcesToLoad:y,originalCanvasNodes:v}=n,{bodyClass:b,fonts:w,ignoreGlobalStyles:N,pageStyle:S,nonce:j,suppressErrors:_,copyShadowRoots:A}=r;e.onload=null;const C=null!==(a=e.contentDocument)&&void 0!==a?a:null===(i=e.contentWindow)||void 0===i?void 0:i.document;if(C){const n=C.body.appendChild(g);A&&h(m,n,!!_),w&&((null===(s=e.contentDocument)||void 0===s?void 0:s.fonts)&&(null===(l=e.contentWindow)||void 0===l?void 0:l.FontFace)?w.forEach(n=>{const r=new FontFace(n.family,n.source,{weight:n.weight,style:n.style});e.contentDocument.fonts.add(r),r.loaded.then(()=>{t(r)}).catch(e=>{t(r,["Failed loading the font:",r,"Load error:",c(e)])})}):(w.forEach(e=>{t(e)}),o({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:_})));const r=null!=S?S:p,a=C.createElement("style");j&&(a.setAttribute("nonce",j),C.head.setAttribute("nonce",j)),a.appendChild(C.createTextNode(r)),C.head.appendChild(a),b&&C.body.classList.add(...b.split(" "));const i=C.querySelectorAll("canvas");for(let e=0;e<v.length;++e){const t=v[e],n=i[e];if(void 0===n){o({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",t],suppressErrors:_});continue}const r=n.getContext("2d");r&&r.drawImage(t,0,0)}for(let e=0;e<f.length;e++){const n=f[e],r=n.getAttribute("src");if(r){const e=new Image;e.onload=()=>{t(n)},e.onerror=(e,r,a,i,s)=>{t(n,["Error loading <img>",n,"Error",s])},e.src=r}else t(n,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',n])}for(let e=0;e<x.length;e++){const n=x[e];n.preload="auto";const r=n.getAttribute("poster");if(r){const e=new Image;e.onload=()=>{t(n)},e.onerror=(e,a,i,s,o)=>{t(n,["Error loading video poster",r,"for video",n,"Error:",o])},e.src=r}else n.readyState>=2?t(n):n.src?(n.onloadeddata=()=>{t(n)},n.onerror=(e,r,a,i,s)=>{t(n,["Error loading video",n,"Error",s])},n.onstalled=()=>{t(n,["Loading video stalled, skipping",n])}):t(n,["Error loading video, `src` is empty",n])}const d="select",y=m.querySelectorAll(d),k=C.querySelectorAll(d);for(let e=0;e<y.length;e++)k[e].value=y[e].value;if(!N){const e=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let n=0,r=e.length;n<r;++n){const r=e[n];if("style"===r.tagName.toLowerCase()){const e=C.createElement(r.tagName),t=r.sheet;if(t){let a="";try{const e=t.cssRules.length;for(let n=0;n<e;++n)"string"==typeof t.cssRules[n].cssText&&(a+=`${t.cssRules[n].cssText}\r\n`)}catch(M){o({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",r,`Original error: ${c(M).message}`],level:"warning"})}e.setAttribute("id",`react-to-print-${n}`),j&&e.setAttribute("nonce",j),e.appendChild(C.createTextNode(a)),C.head.appendChild(e)}}else if(r.getAttribute("href"))if(r.hasAttribute("disabled"))o({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",r],level:"warning"}),t(r);else{const e=C.createElement(r.tagName);for(let t=0,n=r.attributes.length;t<n;++t){const n=r.attributes[t];n&&e.setAttribute(n.nodeName,null!==(u=n.nodeValue)&&void 0!==u?u:"")}e.onload=()=>{t(e)},e.onerror=(n,r,a,i,s)=>{t(e,["Failed to load",e,"Error:",s])},j&&e.setAttribute("nonce",j),C.head.appendChild(e)}else o({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",r],level:"warning"}),t(r)}}}0===y&&d(e,r)}function g({bodyClass:e,contentRef:t,copyShadowRoots:n,documentTitle:r,fonts:a,ignoreGlobalStyles:u,nonce:h,onAfterPrint:p,onBeforePrint:g,onPrintError:f,pageStyle:x,preserveAfterPrint:y,print:v,printIframeProps:b,suppressErrors:w}){return(0,i.useCallback)(i=>{function N(){const l={bodyClass:e,contentRef:t,copyShadowRoots:n,documentTitle:r,fonts:a,ignoreGlobalStyles:u,nonce:h,onAfterPrint:p,onPrintError:f,pageStyle:x,preserveAfterPrint:y,print:v,suppressErrors:w},c=function(e){const t=document.createElement("iframe");return t.width=`${document.documentElement.clientWidth}px`,t.height=`${document.documentElement.clientHeight}px`,t.style.position="absolute",t.style.top=`-${document.documentElement.clientHeight+100}px`,t.style.left=`-${document.documentElement.clientWidth+100}px`,t.id=s,t.srcdoc="<!DOCTYPE html>",e&&(e.allow&&(t.allow=e.allow),void 0!==e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),void 0!==e.sandbox&&(t.sandbox=e.sandbox)),t}(b),g=function(e,t){const{contentRef:n,fonts:r,ignoreGlobalStyles:a,suppressErrors:i}=t,s=function({contentRef:e,optionalContent:t,suppressErrors:n}){return t&&"function"==typeof t?(e&&o({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),t()):e?e.current:void o({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:n})}({contentRef:n,optionalContent:e,suppressErrors:i});if(!s)return;const l=s.cloneNode(!0),c=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),d=l.querySelectorAll("img"),u=l.querySelectorAll("video"),h=r?r.length:0;return{contentNode:s,clonedContentNode:l,clonedImgNodes:d,clonedVideoNodes:u,numResourcesToLoad:(a?0:c.length)+d.length+u.length+h,originalCanvasNodes:s.querySelectorAll("canvas")}}(i,l);if(!g)return void o({messages:["There is nothing to print"],suppressErrors:w});const N=function(e,t,n){const{suppressErrors:r}=e,a=[],i=[];return function(s,l){a.includes(s)?o({level:"debug",messages:["Tried to mark a resource that has already been handled",s],suppressErrors:r}):(l?(o({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...l],suppressErrors:r}),i.push(s)):a.push(s),a.length+i.length===t&&d(n,e))}}(l,g.numResourcesToLoad,c);var S,j,_,A;j=N,_=g,A=l,(S=c).onload=()=>{m(S,j,_,A)},document.body.appendChild(S)}l(y,!0),g?g().then(()=>{N()}).catch(e=>{null==f||f("onBeforePrint",c(e))}):N()},[e,t,n,r,a,u,h,p,g,f,x,y,v,w])}return a}()}(p())),ZL.exports);function tF({userRole:e="teller"}){var t;const{settings:n}=f.useContext($c),r=(null==n?void 0:n.theme)||{},a="dark"===(null==(t=null==n?void 0:n.theme)?void 0:t.mode),{showToast:i}=(null==Kc?void 0:Kc())||{},s=f.useRef(),[o,d]=f.useState([]),[u,p]=f.useState({first:"1000 Worth of Gift Check",second:"700 Worth of Gift Check",third:"500 Worth of Gift Check"}),[m,g]=f.useState(!0),[x,y]=f.useState(!1),v=eF.useReactToPrint({content:()=>s.current}),b=()=>h(null,null,function*(){var e,t,n;try{const r=yield pt.get(`${zc()}/api/employee/monthly`),a=Array.isArray(r.data)?r.data:(null==(e=r.data)?void 0:e.tellers)||(null==(t=r.data)?void 0:t.employees)||(null==(n=r.data)?void 0:n.data)||[];d(a)}catch(r){console.error(" Error fetching teller of the month data:",r),d([])}finally{g(!1),y(!1)}});f.useEffect(()=>{b();const e=Vc();if(e)return e.on("reportUpdated",()=>{y(!0),b(),i&&i({type:"info",message:"Leaderboard updated"})}),()=>{e.off("reportUpdated")}},[]);return m?Nt.jsx("div",{className:"flex justify-center items-center min-h-screen",style:{backgroundColor:a?r.darkBg:r.lightBg,color:a?r.darkFont:r.lightFont},children:Nt.jsx("p",{className:"animate-pulse",children:"Loading Teller of the Month data..."})}):Nt.jsxs("div",{className:"min-h-screen p-6 transition-all",style:{backgroundColor:a?r.darkBg:r.lightBg,color:a?r.darkFont:r.lightFont},children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h1",{className:"text-3xl font-bold text-indigo-600",children:" Teller of the Month"}),x&&Nt.jsx("span",{className:"text-sm text-gray-400 animate-pulse",children:"Refreshing leaderboard..."})]}),("admin"===e||"super_admin"===e)&&Nt.jsxs("div",{className:"rounded-xl shadow-md p-5 mb-6",style:{backgroundColor:a?"#071026":"#fff"},children:[Nt.jsx("h2",{className:"text-xl font-semibold mb-4 text-indigo-500",children:"Prize Setup"}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["first","second","third"].map(e=>Nt.jsxs("div",{children:[Nt.jsxs("label",{className:"block font-medium capitalize mb-1",children:[e," Place Prize"]}),Nt.jsx("input",{type:"text",value:u[e],onChange:t=>{return n=e,r=t.target.value,void p(c(l({},u),{[n]:r}));var n,r},className:"w-full p-2 border rounded",style:{backgroundColor:a?r.darkBg:"#f9fafb",color:a?r.darkFont:"#111"}})]},e))}),Nt.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){try{yield pt.post(`${zc()}/api/employee/prizes`,u),i?i({type:"success",message:"Prizes updated successfully!"}):alert(" Prizes updated successfully!")}catch(e){console.error(" Error saving prizes:",e),i&&i({type:"error",message:"Failed to save prizes"})}}),className:"px-4 py-2 rounded-lg",style:{backgroundColor:a?"#111827":"#4f46e5",color:"#fff"},children:" Save Prizes"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(window.confirm("Reset Teller of the Month data for new month?"))try{yield pt.delete(`${zc()}/api/employee/reset`),d([]),i?i({type:"warning",message:"Teller data reset for new month"}):alert(" Teller data reset for new month!")}catch(e){console.error(" Error resetting data:",e),i&&i({type:"error",message:"Failed to reset data"})}}),className:"px-4 py-2 rounded-lg",style:{backgroundColor:a?"#7f1d1d":"#dc2626",color:"#fff"},children:" Reset Data"}),Nt.jsx("button",{onClick:v,className:"px-4 py-2 rounded-lg",style:{backgroundColor:a?"#064e3b":"#059669",color:"#fff"},children:" Print"})]})]}),Nt.jsxs("div",{ref:s,className:"rounded-xl shadow-md p-5",style:{backgroundColor:a?"#071026":"#fff"},children:[Nt.jsx("h2",{className:"text-xl font-semibold mb-3 text-indigo-500",children:"Leaderboard (Auto-ranked by Total Bet)"}),Array.isArray(o)&&o.length>0?Nt.jsxs("table",{className:"w-full border-collapse",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:"text-left text-sm uppercase tracking-wide",children:[Nt.jsx("th",{className:"p-2 border-b",children:"Rank"}),Nt.jsx("th",{className:"p-2 border-b",children:"Name"}),Nt.jsx("th",{className:"p-2 border-b",children:"Role"}),Nt.jsx("th",{className:"p-2 border-b",children:"Total Bet ()"}),Nt.jsx("th",{className:"p-2 border-b",children:"Prize"})]})}),Nt.jsx("tbody",{children:o.map((e,t)=>Nt.jsxs("tr",{className:"text-sm "+(0===t?"font-semibold text-yellow-500":""),children:[Nt.jsx("td",{className:"p-2 border-b",children:t+1}),Nt.jsx("td",{className:"p-2 border-b",children:e.name}),Nt.jsx("td",{className:"p-2 border-b capitalize",children:e.role}),Nt.jsxs("td",{className:"p-2 border-b",children:["",Number(e.totalBet||0).toLocaleString()]}),Nt.jsx("td",{className:"p-2 border-b",children:0===t?u.first:1===t?u.second:2===t?u.third:"-"})]},e._id||t))})]}):Nt.jsx("p",{className:"text-center text-gray-500 py-4",children:"No teller data available for this month yet."})]})]})}const nF=({active:e,payload:t,dark:n})=>{if(!e||!t||!t[0])return null;const r=t[0].payload;return r.salary>0?Nt.jsxs("div",{className:(n?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border rounded-lg p-3 shadow-lg",children:[Nt.jsxs("p",{className:"font-semibold mb-2",children:[r.day," - ",r.date]}),Nt.jsxs("div",{className:"space-y-1 text-sm",children:[Nt.jsxs("div",{className:"flex justify-between gap-4",children:[Nt.jsx("span",{className:"text-gray-500",children:"Base Salary:"}),Nt.jsxs("span",{className:"font-medium",children:["",r.baseSalary.toFixed(2)]})]}),r.over>0&&Nt.jsxs("div",{className:"flex justify-between gap-4",children:[Nt.jsx("span",{className:"text-green-600",children:"Over:"}),Nt.jsxs("span",{className:"font-medium text-green-600",children:["+",r.over.toFixed(2)]})]}),r.short>0&&Nt.jsxs("div",{className:"flex justify-between gap-4",children:[Nt.jsx("span",{className:"text-red-600",children:"Short:"}),Nt.jsxs("span",{className:"font-medium text-red-600",children:["-",r.short.toFixed(2)]})]}),r.deduction>0&&Nt.jsxs("div",{className:"flex justify-between gap-4",children:[Nt.jsx("span",{className:"text-orange-600",children:"Deduction:"}),Nt.jsxs("span",{className:"font-medium text-orange-600",children:["-",r.deduction.toFixed(2)]})]}),Nt.jsxs("div",{className:"border-t pt-1 mt-1 flex justify-between gap-4",children:[Nt.jsx("span",{className:"font-semibold",children:"Total:"}),Nt.jsxs("span",{className:"font-bold text-indigo-600",children:["",r.salary.toFixed(2)]})]})]})]}):null};function rF(){var e,t;const{user:n,settings:r}=f.useContext($c),{showToast:a}=Kc(),i="dark"===(null==(e=null==r?void 0:r.theme)?void 0:e.mode),[s,o]=f.useState([]),[l,c]=f.useState([]),[d,u]=f.useState(!0),[p,m]=f.useState(null),[g,x]=f.useState(!1),[y,v]=f.useState(!1),[b,w]=f.useState(!1),[N,S]=f.useState(""),[j,_]=f.useState([]),[A,C]=f.useState(!1),[M,k]=f.useState(0);console.log("Payroll component - user:",n),console.log("Payroll component - loading:",d);const E=(e=>{const t=new Date(e),n=t.getDay(),r=(0===n?-6:1)-n;return t.setDate(t.getDate()+r+7*M),t})(new Date),T=new Date(E);T.setDate(E.getDate()+6),T.setHours(23,59,59,999);const P=f.useMemo(()=>Array.from({length:7}).map((e,t)=>{const n=new Date(E);return n.setDate(E.getDate()+t),n}),[E]);f.useEffect(()=>{(null==n?void 0:n._id)&&(D(),"teller"===n.role&&R())},[null==n?void 0:n._id,M]),f.useEffect(()=>{const e=()=>D(),t=Vc();if(t)return t.on("withdrawalApproved",e),t.on("withdrawalRejected",e),t.on("payrollUpdated",e),()=>{t.off("withdrawalApproved",e),t.off("withdrawalRejected",e),t.off("payrollUpdated",e)}},[null==n?void 0:n._id]);const D=()=>h(null,null,function*(){var e,t,r;try{u(!0);let a=`${zc()}/api/payroll/user/${n._id}`;"supervisor"===n.role&&(a=`${zc()}/api/supervisor/payroll?supervisorId=${n._id}`);const[i,s]=yield Promise.all([pt.get(a,{timeout:3e4}),pt.get(`${zc()}/api/payroll/withdrawals/${n._id}`,{timeout:3e4})]);let l=[];l="supervisor"===n.role?(null==(e=i.data)?void 0:e.payrolls)||[]:(null==(t=i.data)?void 0:t.payrolls)||[],o(l),c((null==(r=s.data)?void 0:r.withdrawals)||[])}catch(i){console.error(" Error fetching payroll data:",i),a({type:"error",message:"Failed to load payroll data."})}finally{u(!1)}}),R=()=>h(null,null,function*(){var e;try{const t=(null==(e=(yield pt.get(`${zc()}/api/teller-reports/teller/${n._id}`,{timeout:3e4})).data)?void 0:e.reports)||[],r=new Date(T);r.setHours(23,59,59,999);const a=t.filter(e=>{const t=new Date(e.createdAt||e.date);return t>=E&&t<=r});_(a)}catch(t){console.error("Error fetching daily reports:",t),_([])}}),I=f.useMemo(()=>s.filter(e=>{const t=new Date(e.createdAt||e.date),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(E.getFullYear(),E.getMonth(),E.getDate()),a=new Date(T.getFullYear(),T.getMonth(),T.getDate());return n>=r&&n<=a}),[s,E,T]),O=f.useMemo(()=>I.filter(e=>!e.withdrawn),[I]).reduce((e,t)=>e+(Number(t.totalSalary)||0),0),B=Math.max(O-(parseFloat(N)||0),0),L=P.map(e=>{const t=I.find(t=>new Date(t.createdAt||t.date).toDateString()===e.toDateString()),n=t?Number(t.totalSalary):0;return{day:e.toLocaleDateString("en-US",{weekday:"short"}),date:e.toLocaleDateString("en-US",{month:"short",day:"numeric"}),salary:n,baseSalary:t?t.baseSalary:0,over:t?t.over:0,short:t?t.short:0,deduction:t?t.deduction:0}});return n?d?Nt.jsxs("div",{className:"flex justify-center mt-20 text-gray-400",children:[Nt.jsx(ue,{className:"animate-spin mr-2"})," Loading Payroll Dashboard..."]}):Nt.jsxs("div",{className:"p-6 min-h-screen "+(i?"bg-gray-950 text-gray-100":"bg-gray-50 text-gray-800"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Nt.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[Nt.jsx(Z,{className:"text-indigo-500"}),"Weekly Payroll Dashboard"]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:()=>k(e=>e-1),className:"p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-800",children:Nt.jsx(V,{})}),Nt.jsxs("p",{className:"text-sm opacity-70",children:[E.toLocaleDateString(),"  ",T.toLocaleDateString()]}),Nt.jsx("button",{onClick:()=>k(e=>e+1),className:"p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-800",children:Nt.jsx($,{})})]})]}),Nt.jsxs("div",{className:"mb-6",children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[Nt.jsx(be,{className:"text-indigo-500"})," Payroll This Week"]}),0===I.length?Nt.jsx("div",{className:"text-sm opacity-70",children:"No payrolls found for this week."}):Nt.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:I.map(e=>Nt.jsxs("div",{onClick:()=>{m(e),x(!0)},className:`cursor-pointer border rounded-lg p-3 ${e.withdrawn?i?"bg-gray-700 border-gray-600 opacity-60":"bg-gray-100 border-gray-300 opacity-60":i?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} hover:shadow`,children:[Nt.jsxs("div",{className:"text-xs opacity-70",children:[new Date(e.createdAt||e.date).toLocaleDateString(),e.withdrawn&&Nt.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-red-100 text-red-700 text-xs rounded",children:"Withdrawn"})]}),Nt.jsxs("div",{className:"font-bold text-lg "+(e.withdrawn?"text-gray-500":"text-indigo-600"),children:["",Number(e.totalSalary||0).toLocaleString(void 0,{maximumFractionDigits:2})]}),Nt.jsx("div",{className:"text-xs opacity-70",children:"Tap to view details"})]},e._id))})]}),0===s.length&&Nt.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6 mb-6 text-center",children:[Nt.jsx(Z,{className:"w-12 h-12 mx-auto mb-3 text-yellow-500"}),Nt.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Payroll Data Yet"}),Nt.jsx("p",{className:"text-sm text-gray-400",children:"teller"===n.role?"Your payroll will appear here once teller reports are submitted and synced.":"Your payroll will appear here once it has been created by the system."})]}),"teller"===n.role&&I.length>0&&Nt.jsxs("div",{className:`rounded-lg p-6 mb-6 ${i?"bg-gray-800":"bg-white"} shadow-md`,children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[Nt.jsx(be,{className:"text-indigo-500"})," Weekly Performance Summary"]}),Nt.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[Nt.jsxs("div",{className:"p-4 rounded-lg "+(i?"bg-gray-700":"bg-gray-50"),children:[Nt.jsx("div",{className:"text-sm opacity-70 mb-1",children:"Total Over"}),Nt.jsxs("div",{className:"text-2xl font-bold text-green-500",children:["+",I.reduce((e,t)=>e+(Number(t.over)||0),0).toLocaleString()]}),Nt.jsx("div",{className:"text-xs opacity-60 mt-1",children:"Bonus earnings"})]}),Nt.jsxs("div",{className:"p-4 rounded-lg "+(i?"bg-gray-700":"bg-gray-50"),children:[Nt.jsx("div",{className:"text-sm opacity-70 mb-1",children:"Total Short"}),Nt.jsxs("div",{className:"text-2xl font-bold text-red-500",children:["-",I.reduce((e,t)=>e+(Number(t.short)||0),0).toLocaleString()]}),Nt.jsx("div",{className:"text-xs opacity-60 mt-1",children:"Deductions"})]}),Nt.jsxs("div",{className:"p-4 rounded-lg "+(i?"bg-gray-700":"bg-gray-50"),children:[Nt.jsx("div",{className:"text-sm opacity-70 mb-1",children:"Net Impact"}),Nt.jsxs("div",{className:"text-2xl font-bold "+(I.reduce((e,t)=>e+(Number(t.over)||0),0)-I.reduce((e,t)=>e+(Number(t.short)||0),0)>=0?"text-green-500":"text-red-500"),children:[I.reduce((e,t)=>e+(Number(t.over)||0),0)-I.reduce((e,t)=>e+(Number(t.short)||0),0)>=0?"+":"","",Math.abs(I.reduce((e,t)=>e+(Number(t.over)||0),0)-I.reduce((e,t)=>e+(Number(t.short)||0),0)).toLocaleString()]}),Nt.jsx("div",{className:"text-xs opacity-60 mt-1",children:"Over - Short"})]})]})]}),"teller"===n.role&&j.length>0&&Nt.jsxs("div",{className:`rounded-lg p-6 mb-6 ${i?"bg-gray-800":"bg-white"} shadow-md`,children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(z,{className:"text-indigo-500"})," Daily Reports This Week"]}),Nt.jsx("button",{onClick:()=>C(!0),className:"text-sm text-indigo-500 hover:text-indigo-600 font-medium",children:"View All Details "})]}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:""+(i?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-2 text-left",children:"Date"}),Nt.jsx("th",{className:"p-2 text-left",children:"Day"}),Nt.jsx("th",{className:"p-2 text-right",children:"System"}),Nt.jsx("th",{className:"p-2 text-right",children:"Cash"}),Nt.jsx("th",{className:"p-2 text-right",children:"Over"}),Nt.jsx("th",{className:"p-2 text-right",children:"Short"}),Nt.jsx("th",{className:"p-2 text-center",children:"Terms"}),Nt.jsx("th",{className:"p-2 text-center",children:"Status"})]})}),Nt.jsx("tbody",{children:j.map((e,t)=>{const n=new Date(e.date||e.createdAt),r=n.toLocaleDateString("en-US",{weekday:"short"}),a=Number(e.shortPaymentTerms)||1,s=e.short>0&&a>1?e.short/a:null;return Nt.jsxs("tr",{className:"border-t "+(i?"border-gray-700":"border-gray-200"),children:[Nt.jsx("td",{className:"p-2",children:n.toLocaleDateString()}),Nt.jsx("td",{className:"p-2",children:Nt.jsx("span",{className:"px-2 py-1 rounded text-xs "+("Sun"===r?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-100":"Sat"===r?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-100":"bg-gray-100 text-gray-700 dark:bg-gray-600 dark:text-gray-100"),children:r})}),Nt.jsxs("td",{className:"p-2 text-right",children:["",(e.systemBalance||0).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",(e.cashOnHand||0).toLocaleString()]}),Nt.jsx("td",{className:"p-2 text-right text-green-600 dark:text-green-400 font-semibold",children:e.over>0?`+${e.over.toLocaleString()}`:"-"}),Nt.jsx("td",{className:"p-2 text-right text-red-600 dark:text-red-400 font-semibold",children:e.short>0?`-${e.short.toLocaleString()}`:"-"}),Nt.jsx("td",{className:"p-2 text-center",children:s?Nt.jsxs("div",{className:"text-xs",children:[Nt.jsxs("div",{className:"font-semibold",children:[a,"w"]}),Nt.jsxs("div",{className:"text-red-500",children:["",s.toFixed(0),"/w"]})]}):"-"}),Nt.jsx("td",{className:"p-2 text-center",children:Nt.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("approved"===e.status?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-100":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-100"),children:e.status||"pending"})})]},t)})})]})})]}),Nt.jsxs("div",{className:"bg-gray-800/10 rounded-lg p-4 mb-6",children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[Nt.jsx(be,{className:"text-indigo-500"})," Daily Salary Chart"]}),Nt.jsx(By,{width:"100%",height:200,children:Nt.jsxs(HL,{data:L,children:[Nt.jsx(vB,{dataKey:"day"}),Nt.jsx(TB,{}),Nt.jsx(OT,{content:Nt.jsx(nF,{dark:i}),cursor:{fill:"rgba(79, 70, 229, 0.1)"}}),Nt.jsx(dI,{dataKey:"salary",fill:"#4f46e5",radius:[6,6,0,0]})]})})]}),Nt.jsxs("div",{className:`rounded-lg p-6 mb-6 ${i?"bg-gray-800 text-gray-100":"bg-white text-gray-800"} shadow-md`,children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[Nt.jsx(be,{className:"text-indigo-500"})," Withdrawal Section"]}),Nt.jsxs("div",{className:"flex justify-between items-center mb-3",children:[Nt.jsx("p",{className:"text-sm font-medium",children:"Available Balance:"}),Nt.jsxs("p",{className:"text-lg font-bold text-green-500",children:["",O.toFixed(2)]})]}),Nt.jsxs("div",{className:"flex gap-3 items-center",children:[Nt.jsx("input",{type:"number",placeholder:"Enter amount",value:N,onChange:e=>S(e.target.value),className:"flex-1 p-2 rounded-md border outline-none "+(i?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-100 border-gray-300")}),Nt.jsx("button",{onClick:()=>S(O.toFixed(2)),disabled:O<=0,className:"px-3 py-2 text-sm rounded-md "+(O>0?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-400 cursor-not-allowed text-gray-200"),children:"Withdraw All"}),Nt.jsxs("button",{onClick:()=>{const e=parseFloat(N);isNaN(e)||e<=0?a({type:"warning",message:"Enter a valid amount."}):e>O?a({type:"warning",message:"Cannot withdraw more than balance."}):v(!0)},disabled:O<=0||!N||parseFloat(N)<=0||parseFloat(N)>O,className:"px-5 py-2 rounded-md font-semibold flex items-center gap-1 "+(O>0&&N&&parseFloat(N)>0&&parseFloat(N)<=O?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-400 cursor-not-allowed text-gray-200"),children:["Proceed ",Nt.jsx(we,{className:"w-4 h-4"})]})]}),O<=0&&Nt.jsx("div",{className:"mt-3 p-3 rounded-lg text-sm bg-yellow-50 text-yellow-700 border border-yellow-200",children:Nt.jsx("span",{children:"No funds available for withdrawal."})})]}),Nt.jsxs("div",{className:`rounded-lg p-6 ${i?"bg-gray-800 text-gray-100":"bg-white text-gray-800"} shadow-md`,children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[Nt.jsx(ie,{className:"text-indigo-500"})," Withdrawal History"]}),0===l.length?Nt.jsx("p",{className:"text-sm opacity-60",children:"No withdrawal history yet."}):Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-sm border-collapse",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:(i?"bg-gray-700":"bg-gray-100")+" text-left",children:[Nt.jsx("th",{className:"p-2 border-b",children:"Date"}),Nt.jsx("th",{className:"p-2 border-b",children:"Week Range"}),Nt.jsx("th",{className:"p-2 border-b",children:"Amount"}),Nt.jsx("th",{className:"p-2 border-b",children:"Remaining"})]})}),Nt.jsx("tbody",{children:l.map(e=>Nt.jsxs("tr",{className:"hover:bg-gray-100 dark:hover:bg-gray-700",children:[Nt.jsx("td",{className:"p-2 border-b",children:new Date(e.createdAt).toLocaleString()}),Nt.jsx("td",{className:"p-2 border-b",children:e.weekRange||"N/A"}),Nt.jsxs("td",{className:"p-2 border-b text-green-500",children:["",e.amount.toFixed(2)]}),Nt.jsxs("td",{className:"p-2 border-b text-indigo-500",children:["",e.remaining.toFixed(2)]})]},e._id))})]})})]}),y&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-xl w-96 shadow-lg "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2 mb-3",children:[Nt.jsx(Ne,{className:"text-indigo-500"})," Confirm Withdrawal"]}),Nt.jsx("p",{className:"text-sm mb-4 opacity-80",children:"Please confirm your withdrawal details below:"}),Nt.jsxs("div",{className:"text-sm space-y-1 mb-3",children:[Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Available Balance:"})," ",O.toFixed(2)]}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Withdrawal Amount:"})," ",parseFloat(N||0).toFixed(2)]}),Nt.jsxs("p",{className:"text-green-500",children:[Nt.jsx("strong",{children:"Remaining:"})," ",B.toFixed(2)]})]}),Nt.jsxs("div",{className:"flex justify-between mt-5",children:[Nt.jsxs("button",{onClick:()=>v(!1),className:"flex items-center gap-1 px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md",children:[Nt.jsx(ve,{className:"w-4 h-4"})," Cancel"]}),Nt.jsx("button",{disabled:b,onClick:()=>h(null,null,function*(){try{w(!0);const e=I.filter(e=>!e.withdrawn).map(e=>e._id);if(0===e.length)return void a({type:"warning",message:"No unwithdrawn payrolls found."});const t={payrollIds:e,initiatedBy:n._id,weekRange:`${E.toLocaleDateString()} - ${T.toLocaleDateString()}`};yield pt.post(`${zc()}/api/payroll/bulk-withdraw`,t),a({type:"success",message:` Withdrawal of ${N} processed successfully.`}),S(""),v(!1),D()}catch(e){console.error(" Withdraw error:",e),a({type:"error",message:"Failed to withdraw."})}finally{w(!1)}}),className:"flex items-center gap-1 px-5 py-2 rounded-md font-semibold transition "+(b?"bg-gray-500 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 text-white"),children:b?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{className:"animate-spin w-4 h-4"})," Processing..."]}):Nt.jsxs(Nt.Fragment,{children:["Confirm ",Nt.jsx(Ne,{className:"w-4 h-4"})]})})]})]})}),g&&p&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-xl w-96 shadow-lg "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[Nt.jsx(Se,{className:"text-indigo-500"})," ",new Date(p.createdAt||p.date).toDateString()]}),Nt.jsxs("div",{className:"space-y-1 text-sm",children:[Nt.jsxs("p",{children:["Base Salary: ",Number(p.baseSalary||0).toFixed(2)]}),Nt.jsxs("p",{className:"text-green-500",children:["Over: ",Number(p.over||0).toFixed(2)]}),Nt.jsxs("p",{className:"text-red-500",children:["Short: ",Number(p.short||0).toFixed(2)]}),p.short>0&&p.shortPaymentTerms>1&&Nt.jsxs("div",{className:"p-2 rounded text-xs "+(i?"bg-blue-900/30 border border-blue-700":"bg-blue-50 border border-blue-200"),children:[Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Payment Plan:"}),Nt.jsxs("span",{className:"font-semibold",children:[p.shortPaymentTerms," weeks"]})]}),Nt.jsxs("div",{className:"flex items-center justify-between mt-1",children:[Nt.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Weekly Deduction:"}),Nt.jsxs("span",{className:"font-semibold text-red-600 dark:text-red-400",children:["",(p.short/p.shortPaymentTerms).toFixed(2),"/week"]})]})]}),p.deduction>0&&Nt.jsxs("p",{className:"text-orange-500",children:["Other Deductions: ",Number(p.deduction||0).toFixed(2)]}),Nt.jsx("hr",{className:"my-2"}),Nt.jsxs("p",{className:"font-semibold text-indigo-500",children:["Net Pay: ",Number(p.totalSalary||0).toFixed(2)]})]}),(null==(t=p.adjustments)?void 0:t.length)>0&&Nt.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-300 dark:border-gray-600",children:[Nt.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Adjustments & Overrides"}),Nt.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:p.adjustments.map((e,t)=>{var n;const r=null==(n=e.reason)?void 0:n.startsWith("[OVERRIDE]"),a=r?e.reason.replace("[OVERRIDE]","").trim():"",s=r?a:e.reason||"Adjustment";return Nt.jsx("div",{className:"p-2 rounded text-xs "+(r?i?"bg-purple-900/30 border border-purple-700":"bg-purple-50 border border-purple-200":i?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("div",{className:"flex justify-between items-start",children:[Nt.jsxs("div",{className:"flex-1",children:[r&&Nt.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold bg-purple-600 text-white mr-1",children:"OVERRIDE"}),Nt.jsx("div",{className:"font-medium",children:s}),Nt.jsx("div",{className:"opacity-60 text-[10px]",children:new Date(e.createdAt).toLocaleString()})]}),Nt.jsxs("div",{className:"font-bold ml-2 "+(e.delta>=0?"text-green-500":"text-red-500"),children:[e.delta>=0?"+":"","",e.delta.toFixed(2)]})]})},t)})})]}),Nt.jsx("button",{onClick:()=>x(!1),className:"mt-4 w-full text-gray-400 hover:text-gray-600 text-sm",children:"Close"})]})}),A&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"p-6 rounded-xl w-full max-w-4xl shadow-lg max-h-[90vh] overflow-y-auto "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[Nt.jsx(z,{className:"text-indigo-500"})," Daily Reports Details"]}),Nt.jsx("button",{onClick:()=>C(!1),className:"p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700",children:Nt.jsx(ve,{className:"w-5 h-5"})})]}),Nt.jsx("div",{className:"space-y-4",children:j.map((e,t)=>{const n=new Date(e.date||e.createdAt),r=n.toLocaleDateString("en-US",{weekday:"long"}),a=Number(e.shortPaymentTerms)||1,s=e.short>0&&a>1?e.short/a:null;return Nt.jsxs("div",{className:"p-4 rounded-lg border "+(i?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:[Nt.jsxs("div",{className:"flex justify-between items-start mb-3",children:[Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"font-semibold text-lg",children:r}),Nt.jsx("p",{className:"text-sm opacity-70",children:n.toLocaleDateString()})]}),Nt.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium "+("approved"===e.status?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-100":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-100"),children:e.status||"pending"})]}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"opacity-70",children:"System Balance"}),Nt.jsxs("div",{className:"font-semibold",children:["",(e.systemBalance||0).toLocaleString()]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"opacity-70",children:"Cash on Hand"}),Nt.jsxs("div",{className:"font-semibold",children:["",(e.cashOnHand||0).toLocaleString()]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"opacity-70",children:"Over"}),Nt.jsx("div",{className:"font-semibold text-green-600 dark:text-green-400",children:e.over>0?`+${e.over.toLocaleString()}`:"0"})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"opacity-70",children:"Short"}),Nt.jsx("div",{className:"font-semibold text-red-600 dark:text-red-400",children:e.short>0?`-${e.short.toLocaleString()}`:"0"})]})]}),s&&Nt.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[Nt.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Weekly Payment Terms"}),Nt.jsxs("div",{className:"text-sm mt-1",children:["This short amount will be deducted over ",Nt.jsxs("span",{className:"font-semibold",children:[a," weeks"]})]}),Nt.jsxs("div",{className:"text-sm mt-1",children:["Weekly deduction: ",Nt.jsxs("span",{className:"font-semibold text-red-600 dark:text-red-400",children:["",s.toFixed(2)]})," per week"]})]}),e.notes&&Nt.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-300 dark:border-gray-600",children:[Nt.jsx("div",{className:"text-sm opacity-70",children:"Notes:"}),Nt.jsx("div",{className:"text-sm",children:e.notes})]})]},t)})}),Nt.jsx("div",{className:"mt-6 flex justify-end",children:Nt.jsx("button",{onClick:()=>C(!1),className:"px-6 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:"Close"})})]})})]}):Nt.jsx("div",{className:"flex justify-center items-center min-h-screen text-gray-400",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx(ve,{className:"w-16 h-16 mx-auto mb-4 text-red-500"}),Nt.jsx("p",{children:"User not found. Please login again."})]})})}function aF({userRole:e}){var t;const{user:n,settings:r}=f.useContext($c),{showToast:a}=Kc(),i="dark"===(null==(t=null==r?void 0:r.theme)?void 0:t.mode),[s,o]=f.useState(null),[d,u]=f.useState([]),[p,m]=f.useState(""),[g,x]=f.useState([]),[y,v]=f.useState([]),[b,w]=f.useState(null),[N,S]=f.useState(!1),[j,_]=f.useState(!1),[A,C]=f.useState(!1),[M,k]=f.useState({date:"",enabled:!1,showAll:!1}),E=f.useRef();function T(e){var t,n,r,a,i,s,o,d,u,h,p,m,g,f,x,y,v,b,w,N,S,j;if(!e)return null;const _=JSON.parse(JSON.stringify(e)),A=_.denominationTotals||_.denomTotals||{};return _.denominationTotals={d1000:Number(null!=(n=null!=(t=A.d1000)?t:A.pcs1000)?n:0),d500:Number(null!=(a=null!=(r=A.d500)?r:A.pcs500)?a:0),d200:Number(null!=(s=null!=(i=A.d200)?i:A.pcs200)?s:0),d100:Number(null!=(d=null!=(o=A.d100)?o:A.pcs100)?d:0),d50:Number(null!=(h=null!=(u=A.d50)?u:A.pcs50)?h:0),d20:Number(null!=(m=null!=(p=A.d20)?p:A.pcs20)?m:0),coins:Number(null!=(f=null!=(g=A.coins)?g:A.pcsCoins)?f:0)},_.tellers=(_.tellers||[]).map(e=>{var t,n,r,a,i,s,o,d,u,h,p,m,g,f,x,y;const v=e.denom||{d1000:Number(null!=(n=null!=(t=e.d1000)?t:e.pcs1000)?n:0),d500:Number(null!=(a=null!=(r=e.d500)?r:e.pcs500)?a:0),d200:Number(null!=(s=null!=(i=e.d200)?i:e.pcs200)?s:0),d100:Number(null!=(d=null!=(o=e.d100)?o:e.pcs100)?d:0),d50:Number(null!=(h=null!=(u=e.d50)?u:e.pcs50)?h:0),d20:Number(null!=(m=null!=(p=e.d20)?p:e.pcs20)?m:0),coins:Number(null!=(f=null!=(g=e.coins)?g:e.pcsCoins)?f:0)},b=Number(null!=(y=null!=(x=e.totalFromDenom)?x:e.totalDenomination)?y:0)||1e3*v.d1000+500*v.d500+200*v.d200+100*v.d100+50*v.d50+20*v.d20+v.coins;return c(l({},e),{denom:v,totalFromDenom:b,systemBalance:Number(e.systemBalance||0),cashOnHand:Number(e.cashOnHand||b||0),short:Number(e.short||0),over:Number(e.over||0)})}),_.totalSystemBalance=Number(null!=(y=null!=(x=_.totalSystemBalance)?x:_.totalSystem)?y:0)||_.tellers.reduce((e,t)=>e+(Number(t.systemBalance)||0),0),_.totalCashOnHand=Number(null!=(b=null!=(v=_.totalCashOnHand)?v:_.totalCash)?b:0)||_.tellers.reduce((e,t)=>e+(Number(t.cashOnHand)||0),0),_.totalShort=Number(null!=(N=null!=(w=_.totalShort)?w:_.totalShorts)?N:0)||_.tellers.reduce((e,t)=>e+(Number(t.short)||0),0),_.totalOver=Number(null!=(j=null!=(S=_.totalOver)?S:_.totalOvers)?j:0)||_.tellers.reduce((e,t)=>e+(Number(t.over)||0),0),_}function P(e){return h(this,null,function*(){if(e){S(!0);try{const t=new URLSearchParams;M.enabled&&M.date&&(t.append("fromDate",M.date),t.append("toDate",M.date)),M.showAll&&t.append("showAll","true");const n=t.toString(),r=n?`?${n}`:"",a=yield pt.get(`${zc()}/api/reports/supervisor/${e}${r}`);o(T(a.data))}catch(t){console.error("Failed to load report",t),a({type:"error",message:"Failed to load report"}),o(null)}finally{S(!1)}}else o(null)})}function D(){const e=((null==s?void 0:s.tellers)||[]).slice();if(e.length>=10)return e;const t=[];for(let n=0;n<10-e.length;n++)t.push({tellerId:`placeholder-${n}`,tellerName:"",systemBalance:0,cashOnHand:0,short:0,over:0,denom:{d1000:0,d500:0,d200:0,d100:0,d50:0,d20:0,coins:0},totalFromDenom:0,verified:!1,approvedByAdmin:!1});return[...e,...t]}f.useEffect(()=>{"admin"===e||"super_admin"===e?function(){h(this,null,function*(){try{const e=yield pt.get(`${zc()}/api/reports/supervisors/list`);u(e.data||[])}catch(e){console.error("Failed to load supervisors",e),a({type:"error",message:"Failed to load supervisors"})}})}():"supervisor"===e&&(null==n?void 0:n._id)&&P(n._id);const t=()=>{const t="admin"===e||"super_admin"===e?p:null==n?void 0:n._id;t&&P(t)},r=Vc();if(r)return r.on("reportUpdated",t),r.on("tellerManagementUpdated",t),r.on("tellerReportCreated",t),r.on("supervisorReportUpdated",t=>{const r="admin"===e||"super_admin"===e?p:null==n?void 0:n._id;r&&t&&t.supervisorId&&String(t.supervisorId)===String(r)&&P(r)}),r.on("transactionUpdated",t),()=>{r.off("reportUpdated",t),r.off("tellerManagementUpdated",t),r.off("tellerReportCreated",t),r.off("supervisorReportUpdated"),r.off("transactionUpdated",t)}},[e,n,p]);const R={totalCashOnHand:Number((null==s?void 0:s.totalCashOnHand)||(null==s?void 0:s.totalCash)||0),totalSystemBalance:Number((null==s?void 0:s.totalSystemBalance)||(null==s?void 0:s.totalSystem)||0),totalShort:Number((null==s?void 0:s.totalShort)||0),totalOver:Number((null==s?void 0:s.totalOver)||0)};return Nt.jsxs("div",{className:"p-6 min-h-screen "+(i?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Nt.jsx("h1",{className:"text-xl font-semibold",children:"Supervisor's Report"}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:()=>{const t="admin"===e||"super_admin"===e?p:null==n?void 0:n._id;t?P(t):a({type:"info",message:"Select a supervisor first"})},className:"px-3 py-1 rounded bg-indigo-600 hover:bg-indigo-700 text-white",children:"Refresh"}),Nt.jsxs("button",{onClick:function(){var t;if(console.log(" Export clicked - reportData:",s),!s||!s.tellers||0===s.tellers.length)return console.warn(" No report data to export"),void a({type:"warning",message:"No report data to export"});try{console.log(" Starting export...");const i="supervisor"===e?(null==n?void 0:n.name)||(null==n?void 0:n.username):(null==(t=d.find(e=>e._id===p))?void 0:t.name)||"Unknown";console.log(" Supervisor:",i);const o=["Teller Name","System Balance","Cash on Hand","Short","Over"],l=[["Supervisor Report - "+i],["Date: "+(new Date).toLocaleDateString()],[],o,...s.tellers.map(e=>[e.tellerName||"",Number(e.systemBalance||0),Number(e.cashOnHand||0),Number(e.short||0),Number(e.over||0)]),["TOTAL",s.tellers.reduce((e,t)=>e+Number(t.systemBalance||0),0),s.tellers.reduce((e,t)=>e+Number(t.cashOnHand||0),0),s.tellers.reduce((e,t)=>e+Number(t.short||0),0),s.tellers.reduce((e,t)=>e+Number(t.over||0),0)]];console.log(" CSV rows prepared:",l.length);const c=l.map(e=>e.map(e=>{const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'+t.replace(/"/g,'""')+'"':t}).join(",")).join("\n");console.log(" CSV content created, length:",c.length);const u=`supervisor_report_${i.replace(/\s+/g,"_")}_${(new Date).toISOString().split("T")[0]}.csv`;try{const e=new Blob([c],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),n=URL.createObjectURL(e);console.log(" Blob created, URL:",n),t.href=n,t.download=u,t.style.display="none",document.body.appendChild(t),console.log(" Link appended to DOM"),setTimeout(()=>{console.log(" Triggering download..."),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(n),console.log(" Cleanup done")},500)},100)}catch(r){console.warn(" Blob method failed, trying data URI:",r);const e="data:text/csv;charset=utf-8,"+encodeURIComponent(c),t=document.createElement("a");t.href=e,t.download=u,t.click()}a({type:"success",message:" CSV file downloading..."})}catch(i){console.error(" Export error:",i),a({type:"error",message:"Failed to export report: "+i.message})}},disabled:!s||!s.tellers||0===s.tellers.length,className:"flex items-center gap-2 px-3 py-1 rounded text-white "+(s&&s.tellers&&0!==s.tellers.length?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"),children:[Nt.jsx(je,{size:16}),"Export to Sheets"]}),Nt.jsx("button",{onClick:function(){if(!E.current)return;const e=E.current.cloneNode(!0);e.querySelectorAll("th").forEach(e=>{e.textContent.includes("TOTAL BET")&&(e.style.display="none")}),e.querySelectorAll("td").forEach((t,n)=>{const r=t.parentElement,a=Array.from(r.children).indexOf(t),i=e.querySelectorAll("thead th");i[a]&&i[a].textContent.includes("TOTAL BET")&&(t.style.display="none")}),e.querySelectorAll("th").forEach(e=>{e.textContent.includes("ACTION")&&(e.style.display="none")}),e.querySelectorAll("td").forEach((t,n)=>{const r=t.parentElement,a=Array.from(r.children).indexOf(t),i=e.querySelectorAll("thead th");i[a]&&i[a].textContent.includes("ACTION")&&(t.style.display="none")});const t=e.innerHTML,n=window.open("","_blank");n.document.write(`\n      <html>\n        <head>\n          <title>Supervisor Report</title>\n          <style>\n            body { font-family: Arial, Helvetica, sans-serif; color: #000; margin: 20px; }\n            h2 { text-align: center; margin: 6px 0; font-size: 16px; }\n            .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; font-size:13px; }\n            table { width:100%; border-collapse: collapse; margin-top: 8px; font-size:12px;}\n            th, td { border:1px solid #000; padding:6px; text-align:center; vertical-align: middle; }\n            .denom-table th, .denom-table td { text-align:left; }\n            .signature { margin-top:40px; display:flex; justify-content:space-between; }\n            .sig-line { width:40%; border-top:1px solid #000; text-align:center; padding-top:6px; }\n          </style>\n        </head>\n        <body>${t}</body>\n      </html>\n    `),n.document.close(),n.focus(),n.print()},className:"px-3 py-1 rounded bg-purple-600 hover:bg-purple-700 text-white",children:"Print Report"})]})]}),("admin"===e||"super_admin"===e)&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block mb-2 font-medium",children:"Select Supervisor"}),Nt.jsxs("select",{className:"p-2 rounded border bg-gray-800 text-gray-100",value:p,onChange:e=>{m(e.target.value),P(e.target.value)},children:[Nt.jsx("option",{value:"",children:"-- Choose Supervisor --"}),d.map(e=>Nt.jsx("option",{value:e._id,children:e.name||e.username},e._id))]})]}),"super_admin"===e&&Nt.jsxs("div",{className:"mb-4 p-4 rounded "+(i?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-3",children:[Nt.jsx("label",{className:"font-medium",children:"Print Multiple Supervisor Reports"}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:function(){g.length===d.length?x([]):x(d.map(e=>e._id))},className:"px-3 py-1 text-sm rounded bg-gray-600 hover:bg-gray-700 text-white",children:g.length===d.length?"Deselect All":"Select All"}),Nt.jsx("button",{onClick:function(){return h(this,null,function*(){if(0!==g.length){C(!0);try{const e=new URLSearchParams;M.enabled&&M.date&&(e.append("fromDate",M.date),e.append("toDate",M.date)),M.showAll&&e.append("showAll","true");const t=e.toString(),n=t?`?${t}`:"",r=(yield Promise.all(g.map(e=>h(null,null,function*(){try{return T((yield pt.get(`${zc()}/api/reports/supervisor/${e}${n}`)).data)}catch(t){return console.error(`Failed to load report for supervisor ${e}`,t),null}})))).filter(e=>null!==e);if(0===r.length)return void a({type:"error",message:"Failed to load any reports"});const i=function(e){if(!e||0===e.length)return null;const t=[];e.forEach(e=>{e&&e.tellers&&e.tellers.forEach(n=>{t.push(c(l({},n),{supervisorName:e.supervisorName||"Unknown"}))})});const n={totalSystemBalance:t.reduce((e,t)=>e+(t.systemBalance||0),0),totalCashOnHand:t.reduce((e,t)=>e+(t.cashOnHand||0),0),totalShort:t.reduce((e,t)=>e+(t.short||0),0),totalOver:t.reduce((e,t)=>e+(t.over||0),0)},r={d1000:0,d500:0,d200:0,d100:0,d50:0,d20:0,coins:0};e.forEach(e=>{e&&e.denominationTotals&&(r.d1000+=e.denominationTotals.d1000||0,r.d500+=e.denominationTotals.d500||0,r.d200+=e.denominationTotals.d200||0,r.d100+=e.denominationTotals.d100||0,r.d50+=e.denominationTotals.d50||0,r.d20+=e.denominationTotals.d20||0,r.coins+=e.denominationTotals.coins||0)});const a=e.map(e=>e.supervisorName||"Unknown").join(", ");return{supervisorName:a,supervisorCount:e.length,tellers:t,totalSystemBalance:n.totalSystemBalance,totalCashOnHand:n.totalCashOnHand,totalShort:n.totalShort,totalOver:n.totalOver,denominationTotals:r,dateLabel:M.date||(new Date).toLocaleDateString(),isMerged:!0}}(r);w(i),o(null)}catch(e){console.error("Failed to load merged reports",e),a({type:"error",message:"Failed to load merged reports"})}finally{C(!1)}}else a({type:"warning",message:"Please select at least one supervisor"})})},disabled:0===g.length||A,className:"px-3 py-1 text-sm rounded bg-purple-600 hover:bg-purple-700 text-white disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:A?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(z,{className:"w-4 h-4"}),"Load Reports (",g.length,")"]})})]})]}),Nt.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:d.map(e=>Nt.jsxs("label",{className:"flex items-center gap-2 p-2 rounded cursor-pointer "+(g.includes(e._id)?"bg-purple-600 text-white":i?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:[Nt.jsx("input",{type:"checkbox",checked:g.includes(e._id),onChange:()=>{return t=e._id,void x(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded"}),Nt.jsx("span",{className:"text-sm",children:e.name||e.username})]},e._id))})]})]}),Nt.jsxs("div",{className:"p-4 rounded mb-4 "+(i?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[Nt.jsx(W,{className:"w-5 h-5"}),Nt.jsx("span",{className:"font-medium",children:"Date Filter"}),Nt.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[Nt.jsxs("label",{className:"flex items-center gap-2",children:[Nt.jsx("input",{type:"checkbox",checked:M.showAll,onChange:e=>k(t=>c(l({},t),{showAll:e.target.checked,enabled:!e.target.checked&&t.enabled})),className:"rounded"}),Nt.jsx("span",{className:"text-sm text-orange-600 font-medium",children:"Show All Historical"})]}),Nt.jsxs("label",{className:"flex items-center gap-2",children:[Nt.jsx("input",{type:"checkbox",checked:M.enabled,onChange:e=>k(t=>c(l({},t),{enabled:e.target.checked,showAll:!e.target.checked&&t.showAll})),className:"rounded",disabled:M.showAll}),Nt.jsx("span",{className:"text-sm",children:"Enable Date Range"})]})]})]}),Nt.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Select Date:"}),Nt.jsx("input",{type:"date",value:M.date,onChange:e=>k(t=>c(l({},t),{date:e.target.value})),disabled:!M.enabled,className:`w-full p-2 border rounded ${i?"bg-gray-700 border-gray-600":"bg-white border-gray-300"} ${M.enabled?"":"opacity-50"}`})]}),Nt.jsx("div",{className:"flex items-end",children:Nt.jsxs("button",{onClick:()=>{const t="admin"===e||"super_admin"===e?p:null==n?void 0:n._id;t?P(t):a({type:"info",message:"Select a supervisor first"})},disabled:!M.enabled&&!M.showAll,className:"w-full px-4 py-2 rounded flex items-center justify-center gap-2 "+(M.enabled||M.showAll?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:[Nt.jsx(he,{className:"w-4 h-4"}),M.showAll?"Show All Reports":"Apply Filter"]})})]})]}),b&&Nt.jsx("div",{className:"mb-6",children:Nt.jsxs("div",{className:"mb-4 p-4 rounded "+(i?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("h2",{className:"text-xl font-semibold",children:"Consolidated Report"}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[b.supervisorCount," Supervisors  ",b.tellers.length," Tellers"]})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:function(){if(console.log(" Merged export clicked - mergedReportData:",b),!b||!b.tellers||0===b.tellers.length)return console.warn(" No merged report data to export"),void a({type:"warning",message:"No merged report data to export"});try{console.log(" Starting merged export...");const t=["Supervisor","Teller Name","System Balance","Cash on Hand","Short","Over"],n=b.tellers.map(e=>[e.supervisorName||"",e.tellerName||"",Number(e.systemBalance||0),Number(e.cashOnHand||0),Number(e.short||0),Number(e.over||0)]);n.push(["TOTAL","",b.totalSystemBalance,b.totalCashOnHand,b.totalShort,b.totalOver]),console.log(" Rows prepared:",n.length);const r=[["Consolidated Supervisor Report"],[`Supervisors: ${b.supervisorName}`],[`Total Supervisors: ${b.supervisorCount}`],[`Total Tellers: ${b.tellers.length}`],[`Date: ${b.dateLabel}`],[],t,...n].map(e=>e.map(e=>{const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'+t.replace(/"/g,'""')+'"':t}).join(",")).join("\n");console.log(" CSV content created, length:",r.length);const i=`consolidated_report_${(new Date).toISOString().split("T")[0]}.csv`;try{const e=new Blob([r],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),n=URL.createObjectURL(e);console.log(" Blob created, URL:",n),t.href=n,t.download=i,t.style.display="none",document.body.appendChild(t),console.log(" Link appended to DOM"),setTimeout(()=>{console.log(" Triggering download..."),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(n),console.log(" Cleanup done")},500)},100)}catch(e){console.warn(" Blob method failed, trying data URI:",e);const t="data:text/csv;charset=utf-8,"+encodeURIComponent(r),n=document.createElement("a");n.href=t,n.download=i,n.click()}a({type:"success",message:" CSV file downloading..."})}catch(t){console.error(" Export error:",t),a({type:"error",message:"Failed to export report: "+t.message})}},className:"px-3 py-2 rounded bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[Nt.jsx(je,{className:"w-4 h-4"}),"Export to Sheets"]}),Nt.jsxs("button",{onClick:function(){b?function(e){if(!e||0===e.length)return;const t=[];e.forEach(e=>{e&&e.tellers&&e.tellers.forEach(n=>{t.push(c(l({},n),{supervisorName:e.supervisorName||"Unknown"}))})});const n={totalSystemBalance:t.reduce((e,t)=>e+(t.systemBalance||0),0),totalCashOnHand:t.reduce((e,t)=>e+(t.cashOnHand||0),0),totalShort:t.reduce((e,t)=>e+(t.short||0),0),totalOver:t.reduce((e,t)=>e+(t.over||0),0)},r={d1000:0,d500:0,d200:0,d100:0,d50:0,d20:0,coins:0};e.forEach(e=>{e&&e.denominationTotals&&(r.d1000+=e.denominationTotals.d1000||0,r.d500+=e.denominationTotals.d500||0,r.d200+=e.denominationTotals.d200||0,r.d100+=e.denominationTotals.d100||0,r.d50+=e.denominationTotals.d50||0,r.d20+=e.denominationTotals.d20||0,r.coins+=e.denominationTotals.coins||0)});const a=e.map(e=>e.supervisorName||"Unknown").join(", "),i=`\n      <h2>CONSOLIDATED SUPERVISOR COLLECTION REPORT</h2>\n      <div class="header">\n        <div><strong>Supervisors:</strong> ${a}</div>\n        <div><strong>Date:</strong> ${M.date||(new Date).toLocaleDateString()}</div>\n      </div>\n      <div class="header">\n        <div><strong>Total Supervisors:</strong> ${e.length}</div>\n        <div><strong>Total Tellers:</strong> ${t.length}</div>\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th>SUPERVISOR</th>\n            <th>TELLER</th>\n            <th>SYSTEM BAL</th>\n            <th>CASH ON HAND</th>\n            <th>SHORT</th>\n            <th>OVER</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${t.map(e=>`\n            <tr>\n              <td>${e.supervisorName}</td>\n              <td>${e.tellerName||"Unknown"}</td>\n              <td>${(e.systemBalance||0).toLocaleString()}</td>\n              <td>${(e.cashOnHand||0).toLocaleString()}</td>\n              <td class="short">${(e.short||0).toLocaleString()}</td>\n              <td class="over">${(e.over||0).toLocaleString()}</td>\n            </tr>\n          `).join("")}\n          <tr class="total-row">\n            <td colspan="2"><strong>GRAND TOTAL</strong></td>\n            <td><strong>${n.totalSystemBalance.toLocaleString()}</strong></td>\n            <td><strong>${n.totalCashOnHand.toLocaleString()}</strong></td>\n            <td class="short"><strong>${n.totalShort.toLocaleString()}</strong></td>\n            <td class="over"><strong>${n.totalOver.toLocaleString()}</strong></td>\n          </tr>\n        </tbody>\n      </table>\n\n      <table class="denom-table">\n        <thead>\n          <tr>\n            <th>Denomination</th>\n            <th>Total Pieces</th>\n            <th>Total Amount</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr><td>1000</td><td>${r.d1000}</td><td>${(1e3*r.d1000).toLocaleString()}</td></tr>\n          <tr><td>500</td><td>${r.d500}</td><td>${(500*r.d500).toLocaleString()}</td></tr>\n          <tr><td>200</td><td>${r.d200}</td><td>${(200*r.d200).toLocaleString()}</td></tr>\n          <tr><td>100</td><td>${r.d100}</td><td>${(100*r.d100).toLocaleString()}</td></tr>\n          <tr><td>50</td><td>${r.d50}</td><td>${(50*r.d50).toLocaleString()}</td></tr>\n          <tr><td>20</td><td>${r.d20}</td><td>${(20*r.d20).toLocaleString()}</td></tr>\n          <tr><td>Coins</td><td>${r.coins}</td><td>${r.coins.toLocaleString()}</td></tr>\n          <tr class="total-row">\n            <td colspan="2"><strong>TOTAL CASH</strong></td>\n            <td><strong>${(1e3*r.d1000+500*r.d500+200*r.d200+100*r.d100+50*r.d50+20*r.d20+r.coins).toLocaleString()}</strong></td>\n          </tr>\n        </tbody>\n      </table>\n\n      <div class="signature">\n        <div class="sig-line">Prepared By</div>\n        <div class="sig-line">Verified By</div>\n        <div class="sig-line">Admin Signature</div>\n      </div>\n    `,s=window.open("","_blank");s.document.write(`\n      <html>\n        <head>\n          <title>Consolidated Report - ${M.date||(new Date).toLocaleDateString()}</title>\n          <style>\n            body { font-family: Arial, Helvetica, sans-serif; color: #000; margin: 20px; }\n            h2 { text-align: center; margin: 6px 0; font-size: 16px; }\n            .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; font-size:13px; }\n            table { width:100%; border-collapse: collapse; margin-top: 12px; font-size:11px;}\n            th, td { border:1px solid #000; padding:5px; text-align:center; vertical-align: middle; }\n            .denom-table { margin-top: 16px; }\n            .denom-table th, .denom-table td { text-align:left; }\n            .total-row { background-color: #f0f0f0; font-weight: bold; }\n            .short { color: #dc2626; }\n            .over { color: #16a34a; }\n            .signature { margin-top:40px; display:flex; justify-content:space-around; }\n            .sig-line { width:30%; border-top:1px solid #000; text-align:center; padding-top:6px; }\n            @media print {\n              body { margin: 15px; }\n            }\n          </style>\n        </head>\n        <body>${i}</body>\n      </html>\n    `),s.document.close(),s.print()}([b]):a({type:"warning",message:"No merged report to print"})},className:"px-3 py-2 rounded bg-purple-600 hover:bg-purple-700 text-white flex items-center gap-2",children:[Nt.jsx(de,{className:"w-4 h-4"}),"Print Report"]}),Nt.jsxs("button",{onClick:()=>{w(null),x([])},className:"px-3 py-2 rounded bg-gray-600 hover:bg-gray-700 text-white flex items-center gap-2",children:[Nt.jsx(ce,{className:"w-4 h-4"}),"Close"]})]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-sm",children:[Nt.jsxs("div",{className:"p-2 rounded border bg-indigo-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total Cash On Hand"}),Nt.jsxs("div",{className:"font-semibold text-lg",children:["",Number(b.totalCashOnHand).toLocaleString()]})]}),Nt.jsxs("div",{className:"p-2 rounded border bg-blue-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total System Balance"}),Nt.jsxs("div",{className:"font-semibold text-lg",children:["",Number(b.totalSystemBalance).toLocaleString()]})]}),Nt.jsxs("div",{className:"p-2 rounded border bg-red-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total Short"}),Nt.jsxs("div",{className:"font-semibold text-lg text-red-600",children:["",Number(b.totalShort).toLocaleString()]})]}),Nt.jsxs("div",{className:"p-2 rounded border bg-green-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total Over"}),Nt.jsxs("div",{className:"font-semibold text-lg text-green-600",children:["",Number(b.totalOver).toLocaleString()]})]})]}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full table-auto text-sm border-collapse",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:(i?"bg-gray-700":"bg-gray-200")+" text-center",children:[Nt.jsx("th",{className:"py-2 px-2 border",children:"SUPERVISOR"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"TELLER'S NAME"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"SYSTEM BALANCE"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"CASH ON HAND"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"SHORT"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"OVER"})]})}),Nt.jsxs("tbody",{children:[b.tellers.map((e,t)=>Nt.jsxs("tr",{className:"h-10",children:[Nt.jsx("td",{className:"px-2 border text-left",children:e.supervisorName}),Nt.jsx("td",{className:"px-2 border text-left",children:e.tellerName}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(e.systemBalance||0).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(e.cashOnHand||0).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(e.short||0).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(e.over||0).toLocaleString()]})]},t)),Nt.jsxs("tr",{className:"font-bold "+(i?"bg-gray-700":"bg-gray-200"),children:[Nt.jsx("td",{className:"px-2 border text-left",colSpan:"2",children:"GRAND TOTAL"}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(b.totalSystemBalance).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(b.totalCashOnHand).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(b.totalShort).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(b.totalOver).toLocaleString()]})]})]})]})}),Nt.jsxs("div",{className:"mt-6",children:[Nt.jsx("h3",{className:"font-semibold mb-2",children:"Consolidated Denomination Summary"}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full table-auto text-sm border-collapse",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:""+(i?"bg-gray-700":"bg-gray-200"),children:[Nt.jsx("th",{className:"border px-3 py-2",children:"Denomination"}),Nt.jsx("th",{className:"border px-3 py-2",children:"Pieces"}),Nt.jsx("th",{className:"border px-3 py-2",children:"Total"})]})}),Nt.jsxs("tbody",{children:[[{key:"d1000",label:"1000",value:1e3},{key:"d500",label:"500",value:500},{key:"d200",label:"200",value:200},{key:"d100",label:"100",value:100},{key:"d50",label:"50",value:50},{key:"d20",label:"20",value:20},{key:"coins",label:"Coins",value:1}].map(e=>{const t=b.denominationTotals[e.key]||0,n=t*e.value;return Nt.jsxs("tr",{className:"h-10",children:[Nt.jsx("td",{className:"border px-3",children:e.label}),Nt.jsx("td",{className:"border px-3 text-center",children:t}),Nt.jsxs("td",{className:"border px-3 text-right",children:["",Number(n).toLocaleString()]})]},e.key)}),Nt.jsxs("tr",{className:"font-semibold",children:[Nt.jsx("td",{className:"border px-3",colSpan:"2",children:"TOTAL"}),Nt.jsxs("td",{className:"border px-3 text-right",children:["",Number(1e3*(b.denominationTotals.d1000||0)+500*(b.denominationTotals.d500||0)+200*(b.denominationTotals.d200||0)+100*(b.denominationTotals.d100||0)+50*(b.denominationTotals.d50||0)+20*(b.denominationTotals.d20||0)+(b.denominationTotals.coins||0)).toLocaleString()]})]})]})]})})]})]})}),s&&!b&&Nt.jsx("div",{className:"mb-4 rounded p-3 "+(i?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[Nt.jsxs("div",{className:"p-2 rounded border bg-indigo-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total Cash On Hand"}),Nt.jsxs("div",{className:"font-semibold text-lg",children:["",Number(R.totalCashOnHand).toLocaleString()]})]}),Nt.jsxs("div",{className:"p-2 rounded border bg-blue-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total System Balance"}),Nt.jsxs("div",{className:"font-semibold text-lg",children:["",Number(R.totalSystemBalance).toLocaleString()]})]}),Nt.jsxs("div",{className:"p-2 rounded border bg-red-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total Short"}),Nt.jsxs("div",{className:"font-semibold text-lg text-red-600",children:["",Number(R.totalShort).toLocaleString()]})]}),Nt.jsxs("div",{className:"p-2 rounded border bg-green-50",children:[Nt.jsx("div",{className:"text-xs text-gray-600",children:"Total Over"}),Nt.jsxs("div",{className:"font-semibold text-lg text-green-600",children:["",Number(R.totalOver).toLocaleString()]})]})]})}),s&&!b&&Nt.jsxs("div",{ref:E,className:`rounded-lg shadow-lg border ${i?"border-gray-700 bg-gray-800":"border-gray-300 bg-white"} p-4`,children:[Nt.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[Nt.jsxs("div",{children:[Nt.jsx("strong",{children:"Supervisor's Name: "}),Nt.jsx("span",{children:(null==s?void 0:s.supervisorName)||("supervisor"===e?(null==n?void 0:n.name)||(null==n?void 0:n.username):"N/A")})]}),Nt.jsxs("div",{children:[Nt.jsx("strong",{children:"Date: "}),Nt.jsx("span",{children:(new Date).toLocaleDateString()})]})]}),Nt.jsx("h2",{className:"text-center font-bold mb-3",children:"SUPERVISOR'S REPORT"}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full table-auto text-sm border-collapse",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:(i?"bg-gray-700":"bg-gray-200")+" text-center",children:[Nt.jsx("th",{className:"py-2 px-2 border",children:"TELLER'S NAME"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"SYSTEM BALANCE"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"CASH ON HAND"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"SHORT"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"OVER"}),("admin"===e||"super_admin"===e)&&Nt.jsx("th",{className:"py-2 px-2 border",children:"TOTAL BET"}),("admin"===e||"super_admin"===e)&&Nt.jsx("th",{className:"py-2 px-2 border",children:"ACTION"}),Nt.jsx("th",{className:"py-2 px-2 border",children:"REMARKS"})]})}),Nt.jsx("tbody",{children:N?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:"admin"===e||"super_admin"===e?8:6,className:"py-20 text-center",children:"Loading..."})}):Nt.jsxs(Nt.Fragment,{children:[D().map((t,r)=>{var i;const s="string"==typeof t.tellerId&&t.tellerId.startsWith("placeholder"),o=t.tellerId,l=t.verified?t.approvedByAdmin?"Approved":"Verified":"";return Nt.jsxs("tr",{className:"h-12",children:[Nt.jsx("td",{className:"px-2 border text-left",children:t.tellerName||""}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(t.systemBalance||0).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(t.cashOnHand||0).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right text-red-400",children:["",Number(t.short||0).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right text-green-400",children:["",Number(t.over||0).toLocaleString()]}),("admin"===e||"super_admin"===e)&&Nt.jsx("td",{className:"px-2 border text-right",children:s?"":Nt.jsx("input",{type:"number",className:"w-28 p-1 rounded bg-gray-900 text-white",onBlur:t=>function(t,r){return h(this,null,function*(){_(!0);try{yield pt.put(`${zc()}/api/reports/supervisor/update-bet/${t}`,{totalBet:Number(r||0)}),a({type:"success",message:"Total Bet updated"});const i="admin"===e||"super_admin"===e?p:null==n?void 0:n._id;i&&P(i)}catch(i){console.error("Failed to update Total Bet",i),a({type:"error",message:"Failed to update Total Bet"})}finally{_(!1)}})}(o,t.target.value),placeholder:"0",defaultValue:null!=(i=t.totalBet)?i:"",disabled:j})}),("admin"===e||"super_admin"===e)&&Nt.jsx("td",{className:"px-2 border text-center",children:s?"":Nt.jsx("button",{disabled:j,onClick:()=>function(t,r){return h(this,null,function*(){if(window.confirm(`Approve ${r}'s report and reset capital?`)){_(!0);try{yield pt.post(`${zc()}/api/reports/admin/approve/${t}`),a({type:"success",message:`${r} approved and capital reset`});const i="admin"===e||"super_admin"===e?p:null==n?void 0:n._id;i&&P(i)}catch(i){console.error("Failed to approve",i),a({type:"error",message:"Failed to approve"})}finally{_(!1)}}})}(o,t.tellerName),className:"px-2 py-1 rounded bg-green-600 hover:bg-green-700 text-white text-xs",children:t.approvedByAdmin?"Approved":"Approve"})}),Nt.jsx("td",{className:"px-2 border text-center",children:l})]},o||r)}),Nt.jsxs("tr",{className:"font-semibold bg-gray-100 dark:bg-gray-700",children:[Nt.jsx("td",{className:"px-2 border text-left",children:"TOTAL"}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(D().reduce((e,t)=>e+Number(t.systemBalance||0),0)).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right",children:["",Number(D().reduce((e,t)=>e+Number(t.cashOnHand||0),0)).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right text-red-400",children:["",Number(D().reduce((e,t)=>e+Number(t.short||0),0)).toLocaleString()]}),Nt.jsxs("td",{className:"px-2 border text-right text-green-400",children:["",Number(D().reduce((e,t)=>e+Number(t.over||0),0)).toLocaleString()]}),("admin"===e||"super_admin"===e)&&Nt.jsx("td",{className:"px-2 border"}),("admin"===e||"super_admin"===e)&&Nt.jsx("td",{className:"px-2 border"}),Nt.jsx("td",{className:"px-2 border"})]})]})})]})}),Nt.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[Nt.jsx("div",{}),Nt.jsx("div",{className:"md:col-span-2",children:Nt.jsxs("div",{className:"border rounded",children:[Nt.jsx("div",{className:(i?"bg-gray-700":"bg-gray-200")+" text-center font-semibold py-2",children:"Denomination of actual cash on hand"}),Nt.jsxs("table",{className:"w-full text-sm border-collapse denom-table",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"border py-2 px-3 text-left",children:"Denomination"}),Nt.jsx("th",{className:"border py-2 px-3 text-left",children:"PCS"}),Nt.jsx("th",{className:"border py-2 px-3 text-right",children:"TOTAL"})]})}),Nt.jsxs("tbody",{children:[[{key:"d1000",label:"1000",value:1e3},{key:"d500",label:"500",value:500},{key:"d200",label:"200",value:200},{key:"d100",label:"100",value:100},{key:"d50",label:"50",value:50},{key:"d20",label:"20",value:20},{key:"coins",label:"Coins (10/5/1 total)",value:1}].map(e=>{const t=(n=e.key,Number((null==(r=null==s?void 0:s.denominationTotals)?void 0:r[n])||0));var n,r;const a=t*e.value;return Nt.jsxs("tr",{className:"h-10",children:[Nt.jsx("td",{className:"border px-3",children:e.label}),Nt.jsx("td",{className:"border px-3",children:t}),Nt.jsxs("td",{className:"border px-3 text-right",children:["",Number(a||0).toLocaleString()]})]},e.key)}),Nt.jsxs("tr",{className:"font-semibold",children:[Nt.jsx("td",{className:"border px-3",children:"TOTAL"}),Nt.jsx("td",{className:"border px-3"}),Nt.jsxs("td",{className:"border px-3 text-right",children:["",Number(function(){const e=(null==s?void 0:s.denominationTotals)||{};return 1e3*Number(e.d1000||0)+500*Number(e.d500||0)+200*Number(e.d200||0)+100*Number(e.d100||0)+50*Number(e.d50||0)+20*Number(e.d20||0)+Number(e.coins||0)||0}()).toLocaleString()]})]})]})]})]})})]}),Nt.jsxs("div",{className:"mt-6 text-sm",children:[Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Total System Balance:"})," ",Number((null==s?void 0:s.totalSystemBalance)||0).toLocaleString()]}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Total Over:"})," ",Number((null==s?void 0:s.totalOver)||0).toLocaleString()]}),Nt.jsxs("p",{children:[Nt.jsx("strong",{children:"Total Short:"})," ",Number((null==s?void 0:s.totalShort)||0).toLocaleString()]})]}),Nt.jsxs("div",{className:"flex justify-between mt-10 text-sm",children:[Nt.jsxs("div",{className:"w-1/2 text-center",children:[Nt.jsx("div",{className:"border-t border-gray-500 w-2/3 mx-auto mb-1"}),"Supervisor's Signature"]}),Nt.jsxs("div",{className:"w-1/2 text-center",children:[Nt.jsx("div",{className:"border-t border-gray-500 w-2/3 mx-auto mb-1"}),"Admin's Signature"]})]})]})]})}function iF(){var e;const{user:t,settings:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),[i,s]=f.useState([]),[o,d]=f.useState(!1),[u,p]=f.useState([]),[m,g]=f.useState(!1),[x,y]=f.useState([]),[v,b]=f.useState(""),[w,N]=f.useState(""),[S,j]=f.useState(""),[_,A]=f.useState(["capital"]),[C,M]=f.useState(!1),[k,E]=f.useState(null),[T,P]=f.useState((new Date).toISOString().split("T")[0]),[D,I]=f.useState((new Date).toISOString().split("T")[0]),[O,B]=f.useState((new Date).toISOString().split("T")[0]),[L,F]=f.useState(!1),[U,z]=f.useState(null),[H,G]=f.useState({}),[V,$]=f.useState(null),[W,Y]=f.useState(!1),X=f.useRef(null),K=e=>{if(!e)return"";const t=e.toString().replace(/,/g,"");return isNaN(t)?e:Number(t).toLocaleString("en-US")},q=e=>e?e.toString().replace(/,/g,""):"",J=()=>h(null,null,function*(){var e,n,a,i;d(!0);try{if("admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role)){const t=localStorage.getItem("token"),n=t?{headers:{Authorization:`Bearer ${t}`}}:{},r=(null==(e=(yield pt.get(`${zc()}/api/admin/teller-overview`,l({params:{date:T}},n))).data)?void 0:e.tellers)||[];return void s(r)}const r=(()=>{try{return JSON.parse(localStorage.getItem("user")||"null")}catch(bI){return null}})();let i=(null==t?void 0:t._id)||(null==t?void 0:t.id)||(null==r?void 0:r._id)||(null==r?void 0:r.id)||void 0;if(i&&"object"==typeof i&&(i=i._id||i.id||String(i)),!i)return void s([]);const o=localStorage.getItem("token"),c=o?{headers:{Authorization:`Bearer ${o}`}}:{},d={supervisorId:i};L&&D&&O?(d.startDate=D,d.endDate=O):d.dateKey=T;const u=yield pt.get(`${zc()}/api/teller-management/tellers`,l({params:d},c)),h=Array.isArray(u.data)?u.data:(null==(n=u.data)?void 0:n.tellers)||(null==(a=u.data)?void 0:a.reports)||[];s(h||[])}catch(o){console.error(" Failed to fetch tellers:",(null==(i=null==o?void 0:o.response)?void 0:i.data)||(null==o?void 0:o.message)||o),r({type:"error",message:"Failed to fetch teller data"}),s([])}finally{d(!1)}}),ee=()=>h(null,null,function*(){var e;g(!0);try{const e=localStorage.getItem("token"),t=e?{headers:{Authorization:`Bearer ${e}`}}:{},[n,r]=yield Promise.all([pt.get(`${zc()}/api/users`,l({params:{role:"teller"}},t)),pt.get(`${zc()}/api/users`,l({params:{role:"supervisor"}},t))]),a=n.data||[],i=r.data||[],s=[...a,...i].sort((e,t)=>(e.name||e.username||"").localeCompare(t.name||t.username||""));p(s)}catch(t){console.error(" Failed to fetch users for form:",(null==(e=null==t?void 0:t.response)?void 0:e.data)||(null==t?void 0:t.message)||t),p([])}finally{g(!1)}});f.useEffect(()=>{(null==t?void 0:t._id)&&(J(),ee(),A(["capital"]),j(""));const e=()=>{J(),ee()},n=Vc();if(n)return n.on("tellerManagementUpdated",e),n.on("supervisorReportUpdated",e),n.on("tellerReportCreated",e),n.on("transactionUpdated",e),()=>{n.off("tellerManagementUpdated",e),n.off("supervisorReportUpdated",e),n.off("tellerReportCreated",e),n.off("transactionUpdated",e)}},[null==t?void 0:t._id,T,D,O,L]);const te=()=>{z(null),G({})};return Nt.jsxs("div",{className:"p-6 min-h-screen "+(a?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Nt.jsxs("h1",{className:"text-xl font-semibold flex items-center gap-2",children:[Nt.jsx(_e,{className:"w-5 h-5"}),"Capital Management"]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"flex items-center gap-2",children:L?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("label",{className:"text-sm font-medium",children:"From:"}),Nt.jsx("input",{type:"date",value:D,onChange:e=>I(e.target.value),className:"px-3 py-1 rounded border text-sm "+(a?"bg-gray-800 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900")}),Nt.jsx("label",{className:"text-sm font-medium",children:"To:"}),Nt.jsx("input",{type:"date",value:O,onChange:e=>B(e.target.value),className:"px-3 py-1 rounded border text-sm "+(a?"bg-gray-800 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900")}),Nt.jsx("button",{onClick:()=>F(!1),className:"px-3 py-1 rounded bg-gray-500 hover:bg-gray-600 text-white text-sm",title:"Back to single date view",children:" Single"})]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("label",{className:"text-sm font-medium",children:"Date:"}),Nt.jsx("input",{type:"date",value:T,onChange:e=>P(e.target.value),className:"px-3 py-1 rounded border text-sm "+(a?"bg-gray-800 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900")}),"super_admin"===(null==t?void 0:t.role)&&Nt.jsx("button",{onClick:()=>F(!0),className:"px-3 py-1 rounded bg-gray-500 hover:bg-gray-600 text-white text-sm",title:"View historical data by date range",children:" Range"})]})}),Nt.jsxs("button",{onClick:J,disabled:o,className:"flex items-center gap-2 px-3 py-1 rounded bg-indigo-600 hover:bg-indigo-700 text-white text-sm",children:[o?Nt.jsx(ue,{className:"w-4 h-4 animate-spin"}):Nt.jsx(Ae,{className:"w-4 h-4"}),"Refresh"]})]})]}),"admin"!==(null==t?void 0:t.role)&&Nt.jsxs("div",{ref:X,className:"p-6 mb-6 rounded-lg shadow-lg max-w-2xl mx-auto "+(a?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),onClick:e=>{if(!e.target.closest("#teller-dropdown")&&!e.target.closest(".dropdown-trigger")){const e=document.getElementById("teller-dropdown");null==e||e.classList.add("hidden")}},children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsxs("h2",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[Nt.jsx(Z,{className:"w-5 h-5"}),"Transaction Form"]}),Nt.jsx("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:"Add starting capital to any teller. For additional or remittance, select teller in overview below and use quick actions."})]}),Nt.jsxs("div",{className:"space-y-5",children:[Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsx("label",{className:"block text-sm font-semibold "+(a?"text-gray-200":"text-gray-700"),children:"Select Teller(s)"}),Nt.jsxs("div",{className:"relative",children:[Nt.jsx("div",{className:"w-full p-3 rounded-lg border focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all cursor-pointer dropdown-trigger "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"),onClick:()=>{const e=document.getElementById("teller-dropdown");null==e||e.classList.toggle("hidden")},children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{children:0===x.length?"Choose teller(s)...":`${x.length} teller(s) selected`}),Nt.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})}),Nt.jsxs("div",{id:"teller-dropdown",className:"absolute z-50 w-full mt-1 rounded-lg border shadow-lg max-h-60 overflow-y-auto hidden "+(a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),children:[m&&Nt.jsx("div",{className:"p-3 text-center text-gray-400",children:"Loading users..."}),!m&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-600",children:[Nt.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide px-2 py-1 "+(a?"text-gray-400":"text-gray-500"),children:" Tellers"}),u.filter(e=>"teller"===e.role||"supervisor_teller"===e.role).map(e=>Nt.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer "+(a?"text-gray-100":"text-gray-900"),children:[Nt.jsx("input",{type:"checkbox",checked:x.some(t=>t._id===e._id),onChange:t=>{t.target.checked?y(t=>[...t,e]):y(t=>t.filter(t=>t._id!==e._id)),A(["capital"]),j("capital")},className:"mr-3 w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500"}),e.name||e.username," (Teller)"]},e._id))]}),Nt.jsxs("div",{className:"p-2",children:[Nt.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide px-2 py-1 "+(a?"text-gray-400":"text-gray-500"),children:" Supervisors"}),u.filter(e=>"supervisor"===e.role).map(e=>Nt.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer "+(a?"text-gray-100":"text-gray-900"),children:[Nt.jsx("input",{type:"checkbox",checked:x.some(t=>t._id===e._id),onChange:t=>{t.target.checked?y(t=>[...t,e]):y(t=>t.filter(t=>t._id!==e._id)),A(["capital"]),j("capital")},className:"mr-3 w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500"}),e.name||e.username," (Supervisor)"]},e._id))]})]})]})]}),x.length>0&&Nt.jsxs("div",{className:"p-3 rounded-lg border "+(a?"bg-blue-900/20 border-blue-700/50":"bg-blue-50 border-blue-200"),children:[Nt.jsxs("div",{className:"text-sm font-medium mb-2 "+(a?"text-blue-400":"text-blue-600"),children:["Selected Tellers (",x.length,"):"]}),Nt.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(e=>Nt.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(a?"bg-blue-900/50 text-blue-300":"bg-blue-100 text-blue-800"),children:[e.name||e.username,Nt.jsx("button",{onClick:()=>{y(t=>t.filter(t=>t._id!==e._id))},className:"ml-1 hover:text-red-500 "+(a?"text-blue-400":"text-blue-600"),children:""})]},e._id))})]})]}),x.length>0&&Nt.jsx("div",{className:"p-4 rounded-lg border "+(x.every(e=>{var t;return"active"===(null==(t=e.activeCapital)?void 0:t.status)})?a?"bg-green-900/20 border-green-700/50":"bg-green-50 border-green-200":x.some(e=>{var t;return"active"===(null==(t=e.activeCapital)?void 0:t.status)})?a?"bg-yellow-900/20 border-yellow-700/50":"bg-yellow-50 border-yellow-200":a?"bg-amber-900/20 border-amber-700/50":"bg-amber-50 border-amber-200"),children:x.every(e=>{var t;return"active"===(null==(t=e.activeCapital)?void 0:t.status)})?Nt.jsxs("div",{className:"flex items-center gap-3 "+(a?"text-green-400":"text-green-600"),children:[Nt.jsx(Ce,{className:"w-5 h-5 flex-shrink-0"}),Nt.jsx("span",{className:"text-sm font-medium",children:"All selected users have active capital - you can add more or collect remittance"})]}):x.some(e=>{var t;return"active"===(null==(t=e.activeCapital)?void 0:t.status)})?Nt.jsxs("div",{className:"flex items-center gap-3 "+(a?"text-yellow-400":"text-yellow-600"),children:[Nt.jsx(Me,{className:"w-5 h-5 flex-shrink-0"}),Nt.jsx("span",{className:"text-sm font-medium",children:"Mixed status: Some users have active capital, others need initial capital"})]}):Nt.jsxs("div",{className:"flex items-center gap-3 "+(a?"text-amber-400":"text-amber-600"),children:[Nt.jsx(ke,{className:"w-5 h-5 flex-shrink-0"}),Nt.jsx("span",{className:"text-sm font-medium",children:"Selected users need starting capital before other transactions"})]})}),x.length>0&&Nt.jsxs("div",{className:"p-4 rounded-lg border space-y-4 "+(a?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"),children:[Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-2 text-sm font-semibold "+(a?"text-gray-200":"text-gray-700"),children:"Transaction Type"}),"additional"===S||"remit"===S?Nt.jsx("div",{className:"p-3 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm",children:"additional"===S?" Additional (selected from overview)":" Remittance (selected from overview)"}),Nt.jsx("button",{className:"text-xs underline "+(a?"text-indigo-300":"text-indigo-700"),onClick:()=>{j(""),A(["capital"])},children:"Clear"})]})}):Nt.jsxs("select",{value:S,onChange:e=>j(e.target.value),disabled:0===x.length,className:`w-full p-3 rounded-lg border focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all appearance-none ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"}\n                        ${0===x.length?" opacity-50 cursor-not-allowed":""}`,children:[Nt.jsx("option",{value:"",children:"Select type..."}),Nt.jsx("option",{value:"capital",children:" Add Capital"})]}),S&&Nt.jsxs("p",{className:"mt-2 text-xs "+(a?"text-gray-400":"text-gray-500"),children:["capital"===S&&" Create new starting capital for this teller","additional"===S&&" Add more money to existing capital","remit"===S&&" Record money collected from teller"]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-2 text-sm font-semibold "+(a?"text-gray-200":"text-gray-700"),children:"Amount"}),Nt.jsxs("div",{className:"relative",children:[Nt.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:Nt.jsx(xe,{className:"w-5 h-5 text-gray-400"})}),Nt.jsx("input",{type:"text",value:K(v),onChange:e=>b(q(e.target.value)),className:"w-full pl-10 pr-4 p-3 rounded-lg border focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"),placeholder:"Enter amount..."})]})]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-2 text-sm font-semibold "+(a?"text-gray-200":"text-gray-700"),children:"Note (Optional)"}),Nt.jsx("input",{type:"text",value:w,onChange:e=>N(e.target.value),className:"w-full p-3 rounded-lg border focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all "+(a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"),placeholder:"Add a note about this transaction..."})]})]}),x.length>0&&Nt.jsx("div",{className:"pt-4",children:Nt.jsx("button",{disabled:C||0===x.length||!S||!v,onClick:()=>h(null,null,function*(){var e;if(0!==x.length&&v)if(S&&_.includes(S))if(Number(v)<=0)r({type:"error",message:"Amount must be greater than 0"});else{M(!0);try{const e=x.map(e=>h(null,null,function*(){const n=localStorage.getItem("token"),r=n?{headers:{Authorization:`Bearer ${n}`}}:{};return"capital"===S?pt.post(`${zc()}/api/teller-management/add-capital`,{tellerId:e._id,supervisorId:null==t?void 0:t._id,amount:Number(v),note:w,performedBy:(null==t?void 0:t.name)||(null==t?void 0:t.username)},r):"additional"===S?pt.put(`${zc()}/api/teller-management/${e._id}/add-capital`,{amount:Number(v),note:w,userId:null==t?void 0:t._id},r):"remit"===S?pt.put(`${zc()}/api/teller-management/${e._id}/remit`,{amount:Number(v),note:w,userId:null==t?void 0:t._id},r):void 0}));yield Promise.all(e),r({type:"success",message:`Transaction completed for ${x.length} teller(s)`}),b(""),N(""),y([]),x.length>0&&(A(["capital"]),j("capital")),J()}catch(n){console.error(" Submit error:",(null==(e=null==n?void 0:n.response)?void 0:e.data)||n),r({type:"error",message:"Failed to process request for some tellers"})}finally{M(!1)}}else r({type:"error",message:"Please select a valid action type"});else r({type:"info",message:"Please select teller(s) and enter amount"})}),className:"w-full flex items-center justify-center gap-3 px-6 py-3.5 rounded-lg font-semibold text-white text-base transition-all transform "+(!C&&0!==x.length&&S&&v?"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]":"bg-gray-500 cursor-not-allowed opacity-50"),children:C?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{className:"w-5 h-5 animate-spin"}),Nt.jsxs("span",{children:["Processing ",x.length," Transaction(s)..."]})]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(Z,{className:"w-5 h-5"}),Nt.jsxs("span",{children:["Submit Transaction for ",x.length," Teller(s)"]})]})})})]})]}),Nt.jsxs("div",{className:"rounded-lg shadow-lg p-4 "+(a?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(xe,{className:"w-5 h-5"}),"admin"===(null==t?void 0:t.role)?"All Tellers Overview":"Tellers Overview",!o&&i.length>0&&Nt.jsxs("span",{className:"text-xs font-normal "+(a?"text-gray-400":"text-gray-500"),children:["(",i.filter(e=>e.activeCapital).length," with transactions)"]})]}),T!==(new Date).toISOString().split("T")[0]&&!L&&Nt.jsxs("span",{className:"text-sm px-3 py-1 rounded-full font-medium "+(a?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800"),children:[" Viewing: ",new Date(T+"T00:00:00").toLocaleDateString()]}),L&&D&&O&&Nt.jsxs("span",{className:"text-sm px-3 py-1 rounded-full font-medium "+(a?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"),children:[" Historical View: ",new Date(D+"T00:00:00").toLocaleDateString()," - ",new Date(O+"T00:00:00").toLocaleDateString()]})]}),o?Nt.jsxs("div",{className:"text-center py-10 text-gray-400 flex items-center justify-center gap-2",children:[Nt.jsx(ue,{className:"animate-spin w-5 h-5"})," Loading tellers..."]}):Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full border-collapse text-sm",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:""+(a?"bg-gray-700":"bg-gray-200"),children:[Nt.jsx("th",{className:"border px-3 py-2 text-left",children:"Teller Name"}),"admin"===(null==t?void 0:t.role)&&Nt.jsx("th",{className:"border px-3 py-2 text-left",children:"Supervisor"}),Nt.jsx("th",{className:"border px-3 py-2 text-right",children:"Capital"}),Nt.jsx("th",{className:"border px-3 py-2 text-right",children:"Additional (Total)"}),Nt.jsx("th",{className:"border px-3 py-2 text-right",children:"+Today"}),Nt.jsx("th",{className:"border px-3 py-2 text-right",children:"Remitted (Total)"}),Nt.jsx("th",{className:"border px-3 py-2 text-right",children:"-Today"}),Nt.jsx("th",{className:"border px-3 py-2 text-right",children:"Remaining"}),Nt.jsx("th",{className:"border px-3 py-2 text-center",children:"Status"}),Nt.jsx("th",{className:"border px-3 py-2 text-center",children:"Actions"})]})}),Nt.jsx("tbody",{children:0===i.length?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:"admin"===(null==t?void 0:t.role)?10:9,className:"text-center py-10 text-gray-400",children:"No tellers found."})}):i.filter(e=>"admin"===(null==t?void 0:t.role)||(e.baseCapital>0||e.additionalCapital>0)).map(e=>{var n;const i=e.activeCapital,s="active"===(null==i?void 0:i.status);return Nt.jsxs("tr",{className:"h-12 transition-colors "+(s?a?"bg-green-900/20 hover:bg-green-900/30":"bg-green-50 hover:bg-green-100":a?"hover:bg-gray-700/30":"hover:bg-gray-50"),children:[Nt.jsxs("td",{className:"border px-3 flex items-center gap-2 "+(a?"border-gray-700":"border-gray-200"),children:[Nt.jsx("span",{className:"w-2.5 h-2.5 rounded-full "+(s?"bg-green-500":"bg-gray-400"),title:s?"Active Capital":"No Active Capital"}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("button",{className:"text-left hover:underline "+(a?"text-indigo-300":"text-indigo-700"),onClick:()=>h(null,null,function*(){E(t=>t===e._id?null:e._id)}),title:"Select actions",children:e.name||e.username}),Nt.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full "+("supervisor"===e.role?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300"),children:"supervisor"===e.role?"Supervisor":"Teller"})]}),k===e._id&&Nt.jsxs("div",{className:"mt-2 flex gap-2",children:[Nt.jsx("button",{className:"px-2 py-1 text-xs rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>h(null,null,function*(){var t;e.activeCapital?(y([e]),A(["additional"]),j("additional"),null==(t=X.current)||t.scrollIntoView({behavior:"smooth",block:"start"})):r({type:"warning",message:"Additional not available (no active capital)."})}),children:" Additional"}),Nt.jsx("button",{className:"px-2 py-1 text-xs rounded bg-emerald-600 text-white hover:bg-emerald-700",onClick:()=>h(null,null,function*(){var t;e.activeCapital?(y([e]),A(["remit"]),j("remit"),null==(t=X.current)||t.scrollIntoView({behavior:"smooth",block:"start"})):r({type:"warning",message:"Remittance not available (no active capital)."})}),children:" Remittance"})]})]}),"admin"===(null==t?void 0:t.role)&&Nt.jsx("td",{className:"border px-3 text-left "+(a?"border-gray-700 text-gray-100":"border-gray-200 text-gray-900"),children:e.supervisorName||(null==(n=e.supervisor)?void 0:n.name)||"Not assigned"}),Nt.jsx("td",{className:"border px-3 text-right "+(a?"border-gray-700 text-gray-100":"border-gray-200 text-gray-900"),children:U===e._id?Nt.jsx("input",{type:"text",value:K(H.baseCapital),onChange:e=>G(c(l({},H),{baseCapital:q(e.target.value)})),className:"w-full px-2 py-1 text-right border rounded "+(a?"bg-gray-700 border-gray-600":"bg-white border-gray-300")}):`${Number(e.baseCapital||0).toLocaleString()}`}),Nt.jsx("td",{className:"border px-3 text-right "+(a?"border-gray-700 text-emerald-400":"border-gray-200 text-emerald-600"),children:U===e._id?Nt.jsx("input",{type:"text",value:K(H.additionalCapital),onChange:e=>G(c(l({},H),{additionalCapital:q(e.target.value)})),className:"w-full px-2 py-1 text-right border rounded "+(a?"bg-gray-700 border-gray-600":"bg-white border-gray-300")}):`${Number(e.additionalCapital||0).toLocaleString()}`}),Nt.jsxs("td",{className:"border px-3 text-right font-semibold "+(a?"border-gray-700 text-blue-400":"border-gray-200 text-blue-600"),children:["",Number(e.additionalToday||0).toLocaleString()]}),Nt.jsx("td",{className:"border px-3 text-right "+(a?"border-gray-700 text-green-400":"border-gray-200 text-green-600"),children:U===e._id?Nt.jsx("input",{type:"text",value:K(H.remitted),onChange:e=>G(c(l({},H),{remitted:q(e.target.value)})),className:"w-full px-2 py-1 text-right border rounded "+(a?"bg-gray-700 border-gray-600":"bg-white border-gray-300")}):`${Number((null==i?void 0:i.totalRemitted)||0).toLocaleString()}`}),Nt.jsxs("td",{className:"border px-3 text-right font-semibold "+(a?"border-gray-700 text-orange-400":"border-gray-200 text-orange-600"),children:["",Number(e.remittanceToday||0).toLocaleString()]}),Nt.jsxs("td",{className:"border px-3 text-right "+(a?"border-gray-700 text-yellow-400":"border-gray-200 text-yellow-600"),children:["",Number((e.baseCapital||0)+(e.additionalCapital||0)-((null==i?void 0:i.totalRemitted)||0)).toLocaleString()]}),Nt.jsx("td",{className:"border px-3 text-center "+(a?"border-gray-700":"border-gray-200"),children:"completed"===(null==i?void 0:i.status)?Nt.jsx("span",{className:"text-green-500 font-semibold",children:"Completed"}):"active"===(null==i?void 0:i.status)?Nt.jsx("span",{className:"text-blue-400 font-semibold",children:"Active"}):"-"}),Nt.jsx("td",{className:"border px-3 text-center "+(a?"border-gray-700":"border-gray-200"),children:U===e._id&&"admin"===(null==t?void 0:t.role)?Nt.jsxs("div",{className:"flex items-center justify-center gap-2",children:[Nt.jsxs("button",{onClick:()=>{return t=e._id,h(null,null,function*(){var e;M(!0);try{const e=localStorage.getItem("token"),n=e?{headers:{Authorization:`Bearer ${e}`}}:{};yield pt.put(`${zc()}/api/teller-management/${t}/update-values`,{baseCapital:Number(H.baseCapital),additionalCapital:Number(H.additionalCapital),totalRemitted:Number(H.remitted)},n),r({type:"success",message:"Teller data updated successfully"}),z(null),G({}),J()}catch(n){console.error(" Update error:",(null==(e=null==n?void 0:n.response)?void 0:e.data)||n),r({type:"error",message:"Failed to update teller data"})}finally{M(!1)}});var t},disabled:C,className:"px-2 py-1 rounded bg-green-600 hover:bg-green-700 text-white text-xs flex items-center gap-1",title:"Save changes",children:[Nt.jsx(Ee,{className:"w-3 h-3"}),"Save"]}),Nt.jsxs("button",{onClick:te,disabled:C,className:"px-2 py-1 rounded bg-gray-600 hover:bg-gray-700 text-white text-xs flex items-center gap-1",title:"Cancel",children:[Nt.jsx(ce,{className:"w-3 h-3"}),"Cancel"]})]}):Nt.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:["admin"===(null==t?void 0:t.role)&&Nt.jsxs("button",{onClick:()=>(e=>{var t;z(e._id),G({baseCapital:e.baseCapital||0,additionalCapital:e.additionalCapital||0,remitted:(null==(t=e.activeCapital)?void 0:t.totalRemitted)||0})})(e),className:"px-2 py-1 rounded bg-indigo-600 hover:bg-indigo-700 text-white text-xs flex items-center gap-1",title:"Edit values",children:[Nt.jsx(Q,{className:"w-3 h-3"}),"Edit"]}),"active"===(null==i?void 0:i.status)&&Nt.jsxs("button",{onClick:()=>$({tellerId:e._id,tellerName:e.name||e.username,capitalId:i._id}),className:"px-2 py-1 rounded bg-red-600 hover:bg-red-700 text-white text-xs flex items-center gap-1",title:"Delete capital and reset base salary",children:[Nt.jsx(R,{className:"w-3 h-3"}),"Delete"]})]})})]},e._id)})})]})})]}),V&&Nt.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"rounded-lg shadow-2xl max-w-md w-full p-6 "+(a?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Nt.jsx(Me,{className:"w-6 h-6 text-red-500 flex-shrink-0"}),Nt.jsx("h2",{className:"text-lg font-semibold",children:"Delete Capital?"})]}),Nt.jsxs("p",{className:"mb-4 text-sm "+(a?"text-gray-300":"text-gray-700"),children:["Are you sure you want to delete the capital for ",Nt.jsx("strong",{children:V.tellerName}),"?"]}),Nt.jsxs("div",{className:"p-3 rounded-lg mb-4 border "+(a?"bg-red-900/20 border-red-700/50 text-red-300":"bg-red-50 border-red-200 text-red-700"),children:[Nt.jsx("p",{className:"text-sm font-medium",children:"This will:"}),Nt.jsxs("ul",{className:"text-xs mt-2 space-y-1 list-disc list-inside",children:[Nt.jsx("li",{children:"Remove the active capital record"}),Nt.jsx("li",{children:"Reset base salary to 0"}),Nt.jsx("li",{children:"Delete all related transactions"})]})]}),Nt.jsxs("div",{className:"flex gap-2 justify-end",children:[Nt.jsx("button",{onClick:()=>$(null),disabled:W,className:`px-4 py-2 rounded text-sm font-medium ${a?"bg-gray-700 hover:bg-gray-600 text-gray-100":"bg-gray-200 hover:bg-gray-300 text-gray-900"} disabled:opacity-50 disabled:cursor-not-allowed`,children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e;if(V){Y(!0);try{const e=localStorage.getItem("token"),t=e?{headers:{Authorization:`Bearer ${e}`}}:{},{tellerId:n,capitalId:a}=V;yield pt.delete(`${zc()}/api/teller-management/${n}/capital/${a}`,t),r({type:"success",message:`Capital removed and base salary reset to 0 for ${V.tellerName}`}),$(null),J()}catch(t){console.error(" Delete error:",(null==(e=null==t?void 0:t.response)?void 0:e.data)||t),r({type:"error",message:"Failed to delete capital"})}finally{Y(!1)}}}),disabled:W,className:"px-4 py-2 rounded text-sm font-medium bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:W?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(R,{className:"w-4 h-4"}),"Delete Capital"]})})]})]})})]})}const sF=Hc;function oF(){var e;const{settings:t}=f.useContext($c),n=(null==t?void 0:t.theme)||{},r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState(null),[s,o]=f.useState(""),[l,c]=f.useState(!0),[d,u]=f.useState(!0),[p,m]=f.useState(1e4),g=()=>h(null,null,function*(){try{const e=yield pt.get(`${sF}/api/report/admin`);i(e.data),c(!1),o(" Data updated automatically"),setTimeout(()=>o(""),2e3)}catch(e){console.error("Error loading admin report:",e),o(" Failed to load admin report")}});return f.useEffect(()=>{if(g(),d){const e=setInterval(()=>{g()},p);return()=>clearInterval(e)}},[d,p]),l?Nt.jsx("div",{className:"p-6 text-center",style:{backgroundColor:r?n.darkBg:n.lightBg,color:r?n.darkFont:n.lightFont},children:"Loading Admin Report..."}):Nt.jsxs("div",{className:"p-6 min-h-screen",style:{backgroundColor:r?n.darkBg:n.lightBg,color:r?n.darkFont:n.lightFont},children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsx("h1",{className:"text-2xl font-bold",children:" ADMIN REPORT"}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:g,className:"px-3 py-2 rounded text-sm",style:{backgroundColor:r?n.darkFont:"#2563eb",color:r?n.darkBg:"#fff"},children:" Refresh Now"}),Nt.jsxs("label",{className:"flex items-center gap-1 text-sm",children:[Nt.jsx("input",{type:"checkbox",checked:d,onChange:e=>u(e.target.checked)}),"Auto-refresh"]})]})]}),s&&Nt.jsx("p",{className:"text-green-500 mb-4 transition-all duration-500",children:s}),Nt.jsx("div",{className:"rounded-xl shadow p-4",style:{backgroundColor:r?"#071026":"#fff"},children:Nt.jsx("table",{className:"w-full text-left border-collapse",children:Nt.jsxs("tbody",{children:[Nt.jsx(lF,{label:" OVERALL CAPITAL",value:a.overallCapital}),Nt.jsx(lF,{label:" STARTING CAPITAL",value:a.startingCapital}),Nt.jsx(lF,{label:" REVOLVING",value:a.revolving}),Nt.jsx(lF,{label:" SALARY & OVER",value:a.salaryOver}),Nt.jsx(lF,{label:" EXPENSES",value:a.expenses,highlight:!0}),Nt.jsx(lF,{label:" COMMISSION",value:a.commission}),Nt.jsx(lF,{label:" DRAW",value:a.draw}),Nt.jsx(lF,{label:" RMI SHARE (50%)",value:a.rmiShare}),Nt.jsx(lF,{label:" OPERATOR SHARE (50%)",value:a.operatorShare}),Nt.jsx(lF,{label:" OPERATOR OVER",value:a.operatorOver}),Nt.jsx(lF,{label:" OP COM & OVER",value:a.opComOver})]})})}),Nt.jsx(cF,{theme:n,darkMode:r})]})}function lF({label:e,value:t,highlight:n=!1}){return Nt.jsxs("tr",{className:"border-b",children:[Nt.jsx("td",{className:"py-3 font-semibold text-lg",children:e}),Nt.jsxs("td",{className:"py-3 text-right text-xl font-bold "+(n?"text-red-500 animate-pulse":"text-indigo-600"),children:["",Number(t||0).toLocaleString()]})]})}function cF({theme:e,darkMode:t}){const[n,r]=f.useState([]),[a,i]=f.useState(!0);return f.useEffect(()=>{h(null,null,function*(){try{const e=yield pt.get(`${sF}/api/report/admin/history`);r(e.data),i(!1)}catch(e){console.error("Failed to load history:",e)}})},[]),a?Nt.jsx("p",{className:"mt-6",children:"Loading history..."}):Nt.jsxs("div",{className:"mt-10 rounded-xl shadow p-4",style:{backgroundColor:t?"#071026":"#fff"},children:[Nt.jsx("h2",{className:"text-xl font-bold mb-4",children:" 7-Day Summary"}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-left border-collapse text-sm",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{style:{backgroundColor:t?"#0b1220":"#f3f4f6"},children:[Nt.jsx("th",{className:"p-2",children:"Date"}),Nt.jsx("th",{className:"p-2 text-right",children:"Overall"}),Nt.jsx("th",{className:"p-2 text-right",children:"Start Cap"}),Nt.jsx("th",{className:"p-2 text-right",children:"Revolving"}),Nt.jsx("th",{className:"p-2 text-right",children:"Salary+Over"}),Nt.jsx("th",{className:"p-2 text-right",children:"Expense"}),Nt.jsx("th",{className:"p-2 text-right",children:"Commission"}),Nt.jsx("th",{className:"p-2 text-right",children:"Draw"}),Nt.jsx("th",{className:"p-2 text-right",children:"Op Over"}),Nt.jsx("th",{className:"p-2 text-right",children:"OpCom+Over"})]})}),Nt.jsx("tbody",{children:n.map((e,t)=>Nt.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[Nt.jsx("td",{className:"p-2 font-semibold",children:e.date}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.overallCapital).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.startingCapital).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.revolving).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.salaryOver).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right text-red-500",children:["",Number(e.expenses).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.commission).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.draw).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right text-indigo-500",children:["",Number(e.operatorOver).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right text-green-600 font-bold",children:["",Number(e.opComOver).toLocaleString()]})]},t))})]})})]})}function dF(){const[e,t]=f.useState([]),[n,r]=f.useState(null),[a,i]=f.useState(!0),[s,o]=f.useState(""),[l,c]=f.useState(""),d="https://rmi-backend-zhdr.onrender.com",u=()=>h(null,null,function*(){try{const[e,n]=yield Promise.all([pt.get(`${d}/users`),pt.get(`${d}/admin/assistant`)]),a=e.data.filter(e=>"supervisor"===e.role);t(a),r(n.data)}catch(e){console.error("Error loading data:",e),c(" Failed to load supervisors or assistant admin.")}finally{i(!1)}});f.useEffect(()=>{u()},[]);return Nt.jsx(nd,{role:"admin",children:Nt.jsxs("div",{className:"p-6 fade-in",children:[Nt.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100",children:" Assistant Admin Control"}),a?Nt.jsx("p",{className:"text-gray-500",children:"Loading data..."}):Nt.jsxs("div",{className:"space-y-6",children:[Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-2xl shadow",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-2 text-gray-700 dark:text-gray-200",children:"Current Assistant Admin"}),n&&n._id?Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("p",{className:"text-gray-800 dark:text-gray-100",children:[Nt.jsx("strong",{children:n.fullName})," (",n.username,")"]}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(!(null==n?void 0:n._id))return alert("No assistant assigned currently.");try{yield pt.put(`${d}/admin/assign-assistant/${n._id}`,{assign:!1}),c(" Assistant Admin removed."),u()}catch(e){console.error(e),c(" Failed to remove Assistant Admin.")}}),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg shadow",children:"Remove"})]}):Nt.jsx("p",{className:"text-gray-500",children:"No Assistant Admin assigned."})]}),Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-2xl shadow",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-2 text-gray-700 dark:text-gray-200",children:"Assign New Assistant Admin"}),Nt.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-3",children:[Nt.jsxs("select",{className:"p-2 border rounded-lg flex-1 dark:bg-gray-700 dark:text-gray-100",value:s,onChange:e=>o(e.target.value),children:[Nt.jsx("option",{value:"",children:"Select Supervisor"}),e.map(e=>Nt.jsx("option",{value:e._id,children:e.fullName||e.username},e._id))]}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(!s)return alert("Please select a supervisor first.");try{yield pt.put(`${d}/admin/assign-assistant/${s}`,{assign:!0}),c(" Assistant Admin assigned successfully!"),u()}catch(e){console.error(e),c(" Failed to assign Assistant Admin.")}}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg shadow",children:"Assign"})]})]}),l&&Nt.jsx("div",{className:"p-3 mt-3 rounded-lg bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 shadow",children:l})]})]})})}const uF=Hc;function hF(){var e;const{settings:t}=f.useContext($c),n=(null==t?void 0:t.theme)||{},r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState(""),[s,o]=f.useState(null),[l,c]=f.useState(!0),[d,u]=f.useState([]),[p,m]=f.useState(""),[g,x]=f.useState(""),[y,v]=f.useState("Supplies"),[b,w]=f.useState(null),[N,S]=f.useState(0),[j,_]=f.useState(""),[A,C]=f.useState((new Date).toISOString().split("T")[0]);f.useEffect(()=>{h(null,null,function*(){try{const e=yield pt.get(`${uF}/api/cashflow`);o(e.data)}catch(e){console.error(" Failed to load cashflow:",e)}finally{c(!1)}})},[]);const M=(...e)=>h(null,[...e],function*(e=A){var t;try{const t=yield pt.get(`${uF}/api/cashflow`,{params:{date:e}}),n=(Array.isArray(t.data)?t.data:[]).filter(e=>"expense"===e.type);u(n);const r=n.reduce((e,t)=>e+(Number(t.amount)||0),0);S(r)}catch(n){console.error(" Failed to load expenses:",(null==(t=null==n?void 0:n.response)?void 0:t.data)||n.message),u([]),S(0)}});return f.useEffect(()=>{M()},[A]),l?Nt.jsx("div",{className:"p-8",children:"Loading..."}):Nt.jsxs("div",{className:"p-6 min-h-screen",style:{backgroundColor:r?n.darkBg:n.lightBg,color:r?n.darkFont:n.lightFont},children:[Nt.jsx("h1",{className:"text-2xl font-bold mb-4",children:" Cash Flow Management"}),Nt.jsxs("div",{className:"space-y-4 max-w-md mb-8",children:[Nt.jsxs("label",{className:"block",children:[Nt.jsx("span",{className:"text-sm font-medium",children:"Overall Capital"}),Nt.jsx("input",{type:"number",value:a,onChange:e=>i(e.target.value),placeholder:(null==s?void 0:s.overallCapital)||"Enter capital",className:"mt-1 w-full border rounded-md p-2",style:{backgroundColor:r?n.darkBg:"#fff",color:r?n.darkFont:"#111",borderColor:r?"#374151":"#d1d5db"}})]}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){try{const e=yield pt.put(`${uF}/api/cashflow`,{overallCapital:Number(a)});alert(" Cashflow updated!"),o(e.data.data)}catch(e){console.error(" Error updating capital:",e),alert("Failed to update capital")}}),className:"px-4 py-2 rounded-md",style:{backgroundColor:r?n.darkFont:"#4f46e5",color:r?n.darkBg:"#fff"},children:" Save Capital"}),s&&Nt.jsxs("div",{className:"mt-4 text-sm",style:{color:r?n.darkFont:"#374151"},children:[Nt.jsxs("p",{children:[" ",Nt.jsx("strong",{children:"Last Updated:"})," ",new Date(s.lastUpdated).toLocaleString()]}),Nt.jsxs("p",{children:[" ",Nt.jsx("strong",{children:"Current Capital:"})," ",(s.overallCapital||0).toLocaleString()]})]})]}),Nt.jsxs("div",{className:"p-5 rounded-xl shadow mb-6",style:{backgroundColor:r?"#0b1220":"#fff",borderColor:r?"#1f2937":"#e5e7eb"},children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Nt.jsx("h2",{className:"text-lg font-semibold",children:b?" Edit Expense":" Add Expense"}),Nt.jsx("input",{type:"date",value:A,onChange:e=>C(e.target.value),className:"border rounded p-2 text-sm",style:{backgroundColor:r?n.darkBg:"#fff",color:r?n.darkFont:"#111"}})]}),Nt.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[Nt.jsxs("select",{value:y,onChange:e=>v(e.target.value),className:"border p-2 rounded w-40",style:{backgroundColor:r?n.darkBg:"#fff",color:r?n.darkFont:"#111"},children:[Nt.jsx("option",{children:"Supplies"}),Nt.jsx("option",{children:"Food"}),Nt.jsx("option",{children:"Utilities"}),Nt.jsx("option",{children:"Maintenance"}),Nt.jsx("option",{children:"Miscellaneous"})]}),Nt.jsx("input",{type:"text",placeholder:"Description",value:p,onChange:e=>m(e.target.value),className:"border p-2 rounded flex-1 min-w-[150px]",style:{backgroundColor:r?n.darkBg:"#fff",color:r?n.darkFont:"#111"}}),Nt.jsx("input",{type:"number",placeholder:"Amount",value:g,onChange:e=>x(e.target.value),className:"border p-2 rounded w-40 text-right",style:{backgroundColor:r?n.darkBg:"#fff",color:r?n.darkFont:"#111"}}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(p&&g)try{b?(yield pt.put(`${uF}/api/cashflow/${b._id}`,{type:"expense",description:p,amount:Number(g),category:y,date:A}),_(" Expense updated!")):(yield pt.post(`${uF}/api/cashflow`,{type:"expense",description:p,amount:Number(g),category:y,date:A}),_(" Expense added!")),m(""),x(""),v("Supplies"),w(null),setTimeout(()=>_(""),1500),M()}catch(e){console.error(" Error saving expense:",e),_(" Failed to save expense.")}else _("Warning: Please fill in all fields.")}),className:"px-4 py-2 rounded",style:{backgroundColor:r?n.darkFont:"#2563eb",color:r?n.darkBg:"#fff"},children:b?" Update":" Add"}),b&&Nt.jsx("button",{onClick:()=>{w(null),m(""),x("")},className:"px-4 py-2 rounded",style:{backgroundColor:r?"#374151":"#9ca3af",color:r?"#fff":"#111"},children:"Cancel"})]}),j&&Nt.jsx("p",{className:"mt-3 font-medium",children:j})]}),Nt.jsxs("div",{className:"p-4 rounded-xl shadow",style:{backgroundColor:r?"#071026":"#fff",color:r?n.darkFont:"#111"},children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-3",children:[" Expenses for ",new Date(A).toLocaleDateString()]}),Nt.jsxs("table",{className:"w-full text-left border-collapse text-sm",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{style:{backgroundColor:r?"#0b1220":"#f3f4f6"},children:[Nt.jsx("th",{className:"p-2",children:"Category"}),Nt.jsx("th",{className:"p-2",children:"Description"}),Nt.jsx("th",{className:"p-2 text-right",children:"Amount"}),Nt.jsx("th",{className:"p-2 text-right",children:"Time"}),Nt.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),Nt.jsxs("tbody",{children:[Array.isArray(d)&&d.length>0?d.map(e=>Nt.jsxs("tr",{className:"border-b",children:[Nt.jsx("td",{className:"p-2",children:e.category}),Nt.jsx("td",{className:"p-2",children:e.description}),Nt.jsxs("td",{className:"p-2 text-right",children:["",Number(e.amount).toLocaleString()]}),Nt.jsx("td",{className:"p-2 text-right",children:new Date(e.date).toLocaleTimeString()}),Nt.jsxs("td",{className:"p-2 text-right",children:[Nt.jsx("button",{onClick:()=>(e=>{w(e),m(e.description),x(e.amount),v(e.category)})(e),className:"text-blue-600 hover:underline mr-2",children:"Edit"}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(window.confirm("Delete this expense?"))try{yield pt.delete(`${uF}/api/cashflow/${t}`),M()}catch(e){console.error(" Error deleting expense:",e)}});var t},className:"text-red-600 hover:underline",children:"Delete"})]})]},e._id)):Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:"5",className:"text-center py-3",children:"No expenses recorded on this date."})}),Nt.jsxs("tr",{className:"font-bold",children:[Nt.jsx("td",{colSpan:"2",className:"p-2 text-right",children:"TOTAL"}),Nt.jsxs("td",{className:"p-2 text-right text-indigo-600 text-lg",children:["",Number(N||0).toLocaleString()]}),Nt.jsx("td",{colSpan:"2"})]})]})]})]})]})}function pF(){var e;const{settings:t}=f.useContext($c),{showToast:n}=Kc(),r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState([]),[s,o]=f.useState(!1),[d,u]=f.useState(""),[p,m]=f.useState("all"),[g,x]=f.useState(null),[y,v]=f.useState(""),[b,w]=f.useState(""),[N,S]=f.useState(""),[j,_]=f.useState(""),[A,C]=f.useState(!1),M=()=>h(null,null,function*(){o(!0);try{const e=zc(),t=yield pt.get(`${e}/api/admin/users`);i(t.data||[])}catch(e){console.error(" Fetch users error:",e),n({type:"error",message:"Failed to fetch users."})}finally{o(!1)}});f.useEffect(()=>{M();const e=Vc();return e&&(e.on("userUpdated",M),e.on("userDeleted",M)),()=>{e&&(e.off("userUpdated",M),e.off("userDeleted",M))}},[]);const E=a.filter(e=>{var t,n,r;const a=d.toLowerCase(),i=(null==(t=e.username)?void 0:t.toLowerCase().includes(a))||(null==(n=e.name)?void 0:n.toLowerCase().includes(a))||(null==(r=e._id)?void 0:r.toLowerCase().includes(a)),s="all"===p||("approved"===p?e.active||"approved"===e.status:"pending"===p?!(e.active||"pending"!==e.status&&e.status):"deactivated"!==p||!1===e.active&&"approved"!==e.status);return i&&s});return Nt.jsxs("div",{className:"p-6 transition-all "+(r?"bg-gray-950 text-gray-100":"bg-gray-100 text-gray-800"),children:[Nt.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-6",children:[Nt.jsx("h1",{className:"text-xl font-bold",children:" User Management"}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("input",{type:"text",placeholder:"Search by name, username, or ID...",value:d,onChange:e=>u(e.target.value),className:"px-3 py-2 border rounded-md bg-transparent"}),Nt.jsxs("select",{value:p,onChange:e=>m(e.target.value),className:"px-3 py-2 border rounded-md bg-transparent",children:[Nt.jsx("option",{value:"all",children:"All"}),Nt.jsx("option",{value:"approved",children:"Approved"}),Nt.jsx("option",{value:"pending",children:"Pending"}),Nt.jsx("option",{value:"deactivated",children:"Deactivated"})]})]})]}),s?Nt.jsx("div",{className:"flex justify-center py-10",children:Nt.jsx(ue,{className:"animate-spin h-8 w-8 text-indigo-500"})}):Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"min-w-full border rounded-lg "+(r?"border-gray-700":"border-gray-300"),children:[Nt.jsx("thead",{className:""+(r?"bg-gray-800 text-gray-200":"bg-gray-200 text-gray-700"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-4 py-3 text-left",children:"ID"}),Nt.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),Nt.jsx("th",{className:"px-4 py-3 text-left",children:"Username"}),Nt.jsx("th",{className:"px-4 py-3 text-left",children:"Password"}),Nt.jsx("th",{className:"px-4 py-3 text-left",children:"Role"}),Nt.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),Nt.jsx("th",{className:"px-4 py-3 text-center",children:"Actions"})]})}),Nt.jsxs("tbody",{children:[E.map(e=>Nt.jsxs("tr",{className:`border-t ${r?"border-gray-700":"border-gray-300"} hover:bg-indigo-50 dark:hover:bg-gray-800`,children:[Nt.jsx("td",{className:"px-4 py-3 font-mono text-xs text-gray-500 dark:text-gray-400",children:e._id}),Nt.jsx("td",{className:"px-4 py-3",children:e.name||""}),Nt.jsx("td",{className:"px-4 py-3",children:e.username}),Nt.jsx("td",{className:"px-4 py-3",children:Nt.jsx("span",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:e.plainTextPassword||""})}),Nt.jsx("td",{className:"px-4 py-3 capitalize",children:e.role}),Nt.jsx("td",{className:"px-4 py-3",children:e.active||"approved"===e.status?Nt.jsxs("span",{className:"text-green-500 font-medium flex items-center gap-1",children:[Nt.jsx(k,{size:16})," Approved"]}):Nt.jsx("span",{className:"text-yellow-500 font-medium",children:"Pending"})}),Nt.jsxs("td",{className:"px-4 py-3 text-center space-x-2",children:[Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(window.confirm("Reset this user's password to default (12345)?"))try{yield pt.put(`${zc()}/api/admin/update-user/${t}`,{password:"12345"}),n({type:"success",message:"Password reset successfully! New password: 12345"})}catch(e){console.error(e),n({type:"error",message:"Failed to reset password."})}});var t},className:"p-2 bg-blue-500 hover:bg-blue-600 text-white rounded",title:"Reset Password",children:Nt.jsx(Te,{size:16})}),e.active||"approved"===e.status?Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){try{yield pt.put(`${zc()}/api/admin/approve-user/${t}`,{active:!1}),i(e=>e.map(e=>e._id===t?c(l({},e),{active:!1,status:"pending"}):e)),n({type:"success",message:"User deactivated successfully!"}),setTimeout(M,500)}catch(e){console.error(e),n({type:"error",message:"Failed to deactivate user."})}});var t},className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deactivate"}):Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){try{yield pt.put(`${zc()}/api/admin/approve-user/${t}`,{active:!0}),i(e=>e.map(e=>e._id===t?c(l({},e),{active:!0,status:"approved"}):e)),n({type:"success",message:"User approved successfully!"}),setTimeout(M,500)}catch(e){console.error(e),n({type:"error",message:"Failed to approve user."})}});var t},className:"px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Approve"}),Nt.jsx("button",{onClick:()=>(e=>{x(e),v(e.role||""),w(e.name||""),S(e.username||""),_(e.plainTextPassword||"")})(e),className:"p-2 bg-yellow-400 hover:bg-yellow-500 text-gray-900 rounded",title:"Edit",children:Nt.jsx(Pe,{size:16})}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(window.confirm("Are you sure you want to delete this user?"))try{yield pt.delete(`${zc()}/api/admin/user/${t}`),i(e=>e.filter(e=>e._id!==t)),n({type:"success",message:"User deleted successfully!"})}catch(e){console.error(e),n({type:"error",message:"Failed to delete user."})}});var t},className:"p-2 bg-red-500 hover:bg-red-600 text-white rounded",title:"Delete",children:Nt.jsx(R,{size:16})})]})]},e._id)),0===E.length&&Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:"6",className:"text-center py-6 text-gray-500 dark:text-gray-400",children:"No users found."})})]})]})}),g&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-lg w-96 "+(r?"bg-gray-900 text-white":"bg-white text-gray-900"),children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-4",children:[" Edit User  ",g.username]}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsx("input",{value:b,onChange:e=>w(e.target.value),placeholder:"Full Name",className:"w-full p-2 border rounded-md bg-transparent"}),Nt.jsx("input",{value:N,onChange:e=>S(e.target.value),placeholder:"Username",className:"w-full p-2 border rounded-md bg-transparent"}),Nt.jsxs("div",{className:"relative",children:[Nt.jsx("input",{type:A?"text":"password",value:j,onChange:e=>_(e.target.value),placeholder:"Password",className:"w-full p-2 border rounded-md bg-transparent pr-10"}),Nt.jsx("button",{type:"button",onClick:()=>C(!A),className:"absolute right-2 top-2 text-gray-400 hover:text-gray-600",children:A?Nt.jsx(De,{size:18}):Nt.jsx(ye,{size:18})})]}),Nt.jsxs("select",{value:y,onChange:e=>v(e.target.value),className:"w-full p-2 border rounded-md bg-transparent",children:[Nt.jsx("option",{value:"",children:"Select Role"}),Nt.jsx("option",{value:"admin",children:"Admin"}),Nt.jsx("option",{value:"supervisor",children:"Supervisor"}),Nt.jsx("option",{value:"supervisor_teller",children:"Supervisor/Teller"}),Nt.jsx("option",{value:"head_watcher",children:"Head Watcher"}),Nt.jsx("option",{value:"sub_watcher",children:"Sub Watcher"}),Nt.jsx("option",{value:"declarator",children:"Declarator"}),Nt.jsx("option",{value:"teller",children:"Teller"})]})]}),Nt.jsxs("div",{className:"flex justify-end gap-2 mt-5",children:[Nt.jsx("button",{onClick:()=>x(null),className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(g)try{const e={role:y,name:b,username:N};j.trim()&&(e.password=j),yield pt.put(`${zc()}/api/admin/update-user/${g._id}`,e),x(null),_(""),yield M(),n({type:"success",message:"User updated successfully!"})}catch(e){console.error(" Edit user error:",e),n({type:"error",message:"Failed to update user."})}}),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Save Changes"})]})]})})]})}function mF(){var e;const{settings:t}=f.useContext($c),{showToast:n}=Kc(),r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState((new Date).toISOString().split("T")[0]),[s,o]=f.useState([]),[l,c]=f.useState(!1),[d,u]=f.useState({totalTellers:0,totalBaseCapital:0,totalAdditionalCapital:0,totalCapitalDeployed:0,totalRemittances:0,totalBalance:0,activeTellers:0}),p=(...e)=>h(null,[...e],function*(e=a){c(!0);try{const t=yield pt.get(`${zc()}/api/admin/teller-overview`,{params:{date:e}});o(t.data.tellers||[]),u(t.data.summary||{})}catch(t){console.error("Failed to fetch teller data:",t),n({type:"error",message:"Failed to load teller data"})}finally{c(!1)}});return f.useEffect(()=>{p()},[a]),f.useEffect(()=>{const e=Vc();if(!e)return;const t=()=>{console.log(" Teller management updated - refreshing admin overview"),p(a)},n=()=>{console.log(" Transaction updated - refreshing admin overview"),p(a)};return e.on("tellerManagementUpdated",t),e.on("transactionUpdated",n),e.on("capitalUpdated",t),()=>{e.off("tellerManagementUpdated",t),e.off("transactionUpdated",n),e.off("capitalUpdated",t)}},[a]),Nt.jsxs("div",{className:"p-6 min-h-screen "+(r?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Teller Management Overview"}),Nt.jsx("p",{className:"text-gray-500",children:"Complete daily view of all teller activities"})]}),Nt.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[Nt.jsxs("div",{className:"relative",children:[Nt.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),Nt.jsx("input",{type:"date",value:a,onChange:e=>i(e.target.value),className:`pl-10 pr-4 py-2 rounded-lg border ${r?"bg-gray-800 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500`})]}),Nt.jsxs("button",{onClick:()=>p(),disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[Nt.jsx(Ae,{className:"w-4 h-4 "+(l?"animate-spin":"")}),"Refresh"]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){try{const e=yield pt.post(`${zc()}/api/teller-management/auto-assign`);n({type:"success",message:`Auto-assignment completed! ${e.data.assignmentsCreated} assignments created.`}),p()}catch(e){console.error("Auto-assignment failed:",e),n({type:"error",message:"Failed to trigger auto-assignment"})}}),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[Nt.jsx(X,{className:"w-4 h-4"}),"Auto-Assign"]}),Nt.jsxs("button",{onClick:()=>{const e=[["Teller Name","Username","Supervisor","Base Capital","Additional Capital","Additional Count","Total Capital Deployed","Total Remittances","Remittance Count","Balance","Last Activity","Status"],...s.map(e=>{var t;return[e.name,e.username,(null==(t=e.supervisor)?void 0:t.name)||"No Supervisor",e.baseCapital||0,e.additionalCapital||0,e.additionalCount||0,e.totalCapitalDeployed||0,e.totalRemittances||0,e.remittanceCount||0,e.balance||0,e.lastActivity||"No activity",e.status||"Unknown"]})].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`teller-overview-${a}.csv`,r.click(),window.URL.revokeObjectURL(n)},disabled:!s.length,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[Nt.jsx(E,{className:"w-4 h-4"}),"Export CSV"]})]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-8",children:[Nt.jsx("div",{className:`p-4 rounded-xl ${r?"bg-gray-800":"bg-white"} shadow-sm border ${r?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Total Users"}),Nt.jsx("p",{className:"text-xl font-bold",children:d.totalUsers}),Nt.jsxs("p",{className:"text-xs text-gray-400",children:[d.activeTellers," active"]})]}),Nt.jsx(U,{className:"w-6 h-6 text-blue-500"})]})}),Nt.jsx("div",{className:`p-4 rounded-xl ${r?"bg-gray-800":"bg-white"} shadow-sm border ${r?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Base Capital"}),Nt.jsxs("p",{className:"text-xl font-bold",children:["",(d.totalBaseCapital||0).toLocaleString()]}),Nt.jsx("p",{className:"text-xs text-gray-400",children:"Initial deployment"})]}),Nt.jsx(xe,{className:"w-6 h-6 text-green-500"})]})}),Nt.jsx("div",{className:`p-4 rounded-xl ${r?"bg-gray-800":"bg-white"} shadow-sm border ${r?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"+ Additional"}),Nt.jsxs("p",{className:"text-xl font-bold",children:["",(d.totalAdditionalCapital||0).toLocaleString()]}),Nt.jsxs("p",{className:"text-xs text-gray-400",children:[d.totalAdditionalCount||0," transactions"]})]}),Nt.jsx(xe,{className:"w-6 h-6 text-emerald-500"})]})}),Nt.jsx("div",{className:`p-4 rounded-xl ${r?"bg-gray-800":"bg-white"} shadow-sm border ${r?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"- Remittances"}),Nt.jsxs("p",{className:"text-xl font-bold",children:["",(d.totalRemittances||0).toLocaleString()]}),Nt.jsxs("p",{className:"text-xs text-gray-400",children:[d.totalRemittanceCount||0," transactions"]})]}),Nt.jsx(K,{className:"w-6 h-6 text-red-500"})]})}),Nt.jsx("div",{className:`p-4 rounded-xl ${r?"bg-gray-800":"bg-white"} shadow-sm border ${r?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"= Balance"}),Nt.jsxs("p",{className:"text-xl font-bold",children:["",(d.totalBalance||0).toLocaleString()]}),Nt.jsx("p",{className:"text-xs text-gray-400",children:"Final calculation"})]}),Nt.jsx(X,{className:"w-6 h-6 text-blue-500"})]})})]}),Nt.jsxs("div",{className:"rounded-xl overflow-hidden shadow-sm border "+(r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:Nt.jsxs("h2",{className:"text-xl font-semibold",children:["Teller Details - ",a]})}),l?Nt.jsxs("div",{className:"p-12 text-center",children:[Nt.jsx(Ae,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-gray-400"}),Nt.jsx("p",{className:"text-gray-500",children:"Loading teller data..."})]}):0===s.length?Nt.jsxs("div",{className:"p-12 text-center",children:[Nt.jsx(U,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),Nt.jsxs("p",{className:"text-gray-500",children:["No teller data found for ",a]})]}):Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full",children:[Nt.jsx("thead",{className:`${r?"bg-gray-750":"bg-gray-50"} border-b ${r?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"Teller & Supervisor"}),Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"Base Capital"}),Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"+ Additional"}),Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"- Remittances"}),Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"= Balance"}),Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"Activity"}),Nt.jsx("th",{className:"text-left p-3 font-semibold text-sm",children:"Status"})]})}),Nt.jsx("tbody",{children:s.map((e,t)=>Nt.jsxs("tr",{className:`border-b ${r?"border-gray-700 hover:bg-gray-750":"border-gray-200 hover:bg-gray-50"} transition-colors`,children:[Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("p",{className:"font-medium text-sm",children:e.name}),Nt.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+("supervisor"===e.role?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300"),children:"supervisor"===e.role?"Supervisor":"Teller"})]}),Nt.jsxs("p",{className:"text-xs text-gray-500",children:["@",e.username]}),e.supervisor&&"teller"===e.role&&Nt.jsxs("p",{className:"text-xs text-blue-500 mt-1",children:["Supervisor: ",e.supervisor.name]})]})}),Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsxs("div",{className:"text-lg font-bold text-green-600",children:["",(e.baseCapital||0).toLocaleString()]}),Nt.jsx("div",{className:"text-xs text-gray-500",children:"Base deployment"})]})}),Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsxs("div",{className:"text-lg font-bold text-emerald-600",children:["",(e.additionalCapital||0).toLocaleString()]}),Nt.jsxs("div",{className:"text-xs text-gray-500",children:["(",e.additionalCount||0," transactions)"]})]})}),Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsxs("div",{className:"text-lg font-bold text-red-600",children:["",(e.totalRemittances||0).toLocaleString()]}),Nt.jsxs("div",{className:"text-sm text-gray-500",children:["(",e.remittanceCount||0," transactions)"]})]})}),Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsxs("div",{className:"text-lg font-bold "+((e.balance||0)>=0?"text-blue-600":"text-red-600"),children:["",(e.balance||0).toLocaleString()]}),Nt.jsx("div",{className:"text-xs text-gray-500",children:"Final balance"})]})}),Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{className:"space-y-1",children:[Nt.jsx("div",{className:"text-sm text-gray-600",children:e.lastActivity||"No activity"}),Nt.jsxs("div",{className:"flex gap-1 text-xs",children:[e.hasActivity&&Nt.jsx("span",{className:"px-1 py-0.5 bg-green-100 text-green-700 rounded",children:"Active"}),e.totalRemittances>0&&Nt.jsx("span",{className:"px-1 py-0.5 bg-purple-100 text-purple-700 rounded",children:"Remittances"})]})]})}),Nt.jsx("td",{className:"p-3",children:Nt.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("approved"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"pending"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:e.status||"Unknown"})})]},e._id||t))})]})})]})]})}const gF=6048e5,fF=6e4,xF=36e5,yF=Symbol.for("constructDateFrom");function vF(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&yF in e?e[yF](t):e instanceof Date?new e.constructor(t):new Date(t)}function bF(e,t){return vF(t||e,e)}function wF(e,t,n){const r=bF(e,null==n?void 0:n.in);return isNaN(t)?vF((null==n?void 0:n.in)||e,NaN):t?(r.setDate(r.getDate()+t),r):r}function NF(e,t,n){const r=bF(e,null==n?void 0:n.in);if(isNaN(t))return vF(e,NaN);if(!t)return r;const a=r.getDate(),i=vF(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);return a>=i.getDate()?i:(r.setFullYear(i.getFullYear(),i.getMonth(),a),r)}function SF(e,t,n){return vF(e,+bF(e)+t)}function jF(e,t,n){return SF(e,t*xF)}let _F={};function AF(){return _F}function CF(e,t){var n,r,a,i,s,o,l,c;const d=AF(),u=null!=(c=null!=(l=null!=(i=null!=(a=null==t?void 0:t.weekStartsOn)?a:null==(r=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:r.weekStartsOn)?i:d.weekStartsOn)?l:null==(o=null==(s=d.locale)?void 0:s.options)?void 0:o.weekStartsOn)?c:0,h=bF(e,null==t?void 0:t.in),p=h.getDay(),m=(p<u?7:0)+p-u;return h.setDate(h.getDate()-m),h.setHours(0,0,0,0),h}function MF(e,t){return CF(e,c(l({},t),{weekStartsOn:1}))}function kF(e,t){const n=bF(e,null==t?void 0:t.in),r=n.getFullYear(),a=vF(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const i=MF(a),s=vF(n,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const o=MF(s);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function EF(e){const t=bF(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function TF(e,...t){const n=vF.bind(null,t.find(e=>"object"==typeof e));return t.map(n)}function PF(e,t){const n=bF(e,null==t?void 0:t.in);return n.setHours(0,0,0,0),n}function DF(e,t,n){const[r,a]=TF(null==n||n.in,e,t),i=PF(r),s=PF(a),o=+i-EF(i),l=+s-EF(s);return Math.round((o-l)/864e5)}function RF(e,t,n){const r=bF(e,null==n?void 0:n.in);return r.setTime(r.getTime()+t*fF),r}function IF(e,t,n){return NF(e,3*t,n)}function OF(e,t,n){return SF(e,1e3*t)}function BF(e,t,n){return wF(e,7*t,n)}function LF(e,t,n){return NF(e,12*t,n)}function FF(e,t){let n,r=null==t?void 0:t.in;return e.forEach(e=>{r||"object"!=typeof e||(r=vF.bind(null,e));const t=bF(e,r);(!n||n<t||isNaN(+t))&&(n=t)}),vF(r,n||NaN)}function UF(e,t){let n,r=null==t?void 0:t.in;return e.forEach(e=>{r||"object"!=typeof e||(r=vF.bind(null,e));const t=bF(e,r);(!n||n>t||isNaN(+t))&&(n=t)}),vF(r,n||NaN)}function zF(e){return e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function HF(e){return!(!zF(e)&&"number"!=typeof e||isNaN(+bF(e)))}function GF(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return 12*(r.getFullYear()-a.getFullYear())+(r.getMonth()-a.getMonth())}function VF(e,t){const n=bF(e,null==t?void 0:t.in);return Math.trunc(n.getMonth()/3)+1}function $F(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return 4*(r.getFullYear()-a.getFullYear())+(VF(r)-VF(a))}function WF(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return r.getFullYear()-a.getFullYear()}function YF(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function XF(e,t){const n=bF(e,null==t?void 0:t.in);return n.setHours(23,59,59,999),n}function KF(e,t){const n=bF(e,null==t?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function qF(e,t){const n=bF(e,null==t?void 0:t.in),r=n.getMonth(),a=r-r%3;return n.setMonth(a,1),n.setHours(0,0,0,0),n}function JF(e,t){const n=bF(e,null==t?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function QF(e,t){const n=bF(e,null==t?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function ZF(e,t){const n=bF(e,null==t?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const eU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function tU(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const nU={date:tU({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:tU({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:tU({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},rU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function aU(e){return(t,n)=>{let r;if("formatting"===((null==n?void 0:n.context)?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=(null==n?void 0:n.width)?String(n.width):t;r=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=(null==n?void 0:n.width)?String(n.width):e.defaultWidth;r=e.values[a]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function iU(e){return(t,n={})=>{const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,e=>e.test(s)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,e=>e.test(s));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(s.length)}}}var sU;const oU={code:"en-US",formatDistance:(e,t,n)=>{let r;const a=eU[e];return r="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),(null==n?void 0:n.addSuffix)?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:nU,formatRelative:(e,t,n,r)=>rU[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:aU({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:aU({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:aU({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:aU({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:aU({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(sU={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(sU.matchPattern);if(!n)return null;const r=n[0],a=e.match(sU.parsePattern);if(!a)return null;let i=sU.valueCallback?sU.valueCallback(a[0]):a[0];return i=t.valueCallback?t.valueCallback(i):i,{value:i,rest:e.slice(r.length)}}),era:iU({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:iU({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:iU({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:iU({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:iU({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function lU(e,t){const n=bF(e,null==t?void 0:t.in),r=+MF(n)-+function(e,t){const n=kF(e,t),r=vF(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),MF(r)}(n);return Math.round(r/gF)+1}function cU(e,t){var n,r,a,i,s,o,l,c;const d=bF(e,null==t?void 0:t.in),u=d.getFullYear(),h=AF(),p=null!=(c=null!=(l=null!=(i=null!=(a=null==t?void 0:t.firstWeekContainsDate)?a:null==(r=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:r.firstWeekContainsDate)?i:h.firstWeekContainsDate)?l:null==(o=null==(s=h.locale)?void 0:s.options)?void 0:o.firstWeekContainsDate)?c:1,m=vF((null==t?void 0:t.in)||e,0);m.setFullYear(u+1,0,p),m.setHours(0,0,0,0);const g=CF(m,t),f=vF((null==t?void 0:t.in)||e,0);f.setFullYear(u,0,p),f.setHours(0,0,0,0);const x=CF(f,t);return+d>=+g?u+1:+d>=+x?u:u-1}function dU(e,t){const n=bF(e,null==t?void 0:t.in),r=+CF(n,t)-+function(e,t){var n,r,a,i,s,o,l,c;const d=AF(),u=null!=(c=null!=(l=null!=(i=null!=(a=null==t?void 0:t.firstWeekContainsDate)?a:null==(r=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:r.firstWeekContainsDate)?i:d.firstWeekContainsDate)?l:null==(o=null==(s=d.locale)?void 0:s.options)?void 0:o.firstWeekContainsDate)?c:1,h=cU(e,t),p=vF((null==t?void 0:t.in)||e,0);return p.setFullYear(h,0,u),p.setHours(0,0,0,0),CF(p,t)}(n,t);return Math.round(r/gF)+1}function uU(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const hU={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return uU("yy"===t?r%100:r,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):uU(n+1,2)},d:(e,t)=>uU(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>uU(e.getHours()%12||12,t.length),H:(e,t)=>uU(e.getHours(),t.length),m:(e,t)=>uU(e.getMinutes(),t.length),s:(e,t)=>uU(e.getSeconds(),t.length),S(e,t){const n=t.length,r=e.getMilliseconds();return uU(Math.trunc(r*Math.pow(10,n-3)),t.length)}},pU="midnight",mU="noon",gU="morning",fU="afternoon",xU="evening",yU="night",vU={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return hU.y(e,t)},Y:function(e,t,n,r){const a=cU(e,r),i=a>0?a:1-a;if("YY"===t){return uU(i%100,2)}return"Yo"===t?n.ordinalNumber(i,{unit:"year"}):uU(i,t.length)},R:function(e,t){return uU(kF(e),t.length)},u:function(e,t){return uU(e.getFullYear(),t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return uU(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return uU(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return hU.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return uU(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=dU(e,r);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):uU(a,t.length)},I:function(e,t,n){const r=lU(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):uU(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):hU.d(e,t)},D:function(e,t,n){const r=function(e,t){const n=bF(e,null==t?void 0:t.in);return DF(n,ZF(n))+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):uU(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return uU(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return uU(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return uU(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(a=12===r?mU:0===r?pU:r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(a=r>=17?xU:r>=12?fU:r>=4?gU:yU,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return hU.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):hU.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):uU(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):uU(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):hU.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):hU.s(e,t)},S:function(e,t){return hU.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return wU(r);case"XXXX":case"XX":return NU(r);default:return NU(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return wU(r);case"xxxx":case"xx":return NU(r);default:return NU(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+bU(r,":");default:return"GMT"+NU(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+bU(r,":");default:return"GMT"+NU(r,":")}},t:function(e,t,n){return uU(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return uU(+e,t.length)}};function bU(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),i=r%60;return 0===i?n+String(a):n+String(a)+t+uU(i,2)}function wU(e,t){if(e%60==0){return(e>0?"-":"+")+uU(Math.abs(e)/60,2)}return NU(e,t)}function NU(e,t=""){const n=e>0?"-":"+",r=Math.abs(e);return n+uU(Math.trunc(r/60),2)+t+uU(r%60,2)}const SU=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},jU=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},_U={p:jU,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return SU(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"})}return i.replace("{{date}}",SU(r,t)).replace("{{time}}",jU(a,t))}},AU=/^D+$/,CU=/^Y+$/,MU=["D","DD","YY","YYYY"];const kU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,EU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,TU=/^'([^]*?)'?$/,PU=/''/g,DU=/[a-zA-Z]/;function RU(e,t,n){var r,a,i,s,o,l,c,d,u,h,p,m,g,f,x,y,v,b;const w=AF(),N=null!=(a=null!=(r=null==n?void 0:n.locale)?r:w.locale)?a:oU,S=null!=(h=null!=(u=null!=(l=null!=(o=null==n?void 0:n.firstWeekContainsDate)?o:null==(s=null==(i=null==n?void 0:n.locale)?void 0:i.options)?void 0:s.firstWeekContainsDate)?l:w.firstWeekContainsDate)?u:null==(d=null==(c=w.locale)?void 0:c.options)?void 0:d.firstWeekContainsDate)?h:1,j=null!=(b=null!=(v=null!=(f=null!=(g=null==n?void 0:n.weekStartsOn)?g:null==(m=null==(p=null==n?void 0:n.locale)?void 0:p.options)?void 0:m.weekStartsOn)?f:w.weekStartsOn)?v:null==(y=null==(x=w.locale)?void 0:x.options)?void 0:y.weekStartsOn)?b:0,_=bF(e,null==n?void 0:n.in);if(!HF(_))throw new RangeError("Invalid time value");let A=t.match(EU).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,_U[t])(e,N.formatLong)}return e}).join("").match(kU).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:IU(e)};if(vU[t])return{isToken:!0,value:e};if(t.match(DU))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});N.localize.preprocessor&&(A=N.localize.preprocessor(_,A));const C={firstWeekContainsDate:S,weekStartsOn:j,locale:N};return A.map(r=>{if(!r.isToken)return r.value;const a=r.value;(!(null==n?void 0:n.useAdditionalWeekYearTokens)&&function(e){return CU.test(e)}(a)||!(null==n?void 0:n.useAdditionalDayOfYearTokens)&&function(e){return AU.test(e)}(a))&&function(e,t,n){const r=function(e,t,n){const r="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(r),MU.includes(e))throw new RangeError(r)}(a,t,String(e));return(0,vU[a[0]])(_,a,N.localize,C)}).join("")}function IU(e){const t=e.match(TU);return t?t[1].replace(PU,"'"):e}function OU(e,t){return bF(e,null==t?void 0:t.in).getDate()}function BU(e,t){return bF(e,null==t?void 0:t.in).getHours()}function LU(e,t){return bF(e,null==t?void 0:t.in).getMinutes()}function FU(e,t){return bF(e,null==t?void 0:t.in).getMonth()}function UU(e){return bF(e).getSeconds()}function zU(e){return+bF(e)}function HU(e,t){return bF(e,null==t?void 0:t.in).getFullYear()}function GU(e,t){return+bF(e)>+bF(t)}function VU(e,t){return+bF(e)<+bF(t)}class $U{constructor(){u(this,"subPriority",0)}validate(e,t){return!0}}class WU extends $U{constructor(e,t,n,r,a){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=r,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class YU extends $U{constructor(e,t){super(),u(this,"priority",10),u(this,"subPriority",-1),this.context=e||(e=>vF(t,e))}set(e,t){return t.timestampIsSet?e:vF(e,function(e,t){const n=function(e){var t;return"function"==typeof e&&(null==(t=e.prototype)?void 0:t.constructor)===e}(t)?new t(0):vF(t,0);return n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n}(e,this.context))}}class XU{run(e,t,n,r){const a=this.parse(e,t,n,r);return a?{setter:new WU(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,n){return!0}}const KU=/^(1[0-2]|0?\d)/,qU=/^(3[0-1]|[0-2]?\d)/,JU=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,QU=/^(5[0-3]|[0-4]?\d)/,ZU=/^(2[0-3]|[0-1]?\d)/,ez=/^(2[0-4]|[0-1]?\d)/,tz=/^(1[0-1]|0?\d)/,nz=/^(1[0-2]|0?\d)/,rz=/^[0-5]?\d/,az=/^[0-5]?\d/,iz=/^\d/,sz=/^\d{1,2}/,oz=/^\d{1,3}/,lz=/^\d{1,4}/,cz=/^-?\d+/,dz=/^-?\d/,uz=/^-?\d{1,2}/,hz=/^-?\d{1,3}/,pz=/^-?\d{1,4}/,mz=/^([+-])(\d{2})(\d{2})?|Z/,gz=/^([+-])(\d{2})(\d{2})|Z/,fz=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,xz=/^([+-])(\d{2}):(\d{2})|Z/,yz=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function vz(e,t){return e?{value:t(e.value),rest:e.rest}:e}function bz(e,t){const n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function wz(e,t){const n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};const r="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,s=n[5]?parseInt(n[5],10):0;return{value:r*(a*xF+i*fF+1e3*s),rest:t.slice(n[0].length)}}function Nz(e){return bz(cz,e)}function Sz(e,t){switch(e){case 1:return bz(iz,t);case 2:return bz(sz,t);case 3:return bz(oz,t);case 4:return bz(lz,t);default:return bz(new RegExp("^\\d{1,"+e+"}"),t)}}function jz(e,t){switch(e){case 1:return bz(dz,t);case 2:return bz(uz,t);case 3:return bz(hz,t);case 4:return bz(pz,t);default:return bz(new RegExp("^-?\\d{1,"+e+"}"),t)}}function _z(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function Az(e,t){const n=t>0,r=n?t:1-t;let a;if(r<=50)a=e||100;else{const t=r+50;a=e+100*Math.trunc(t/100)-(e>=t%100?100:0)}return n?a:1-a}function Cz(e){return e%400==0||e%4==0&&e%100!=0}const Mz=[31,28,31,30,31,30,31,31,30,31,30,31],kz=[31,29,31,30,31,30,31,31,30,31,30,31];function Ez(e,t,n){var r,a,i,s,o,l,c,d;const u=AF(),h=null!=(d=null!=(c=null!=(s=null!=(i=null==n?void 0:n.weekStartsOn)?i:null==(a=null==(r=null==n?void 0:n.locale)?void 0:r.options)?void 0:a.weekStartsOn)?s:u.weekStartsOn)?c:null==(l=null==(o=u.locale)?void 0:o.options)?void 0:l.weekStartsOn)?d:0,p=bF(e,null==n?void 0:n.in),m=p.getDay(),g=7-h;return wF(p,t<0||t>6?t-(m+g)%7:((t%7+7)%7+g)%7-(m+g)%7,n)}function Tz(e,t,n){const r=bF(e,null==n?void 0:n.in),a=function(e,t){const n=bF(e,null==t?void 0:t.in).getDay();return 0===n?7:n}(r,n);return wF(r,t-a,n)}const Pz={G:new class extends XU{constructor(){super(...arguments),u(this,"priority",140),u(this,"incompatibleTokens",["R","u","t","T"])}parse(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,t,n){return t.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}},y:new class extends XU{constructor(){super(...arguments),u(this,"priority",130),u(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(e,t,n){const r=e=>({year:e,isTwoDigitYear:"yy"===t});switch(t){case"y":return vz(Sz(4,e),r);case"yo":return vz(n.ordinalNumber(e,{unit:"year"}),r);default:return vz(Sz(t.length,e),r)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n){const r=e.getFullYear();if(n.isTwoDigitYear){const t=Az(n.year,r);return e.setFullYear(t,0,1),e.setHours(0,0,0,0),e}const a="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},Y:new class extends XU{constructor(){super(...arguments),u(this,"priority",130),u(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(e,t,n){const r=e=>({year:e,isTwoDigitYear:"YY"===t});switch(t){case"Y":return vz(Sz(4,e),r);case"Yo":return vz(n.ordinalNumber(e,{unit:"year"}),r);default:return vz(Sz(t.length,e),r)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n,r){const a=cU(e,r);if(n.isTwoDigitYear){const t=Az(n.year,a);return e.setFullYear(t,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),CF(e,r)}const i="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(i,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),CF(e,r)}},R:new class extends XU{constructor(){super(...arguments),u(this,"priority",130),u(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(e,t){return jz("R"===t?4:t.length,e)}set(e,t,n){const r=vF(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),MF(r)}},u:new class extends XU{constructor(){super(...arguments),u(this,"priority",130),u(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(e,t){return jz("u"===t?4:t.length,e)}set(e,t,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}},Q:new class extends XU{constructor(){super(...arguments),u(this,"priority",120),u(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"Q":case"QQ":return Sz(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}},q:new class extends XU{constructor(){super(...arguments),u(this,"priority",120),u(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"q":case"qq":return Sz(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}},M:new class extends XU{constructor(){super(...arguments),u(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),u(this,"priority",110)}parse(e,t,n){const r=e=>e-1;switch(t){case"M":return vz(bz(KU,e),r);case"MM":return vz(Sz(2,e),r);case"Mo":return vz(n.ordinalNumber(e,{unit:"month"}),r);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},L:new class extends XU{constructor(){super(...arguments),u(this,"priority",110),u(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(e,t,n){const r=e=>e-1;switch(t){case"L":return vz(bz(KU,e),r);case"LL":return vz(Sz(2,e),r);case"Lo":return vz(n.ordinalNumber(e,{unit:"month"}),r);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},w:new class extends XU{constructor(){super(...arguments),u(this,"priority",100),u(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(e,t,n){switch(t){case"w":return bz(QU,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return Sz(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n,r){return CF(function(e,t,n){const r=bF(e,null==n?void 0:n.in),a=dU(r,n)-t;return r.setDate(r.getDate()-7*a),bF(r,null==n?void 0:n.in)}(e,n,r),r)}},I:new class extends XU{constructor(){super(...arguments),u(this,"priority",100),u(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(e,t,n){switch(t){case"I":return bz(QU,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return Sz(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n){return MF(function(e,t,n){const r=bF(e,null==n?void 0:n.in),a=lU(r,n)-t;return r.setDate(r.getDate()-7*a),r}(e,n))}},d:new class extends XU{constructor(){super(...arguments),u(this,"priority",90),u(this,"subPriority",1),u(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"d":return bz(qU,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return Sz(t.length,e)}}validate(e,t){const n=Cz(e.getFullYear()),r=e.getMonth();return n?t>=1&&t<=kz[r]:t>=1&&t<=Mz[r]}set(e,t,n){return e.setDate(n),e.setHours(0,0,0,0),e}},D:new class extends XU{constructor(){super(...arguments),u(this,"priority",90),u(this,"subpriority",1),u(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(e,t,n){switch(t){case"D":case"DD":return bz(JU,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return Sz(t.length,e)}}validate(e,t){return Cz(e.getFullYear())?t>=1&&t<=366:t>=1&&t<=365}set(e,t,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}},E:new class extends XU{constructor(){super(...arguments),u(this,"priority",90),u(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Ez(e,n,r)).setHours(0,0,0,0),e}},e:new class extends XU{constructor(){super(...arguments),u(this,"priority",90),u(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(e,t,n,r){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return vz(Sz(t.length,e),a);case"eo":return vz(n.ordinalNumber(e,{unit:"day"}),a);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Ez(e,n,r)).setHours(0,0,0,0),e}},c:new class extends XU{constructor(){super(...arguments),u(this,"priority",90),u(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(e,t,n,r){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return vz(Sz(t.length,e),a);case"co":return vz(n.ordinalNumber(e,{unit:"day"}),a);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Ez(e,n,r)).setHours(0,0,0,0),e}},i:new class extends XU{constructor(){super(...arguments),u(this,"priority",90),u(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(e,t,n){const r=e=>0===e?7:e;switch(t){case"i":case"ii":return Sz(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return vz(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return vz(n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return vz(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);default:return vz(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r)}}validate(e,t){return t>=1&&t<=7}set(e,t,n){return(e=Tz(e,n)).setHours(0,0,0,0),e}},a:new class extends XU{constructor(){super(...arguments),u(this,"priority",80),u(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(_z(n),0,0,0),e}},b:new class extends XU{constructor(){super(...arguments),u(this,"priority",80),u(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(_z(n),0,0,0),e}},B:new class extends XU{constructor(){super(...arguments),u(this,"priority",80),u(this,"incompatibleTokens",["a","b","t","T"])}parse(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(_z(n),0,0,0),e}},h:new class extends XU{constructor(){super(...arguments),u(this,"priority",70),u(this,"incompatibleTokens",["H","K","k","t","T"])}parse(e,t,n){switch(t){case"h":return bz(nz,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return Sz(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,n){const r=e.getHours()>=12;return r&&n<12?e.setHours(n+12,0,0,0):r||12!==n?e.setHours(n,0,0,0):e.setHours(0,0,0,0),e}},H:new class extends XU{constructor(){super(...arguments),u(this,"priority",70),u(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(e,t,n){switch(t){case"H":return bz(ZU,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return Sz(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,n){return e.setHours(n,0,0,0),e}},K:new class extends XU{constructor(){super(...arguments),u(this,"priority",70),u(this,"incompatibleTokens",["h","H","k","t","T"])}parse(e,t,n){switch(t){case"K":return bz(tz,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return Sz(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}},k:new class extends XU{constructor(){super(...arguments),u(this,"priority",70),u(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(e,t,n){switch(t){case"k":return bz(ez,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return Sz(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,n){const r=n<=24?n%24:n;return e.setHours(r,0,0,0),e}},m:new class extends XU{constructor(){super(...arguments),u(this,"priority",60),u(this,"incompatibleTokens",["t","T"])}parse(e,t,n){switch(t){case"m":return bz(rz,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return Sz(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setMinutes(n,0,0),e}},s:new class extends XU{constructor(){super(...arguments),u(this,"priority",50),u(this,"incompatibleTokens",["t","T"])}parse(e,t,n){switch(t){case"s":return bz(az,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return Sz(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setSeconds(n,0),e}},S:new class extends XU{constructor(){super(...arguments),u(this,"priority",30),u(this,"incompatibleTokens",["t","T"])}parse(e,t){return vz(Sz(t.length,e),e=>Math.trunc(e*Math.pow(10,3-t.length)))}set(e,t,n){return e.setMilliseconds(n),e}},X:new class extends XU{constructor(){super(...arguments),u(this,"priority",10),u(this,"incompatibleTokens",["t","T","x"])}parse(e,t){switch(t){case"X":return wz(mz,e);case"XX":return wz(gz,e);case"XXXX":return wz(fz,e);case"XXXXX":return wz(yz,e);default:return wz(xz,e)}}set(e,t,n){return t.timestampIsSet?e:vF(e,e.getTime()-EF(e)-n)}},x:new class extends XU{constructor(){super(...arguments),u(this,"priority",10),u(this,"incompatibleTokens",["t","T","X"])}parse(e,t){switch(t){case"x":return wz(mz,e);case"xx":return wz(gz,e);case"xxxx":return wz(fz,e);case"xxxxx":return wz(yz,e);default:return wz(xz,e)}}set(e,t,n){return t.timestampIsSet?e:vF(e,e.getTime()-EF(e)-n)}},t:new class extends XU{constructor(){super(...arguments),u(this,"priority",40),u(this,"incompatibleTokens","*")}parse(e){return Nz(e)}set(e,t,n){return[vF(e,1e3*n),{timestampIsSet:!0}]}},T:new class extends XU{constructor(){super(...arguments),u(this,"priority",20),u(this,"incompatibleTokens","*")}parse(e){return Nz(e)}set(e,t,n){return[vF(e,n),{timestampIsSet:!0}]}}},Dz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Rz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Iz=/^'([^]*?)'?$/,Oz=/''/g,Bz=/\S/,Lz=/[a-zA-Z]/;function Fz(e,t,n,r){var a,i,s,o,l,c,d,u,h,p,m,g,f,x,y,v,b,w;const N=()=>vF((null==r?void 0:r.in)||n,NaN),S=Object.assign({},AF()),j=null!=(i=null!=(a=null==r?void 0:r.locale)?a:S.locale)?i:oU,_=null!=(p=null!=(h=null!=(c=null!=(l=null==r?void 0:r.firstWeekContainsDate)?l:null==(o=null==(s=null==r?void 0:r.locale)?void 0:s.options)?void 0:o.firstWeekContainsDate)?c:S.firstWeekContainsDate)?h:null==(u=null==(d=S.locale)?void 0:d.options)?void 0:u.firstWeekContainsDate)?p:1,A=null!=(w=null!=(b=null!=(x=null!=(f=null==r?void 0:r.weekStartsOn)?f:null==(g=null==(m=null==r?void 0:r.locale)?void 0:m.options)?void 0:g.weekStartsOn)?x:S.weekStartsOn)?b:null==(v=null==(y=S.locale)?void 0:y.options)?void 0:v.weekStartsOn)?w:0;if(!t)return e?N():bF(n,null==r?void 0:r.in);const C={firstWeekContainsDate:_,weekStartsOn:A,locale:j},M=[new YU(null==r?void 0:r.in,n)],k=t.match(Rz).map(e=>{const t=e[0];if(t in _U){return(0,_U[t])(e,j.formatLong)}return e}).join("").match(Dz),E=[];for(let R of k){const t=R[0],n=Pz[t];if(n){const{incompatibleTokens:r}=n;if(Array.isArray(r)){const e=E.find(e=>r.includes(e.token)||e.token===t);if(e)throw new RangeError(`The format string mustn't contain \`${e.fullToken}\` and \`${R}\` at the same time`)}else if("*"===n.incompatibleTokens&&E.length>0)throw new RangeError(`The format string mustn't contain \`${R}\` and any other token at the same time`);E.push({token:t,fullToken:R});const a=n.run(e,R,j.match,C);if(!a)return N();M.push(a.setter),e=a.rest}else{if(t.match(Lz))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");if("''"===R?R="'":"'"===t&&(R=Uz(R)),0!==e.indexOf(R))return N();e=e.slice(R.length)}}if(e.length>0&&Bz.test(e))return N();const T=M.map(e=>e.priority).sort((e,t)=>t-e).filter((e,t,n)=>n.indexOf(e)===t).map(e=>M.filter(t=>t.priority===e).sort((e,t)=>t.subPriority-e.subPriority)).map(e=>e[0]);let P=bF(n,null==r?void 0:r.in);if(isNaN(+P))return N();const D={};for(const R of T){if(!R.validate(P,C))return N();const e=R.set(P,D,C);Array.isArray(e)?(P=e[0],Object.assign(D,e[1])):P=e}return P}function Uz(e){return e.match(Iz)[1].replace(Oz,"'")}function zz(e,t,n){const r=+bF(e,null==n?void 0:n.in),[a,i]=[+bF(t.start,null==n?void 0:n.in),+bF(t.end,null==n?void 0:n.in)].sort((e,t)=>e-t);return r>=a&&r<=i}function Hz(e,t){const n=()=>vF(null==t?void 0:t.in,NaN),r=function(e){const t={},n=e.split(Gz.dateTimeDelimiter);let r;if(n.length>2)return t;/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],Gz.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Gz.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length)));if(r){const e=Gz.timezone.exec(r);e?(t.time=r.replace(e[1],""),t.timezone=e[1]):t.time=r}return t}(e);let a;if(r.date){const e=function(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:null===i?a:100*i,restDateString:e.slice((r[1]||r[2]).length)}}(r.date,2);a=function(e,t){if(null===t)return new Date(NaN);const n=e.match(Vz);if(!n)return new Date(NaN);const r=!!n[4],a=Yz(n[1]),i=Yz(n[2])-1,s=Yz(n[3]),o=Yz(n[4]),l=Yz(n[5])-1;if(r)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,o,l)?function(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,i=7*(t-1)+n+1-a;return r.setUTCDate(r.getUTCDate()+i),r}(t,o,l):new Date(NaN);{const e=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Kz[t]||(qz(e)?29:28))}(t,i,s)&&function(e,t){return t>=1&&t<=(qz(e)?366:365)}(t,a)?(e.setUTCFullYear(t,i,Math.max(a,s)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!a||isNaN(+a))return n();const i=+a;let s,o=0;if(r.time&&(o=function(e){const t=e.match($z);if(!t)return NaN;const n=Xz(t[1]),r=Xz(t[2]),a=Xz(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,r,a))return NaN;return n*xF+r*fF+1e3*a}(r.time),isNaN(o)))return n();if(!r.timezone){const e=new Date(i+o),n=bF(0,null==t?void 0:t.in);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}return s=function(e){if("Z"===e)return 0;const t=e.match(Wz);if(!t)return 0;const n="+"===t[1]?-1:1,r=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,a))return NaN;return n*(r*xF+a*fF)}(r.timezone),isNaN(s)?n():bF(i+o+s,null==t?void 0:t.in)}const Gz={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Vz=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,$z=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Wz=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Yz(e){return e?parseInt(e):1}function Xz(e){return e&&parseFloat(e.replace(",","."))||0}const Kz=[31,null,31,30,31,30,31,31,30,31,30,31];function qz(e){return e%400==0||e%4==0&&e%100!=0}function Jz(e,t,n){const r=bF(e,null==n?void 0:n.in),a=r.getFullYear(),i=r.getDate(),s=vF(e,0);s.setFullYear(a,t,15),s.setHours(0,0,0,0);const o=function(e,t){const n=bF(e,null==t?void 0:t.in),r=n.getFullYear(),a=n.getMonth(),i=vF(n,0);return i.setFullYear(r,a+1,0),i.setHours(0,0,0,0),i.getDate()}(s);return r.setMonth(t,Math.min(i,o)),r}function Qz(e,t,n){const r=bF(e,null==n?void 0:n.in);return r.setHours(t),r}function Zz(e,t,n){const r=bF(e,null==n?void 0:n.in);return r.setMinutes(t),r}function eH(e,t,n){const r=bF(e,null==n?void 0:n.in),a=t-(Math.trunc(r.getMonth()/3)+1);return Jz(r,r.getMonth()+3*a)}function tH(e,t,n){const r=bF(e,null==n?void 0:n.in);return r.setSeconds(t),r}function nH(e,t,n){const r=bF(e,null==n?void 0:n.in);return isNaN(+r)?vF(e,NaN):(r.setFullYear(t),r)}function rH(e,t,n){return NF(e,-t,n)}function aH(e,t,n){return IF(e,-1,n)}function iH(e,t,n){return BF(e,-1,n)}function sH(e,t,n){return LF(e,-t,n)}function oH(){return"undefined"!=typeof window}function lH(e){return uH(e)?(e.nodeName||"").toLowerCase():"#document"}function cH(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function dH(e){var t;return null==(t=(uH(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function uH(e){return!!oH()&&(e instanceof Node||e instanceof cH(e).Node)}function hH(e){return!!oH()&&(e instanceof Element||e instanceof cH(e).Element)}function pH(e){return!!oH()&&(e instanceof HTMLElement||e instanceof cH(e).HTMLElement)}function mH(e){return!(!oH()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof cH(e).ShadowRoot)}const gH=new Set(["inline","contents"]);function fH(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=MH(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!gH.has(a)}const xH=new Set(["table","td","th"]);function yH(e){return xH.has(lH(e))}const vH=[":popover-open",":modal"];function bH(e){return vH.some(t=>{try{return e.matches(t)}catch(n){return!1}})}const wH=["transform","translate","scale","rotate","perspective"],NH=["transform","translate","scale","rotate","perspective","filter"],SH=["paint","layout","strict","content"];function jH(e){const t=_H(),n=hH(e)?MH(e):e;return wH.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||NH.some(e=>(n.willChange||"").includes(e))||SH.some(e=>(n.contain||"").includes(e))}function _H(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const AH=new Set(["html","body","#document"]);function CH(e){return AH.has(lH(e))}function MH(e){return cH(e).getComputedStyle(e)}function kH(e){return hH(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function EH(e){if("html"===lH(e))return e;const t=e.assignedSlot||e.parentNode||mH(e)&&e.host||dH(e);return mH(t)?t.host:t}function TH(e){const t=EH(e);return CH(t)?e.ownerDocument?e.ownerDocument.body:e.body:pH(t)&&fH(t)?t:TH(t)}function PH(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const a=TH(e),i=a===(null==(r=e.ownerDocument)?void 0:r.body),s=cH(a);if(i){const e=DH(s);return t.concat(s,s.visualViewport||[],fH(a)?a:[],e&&n?PH(e):[])}return t.concat(a,PH(a,[],n))}function DH(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const RH=Math.min,IH=Math.max,OH=Math.round,BH=Math.floor,LH=e=>({x:e,y:e}),FH={left:"right",right:"left",bottom:"top",top:"bottom"},UH={start:"end",end:"start"};function zH(e,t){return"function"==typeof e?e(t):e}function HH(e){return e.split("-")[0]}function GH(e){return e.split("-")[1]}function VH(e){return"y"===e?"height":"width"}const $H=new Set(["top","bottom"]);function WH(e){return $H.has(HH(e))?"y":"x"}function YH(e){return"x"===WH(e)?"y":"x"}function XH(e){return e.replace(/start|end/g,e=>UH[e])}const KH=["left","right"],qH=["right","left"],JH=["top","bottom"],QH=["bottom","top"];function ZH(e,t,n,r){const a=GH(e);let i=function(e,t,n){switch(e){case"top":case"bottom":return n?t?qH:KH:t?KH:qH;case"left":case"right":return t?JH:QH;default:return[]}}(HH(e),"start"===n,r);return a&&(i=i.map(e=>e+"-"+a),t&&(i=i.concat(i.map(XH)))),i}function eG(e){return e.replace(/left|right|bottom|top/g,e=>FH[e])}function tG(e){return"number"!=typeof e?function(e){return l({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function nG(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}var rG="undefined"!=typeof document?f.useLayoutEffect:function(){};const aG=l({},w).useInsertionEffect||(e=>e());function iG(e,t,n){let{reference:r,floating:a}=e;const i=WH(t),s=YH(t),o=VH(s),l=HH(t),c="y"===i,d=r.x+r.width/2-a.width/2,u=r.y+r.height/2-a.height/2,h=r[o]/2-a[o]/2;let p;switch(l){case"top":p={x:d,y:r.y-a.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:u};break;case"left":p={x:r.x-a.width,y:u};break;default:p={x:r.x,y:r.y}}switch(GH(t)){case"start":p[s]-=h*(n&&c?-1:1);break;case"end":p[s]+=h*(n&&c?-1:1)}return p}const sG=new Set(["left","top"]);function oG(e){const t=MH(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=pH(e),i=a?e.offsetWidth:n,s=a?e.offsetHeight:r,o=OH(n)!==i||OH(r)!==s;return o&&(n=i,r=s),{width:n,height:r,$:o}}function lG(e){return hH(e)?e:e.contextElement}function cG(e){const t=lG(e);if(!pH(t))return LH(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:i}=oG(t);let s=(i?OH(n.width):n.width)/r,o=(i?OH(n.height):n.height)/a;return s&&Number.isFinite(s)||(s=1),o&&Number.isFinite(o)||(o=1),{x:s,y:o}}const dG=LH(0);function uG(e){const t=cH(e);return _H()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:dG}function hG(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const a=e.getBoundingClientRect(),i=lG(e);let s=LH(1);t&&(r?hH(r)&&(s=cG(r)):s=cG(e));const o=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==cH(e))&&t}(i,n,r)?uG(i):LH(0);let l=(a.left+o.x)/s.x,c=(a.top+o.y)/s.y,d=a.width/s.x,u=a.height/s.y;if(i){const e=cH(i),t=r&&hH(r)?cH(r):r;let n=e,a=DH(n);for(;a&&r&&t!==n;){const e=cG(a),t=a.getBoundingClientRect(),r=MH(a),i=t.left+(a.clientLeft+parseFloat(r.paddingLeft))*e.x,s=t.top+(a.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=i,c+=s,n=cH(a),a=DH(n)}}return nG({width:d,height:u,x:l,y:c})}function pG(e,t){const n=kH(e).scrollLeft;return t?t.left+n:hG(dH(e)).left+n}function mG(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-pG(e,n),y:n.top+t.scrollTop}}const gG=new Set(["absolute","fixed"]);function fG(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=cH(e),r=dH(e),a=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,o=0,l=0;if(a){i=a.width,s=a.height;const e=_H();(!e||e&&"fixed"===t)&&(o=a.offsetLeft,l=a.offsetTop)}const c=pG(r);if(c<=0){const e=r.ownerDocument,t=e.body,n=getComputedStyle(t),a="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,s=Math.abs(r.clientWidth-t.clientWidth-a);s<=25&&(i-=s)}else c<=25&&(i+=c);return{width:i,height:s,x:o,y:l}}(e,n);else if("document"===t)r=function(e){const t=dH(e),n=kH(e),r=e.ownerDocument.body,a=IH(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=IH(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+pG(e);const o=-n.scrollTop;return"rtl"===MH(r).direction&&(s+=IH(t.clientWidth,r.clientWidth)-a),{width:a,height:i,x:s,y:o}}(dH(e));else if(hH(t))r=function(e,t){const n=hG(e,!0,"fixed"===t),r=n.top+e.clientTop,a=n.left+e.clientLeft,i=pH(e)?cG(e):LH(1);return{width:e.clientWidth*i.x,height:e.clientHeight*i.y,x:a*i.x,y:r*i.y}}(t,n);else{const n=uG(e);r={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return nG(r)}function xG(e,t){const n=EH(e);return!(n===t||!hH(n)||CH(n))&&("fixed"===MH(n).position||xG(n,t))}function yG(e,t,n){const r=pH(t),a=dH(t),i="fixed"===n,s=hG(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=LH(0);function c(){l.x=pG(a)}if(r||!r&&!i)if(("body"!==lH(t)||fH(a))&&(o=kH(t)),r){const e=hG(t,!0,i,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else a&&c();i&&!r&&a&&c();const d=!a||r||i?LH(0):mG(a,o);return{x:s.left+o.scrollLeft-l.x-d.x,y:s.top+o.scrollTop-l.y-d.y,width:s.width,height:s.height}}function vG(e){return"static"===MH(e).position}function bG(e,t){if(!pH(e)||"fixed"===MH(e).position)return null;if(t)return t(e);let n=e.offsetParent;return dH(e)===n&&(n=n.ownerDocument.body),n}function wG(e,t){const n=cH(e);if(bH(e))return n;if(!pH(e)){let t=EH(e);for(;t&&!CH(t);){if(hH(t)&&!vG(t))return t;t=EH(t)}return n}let r=bG(e,t);for(;r&&yH(r)&&vG(r);)r=bG(r,t);return r&&CH(r)&&vG(r)&&!jH(r)?n:r||function(e){let t=EH(e);for(;pH(t)&&!CH(t);){if(jH(t))return t;if(bH(t))return null;t=EH(t)}return null}(e)||n}const NG={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const i="fixed"===a,s=dH(r),o=!!t&&bH(t.floating);if(r===s||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=LH(1);const d=LH(0),u=pH(r);if((u||!u&&!i)&&(("body"!==lH(r)||fH(s))&&(l=kH(r)),pH(r))){const e=hG(r);c=cG(r),d.x=e.x+r.clientLeft,d.y=e.y+r.clientTop}const h=!s||u||i?LH(0):mG(s,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:n.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:dH,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const i=[..."clippingAncestors"===n?bH(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=PH(e,[],!1).filter(e=>hH(e)&&"body"!==lH(e)),a=null;const i="fixed"===MH(e).position;let s=i?EH(e):e;for(;hH(s)&&!CH(s);){const t=MH(s),n=jH(s);n||"fixed"!==t.position||(a=null),(i?!n&&!a:!n&&"static"===t.position&&a&&gG.has(a.position)||fH(s)&&!n&&xG(e,s))?r=r.filter(e=>e!==s):a=t,s=EH(s)}return t.set(e,r),r}(t,this._c):[].concat(n),r],s=i[0],o=i.reduce((e,n)=>{const r=fG(t,n,a);return e.top=IH(r.top,e.top),e.right=RH(r.right,e.right),e.bottom=RH(r.bottom,e.bottom),e.left=IH(r.left,e.left),e},fG(t,s,a));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:wG,getElementRects:function(e){return h(this,null,function*(){const t=this.getOffsetParent||wG,n=this.getDimensions,r=yield n(e.floating);return{reference:yG(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}})},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=oG(e);return{width:t,height:n}},getScale:cG,isElement:hH,isRTL:function(e){return"rtl"===MH(e).direction}};function SG(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function jG(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:d=!1}=r,u=lG(e),h=a||i?[...u?PH(u):[],...PH(t)]:[];h.forEach(e=>{a&&e.addEventListener("scroll",n,{passive:!0}),i&&e.addEventListener("resize",n)});const p=u&&o?function(e,t){let n,r=null;const a=dH(e);function i(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function s(o,d){void 0===o&&(o=!1),void 0===d&&(d=1),i();const u=e.getBoundingClientRect(),{left:h,top:p,width:m,height:g}=u;if(o||t(),!m||!g)return;const f={rootMargin:-BH(p)+"px "+-BH(a.clientWidth-(h+m))+"px "+-BH(a.clientHeight-(p+g))+"px "+-BH(h)+"px",threshold:IH(0,RH(1,d))||1};let x=!0;function y(t){const r=t[0].intersectionRatio;if(r!==d){if(!x)return s();r?s(!1,r):n=setTimeout(()=>{s(!1,1e-7)},1e3)}1!==r||SG(u,e.getBoundingClientRect())||s(),x=!1}try{r=new IntersectionObserver(y,c(l({},f),{root:a.ownerDocument}))}catch(v){r=new IntersectionObserver(y,f)}r.observe(e)}(!0),i}(u,n):null;let m,g=-1,f=null;s&&(f=new ResizeObserver(e=>{let[r]=e;r&&r.target===u&&f&&(f.unobserve(t),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var e;null==(e=f)||e.observe(t)})),n()}),u&&!d&&f.observe(u),f.observe(t));let x=d?hG(e):null;return d&&function t(){const r=hG(e);x&&!SG(x,r)&&n();x=r,m=requestAnimationFrame(t)}(),n(),()=>{var e;h.forEach(e=>{a&&e.removeEventListener("scroll",n),i&&e.removeEventListener("resize",n)}),null==p||p(),null==(e=f)||e.disconnect(),f=null,d&&cancelAnimationFrame(m)}}const _G=function(e){return void 0===e&&(e=0),{name:"offset",options:e,fn(t){return h(this,null,function*(){var n,r;const{x:a,y:i,placement:s,middlewareData:o}=t,d=yield function(e,t){return h(this,null,function*(){const{placement:n,platform:r,elements:a}=e,i=yield null==r.isRTL?void 0:r.isRTL(a.floating),s=HH(n),o=GH(n),l="y"===WH(n),c=sG.has(s)?-1:1,d=i&&l?-1:1,u=zH(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:m}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return o&&"number"==typeof m&&(p="end"===o?-1*m:m),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}})}(t,e);return s===(null==(n=o.offset)?void 0:n.placement)&&null!=(r=o.arrow)&&r.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:c(l({},d),{placement:s})}})}}},AG=function(e){return void 0===e&&(e={}),{name:"flip",options:e,fn(t){return h(this,null,function*(){var n,r;const{placement:a,middlewareData:i,rects:s,initialPlacement:o,platform:l,elements:c}=t,u=zH(e,t),{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:y=!0}=u,v=d(u,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const b=HH(a),w=WH(o),N=HH(o)===o,S=yield null==l.isRTL?void 0:l.isRTL(c.floating),j=g||(N||!y?[eG(o)]:function(e){const t=eG(e);return[XH(e),t,XH(t)]}(o)),_="none"!==x;!g&&_&&j.push(...ZH(o,y,x,S));const A=[o,...j],C=yield function(e,t){return h(this,null,function*(){var n;void 0===t&&(t={});const{x:r,y:a,platform:i,rects:s,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=zH(t,e),m=tG(p),g=o[h?"floating"===u?"reference":"floating":u],f=nG(yield i.getClippingRect({element:null==(n=yield null==i.isElement?void 0:i.isElement(g))||n?g:g.contextElement||(yield null==i.getDocumentElement?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:l})),x="floating"===u?{x:r,y:a,width:s.floating.width,height:s.floating.height}:s.reference,y=yield null==i.getOffsetParent?void 0:i.getOffsetParent(o.floating),v=(yield null==i.isElement?void 0:i.isElement(y))&&(yield null==i.getScale?void 0:i.getScale(y))||{x:1,y:1},b=nG(i.convertOffsetParentRelativeRectToViewportRelativeRect?yield i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:x,offsetParent:y,strategy:l}):x);return{top:(f.top-b.top+m.top)/v.y,bottom:(b.bottom-f.bottom+m.bottom)/v.y,left:(f.left-b.left+m.left)/v.x,right:(b.right-f.right+m.right)/v.x}})}(t,v),M=[];let k=(null==(r=i.flip)?void 0:r.overflows)||[];if(p&&M.push(C[b]),m){const e=function(e,t,n){void 0===n&&(n=!1);const r=GH(e),a=YH(e),i=VH(a);let s="x"===a?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=eG(s)),[s,eG(s)]}(a,s,S);M.push(C[e[0]],C[e[1]])}if(k=[...k,{placement:a,overflows:M}],!M.every(e=>e<=0)){var E,T;const e=((null==(E=i.flip)?void 0:E.index)||0)+1,t=A[e];if(t){if(!("alignment"===m&&w!==WH(t))||k.every(e=>WH(e.placement)!==w||e.overflows[0]>0))return{data:{index:e,overflows:k},reset:{placement:t}}}let n=null==(T=k.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:T.placement;if(!n)switch(f){case"bestFit":{var P;const e=null==(P=k.filter(e=>{if(_){const t=WH(e.placement);return t===w||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:P[0];e&&(n=e);break}case"initialPlacement":n=o}if(a!==n)return{reset:{placement:n}}}return{}})}}},CG=e=>({name:"arrow",options:e,fn(t){return h(this,null,function*(){const{x:n,y:r,placement:a,rects:i,platform:s,elements:o,middlewareData:c}=t,{element:d,padding:u=0}=zH(e,t)||{};if(null==d)return{};const h=tG(u),p={x:n,y:r},m=YH(a),g=VH(m),f=yield s.getDimensions(d),x="y"===m,y=x?"top":"left",v=x?"bottom":"right",b=x?"clientHeight":"clientWidth",w=i.reference[g]+i.reference[m]-p[m]-i.floating[g],N=p[m]-i.reference[m],S=yield null==s.getOffsetParent?void 0:s.getOffsetParent(d);let j=S?S[b]:0;j&&(yield null==s.isElement?void 0:s.isElement(S))||(j=o.floating[b]||i.floating[g]);const _=w/2-N/2,A=j/2-f[g]/2-1,C=RH(h[y],A),M=RH(h[v],A),k=C,E=j-f[g]-M,T=j/2-f[g]/2+_,P=IH(k,RH(T,E));const D=!c.arrow&&null!=GH(a)&&T!==P&&i.reference[g]/2-(T<k?C:M)-f[g]/2<0,R=D?T<k?T-k:T-E:0;return{[m]:p[m]+R,data:l({[m]:P,centerOffset:T-P-R},D&&{alignmentOffset:R}),reset:D}})}}),MG=(e,t,n)=>{const r=new Map,a=l({platform:NG},n),i=c(l({},a.platform),{_c:r});return((e,t,n)=>h(null,null,function*(){const{placement:r="bottom",strategy:a="absolute",middleware:i=[],platform:s}=n,o=i.filter(Boolean),d=yield null==s.isRTL?void 0:s.isRTL(t);let u=yield s.getElementRects({reference:e,floating:t,strategy:a}),{x:h,y:p}=iG(u,r,d),m=r,g={},f=0;for(let n=0;n<o.length;n++){const{name:i,fn:x}=o[n],{x:y,y:v,data:b,reset:w}=yield x({x:h,y:p,initialPlacement:r,placement:m,strategy:a,middlewareData:g,rects:u,platform:s,elements:{reference:e,floating:t}});h=null!=y?y:h,p=null!=v?v:p,g=c(l({},g),{[i]:l(l({},g[i]),b)}),w&&f<=50&&(f++,"object"==typeof w&&(w.placement&&(m=w.placement),w.rects&&(u=!0===w.rects?yield s.getElementRects({reference:e,floating:t,strategy:a}):w.rects),({x:h,y:p}=iG(u,m,d))),n=-1)}return{x:h,y:p,placement:m,strategy:a,middlewareData:g}}))(e,t,c(l({},a),{platform:i}))};var kG="undefined"!=typeof document?f.useLayoutEffect:function(){};function EG(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!==r--;)if(!EG(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;0!==r--;){const n=a[r];if(("_owner"!==n||!e.$$typeof)&&!EG(e[n],t[n]))return!1}return!0}return e!=e&&t!=t}function TG(e){if("undefined"==typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function PG(e,t){const n=TG(e);return Math.round(t*n)/n}function DG(e){const t=f.useRef(e);return kG(()=>{t.current=e}),t}const RG=(e,t)=>c(l({},_G(e)),{options:[e,t]}),IG=(e,t)=>c(l({},(e=>({name:"arrow",options:e,fn(t){const{element:n,padding:r}="function"==typeof e?e(t):e;return n&&(a=n,{}.hasOwnProperty.call(a,"current"))?null!=n.current?CG({element:n.current,padding:r}).fn(t):{}:n?CG({element:n,padding:r}).fn(t):{};var a}}))(e)),{options:[e,t]}),OG=l({},w);let BG=!1,LG=0;const FG=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+LG++;const UG=OG.useId||function(){const[e,t]=f.useState(()=>BG?FG():void 0);return rG(()=>{null==e&&t(FG())},[]),f.useEffect(()=>{BG=!0},[]),e},zG=f.forwardRef(function(e,t){const n=e,{context:{placement:r,elements:{floating:a},middlewareData:{arrow:i,shift:s}},width:o=14,height:u=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:m,stroke:g,d:x,style:y={}}=n,v=y,{transform:b}=v,w=d(v,["transform"]),N=d(n,["context","width","height","tipRadius","strokeWidth","staticOffset","stroke","d","style"]),S=UG(),[j,_]=f.useState(!1);if(rG(()=>{if(!a)return;"rtl"===MH(a).direction&&_(!0)},[a]),!a)return null;const[A,C]=r.split("-"),M="top"===A||"bottom"===A;let k=m;(M&&null!=s&&s.x||!M&&null!=s&&s.y)&&(k=null);const E=2*p,T=E/2,P=o/2*(h/-8+1),D=u/2*h/4,R=!!x,I=k&&"end"===C?"bottom":"top";let O=k&&"end"===C?"right":"left";k&&j&&(O="end"===C?"left":"right");const B=null!=(null==i?void 0:i.x)?k||i.x:"",L=null!=(null==i?void 0:i.y)?k||i.y:"",F=x||"M0,0 H"+o+" L"+(o-P)+","+(u-D)+" Q"+o/2+","+u+" "+P+","+(u-D)+" Z",U={top:R?"rotate(180deg)":"",left:R?"rotate(90deg)":"rotate(-90deg)",bottom:R?"":"rotate(180deg)",right:R?"rotate(-90deg)":"rotate(90deg)"}[A];return Nt.jsxs("svg",c(l({},N),{"aria-hidden":!0,ref:t,width:R?o:o+E,height:o,viewBox:"0 0 "+o+" "+(u>o?u:o),style:l({position:"absolute",pointerEvents:"none",[O]:B,[I]:L,[A]:M||R?"100%":"calc(100% - "+E/2+"px)",transform:[U,b].filter(e=>!!e).join(" ")},w),children:[E>0&&Nt.jsx("path",{clipPath:"url(#"+S+")",fill:"none",stroke:g,strokeWidth:E+(x?0:1),d:F}),Nt.jsx("path",{stroke:E&&!x?N.fill:"none",d:F}),Nt.jsx("clipPath",{id:S,children:Nt.jsx("rect",{x:-T,y:T*(R?-1:1),width:o+E,height:o})})]}))});const HG=f.createContext(null),GG=f.createContext(null);function VG(e){const{open:t=!1,onOpenChange:n,elements:r}=e,a=UG(),i=f.useRef({}),[s]=f.useState(()=>function(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach(e=>e(n))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var r;null==(r=e.get(t))||r.delete(n)}}}()),o=null!=((null==(l=f.useContext(HG))?void 0:l.id)||null);var l;const[c,d]=f.useState(r.reference),u=function(e){const t=f.useRef(()=>{});return aG(()=>{t.current=e}),f.useCallback(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}((e,t,r)=>{i.current.openEvent=e?t:void 0,s.emit("openchange",{open:e,event:t,reason:r,nested:o}),null==n||n(e,t,r)}),h=f.useMemo(()=>({setPositionReference:d}),[]),p=f.useMemo(()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference}),[c,r.reference,r.floating]);return f.useMemo(()=>({dataRef:i,open:t,onOpenChange:u,elements:p,events:s,floatingId:a,refs:h}),[t,u,p,s,a,h])}function $G(e){void 0===e&&(e={});const{nodeId:t}=e,n=VG(c(l({},e),{elements:l({reference:null,floating:null},e.elements)})),r=e.rootContext||n,a=r.elements,[i,s]=f.useState(null),[o,d]=f.useState(null),u=(null==a?void 0:a.domReference)||i,h=f.useRef(null),p=f.useContext(GG);rG(()=>{u&&(h.current=u)},[u]);const m=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:i,floating:s}={},transform:o=!0,whileElementsMounted:d,open:u}=e,[h,p]=f.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[m,g]=f.useState(r);EG(m,r)||g(r);const[x,y]=f.useState(null),[v,w]=f.useState(null),N=f.useCallback(e=>{e!==A.current&&(A.current=e,y(e))},[]),S=f.useCallback(e=>{e!==C.current&&(C.current=e,w(e))},[]),j=i||x,_=s||v,A=f.useRef(null),C=f.useRef(null),M=f.useRef(h),k=null!=d,E=DG(d),T=DG(a),P=DG(u),D=f.useCallback(()=>{if(!A.current||!C.current)return;const e={placement:t,strategy:n,middleware:m};T.current&&(e.platform=T.current),MG(A.current,C.current,e).then(e=>{const t=c(l({},e),{isPositioned:!1!==P.current});R.current&&!EG(M.current,t)&&(M.current=t,b.flushSync(()=>{p(t)}))})},[m,t,n,T,P]);kG(()=>{!1===u&&M.current.isPositioned&&(M.current.isPositioned=!1,p(e=>c(l({},e),{isPositioned:!1})))},[u]);const R=f.useRef(!1);kG(()=>(R.current=!0,()=>{R.current=!1}),[]),kG(()=>{if(j&&(A.current=j),_&&(C.current=_),j&&_){if(E.current)return E.current(j,_,D);D()}},[j,_,D,E,k]);const I=f.useMemo(()=>({reference:A,floating:C,setReference:N,setFloating:S}),[N,S]),O=f.useMemo(()=>({reference:j,floating:_}),[j,_]),B=f.useMemo(()=>{const e={position:n,left:0,top:0};if(!O.floating)return e;const t=PG(O.floating,h.x),r=PG(O.floating,h.y);return o?l(c(l({},e),{transform:"translate("+t+"px, "+r+"px)"}),TG(O.floating)>=1.5&&{willChange:"transform"}):{position:n,left:t,top:r}},[n,o,O.floating,h.x,h.y]);return f.useMemo(()=>c(l({},h),{update:D,refs:I,elements:O,floatingStyles:B}),[h,D,I,O,B])}(c(l({},e),{elements:l(l({},a),o&&{reference:o})})),g=f.useCallback(e=>{const t=hH(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects(),contextElement:e}:e;d(t),m.refs.setReference(t)},[m.refs]),x=f.useCallback(e=>{(hH(e)||null===e)&&(h.current=e,s(e)),(hH(m.refs.reference.current)||null===m.refs.reference.current||null!==e&&!hH(e))&&m.refs.setReference(e)},[m.refs]),y=f.useMemo(()=>c(l({},m.refs),{setReference:x,setPositionReference:g,domReference:h}),[m.refs,x,g]),v=f.useMemo(()=>c(l({},m.elements),{domReference:u}),[m.elements,u]),w=f.useMemo(()=>c(l(l({},m),r),{refs:y,elements:v,nodeId:t}),[m,y,v,t,r]);return rG(()=>{r.dataRef.current.floatingContext=w;const e=null==p?void 0:p.nodesRef.current.find(e=>e.id===t);e&&(e.context=w)}),f.useMemo(()=>c(l({},m),{context:w,refs:y,elements:v}),[m,y,v,w])}
/*!
  react-datepicker v8.8.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var WG=function(e,t){return(WG=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function YG(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}WG(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var XG=function(){return XG=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},XG.apply(this,arguments)};function KG(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var qG,JG,QG=function(e){var t=e.showTimeSelectOnly,n=void 0!==t&&t,r=e.showTime,a=void 0!==r&&r,i=e.className,s=e.children,o=n?"Choose Time":"Choose Date".concat(a?" and Time":"");return v.createElement("div",{className:i,role:"dialog","aria-label":o,"aria-modal":"true"},s)},ZG=function(e){var t=e.children,n=e.onClickOutside,r=e.className,a=e.containerRef,i=e.style,s=function(e,t){var n=f.useRef(null),r=f.useRef(e);r.current=e;var a=f.useCallback(function(e){var a,i=e.composed&&e.composedPath&&e.composedPath().find(function(e){return e instanceof Node})||e.target;n.current&&!n.current.contains(i)&&(t&&i instanceof HTMLElement&&i.classList.contains(t)||null===(a=r.current)||void 0===a||a.call(r,e))},[t]);return f.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),n}(n,e.ignoreClass);return v.createElement("div",{className:r,style:i,ref:function(e){s.current=e,a&&(a.current=e)}},t)};function eV(){return"undefined"!=typeof window?window:globalThis}(JG=qG||(qG={})).ArrowUp="ArrowUp",JG.ArrowDown="ArrowDown",JG.ArrowLeft="ArrowLeft",JG.ArrowRight="ArrowRight",JG.PageUp="PageUp",JG.PageDown="PageDown",JG.Home="Home",JG.End="End",JG.Enter="Enter",JG.Space=" ",JG.Tab="Tab",JG.Escape="Escape",JG.Backspace="Backspace",JG.X="x";function tV(e){if(null==e)return new Date;var t="string"==typeof e?Hz(e):bF(e);return rV(t)?t:new Date}function nV(e,t,n,r,a){void 0===a&&(a=tV());for(var i=NV(n)||NV(wV()),s=0,o=Array.isArray(t)?t:[t];s<o.length;s++){var l=o[s],c=Fz(e,l,a,{locale:i});if(rV(c)&&(!r||e===aV(c,l,n)))return c}return null}function rV(e,t){return HF(e)&&!VU(e,new Date("1/1/1800"))}function aV(e,t,n){if("en"===n)return RU(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=n?NV(n):void 0;return n&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),RU(e,t,{locale:r=r||NV(wV()),useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function iV(e,t){var n=t.dateFormat,r=t.locale,a=Array.isArray(n)&&n.length>0?n[0]:n;return e&&aV(e,a,r)||""}function sV(e,t){var n=t.hour,r=void 0===n?0:n,a=t.minute,i=void 0===a?0:a,s=t.second;return Qz(Zz(tH(e,void 0===s?0:s),i),r)}function oV(e){return PF(e)}function lV(e,t,n){return CF(e,{locale:NV(t||wV()),weekStartsOn:n})}function cV(e){return JF(e)}function dV(e){return ZF(e)}function uV(e){return qF(e)}function hV(){return PF(tV())}function pV(e){return XF(e)}function mV(e){return function(e,t){var n,r,a,i;const s=AF(),o=null!=(i=null!=(a=s.weekStartsOn)?a:null==(r=null==(n=s.locale)?void 0:n.options)?void 0:r.weekStartsOn)?i:0,l=bF(e,null==t?void 0:t.in),c=l.getDay(),d=6+(c<o?-7:0)-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}(e)}function gV(e,t){return e&&t?function(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return r.getFullYear()===a.getFullYear()}(e,t):!e&&!t}function fV(e,t){return e&&t?function(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}(e,t):!e&&!t}function xV(e,t){return e&&t?function(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return+qF(r)===+qF(a)}(e,t):!e&&!t}function yV(e,t){return e&&t?function(e,t,n){const[r,a]=TF(null==n||n.in,e,t);return+PF(r)===+PF(a)}(e,t):!e&&!t}function vV(e,t){return e&&t?(n=t,+bF(e)===+bF(n)):!e&&!t;var n}function bV(e,t,n){var r,a=PF(t),i=XF(n);try{r=zz(e,{start:a,end:i})}catch(s){r=!1}return r}function wV(){return eV().__localeId__}function NV(e){if("string"==typeof e){var t=eV();return t.__localeData__?t.__localeData__[e]:void 0}return e}function SV(e,t){return aV(Jz(tV(),e),"LLLL",t)}function jV(e,t){return aV(Jz(tV(),e),"LLL",t)}function _V(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,i=n.excludeDates,s=n.excludeDateIntervals,o=n.includeDates,l=n.includeDateIntervals,c=n.filterDate;return!!n.disabled||(RV(e,{minDate:r,maxDate:a})||i&&i.some(function(t){return t instanceof Date?yV(e,t):yV(e,t.date)})||s&&s.some(function(t){var n=t.start,r=t.end;return zz(e,{start:n,end:r})})||o&&!o.some(function(t){return yV(e,t)})||l&&!l.some(function(t){var n=t.start,r=t.end;return zz(e,{start:n,end:r})})||c&&!c(tV(e))||!1)}function AV(e,t){var n=void 0===t?{}:t,r=n.excludeDates,a=n.excludeDateIntervals;return a&&a.length>0?a.some(function(t){var n=t.start,r=t.end;return zz(e,{start:n,end:r})}):r&&r.some(function(t){var n;return t instanceof Date?yV(e,t):yV(e,null!==(n=t.date)&&void 0!==n?n:new Date)})||!1}function CV(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,i=n.excludeDates,s=n.includeDates,o=n.filterDate;return RV(e,{minDate:r?JF(r):void 0,maxDate:a?KF(a):void 0})||(null==i?void 0:i.some(function(t){return fV(e,t instanceof Date?t:t.date)}))||s&&!s.some(function(t){return fV(e,t)})||o&&!o(tV(e))||!1}function MV(e,t,n,r){var a=HU(e),i=FU(e),s=HU(t),o=FU(t),l=HU(r);return a===s&&a===l?i<=n&&n<=o:a<s&&(l===a&&i<=n||l===s&&o>=n||l<s&&l>a)}function kV(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,i=n.excludeDates,s=n.includeDates;return RV(e,{minDate:r,maxDate:a})||i&&i.some(function(t){return fV(t instanceof Date?t:t.date,e)})||s&&!s.some(function(t){return fV(t,e)})||!1}function EV(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,i=n.excludeDates,s=n.includeDates,o=n.filterDate;return!!n.disabled||(RV(e,{minDate:r,maxDate:a})||(null==i?void 0:i.some(function(t){return xV(e,t instanceof Date?t:t.date)}))||s&&!s.some(function(t){return xV(e,t)})||o&&!o(tV(e))||!1)}function TV(e,t,n){if(!t||!n)return!1;if(!HF(t)||!HF(n))return!1;var r=HU(t),a=HU(n);return r<=e&&a>=e}function PV(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,i=n.excludeDates,s=n.includeDates,o=n.filterDate;if(n.disabled)return!0;var l=new Date(e,0,1);return RV(l,{minDate:r?ZF(r):void 0,maxDate:a?QF(a):void 0})||(null==i?void 0:i.some(function(e){return gV(l,e instanceof Date?e:e.date)}))||s&&!s.some(function(e){return gV(l,e)})||o&&!o(tV(l))||!1}function DV(e,t,n,r){var a=HU(e),i=VF(e),s=HU(t),o=VF(t),l=HU(r);return a===s&&a===l?i<=n&&n<=o:a<s&&(l===a&&i<=n||l===s&&o>=n||l<s&&l>a)}function RV(e,t){var n,r=void 0===t?{}:t,a=r.minDate,i=r.maxDate;return null!==(n=a&&DF(e,a)<0||i&&DF(e,i)>0)&&void 0!==n&&n}function IV(e,t){return t.some(function(t){return BU(t)===BU(e)&&LU(t)===LU(e)&&UU(t)===UU(e)})}function OV(e,t){var n=void 0===t?{}:t,r=n.excludeTimes,a=n.includeTimes,i=n.filterTime;return r&&IV(e,r)||a&&!IV(e,a)||i&&!i(e)||!1}function BV(e,t){var n=t.minTime,r=t.maxTime;if(!n||!r)throw new Error("Both minTime and maxTime props required");var a=tV();a=tH(a=Zz(a=Qz(a,BU(e)),LU(e)),UU(e));var i=tV();i=tH(i=Zz(i=Qz(i,BU(n)),LU(n)),UU(n));var s,o=tV();o=tH(o=Zz(o=Qz(o,BU(r)),LU(r)),UU(r));try{s=!zz(a,{start:i,end:o})}catch(l){s=!1}return s}function LV(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,i=rH(e,1);return r&&GF(r,i)>0||a&&a.every(function(e){return GF(e,i)>0})||!1}function FV(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,i=NF(e,1);return r&&GF(i,r)>0||a&&a.every(function(e){return GF(i,e)>0})||!1}function UV(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,i=sH(e,1);return r&&WF(r,i)>0||a&&a.every(function(e){return WF(e,i)>0})||!1}function zV(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,i=LF(e,1);return r&&WF(i,r)>0||a&&a.every(function(e){return WF(i,e)>0})||!1}function HV(e){var t=e.minDate,n=e.includeDates;return n&&t?UF(n.filter(function(e){return DF(e,t)>=0})):n?UF(n):t}function GV(e){var t=e.maxDate,n=e.includeDates;return n&&t?FF(n.filter(function(e){return DF(e,t)<=0})):n?FF(n):t}function VV(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--highlighted");for(var r=new Map,a=0,i=e.length;a<i;a++){var s=e[a];if(zF(s)){var o=aV(s,"MM.dd.yyyy");(p=r.get(o)||[]).includes(t)||(p.push(t),r.set(o,p))}else if("object"==typeof s){var l=null!==(n=Object.keys(s)[0])&&void 0!==n?n:"",c=s[l];if("string"==typeof l&&Array.isArray(c))for(var d=0,u=c.length;d<u;d++){var h=c[d];if(h){var p;o=aV(h,"MM.dd.yyyy");(p=r.get(o)||[]).includes(l)||(p.push(l),r.set(o,p))}}}}return r}function $V(e,t){void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--holidays");var n=new Map;return e.forEach(function(e){var r=e.date,a=e.holidayName;if(zF(r)){var i=aV(r,"MM.dd.yyyy"),s=n.get(i)||{className:"",holidayNames:[]};if(!("className"in s)||s.className!==t||(o=s.holidayNames,l=[a],o.length!==l.length||!o.every(function(e,t){return e===l[t]}))){var o,l;s.className=t;var c=s.holidayNames;s.holidayNames=c?KG(KG([],c,!0),[a],!1):[a],n.set(i,s)}}}),n}function WV(e,t,n,r,a){for(var i=a.length,s=[],o=0;o<i;o++){var l=e,c=a[o];c&&(l=OF(l=RF(l=jF(l,BU(c)),LU(c)),UU(c)));var d=RF(e,(n+1)*r);GU(l,t)&&VU(l,d)&&null!=c&&s.push(c)}return s}function YV(e){return e<10?"0".concat(e):"".concat(e)}function XV(e,t){void 0===t&&(t=12);var n=Math.ceil(HU(e)/t)*t;return{startPeriod:n-(t-1),endPeriod:n}}function KV(e){var t=e.getSeconds(),n=e.getMilliseconds();return bF(e.getTime()-1e3*t-n)}function qV(e){if(!zF(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function JV(e,t){if(!zF(e)||!zF(t))throw new Error("Invalid date received");return VU(qV(e),qV(t))}function QV(e){return e.key===qG.Space}var ZV,e$=function(e){function t(t){var n=e.call(this,t)||this;return n.inputRef=v.createRef(),n.onTimeChange=function(e){var t,r;n.setState({time:e});var a=n.props.date,i=a instanceof Date&&!isNaN(+a)?a:new Date;if(null==e?void 0:e.includes(":")){var s=e.split(":"),o=s[0],l=s[1];i.setHours(Number(o)),i.setMinutes(Number(l))}null===(r=(t=n.props).onChange)||void 0===r||r.call(t,i)},n.renderTimeInput=function(){var e=n.state.time,t=n.props,r=t.date,a=t.timeString,i=t.customTimeInput;return i?f.cloneElement(i,{date:r,value:e,onChange:n.onTimeChange}):v.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var e;null===(e=n.inputRef.current)||void 0===e||e.focus()},required:!0,value:e,onChange:function(e){n.onTimeChange(e.target.value||a)}})},n.state={time:n.props.timeString},n}return YG(t,e),t.getDerivedStateFromProps=function(e,t){return e.timeString!==t.time?{time:e.timeString}:null},t.prototype.render=function(){return v.createElement("div",{className:"react-datepicker__input-time-container"},v.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),v.createElement("div",{className:"react-datepicker-time__input-container"},v.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},t}(f.Component),t$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dayEl=f.createRef(),t.handleClick=function(e){!t.isDisabled()&&t.props.onClick&&t.props.onClick(e)},t.handleMouseEnter=function(e){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(e)},t.handleOnKeyDown=function(e){var n,r;e.key===qG.Space&&(e.preventDefault(),e.key=qG.Enter),null===(r=(n=t.props).handleOnKeyDown)||void 0===r||r.call(n,e)},t.isSameDay=function(e){return yV(t.props.day,e)},t.isKeyboardSelected=function(){var e;if(t.props.disabledKeyboardNavigation)return!1;var n=t.props.selectsMultiple?null===(e=t.props.selectedDates)||void 0===e?void 0:e.some(function(e){return t.isSameDayOrWeek(e)}):t.isSameDayOrWeek(t.props.selected),r=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!n&&t.isSameDayOrWeek(t.props.preSelection)&&!r},t.isDisabled=function(e){return void 0===e&&(e=t.props.day),_V(e,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate,disabled:t.props.disabled})},t.isExcluded=function(){return AV(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return yV(t.props.day,lV(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(e){return t.props.showWeekPicker&&yV(e,lV(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(e){return t.isSameDay(e)||t.isSameWeek(e)},t.getHighLightedClass=function(){var e=t.props,n=e.day,r=e.highlightDates;if(!r)return!1;var a=aV(n,"MM.dd.yyyy");return r.get(a)},t.getHolidaysClass=function(){var e,n=t.props,r=n.day,a=n.holidays;if(!a)return[void 0];var i=aV(r,"MM.dd.yyyy");return a.has(i)?[null===(e=a.get(i))||void 0===e?void 0:e.className]:[void 0]},t.isInRange=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&bV(n,r,a)},t.isInSelectingRange=function(){var e,n=t.props,r=n.day,a=n.selectsStart,i=n.selectsEnd,s=n.selectsRange,o=n.selectsDisabledDaysInRange,l=n.startDate,c=n.swapRange,d=n.endDate,u=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;if(!(a||i||s)||!u||!o&&t.isDisabled())return!1;if(a&&d&&(VU(u,d)||vV(u,d)))return bV(r,u,d);if(i&&l&&(GU(u,l)||vV(u,l)))return bV(r,l,u);if(s&&l&&!d){if(vV(u,l))return bV(r,l,u);if(GU(u,l))return bV(r,l,u);if(c&&VU(u,l))return bV(r,u,l)}return!1},t.isSelectingRangeStart=function(){var e;if(!t.isInSelectingRange())return!1;var n=t.props,r=n.day,a=n.startDate,i=n.selectsStart,s=n.swapRange,o=n.selectsRange,l=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return yV(r,i||o&&s&&a&&l&&VU(l,a)?l:a)},t.isSelectingRangeEnd=function(){var e;if(!t.isInSelectingRange())return!1;var n=t.props,r=n.day,a=n.endDate,i=n.selectsEnd,s=n.selectsRange,o=n.swapRange,l=n.startDate,c=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return yV(r,i?c:s&&o&&l&&c?VU(c,l)?l:c:s?c:a)},t.isRangeStart=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&yV(r,n)},t.isRangeEnd=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&yV(a,n)},t.isWeekend=function(){var e,n=bF(t.props.day,null==e?void 0:e.in).getDay();return 0===n||6===n},t.isAfterMonth=function(){return void 0!==t.props.month&&(t.props.month+1)%12===FU(t.props.day)},t.isBeforeMonth=function(){return void 0!==t.props.month&&(FU(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(tV())},t.isSelected=function(){var e;return t.props.selectsMultiple?null===(e=t.props.selectedDates)||void 0===e?void 0:e.some(function(e){return t.isSameDayOrWeek(e)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(e){var n;return yd("react-datepicker__day",t.props.dayClassName?t.props.dayClassName(e):void 0,"react-datepicker__day--"+aV(t.props.day,"ddd",n),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var e=t.props,n=e.day,r=e.ariaLabelPrefixWhenEnabled,a=void 0===r?"Choose":r,i=e.ariaLabelPrefixWhenDisabled,s=void 0===i?"Not available":i,o=t.isDisabled()||t.isExcluded()?s:a;return"".concat(o," ").concat(aV(n,"PPPP",t.props.locale))},t.getTitle=function(){var e=t.props,n=e.day,r=e.holidays,a=void 0===r?new Map:r,i=e.excludeDates,s=aV(n,"MM.dd.yyyy"),o=[];return a.has(s)&&o.push.apply(o,a.get(s).holidayNames),t.isExcluded()&&o.push(null==i?void 0:i.filter(function(e){return e instanceof Date?yV(e,n):yV(null==e?void 0:e.date,n)}).map(function(e){if(!(e instanceof Date))return null==e?void 0:e.message})),o.join(", ")},t.getTabIndex=function(){var e=t.props.selected,n=t.props.preSelection;return(!t.props.showWeekPicker||!t.props.showWeekNumber&&t.isStartOfWeek())&&(t.isKeyboardSelected()||t.isSameDay(e)&&yV(n,e))?0:-1},t.handleFocusDay=function(){var e;t.shouldFocusDay()&&(null===(e=t.dayEl.current)||void 0===e||e.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(OU(t.props.day),t.props.day):OU(t.props.day)},t.render=function(){return v.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"gridcell",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),""!==t.getTitle()&&v.createElement("span",{className:"overlay"},t.getTitle()))},t}return YG(t,e),t.prototype.componentDidMount=function(){this.handleFocusDay()},t.prototype.componentDidUpdate=function(){this.handleFocusDay()},t.prototype.shouldFocusDay=function(){var e=!1;return 0===this.getTabIndex()&&this.isSameDay(this.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(e=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(e=!1),this.isDayActiveElement()&&(e=!0),this.isDuplicateDay()&&(e=!1)),e},t.prototype.isDayActiveElement=function(){var e,t,n;return(null===(t=null===(e=this.props.containerRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.contains(document.activeElement))&&(null===(n=document.activeElement)||void 0===n?void 0:n.classList.contains("react-datepicker__day"))},t.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},t}(f.Component),n$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.weekNumberEl=f.createRef(),t.handleClick=function(e){t.props.onClick&&t.props.onClick(e)},t.handleOnKeyDown=function(e){var n,r;e.key===qG.Space&&(e.preventDefault(),e.key=qG.Enter),null===(r=(n=t.props).handleOnKeyDown)||void 0===r||r.call(n,e)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!yV(t.props.date,t.props.selected)&&yV(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||yV(t.props.date,t.props.selected)&&yV(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(e){var n=!1;0===t.getTabIndex()&&!(null==e?void 0:e.isInputFocused)&&yV(t.props.date,t.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(n=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(n=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(n=!0)),n&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return YG(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},t.prototype.componentDidUpdate=function(e){this.handleFocusWeekNumber(e)},t.prototype.render=function(){var e=this.props,n=e.weekNumber,r=e.isWeekDisabled,a=e.ariaLabelPrefix,i=void 0===a?t.defaultProps.ariaLabelPrefix:a,s=e.onClick,o={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!s&&!r,"react-datepicker__week-number--selected":!!s&&yV(this.props.date,this.props.selected)};return v.createElement("div",{ref:this.weekNumberEl,className:yd(o),"aria-label":"".concat(i," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex(),role:"gridcell"},n)},t}(f.Component),r$=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isDisabled=function(e){return _V(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals,includeDateIntervals:n.props.includeDateIntervals,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.handleDayClick=function(e,t){n.props.onDayClick&&n.props.onDayClick(e,t)},n.handleDayMouseEnter=function(e){n.props.onDayMouseEnter&&n.props.onDayMouseEnter(e)},n.handleWeekClick=function(e,r,a){for(var i,s,o,l=new Date(e),c=0;c<7;c++){var d=new Date(e);if(d.setDate(d.getDate()+c),!n.isDisabled(d)){l=d;break}}"function"==typeof n.props.onWeekSelect&&n.props.onWeekSelect(l,r,a),n.props.showWeekPicker&&n.handleDayClick(l,a),(null!==(i=n.props.shouldCloseOnSelect)&&void 0!==i?i:t.defaultProps.shouldCloseOnSelect)&&(null===(o=(s=n.props).setOpen)||void 0===o||o.call(s,!1))},n.formatWeekNumber=function(e){return n.props.formatWeekNumber?n.props.formatWeekNumber(e):function(e){return lU(e)}(e)},n.isWeekDisabled=function(){for(var e=n.startOfWeek(),t=wF(e,6),r=new Date(e);r<=t;){if(!n.isDisabled(r))return!1;r=wF(r,1)}return!0},n.renderDays=function(){var e=n.startOfWeek(),r=[],a=n.formatWeekNumber(e);if(n.props.showWeekNumber){var i=n.props.onWeekSelect||n.props.showWeekPicker?n.handleWeekClick.bind(n,e,a):void 0;r.push(v.createElement(n$,XG({key:"W"},t.defaultProps,n.props,{weekNumber:a,isWeekDisabled:n.isWeekDisabled(),date:e,onClick:i})))}return r.concat([0,1,2,3,4,5,6].map(function(r){var a=wF(e,r);return v.createElement(t$,XG({},t.defaultProps,n.props,{ariaLabelPrefixWhenEnabled:n.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:n.props.disabledDayAriaLabelPrefix,key:a.valueOf(),day:a,onClick:n.handleDayClick.bind(n,a),onMouseEnter:n.handleDayMouseEnter.bind(n,a)}))}))},n.startOfWeek=function(){return lV(n.props.day,n.props.locale,n.props.calendarStartDay)},n.isKeyboardSelected=function(){return!n.props.disabledKeyboardNavigation&&!yV(n.startOfWeek(),n.props.selected)&&yV(n.startOfWeek(),n.props.preSelection)},n}return YG(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e={"react-datepicker__week":!0,"react-datepicker__week--selected":yV(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()},t=this.props.weekClassName?this.props.weekClassName(this.startOfWeek()):void 0;return v.createElement("div",{className:yd(e,t),role:"row"},this.renderDays())},t}(f.Component),a$="two_columns",i$="three_columns",s$="four_columns",o$=((ZV={})[a$]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},ZV[i$]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},ZV[s$]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},ZV);function l$(e,t){return e?s$:t?a$:i$}var c$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MONTH_REFS=KG([],Array(12),!0).map(function(){return f.createRef()}),t.QUARTER_REFS=KG([],Array(4),!0).map(function(){return f.createRef()}),t.isDisabled=function(e){return _V(e,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate,disabled:t.props.disabled})},t.isExcluded=function(e){return AV(e,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(e,n){var r,a;null===(a=(r=t.props).onDayClick)||void 0===a||a.call(r,e,n,t.props.orderInDisplay)},t.handleDayMouseEnter=function(e){var n,r;null===(r=(n=t.props).onDayMouseEnter)||void 0===r||r.call(n,e)},t.handleMouseLeave=function(){var e,n;null===(n=(e=t.props).onMouseLeave)||void 0===n||n.call(e)},t.isRangeStartMonth=function(e){var n=t.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&fV(Jz(r,e),a)},t.isRangeStartQuarter=function(e){var n=t.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&xV(eH(r,e),a)},t.isRangeEndMonth=function(e){var n=t.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&fV(Jz(r,e),i)},t.isRangeEndQuarter=function(e){var n=t.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&xV(eH(r,e),i)},t.isInSelectingRangeMonth=function(e){var n,r=t.props,a=r.day,i=r.selectsStart,s=r.selectsEnd,o=r.selectsRange,l=r.startDate,c=r.endDate,d=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return!(!(i||s||o)||!d)&&(i&&c?MV(d,c,e,a):(s&&l||!(!o||!l||c))&&MV(l,d,e,a))},t.isSelectingMonthRangeStart=function(e){var n;if(!t.isInSelectingRangeMonth(e))return!1;var r=t.props,a=r.day,i=r.startDate,s=r.selectsStart,o=Jz(a,e),l=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return fV(o,s?l:i)},t.isSelectingMonthRangeEnd=function(e){var n;if(!t.isInSelectingRangeMonth(e))return!1;var r=t.props,a=r.day,i=r.endDate,s=r.selectsEnd,o=r.selectsRange,l=Jz(a,e),c=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return fV(l,s||o?c:i)},t.isInSelectingRangeQuarter=function(e){var n,r=t.props,a=r.day,i=r.selectsStart,s=r.selectsEnd,o=r.selectsRange,l=r.startDate,c=r.endDate,d=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return!(!(i||s||o)||!d)&&(i&&c?DV(d,c,e,a):(s&&l||!(!o||!l||c))&&DV(l,d,e,a))},t.isWeekInMonth=function(e){var n=t.props.day,r=wF(e,6);return fV(e,n)||fV(r,n)},t.isCurrentMonth=function(e,t){return HU(e)===HU(tV())&&t===FU(tV())},t.isCurrentQuarter=function(e,t){return HU(e)===HU(tV())&&t===VF(tV())},t.isSelectedMonth=function(e,t,n){return FU(n)===t&&HU(e)===HU(n)},t.isSelectMonthInList=function(e,n,r){return r.some(function(r){return t.isSelectedMonth(e,n,r)})},t.isSelectedQuarter=function(e,t,n){return VF(e)===t&&HU(e)===HU(n)},t.isMonthSelected=function(){var e=t.props,n=e.day,r=e.selected,a=e.selectedDates,i=e.selectsMultiple,s=FU(n);return i?null==a?void 0:a.some(function(e){return t.isSelectedMonth(n,s,e)}):!!r&&t.isSelectedMonth(n,s,r)},t.renderWeeks=function(){for(var e,n,r=[],a=t.props.fixedHeight,i=0,s=!1,o=lV(cV(t.props.day),t.props.locale,t.props.calendarStartDay),l=t.props.selected?(e=t.props.selected,t.props.showWeekPicker?lV(e,t.props.locale,t.props.calendarStartDay):t.props.selected):void 0,c=t.props.preSelection?(n=t.props.preSelection,t.props.showWeekPicker?lV(n,t.props.locale,t.props.calendarStartDay):t.props.preSelection):void 0;r.push(v.createElement(r$,XG({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:i,day:o,month:FU(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:l,preSelection:c,showWeekNumber:t.props.showWeekNumbers}))),!s;){i++,o=BF(o,1);var d=a&&i>=6,u=!a&&!t.isWeekInMonth(o);if(d||u){if(!t.props.peekNextMonth)break;s=!0}}return r},t.onMonthClick=function(e,n){var r=t.isMonthDisabledForLabelDate(n),a=r.isDisabled,i=r.labelDate;a||t.handleDayClick(cV(i),e)},t.onMonthMouseEnter=function(e){var n=t.isMonthDisabledForLabelDate(e),r=n.isDisabled,a=n.labelDate;r||t.handleDayMouseEnter(cV(a))},t.handleMonthNavigation=function(e,n){var r,a,i,s;null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,n),null===(s=null===(i=t.MONTH_REFS[e])||void 0===i?void 0:i.current)||void 0===s||s.focus()},t.handleKeyboardNavigation=function(e,n,r){var a,i=t.props,s=i.selected,o=i.preSelection,l=i.setPreSelection,c=i.minDate,d=i.maxDate,u=i.showFourColumnMonthYearPicker,h=i.showTwoColumnMonthYearPicker;if(o){var p=l$(u,h),m=t.getVerticalOffset(p),g=null===(a=o$[p])||void 0===a?void 0:a.grid,f=function(e,t,n){var r,a,i=t,s=n;switch(e){case qG.ArrowRight:i=NF(t,1),s=11===n?0:n+1;break;case qG.ArrowLeft:i=rH(t,1),s=0===n?11:n-1;break;case qG.ArrowUp:i=rH(t,m),s=(null===(r=null==g?void 0:g[0])||void 0===r?void 0:r.includes(n))?n+12-m:n-m;break;case qG.ArrowDown:i=NF(t,m),s=(null===(a=null==g?void 0:g[g.length-1])||void 0===a?void 0:a.includes(n))?n-12+m:n+m}return{newCalculatedDate:i,newCalculatedMonth:s}};if(n!==qG.Enter){var x=function(e,n,r){for(var a=e,i=!1,s=0,o=f(a,n,r),l=o.newCalculatedDate,u=o.newCalculatedMonth;!i;){if(s>=40){l=n,u=r;break}var h;if(c&&l<c)a=qG.ArrowRight,l=(h=f(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;if(d&&l>d)a=qG.ArrowLeft,l=(h=f(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;if(kV(l,t.props))l=(h=f(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;else i=!0;s++}return{newCalculatedDate:l,newCalculatedMonth:u}}(n,o,r),y=x.newCalculatedDate,v=x.newCalculatedMonth;switch(n){case qG.ArrowRight:case qG.ArrowLeft:case qG.ArrowUp:case qG.ArrowDown:t.handleMonthNavigation(v,y)}}else t.isMonthDisabled(r)||(t.onMonthClick(e,r),null==l||l(s))}},t.getVerticalOffset=function(e){var t,n;return null!==(n=null===(t=o$[e])||void 0===t?void 0:t.verticalNavigationOffset)&&void 0!==n?n:0},t.onMonthKeyDown=function(e,n){var r=t.props,a=r.disabledKeyboardNavigation,i=r.handleOnMonthKeyDown,s=e.key;s!==qG.Tab&&e.preventDefault(),a||t.handleKeyboardNavigation(e,s,n),i&&i(e)},t.onQuarterClick=function(e,n){var r=eH(t.props.day,n);EV(r,t.props)||t.handleDayClick(uV(r),e)},t.onQuarterMouseEnter=function(e){var n=eH(t.props.day,e);EV(n,t.props)||t.handleDayMouseEnter(uV(n))},t.handleQuarterNavigation=function(e,n){var r,a,i,s;t.isDisabled(n)||t.isExcluded(n)||(null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,n),null===(s=null===(i=t.QUARTER_REFS[e-1])||void 0===i?void 0:i.current)||void 0===s||s.focus())},t.onQuarterKeyDown=function(e,n){var r,a,i=e.key;if(!t.props.disabledKeyboardNavigation)switch(i){case qG.Enter:t.onQuarterClick(e,n),null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,t.props.selected);break;case qG.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(4===n?1:n+1,IF(t.props.preSelection,1));break;case qG.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(1===n?4:n-1,aH(t.props.preSelection))}},t.isMonthDisabledForLabelDate=function(e){var n,r=t.props,a=r.day,i=r.disabled,s=r.minDate,o=r.maxDate,l=r.excludeDates,c=r.includeDates,d=Jz(a,e);return i?{isDisabled:!0,labelDate:Jz(a,e)}:{isDisabled:null!==(n=(s||o||l||c)&&CV(d,t.props))&&void 0!==n&&n,labelDate:d}},t.isMonthDisabled=function(e){return t.isMonthDisabledForLabelDate(e).isDisabled},t.getMonthClassNames=function(e){var n=t.props,r=n.day,a=n.startDate,i=n.endDate,s=n.preSelection,o=n.monthClassName,l=o?o(Jz(r,e)):void 0,c=t.getSelection();return yd("react-datepicker__month-text","react-datepicker__month-".concat(e),l,{"react-datepicker__month-text--disabled":t.isMonthDisabled(e),"react-datepicker__month-text--selected":c?t.isSelectMonthInList(r,e,c):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&s&&t.isSelectedMonth(r,e,s)&&!t.isMonthSelected()&&!t.isMonthDisabled(e),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(e),"react-datepicker__month-text--in-range":a&&i?MV(a,i,e,r):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(e),"react-datepicker__month-text--range-end":t.isRangeEndMonth(e),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(e),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(e),"react-datepicker__month-text--today":t.isCurrentMonth(r,e)})},t.getTabIndex=function(e){if(null==t.props.preSelection)return"-1";var n=FU(t.props.preSelection),r=t.isMonthDisabledForLabelDate(n).isDisabled;return e!==n||r||t.props.disabledKeyboardNavigation?"-1":"0"},t.getQuarterTabIndex=function(e){if(null==t.props.preSelection)return"-1";var n=VF(t.props.preSelection),r=EV(t.props.day,t.props);return e!==n||r||t.props.disabledKeyboardNavigation?"-1":"0"},t.getAriaLabel=function(e){var n=t.props,r=n.chooseDayAriaLabelPrefix,a=void 0===r?"Choose":r,i=n.disabledDayAriaLabelPrefix,s=void 0===i?"Not available":i,o=n.day,l=n.locale,c=Jz(o,e),d=t.isDisabled(c)||t.isExcluded(c)?s:a;return"".concat(d," ").concat(aV(c,"MMMM yyyy",l))},t.getQuarterClassNames=function(e){var n=t.props,r=n.day,a=n.startDate,i=n.endDate,s=n.selected,o=n.minDate,l=n.maxDate,c=n.excludeDates,d=n.includeDates,u=n.filterDate,h=n.preSelection,p=n.disabledKeyboardNavigation,m=n.disabled,g=(o||l||c||d||u||m)&&EV(eH(r,e),t.props);return yd("react-datepicker__quarter-text","react-datepicker__quarter-".concat(e),{"react-datepicker__quarter-text--disabled":g,"react-datepicker__quarter-text--selected":s?t.isSelectedQuarter(r,e,s):void 0,"react-datepicker__quarter-text--keyboard-selected":!p&&h&&t.isSelectedQuarter(r,e,h)&&!g,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(e),"react-datepicker__quarter-text--in-range":a&&i?DV(a,i,e,r):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(e),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(e),"react-datepicker__quarter-text--today":t.isCurrentQuarter(r,e)})},t.getMonthContent=function(e){var n=t.props,r=n.showFullMonthYearPicker,a=n.renderMonthContent,i=n.locale,s=n.day,o=jV(e,i),l=SV(e,i);return a?a(e,o,l,s):r?l:o},t.getQuarterContent=function(e){var n,r=t.props,a=r.renderQuarterContent,i=function(e,t){return aV(eH(tV(),e),"QQQ",t)}(e,r.locale);return null!==(n=null==a?void 0:a(e,i))&&void 0!==n?n:i},t.renderMonths=function(){var e,n=t.props,r=n.showTwoColumnMonthYearPicker,a=n.showFourColumnMonthYearPicker,i=n.day,s=n.selected,o=null===(e=o$[l$(a,r)])||void 0===e?void 0:e.grid;return null==o?void 0:o.map(function(e,n){return v.createElement("div",{className:"react-datepicker__month-wrapper",key:n},e.map(function(e,n){return v.createElement("div",{ref:t.MONTH_REFS[e],key:n,onClick:function(n){t.onMonthClick(n,e)},onKeyDown:function(n){QV(n)&&(n.preventDefault(),n.key=qG.Enter),t.onMonthKeyDown(n,e)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(e)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(e)}:void 0,tabIndex:Number(t.getTabIndex(e)),className:t.getMonthClassNames(e),"aria-disabled":t.isMonthDisabled(e),role:"option","aria-label":t.getAriaLabel(e),"aria-current":t.isCurrentMonth(i,e)?"date":void 0,"aria-selected":s?t.isSelectedMonth(i,e,s):void 0},t.getMonthContent(e))}))})},t.renderQuarters=function(){var e=t.props,n=e.day,r=e.selected;return v.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map(function(e,a){return v.createElement("div",{key:a,ref:t.QUARTER_REFS[a],role:"option",onClick:function(n){t.onQuarterClick(n,e)},onKeyDown:function(n){t.onQuarterKeyDown(n,e)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(e)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(e)}:void 0,className:t.getQuarterClassNames(e),"aria-selected":r?t.isSelectedQuarter(n,e,r):void 0,tabIndex:Number(t.getQuarterTabIndex(e)),"aria-current":t.isCurrentQuarter(n,e)?"date":void 0},t.getQuarterContent(e))}))},t.getClassNames=function(){var e=t.props,n=e.selectingDate,r=e.selectsStart,a=e.selectsEnd;return yd("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(r||a)},{"react-datepicker__monthPicker":e.showMonthYearPicker},{"react-datepicker__quarterPicker":e.showQuarterYearPicker},{"react-datepicker__weekPicker":e.showWeekPicker})},t}return YG(t,e),t.prototype.getSelection=function(){var e=this.props,t=e.selected,n=e.selectedDates;return e.selectsMultiple?n:t?[t]:void 0},t.prototype.render=function(){var e=this.props,t=e.showMonthYearPicker,n=e.showQuarterYearPicker,r=e.day,a=e.ariaLabelPrefix,i=void 0===a?"Month ":a,s=i?i.trim()+" ":"";return t||n?v.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(s).concat(aV(r,"MMMM, yyyy",this.props.locale)),role:"listbox"},t?this.renderMonths():this.renderQuarters()):v.createElement("div",{role:"table"},this.props.dayNamesHeader&&v.createElement("div",{role:"rowgroup"},this.props.dayNamesHeader),v.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(s).concat(aV(r,"MMMM, yyyy",this.props.locale)),role:"rowgroup"},this.renderWeeks()))},t}(f.Component),d$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.monthOptionButtonsRef={},t.isSelectedMonth=function(e){return t.props.month===e},t.handleOptionKeyDown=function(e,n){var r;switch(n.key){case"Enter":n.preventDefault(),t.onChange(e);break;case"Escape":n.preventDefault(),t.props.onCancel();break;case"ArrowUp":case"ArrowDown":n.preventDefault();var a=(e+("ArrowUp"===n.key?-1:1)+t.props.monthNames.length)%t.props.monthNames.length;null===(r=t.monthOptionButtonsRef[a])||void 0===r||r.focus()}},t.renderOptions=function(){return t.monthOptionButtonsRef={},t.props.monthNames.map(function(e,n){return v.createElement("div",{ref:function(e){t.monthOptionButtonsRef[n]=e,t.isSelectedMonth(n)&&(null==e||e.focus())},role:"button",tabIndex:0,className:t.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:e,onClick:t.onChange.bind(t,n),onKeyDown:t.handleOptionKeyDown.bind(t,n),"aria-selected":t.isSelectedMonth(n)?"true":void 0},t.isSelectedMonth(n)?v.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",e)})},t.onChange=function(e){return t.props.onChange(e)},t.handleClickOutside=function(){return t.props.onCancel()},t}return YG(t,e),t.prototype.render=function(){return v.createElement(ZG,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},t}(f.Component),u$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(e){return e.map(function(e,t){return v.createElement("option",{key:e,value:t},e)})},t.renderSelectMode=function(e){return v.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(e){return t.onChange(parseInt(e.target.value))}},t.renderSelectOptions(e))},t.renderReadView=function(e,n){return v.createElement("button",{key:"read",type:"button",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},v.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),v.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[t.props.month]))},t.renderDropdown=function(e){return v.createElement(d$,XG({key:"dropdown"},t.props,{monthNames:e,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(e){var n=t.state.dropdownVisible,r=[t.renderReadView(!n,e)];return n&&r.unshift(t.renderDropdown(e)),r},t.onChange=function(e){t.toggleDropdown(),e!==t.props.month&&t.props.onChange(e)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return YG(t,e),t.prototype.render=function(){var e,t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return jV(e,t.props.locale)}:function(e){return SV(e,t.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(n);break;case"select":e=this.renderSelectMode(n)}return v.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(f.Component);function h$(e,t){for(var n=[],r=cV(e),a=cV(t);!GU(r,a);)n.push(tV(r)),r=NF(r,1);return n}var p$=function(e){function t(t){var n=e.call(this,t)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(e){var t=zU(e),r=gV(n.props.date,e)&&fV(n.props.date,e);return v.createElement("div",{className:r?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:t,onClick:n.onChange.bind(n,t),"aria-selected":r?"true":void 0},r?v.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",aV(e,n.props.dateFormat,n.props.locale))})},n.onChange=function(e){return n.props.onChange(e)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:h$(n.props.minDate,n.props.maxDate)},n}return YG(t,e),t.prototype.render=function(){var e=yd({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return v.createElement(ZG,{className:e,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(f.Component),m$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var e=cV(t.props.minDate),n=cV(t.props.maxDate),r=[];!GU(e,n);){var a=zU(e);r.push(v.createElement("option",{key:a,value:a},aV(e,t.props.dateFormat,t.props.locale))),e=NF(e,1)}return r},t.onSelectChange=function(e){t.onChange(parseInt(e.target.value))},t.renderSelectMode=function(){return v.createElement("select",{value:zU(cV(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(e){var n=aV(t.props.date,t.props.dateFormat,t.props.locale);return v.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},v.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),v.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))},t.renderDropdown=function(){return v.createElement(p$,XG({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var e=t.state.dropdownVisible,n=[t.renderReadView(!e)];return e&&n.unshift(t.renderDropdown()),n},t.onChange=function(e){t.toggleDropdown();var n=tV(e);gV(t.props.date,n)&&fV(t.props.date,n)||t.props.onChange(n)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return YG(t,e),t.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return v.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(f.Component),g$=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={height:null},n.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var e,r,a;n.list&&(n.list.scrollTop=null!==(a=n.centerLi&&t.calcCenterPosition(n.props.monthRef?n.props.monthRef.clientHeight-(null!==(r=null===(e=n.header)||void 0===e?void 0:e.clientHeight)&&void 0!==r?r:0):n.list.clientHeight,n.centerLi))&&void 0!==a?a:0)})},n.handleClick=function(e){var t,r;(n.props.minTime||n.props.maxTime)&&BV(e,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&OV(e,n.props)||null===(r=(t=n.props).onChange)||void 0===r||r.call(t,e)},n.isSelectedTime=function(e){return n.props.selected&&(t=n.props.selected,r=e,KV(t).getTime()===KV(r).getTime());var t,r},n.isDisabledTime=function(e){return(n.props.minTime||n.props.maxTime)&&BV(e,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&OV(e,n.props)},n.liClasses=function(e){var r,a=["react-datepicker__time-list-item",n.props.timeClassName?n.props.timeClassName(e):void 0];return n.isSelectedTime(e)&&a.push("react-datepicker__time-list-item--selected"),n.isDisabledTime(e)&&a.push("react-datepicker__time-list-item--disabled"),n.props.injectTimes&&(3600*BU(e)+60*LU(e)+UU(e))%(60*(null!==(r=n.props.intervals)&&void 0!==r?r:t.defaultProps.intervals))!=0&&a.push("react-datepicker__time-list-item--injected"),a.join(" ")},n.handleOnKeyDown=function(e,t){var r,a;e.key===qG.Space&&(e.preventDefault(),e.key=qG.Enter),(e.key===qG.ArrowUp||e.key===qG.ArrowLeft)&&e.target instanceof HTMLElement&&e.target.previousSibling&&(e.preventDefault(),e.target.previousSibling instanceof HTMLElement&&e.target.previousSibling.focus()),(e.key===qG.ArrowDown||e.key===qG.ArrowRight)&&e.target instanceof HTMLElement&&e.target.nextSibling&&(e.preventDefault(),e.target.nextSibling instanceof HTMLElement&&e.target.nextSibling.focus()),e.key===qG.Enter&&n.handleClick(t),null===(a=(r=n.props).handleOnKeyDown)||void 0===a||a.call(r,e)},n.renderTimes=function(){for(var e,r,a,i,s=[],o="string"==typeof n.props.format?n.props.format:"p",l=null!==(e=n.props.intervals)&&void 0!==e?e:t.defaultProps.intervals,c=n.props.selected||n.props.openToDate||tV(),d=oV(c),u=n.props.injectTimes&&n.props.injectTimes.sort(function(e,t){return e.getTime()-t.getTime()}),h=60*(r=c,a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=new Date(r.getFullYear(),r.getMonth(),r.getDate(),24),Math.round((+i-+a)/36e5))/l,p=0;p<h;p++){var m=RF(d,p*l);if(s.push(m),u){var g=WV(d,m,p,l,u);s=s.concat(g)}}var f=s.reduce(function(e,t){return t.getTime()<=c.getTime()?t:e},s[0]);return s.map(function(e){return v.createElement("li",{key:e.valueOf(),onClick:n.handleClick.bind(n,e),className:n.liClasses(e),ref:function(t){e===f&&(n.centerLi=t)},onKeyDown:function(t){n.handleOnKeyDown(t,e)},tabIndex:e===f?0:-1,role:"option","aria-selected":n.isSelectedTime(e)?"true":void 0,"aria-disabled":n.isDisabledTime(e)?"true":void 0},aV(e,o,n.props.locale))})},n.renderTimeCaption=function(){return!1===n.props.showTimeCaption?v.createElement(v.Fragment,null):v.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(n.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(e){n.header=e}},v.createElement("div",{className:"react-datepicker-time__header"},n.props.timeCaption))},n}return YG(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},t.prototype.componentWillUnmount=function(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect()},t.prototype.observeDatePickerHeightChanges=function(){var e=this,t=this.props.monthRef;this.updateContainerHeight(),t&&(this.resizeObserver=new ResizeObserver(function(){e.updateContainerHeight()}),this.resizeObserver.observe(t))},t.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},t.prototype.render=function(){var e,n=this,r=this.state.height;return v.createElement("div",{className:"react-datepicker__time-container ".concat((null!==(e=this.props.todayButton)&&void 0!==e?e:t.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),v.createElement("div",{className:"react-datepicker__time"},v.createElement("div",{className:"react-datepicker__time-box"},v.createElement("ul",{className:"react-datepicker__time-list",ref:function(e){n.list=e},style:r?{height:r}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},t.calcCenterPosition=function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)},t}(f.Component),f$=function(e){function t(t){var n=e.call(this,t)||this;return n.YEAR_REFS=KG([],Array(n.props.yearItemNumber),!0).map(function(){return f.createRef()}),n.isDisabled=function(e){return _V(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(e){return AV(e,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var e;return null!==(e=n.props.selectingDate)&&void 0!==e?e:n.props.preSelection},n.updateFocusOnPaginate=function(e){window.requestAnimationFrame(function(){var t,r;null===(r=null===(t=n.YEAR_REFS[e])||void 0===t?void 0:t.current)||void 0===r||r.focus()})},n.handleYearClick=function(e,t){n.props.onDayClick&&n.props.onDayClick(e,t)},n.handleYearNavigation=function(e,t){var r,a,i,s,o=n.props,l=o.date,c=o.yearItemNumber;if(void 0!==l&&void 0!==c){var d=XV(l,c).startPeriod;n.isDisabled(t)||n.isExcluded(t)||(null===(a=(r=n.props).setPreSelection)||void 0===a||a.call(r,t),e-d<0?n.updateFocusOnPaginate(c-(d-e)):e-d>=c?n.updateFocusOnPaginate(Math.abs(c-(e-d))):null===(s=null===(i=n.YEAR_REFS[e-d])||void 0===i?void 0:i.current)||void 0===s||s.focus())}},n.isSameDay=function(e,t){return yV(e,t)},n.isCurrentYear=function(e){return e===HU(tV())},n.isRangeStart=function(e){return n.props.startDate&&n.props.endDate&&gV(nH(tV(),e),n.props.startDate)},n.isRangeEnd=function(e){return n.props.startDate&&n.props.endDate&&gV(nH(tV(),e),n.props.endDate)},n.isInRange=function(e){return TV(e,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(e){var t=n.props,r=t.selectsStart,a=t.selectsEnd,i=t.selectsRange,s=t.startDate,o=t.endDate;return!(!(r||a||i)||!n.selectingDate())&&(r&&o?TV(e,n.selectingDate(),o):(a&&s||!(!i||!s||o))&&TV(e,s,n.selectingDate()))},n.isSelectingRangeStart=function(e){var t;if(!n.isInSelectingRange(e))return!1;var r=n.props,a=r.startDate,i=r.selectsStart,s=nH(tV(),e);return gV(s,i?null!==(t=n.selectingDate())&&void 0!==t?t:null:null!=a?a:null)},n.isSelectingRangeEnd=function(e){var t;if(!n.isInSelectingRange(e))return!1;var r=n.props,a=r.endDate,i=r.selectsEnd,s=r.selectsRange,o=nH(tV(),e);return gV(o,i||s?null!==(t=n.selectingDate())&&void 0!==t?t:null:null!=a?a:null)},n.isKeyboardSelected=function(e){if(!n.props.disabledKeyboardNavigation&&void 0!==n.props.date&&null!=n.props.preSelection){var t=n.props,r=t.minDate,a=t.maxDate,i=t.excludeDates,s=t.includeDates,o=t.filterDate,l=t.selected,c=dV(nH(n.props.date,e)),d=(r||a||i||s||o)&&PV(e,n.props),u=!!l&&yV(c,dV(l)),h=yV(c,dV(n.props.preSelection));return!n.props.inline&&!u&&h&&!d}},n.isSelectedYear=function(e){var t=n.props,r=t.selectsMultiple,a=t.selected,i=t.selectedDates;return r?null==i?void 0:i.some(function(t){return e===HU(t)}):!!a&&e===HU(a)},n.onYearClick=function(e,t){var r=n.props.date;void 0!==r&&n.handleYearClick(dV(nH(r,t)),e)},n.onYearKeyDown=function(e,t){var r,a,i=e.key,s=n.props,o=s.date,l=s.yearItemNumber,c=s.handleOnKeyDown;if(i!==qG.Tab&&e.preventDefault(),!n.props.disabledKeyboardNavigation)switch(i){case qG.Enter:if(null==n.props.selected)break;n.onYearClick(e,t),null===(a=(r=n.props).setPreSelection)||void 0===a||a.call(r,n.props.selected);break;case qG.ArrowRight:if(null==n.props.preSelection)break;n.handleYearNavigation(t+1,LF(n.props.preSelection,1));break;case qG.ArrowLeft:if(null==n.props.preSelection)break;n.handleYearNavigation(t-1,sH(n.props.preSelection,1));break;case qG.ArrowUp:if(void 0===o||void 0===l||null==n.props.preSelection)break;var d=XV(o,l).startPeriod;if((p=t-(h=3))<d){var u=l%h;t>=d&&t<d+u?h=u:h+=u,p=t-h}n.handleYearNavigation(p,sH(n.props.preSelection,h));break;case qG.ArrowDown:if(void 0===o||void 0===l||null==n.props.preSelection)break;var h,p,m=XV(o,l).endPeriod;if((p=t+(h=3))>m){u=l%h;t<=m&&t>m-u?h=u:h+=u,p=t+h}n.handleYearNavigation(p,LF(n.props.preSelection,h))}c&&c(e)},n.getYearClassNames=function(e){var t=n.props,r=t.date,a=t.disabled,i=t.minDate,s=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,d=t.yearClassName;return yd("react-datepicker__year-text","react-datepicker__year-".concat(e),r?null==d?void 0:d(nH(r,e)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(e),"react-datepicker__year-text--disabled":(i||s||o||l||c||a)&&PV(e,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(e),"react-datepicker__year-text--range-start":n.isRangeStart(e),"react-datepicker__year-text--range-end":n.isRangeEnd(e),"react-datepicker__year-text--in-range":n.isInRange(e),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(e),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(e),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(e),"react-datepicker__year-text--today":n.isCurrentYear(e)})},n.getYearTabIndex=function(e){if(n.props.disabledKeyboardNavigation||null==n.props.preSelection)return"-1";var t=HU(n.props.preSelection),r=PV(e,n.props);return e!==t||r?"-1":"0"},n.getYearContent=function(e){return n.props.renderYearContent?n.props.renderYearContent(e):e},n}return YG(t,e),t.prototype.render=function(){var e=this,t=[],n=this.props,r=n.date,a=n.yearItemNumber,i=n.onYearMouseEnter,s=n.onYearMouseLeave;if(void 0===r)return null;for(var o=XV(r,a),l=o.startPeriod,c=o.endPeriod,d=function(n){t.push(v.createElement("div",{ref:u.YEAR_REFS[n-l],onClick:function(t){e.onYearClick(t,n)},onKeyDown:function(t){QV(t)&&(t.preventDefault(),t.key=qG.Enter),e.onYearKeyDown(t,n)},tabIndex:Number(u.getYearTabIndex(n)),className:u.getYearClassNames(n),onMouseEnter:u.props.usePointerEvent?void 0:function(e){return i(e,n)},onPointerEnter:u.props.usePointerEvent?function(e){return i(e,n)}:void 0,onMouseLeave:u.props.usePointerEvent?void 0:function(e){return s(e,n)},onPointerLeave:u.props.usePointerEvent?function(e){return s(e,n)}:void 0,key:n,"aria-current":u.isCurrentYear(n)?"date":void 0},u.getYearContent(n)))},u=this,h=l;h<=c;h++)d(h);return v.createElement("div",{className:"react-datepicker__year"},v.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},t))},t}(f.Component);function x$(e,t,n,r){for(var a=[],i=0;i<2*t+1;i++){var s=e+t-i,o=!0;n&&(o=HU(n)<=s),r&&o&&(o=HU(r)>=s),o&&a.push(s)}return a}var y$=function(e){function t(t){var n=e.call(this,t)||this;n.yearOptionButtonsRef={},n.handleOptionKeyDown=function(e,t){var r;switch(t.key){case"Enter":t.preventDefault(),n.onChange(e);break;case"Escape":t.preventDefault(),n.props.onCancel();break;case"ArrowUp":case"ArrowDown":t.preventDefault();var a=e+("ArrowUp"===t.key?1:-1);n.yearOptionButtonsRef[a]&&(null===(r=n.yearOptionButtonsRef[a])||void 0===r||r.focus())}},n.renderOptions=function(){n.yearOptionButtonsRef={};var e=n.props.year,t=n.state.yearsList.map(function(t){return v.createElement("div",{ref:function(r){n.yearOptionButtonsRef[t]=r,t===e&&(null==r||r.focus())},role:"button",tabIndex:0,className:e===t?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:t,onClick:n.onChange.bind(n,t),onKeyDown:n.handleOptionKeyDown.bind(n,t),"aria-selected":e===t?"true":void 0},e===t?v.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",t)}),r=n.props.minDate?HU(n.props.minDate):null,a=n.props.maxDate?HU(n.props.maxDate):null;return a&&n.state.yearsList.find(function(e){return e===a})||t.unshift(v.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},v.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),r&&n.state.yearsList.find(function(e){return e===r})||t.push(v.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},v.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),t},n.onChange=function(e){n.props.onChange(e)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(e){var t=n.state.yearsList.map(function(t){return t+e});n.setState({yearsList:t})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var r=t.yearDropdownItemNumber,a=t.scrollableYearDropdown,i=r||(a?10:5);return n.state={yearsList:x$(n.props.year,i,n.props.minDate,n.props.maxDate)},n.dropdownRef=f.createRef(),n}return YG(t,e),t.prototype.componentDidMount=function(){var e=this.dropdownRef.current;if(e){var t=e.children?Array.from(e.children):null,n=t?t.find(function(e){return e.ariaSelected}):null;e.scrollTop=n&&n instanceof HTMLElement?n.offsetTop+(n.clientHeight-e.clientHeight)/2:(e.scrollHeight-e.clientHeight)/2}},t.prototype.render=function(){var e=yd({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return v.createElement(ZG,{className:e,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(f.Component),v$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var e=t.props.minDate?HU(t.props.minDate):1900,n=t.props.maxDate?HU(t.props.maxDate):2100,r=[],a=e;a<=n;a++)r.push(v.createElement("option",{key:a,value:a},a));return r},t.onSelectChange=function(e){t.onChange(parseInt(e.target.value))},t.renderSelectMode=function(){return v.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(e){return v.createElement("button",{key:"read",type:"button",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:t.toggleDropdown},v.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),v.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return v.createElement(y$,XG({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var e=t.state.dropdownVisible,n=[t.renderReadView(!e)];return e&&n.unshift(t.renderDropdown()),n},t.onChange=function(e){t.toggleDropdown(),e!==t.props.year&&t.props.onChange(e)},t.toggleDropdown=function(e){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,e)})},t.handleYearChange=function(e,n){var r;null===(r=t.onSelect)||void 0===r||r.call(t,e,n),t.setOpen()},t.onSelect=function(e,n){var r,a;null===(a=(r=t.props).onSelect)||void 0===a||a.call(r,e,n)},t.setOpen=function(){var e,n;null===(n=(e=t.props).setOpen)||void 0===n||n.call(e,!0)},t}return YG(t,e),t.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return v.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(f.Component),b$=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],w$="react-datepicker-ignore-onclickoutside",N$=function(e){function t(n){var r=e.call(this,n)||this;return r.monthContainer=void 0,r.handleClickOutside=function(e){r.props.onClickOutside(e)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(e){var t,n,a,i;a=e.target,i=(a.className||"").split(/\s+/),b$.some(function(e){return i.indexOf(e)>=0})&&(null===(n=(t=r.props).onDropdownFocus)||void 0===n||n.call(t,e))},r.getDateInView=function(){var e=r.props,t=e.preSelection,n=e.selected,a=e.openToDate,i=HV(r.props),s=GV(r.props),o=tV(),l=a||n||t;return l||(i&&VU(o,i)?i:s&&GU(o,s)?s:o)},r.increaseMonth=function(){r.setState(function(e){return{date:NF(e.date,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(e){return{date:rH(e.date,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(e,t,n){r.props.onSelect(e,t,n),r.props.setPreSelection&&r.props.setPreSelection(e)},r.handleDayMouseEnter=function(e){r.setState({selectingDate:e}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(e)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(e,t){r.setState({selectingDate:nH(tV(),t)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(e,t)},r.handleYearMouseLeave=function(e,t){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(e,t)},r.handleYearChange=function(e){var t,n,a,i;null===(n=(t=r.props).onYearChange)||void 0===n||n.call(t,e),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(e),null===(i=(a=r.props).setOpen)||void 0===i||i.call(a,!0)),r.props.setPreSelection&&r.props.setPreSelection(e)},r.getEnabledPreSelectionDateForMonth=function(e){if(!_V(e,r.props))return e;for(var t=cV(e),n=function(e){return KF(e)}(e),a=function(e,t,n){const[r,a]=TF(null==n||n.in,e,t),i=YF(r,a),s=Math.abs(DF(r,a));r.setDate(r.getDate()-i*s);const o=i*(s-Number(YF(r,a)===-i));return 0===o?0:o}(n,t),i=null,s=0;s<=a;s++){var o=wF(t,s);if(!_V(o,r.props)){i=o;break}}return i},r.handleMonthChange=function(e){var t,n,a,i=null!==(t=r.getEnabledPreSelectionDateForMonth(e))&&void 0!==t?t:e;r.handleCustomMonthChange(i),r.props.adjustDateOnChange&&(r.props.onSelect(i),null===(a=(n=r.props).setOpen)||void 0===a||a.call(n,!0)),r.props.setPreSelection&&r.props.setPreSelection(i)},r.handleCustomMonthChange=function(e){var t,n;null===(n=(t=r.props).onMonthChange)||void 0===n||n.call(t,e),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(e){r.handleYearChange(e),r.handleMonthChange(e)},r.changeYear=function(e){r.setState(function(t){return{date:nH(t.date,Number(e))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(e){r.setState(function(t){return{date:Jz(t.date,Number(e))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(e){r.setState(function(t){return{date:nH(Jz(t.date,FU(e)),HU(e))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(e){void 0===e&&(e=r.state.date);var t=r.props.disabled,n=lV(e,r.props.locale,r.props.calendarStartDay),a=[];return r.props.showWeekNumbers&&a.push(v.createElement("div",{key:"W",className:"react-datepicker__day-name ".concat(t?"react-datepicker__day-name--disabled":""),role:"columnheader"},v.createElement("span",{className:"react-datepicker__sr-only"},"Week number"),v.createElement("span",{"aria-hidden":"true"},r.props.weekLabel||"#"))),a.concat([0,1,2,3,4,5,6].map(function(e){var a=wF(n,e),i=r.formatWeekday(a,r.props.locale),s=r.props.weekDayClassName?r.props.weekDayClassName(a):void 0;return v.createElement("div",{key:e,role:"columnheader",className:yd("react-datepicker__day-name",s,t?"react-datepicker__day-name--disabled":"")},v.createElement("span",{className:"react-datepicker__sr-only"},aV(a,"EEEE",r.props.locale)),v.createElement("span",{"aria-hidden":"true"},i))}))},r.formatWeekday=function(e,t){return r.props.formatWeekDay?function(e,t,n){return t(aV(e,"EEEE",n))}(e,r.props.formatWeekDay,t):r.props.useWeekdaysShort?function(e,t){return aV(e,"EEE",t)}(e,t):function(e,t){return aV(e,"EEEEEE",t)}(e,t)},r.decreaseYear=function(){r.setState(function(e){var n;return{date:sH(e.date,r.props.showYearPicker?null!==(n=r.props.yearItemNumber)&&void 0!==n?n:t.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var e,n,a;if(!r.props.renderCustomHeader){var i,s=null!==(e=r.props.monthsShown)&&void 0!==e?e:t.defaultProps.monthsShown,o=r.props.showPreviousMonths?s-1:0,l=null!==(n=r.props.monthSelectedIn)&&void 0!==n?n:o,c=rH(r.state.date,l);switch(!0){case r.props.disabled:i=!0;break;case r.props.showMonthYearPicker:i=UV(r.state.date,r.props);break;case r.props.showYearPicker:i=function(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.yearItemNumber,i=void 0===a?12:a,s=XV(dV(sH(e,i)),i).endPeriod,o=r&&HU(r);return o&&o>s||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:i=function(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,i=aH(ZF(e));return r&&$F(r,i)>0||a&&a.every(function(e){return $F(e,i)>0})||!1}(r.state.date,r.props);break;default:i=LV(c,r.props)}if(((null!==(a=r.props.forceShowMonthNavigation)&&void 0!==a?a:t.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!i)&&!r.props.showTimeSelectOnly){var d=["react-datepicker__navigation","react-datepicker__navigation--previous"],u=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(u=r.decreaseYear),i&&r.props.showDisabledMonthNavigation&&(d.push("react-datepicker__navigation--previous--disabled"),u=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.previousMonthButtonLabel,g=void 0===m?t.defaultProps.previousMonthButtonLabel:m,f=p.previousYearButtonLabel,x=void 0===f?t.defaultProps.previousYearButtonLabel:f,y=r.props,b=y.previousMonthAriaLabel,w=void 0===b?"string"==typeof g?g:"Previous Month":b,N=y.previousYearAriaLabel,S=void 0===N?"string"==typeof x?x:"Previous Year":N;return v.createElement("button",{type:"button",className:d.join(" "),onClick:u,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?S:w},v.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},h?x:g))}}},r.increaseYear=function(){r.setState(function(e){var n;return{date:LF(e.date,r.props.showYearPicker?null!==(n=r.props.yearItemNumber)&&void 0!==n?n:t.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var e;if(!r.props.renderCustomHeader){var n;switch(!0){case r.props.disabled:n=!0;break;case r.props.showMonthYearPicker:n=zV(r.state.date,r.props);break;case r.props.showYearPicker:n=function(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.yearItemNumber,i=void 0===a?12:a,s=XV(LF(e,i),i).startPeriod,o=r&&HU(r);return o&&o<s||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:n=function(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,i=IF(QF(e),1);return r&&$F(i,r)>0||a&&a.every(function(e){return $F(i,e)>0})||!1}(r.state.date,r.props);break;default:n=FV(r.state.date,r.props)}if(((null!==(e=r.props.forceShowMonthNavigation)&&void 0!==e?e:t.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!n)&&!r.props.showTimeSelectOnly){var a=["react-datepicker__navigation","react-datepicker__navigation--next"];r.props.showTimeSelect&&a.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&a.push("react-datepicker__navigation--next--with-today-button");var i=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(i=r.increaseYear),n&&r.props.showDisabledMonthNavigation&&(a.push("react-datepicker__navigation--next--disabled"),i=void 0);var s=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,o=r.props,l=o.nextMonthButtonLabel,c=void 0===l?t.defaultProps.nextMonthButtonLabel:l,d=o.nextYearButtonLabel,u=void 0===d?t.defaultProps.nextYearButtonLabel:d,h=r.props,p=h.nextMonthAriaLabel,m=void 0===p?"string"==typeof c?c:"Next Month":p,g=h.nextYearAriaLabel,f=void 0===g?"string"==typeof u?u:"Next Year":g;return v.createElement("button",{type:"button",className:a.join(" "),onClick:i,onKeyDown:r.props.handleOnKeyDown,"aria-label":s?f:m},v.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},s?u:c))}}},r.renderCurrentMonth=function(e){void 0===e&&(e=r.state.date);var t=["react-datepicker__current-month"];return r.props.showYearDropdown&&t.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&t.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&t.push("react-datepicker__current-month--hasMonthYearDropdown"),v.createElement("h2",{className:t.join(" ")},aV(e,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(e){if(void 0===e&&(e=!1),r.props.showYearDropdown&&!e)return v.createElement(v$,XG({},t.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:HU(r.state.date)}))},r.renderMonthDropdown=function(e){if(void 0===e&&(e=!1),r.props.showMonthDropdown&&!e)return v.createElement(u$,XG({},t.defaultProps,r.props,{month:FU(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(e){if(void 0===e&&(e=!1),r.props.showMonthYearDropdown&&!e)return v.createElement(m$,XG({},t.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(e){r.props.onSelect(hV(),e),r.props.setPreSelection&&r.props.setPreSelection(hV())},r.renderTodayButton=function(){if(r.props.todayButton&&!r.props.showTimeSelectOnly)return v.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDayNamesHeader=function(e){return v.createElement("div",{className:"react-datepicker__day-names",role:"row"},r.header(e))},r.renderDefaultHeader=function(e){var t=e.monthDate,n=e.i;return v.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(t),v.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(0!==n),r.renderMonthYearDropdown(0!==n),r.renderYearDropdown(0!==n)))},r.renderCustomHeader=function(e){var t,n,a=e.monthDate,i=e.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var s,o=r.props,l=o.showYearPicker,c=o.yearItemNumber;if(l){var d=XV(a,c);s={startYear:d.startPeriod,endYear:d.endPeriod}}var u=LV(r.state.date,r.props),h=FV(r.state.date,r.props),p=UV(r.state.date,r.props),m=zV(r.state.date,r.props);return v.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},null===(n=(t=r.props).renderCustomHeader)||void 0===n?void 0:n.call(t,XG(XG(XG({},r.state),l&&{visibleYearsRange:s}),{customHeaderCount:i,monthDate:a,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:u,nextMonthButtonDisabled:h,prevYearButtonDisabled:p,nextYearButtonDisabled:m})))},r.renderYearHeader=function(e){var n=e.monthDate,a=r.props,i=a.showYearPicker,s=a.yearItemNumber,o=XV(n,void 0===s?t.defaultProps.yearItemNumber:s),l=o.startPeriod,c=o.endPeriod;return v.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},i?"".concat(l," - ").concat(c):HU(n))},r.renderHeader=function(e){var t=e.monthDate,n=e.i,a={monthDate:t,i:void 0===n?0:n};switch(!0){case void 0!==r.props.renderCustomHeader:return r.renderCustomHeader(a);case r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker:return r.renderYearHeader(a);default:return r.renderDefaultHeader(a)}},r.renderMonths=function(){var e,n;if(!r.props.showTimeSelectOnly&&!r.props.showYearPicker){for(var a=[],i=null!==(e=r.props.monthsShown)&&void 0!==e?e:t.defaultProps.monthsShown,s=r.props.showPreviousMonths?i-1:0,o=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?LF(r.state.date,s):rH(r.state.date,s),l=null!==(n=r.props.monthSelectedIn)&&void 0!==n?n:s,c=0;c<i;++c){var d=c-l+s,u=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?LF(o,d):NF(o,d),h="month-".concat(c),p=c<i-1,m=c>0;a.push(v.createElement("div",{key:h,ref:function(e){r.monthContainer=null!=e?e:void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:u,i:c}),v.createElement(c$,XG({},t.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:u,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:c,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:p,monthShowsDuplicateDaysStart:m,dayNamesHeader:r.renderDayNamesHeader(u)}))))}return a}},r.renderYears=function(){if(!r.props.showTimeSelectOnly)return r.props.showYearPicker?v.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),v.createElement(f$,XG({},t.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave}))):void 0},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return v.createElement(g$,XG({},t.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var e=r.props.selected?new Date(r.props.selected):void 0,n=e&&rV(e)&&Boolean(r.props.selected)?"".concat(YV(e.getHours()),":").concat(YV(e.getMinutes())):"";if(r.props.showTimeInput)return v.createElement(e$,XG({},t.defaultProps,r.props,{date:e,timeString:n,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var e,n,a=XV(r.state.date,null!==(e=r.props.yearItemNumber)&&void 0!==e?e:t.defaultProps.yearItemNumber),i=a.startPeriod,s=a.endPeriod;return n=r.props.showYearPicker?"".concat(i," - ").concat(s):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?HU(r.state.date):"".concat(SV(FU(r.state.date),r.props.locale)," ").concat(HU(r.state.date)),v.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&n)},r.renderChildren=function(){if(r.props.children)return v.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=f.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return YG(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,outsideClickIgnoreClass:w$,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:12}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){var e=this;this.props.showTimeSelect&&(this.assignMonthContainer=void e.setState({monthContainer:e.monthContainer}))},t.prototype.componentDidUpdate=function(e){var t=this;if(!this.props.preSelection||yV(this.props.preSelection,e.preSelection)&&this.props.monthSelectedIn===e.monthSelectedIn)this.props.openToDate&&!yV(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!fV(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return n&&t.handleCustomMonthChange(t.state.date)})}},t.prototype.render=function(){var e=this.props.container||QG;return v.createElement(ZG,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},v.createElement("div",{style:{display:"contents"},ref:this.containerRef},v.createElement(e,{className:yd("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},t}(f.Component),S$=function(e){var t=e.icon,n=e.className,r=void 0===n?"":n,a=e.onClick,i="react-datepicker__calendar-icon";if("string"==typeof t)return v.createElement("i",{className:"".concat(i," ").concat(t," ").concat(r),"aria-hidden":"true",onClick:a});if(v.isValidElement(t)){var s=t;return v.cloneElement(s,{className:"".concat(s.props.className||""," ").concat(i," ").concat(r),onClick:function(e){"function"==typeof s.props.onClick&&s.props.onClick(e),"function"==typeof a&&a(e)}})}return v.createElement("svg",{className:"".concat(i," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},v.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},j$=function(e){function t(t){var n=e.call(this,t)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return YG(t,e),t.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},t.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},t.prototype.render=function(){return N.createPortal(this.props.children,this.el)},t}(f.Component),_$=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&-1!==e.tabIndex},A$=function(e){function t(t){var n=e.call(this,t)||this;return n.getTabChildren=function(){var e;return Array.prototype.slice.call(null===(e=n.tabLoopRef.current)||void 0===e?void 0:e.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(_$)},n.handleFocusStart=function(){var e=n.getTabChildren();e&&e.length>1&&e[e.length-1].focus()},n.handleFocusEnd=function(){var e=n.getTabChildren();e&&e.length>1&&e[0].focus()},n.tabLoopRef=f.createRef(),n}return YG(t,e),t.prototype.render=function(){var e;return(null!==(e=this.props.enableTabLoop)&&void 0!==e?e:t.defaultProps.enableTabLoop)?v.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},v.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,v.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},t.defaultProps={enableTabLoop:!0},t}(f.Component);var C$=function(e){function t(t){var n,r,a,i="boolean"!=typeof t.hidePopper||t.hidePopper,s=f.useRef(null),o=$G(XG({open:!i,whileElementsMounted:jG,placement:t.popperPlacement,middleware:KG([(r={padding:15},c(l({},AG(r)),{options:[r,a]})),RG(10),IG({element:s})],null!==(n=t.popperModifiers)&&void 0!==n?n:[],!0)},t.popperProps)),d=XG(XG({},t),{hidePopper:i,popperProps:XG(XG({},o),{arrowRef:s})});return v.createElement(e,XG({},d))}return t.displayName="withFloating(".concat(e.displayName||e.name||"Component",")"),t}(function(e){var t=e.className,n=e.wrapperClassName,r=e.hidePopper,a=void 0===r||r,i=e.popperComponent,s=e.targetComponent,o=e.enableTabLoop,l=e.popperOnKeyDown,c=e.portalId,d=e.portalHost,u=e.popperProps,h=e.showArrow,p=void 0;if(!a){var m=yd("react-datepicker-popper",t);p=v.createElement(A$,{enableTabLoop:o},v.createElement("div",{ref:u.refs.setFloating,style:u.floatingStyles,className:m,"data-placement":u.placement,onKeyDown:l},i,h&&v.createElement(zG,{ref:u.arrowRef,context:u.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}e.popperContainer&&(p=f.createElement(e.popperContainer,{},p)),c&&!a&&(p=v.createElement(j$,{portalId:c,portalHost:d},p));var g=yd("react-datepicker-wrapper",n);return v.createElement(v.Fragment,null,v.createElement("div",{ref:u.refs.setReference,className:g},s),p)});var M$="Date input not valid.",k$=function(e){function t(n){var r=e.call(this,n)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:tV()},r.modifyHolidays=function(){var e;return null===(e=r.props.holidays)||void 0===e?void 0:e.reduce(function(e,t){var n=new Date(t.date);return rV(n)?KG(KG([],e,!0),[XG(XG({},t),{date:n})],!1):e},[])},r.calcInitialState=function(){var e,t=r.getPreSelection(),n=HV(r.props),a=GV(r.props),i=n&&VU(t,oV(n))?n:a&&GU(t,pV(a))?a:t;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:null!==(e=r.props.selectsRange?r.props.startDate:r.props.selected)&&void 0!==e?e:i,highlightDates:VV(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.getInputValue=function(){var e,n=r.props,a=n.locale,i=n.startDate,s=n.endDate,o=n.rangeSeparator,l=n.selected,c=n.selectedDates,d=n.selectsMultiple,u=n.selectsRange,h=n.value,p=null!==(e=r.props.dateFormat)&&void 0!==e?e:t.defaultProps.dateFormat,m=r.state.inputValue;return"string"==typeof h?h:"string"==typeof m?m:u?function(e,t,n){if(!e&&!t)return"";var r=e?iV(e,n):"",a=t?iV(t,n):"",i=n.rangeSeparator||" - ";return"".concat(r).concat(i).concat(a)}(i,s,{dateFormat:p,locale:a,rangeSeparator:o}):d?function(e,t){if(!(null==e?void 0:e.length))return"";var n=e[0]?iV(e[0],t):"";if(1===e.length)return n;if(2===e.length&&e[1]){var r=iV(e[1],t);return"".concat(n,", ").concat(r)}var a=e.length-1;return"".concat(n," (+").concat(a,")")}(null!=c?c:[],{dateFormat:p,locale:a}):iV(l,{dateFormat:p,locale:a})},r.resetHiddenStatus=function(){r.setState(XG(XG({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(XG(XG({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){"hidden"===document.visibilityState&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var e,t;null===(t=null===(e=r.input)||void 0===e?void 0:e.focus)||void 0===t||t.call(e,{preventScroll:!0})},r.setBlur=function(){var e,t;null===(t=null===(e=r.input)||void 0===e?void 0:e.blur)||void 0===t||t.call(e),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(e,t){void 0===t&&(t=!1),r.setState({open:e,preSelection:e&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:T$},function(){e||r.setState(function(e){return{focused:!!t&&e.focused}},function(){!t&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return zF(r.state.preSelection)},r.isCalendarOpen=function(){return void 0===r.props.open?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(e){var t,n,a=r.state.wasHidden,i=!a||r.state.open;a&&r.resetHiddenStatus(),r.state.preventFocus||(null===(n=(t=r.props).onFocus)||void 0===n||n.call(t,e),!i||r.props.preventOpenOnFocus||r.props.readOnly||r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.resetInputValue=function(){r.setState(XG(XG({},r.state),{inputValue:null}))},r.handleBlur=function(e){var t,n;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&(null===(n=(t=r.props).onBlur)||void 0===n||n.call(t,e)),r.resetInputValue(),r.state.open&&!1===r.props.open&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(e){var t,n;r.props.inline||r.setOpen(!1),null===(n=(t=r.props).onClickOutside)||void 0===n||n.call(t,e),r.props.withPortal&&e.preventDefault()},r.handleChange=function(){for(var e,n,a,i,s,o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var c=o[0];if(!r.props.onChangeRaw||(r.props.onChangeRaw.apply(r,o),c&&"function"==typeof c.isDefaultPrevented&&!c.isDefaultPrevented())){r.setState({inputValue:(null==c?void 0:c.target)instanceof HTMLInputElement?c.target.value:null,lastPreSelectChange:E$});var d=r.props,u=d.selectsRange,h=d.startDate,p=d.endDate,m=null!==(e=r.props.dateFormat)&&void 0!==e?e:t.defaultProps.dateFormat,g=null!==(n=r.props.strictParsing)&&void 0!==n?n:t.defaultProps.strictParsing,f=(null==c?void 0:c.target)instanceof HTMLInputElement?c.target.value:"";if(u){var x=r.props.rangeSeparator,y=x.trim(),v=f.split(m.includes(y)?x:y,2).map(function(e){return e.trim()}),b=v[0],w=v[1],N=nV(null!=b?b:"",m,r.props.locale,g),S=N?nV(null!=w?w:"",m,r.props.locale,g):null,j=(null==h?void 0:h.getTime())!==(null==N?void 0:N.getTime()),_=(null==p?void 0:p.getTime())!==(null==S?void 0:S.getTime());if(!j&&!_)return;if(N&&_V(N,r.props))return;if(S&&_V(S,r.props))return;null===(i=(a=r.props).onChange)||void 0===i||i.call(a,[N,S],c)}else{var A=nV(f,m,r.props.locale,g,null!==(s=r.props.selected)&&void 0!==s?s:void 0);!A&&f||r.setSelected(A,c,!0)}}},r.handleSelect=function(e,n,a){var i;if(!r.props.readOnly){var s=r.props,o=s.selectsRange,l=s.startDate,c=s.endDate,d=s.locale,u=s.swapRange,h=null!==(i=r.props.dateFormat)&&void 0!==i?i:t.defaultProps.dateFormat,p=!o||l&&!c&&(u||!JV(e,l));if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&p&&r.sendFocusBackToInput(),r.props.onChangeRaw){var m=iV(e,{dateFormat:h,locale:d});r.props.onChangeRaw(n,{date:e,formattedDate:m})}r.setSelected(e,n,!1,a),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect?r.setPreSelection(e):p&&r.setOpen(!1)}},r.setSelected=function(e,t,n,a){var i,s,o=e;if(r.props.showYearPicker){if(null!==o&&PV(HU(o),r.props))return}else if(r.props.showMonthYearPicker){if(null!==o&&CV(o,r.props))return}else if(null!==o&&_V(o,r.props))return;var l=r.props,c=l.onChange,d=l.selectsRange,u=l.startDate,h=l.endDate,p=l.selectsMultiple,m=l.selectedDates,g=l.minTime,f=l.swapRange;if(!vV(r.props.selected,o)||r.props.allowSameDay||d||p)if(null!==o&&(!r.props.selected||n&&(r.props.showTimeSelect||r.props.showTimeSelectOnly||r.props.showTimeInput)||(o=sV(o,{hour:BU(r.props.selected),minute:LU(r.props.selected),second:UU(r.props.selected)})),n||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly||g&&(o=sV(o,{hour:g.getHours(),minute:g.getMinutes(),second:g.getSeconds()})),r.props.inline||r.setState({preSelection:o}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:a})),d){var x=u&&!h,y=!u&&!!h,v=u&&h;!u&&!h?null==c||c([o,null],t):x?null===o?null==c||c([null,null],t):JV(o,u)?f?null==c||c([o,u],t):null==c||c([o,null],t):null==c||c([u,o],t):y&&(o&&JV(o,h)?null==c||c([o,h],t):null==c||c([o,null],t)),v&&(null==c||c([o,null],t))}else if(p){if(null!==o)if(null==m?void 0:m.length)if(m.some(function(e){return yV(e,o)})){var b=m.filter(function(e){return!yV(e,o)});null==c||c(b,t)}else null==c||c(KG(KG([],m,!0),[o],!1),t);else null==c||c([o],t)}else null==c||c(o,t);n||(null===(s=(i=r.props).onSelect)||void 0===s||s.call(i,o,t),r.setState({inputValue:null}))},r.setPreSelection=function(e){if(!r.props.readOnly){var t=zF(r.props.minDate),n=zF(r.props.maxDate),a=!0;if(e){var i=oV(e);if(t&&n)a=bV(e,r.props.minDate,r.props.maxDate);else if(t){var s=oV(r.props.minDate);a=GU(e,s)||vV(i,s)}else if(n){var o=pV(r.props.maxDate);a=VU(e,o)||vV(i,o)}}a&&r.setState({preSelection:e})}},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(e){var t,n;if(!r.props.selectsRange&&!r.props.selectsMultiple){var a=r.props.selected?r.props.selected:r.getPreSelection(),i=r.props.selected?e:sV(a,{hour:BU(e),minute:LU(e)});r.setState({preSelection:i}),null===(n=(t=r.props).onChange)||void 0===n||n.call(t,i),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var e,t;r.props.disabled||r.props.readOnly||r.setOpen(!0),null===(t=(e=r.props).onInputClick)||void 0===t||t.call(e)},r.onInputKeyDown=function(e){var t,n,a,i,s,o;null===(n=(t=r.props).onKeyDown)||void 0===n||n.call(t,e);var l=e.key;if(r.state.open||r.props.inline||r.props.preventOpenOnFocus){if(r.state.open){if(l===qG.ArrowDown||l===qG.ArrowUp){e.preventDefault();var c=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',d=(null===(i=r.calendar)||void 0===i?void 0:i.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(c);return void(d instanceof HTMLElement&&d.focus({preventScroll:!0}))}var u=tV(r.state.preSelection);l===qG.Enter?(e.preventDefault(),e.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===T$?(r.handleSelect(u,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(u)):r.setOpen(!1)):l===qG.Escape?(e.preventDefault(),e.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):l===qG.Tab&&r.setOpen(!1),r.inputOk()||null===(o=(s=r.props).onInputError)||void 0===o||o.call(s,{code:1,msg:M$})}}else l!==qG.ArrowDown&&l!==qG.ArrowUp&&l!==qG.Enter||null===(a=r.onInputClick)||void 0===a||a.call(r)},r.onPortalKeyDown=function(e){e.key===qG.Escape&&(e.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(e){var t,n,a,i,s,o,l=r.props,c=l.minDate,d=l.maxDate,u=l.disabledKeyboardNavigation,h=l.showWeekPicker,p=l.shouldCloseOnSelect,m=l.locale,g=l.calendarStartDay,f=l.adjustDateOnChange,x=l.inline;if(null===(n=(t=r.props).onKeyDown)||void 0===n||n.call(t,e),!u){var y=e.key,v=e.shiftKey,b=tV(r.state.preSelection),w=function(e,t){var n=t;switch(e){case qG.ArrowRight:n=h?BF(t,1):wF(t,1);break;case qG.ArrowLeft:n=h?iH(t):function(e,t,n){return wF(e,-1,n)}(t);break;case qG.ArrowUp:n=iH(t);break;case qG.ArrowDown:n=BF(t,1);break;case qG.PageUp:n=v?sH(t,1):rH(t,1);break;case qG.PageDown:n=v?LF(t,1):NF(t,1);break;case qG.Home:n=lV(t,m,g);break;case qG.End:n=mV(t)}return n};if(y===qG.Enter)return e.preventDefault(),r.handleSelect(b,e),void(!p&&r.setPreSelection(b));if(y===qG.Escape)return e.preventDefault(),r.setOpen(!1),void(r.inputOk()||null===(i=(a=r.props).onInputError)||void 0===i||i.call(a,{code:1,msg:M$}));var N=null;switch(y){case qG.ArrowLeft:case qG.ArrowRight:case qG.ArrowUp:case qG.ArrowDown:case qG.PageUp:case qG.PageDown:case qG.Home:case qG.End:N=function(e,t){for(var n=e,a=!1,i=0,s=w(e,t);!a;){if(i>=40){s=t;break}c&&s<c&&(n=qG.ArrowRight,s=_V(c,r.props)?w(n,s):c),d&&s>d&&(n=qG.ArrowLeft,s=_V(d,r.props)?w(n,s):d),_V(s,r.props)?(n!==qG.PageUp&&n!==qG.Home||(n=qG.ArrowRight),n!==qG.PageDown&&n!==qG.End||(n=qG.ArrowLeft),s=w(n,s)):a=!0,i++}return s}(y,b)}if(N){if(e.preventDefault(),r.setState({lastPreSelectChange:T$}),f&&r.setSelected(N),r.setPreSelection(N),x){var S=FU(b),j=FU(N),_=HU(b),A=HU(N);S!==j||_!==A?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}else null===(o=(s=r.props).onInputError)||void 0===o||o.call(s,{code:1,msg:M$})}},r.onPopperKeyDown=function(e){e.key===qG.Escape&&(e.preventDefault(),r.sendFocusBackToInput(),r.setOpen(!1))},r.onClearClick=function(e){e&&e.preventDefault&&e.preventDefault(),r.sendFocusBackToInput();var t=r.props,n=t.selectsRange,a=t.onChange;n?null==a||a([null,null],e):null==a||a(null,e),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(e){"boolean"==typeof r.props.closeOnScroll&&r.props.closeOnScroll?e.target!==document&&e.target!==document.documentElement&&e.target!==document.body||r.setOpen(!1):"function"==typeof r.props.closeOnScroll&&r.props.closeOnScroll(e)&&r.setOpen(!1)},r.renderCalendar=function(){var e,n;return r.props.inline||r.isCalendarOpen()?v.createElement(N$,XG({showMonthYearDropdown:void 0,ref:function(e){r.calendar=e}},r.props,r.state,{setOpen:r.setOpen,dateFormat:null!==(e=r.props.dateFormatCalendar)&&void 0!==e?e:t.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:$V(r.modifyHolidays()),outsideClickIgnoreClass:r.props.outsideClickIgnoreClass,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:null!==(n=r.props.dropdownMode)&&void 0!==n?n:t.defaultProps.dropdownMode}),r.props.children):null},r.renderAriaLiveRegion=function(){var e,n,a=r.props.locale,i=null!==(e=r.props.dateFormat)&&void 0!==e?e:t.defaultProps.dateFormat,s=r.props.showTimeInput||r.props.showTimeSelect?"PPPPp":"PPPP";return n=r.props.selectsRange?"Selected start date: ".concat(iV(r.props.startDate,{dateFormat:s,locale:a}),". ").concat(r.props.endDate?"End date: "+iV(r.props.endDate,{dateFormat:s,locale:a}):""):r.props.showTimeSelectOnly?"Selected time: ".concat(iV(r.props.selected,{dateFormat:i,locale:a})):r.props.showYearPicker?"Selected year: ".concat(iV(r.props.selected,{dateFormat:"yyyy",locale:a})):r.props.showMonthYearPicker?"Selected month: ".concat(iV(r.props.selected,{dateFormat:"MMMM yyyy",locale:a})):r.props.showQuarterYearPicker?"Selected quarter: ".concat(iV(r.props.selected,{dateFormat:"yyyy, QQQ",locale:a})):"Selected date: ".concat(iV(r.props.selected,{dateFormat:s,locale:a})),v.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n)},r.renderDateInput=function(){var e,n,a=yd(r.props.className,((e={})[r.props.outsideClickIgnoreClass||t.defaultProps.outsideClickIgnoreClass]=r.state.open,e)),i=r.props.customInput||v.createElement("input",{type:"text"}),s=r.props.customInputRef||"ref";return f.cloneElement(i,((n={})[s]=function(e){r.input=e},n.value=r.getInputValue(),n.onBlur=r.handleBlur,n.onChange=r.handleChange,n.onClick=r.onInputClick,n.onFocus=r.handleFocus,n.onKeyDown=r.onInputKeyDown,n.id=r.props.id,n.name=r.props.name,n.form=r.props.form,n.autoFocus=r.props.autoFocus,n.placeholder=r.props.placeholderText,n.disabled=r.props.disabled,n.autoComplete=r.props.autoComplete,n.className=yd(i.props.className,a),n.title=r.props.title,n.readOnly=r.props.readOnly,n.required=r.props.required,n.tabIndex=r.props.tabIndex,n["aria-describedby"]=r.props.ariaDescribedBy,n["aria-invalid"]=r.props.ariaInvalid,n["aria-labelledby"]=r.props.ariaLabelledBy,n["aria-required"]=r.props.ariaRequired,n))},r.renderClearButton=function(){var e=r.props,t=e.isClearable,n=e.disabled,a=e.selected,i=e.startDate,s=e.endDate,o=e.clearButtonTitle,l=e.clearButtonClassName,c=void 0===l?"":l,d=e.ariaLabelClose,u=void 0===d?"Close":d,h=e.selectedDates,p=e.readOnly;return!t||p||null==a&&null==i&&null==s&&!(null==h?void 0:h.length)?null:v.createElement("button",{type:"button",className:yd("react-datepicker__close-icon",c,{"react-datepicker__close-icon--disabled":n}),disabled:n,"aria-label":u,onClick:r.onClearClick,title:o,tabIndex:-1})},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return YG(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,outsideClickIgnoreClass:w$,readOnly:!1,rangeSeparator:" - ",withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:12,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.componentDidUpdate=function(e,t){var n,r,a,i,s,o;e.inline&&(s=e.selected,o=this.props.selected,s&&o?FU(s)!==FU(o)||HU(s)!==HU(o):s!==o)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:VV(this.props.highlightDates)}),t.focused||vV(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&(null===(r=(n=this.props).onCalendarOpen)||void 0===r||r.call(n)),!0===t.open&&!1===this.state.open&&(null===(i=(a=this.props).onCalendarClose)||void 0===i||i.call(a)))},t.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.renderInputContainer=function(){var e=this.props,t=e.showIcon,n=e.icon,r=e.calendarIconClassname,a=e.calendarIconClassName,i=e.toggleCalendarOnIconClick,s=this.state.open;return r&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),v.createElement("div",{className:"react-datepicker__input-container".concat(t?" react-datepicker__view-calendar-icon":"")},t&&v.createElement(S$,XG({icon:n,className:yd(a,!a&&r,s&&"react-datepicker-ignore-onclickoutside")},i?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},t.prototype.render=function(){var e=this.renderCalendar();if(this.props.inline)return e;if(this.props.withPortal){var t=this.state.open?v.createElement(A$,{enableTabLoop:this.props.enableTabLoop},v.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},e)):null;return this.state.open&&this.props.portalId&&(t=v.createElement(j$,XG({portalId:this.props.portalId},this.props),t)),v.createElement("div",null,this.renderInputContainer(),t)}return v.createElement(C$,XG({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:e,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},t}(f.Component),E$="input",T$="navigate";const P$=Hc;function D$(){const[e,t]=f.useState([]),[n,r]=f.useState(null),[a,i]=f.useState([]),s=f.useRef(),o=eF.useReactToPrint({content:()=>s.current,documentTitle:"RMI_Gideon_Daily_Archive"});return f.useEffect(()=>{h(null,null,function*(){try{const e=yield pt.get(`${P$}/api/cashflow-archive`);t(e.data),i(e.data)}catch(e){console.error(" Error fetching archives:",e)}})},[]),Nt.jsxs("div",{className:"p-8 min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Nt.jsx("h2",{className:"text-2xl font-bold",children:" Daily Archive Reports"}),Nt.jsxs("div",{className:"flex items-center space-x-3",children:[Nt.jsx(k$,{selected:n,onChange:t=>{if(r(t),t){const n=t.toISOString().split("T")[0];i(e.filter(e=>{var t;return null==(t=e.date)?void 0:t.startsWith(n)}))}else i(e)},placeholderText:"Filter by date",className:"border rounded-md p-2 dark:bg-gray-800 dark:border-gray-700"}),Nt.jsx("button",{onClick:o,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg",children:" Print"})]})]}),Nt.jsx("div",{ref:s,className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:Nt.jsxs("table",{className:"w-full border-collapse",children:[Nt.jsx("thead",{className:"bg-indigo-100 dark:bg-gray-700",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-3 text-left",children:"Date"}),Nt.jsx("th",{className:"p-3 text-left",children:"Overall Capital"}),Nt.jsx("th",{className:"p-3 text-left",children:"Starting Capital"}),Nt.jsx("th",{className:"p-3 text-left",children:"Additional"}),Nt.jsx("th",{className:"p-3 text-left",children:"Remittance"}),Nt.jsx("th",{className:"p-3 text-left",children:"Revolving"}),Nt.jsx("th",{className:"p-3 text-left",children:"Cashbox"})]})}),Nt.jsx("tbody",{children:0===a.length?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:"7",className:"text-center p-6 text-gray-500",children:"No archived records found."})}):a.map(e=>{var t,n,r,a,i,s;return Nt.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsx("td",{className:"p-3",children:new Date(e.lastUpdated||e.date).toLocaleDateString("en-PH")}),Nt.jsxs("td",{className:"p-3",children:["",(null==(t=e.overallCapital)?void 0:t.toLocaleString())||0]}),Nt.jsxs("td",{className:"p-3",children:["",(null==(n=e.startingCapital)?void 0:n.toLocaleString())||0]}),Nt.jsxs("td",{className:"p-3",children:["",(null==(r=e.additional)?void 0:r.toLocaleString())||0]}),Nt.jsxs("td",{className:"p-3",children:["",(null==(a=e.remittance)?void 0:a.toLocaleString())||0]}),Nt.jsxs("td",{className:"p-3 font-semibold text-green-600",children:["",(null==(i=e.revolving)?void 0:i.toLocaleString())||0]}),Nt.jsxs("td",{className:"p-3 font-semibold text-blue-600",children:["",(null==(s=e.cashbox)?void 0:s.toLocaleString())||0]})]},e._id)})})]})})]})}const R$=Hc;function I$(){const{settings:e,updateSettings:t,loading:n,user:r,userTheme:a,updateUserTheme:i,setUser:s}=f.useContext($c),[o,d]=f.useState(!1),u="admin"===(null==r?void 0:r.role)||"super_admin"===(null==r?void 0:r.role),[p,m]=f.useState(null);f.useEffect(()=>{a?m(a):(null==r?void 0:r.theme)?m(r.theme):(null==e?void 0:e.theme)&&m(e.theme)},[a,r,e]);const[g,x]=f.useState("00:00"),[y,v]=f.useState(!1),[b,w]=f.useState("02:00"),[N,S]=f.useState(!1),[j,_]=f.useState(!1),[A,C]=f.useState(!1),[M,k]=f.useState(!1),[E,T]=f.useState(!1),P="super_admin"===(null==r?void 0:r.role),[D,I]=f.useState(""),[O,B]=f.useState(""),[L,F]=f.useState(!1),[U,z]=f.useState(null),[H,G]=f.useState([]),[V,$]=f.useState([]),[W,Y]=f.useState(""),[X,K]=f.useState(!1),[q,J]=f.useState([]),[Q,Z]=f.useState(""),[ee,te]=f.useState(""),[ne,re]=f.useState(!1),[ae,se]=f.useState(""),[oe,le]=f.useState(""),[ce,de]=f.useState(""),[ue,he]=f.useState(!1),[pe,me]=f.useState((null==r?void 0:r.name)||""),[ge,fe]=f.useState((null==r?void 0:r.username)||""),[ye,ve]=f.useState(!1),[be,we]=f.useState([]),[Ne,Se]=f.useState([]),[je,_e]=f.useState(""),[Ce,ke]=f.useState(""),[Ee,Te]=f.useState({systemBalance:"",cashOnHand:"",short:"",over:""}),[De,Ie]=f.useState((new Date).toISOString().split("T")[0]),[Oe,Be]=f.useState(!1),[Le,Fe]=f.useState(!1);if(f.useEffect(()=>{let e=!0;return h(null,null,function*(){var t;try{const n=yield pt.get(`${R$}/api/scheduler`);if(e&&(null==(t=n.data)?void 0:t.resetTime)){const e=/^\d{1,2}:\d{2}/.test(n.data.resetTime)?n.data.resetTime.slice(0,5):"00:00";x(e)}}catch(n){console.warn(" Failed to load scheduler time:",n)}}),h(null,null,function*(){try{const t=yield pt.get(`${R$}/api/system-settings`);e&&t.data&&(w(t.data.supervisorResetTime||"02:00"),S(t.data.autoResetSupervisorAssignments||!1),k(t.data.allowMultipleReportsPerDay||!1))}catch(t){console.warn(" Failed to load supervisor reset settings:",t)}}),u&&(h(null,null,function*(){try{const t=((yield pt.get(`${R$}/api/admin/users`)).data||[]).filter(e=>"teller"===e.role);e&&$(t)}catch(t){console.warn(" Failed to load tellers:",t)}}),h(null,null,function*(){try{const t=yield pt.get(`${R$}/api/admin/users`);e&&J(t.data||[])}catch(t){console.warn(" Failed to load users:",t)}}),h(null,null,function*(){try{const t=((yield pt.get(`${R$}/api/admin/users`)).data||[]).filter(e=>"teller"===e.role);e&&we(t)}catch(t){console.warn(" Failed to load tellers for report:",t)}}),h(null,null,function*(){try{const t=((yield pt.get(`${R$}/api/admin/users`)).data||[]).filter(e=>"supervisor"===e.role);e&&Se(t)}catch(t){console.warn(" Failed to load supervisors for report:",t)}})),()=>e=!1},[]),n||!e)return Nt.jsx("div",{className:"p-6 text-gray-700 dark:text-gray-200",children:" Loading system settings..."});const Ue=(n,r)=>{const a=c(l({},p),{[n]:r});m(a),u?t(c(l({},e),{theme:a})):i(a)};return Nt.jsxs("div",{className:"p-6 bg-gray-100 dark:bg-blue-950 text-gray-900 dark:text-gray-100 min-h-screen",children:[Nt.jsxs("h1",{className:"text-2xl font-bold mb-6",children:[" ",u?"System Settings":"My Settings"]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsx("h2",{className:"font-semibold text-lg mb-3",children:" Base Salary Configuration"}),Nt.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:Object.keys(e.baseSalary).map(n=>Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block capitalize mb-1",children:n}),Nt.jsx("input",{type:"number",value:e.baseSalary[n],onChange:r=>((n,r)=>{t(c(l({},e),{baseSalary:c(l({},e.baseSalary),{[n]:parseInt(r)||0})}))})(n,r.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]},n))})]}),Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsx("h2",{className:"font-semibold text-lg mb-3",children:" My Profile"}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Update your personal information"}),ue?Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name *"}),Nt.jsx("input",{type:"text",value:pe,onChange:e=>me(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"Enter your full name",required:!0})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username *"}),Nt.jsx("input",{type:"text",value:ge,onChange:e=>fe(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",placeholder:"Enter your username",required:!0})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;if(pe.trim()&&ge.trim()){ve(!0);try{const e=localStorage.getItem("token");yield pt.put(`${R$}/api/users/profile`,{name:pe.trim(),username:ge.trim()},{headers:{Authorization:`Bearer ${e}`}}),s(updatedUser),alert(" Profile updated successfully!"),he(!1)}catch(n){console.error(" Failed to update profile:",n),alert("Failed to update profile: "+((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||n.message))}finally{ve(!1)}}else alert(" Name and username are required.")}),disabled:ye,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition disabled:opacity-50",children:ye?" Saving...":" Save Changes"}),Nt.jsx("button",{onClick:()=>he(!1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition",children:" Cancel"})]})]}):Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),Nt.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded border",children:(null==r?void 0:r.name)||"Not set"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),Nt.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded border",children:null==r?void 0:r.username})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),Nt.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded border capitalize",children:null==r?void 0:r.role})]}),Nt.jsx("button",{onClick:()=>{he(!0),me((null==r?void 0:r.name)||""),fe((null==r?void 0:r.username)||"")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:" Edit Profile"})]})]}),p&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3",children:[" ",u?"System Theme Settings":"My Theme Settings"]}),!u&&Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Customize your personal theme preferences"}),Nt.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Nt.jsx("label",{className:"font-medium",children:"Mode:"}),Nt.jsxs("select",{value:p.mode,onChange:n=>(n=>{const r=c(l({},p),{mode:n});m(r),u?t(c(l({},e),{theme:r})):i(r)})(n.target.value),className:"p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[Nt.jsx("option",{value:"light",children:" Light"}),Nt.jsx("option",{value:"dark",children:" Dark"})]})]}),Nt.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[Nt.jsx(O$,{label:"Light Font Color",value:p.lightFont,onChange:e=>Ue("lightFont",e)}),Nt.jsx(O$,{label:"Dark Font Color",value:p.darkFont,onChange:e=>Ue("darkFont",e)}),Nt.jsx(O$,{label:"Light Background",value:p.lightBg,onChange:e=>Ue("lightBg",e)}),Nt.jsx(O$,{label:"Dark Background",value:p.darkBg,onChange:e=>Ue("darkBg",e)})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsx("h2",{className:"font-semibold text-lg mb-3",children:" Daily Reset Time"}),Nt.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Choose what time the system performs automatic daily reset (Asia/Manila timezone)."}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"time",value:g,onChange:e=>x(e.target.value),className:"p-2 border rounded dark:bg-gray-700 dark:border-gray-600"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){v(!0);try{let e=g;if(!e||e.includes("Invalid"))return alert(" Please select a valid reset time first."),void v(!1);yield pt.put(`${R$}/api/scheduler`,{resetTime:e}),alert(` Reset time updated to ${e}`)}catch(e){console.error(" Failed to update reset time:",e),alert("Failed to update reset time.")}finally{v(!1)}}),disabled:y,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:opacity-90",children:y?"Saving...":"Save Reset Time"})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsx("h2",{className:"font-semibold text-lg mb-3",children:" Supervisor Assignment Auto-Reset"}),Nt.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Automatically clear all teller-supervisor assignments daily at a specified time. This allows supervisors to be reassigned flexibly each day."}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",id:"autoResetSupervisorAssignments",checked:N,onChange:e=>S(e.target.checked),className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500"}),Nt.jsx("label",{htmlFor:"autoResetSupervisorAssignments",className:"text-sm font-medium",children:"Enable automatic daily reset"})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("label",{className:"text-sm font-medium",children:"Reset Time:"}),Nt.jsx("input",{type:"time",value:b,onChange:e=>w(e.target.value),disabled:!N,className:"p-2 border rounded dark:bg-gray-700 dark:border-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){_(!0);try{yield pt.put(`${R$}/api/system-settings/supervisor-reset`,{supervisorResetTime:b,autoResetSupervisorAssignments:N}),alert(" Supervisor reset settings updated! "+(N?`Assignments will reset daily at ${b}`:"Auto-reset disabled"))}catch(e){console.error(" Failed to update supervisor reset settings:",e),alert("Failed to update supervisor reset settings.")}finally{_(!1)}}),disabled:j,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:opacity-90 disabled:opacity-50",children:j?"Saving...":"Save Settings"})]}),Nt.jsxs("div",{className:"pt-3 border-t dark:border-gray-700",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){if(confirm(" This will clear all teller-supervisor assignments. Continue?")){C(!0);try{yield pt.post(`${R$}/api/system-settings/supervisor-reset/trigger`),alert(" All supervisor assignments have been cleared!")}catch(e){console.error(" Failed to reset assignments:",e),alert("Failed to reset supervisor assignments.")}finally{C(!1)}}}),disabled:A,className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:opacity-90 disabled:opacity-50 flex items-center gap-2",children:[Nt.jsx(Ae,{className:"w-4 h-4 "+(A?"animate-spin":"")}),A?"Resetting...":"Reset All Assignments Now"]}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Manually clear all teller-supervisor assignments immediately"})]})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsx("h2",{className:"font-semibold text-lg mb-3",children:" Teller Report Frequency"}),Nt.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Control whether tellers can submit multiple reports per day or are limited to one report per day."}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",id:"allowMultipleReportsPerDay",checked:M,onChange:e=>k(e.target.checked),className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500"}),Nt.jsx("label",{htmlFor:"allowMultipleReportsPerDay",className:"text-sm font-medium",children:"Allow tellers to submit multiple reports per day"})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){T(!0);try{yield pt.put(`${R$}/api/system-settings/multiple-reports`,{allowMultipleReportsPerDay:M}),alert(" Multiple reports setting updated! "+(M?"Tellers can now submit multiple reports per day":"Tellers are limited to one report per day"))}catch(e){console.error(" Failed to update multiple reports setting:",e),alert("Failed to update multiple reports setting.")}finally{T(!1)}}),disabled:E,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:opacity-90 disabled:opacity-50",children:E?"Saving...":"Save Setting"}),Nt.jsxs("span",{className:"text-sm text-gray-500",children:["Current: ",M?"Multiple reports allowed":"One report per day"]})]})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[Nt.jsx(Ae,{className:"w-5 h-5"}),"Transaction Reset/Override"]}),Nt.jsxs("div",{className:"flex items-center gap-2 p-3 mb-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg",children:[Nt.jsx(Me,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0"}),Nt.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:"Warning: This will permanently delete all capital and transaction records for the selected teller."})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsxs("select",{value:W,onChange:e=>Y(e.target.value),className:"flex-1 p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[Nt.jsx("option",{value:"",children:"-- Select Teller to Reset --"}),V.map(e=>Nt.jsx("option",{value:e._id,children:e.name||e.username},e._id))]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(!W)return void alert("Please select a teller first");const n=V.find(e=>e._id===W);if(confirm(` Are you sure you want to reset all transactions for ${(null==n?void 0:n.name)||(null==n?void 0:n.username)}? This will delete all capital and transaction records for this teller.`)){K(!0);try{yield pt.delete(`${R$}/api/teller-management/${W}/reset-all`),alert(` Successfully reset all transactions for ${(null==n?void 0:n.name)||(null==n?void 0:n.username)}`),Y("")}catch(r){console.error(" Failed to reset transactions:",r),alert("Failed to reset transactions: "+((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||r.message))}finally{K(!1)}}}),disabled:!W||X,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[Nt.jsx(R,{className:"w-4 h-4"}),X?"Resetting...":"Reset Transactions"]})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[Nt.jsx(Pe,{className:"w-5 h-5"}),"Override/Backfill Teller Report"]}),Nt.jsxs("div",{className:"flex items-center gap-2 p-3 mb-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg",children:[Nt.jsx(Me,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0"}),Nt.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"Manually set or override teller report values for any date. This will create or update the report for the selected day."})]}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Select Teller"}),Nt.jsxs("select",{value:je,onChange:e=>_e(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[Nt.jsx("option",{value:"",children:"-- Select Teller --"}),be.map(e=>Nt.jsx("option",{value:e._id,children:e.name||e.username},e._id))]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Select Supervisor"}),Nt.jsxs("select",{value:Ce,onChange:e=>ke(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[Nt.jsx("option",{value:"",children:"-- Select Supervisor --"}),Ne.map(e=>Nt.jsx("option",{value:e._id,children:e.name||e.username},e._id))]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Report Date"}),Nt.jsx("input",{type:"date",value:De,onChange:e=>Ie(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]})]}),je&&Ce&&Nt.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"System Balance"}),Nt.jsx("input",{type:"number",step:"0.01",value:Ee.systemBalance,onChange:e=>{const t=e.target.value,n=Ee.cashOnHand;if(t&&n){const e=parseFloat(n)-parseFloat(t);Te(c(l({},Ee),e<0?{systemBalance:t,short:Math.abs(e).toFixed(2),over:"0"}:e>0?{systemBalance:t,short:"0",over:e.toFixed(2)}:{systemBalance:t,short:"0",over:"0"}))}else Te(c(l({},Ee),{systemBalance:t}))},placeholder:"0.00",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Cash on Hand"}),Nt.jsx("input",{type:"number",step:"0.01",value:Ee.cashOnHand,onChange:e=>{const t=e.target.value,n=Ee.systemBalance;if(n&&t){const e=parseFloat(t)-parseFloat(n);Te(c(l({},Ee),e<0?{cashOnHand:t,short:Math.abs(e).toFixed(2),over:"0"}:e>0?{cashOnHand:t,short:"0",over:e.toFixed(2)}:{cashOnHand:t,short:"0",over:"0"}))}else Te(c(l({},Ee),{cashOnHand:t}))},placeholder:"0.00",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Short (Auto-calculated)"}),Nt.jsx("input",{type:"number",step:"0.01",value:Ee.short,readOnly:!0,placeholder:"0.00",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 cursor-not-allowed"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Over (Auto-calculated)"}),Nt.jsx("input",{type:"number",step:"0.01",value:Ee.over,readOnly:!0,placeholder:"0.00",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 cursor-not-allowed"})]})]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(!je)return void alert("Please select a teller first");if(!Ce)return void alert("Please select a supervisor first");if(!De)return void alert("Please select a date for the report");const n=be.find(e=>e._id===je),r=Ne.find(e=>e._id===Ce);if(confirm(`Override/backfill ${De} report for ${(null==n?void 0:n.name)||(null==n?void 0:n.username)} under ${(null==r?void 0:r.name)||(null==r?void 0:r.username)}?`)){Be(!0);try{const e=localStorage.getItem("token");yield pt.put(`${R$}/api/teller-reports/${je}/override`,{date:De,supervisorId:Ce,supervisorName:(null==r?void 0:r.name)||(null==r?void 0:r.username),systemBalance:parseFloat(Ee.systemBalance)||0,cashOnHand:parseFloat(Ee.cashOnHand)||0,short:parseFloat(Ee.short)||0,over:parseFloat(Ee.over)||0},{headers:{Authorization:`Bearer ${e}`}}),alert(` Report saved for ${De}  ${(null==n?void 0:n.name)||(null==n?void 0:n.username)}`),_e(""),ke(""),Te({systemBalance:"",cashOnHand:"",short:"",over:""}),Ie((new Date).toISOString().split("T")[0])}catch(a){console.error(" Failed to override report:",a),alert("Failed to override report: "+((null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.error)||a.message))}finally{Be(!1)}}}),disabled:!je||Oe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[Nt.jsx(Pe,{className:"w-4 h-4"}),Oe?"Overriding...":"Override Report"]})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[Nt.jsx(Re,{className:"w-5 h-5"}),"Change User Password"]}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Change password for any user (admin, supervisor, or teller)"}),Nt.jsxs("div",{className:"grid md:grid-cols-3 gap-3 items-end",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Select User"}),Nt.jsxs("select",{value:Q,onChange:e=>Z(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[Nt.jsx("option",{value:"",children:"-- Select User --"}),q.map(e=>Nt.jsxs("option",{value:e._id,children:[e.name||e.username," (",e.role,")"]},e._id))]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"New Password"}),Nt.jsx("input",{type:"password",value:ee,onChange:e=>te(e.target.value),placeholder:"Enter new password",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(!Q)return void alert("Please select a user first");if(!ee||ee.length<4)return void alert("Password must be at least 4 characters long");const n=q.find(e=>e._id===Q);if(confirm(`Change password for ${(null==n?void 0:n.name)||(null==n?void 0:n.username)}?`)){re(!0);try{yield pt.put(`${R$}/api/admin/users/${Q}/password`,{password:ee}),alert(` Password changed successfully for ${(null==n?void 0:n.name)||(null==n?void 0:n.username)}`),Z(""),te("")}catch(r){console.error(" Failed to change password:",r),alert("Failed to change password: "+((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||r.message))}finally{re(!1)}}}),disabled:!Q||!ee||ne,className:"flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[Nt.jsx(Re,{className:"w-4 h-4"}),ne?"Changing...":"Change Password"]})]})]}),!u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[Nt.jsx(Re,{className:"w-5 h-5"}),"Change My Password"]}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Update your account password"}),Nt.jsxs("div",{className:"space-y-3 max-w-md",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Current Password"}),Nt.jsx("input",{type:"password",value:ae,onChange:e=>se(e.target.value),placeholder:"Enter current password",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"New Password"}),Nt.jsx("input",{type:"password",value:oe,onChange:e=>le(e.target.value),placeholder:"Enter new password (min 4 chars)",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Confirm New Password"}),Nt.jsx("input",{type:"password",value:ce,onChange:e=>de(e.target.value),placeholder:"Confirm new password",className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(ae&&oe&&ce)if(oe.length<4)alert("New password must be at least 4 characters long");else if(oe===ce){if(confirm("Change your password?")){re(!0);try{const e=localStorage.getItem("token");yield pt.put(`${R$}/api/admin/users/${r._id}/password`,{password:oe,currentPassword:ae},{headers:{Authorization:`Bearer ${e}`}}),alert(" Password changed successfully"),se(""),le(""),de("")}catch(n){console.error(" Failed to change password:",n),alert("Failed to change password: "+((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.error)||n.message))}finally{re(!1)}}}else alert("New passwords do not match");else alert("Please fill in all password fields")}),disabled:!ae||!oe||!ce||ne,className:"flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[Nt.jsx(Re,{className:"w-4 h-4"}),ne?"Changing...":"Change Password"]})]})]}),u&&P&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[Nt.jsx(ie,{className:"w-5 h-5"}),"Backfill / Recalculate Payrolls"]}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Recalculate payroll totals (base + over - short/terms - deduction - withdrawal) for a date range."}),Nt.jsxs("div",{className:"grid md:grid-cols-3 gap-3 items-end mb-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm font-medium block mb-1",children:"Start date"}),Nt.jsx("input",{type:"date",value:D,onChange:e=>I(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm font-medium block mb-1",children:"End date"}),Nt.jsx("input",{type:"date",value:O,onChange:e=>B(e.target.value),className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(!P)return alert("Permission denied - super_admin only");if(!D||!O)return alert("Please select both start and end dates");if(confirm(`Run payroll recalculation between ${D}  ${O}? This will update payroll totals in place.`)){F(!0),z(null),G([]);try{const e=localStorage.getItem("token");G(e=>[...e,`Starting backfill (${D}  ${O})...`]);const t=yield pt.post(`${R$}/api/payroll/backfill-recalculate`,{startDate:D,endDate:O},{headers:{Authorization:`Bearer ${e}`}});z(t.data),G(e=>[...e,` Done: ${JSON.stringify(t.data)}`]),alert(`Backfill completed: ${t.data.processed||0} processed`)}catch(n){console.error(" Backfill error:",n);const r=(null==(t=null==(e=null==n?void 0:n.response)?void 0:e.data)?void 0:t.message)||n.message||"Unknown error";G(e=>[...e,` Error: ${r}`]),alert("Backfill failed: "+r)}finally{F(!1)}}}),disabled:L,className:"px-4 py-2 bg-rose-600 text-white rounded-lg hover:opacity-90 disabled:opacity-50 flex items-center gap-2",children:[Nt.jsx(Ae,{className:"w-4 h-4"}),L?"Running...":"Run Backfill"]}),Nt.jsx("button",{onClick:()=>{G([]),z(null)},className:"px-3 py-2 border rounded text-sm",children:"Clear"})]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-xs text-gray-500",children:"Progress / Logs"}),Nt.jsx("textarea",{readOnly:!0,value:(H||[]).join("\n"),rows:5,className:"w-full p-2 mt-2 border rounded bg-gray-50 dark:bg-gray-900 text-xs"}),U&&Nt.jsxs("div",{className:"mt-2 text-sm text-green-700 dark:text-green-300",children:["Processed: ",U.processed||0,"  Errors: ",U.errors&&U.errors.length||0]})]})]}),u&&Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow mb-6",children:[Nt.jsxs("h2",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[Nt.jsx(xe,{className:"w-5 h-5"}),"Sync Payroll from Teller Reports"]}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:'Automatically calculate and update teller payrolls based on their reports. This will aggregate "over" amounts as bonuses and "short" amounts as deductions.'}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(confirm("This will recalculate all teller payrolls based on their reports. Continue?")){Fe(!0);try{const e=localStorage.getItem("token"),t=((yield pt.get(`${R$}/api/admin/users`,{headers:{Authorization:`Bearer ${e}`}})).data||[]).filter(e=>"teller"===e.role);let r=0,a=0;for(const i of t)try{yield pt.post(`${R$}/api/payroll/sync-teller-reports`,{userId:i._id},{headers:{Authorization:`Bearer ${e}`}}),r++}catch(n){console.error(`Failed to sync payroll for ${i.name||i.username}:`,n),a++}alert(` Payroll sync complete!\nSuccess: ${r}\nFailed: ${a}`)}catch(n){console.error(" Failed to sync payrolls:",n),alert("Failed to sync payrolls: "+((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||n.message))}finally{Fe(!1)}}}),disabled:Le,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[Nt.jsx(Ae,{className:"w-4 h-4 "+(Le?"animate-spin":"")}),Le?"Syncing...":"Sync All Teller Payrolls"]})]}),u&&Nt.jsx("button",{onClick:()=>h(null,null,function*(){d(!0);try{yield t(e),alert(" Settings saved successfully!")}catch(n){console.error(" Failed to save:",n),alert("Failed to save settings.")}finally{d(!1)}}),disabled:o,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-md shadow",children:o?" Saving...":" Save Settings"})]})}function O$({label:e,value:t,onChange:n}){return Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block mb-1 font-medium",children:e}),Nt.jsx("input",{type:"color",value:t,onChange:e=>n(e.target.value),className:"w-16 h-8 p-1 border rounded cursor-pointer"})]})}const B$=`${Hc}/api`;function L$(){const[e,t]=f.useState([]),[n,r]=f.useState(!1),[a,i]=f.useState(!1),[s,o]=f.useState(null),[d,u]=f.useState(null),[p,m]=f.useState(!1),[g,x]=f.useState({type:"",text:""}),[y,v]=f.useState({name:"",position:"Watcher",dailySalary:""}),[b,w]=f.useState({amount:"",dateKey:(new Date).toISOString().split("T")[0],notes:""});f.useEffect(()=>{N()},[]);const N=()=>h(null,null,function*(){try{const e=yield pt.get(`${B$}/staff`);t(e.data||[])}catch(e){console.error("Error fetching employees:",e),S("error","Failed to load employees")}}),S=(e,t)=>{x({type:e,text:t}),setTimeout(()=>x({type:"",text:""}),3e3)},j=()=>{o(null),v({name:"",position:"Watcher",dailySalary:""}),r(!1)};return Nt.jsx(nd,{children:Nt.jsxs("div",{className:"p-6 space-y-6",children:[Nt.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"p-3 bg-indigo-600 rounded-lg",children:Nt.jsx(U,{className:"w-8 h-8 text-white"})}),Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Employee Management"}),Nt.jsx("p",{className:"text-gray-600",children:"Manage staff and manual payroll"})]})]}),Nt.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition-colors",children:[Nt.jsx(le,{className:"w-5 h-5"}),"Add Employee"]})]})}),g.text&&Nt.jsx("div",{className:"mb-4 p-4 rounded-lg "+("success"===g.type?"bg-green-100 text-green-800 border border-green-300":"bg-red-100 text-red-800 border border-red-300"),children:g.text}),Nt.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full",children:[Nt.jsx("thead",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 text-white",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Name"}),Nt.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Position"}),Nt.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Daily Salary"}),Nt.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Status"}),Nt.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold",children:"Actions"})]})}),Nt.jsx("tbody",{className:"divide-y divide-gray-200",children:0===e.length?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-500",children:"No employees found. Add your first employee to get started."})}):e.map(e=>{var t;return Nt.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[Nt.jsx("td",{className:"px-6 py-4",children:Nt.jsx("div",{className:"font-semibold text-gray-800",children:e.name})}),Nt.jsx("td",{className:"px-6 py-4",children:Nt.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-100 text-indigo-700 text-sm font-medium",children:[Nt.jsx(se,{className:"w-4 h-4"}),e.position]})}),Nt.jsx("td",{className:"px-6 py-4",children:Nt.jsxs("span",{className:"font-semibold text-green-600",children:["",(null==(t=e.dailySalary)?void 0:t.toLocaleString())||"0"]})}),Nt.jsx("td",{className:"px-6 py-4",children:Nt.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium "+("active"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.status})}),Nt.jsx("td",{className:"px-6 py-4",children:Nt.jsxs("div",{className:"flex items-center justify-center gap-2",children:[Nt.jsx("button",{onClick:()=>{return u(t=e),w({amount:t.dailySalary||"",dateKey:(new Date).toISOString().split("T")[0],notes:""}),void i(!0);var t},className:"p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",title:"Add Payroll",children:Nt.jsx(xe,{className:"w-4 h-4"})}),Nt.jsx("button",{onClick:()=>{return o(t=e),v({name:t.name,position:t.position,dailySalary:t.dailySalary||""}),void r(!0);var t},className:"p-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",title:"Edit",children:Nt.jsx(Q,{className:"w-4 h-4"})}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(confirm("Are you sure you want to delete this employee?"))try{yield pt.delete(`${B$}/staff/${t}`),S("success","Employee deleted successfully"),N()}catch(e){S("error","Failed to delete employee")}});var t},className:"p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",title:"Delete",children:Nt.jsx(R,{className:"w-4 h-4"})})]})})]},e._id)})})]})})}),n&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:s?"Edit Employee":"Add New Employee"}),Nt.jsx("button",{onClick:j,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:Nt.jsx(ce,{className:"w-5 h-5"})})]}),Nt.jsxs("form",{onSubmit:s?e=>h(null,null,function*(){var t,n;e.preventDefault(),m(!0);try{yield pt.put(`${B$}/staff/${s._id}`,c(l({},y),{dailySalary:Number(y.dailySalary)||0})),S("success","Employee updated successfully"),o(null),v({name:"",position:"Watcher",dailySalary:""}),N()}catch(r){S("error",(null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||"Failed to update employee")}finally{m(!1)}}):e=>h(null,null,function*(){var t,n;e.preventDefault(),m(!0);try{if(!y.name||!y.position)throw new Error("Name and position are required");yield pt.post(`${B$}/staff`,c(l({},y),{dailySalary:Number(y.dailySalary)||0})),S("success","Employee added successfully"),r(!1),v({name:"",position:"Watcher",dailySalary:""}),N()}catch(a){S("error",(null==(n=null==(t=a.response)?void 0:t.data)?void 0:n.message)||"Failed to add employee")}finally{m(!1)}}),children:[Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Name *"}),Nt.jsx("input",{type:"text",value:y.name,onChange:e=>v(c(l({},y),{name:e.target.value})),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Position *"}),Nt.jsx("select",{value:y.position,onChange:e=>v(c(l({},y),{position:e.target.value})),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:["Watcher","Sub-watcher","Assistant Admin","Monton"].map(e=>Nt.jsx("option",{value:e,children:e},e))})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Daily Salary"}),Nt.jsx("input",{type:"number",value:y.dailySalary,onChange:e=>v(c(l({},y),{dailySalary:e.target.value})),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",min:"0",step:"0.01"})]})]}),Nt.jsxs("div",{className:"flex gap-3 mt-6",children:[Nt.jsx("button",{type:"button",onClick:j,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-semibold",children:"Cancel"}),Nt.jsx("button",{type:"submit",disabled:p,className:"flex-1 px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-semibold disabled:opacity-50",children:p?"Saving...":s?"Update":"Add"})]})]})]})}),a&&d&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Add Payroll"}),Nt.jsx("button",{onClick:()=>{i(!1),u(null)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:Nt.jsx(ce,{className:"w-5 h-5"})})]}),Nt.jsxs("div",{className:"mb-4 p-4 bg-indigo-50 rounded-lg",children:[Nt.jsx("p",{className:"text-sm text-gray-600",children:"Employee"}),Nt.jsx("p",{className:"text-lg font-bold text-gray-800",children:d.name}),Nt.jsx("p",{className:"text-sm text-indigo-600",children:d.position})]}),Nt.jsxs("form",{onSubmit:e=>h(null,null,function*(){var t,n;e.preventDefault(),m(!0);try{if(!b.amount||!b.dateKey)throw new Error("Amount and date are required");const e=JSON.parse(localStorage.getItem("mock-user")||"{}");yield pt.post(`${B$}/staff/${d._id}/payroll`,c(l({},b),{amount:Number(b.amount),createdBy:e.username||"admin"})),S("success","Payroll added successfully"),i(!1),w({amount:"",dateKey:(new Date).toISOString().split("T")[0],notes:""}),u(null)}catch(r){S("error",(null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||"Failed to add payroll")}finally{m(!1)}}),children:[Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Amount *"}),Nt.jsx("input",{type:"number",value:b.amount,onChange:e=>w(c(l({},b),{amount:e.target.value})),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,min:"0",step:"0.01"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Date *"}),Nt.jsx("input",{type:"date",value:b.dateKey,onChange:e=>w(c(l({},b),{dateKey:e.target.value})),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Notes"}),Nt.jsx("textarea",{value:b.notes,onChange:e=>w(c(l({},b),{notes:e.target.value})),className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",rows:"3"})]})]}),Nt.jsxs("div",{className:"flex gap-3 mt-6",children:[Nt.jsx("button",{type:"button",onClick:()=>{i(!1),u(null)},className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-semibold",children:"Cancel"}),Nt.jsx("button",{type:"submit",disabled:p,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold disabled:opacity-50",children:p?"Adding...":"Add Payroll"})]})]})]})})]})})}const F$={},U$=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};const a=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),s=(null==i?void 0:i.nonce)||(null==i?void 0:i.getAttribute("nonce"));r=e(t.map(e=>{if(e=function(e,t){return new URL(e,t).href}(e,n),e in F$)return;F$[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(n)for(let n=a.length-1;n>=0;n--){const r=a[n];if(r.href===e&&(!t||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${e}"]${r}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,s&&i.setAttribute("nonce",s),document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};function z$(){var e,t,n,r,a,i,s,o,l,c,d,u,p,m,g,x,y,v,b,w,N,S,j;const{user:_,settings:A}=f.useContext($c),{showToast:C}=Kc(),M="dark"===(null==(e=null==A?void 0:A.theme)?void 0:e.mode);if(!_||"admin"!==_.role&&"super_admin"!==_.role)return Nt.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen "+(M?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Access Denied"}),Nt.jsx("p",{className:"text-sm opacity-70",children:"You do not have permission to view this page."})]});const[E,T]=f.useState(!0),[P,D]=f.useState({totalPayrolls:0,approvedCount:0,pendingCount:0,totalPayout:0}),[I,B]=f.useState([]),[L,F]=f.useState([]),[U,z]=f.useState([]),[H,G]=f.useState("all"),[V,$]=f.useState(""),[Y,X]=f.useState("all"),[K,q]=f.useState(!1),[J,Q]=f.useState("overall"),[Z,ee]=f.useState(""),[te,ne]=f.useState("none"),[re,ae]=f.useState([]),[ie,se]=f.useState(0),[oe,le]=f.useState({open:!1,payroll:null,userName:"",date:""}),[de,ue]=f.useState(()=>localStorage.getItem("payoutFilter")||"overall"),[me,fe]=f.useState(()=>localStorage.getItem("payoutDate")||(new Date).toISOString().split("T")[0]),[ve,be]=f.useState(()=>localStorage.getItem("totalPayrollFilter")||"daily"),[we,Ne]=f.useState(()=>localStorage.getItem("totalPayrollDate")||(new Date).toISOString().split("T")[0]),[Se,je]=f.useState(null),[Ae,Ce]=f.useState({open:!1,payroll:null}),[Me,ke]=f.useState({open:!1,payroll:null,payload:null}),[Ee,Te]=f.useState({open:!1,payroll:null}),[De,Re]=f.useState(!1),[Le,Fe]=f.useState(!1),[Ue,ze]=f.useState("add"),[He,Ge]=f.useState(""),[Ve,$e]=f.useState(""),[We,Ye]=f.useState(""),[Xe,Ke]=f.useState(""),[qe,Je]=f.useState(""),[Qe,Ze]=f.useState(""),[et,tt]=f.useState(""),[nt,rt]=f.useState([]),[at,it]=f.useState(""),[st,ot]=f.useState(""),[lt,ct]=f.useState(""),[dt,ut]=f.useState(""),[ht,mt]=f.useState(""),[gt,ft]=f.useState("1"),[xt,yt]=f.useState(""),[vt,bt]=f.useState([]),[wt,St]=f.useState([]),[jt,_t]=f.useState(""),[At,Ct]=f.useState(""),[Mt,kt]=f.useState([]),[Et,Tt]=f.useState(4);f.useEffect(()=>{Dt(),Pt()},[de,me]);const Pt=()=>h(null,null,function*(){var e;try{const t=yield pt.get(`${zc()}/api/users`);bt((null==(e=t.data)?void 0:e.users)||t.data||[])}catch(t){console.error("Error fetching users:",t)}});f.useEffect(()=>{const e=["payrollUpdated","payrollApproved","payrollDisapproved","payrollAdjusted","payrollLocked","payrollDeleted"],t=Vc();if(t)return e.forEach(e=>t.on(e,()=>{console.log(" Payroll event:",e),Dt(),C({type:"info",message:"Payroll auto-refreshed"})})),()=>e.forEach(e=>t.off(e))},[]);const Dt=()=>h(null,null,function*(){var e,t,n,r,a,i,s,o,l,c,d,u,h,p,m,g,f,x,y,v,b;try{T(!0);const w=new URLSearchParams;"overall"!==de&&(w.append("filter",de),w.append("date",me));const[N,S,j]=yield Promise.all([pt.get(`${zc()}/api/admin/payroll-summary?${w.toString()}`),pt.get(`${zc()}/api/payroll/all`),pt.get(`${zc()}/api/payroll/unapproved`)]),_=N.data||{};D({totalPayrolls:null!=(t=null!=(e=_.totalPayrolls)?e:_.totalRecords)?t:0,approvedCount:null!=(n=_.approvedCount)?n:0,pendingCount:null!=(s=_.pendingCount)?s:null!=(i=null==(a=null==(r=j.data)?void 0:r.unapproved)?void 0:a.length)?i:0,totalPayout:null!=(l=null!=(o=_.totalPayout)?o:_.totalNet)?l:0}),B(null!=(u=null!=(d=null==(c=S.data)?void 0:c.payrolls)?d:S.data)?u:[]),F(null!=(x=null!=(f=null!=(m=null==(h=j.data)?void 0:h.unapproved)?m:null==(p=j.data)?void 0:p.requests)?f:null==(g=j.data)?void 0:g.payrolls)?x:[]);const A=(null!=(b=null!=(v=null==(y=S.data)?void 0:y.payrolls)?v:S.data)?b:[]).filter(e=>e.approved);z(A)}catch(w){console.error("Error loading payroll management data:",w),C({type:"error",message:"Failed to load payroll management data."})}finally{T(!1)}}),Rt=()=>h(null,null,function*(){yield Dt(),"weekly-summary"===H&&(yield It(ie))}),It=(e=0)=>h(null,null,function*(){var t,n,r,a,i,s,o,l;try{const d=new Date,u=d.getDay(),h=0===u?6:u-1,p=new Date(d);p.setDate(d.getDate()-h+7*e),p.setHours(0,0,0,0);const m=new Date(p);m.setDate(p.getDate()+6),m.setHours(23,59,59,999);const g=yield pt.get(`${zc()}/api/payroll/all`),f=(null!=(r=null!=(n=null==(t=g.data)?void 0:t.payrolls)?n:g.data)?r:[]).filter(e=>{const t=new Date(e.createdAt||e.date);return t>=p&&t<=m}),x={};for(const e of f){const t=(null==(a=e.user)?void 0:a._id)||e.user;if(!t)continue;x[t]||(x[t]={userId:t,userName:(null==(i=e.user)?void 0:i.name)||(null==(s=e.user)?void 0:s.username)||"Unknown",username:(null==(o=e.user)?void 0:o.username)||"unknown",role:e.role,totalBaseSalary:0,totalOver:0,totalShort:0,totalDeductions:0,totalAdjustments:0,adjustmentsList:[],weeklyPaymentDeductions:0,shortPaymentPlans:[],totalGross:0,totalNet:0,daysWorked:0,payrolls:[]});const n=e.baseSalary||0,r=e.over||0,c=e.short||0,d=e.deduction||0,u=e.totalSalary||n+r-c,h=(null==(l=e.adjustments)?void 0:l.reduce((e,t)=>e+(t.delta||0),0))||0;e.adjustments&&e.adjustments.length>0&&e.adjustments.forEach(n=>{x[t].adjustmentsList.push({delta:n.delta||0,reason:n.reason||"No reason provided",createdAt:n.createdAt,date:new Date(e.createdAt||e.date).toLocaleDateString()})}),x[t].totalBaseSalary+=n,x[t].totalOver+=r,x[t].totalShort+=c,x[t].totalDeductions+=d,x[t].totalAdjustments+=h,x[t].totalGross+=n+r-c,x[t].totalNet+=u,x[t].daysWorked+=1,x[t].payrolls.push(e)}const y=Object.values(x);for(const e of y)try{const t=yield pt.get(`${zc()}/api/short-payments/active/${e.userId}`);if(t.data.success&&t.data.plans){const n=t.data.plans.reduce((e,t)=>e+t.weeklyAmount,0);e.weeklyPaymentDeductions=n,e.shortPaymentPlans=t.data.plans.map(e=>({amount:e.weeklyAmount,remaining:e.remainingWeeks,total:e.totalAmount,original:e.originalAmount}))}}catch(c){console.error("Error fetching payment plans:",c)}ae(y)}catch(c){console.error("Error fetching weekly payroll data:",c),C({type:"error",message:"Failed to load weekly payroll data."})}});f.useEffect(()=>{"weekly-summary"===H&&It(ie)},[H,ie]);const Ot=f.useMemo(()=>{let e="all"===H?I:"approved"===H?U:L;Array.isArray(e)||(console.warn(" PayrollManagement expected array, got:",e),e=[]);const t=V.trim().toLowerCase(),n=e.filter(e=>{var n,r,a;if("all"!==Y&&e.role!==Y)return!1;if(!t)return!0;const i=((null==(n=e.user)?void 0:n.name)||(null==(r=e.user)?void 0:r.username)||"").toLowerCase(),s=((null==(a=e.user)?void 0:a.username)||"").toLowerCase();return i.includes(t)||s.includes(t)}),r="overall"!==J?n.filter(e=>{const t=new Date(e.createdAt||e.date),n=new Date(J);return t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()}):n;return K?r.filter(e=>{var t,n,r,a,i,s,o;const l=(null!=(n=null!=(t=e.baseSalary)?t:e.base)?n:0)||0,c=null!=(r=e.over)?r:0,d=null!=(a=e.short)?a:0,u=(null!=(s=null!=(i=e.deduction)?i:e.totalDeductions)?s:0)||0;return((null!=(o=e.totalSalary)?o:l+c-d-u)||0)>0}):r},[H,I,U,L,V,Y,J]),Bt=f.useMemo(()=>{if(!I||0===I.length)return 0;let e=I;if("daily"===ve)e=I.filter(e=>{const t=new Date(e.createdAt||e.date);return!isNaN(t.getTime())&&t.toISOString().split("T")[0]===we});else if("weekly"===ve){const t=new Date(we),n=t.getDay(),r=new Date(t);r.setDate(t.getDate()-(0===n?6:n-1)),r.setHours(0,0,0,0);const a=new Date(r);a.setDate(r.getDate()+6),a.setHours(23,59,59,999),e=I.filter(e=>{const t=new Date(e.createdAt||e.date);return!isNaN(t.getTime())&&(t>=r&&t<=a)})}else if("monthly"===ve){const[t,n]=we.split("-");e=I.filter(e=>{const r=new Date(e.createdAt||e.date);return!isNaN(r.getTime())&&(r.getFullYear()===parseInt(t)&&r.getMonth()+1===parseInt(n))})}return e.reduce((e,t)=>e+(t.totalSalary||0),0)},[I,ve,we]),Lt=f.useMemo(()=>{var e,t,n,r,a,i,s,o,l;if("none"===te)return Ot;const c=new Map;for(const u of Ot){const d=new Date(u.createdAt||u.date);let h;if("monthly"===te)h=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;else if("weekly"===te){const e=d.getDay(),t=new Date(d);t.setDate(d.getDate()-(0===e?6:e-1)),h=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}const p=`${(null==(e=u.user)?void 0:e._id)||u.user}|${h}`;c.has(p)||c.set(p,{_id:p,user:u.user,role:u.role,period:h,baseSalary:0,over:0,short:0,deduction:0,totalSalary:0,daysPresent:0,approved:!0,locked:!1});const m=c.get(p);m.baseSalary+=Number(null!=(n=null!=(t=u.baseSalary)?t:u.base)?n:0)||0,m.over+=Number(null!=(r=u.over)?r:0)||0,m.short+=Number(null!=(a=u.short)?a:0)||0,m.deduction+=Number(null!=(s=null!=(i=u.deduction)?i:u.totalDeductions)?s:0)||0,m.totalSalary+=Number(null!=(o=u.totalSalary)?o:0)||0,m.daysPresent+=Number(null!=(l=u.daysPresent)?l:1)||0,u.adjustments&&Array.isArray(u.adjustments)&&u.adjustments.forEach(e=>{m.adjustments||(m.adjustments=[]),m.adjustments.push(e)}),u.approved||(m.approved=!1),u.locked&&(m.locked=!0)}const d=Array.from(c.values());return d.sort((e,t)=>{var n,r,a,i;const s=((null==(n=e.user)?void 0:n.name)||(null==(r=e.user)?void 0:r.username)||"").toLowerCase(),o=((null==(a=t.user)?void 0:a.name)||(null==(i=t.user)?void 0:i.username)||"").toLowerCase();return s!==o?s.localeCompare(o):t.period.localeCompare(e.period)}),d},[Ot,te]),Ft=f.useMemo(()=>{const e="none"===te?Ot:Lt,t=e.filter(e=>e.approved),n=new Map;e.forEach(e=>{const t=new Date(e.createdAt||e.date).toLocaleDateString();n.has(t)||n.set(t,{date:t,records:0,approved:0,pending:0,totalPayout:0,base:0,over:0,short:0});const r=n.get(t);r.records++,e.approved?(r.approved++,r.totalPayout+=Number(e.totalSalary)||0):r.pending++,r.base+=Number(e.baseSalary)||0,r.over+=Number(e.over)||0,r.short+=Number(e.short)||0});const r=Array.from(n.values()).sort((e,t)=>new Date(t.date)-new Date(e.date));return{totalRecords:e.length,approvedRecords:t.length,pendingRecords:e.length-t.length,totalPayout:t.reduce((e,t)=>e+(Number(t.totalSalary)||0),0),totalBase:e.reduce((e,t)=>e+(Number(t.baseSalary)||0),0),totalOver:e.reduce((e,t)=>e+(Number(t.over)||0),0),totalShort:e.reduce((e,t)=>e+(Number(t.short)||0),0),dailyBreakdown:r}},[Ot,Lt,te]),Ut=e=>je(e),zt=(e,t)=>{if(!e||!t)return[];const n=[],r=new Date(e),a=new Date(t);if(r>a)return[];for(let i=new Date(r);i<=a;i.setDate(i.getDate()+1))n.push(new Date(i).toISOString().split("T")[0]);return n};f.useEffect(()=>{Se&&"teller"===Se.role?Ht(Se.user._id):rt([])},[Se]);const Ht=e=>h(null,null,function*(){try{const t=yield pt.get(`${zc()}/api/teller-reports/teller/${e}`);let n=[];n=t&&t.data?Array.isArray(t.data)?t.data:Array.isArray(t.data.reports)?t.data.reports:Array.isArray(t.data.tellers)?t.data.tellers:Array.isArray(t.data.items)?t.data.items:[]:[];const r=new Date,a=new Date(r.getFullYear(),r.getMonth(),1),i=new Date(r.getFullYear(),r.getMonth()+1,0),s=n.filter(e=>{const t=new Date(e.date||e.createdAt);return t>=a&&t<=i});rt(s)}catch(t){console.error("Error fetching daily reports:",t),rt([])}}),Gt=(e="")=>`p-4 rounded-xl shadow-md transition transform hover:-translate-y-1 ${e}`;return Nt.jsxs("div",{className:"p-6 min-h-screen "+(M?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-2xl font-bold",children:"Payroll Management"}),Nt.jsx("p",{className:"text-sm opacity-70",children:"Overview, approve, and manually adjust payrolls."})]}),("admin"===(null==_?void 0:_.role)||"super_admin"===(null==_?void 0:_.role))&&Nt.jsxs("button",{onClick:()=>{Re(!0),it(""),ot((new Date).toISOString().split("T")[0]),ct(""),ut(""),mt(""),ft("1"),yt(""),St([]),_t(""),Ct("")},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 transition",children:[Nt.jsx(xe,{className:"w-4 h-4"}),"Create Override"]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[Nt.jsx("div",{className:Gt(M?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:[Nt.jsx(_e,{className:"w-4 h-4"})," Total Payrolls"]}),Nt.jsx("div",{className:"text-2xl font-bold",children:null!=(t=P.totalPayrolls)?t:0})]}),Nt.jsx("div",{className:"p-3 rounded-lg bg-indigo-100 dark:bg-indigo-700 text-indigo-700 dark:text-indigo-100",children:Nt.jsx(_e,{})})]})}),Nt.jsx("div",{className:Gt(M?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:[Nt.jsx(k,{className:"w-4 h-4"})," Approved"]}),Nt.jsx("div",{className:"text-2xl font-bold",children:null!=(n=P.approvedCount)?n:0})]}),Nt.jsx("div",{className:"p-3 rounded-lg bg-green-100 text-green-700 dark:bg-green-700 dark:text-green-100",children:Nt.jsx(k,{})})]})}),Nt.jsx("div",{className:Gt(M?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:[Nt.jsx(Ie,{className:"w-4 h-4"})," Pending"]}),Nt.jsx("div",{className:"text-2xl font-bold",children:null!=(r=P.pendingCount)?r:0})]}),Nt.jsx("div",{className:"p-3 rounded-lg bg-yellow-100 text-yellow-700 dark:bg-yellow-700 dark:text-yellow-100",children:Nt.jsx(Ie,{})})]})}),Nt.jsx("div",{className:Gt(M?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:[Nt.jsx(xe,{className:"w-4 h-4"})," Total Payroll"]}),Nt.jsxs("div",{className:"text-2xl font-bold",children:["",Bt.toLocaleString()]}),Nt.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[Nt.jsxs("select",{value:ve,onChange:e=>{const t=e.target.value;be(t),localStorage.setItem("totalPayrollFilter",t)},className:"text-xs px-2 py-1 rounded border "+(M?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"daily",children:"Daily"}),Nt.jsx("option",{value:"weekly",children:"Weekly"}),Nt.jsx("option",{value:"monthly",children:"Monthly"})]}),Nt.jsx("input",{type:"date",value:we,onChange:e=>{const t=e.target.value;Ne(t),localStorage.setItem("totalPayrollDate",t)},className:"text-xs px-2 py-1 rounded border "+(M?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})]})]}),Nt.jsx("div",{className:"p-3 rounded-lg bg-purple-100 dark:bg-purple-700 text-purple-700 dark:text-purple-100",children:Nt.jsx(xe,{})})]})}),Nt.jsx("div",{className:Gt(M?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:[Nt.jsx(xe,{className:"w-4 h-4"})," Total Payout"]}),Nt.jsxs("div",{className:"text-2xl font-bold",children:["",(null!=(a=P.totalPayout)?a:0).toLocaleString()]}),Nt.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[Nt.jsxs("select",{value:de,onChange:e=>{const t=e.target.value;ue(t),localStorage.setItem("payoutFilter",t)},className:"text-xs px-2 py-1 rounded border "+(M?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"overall",children:"Overall"}),Nt.jsx("option",{value:"daily",children:"Daily"}),Nt.jsx("option",{value:"weekly",children:"Weekly"}),Nt.jsx("option",{value:"monthly",children:"Monthly"})]}),"overall"!==de&&Nt.jsx("input",{type:"date",value:me,onChange:e=>{const t=e.target.value;fe(t),localStorage.setItem("payoutDate",t)},className:"text-xs px-2 py-1 rounded border "+(M?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})]})]}),Nt.jsx("div",{className:"p-3 rounded-lg bg-indigo-100 dark:bg-indigo-700 text-indigo-700 dark:text-indigo-100",children:Nt.jsx(xe,{})})]})})]}),Nt.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-4 items-start lg:items-center justify-between",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:()=>G("all"),className:"px-4 py-2 rounded-lg font-semibold "+("all"===H?"bg-indigo-600 text-white":M?"bg-gray-800 text-gray-200":"bg-white text-gray-700"),children:"All Payrolls"}),Nt.jsx("button",{onClick:()=>G("pending"),className:"px-4 py-2 rounded-lg font-semibold "+("pending"===H?"bg-indigo-600 text-white":M?"bg-gray-800 text-gray-200":"bg-white text-gray-700"),children:"Pending Payrolls"}),Nt.jsx("button",{onClick:()=>G("approved"),className:"px-4 py-2 rounded-lg font-semibold "+("approved"===H?"bg-indigo-600 text-white":M?"bg-gray-800 text-gray-200":"bg-white text-gray-700"),children:"Approved Payrolls"}),Nt.jsx("button",{onClick:()=>G("weekly-summary"),className:"px-4 py-2 rounded-lg font-semibold "+("weekly-summary"===H?"bg-indigo-600 text-white":M?"bg-gray-800 text-gray-200":"bg-white text-gray-700"),children:"Weekly Summary"})]}),Nt.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto",children:[Nt.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border "+(M?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:[Nt.jsx(pe,{className:"w-4 h-4 text-gray-400"}),Nt.jsx("input",{value:V,onChange:e=>$(e.target.value),placeholder:"Search name or username...",className:"bg-transparent outline-none text-sm"})]}),Nt.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border "+(M?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:[Nt.jsx(he,{className:"w-4 h-4 text-gray-400"}),Nt.jsxs("select",{value:Y,onChange:e=>X(e.target.value),className:"bg-transparent outline-none text-sm",children:[Nt.jsx("option",{value:"all",children:"All roles"}),Nt.jsx("option",{value:"admin",children:"Admin"}),Nt.jsx("option",{value:"supervisor",children:"Supervisor"}),Nt.jsx("option",{value:"supervisor_teller",children:"Supervisor/Teller"}),Nt.jsx("option",{value:"head_watcher",children:"Head Watcher"}),Nt.jsx("option",{value:"sub_watcher",children:"Sub Watcher"}),Nt.jsx("option",{value:"teller",children:"Teller"})]})]}),Nt.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border "+(M?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:[Nt.jsx(W,{className:"w-4 h-4 text-gray-400"}),Nt.jsxs("select",{value:J,onChange:e=>{const t=e.target.value;Q(t),"overall"===t?ee(""):"custom"===t||ee(t)},className:"bg-transparent outline-none text-sm min-w-[140px]",children:[Nt.jsx("option",{value:"overall",children:"Overall (All Dates)"}),Nt.jsx("option",{value:(new Date).toISOString().split("T")[0],children:"Today"}),Nt.jsx("option",{value:new Date(Date.now()-864e5).toISOString().split("T")[0],children:"Yesterday"}),Nt.jsx("option",{value:"custom",children:"Custom Date..."})]})]}),"custom"===J&&Nt.jsx("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border "+(M?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:Nt.jsx("input",{type:"date",value:Z,onChange:e=>{const t=e.target.value;ee(t),Q(t)},className:"bg-transparent outline-none text-sm"})}),Nt.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer "+(M?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:[Nt.jsx("input",{type:"checkbox",checked:K,onChange:e=>q(e.target.checked)}),Nt.jsx("span",{className:"text-sm select-none",children:"Hide zero salary"})]})]})]}),"weekly-summary"===H&&Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"mb-4",children:[Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("h3",{className:"text-lg font-semibold",children:"Weekly Payroll Summary"}),Nt.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(()=>{const e=new Date,t=e.getDay(),n=0===t?6:t-1,r=new Date(e);r.setDate(e.getDate()-n+7*ie);const a=new Date(r);return a.setDate(r.getDate()+6),`${r.toLocaleDateString()} - ${a.toLocaleDateString()}`})(),0===ie&&Nt.jsx("span",{className:"ml-2 text-indigo-600 dark:text-indigo-400 font-semibold",children:"(Current Week)"}),ie<0&&Nt.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:["(",Math.abs(ie)," week",Math.abs(ie)>1?"s":""," ago)"]}),ie>0&&Nt.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:["(",ie," week",ie>1?"s":""," ahead)"]})]})]}),Mt.length>0&&Nt.jsxs("div",{className:"mb-4 p-4 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg flex items-center justify-between",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsxs("span",{className:"font-semibold text-indigo-800 dark:text-indigo-300",children:[Mt.length," card",Mt.length>1?"s":""," selected"]}),Nt.jsx("button",{onClick:()=>kt([]),className:"text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:"Clear selection"})]}),Nt.jsxs("button",{onClick:()=>{const e=window.open("","","width=800,height=600");if(e){const t=new Date,n=t.getDay(),r=0===n?6:n-1,a=new Date(t);a.setDate(t.getDate()-r+7*ie);const i=new Date(a);i.setDate(a.getDate()+6);let s="";Mt.forEach(e=>{const t=re.find(t=>t.userId===e);if(!t)return;let n="";for(let r=0;r<7;r++){const e=new Date(a);e.setDate(a.getDate()+r);const i=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][r],s=t.payrolls.find(t=>{const n=new Date(t.createdAt||t.date),r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(e.getFullYear(),e.getMonth(),e.getDate());return r.getTime()===a.getTime()});s&&(n+=`<div style="display: flex; justify-content: space-between; padding: 2px 0; border-bottom: 1px dotted #ccc;">\n                              <span>${i} ${e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}</span>\n                              <span style="font-weight: bold;">${(s.totalSalary||0).toFixed(2)}</span>\n                            </div>`)}s+=`\n                        <div class="receipt-card">\n                          <div class="header">\n                            <p class="title">WEEKLY PAYROLL</p>\n                            <p class="subtitle">${a.toLocaleDateString()} - ${i.toLocaleDateString()}</p>\n                          </div>\n                          \n                          <div class="section">\n                            <div class="row">\n                              <span style="font-weight: bold;">Employee:</span>\n                              <span>${t.userName}</span>\n                            </div>\n                            <div class="row">\n                              <span style="font-weight: bold;">Username:</span>\n                              <span>@${t.username}</span>\n                            </div>\n                            <div class="row">\n                              <span style="font-weight: bold;">Role:</span>\n                              <span>${t.role.toUpperCase()}</span>\n                            </div>\n                          </div>\n                          \n                          <div class="section">\n                            <div class="section-title">DAILY BREAKDOWN (${t.daysWorked} days)</div>\n                            ${n}\n                          </div>\n                          \n                          <div class="section">\n                            <div class="section-title">WEEKLY SUMMARY</div>\n                            <div class="row">\n                              <span>Base Salary:</span>\n                              <span>${t.totalBaseSalary.toFixed(2)}</span>\n                            </div>\n                            ${t.totalOver>0?`<div class="row"><span>Over:</span><span>+${t.totalOver.toFixed(2)}</span></div>`:""}\n                            ${t.totalShort>0?`<div class="row"><span>Short:</span><span>-${t.totalShort.toFixed(2)}</span></div>`:""}\n                            ${t.totalDeductions>0?`<div class="row"><span>Deduction:</span><span>-${t.totalDeductions.toFixed(2)}</span></div>`:""}\n                            ${t.weeklyPaymentDeductions>0?`<div class="row"><span>Payment Plan:</span><span>-${t.weeklyPaymentDeductions.toFixed(2)}</span></div>`:""}\n                            ${t.shortPaymentPlans&&t.shortPaymentPlans.length>0?t.shortPaymentPlans.map(e=>`<div class="row" style="font-size: 7px; color: #666; padding-left: 5mm;"><span>${e.amount.toFixed(2)}/week</span><span>${e.remaining} weeks left</span></div>`).join(""):""}\n                            ${t.adjustmentsList&&t.adjustmentsList.length>0?`<div class="row" style="font-weight: bold; color: ${t.totalAdjustments>=0?"#2563eb":"#d97706"};"><span>Adjustments:</span><span>${t.totalAdjustments>=0?"+":""}${t.totalAdjustments.toFixed(2)}</span></div>`:""}\n                            ${t.adjustmentsList&&t.adjustmentsList.length>0?t.adjustmentsList.map(e=>`<div class="row" style="font-size: 6px; color: #666; padding-left: 5mm;"><span>${e.reason}</span><span style="color: ${e.delta>=0?"#2563eb":"#d97706"};">${e.delta>=0?"+":""}${e.delta.toFixed(2)}</span></div>`).join(""):""}\n                          </div>\n                          \n                          <div class="total-row">\n                            <div class="row">\n                              <span>NET PAY:</span>\n                              <span>${t.totalNet.toFixed(2)}</span>\n                            </div>\n                          </div>\n                          \n                          <div class="footer">\n                            <p>Generated: ${(new Date).toLocaleString()}</p>\n                            <p style="margin-top: 2mm;">Thank you!</p>\n                          </div>\n                        </div>\n                        `});const o=Et<=2?1:2,l=1===o?"90%":`calc(${100/o}% - 5mm)`,c=Et<=4?"8px":Et<=6?"7px":"6px",d=Et<=4?"11px":Et<=6?"10px":"9px";e.document.write(`\n                        <html>\n                        <head>\n                          <title>Weekly Payroll - Multiple Receipts</title>\n                          <style>\n                            @page { size: A4; margin: 10mm; }\n                            body { \n                              font-family: 'Courier New', monospace; \n                              padding: 0;\n                              margin: 0;\n                              display: flex;\n                              flex-wrap: wrap;\n                              justify-content: space-between;\n                              align-content: flex-start;\n                            }\n                            .receipt-card {\n                              width: ${l};\n                              margin-bottom: ${Et<=4?"8mm":"5mm"};\n                              padding: 3mm;\n                              border: 1px solid #ccc;\n                              page-break-inside: avoid;\n                              font-size: ${c};\n                              line-height: 1.3;\n                              box-sizing: border-box;\n                            }\n                            .receipt-card:nth-child(${Et}n) {\n                              page-break-after: always;\n                            }\n                            .header {\n                              text-align: center;\n                              border-bottom: 2px solid #000;\n                              padding-bottom: 3mm;\n                              margin-bottom: 3mm;\n                            }\n                            .title { font-size: ${d}; font-weight: bold; margin: 0; }\n                            .subtitle { font-size: ${Et<=4?"7px":"6px"}; margin: 2px 0; }\n                            .section { margin: ${Et<=4?"3mm":"2mm"} 0; padding: 2mm 0; border-bottom: 1px dashed #000; }\n                            .section-title { font-weight: bold; margin-bottom: 2mm; font-size: ${Et<=4?"9px":"8px"}; }\n                            .row { display: flex; justify-content: space-between; padding: 1px 0; }\n                            .total-row { \n                              font-weight: bold; \n                              font-size: ${Et<=4?"10px":"9px"}; \n                              padding: 2mm 0;\n                              border-top: 2px solid #000;\n                              border-bottom: 2px solid #000;\n                              margin-top: 2mm;\n                            }\n                            .footer { text-align: center; font-size: ${Et<=4?"7px":"6px"}; margin-top: 3mm; padding-top: 2mm; border-top: 1px solid #000; }\n                          </style>\n                        </head>\n                        <body>\n                          ${s}\n                        </body>\n                        </html>\n                      `),e.document.close(),e.focus(),setTimeout(()=>{e.print(),e.close()},250)}},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold flex items-center gap-2",children:[Nt.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print ",Mt.length," Cards (A4)"]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("label",{className:"text-sm font-medium "+(M?"text-gray-300":"text-gray-700"),children:"Cards per page:"}),Nt.jsx("input",{type:"number",min:"1",max:"12",value:Et,onChange:e=>{const t=parseInt(e.target.value)||4;Tt(Math.min(Math.max(t,1),12))},className:"w-16 px-2 py-1 rounded border text-center "+(M?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900")}),Nt.jsx("span",{className:"text-xs "+(M?"text-gray-400":"text-gray-500"),children:"(1-12)"})]})]}),Nt.jsxs("div",{className:"flex items-center justify-center gap-4",children:[Nt.jsxs("button",{onClick:()=>se(ie-1),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${M?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-700 hover:bg-gray-50"} border ${M?"border-gray-700":"border-gray-200"}`,children:[Nt.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous Week"]}),Nt.jsx("button",{onClick:()=>se(0),disabled:0===ie,className:"px-4 py-2 rounded-lg font-semibold "+(0===ie?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"),children:"Current Week"}),Nt.jsxs("button",{onClick:()=>se(ie+1),className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 ${M?"bg-gray-800 text-gray-200 hover:bg-gray-700":"bg-white text-gray-700 hover:bg-gray-50"} border ${M?"border-gray-700":"border-gray-200"}`,children:["Next Week",Nt.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),E?Nt.jsx("div",{className:"p-6 text-center text-gray-400",children:"Loading weekly summary..."}):0===re.length?Nt.jsx("div",{className:"p-6 text-center text-gray-400",children:"No payroll data for this week."}):Nt.jsxs("div",{children:[Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:re.map(e=>{const t=new Date,n=t.getDay(),r=0===n?6:n-1,a=new Date(t);a.setDate(t.getDate()-r+7*ie);const i=[];for(let s=0;s<7;s++){const t=new Date(a);t.setDate(a.getDate()+s);const n=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][s],r=e.payrolls.find(e=>{const n=new Date(e.createdAt||e.date),r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate());return r.getTime()===a.getTime()});i.push({day:n,date:t.toLocaleDateString("en-US",{month:"short",day:"numeric"}),payroll:r,hasData:!!r})}return Nt.jsxs("div",{id:`receipt-${e.userId}`,className:`receipt-card rounded-lg ${M?"bg-gray-800":"bg-white"} shadow-lg p-4 border ${Mt.includes(e.userId)?"border-indigo-500 border-2":M?"border-gray-700":"border-gray-200"}`,children:[Nt.jsx("div",{className:"flex items-center justify-end mb-2",children:Nt.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:Mt.includes(e.userId),onChange:t=>{t.target.checked?kt([...Mt,e.userId]):kt(Mt.filter(t=>t!==e.userId))},className:"w-4 h-4"}),Nt.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Select for printing"})]})}),Nt.jsxs("div",{className:"border-b pb-3 mb-3",children:[Nt.jsx("h4",{className:"text-lg font-bold",children:e.userName}),Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["@",e.username]}),Nt.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-800 dark:text-indigo-300 rounded text-xs font-semibold",children:e.role})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("p",{className:"text-xs font-semibold mb-2 text-gray-600 dark:text-gray-400",children:"Daily Breakdown:"}),Nt.jsx("div",{className:"space-y-1",children:i.map((t,n)=>{var r;return Nt.jsxs("div",{onClick:()=>{t.hasData&&le({open:!0,payroll:t.payroll,userName:e.userName,date:`${t.day} ${t.date}`})},className:"flex justify-between items-center text-xs py-1 px-2 rounded "+(t.hasData?M?"bg-green-900/20 text-green-400 cursor-pointer hover:bg-green-900/30":"bg-green-50 text-green-700 cursor-pointer hover:bg-green-100":M?"bg-gray-700/50 text-gray-500":"bg-gray-50 text-gray-400"),children:[Nt.jsxs("span",{className:"font-medium",children:[t.day," ",t.date]}),t.hasData?Nt.jsxs("span",{className:"font-bold",children:["",(null==(r=t.payroll.totalSalary)?void 0:r.toFixed(2))||"0.00"]}):Nt.jsx("span",{children:""})]},n)})})]}),Nt.jsxs("div",{className:"border-t pt-3 space-y-1 text-sm",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Days:"}),Nt.jsx("span",{className:"font-bold",children:e.daysWorked})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Base:"}),Nt.jsxs("span",{className:"font-medium",children:["",e.totalBaseSalary.toFixed(2)]})]}),e.totalOver>0&&Nt.jsxs("div",{className:"flex justify-between text-green-600 dark:text-green-400",children:[Nt.jsx("span",{children:"Over:"}),Nt.jsxs("span",{children:["+",e.totalOver.toFixed(2)]})]}),e.totalShort>0&&Nt.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[Nt.jsx("span",{children:"Short:"}),Nt.jsxs("span",{children:["-",e.totalShort.toFixed(2)]})]}),e.totalDeductions>0&&Nt.jsxs("div",{className:"flex justify-between text-orange-600 dark:text-orange-400",children:[Nt.jsx("span",{children:"Deduct:"}),Nt.jsxs("span",{children:["-",e.totalDeductions.toFixed(2)]})]}),e.weeklyPaymentDeductions>0&&Nt.jsxs("div",{className:"space-y-1",children:[Nt.jsxs("div",{className:"flex justify-between text-purple-600 dark:text-purple-400",children:[Nt.jsx("span",{children:"Payment Plan:"}),Nt.jsxs("span",{children:["-",e.weeklyPaymentDeductions.toFixed(2)]})]}),e.shortPaymentPlans&&e.shortPaymentPlans.length>0&&Nt.jsx("div",{className:"pl-4 space-y-0.5",children:e.shortPaymentPlans.map((e,t)=>Nt.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex justify-between",children:[Nt.jsxs("span",{children:["",e.amount.toFixed(2),"/week"]}),Nt.jsxs("span",{children:[e.remaining," weeks left"]})]},t))})]}),e.adjustmentsList&&e.adjustmentsList.length>0&&Nt.jsxs("div",{className:"space-y-1",children:[Nt.jsxs("div",{className:"flex justify-between font-semibold "+(e.totalAdjustments>=0?"text-blue-600 dark:text-blue-400":"text-yellow-600 dark:text-yellow-400"),children:[Nt.jsx("span",{children:"Adjustments:"}),Nt.jsxs("span",{children:[e.totalAdjustments>=0?"+":"","",e.totalAdjustments.toFixed(2)]})]}),Nt.jsx("div",{className:"pl-4 space-y-0.5",children:e.adjustmentsList.map((e,t)=>Nt.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Nt.jsxs("div",{className:"flex justify-between items-start",children:[Nt.jsx("span",{className:"flex-1 pr-2",children:e.reason}),Nt.jsxs("span",{className:"font-semibold whitespace-nowrap "+(e.delta>=0?"text-blue-600 dark:text-blue-400":"text-yellow-600 dark:text-yellow-400"),children:[e.delta>=0?"+":"","",e.delta.toFixed(2)]})]}),Nt.jsx("div",{className:"text-[10px] opacity-60 mt-0.5",children:e.date})]},t))})]})]}),Nt.jsx("div",{className:"border-t-2 mt-3 pt-3",children:Nt.jsxs("div",{className:"flex justify-between items-center bg-indigo-100 dark:bg-indigo-900/30 -mx-2 px-2 py-2 rounded",children:[Nt.jsx("span",{className:"font-bold",children:"NET PAY:"}),Nt.jsxs("span",{className:"font-bold text-lg text-indigo-600 dark:text-indigo-400",children:["",e.totalNet.toFixed(2)]})]})}),Nt.jsxs("div",{className:"mt-3 pt-3 border-t space-y-2",children:[Nt.jsxs("button",{onClick:()=>{const t=window.open("","","width=300,height=600");if(t){const n=new Date,r=n.getDay(),a=0===r?6:r-1,i=new Date(n);i.setDate(n.getDate()-a+7*ie);const s=new Date(i);s.setDate(i.getDate()+6);let o="";for(let t=0;t<7;t++){const n=new Date(i);n.setDate(i.getDate()+t);const r=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],a=e.payrolls.find(e=>{const t=new Date(e.createdAt||e.date),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(n.getFullYear(),n.getMonth(),n.getDate());return r.getTime()===a.getTime()});a&&(o+=`<div style="display: flex; justify-content: space-between; padding: 2px 0; border-bottom: 1px dotted #ccc;">\n                                    <span>${r} ${n.toLocaleDateString("en-US",{month:"short",day:"numeric"})}</span>\n                                    <span style="font-weight: bold;">${(a.totalSalary||0).toFixed(2)}</span>\n                                  </div>`)}t.document.write(`\n                                <html>\n                                <head>\n                                  <title>Weekly Payroll Receipt</title>\n                                  <style>\n                                    @page { size: 58mm auto; margin: 0; }\n                                    body { \n                                      width: 58mm; \n                                      margin: 0; \n                                      padding: 3mm; \n                                      font-family: 'Courier New', monospace; \n                                      font-size: 8px;\n                                      line-height: 1.3;\n                                    }\n                                    .header {\n                                      text-align: center;\n                                      border-bottom: 2px solid #000;\n                                      padding-bottom: 3mm;\n                                      margin-bottom: 3mm;\n                                    }\n                                    .title { font-size: 11px; font-weight: bold; margin: 0; }\n                                    .subtitle { font-size: 7px; margin: 2px 0; }\n                                    .section { margin: 3mm 0; padding: 2mm 0; border-bottom: 1px dashed #000; }\n                                    .section-title { font-weight: bold; margin-bottom: 2mm; font-size: 9px; }\n                                    .row { display: flex; justify-content: space-between; padding: 1px 0; }\n                                    .daily-row { font-size: 7px; }\n                                    .total-row { \n                                      font-weight: bold; \n                                      font-size: 10px; \n                                      padding: 2mm 0;\n                                      border-top: 2px solid #000;\n                                      border-bottom: 2px solid #000;\n                                      margin-top: 2mm;\n                                    }\n                                    .footer { text-align: center; font-size: 7px; margin-top: 3mm; padding-top: 2mm; border-top: 1px solid #000; }\n                                  </style>\n                                </head>\n                                <body>\n                                  <div class="header">\n                                    <p class="title">WEEKLY PAYROLL</p>\n                                    <p class="subtitle">${i.toLocaleDateString()} - ${s.toLocaleDateString()}</p>\n                                  </div>\n                                  \n                                  <div class="section">\n                                    <div class="row">\n                                      <span style="font-weight: bold;">Employee:</span>\n                                      <span>${e.userName}</span>\n                                    </div>\n                                    <div class="row">\n                                      <span style="font-weight: bold;">Username:</span>\n                                      <span>@${e.username}</span>\n                                    </div>\n                                    <div class="row">\n                                      <span style="font-weight: bold;">Role:</span>\n                                      <span>${e.role.toUpperCase()}</span>\n                                    </div>\n                                  </div>\n                                  \n                                  <div class="section">\n                                    <div class="section-title">DAILY BREAKDOWN (${e.daysWorked} days)</div>\n                                    ${o}\n                                  </div>\n                                  \n                                  <div class="section">\n                                    <div class="section-title">WEEKLY SUMMARY</div>\n                                    <div class="row">\n                                      <span>Base Salary:</span>\n                                      <span>${e.totalBaseSalary.toFixed(2)}</span>\n                                    </div>\n                                    ${e.totalOver>0?`<div class="row"><span>Over:</span><span>+${e.totalOver.toFixed(2)}</span></div>`:""}\n                                    ${e.totalShort>0?`<div class="row"><span>Short:</span><span>-${e.totalShort.toFixed(2)}</span></div>`:""}\n                                    ${e.totalDeductions>0?`<div class="row"><span>Deduction:</span><span>-${e.totalDeductions.toFixed(2)}</span></div>`:""}\n                                    ${e.weeklyPaymentDeductions>0?`<div class="row"><span>Payment Plan:</span><span>-${e.weeklyPaymentDeductions.toFixed(2)}</span></div>`:""}\n                                    ${e.adjustmentsList&&e.adjustmentsList.length>0?`<div class="row" style="font-weight: bold; color: ${e.totalAdjustments>=0?"#2563eb":"#d97706"};"><span>Adjustments:</span><span>${e.totalAdjustments>=0?"+":""}${e.totalAdjustments.toFixed(2)}</span></div>`:""}\n                                    ${e.adjustmentsList&&e.adjustmentsList.length>0?e.adjustmentsList.map(e=>`<div class="row" style="font-size: 6px; color: #666; padding-left: 3mm;"><span style="max-width: 35mm; word-wrap: break-word;">${e.reason}</span><span style="color: ${e.delta>=0?"#2563eb":"#d97706"};">${e.delta>=0?"+":""}${e.delta.toFixed(2)}</span></div>`).join(""):""}\n                                  </div>\n                                  \n                                  <div class="total-row">\n                                    <div class="row">\n                                      <span>NET PAY:</span>\n                                      <span>${e.totalNet.toFixed(2)}</span>\n                                    </div>\n                                  </div>\n                                  \n                                  <div class="footer">\n                                    <p>Generated: ${(new Date).toLocaleString()}</p>\n                                    <p style="margin-top: 2mm;">Thank you!</p>\n                                  </div>\n                                </body>\n                                </html>\n                              `),t.document.close(),t.focus(),setTimeout(()=>{t.print(),t.close()},250)}},className:"w-full px-3 py-1.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 flex items-center justify-center gap-2 text-xs no-print",children:[Nt.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print"]}),Nt.jsxs("button",{onClick:()=>{U$(()=>import("./html2canvas.esm-BTH0Ap93.js"),[],import.meta.url).then(t=>{const n=document.getElementById(`receipt-${e.userId}`);if(!n)return;const r=n.cloneNode(!0);r.style.width="58mm",r.style.padding="3mm",r.style.backgroundColor="white",r.style.color="black";r.querySelectorAll("button").forEach(e=>e.remove());const a=document.createElement("div");a.style.position="absolute",a.style.left="-9999px",a.appendChild(r),document.body.appendChild(a);const i=Math.floor(219.2125984278);t.default(r,{width:i,backgroundColor:"#ffffff",scale:2}).then(t=>{const n=document.createElement("a");n.download=`weekly-payroll-${e.username}-${(new Date).toISOString().split("T")[0]}.png`,n.href=t.toDataURL("image/png"),n.click(),document.body.removeChild(a)}).catch(e=>{console.error("Error generating image:",e),document.body.removeChild(a)})}).catch(e=>{console.error("Error loading html2canvas:",e),alert("Failed to load image generator. Please check your internet connection.")})},className:"w-full px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center justify-center gap-2 text-xs no-print",children:[Nt.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download Image (58mm)"]})]})]},e.userId)})}),Nt.jsxs("div",{className:`receipt-card rounded-lg ${M?"bg-gray-900":"bg-gray-50"} shadow-lg p-6 border-2 ${M?"border-indigo-600":"border-indigo-500"}`,children:[Nt.jsxs("div",{className:"text-center border-b pb-3 mb-4",children:[Nt.jsx("h4",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:"WEEKLY TOTALS"}),Nt.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[re.length," Employee",1!==re.length?"s":"","  ",re.reduce((e,t)=>e+t.daysWorked,0)," Total Days"]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[Nt.jsxs("div",{className:"text-center p-3 bg-white dark:bg-gray-800 rounded-lg",children:[Nt.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Base Salary"}),Nt.jsxs("p",{className:"font-bold text-lg",children:["",re.reduce((e,t)=>e+t.totalBaseSalary,0).toFixed(2)]})]}),Nt.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[Nt.jsx("p",{className:"text-xs text-green-700 dark:text-green-400 mb-1",children:"Over"}),Nt.jsxs("p",{className:"font-bold text-lg text-green-600 dark:text-green-400",children:["",re.reduce((e,t)=>e+t.totalOver,0).toFixed(2)]})]}),Nt.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[Nt.jsx("p",{className:"text-xs text-red-700 dark:text-red-400 mb-1",children:"Short"}),Nt.jsxs("p",{className:"font-bold text-lg text-red-600 dark:text-red-400",children:["",re.reduce((e,t)=>e+t.totalShort,0).toFixed(2)]})]}),Nt.jsxs("div",{className:"text-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[Nt.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-400 mb-1",children:"Payment Plan"}),Nt.jsxs("p",{className:"font-bold text-lg text-purple-600 dark:text-purple-400",children:["",re.reduce((e,t)=>e+t.weeklyPaymentDeductions,0).toFixed(2)]})]})]}),Nt.jsxs("div",{className:"bg-indigo-600 dark:bg-indigo-700 text-white p-4 rounded-lg text-center",children:[Nt.jsx("p",{className:"text-sm mb-1",children:"TOTAL NET PAYROLL"}),Nt.jsxs("p",{className:"font-bold text-3xl",children:["",re.reduce((e,t)=>e+t.totalNet,0).toFixed(2)]})]}),Nt.jsx("div",{className:"text-center mt-4 text-xs text-gray-500 dark:text-gray-400",children:Nt.jsxs("p",{children:["Generated: ",(new Date).toLocaleString()]})})]})]}),oe.open&&oe.payroll&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",children:Nt.jsxs("div",{className:"w-full max-w-md rounded-xl p-6 "+(M?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h3",{className:"text-lg font-bold",children:"Daily Payroll Details"}),Nt.jsx("button",{onClick:()=>le({open:!1,payroll:null,userName:"",date:""}),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:Nt.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{className:"border-b pb-3",children:[Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Employee"}),Nt.jsx("p",{className:"text-lg font-bold",children:oe.userName}),Nt.jsx("p",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:oe.date})]}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Role:"}),Nt.jsx("span",{className:"font-semibold capitalize",children:oe.payroll.role})]}),Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Base Salary:"}),Nt.jsxs("span",{className:"font-bold",children:["",(oe.payroll.baseSalary||0).toFixed(2)]})]}),oe.payroll.daysPresent&&oe.payroll.daysPresent>0&&Nt.jsxs("div",{className:"flex justify-between items-center text-sm",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Days Present:"}),Nt.jsx("span",{className:"font-semibold",children:oe.payroll.daysPresent})]}),oe.payroll.over>0&&Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsxs("div",{className:"flex justify-between items-center text-green-600 dark:text-green-400",children:[Nt.jsx("span",{children:"Over:"}),Nt.jsxs("span",{className:"font-bold",children:["+",oe.payroll.over.toFixed(2)]})]}),oe.payroll.daysPresent&&oe.payroll.daysPresent>0&&Nt.jsxs("div",{className:"flex justify-between items-center text-green-500 dark:text-green-500 text-xs",children:[Nt.jsx("span",{className:"italic",children:"Over Per Day:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(oe.payroll.over/oe.payroll.daysPresent).toFixed(2)]})]})]}),oe.payroll.short>0&&Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsxs("div",{className:"flex justify-between items-center text-red-600 dark:text-red-400",children:[Nt.jsx("span",{children:"Short:"}),Nt.jsxs("span",{className:"font-bold",children:["-",oe.payroll.short.toFixed(2)]})]}),oe.payroll.daysPresent&&oe.payroll.daysPresent>0&&Nt.jsxs("div",{className:"flex justify-between items-center text-red-500 dark:text-red-500 text-xs",children:[Nt.jsx("span",{className:"italic",children:"Short Per Day:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(oe.payroll.short/oe.payroll.daysPresent).toFixed(2)]})]})]}),oe.payroll.deduction>0&&Nt.jsxs("div",{className:"flex justify-between items-center text-orange-600 dark:text-orange-400",children:[Nt.jsx("span",{children:"Deduction:"}),Nt.jsxs("span",{className:"font-bold",children:["-",oe.payroll.deduction.toFixed(2)]})]}),Nt.jsx("div",{className:"border-t pt-3 mt-3",children:Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("span",{className:"text-lg font-bold",children:"Total Salary:"}),Nt.jsxs("span",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:["",(oe.payroll.totalSalary||0).toFixed(2)]})]})}),void 0!==oe.payroll.approved&&Nt.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),Nt.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-semibold "+(oe.payroll.approved?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"),children:oe.payroll.approved?"Approved":"Pending"})]}),oe.payroll.notes&&Nt.jsxs("div",{className:"pt-2 border-t",children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Notes:"}),Nt.jsx("p",{className:"text-sm italic",children:oe.payroll.notes})]})]}),Nt.jsx("div",{className:"pt-4",children:Nt.jsx("button",{onClick:()=>le({open:!1,payroll:null,userName:"",date:""}),className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 font-semibold",children:"Close"})})]})]})})]}),"weekly-summary"!==H&&Nt.jsxs("div",{className:`rounded-lg ${M?"bg-gray-800":"bg-white"} shadow p-4`,children:[Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:""+(M?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-3 text-left",children:"Employee"}),Nt.jsx("th",{className:"p-3 text-left",children:"Role"}),Nt.jsx("th",{className:"p-3 text-right",children:"Base"}),Nt.jsx("th",{className:"p-3 text-right",children:"Total"}),Nt.jsx("th",{className:"p-3 text-right",children:"Over"}),Nt.jsx("th",{className:"p-3 text-right",children:"Over/Day"}),Nt.jsx("th",{className:"p-3 text-right",children:"Short"}),Nt.jsx("th",{className:"p-3 text-right",children:"Deduction"}),Nt.jsx("th",{className:"p-3 text-center",children:"Status"}),Nt.jsx("th",{className:"p-3 text-center",children:"Actions"})]})}),Nt.jsx("tbody",{children:E?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:10,className:"p-6 text-center text-gray-400",children:"Loading..."})}):0===Ot.length?Nt.jsx("tr",{children:Nt.jsx("td",{colSpan:10,className:"p-6 text-center text-gray-400",children:"No payroll records found."})}):Ot.map(e=>{var t,n,r,a,i,s,o,l,c,d;const u=(e=>e.locked?{color:"bg-gray-600 text-white",text:"Locked"}:e.approved?e.approved?{color:"bg-green-500 text-white",text:"Approved"}:{color:"bg-gray-400 text-white",text:"Unknown"}:{color:"bg-yellow-400 text-black",text:"Pending"})(e);return Nt.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsx("td",{className:"p-3",children:Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-500",children:Nt.jsx(Oe,{className:"w-4 h-4"})}),Nt.jsxs("div",{children:[Nt.jsx("button",{onClick:()=>Ut(e),className:"font-semibold hover:text-indigo-600 dark:hover:text-indigo-400 text-left transition-colors cursor-pointer underline decoration-dotted",children:(null==(t=e.user)?void 0:t.name)||(null==(n=e.user)?void 0:n.username)}),Nt.jsx("div",{className:"text-xs opacity-70",children:null==(r=e.user)?void 0:r.username})]})]})}),Nt.jsx("td",{className:"p-3",children:e.role}),"none"!==te&&Nt.jsx("td",{className:"p-3",children:"weekly"===te?Nt.jsxs("span",{className:"text-xs",children:["Week of ",new Date(e.period).toLocaleDateString()]}):Nt.jsx("span",{className:"text-xs",children:e.period})}),Nt.jsxs("td",{className:"p-3 text-right",children:["",((null!=(a=e.baseSalary)?a:e.base)||0).toLocaleString()]}),Nt.jsxs("td",{className:"p-3 text-right font-semibold",children:["",(null!=(i=e.totalSalary)?i:0).toLocaleString()]}),Nt.jsxs("td",{className:"p-3 text-right",children:["",(null!=(s=e.over)?s:0).toLocaleString()]}),Nt.jsx("td",{className:"p-3 text-right text-green-600 dark:text-green-400 font-semibold",children:e.daysPresent&&e.daysPresent>0?`${((null!=(o=e.over)?o:0)/e.daysPresent).toFixed(2)}`:"-"}),Nt.jsxs("td",{className:"p-3 text-right",children:["",(null!=(l=e.short)?l:0).toLocaleString()]}),Nt.jsxs("td",{className:"p-3 text-right",children:["",(null!=(d=null!=(c=e.deduction)?c:e.totalDeductions)?d:0).toLocaleString()]}),Nt.jsx("td",{className:"p-3 text-center",children:Nt.jsx("span",{className:`px-3 py-1 rounded-full text-xs ${u.color}`,children:u.text})}),Nt.jsx("td",{className:"p-3 text-center",children:Nt.jsxs("div",{className:"flex items-center justify-center gap-2",children:[!e.approved&&!e.locked&&Nt.jsxs("button",{title:"Approve",onClick:()=>{return t=e,h(null,null,function*(){var e,n;if((null==t?void 0:t._id)&&confirm(`Approve payroll for ${(null==(e=t.user)?void 0:e.name)||(null==(n=t.user)?void 0:n.username)||"user"}?`))try{Fe(!0),yield pt.put(`${zc()}/api/payroll/${t._id}/approve`,{adminId:null==_?void 0:_._id}),C({type:"success",message:"Payroll approved."});try{const e=Vc();e&&e.emit("payrollApproved")}catch(bI){}yield Rt()}catch(r){console.error("Approve error",r),C({type:"error",message:"Failed to approve payroll."})}finally{Fe(!1)}});var t},disabled:Le,className:"px-2 py-1 rounded-md bg-green-600 text-white text-xs hover:opacity-90",children:[Nt.jsx(O,{className:"inline-block mr-1 w-3 h-3"})," Approve"]}),e.approved&&!e.locked&&Nt.jsxs("button",{title:"Disapprove",onClick:()=>{return t=e,h(null,null,function*(){var e,n;if((null==t?void 0:t._id)&&confirm(`Set payroll to pending for ${(null==(e=t.user)?void 0:e.name)||(null==(n=t.user)?void 0:n.username)||"user"}? This will exclude it from total payout.`))try{Fe(!0),yield pt.put(`${zc()}/api/payroll/${t._id}/disapprove`,{adminId:null==_?void 0:_._id}),C({type:"success",message:"Payroll set to pending."});try{const e=Vc();e&&e.emit("payrollDisapproved")}catch(bI){}yield Rt()}catch(r){console.error("Disapprove error",r),C({type:"error",message:"Failed to disapprove payroll."})}finally{Fe(!1)}});var t},disabled:Le,className:"px-2 py-1 rounded-md bg-orange-600 text-white text-xs hover:opacity-90",children:[Nt.jsx(ce,{className:"inline-block mr-1 w-3 h-3"})," Disapprove"]}),!e.locked&&Nt.jsxs("button",{title:"Adjust",onClick:()=>{return Ce({open:!0,payroll:t=e}),ze("add"),Ge(""),$e(""),void Ye(t.shortPaymentTerms||"1");var t},className:`px-2 py-1 rounded-md ${M?"bg-gray-700 text-white":"bg-gray-100 text-gray-800"} text-xs hover:opacity-90`,children:[Nt.jsx(Pe,{className:"inline-block mr-1 w-3 h-3"})," Adjust"]}),!e.locked&&("admin"===(null==_?void 0:_.role)||"super_admin"===(null==_?void 0:_.role))&&Nt.jsxs("button",{title:"Override",onClick:()=>(e=>{var t;if("none"!==te&&e._id&&"string"==typeof e._id&&e._id.includes("|"))return void C({type:"warning",message:"Cannot override consolidated records. Set view to 'Daily' to override individual payrolls."});Te({open:!0,payroll:e}),Ke(""),Je(""),tt((null==(t=e.baseSalary)?void 0:t.toString())||"");const n=new Date(e.createdAt||e.date);Ze(n.toISOString().split("T")[0])})(e),className:"px-2 py-1 rounded-md bg-purple-600 text-white text-xs hover:opacity-90",children:[Nt.jsx(xe,{className:"inline-block mr-1 w-3 h-3"})," Override"]}),Nt.jsxs("button",{title:"View",onClick:()=>Ut(e),className:`px-2 py-1 rounded-md ${M?"bg-gray-700 text-white":"bg-gray-100 text-gray-800"} text-xs hover:opacity-90`,children:[Nt.jsx(ye,{className:"inline-block mr-1 w-3 h-3"})," View"]}),Nt.jsxs("button",{title:e.locked?"Unlock":"Lock",onClick:()=>{return t=e,h(null,null,function*(){var e,n,r,a;if(!t)return;const i=!t.locked,s=i?`Lock payroll for ${(null==(e=t.user)?void 0:e.name)||(null==(n=t.user)?void 0:n.username)}? Locked payroll cannot be edited.`:`Unlock payroll for ${(null==(r=t.user)?void 0:r.name)||(null==(a=t.user)?void 0:a.username)}?`;if(confirm(s))try{Fe(!0),yield pt.put(`${zc()}/api/payroll/${t._id}/adjust`,{delta:0,reason:i?"Locked by admin":"Unlocked by admin",adminId:null==_?void 0:_._id});try{const e=Vc();e&&e.emit("payrollLocked")}catch(bI){}yield Rt(),C({type:"success",message:i?"Payroll locked.":"Payroll unlocked."})}catch(o){console.error("Lock/Unlock error",o),C({type:"error",message:"Failed to toggle lock."})}finally{Fe(!1)}});var t},className:`px-2 py-1 rounded-md ${e.locked?"bg-gray-600 text-white":"bg-gray-100 text-gray-800"} text-xs hover:opacity-90`,children:[e.locked?Nt.jsx(ge,{className:"inline-block mr-1 w-3 h-3"}):Nt.jsx(Be,{className:"inline-block mr-1 w-3 h-3"})," ",e.locked?"Unlock":"Lock"]}),("admin"===(null==_?void 0:_.role)||"super_admin"===(null==_?void 0:_.role))&&Nt.jsxs("button",{title:"Delete",onClick:()=>{return t=e,h(null,null,function*(){var e,n,r,a;if(!t)return;const i=`Are you sure you want to delete payroll for ${(null==(e=t.user)?void 0:e.name)||(null==(n=t.user)?void 0:n.username)}?\n\nThis action cannot be undone!`;if(confirm(i))try{Fe(!0),yield pt.delete(`${zc()}/api/payroll/${t._id}`);try{const e=Vc();e&&e.emit("payrollDeleted")}catch(bI){}yield Rt(),C({type:"success",message:"Payroll deleted successfully."})}catch(s){console.error("Delete payroll error",s),C({type:"error",message:(null==(a=null==(r=s.response)?void 0:r.data)?void 0:a.message)||"Failed to delete payroll."})}finally{Fe(!1)}});var t},className:"px-2 py-1 rounded-md bg-red-600 text-white text-xs hover:bg-red-700",children:[Nt.jsx(R,{className:"inline-block mr-1 w-3 h-3"})," Delete"]})]})})]},e._id)})})]})}),Nt.jsxs("div",{className:"mt-4 p-4 rounded-lg "+(M?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"flex items-center justify-between mb-2",children:Nt.jsx("h3",{className:"font-semibold text-sm",children:"Daily View Totals"})}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-gray-500 text-xs",children:"Total Records"}),Nt.jsx("div",{className:"font-semibold",children:Ft.totalRecords})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-gray-500 text-xs",children:"Approved"}),Nt.jsx("div",{className:"font-semibold text-green-600",children:Ft.approvedRecords})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-gray-500 text-xs",children:"Pending"}),Nt.jsx("div",{className:"font-semibold text-yellow-600",children:Ft.pendingRecords})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-gray-500 text-xs",children:"Total Payout (Approved)"}),Nt.jsxs("div",{className:"font-semibold text-indigo-600",children:["",Ft.totalPayout.toLocaleString()]})]})]}),Ft.dailyBreakdown&&Ft.dailyBreakdown.length>0&&Nt.jsxs("div",{className:"mt-4",children:[Nt.jsx("h4",{className:"font-semibold text-xs mb-2 text-gray-500",children:"Breakdown by Date"}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-xs",children:[Nt.jsx("thead",{className:""+(M?"bg-gray-800":"bg-gray-200"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-2 text-left",children:"Date"}),Nt.jsx("th",{className:"p-2 text-center",children:"Records"}),Nt.jsx("th",{className:"p-2 text-right",children:"Base"}),Nt.jsx("th",{className:"p-2 text-right",children:"Over"}),Nt.jsx("th",{className:"p-2 text-right",children:"Short"}),Nt.jsx("th",{className:"p-2 text-right",children:"Payout"})]})}),Nt.jsx("tbody",{children:Ft.dailyBreakdown.map((e,t)=>Nt.jsxs("tr",{className:""+(M?"hover:bg-gray-800":"hover:bg-gray-50"),children:[Nt.jsx("td",{className:"p-2 font-medium",children:e.date}),Nt.jsxs("td",{className:"p-2 text-center",children:[Nt.jsx("span",{className:"text-green-600",children:e.approved}),e.pending>0&&Nt.jsxs("span",{className:"text-yellow-600",children:[" / ",e.pending]})]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",e.base.toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right text-green-600",children:["",e.over.toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right text-red-600",children:["",e.short.toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right font-semibold text-indigo-600",children:["",e.totalPayout.toLocaleString()]})]},t))})]})})]})]})]}),Ae.open&&Ae.payroll&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",children:Nt.jsxs("div",{className:"w-full max-w-lg rounded-xl p-6 "+(M?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h3",{className:"text-lg font-semibold",children:"Adjust Payroll"}),Nt.jsx("button",{onClick:()=>Ce({open:!1,payroll:null}),className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700",children:Nt.jsx(ce,{})})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Employee"}),Nt.jsx("div",{className:"font-semibold",children:(null==(i=Ae.payroll.user)?void 0:i.name)||(null==(s=Ae.payroll.user)?void 0:s.username)})]}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Type"}),Nt.jsxs("div",{className:"mt-2 flex gap-2",children:[Nt.jsxs("label",{className:"py-2 px-3 rounded-lg cursor-pointer "+("add"===Ue?"bg-indigo-600 text-white":M?"bg-gray-700 text-gray-100":"bg-gray-100 text-gray-800"),children:[Nt.jsx("input",{type:"radio",className:"hidden",checked:"add"===Ue,onChange:()=>ze("add")}),"Add"]}),Nt.jsxs("label",{className:"py-2 px-3 rounded-lg cursor-pointer "+("deduct"===Ue?"bg-red-600 text-white":M?"bg-gray-700 text-gray-100":"bg-gray-100 text-gray-800"),children:[Nt.jsx("input",{type:"radio",className:"hidden",checked:"deduct"===Ue,onChange:()=>ze("deduct")}),"Deduct"]})]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Amount"}),Nt.jsx("input",{type:"number",value:He,onChange:e=>Ge(e.target.value),className:"mt-2 w-full p-2 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),placeholder:"Enter amount"})]})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Reason"}),Nt.jsx("textarea",{value:Ve,onChange:e=>$e(e.target.value),className:"mt-2 w-full p-2 rounded-lg border resize-none "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),rows:3,placeholder:"Enter reason (required for audit)..."})]}),Ae.payroll.short>0&&Nt.jsxs("div",{className:"mb-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800",children:[Nt.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:[" Payment Terms for Short (",Ae.payroll.short.toLocaleString(),")"]}),Nt.jsx("input",{type:"number",min:"1",value:We,onChange:e=>Ye(e.target.value),className:"w-full p-2 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"),placeholder:"Number of weeks"}),Nt.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:We>1?Nt.jsxs("span",{className:"text-orange-600 dark:text-orange-400 font-semibold",children:["",(Ae.payroll.short/parseInt(We)).toFixed(2),"/week for ",We," weeks"]}):"Deduct the full short amount this week"})]}),Nt.jsxs("div",{className:"flex justify-end gap-3",children:[Nt.jsx("button",{onClick:()=>Ce({open:!1,payroll:null}),className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700",children:"Cancel"}),Nt.jsx("button",{onClick:()=>{var e;const t=parseFloat(He),n=!isNaN(t)&&t>0,r=(null==(e=Ae.payroll)?void 0:e.short)>0&&We;if(!n&&!r)return void C({type:"warning",message:"Enter a valid amount or set payment terms."});const a=n?"add"===Ue?Math.abs(t):-Math.abs(t):0;ke({open:!0,payroll:Ae.payroll,payload:{delta:a,reason:Ve}})},className:"px-4 py-2 rounded-lg bg-indigo-600 text-white",children:"Proceed"})]})]})}),De&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",children:Nt.jsxs("div",{className:"w-full max-w-2xl rounded-xl p-6 max-h-[90vh] overflow-y-auto "+(M?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(xe,{className:"text-purple-500"}),"Create Payroll Override"]}),Nt.jsx("button",{onClick:()=>Re(!1),className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700",children:Nt.jsx(ce,{})})]}),Nt.jsx("div",{className:"mb-4 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800",children:Nt.jsx("div",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Create a new payroll entry for a user with custom base salary, over/short amounts, and reason."})}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Select User *"}),Nt.jsxs("select",{value:at,onChange:e=>it(e.target.value),className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),children:[Nt.jsx("option",{value:"",children:"-- Select User --"}),vt.map(e=>Nt.jsxs("option",{value:e._id,children:[e.name||e.username," (",e.role,")"]},e._id))]})]})}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Select Date Range *"}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-xs text-gray-500",children:"Start Date"}),Nt.jsx("input",{type:"date",value:jt,onChange:e=>(e=>{if(_t(e),e&&At){const t=zt(e,At);St(t)}})(e.target.value),className:"w-full p-2 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-xs text-gray-500",children:"End Date"}),Nt.jsx("input",{type:"date",value:At,onChange:e=>(e=>{if(Ct(e),jt&&e){const t=zt(jt,e);St(t)}})(e.target.value),className:"w-full p-2 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")})]})]}),wt.length>0&&Nt.jsxs("div",{className:"p-3 rounded-lg border max-h-40 overflow-y-auto "+(M?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:[Nt.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Selected Dates (",wt.length,"):"]}),Nt.jsx("div",{className:"grid grid-cols-3 gap-2",children:wt.map(e=>Nt.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 p-1 rounded",children:[Nt.jsx("input",{type:"checkbox",checked:!0,onChange:()=>(e=>{St(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),className:"rounded"}),Nt.jsx("span",{children:new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},e))})]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Base Salary *"}),Nt.jsx("input",{type:"number",step:"0.01",value:lt,onChange:e=>ct(e.target.value),placeholder:"450.00",className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Over Amount"}),Nt.jsx("input",{type:"number",step:"0.01",value:dt,onChange:e=>ut(e.target.value),placeholder:"0.00",className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Short Amount"}),Nt.jsx("input",{type:"number",step:"0.01",value:ht,onChange:e=>mt(e.target.value),placeholder:"0.00",className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Payment Terms (Weeks)"}),Nt.jsx("input",{type:"number",min:"1",value:gt,onChange:e=>ft(e.target.value),placeholder:"1",className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")}),Nt.jsx("div",{className:"text-xs text-gray-400 mt-1",children:ht&&gt>1?Nt.jsxs("span",{className:"text-orange-500",children:["",(parseFloat(ht)/parseInt(gt)).toFixed(2),"/week for ",gt," weeks"]}):"Number of weeks to deduct the short amount"})]})]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Reason *"}),Nt.jsx("textarea",{value:xt,onChange:e=>yt(e.target.value),className:"w-full p-3 rounded-lg border resize-none "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),rows:3,placeholder:"Explain why this payroll override is being created (e.g., Manual correction, Missed day entry, etc.)"})]}),at&&lt&&wt.length>0&&Nt.jsxs("div",{className:"mb-4 p-3 rounded-lg "+(M?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"text-sm font-semibold mb-2",children:"Preview (Per Day)"}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Nt.jsx("div",{children:"Base Salary:"}),Nt.jsxs("div",{className:"font-semibold",children:["",parseFloat(lt||0).toFixed(2)]}),Nt.jsx("div",{children:"Over:"}),Nt.jsxs("div",{className:"text-green-600 font-semibold",children:["+",parseFloat(dt||0).toFixed(2)]}),Nt.jsx("div",{children:"Short:"}),Nt.jsxs("div",{className:"text-red-600 font-semibold",children:["-",parseFloat(ht||0).toFixed(2)]}),Nt.jsx("div",{className:"border-t pt-2 font-bold",children:"Total Per Day:"}),Nt.jsxs("div",{className:"border-t pt-2 font-bold text-indigo-600",children:["",(parseFloat(lt||0)+parseFloat(dt||0)-parseFloat(ht||0)).toFixed(2)]}),Nt.jsx("div",{className:"border-t pt-2 font-bold text-purple-600",children:"Number of Days:"}),Nt.jsxs("div",{className:"border-t pt-2 font-bold text-purple-600",children:[wt.length," days"]}),Nt.jsx("div",{className:"border-t pt-2 font-bold text-lg",children:"Grand Total:"}),Nt.jsxs("div",{className:"border-t pt-2 font-bold text-lg text-green-600",children:["",((parseFloat(lt||0)+parseFloat(dt||0)-parseFloat(ht||0))*wt.length).toFixed(2)]})]})]}),Nt.jsxs("div",{className:"flex justify-end gap-3",children:[Nt.jsx("button",{onClick:()=>Re(!1),className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t,n;if(at)if(0!==wt.length)if(!lt||parseFloat(lt)<=0)C({type:"warning",message:"Please enter a valid base salary."});else if(xt.trim())try{Fe(!0);const t=vt.find(e=>e._id===at);let n=0,i=0;for(const s of wt)try{const a=yield pt.post(`${zc()}/api/payroll/create-override`,{userId:at,date:s,baseSalary:parseFloat(lt),over:parseFloat(dt)||0,short:parseFloat(ht)||0,shortPaymentTerms:parseInt(gt)||1,reason:xt,role:(null==t?void 0:t.role)||"teller",adminId:null==_?void 0:_._id}),i=parseFloat(ht)||0,o=parseInt(gt)||1;if(i>0&&o>1&&(null==(e=a.data)?void 0:e.payroll))try{yield pt.post(`${zc()}/api/short-payments/create`,{userId:at,originPayrollId:a.data.payroll._id,totalAmount:i,weeksTotal:o,startDate:s,note:`Payment plan from admin override: ${xt}`}),console.log(` Created payment plan for ${(null==t?void 0:t.name)||(null==t?void 0:t.username)}`)}catch(r){console.error("Failed to create payment plan:",r)}n++}catch(a){console.error(`Failed to create override for ${s}:`,a),i++}C(n>0?{type:"success",message:`Created ${n} payroll override(s) for ${(null==t?void 0:t.name)||(null==t?void 0:t.username)}.${i>0?` ${i} failed (may already exist).`:""}`}:{type:"error",message:"Failed to create overrides. Payrolls may already exist for these dates."});try{const e=Vc();e&&e.emit("payrollAdjusted")}catch(bI){}Re(!1),yield Rt()}catch(a){console.error("Create override error:",a),C({type:"error",message:(null==(n=null==(t=a.response)?void 0:t.data)?void 0:n.message)||"Failed to create override."})}finally{Fe(!1)}else C({type:"warning",message:"Please provide a reason for this override."});else C({type:"warning",message:"Please select at least one date."});else C({type:"warning",message:"Please select a user."})}),disabled:Le,className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-50",children:Le?"Creating...":"Create Override"})]})]})}),Ee.open&&Ee.payroll&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",children:Nt.jsxs("div",{className:"w-full max-w-lg rounded-xl p-6 "+(M?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(xe,{className:"text-purple-500"}),"Payroll Override (Super Admin)"]}),Nt.jsx("button",{onClick:()=>Te({open:!1,payroll:null}),className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700",children:Nt.jsx(ce,{})})]}),Nt.jsx("div",{className:"mb-4 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800",children:Nt.jsx("div",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Override allows you to add or deduct any amount from the payroll with a specific reason. This will be visible to all users viewing payroll."})}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Employee"}),Nt.jsx("div",{className:"font-semibold",children:(null==(o=Ee.payroll.user)?void 0:o.name)||(null==(l=Ee.payroll.user)?void 0:l.username)}),Nt.jsxs("div",{className:"text-xs opacity-70",children:["Current Total: ",(null!=(c=Ee.payroll.totalSalary)?c:0).toLocaleString()]})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Base Salary"}),Nt.jsx("input",{type:"number",step:"0.01",value:et,onChange:e=>tt(e.target.value),className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),placeholder:"Enter base salary"}),Nt.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Adjust the base salary if needed"})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Override Date"}),Nt.jsx("input",{type:"date",value:Qe,onChange:e=>Ze(e.target.value),className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")}),Nt.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Specify which date this override applies to"})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Override Amount"}),Nt.jsx("input",{type:"number",step:"0.01",value:Xe,onChange:e=>Ke(e.target.value),className:"w-full p-3 rounded-lg border "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),placeholder:"Enter amount (e.g., 500 or -200)"}),Nt.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Use positive numbers to add, negative to deduct"})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Reason (Required)"}),Nt.jsx("textarea",{value:qe,onChange:e=>Je(e.target.value),className:"w-full p-3 rounded-lg border resize-none "+(M?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200"),rows:3,placeholder:"Explain why this override is necessary (e.g., Bonus for exceptional performance, Correction for reporting error, etc.)"})]}),Nt.jsxs("div",{className:"flex justify-end gap-3",children:[Nt.jsx("button",{onClick:()=>Te({open:!1,payroll:null}),className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;const n=parseFloat(Xe);if(isNaN(n)||0===n)return void C({type:"warning",message:"Enter a valid amount (can be positive or negative)."});if(!qe.trim())return void C({type:"warning",message:"Please provide a reason for this override."});const r=parseFloat(et);if(isNaN(r)||r<0)return void C({type:"warning",message:"Please enter a valid base salary."});const{payroll:a}=Ee;if(a)try{Fe(!0),yield pt.put(`${zc()}/api/payroll/${a._id}/adjust`,{delta:n,baseSalary:r,reason:`[OVERRIDE] ${qe} (Date: ${new Date(Qe).toLocaleDateString()})`,adminId:null==_?void 0:_._id,overrideDate:Qe}),C({type:"success",message:`Override applied: ${n>=0?"+":""}${n.toFixed(2)} for ${(null==(e=a.user)?void 0:e.name)||(null==(t=a.user)?void 0:t.username)} on ${new Date(Qe).toLocaleDateString()}.`});try{const e=Vc();e&&e.emit("payrollAdjusted")}catch(bI){}Te({open:!1,payroll:null}),yield Rt()}catch(i){console.error("Override error:",i),C({type:"error",message:"Failed to apply override."})}finally{Fe(!1)}}),disabled:Le,className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-50",children:Le?"Processing...":"Apply Override"})]})]})}),Me.open&&Me.payroll&&Me.payload&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",children:Nt.jsxs("div",{className:"w-full max-w-md rounded-xl p-6 "+(M?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Confirm Adjustment"}),Nt.jsxs("div",{className:"text-sm mb-4",children:[0!==Me.payload.delta&&Nt.jsxs("p",{className:"mb-2",children:["Are you sure you want to ",Nt.jsx("strong",{children:Me.payload.delta>0?"add":"deduct"})," ",Nt.jsxs("strong",{children:["",Math.abs(Me.payload.delta).toFixed(2)]})," for"," ",Nt.jsx("strong",{children:(null==(d=Me.payroll.user)?void 0:d.name)||(null==(u=Me.payroll.user)?void 0:u.username)}),"?"]}),Me.payroll.short>0&&We&&Nt.jsxs("p",{className:"p-2 rounded bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800",children:[Nt.jsx("strong",{children:"Payment Terms:"})," Short of ",Me.payroll.short.toLocaleString()," will be deducted over"," ",Nt.jsxs("strong",{children:[We," week",We>1?"s":""]}),We>1&&` (${(Me.payroll.short/parseInt(We)).toFixed(2)}/week)`]})]}),Nt.jsxs("div",{className:"flex justify-end gap-3",children:[Nt.jsx("button",{onClick:()=>ke({open:!1,payroll:null,payload:null}),className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t,n,r;const{payload:a,payroll:i}=Me;if(i&&a)try{Fe(!0);const o={delta:a.delta,reason:a.reason||"",adminId:null==_?void 0:_._id};if(We&&We!==String(i.shortPaymentTerms||1)&&(o.shortPaymentTerms=parseInt(We)||1),yield pt.put(`${zc()}/api/payroll/${i._id}/adjust`,o),i.short>0&&We&&parseInt(We)>1)try{yield pt.post(`${zc()}/api/short-payments/create`,{userId:i.user._id,originPayrollId:i._id,totalAmount:i.short,weeksTotal:parseInt(We),startDate:new Date,note:`Payment plan set by admin: ${a.reason||"Payment terms adjusted"}`}),console.log(` Created payment plan for ${(null==(e=i.user)?void 0:e.name)||(null==(t=i.user)?void 0:t.username)}`)}catch(s){console.error("Failed to create payment plan:",s)}C({type:"success",message:`Adjusted ${a.delta.toFixed(2)} for ${(null==(n=i.user)?void 0:n.name)||(null==(r=i.user)?void 0:r.username)}.`});try{const e=Vc();e&&e.emit("payrollAdjusted")}catch(bI){}ke({open:!1,payroll:null,payload:null}),Ce({open:!1,payroll:null}),yield Rt()}catch(o){console.error("Adjust error:",o),C({type:"error",message:"Failed to adjust payroll."})}finally{Fe(!1)}}),disabled:Le,className:"px-4 py-2 rounded-lg bg-green-600 text-white",children:Le?"Processing...":"Confirm"})]})]})}),Se&&Nt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4 overflow-y-auto",children:Nt.jsxs("div",{className:"w-full max-w-3xl rounded-xl p-6 my-8 "+(M?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h3",{className:"text-lg font-semibold",children:"Payroll Details"}),Nt.jsx("button",{onClick:()=>je(null),className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700",children:Nt.jsx(ce,{})})]}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Employee"}),Nt.jsx("div",{className:"font-semibold",children:(null==(p=Se.user)?void 0:p.name)||(null==(m=Se.user)?void 0:m.username)}),Nt.jsx("div",{className:"text-xs opacity-70",children:null==(g=Se.user)?void 0:g.username})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Role"}),Nt.jsx("div",{className:"font-semibold",children:Se.role}),Nt.jsx("div",{className:"text-sm text-gray-400",children:"Date"}),Nt.jsx("div",{children:new Date(Se.createdAt||Se.date).toLocaleDateString()})]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Base Salary"}),Nt.jsxs("div",{className:"font-semibold",children:["",(null!=(x=Se.baseSalary)?x:0).toLocaleString()]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Total Salary"}),Nt.jsxs("div",{className:"font-semibold",children:["",(null!=(y=Se.totalSalary)?y:0).toLocaleString()]})]}),Se.daysPresent&&Se.daysPresent>0&&Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Days Present"}),Nt.jsxs("div",{className:"font-semibold",children:[Se.daysPresent," day",1!==Se.daysPresent?"s":""]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Over"}),Nt.jsxs("div",{children:["",(null!=(v=Se.over)?v:0).toLocaleString()]})]}),Se.over>0&&Se.daysPresent&&Se.daysPresent>0&&Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Over Per Day"}),Nt.jsxs("div",{className:"text-green-600 dark:text-green-400 font-semibold",children:["",((null!=(b=Se.over)?b:0)/Se.daysPresent).toFixed(2)]})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Short"}),Nt.jsxs("div",{children:["",(null!=(w=Se.short)?w:0).toLocaleString()]})]}),Se.short>0&&Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Payment Terms"}),Nt.jsx("div",{children:Se.shortPaymentTerms&&Se.shortPaymentTerms>1?Nt.jsxs("span",{className:"text-orange-500 font-semibold",children:[Se.shortPaymentTerms," weeks",Nt.jsxs("span",{className:"text-xs ml-1",children:["(",(Se.short/Se.shortPaymentTerms).toFixed(2),"/week)"]})]}):Nt.jsx("span",{className:"text-gray-500",children:"1 week (full payment)"})})]}),Nt.jsxs("div",{className:Se.short>0?"":"col-span-2",children:[Nt.jsx("div",{className:"text-sm text-gray-400",children:"Deductions"}),Nt.jsxs("div",{children:["",(null!=(S=null!=(N=Se.deduction)?N:Se.totalDeductions)?S:0).toLocaleString()]})]})]}),Se.note&&Nt.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Payment Terms"}),Nt.jsx("div",{className:"text-sm",children:Se.note})]}),"teller"===Se.role&&nt.length>0&&Nt.jsxs("div",{className:"mb-4",children:[Nt.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[Nt.jsx(_e,{className:"w-4 h-4"}),"Daily Reports This Month"]}),Nt.jsx("div",{className:"rounded-lg overflow-hidden "+(M?"bg-gray-700":"bg-gray-50"),children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:""+(M?"bg-gray-600":"bg-gray-200"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-2 text-left",children:"Date"}),Nt.jsx("th",{className:"p-2 text-left",children:"Day"}),Nt.jsx("th",{className:"p-2 text-right",children:"System"}),Nt.jsx("th",{className:"p-2 text-right",children:"Cash"}),Nt.jsx("th",{className:"p-2 text-right",children:"Over"}),Nt.jsx("th",{className:"p-2 text-right",children:"Short"}),Nt.jsx("th",{className:"p-2 text-center",children:"Terms"}),Nt.jsx("th",{className:"p-2 text-center",children:"Status"})]})}),Nt.jsx("tbody",{children:nt.map((e,t)=>{const n=new Date(e.date||e.createdAt),r=n.toLocaleDateString("en-US",{weekday:"short"}),a=e.over>0||e.short>0||e.systemBalance>0,i=Number(e.shortPaymentTerms)||1,s=e.short>0&&i>1?e.short/i:null;return a?Nt.jsxs("tr",{className:"border-t "+(M?"border-gray-600":"border-gray-200"),children:[Nt.jsx("td",{className:"p-2",children:n.toLocaleDateString()}),Nt.jsx("td",{className:"p-2",children:Nt.jsx("span",{className:"px-2 py-1 rounded text-xs "+("Sun"===r?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-100":"Sat"===r?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-100":"bg-gray-100 text-gray-700 dark:bg-gray-600 dark:text-gray-100"),children:r})}),Nt.jsxs("td",{className:"p-2 text-right",children:["",(e.systemBalance||0).toLocaleString()]}),Nt.jsxs("td",{className:"p-2 text-right",children:["",(e.cashOnHand||0).toLocaleString()]}),Nt.jsx("td",{className:"p-2 text-right text-green-600 dark:text-green-400 font-semibold",children:e.over>0?`+${e.over.toLocaleString()}`:"-"}),Nt.jsx("td",{className:"p-2 text-right text-red-600 dark:text-red-400 font-semibold",children:e.short>0?`-${e.short.toLocaleString()}`:"-"}),Nt.jsx("td",{className:"p-2 text-center",children:s?Nt.jsxs("div",{className:"text-xs",children:[Nt.jsxs("div",{className:"font-semibold",children:[i,"w"]}),Nt.jsxs("div",{className:"text-red-500",children:["",s.toFixed(0),"/w"]})]}):"-"}),Nt.jsx("td",{className:"p-2 text-center",children:Nt.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("approved"===e.status?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-100":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-100"),children:e.status||"pending"})})]},t):null})})]})})]}),Nt.jsxs("div",{children:[Nt.jsx("h4",{className:"font-semibold mb-2",children:"Adjustments & Overrides"}),(null==(j=Se.adjustments)?void 0:j.length)?Nt.jsx("ul",{className:"space-y-2",children:Se.adjustments.map((e,t)=>{var n;const r=null==(n=e.reason)?void 0:n.startsWith("[OVERRIDE]"),a=r?e.reason.replace("[OVERRIDE]","").trim():e.reason||"Manual adjustment";return Nt.jsx("li",{className:"text-sm p-3 rounded-lg "+(r?M?"bg-purple-900/20 border border-purple-800":"bg-purple-50 border border-purple-200":M?"bg-gray-700":"bg-gray-50"),children:Nt.jsxs("div",{className:"flex justify-between items-start",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r&&Nt.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-purple-600 text-white",children:"OVERRIDE"}),Nt.jsx("div",{className:"text-xs opacity-70",children:new Date(e.createdAt).toLocaleString()})]}),Nt.jsx("div",{className:r?"font-medium":"",children:a})]}),Nt.jsxs("div",{className:"font-bold text-lg ml-3 "+(e.delta>=0?"text-green-500":"text-red-500"),children:[e.delta>=0?"+":"-","",Math.abs(e.delta).toFixed(2)]})]})},t)})}):Nt.jsx("div",{className:"text-sm opacity-70",children:"No adjustments or overrides"})]}),Nt.jsx("div",{className:"mt-4 flex justify-end",children:Nt.jsx("button",{onClick:()=>je(null),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white",children:"Close"})})]})})]})}function H$(){var e;const{settings:t}=f.useContext($c),{showToast:n}=Kc(),r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState([]),[s,o]=f.useState(!0),[l,c]=f.useState(null);f.useEffect(()=>{d()},[]);const d=()=>h(null,null,function*(){var e,t;try{o(!0),c(null);const e=yield pt.get(`${zc()}/api/payroll/check/no-base-salary`);e.data.success&&(i(e.data.users||[]),e.data.count>0&&n({type:"warning",message:` Found ${e.data.count} users without base salary`}))}catch(r){console.error("Error fetching users without base salary:",r),c((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.message)||"Failed to load users"),n({type:"error",message:"Failed to load users without base salary"})}finally{o(!1)}});return s?Nt.jsxs("div",{className:"flex items-center justify-center p-8",children:[Nt.jsx(ue,{className:"w-6 h-6 animate-spin text-indigo-600"}),Nt.jsx("span",{className:"ml-2",children:"Checking users..."})]}):l?Nt.jsx("div",{className:"p-4 rounded-lg border "+(r?"bg-red-900/20 border-red-800":"bg-red-50 border-red-200"),children:Nt.jsxs("div",{className:"flex items-start gap-3",children:[Nt.jsx(Me,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"font-semibold text-red-800 dark:text-red-200",children:"Error"}),Nt.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:l})]})]})}):0===a.length?Nt.jsx("div",{className:"p-4 rounded-lg border "+(r?"bg-green-900/20 border-green-800":"bg-green-50 border-green-200"),children:Nt.jsx("p",{className:"text-green-800 dark:text-green-200",children:" All users have base salary configured!"})}):Nt.jsxs("div",{className:"rounded-lg shadow p-6 "+(r?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx(Me,{className:"w-5 h-5 text-yellow-600"}),Nt.jsx("h2",{className:"text-lg font-semibold",children:"Users Without Base Salary"})]}),Nt.jsx("button",{onClick:d,className:"p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition",title:"Refresh",children:Nt.jsx(Ae,{className:"w-4 h-4"})})]}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"min-w-full divide-y "+(r?"divide-gray-700":"divide-gray-200"),children:[Nt.jsx("thead",{className:r?"bg-gray-700":"bg-gray-50",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Username"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Email"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Base Salary"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Latest Payroll"})]})}),Nt.jsx("tbody",{className:"divide-y "+(r?"divide-gray-700 bg-gray-800":"divide-gray-200 bg-white"),children:a.map(e=>Nt.jsxs("tr",{className:r?"hover:bg-gray-700":"hover:bg-gray-50",children:[Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.username}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.name}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.email||"N/A"}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Nt.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200",children:"0.00"})}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.latestPayroll?Nt.jsxs("div",{className:"flex flex-col",children:[Nt.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.latestPayroll.baseSalary?`Base: ${e.latestPayroll.baseSalary}`:"No base"}),Nt.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.latestPayroll.createdAt).toLocaleDateString()})]}):Nt.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No payroll yet"})})]},e._id))})]})}),Nt.jsxs("div",{className:"mt-4 p-3 rounded text-sm "+(r?"bg-yellow-900/20 text-yellow-200":"bg-yellow-50 text-yellow-800"),children:[Nt.jsx("strong",{children:" Action Required:"})," These ",a.length," user(s) need base salary configuration. Use the Payroll Base Salary Fixer to set their salaries."]})]})}const G$=()=>{const{settings:e}=f.useContext($c),{showToast:t}=Kc(),n=zc(),[r,a]=f.useState(!1),[i,s]=f.useState(7),[o,d]=f.useState(null),[u,p]=f.useState("duplicates");return Nt.jsxs("div",{className:"space-y-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Payroll Cleanup Tools"}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:o&&`Last run: ${o.timestamp}`})]}),Nt.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4 rounded",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:Nt.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),Nt.jsx("div",{className:"ml-3",children:Nt.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Admin Only: These operations modify payroll data. Use with caution and verify results."})})]})}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Days to Process"}),Nt.jsx("input",{type:"number",min:"1",max:"90",value:i,onChange:e=>s(Math.max(1,Math.min(90,parseInt(e.target.value)||1))),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Process payroll records from the past ",i," day(s)"]})]}),Nt.jsxs("div",{className:"flex space-x-2 border-b border-gray-200 dark:border-gray-700",children:[Nt.jsx("button",{onClick:()=>p("duplicates"),className:"px-4 py-2 font-medium transition "+("duplicates"===u?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"),children:"Clean Duplicates"}),Nt.jsx("button",{onClick:()=>p("recalculate"),className:"px-4 py-2 font-medium transition "+("recalculate"===u?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"),children:"Recalculate Salaries"}),Nt.jsx("button",{onClick:()=>p("both"),className:"px-4 py-2 font-medium transition "+("both"===u?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"),children:"Run Both"})]}),"duplicates"===u&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700",children:[Nt.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Clean Duplicate Payroll Records"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"This will identify and delete duplicate payroll records where the same teller has multiple entries for the same day. The newest record will be kept."}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,r;if(window.confirm(`Delete duplicate payroll records from the past ${i} days?`)){a(!0);try{const e=localStorage.getItem("token"),r=yield pt.post(`${n}/api/payroll/cleanup/duplicates`,{daysBack:i},{headers:{Authorization:`Bearer ${e}`}});200===r.status&&(d(c(l({type:"duplicates"},r.data),{timestamp:(new Date).toLocaleString()})),t(` Deleted ${r.data.totalDeleted} duplicate payroll records`,"success"))}catch(s){console.error(" Error cleaning up duplicates:",s),t(` Error: ${(null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.message)||s.message}`,"error")}finally{a(!1)}}}),disabled:r,className:"w-full px-6 py-3 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition",children:r?"Processing...":"Delete Duplicates"})]}),"recalculate"===u&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700",children:[Nt.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Recalculate Payroll with Fixed Salaries"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"This will recalculate all payroll records using the current base salary values. Useful when salaries have been fixed but old records still show old values."}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,r;if(window.confirm(`Recalculate payroll with fixed salaries for the past ${i} days?`)){a(!0);try{const e=localStorage.getItem("token"),r=yield pt.post(`${n}/api/payroll/recalculate/with-fixed-salaries`,{daysBack:i},{headers:{Authorization:`Bearer ${e}`}});200===r.status&&(d(c(l({type:"recalculate"},r.data),{timestamp:(new Date).toLocaleString()})),t(` Recalculated ${r.data.totalRecalculated} payroll records`,"success"))}catch(s){console.error(" Error recalculating payrolls:",s),t(` Error: ${(null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.message)||s.message}`,"error")}finally{a(!1)}}}),disabled:r,className:"w-full px-6 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition",children:r?"Processing...":"Recalculate Now"})]}),"both"===u&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700",children:[Nt.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Run Both Operations"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"This will run both operations in sequence:"}),Nt.jsxs("ol",{className:"list-decimal list-inside text-gray-600 dark:text-gray-400 mb-6 space-y-2",children:[Nt.jsx("li",{children:"Delete duplicate payroll records"}),Nt.jsx("li",{children:"Recalculate all payroll with fixed salaries"})]}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,r;if(window.confirm(`Run both cleanup and recalculation for the past ${i} days?\n\nThis will:\n1. Delete duplicate payroll records\n2. Recalculate all payroll with fixed salaries`)){a(!0);try{const e={Authorization:`Bearer ${localStorage.getItem("token")}`},r=yield pt.post(`${n}/api/payroll/cleanup/duplicates`,{daysBack:i},{headers:e});t(` Deleted ${r.data.totalDeleted} duplicate records`,"success");const a=yield pt.post(`${n}/api/payroll/recalculate/with-fixed-salaries`,{daysBack:i},{headers:e});d({type:"both",cleanup:r.data,recalculate:a.data,timestamp:(new Date).toLocaleString()}),t(" Cleanup and recalculation complete!","success")}catch(s){console.error(" Error running operations:",s),t(` Error: ${(null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.message)||s.message}`,"error")}finally{a(!1)}}}),disabled:r,className:"w-full px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition",children:r?"Processing...":"Run Both Operations"})]}),o&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700",children:[Nt.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Results"}),"duplicates"===o.type&&Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200 dark:border-blue-700",children:Nt.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:[" ",o.message]})}),o.details&&o.details.length>0&&Nt.jsxs("div",{className:"overflow-x-auto",children:[Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"Date"}),Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"Deleted Amount"}),Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"Kept Amount"})]})}),Nt.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:o.details.slice(0,10).map((e,t)=>{var n,r;return Nt.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsx("td",{className:"px-4 py-2 text-gray-900 dark:text-gray-300",children:e.date}),Nt.jsxs("td",{className:"px-4 py-2 text-red-600 dark:text-red-400",children:["",null==(n=e.deletedAmount)?void 0:n.toFixed(2)]}),Nt.jsxs("td",{className:"px-4 py-2 text-green-600 dark:text-green-400",children:["",null==(r=e.keptAmount)?void 0:r.toFixed(2)]})]},t)})})]}),o.details.length>10&&Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["... and ",o.details.length-10," more records"]})]})]}),"recalculate"===o.type&&Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200 dark:border-blue-700",children:Nt.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:[" ",o.message]})}),o.details&&o.details.length>0&&Nt.jsxs("div",{className:"overflow-x-auto",children:[Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"Old Base"}),Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"New Base"}),Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"Old Total"}),Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"New Total"}),Nt.jsx("th",{className:"px-4 py-2 text-left text-gray-900 dark:text-white",children:"Difference"})]})}),Nt.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:o.details.slice(0,10).map((e,t)=>{var n,r,a,i,s;return Nt.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsxs("td",{className:"px-4 py-2 text-gray-900 dark:text-gray-300",children:["",null==(n=e.oldBaseSalary)?void 0:n.toFixed(2)]}),Nt.jsxs("td",{className:"px-4 py-2 text-gray-900 dark:text-gray-300",children:["",null==(r=e.newBaseSalary)?void 0:r.toFixed(2)]}),Nt.jsxs("td",{className:"px-4 py-2 text-gray-900 dark:text-gray-300",children:["",null==(a=e.oldTotalSalary)?void 0:a.toFixed(2)]}),Nt.jsxs("td",{className:"px-4 py-2 text-gray-900 dark:text-gray-300",children:["",null==(i=e.newTotalSalary)?void 0:i.toFixed(2)]}),Nt.jsxs("td",{className:"px-4 py-2 font-medium "+(e.difference>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[e.difference>=0?"+":"","",null==(s=e.difference)?void 0:s.toFixed(2)]})]},t)})})]}),o.details.length>10&&Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["... and ",o.details.length-10," more records"]})]})]}),"both"===o.type&&Nt.jsxs("div",{className:"space-y-6",children:[Nt.jsxs("div",{children:[Nt.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Step 1: Cleanup"}),Nt.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200 dark:border-blue-700",children:Nt.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[" ",o.cleanup.message]})})]}),Nt.jsxs("div",{children:[Nt.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Step 2: Recalculation"}),Nt.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200 dark:border-blue-700",children:Nt.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[" ",o.recalculate.message]})})]}),Nt.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200 dark:border-green-700",children:Nt.jsx("p",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:" All operations completed successfully!"})})]})]})]})};function V$(){var e;const{settings:t}=f.useContext($c),{showToast:n}=Kc(),r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState(!0),[s,o]=f.useState(!0),[l,c]=f.useState(!1),[d,u]=f.useState(!1),[p,m]=f.useState([]),[g,x]=f.useState(""),[y,v]=f.useState([]),[b,w]=f.useState(!1),[N,S]=f.useState(""),j=()=>h(null,null,function*(){o(!0);try{const e=zc(),t=yield pt.get(`${e}/api/admin/employees-with-zero-salary`);t.data.success&&t.data.employees.length>0?v(t.data.employees):(v([]),n({type:"info",message:" No employees with zero base salary found!"}))}catch(e){console.error("Error fetching employees:",e),n({type:"error",message:"Failed to load employees"}),v([])}finally{o(!1)}});f.useEffect(()=>{j(),i(!1)},[]);const _=()=>h(null,null,function*(){try{const e=zc(),t=yield pt.get(`${e}/api/admin/payroll-audit-logs`,{params:{limit:10,sort:-1}});m(t.data||[])}catch(e){console.error("Error fetching audit logs:",e)}});f.useEffect(()=>{d&&_()},[d]);return Nt.jsxs("div",{className:"p-6 rounded-lg "+(r?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[Nt.jsx(Ae,{size:24}),"Payroll Base Salary Manager"]}),Nt.jsxs("button",{onClick:()=>u(!d),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[Nt.jsx(ie,{size:18}),"Audit Log"]})]}),s&&Nt.jsxs("div",{className:"flex items-center justify-center py-12",children:[Nt.jsx(ue,{size:32,className:"animate-spin text-blue-600"}),Nt.jsx("span",{className:"ml-3",children:"Loading employees..."})]}),!s&&0===y.length&&Nt.jsx("div",{className:"p-6 rounded-lg border-l-4 border-green-500 mb-6 "+(r?"bg-green-900/20":"bg-green-50"),children:Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx(k,{className:"text-green-600 flex-shrink-0 mt-0.5",size:20}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold text-green-800",children:"All Set!"}),Nt.jsx("p",{className:"text-sm text-green-700",children:" No employees with zero base salary found. All payroll records have proper base salaries."})]})]})}),!s&&y.length>0&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Employees with 0 Base Salary (",y.length,"):"]}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map((e,t)=>Nt.jsx("div",{className:"p-4 rounded-lg border "+(r?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:Nt.jsxs("div",{className:"flex items-start justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold capitalize",children:e.name}),Nt.jsx("p",{className:"text-sm text-gray-500",children:e.role})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsxs("p",{className:"font-bold text-lg text-green-600",children:["",e.baseSalary||"0"]}),Nt.jsx("p",{className:"text-xs text-gray-500",children:"Current Base"})]})]})},t))})]}),Nt.jsx("div",{className:"p-4 rounded-lg border-l-4 border-yellow-500 mb-6 "+(r?"bg-yellow-900/20":"bg-yellow-50"),children:Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx(Me,{className:"text-yellow-600 flex-shrink-0 mt-0.5",size:20}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold text-yellow-800",children:"Important:"}),Nt.jsx("p",{className:"text-sm text-yellow-700",children:"This will update payroll records with 0 base salary to the correct amounts based on employee role. An audit log will be created and notifications will be sent to administrators."})]})]})}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("button",{onClick:()=>c(!0),disabled:a,className:"flex-1 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2",children:a?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{size:18,className:"animate-spin"}),"Processing..."]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(k,{size:18}),"Fix New Employees"]})}),Nt.jsx("button",{onClick:()=>w(!0),disabled:a,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center gap-2",children:a?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{size:18,className:"animate-spin"}),"Processing..."]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(Ae,{size:18}),"Fix All Historical"]})})]})]}),y.length>0&&Nt.jsx("div",{className:"hidden"}),l&&Nt.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"rounded-lg p-6 w-full max-w-md "+(r?"bg-gray-900":"bg-white"),children:[Nt.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[Nt.jsx(Me,{className:"text-orange-500"}),"Confirm Update"]}),Nt.jsxs("p",{className:"mb-4 text-gray-600 dark:text-gray-400",children:["You're about to update base salaries for ",y.length," employees. This action will be logged and audited."]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Reason for Update:"}),Nt.jsx("textarea",{value:g,onChange:e=>x(e.target.value),placeholder:"Enter reason for this update (required)...",className:"w-full p-3 rounded border "+(r?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300"),rows:3}),!g.trim()&&Nt.jsx("p",{className:"text-sm text-red-500 mt-1",children:" Reason is required"})]}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("button",{onClick:()=>{c(!1),x("")},disabled:a,className:"flex-1 px-4 py-2 rounded border border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50",children:"Cancel"}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;if(g.trim())if(0!==y.length){i(!0);try{const e=zc(),t={};for(const n of y){const e="supervisor"===n.role?600:450;t[n.name]=e}const r=yield pt.post(`${e}/api/admin/fix-payroll-base-salaries`,{targetNames:y.map(e=>e.name),baseSalary:450,conditionalSalaries:t,reason:g}),a=r.data;a.success?(n({type:"success",message:` ${a.message}`}),a.notificationSent&&n({type:"info",message:" Notifications sent to admin"}),x(""),c(!1),setTimeout(()=>{j(),_()},1e3)):n({type:"error",message:a.message||"Update failed"})}catch(r){const a=(null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||r.message;n({type:"error",message:` ${a}`})}finally{i(!1)}}else n({type:"warning",message:"No employees to update."});else n({type:"warning",message:"Please provide a reason for this update."})}),disabled:a||!g.trim(),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[a&&Nt.jsx(ue,{size:16,className:"animate-spin"}),"Confirm Update"]})]})]})}),b&&Nt.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"rounded-lg p-6 w-full max-w-md "+(r?"bg-gray-900":"bg-white"),children:[Nt.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[Nt.jsx(Me,{className:"text-red-500"}),"Fix All Historical Payroll"]}),Nt.jsxs("p",{className:"text-sm mb-4 leading-relaxed",children:["This will fix ",Nt.jsx("strong",{children:"ALL historical payroll records"})," with 0 base salary, automatically assigning the correct salary based on each employee's role:"]}),Nt.jsxs("ul",{className:"text-sm mb-4 space-y-1 ml-4 list-disc",children:[Nt.jsx("li",{children:"Tellers: 450"}),Nt.jsx("li",{children:"Supervisors: 600"}),Nt.jsx("li",{children:"Watchers: 400-450"}),Nt.jsx("li",{children:"Admins: 0"})]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Reason for Update:"}),Nt.jsx("textarea",{value:N,onChange:e=>S(e.target.value),placeholder:"e.g., Bulk fix for historical payroll records created before salary sync...",className:"w-full px-3 py-2 rounded-lg border text-sm resize-none "+(r?"bg-gray-700 border-gray-600 text-white":"bg-gray-50 border-gray-300"),rows:3})]}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("button",{onClick:()=>w(!1),className:"flex-1 px-4 py-2 rounded-lg transition "+(r?"bg-gray-700 hover:bg-gray-600":"bg-gray-300 hover:bg-gray-400"),children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;if(N.trim()){i(!0);try{const e=zc(),t=(yield pt.post(`${e}/api/admin/fix-all-historical-payroll`,{reason:N})).data;t.success?(n({type:"success",message:` ${t.message}`}),t.updated>0&&n({type:"info",message:`Fixed ${t.updated} historical payroll records`}),t.notificationSent&&n({type:"info",message:" Notifications sent to admin"}),S(""),w(!1),setTimeout(()=>_(),1e3)):n({type:"error",message:t.message||"Update failed"})}catch(r){const a=(null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||r.message;n({type:"error",message:` ${a}`})}finally{i(!1)}}else n({type:"warning",message:"Please provide a reason for this batch update."})}),disabled:a||!N.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:a?"Processing...":"Confirm & Fix All"})]})]})}),d&&Nt.jsxs("div",{className:"mt-8 pt-8 border-t",children:[Nt.jsx("h3",{className:"text-lg font-bold mb-4",children:"Update History (Audit Log)"}),0===p.length?Nt.jsx("p",{className:"text-gray-500",children:"No audit logs found."}):Nt.jsx("div",{className:"space-y-4",children:p.map((e,t)=>{var n;return Nt.jsx("div",{className:"p-4 rounded-lg border "+(r?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:Nt.jsxs("div",{className:"flex items-start justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold",children:e.actionType}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["By: ",(null==(n=e.performedBy)?void 0:n.name)||"Unknown"]}),Nt.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString()}),e.reason&&Nt.jsxs("p",{className:"text-sm mt-2 italic",children:["Reason: ",e.reason]})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsx("p",{className:"font-bold "+("SUCCESS"===e.status?"text-green-600":"PARTIAL"===e.status?"text-yellow-600":"text-red-600"),children:e.status}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.payrollsUpdated," records"]})]})]})},t)})})]}),Nt.jsx("div",{className:"mt-8 border-t pt-6",children:Nt.jsx(H$,{})}),Nt.jsx("div",{className:"mt-8 border-t pt-6",children:Nt.jsx(G$,{})})]})}const $$=Hc;function W$(){var e,t,n,r,a,i;const[s,o]=f.useState([]),[l,c]=f.useState("pending"),[d,u]=f.useState(!1),[p,m]=f.useState(null),[g,x]=f.useState(""),{settings:y,user:v}=f.useContext($c),[b,w]=f.useState(0),[N,S]=f.useState([]),[j,_]=f.useState(!1),[A,C]=f.useState(""),[E,T]=f.useState("amount"),P=()=>h(null,null,function*(){u(!0);try{const e="pending"===l?`${$$}/api/payroll/withdrawals/pending`:`${$$}/api/payroll/withdrawals`;let t=(yield pt.get(e)).data.withdrawals||[];"pending"!==l&&"all"!==l&&(t=t.filter(e=>e.status===l)),o(t)}catch(e){console.error(" Failed to fetch withdrawals:",e)}finally{u(!1)}});f.useEffect(()=>{P();const e=setInterval(P,3e4);return()=>clearInterval(e)},[l]);f.useEffect(()=>{h(null,null,function*(){var e;_(!0);try{const t=new Date,n=t.getDay(),r=0===n?6:n-1,a=new Date(t);a.setDate(t.getDate()-r+7*b),a.setHours(0,0,0,0);const i=new Date(a);i.setDate(a.getDate()+6),i.setHours(23,59,59,999);const s=(null==(e=(yield pt.get(`${$$}/api/payroll`)).data)?void 0:e.payrolls)||[],o=s.filter(e=>{if(!0===e.withdrawn)return!1;const t=new Date(e.createdAt||e.date),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(a.getFullYear(),a.getMonth(),a.getDate()),s=new Date(i.getFullYear(),i.getMonth(),i.getDate());return n>=r&&n<=s});console.log(` Week: ${a.toLocaleDateString()} - ${i.toLocaleDateString()}`),console.log(` Total payrolls: ${s.length}`),console.log(` Unwithdrawn in week: ${o.length}`);const l={};o.forEach(e=>{var t,n,r,a;const i=(null==(t=e.user)?void 0:t._id)||e.user;l[i]||(l[i]={userId:i,userName:(null==(n=e.user)?void 0:n.name)||(null==(r=e.user)?void 0:r.username)||"Unknown",username:(null==(a=e.user)?void 0:a.username)||"unknown",payrolls:[],totalAmount:0}),l[i].payrolls.push(e),l[i].totalAmount+=Number(e.totalSalary)||0});const c=Object.values(l).sort((e,t)=>t.totalAmount-e.totalAmount);console.log(` Users with unwithdrawn payrolls: ${c.length}`),S(c)}catch(t){console.error(" Failed to fetch unwithdrawn payrolls:",t)}finally{_(!1)}})},[b]);const D=e=>{const t={pending:Nt.jsx(Ie,{className:"w-4 h-4"}),approved:Nt.jsx(k,{className:"w-4 h-4"}),rejected:Nt.jsx(ve,{className:"w-4 h-4"})};return Nt.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1 ${{pending:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200",approved:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",rejected:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"}[e]}`,children:[t[e],e.toUpperCase()]})};return Nt.jsxs("div",{className:"p-6 min-h-screen",style:{backgroundColor:"dark"===(null==(e=null==y?void 0:y.theme)?void 0:e.mode)?y.theme.darkBg:null==(t=null==y?void 0:y.theme)?void 0:t.lightBg,color:"dark"===(null==(n=null==y?void 0:y.theme)?void 0:n.mode)?y.theme.darkFont:null==(r=null==y?void 0:y.theme)?void 0:r.lightFont},children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsxs("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[Nt.jsx(xe,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),"Withdrawal Approvals"]}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Review and approve employee withdrawal requests"})]}),Nt.jsx("div",{className:"flex gap-2 mb-6 flex-wrap",children:["pending","approved","rejected","all"].map(e=>Nt.jsx("button",{onClick:()=>c(e),className:"px-4 py-2 rounded-lg font-medium transition "+(l===e?"bg-indigo-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),Nt.jsxs("div",{className:"mb-8 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-4",children:[Nt.jsxs("div",{children:[Nt.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[Nt.jsx(Z,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"}),"Unwithdrawn Payrolls"]}),Nt.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Employees who haven't withdrawn their salary for the selected week"})]}),!j&&N.length>0&&Nt.jsxs("div",{className:"flex gap-4 text-center",children:[Nt.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 px-4 py-2 rounded-lg border border-orange-200 dark:border-orange-800",children:[Nt.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:N.length}),Nt.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Employees"})]}),Nt.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg border border-red-200 dark:border-red-800",children:[Nt.jsxs("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:["",N.reduce((e,t)=>e+t.totalAmount,0).toLocaleString(void 0,{maximumFractionDigits:2})]}),Nt.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Total Pending"})]})]})]}),Nt.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[Nt.jsxs("button",{onClick:()=>w(b-1),className:"px-4 py-2 rounded-lg font-semibold flex items-center gap-2 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600",children:[Nt.jsx(V,{className:"w-4 h-4"}),"Previous Week"]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"font-bold text-lg",children:(()=>{const e=new Date,t=e.getDay(),n=0===t?6:t-1,r=new Date(e);r.setDate(e.getDate()-n+7*b);const a=new Date(r);return a.setDate(r.getDate()+6),`${r.toLocaleDateString()} - ${a.toLocaleDateString()}`})()}),0===b&&Nt.jsx("span",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-semibold",children:"(Current Week)"}),b<0&&Nt.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["(",Math.abs(b)," week",Math.abs(b)>1?"s":""," ago)"]}),b>0&&Nt.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["(",b," week",b>1?"s":""," ahead)"]})]}),Nt.jsxs("button",{onClick:()=>w(b+1),className:"px-4 py-2 rounded-lg font-semibold flex items-center gap-2 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600",children:["Next Week",Nt.jsx($,{className:"w-4 h-4"})]})]}),j?Nt.jsx("div",{className:"flex justify-center items-center py-8",children:Nt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):0===N.length?Nt.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[Nt.jsx(k,{className:"w-12 h-12 mx-auto mb-2 text-green-500"}),Nt.jsx("p",{children:"All employees have withdrawn their salary for this week!"})]}):Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{className:"flex gap-3 flex-wrap mb-4",children:[Nt.jsx("input",{type:"text",placeholder:"Search by name...",value:A,onChange:e=>C(e.target.value),className:"flex-1 min-w-[200px] px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500"}),Nt.jsxs("select",{value:E,onChange:e=>T(e.target.value),className:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500",children:[Nt.jsx("option",{value:"amount",children:"Sort by Amount (High to Low)"}),Nt.jsx("option",{value:"amount-asc",children:"Sort by Amount (Low to High)"}),Nt.jsx("option",{value:"name",children:"Sort by Name (A-Z)"}),Nt.jsx("option",{value:"count",children:"Sort by Payroll Count"})]})]}),Nt.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[`${N.filter(e=>e.userName.toLowerCase().includes(A.toLowerCase())||e.username.toLowerCase().includes(A.toLowerCase())).length} of ${N.length} employee${1!==N.length?"s":""}`," with unwithdrawn payroll"]}),N.filter(e=>e.userName.toLowerCase().includes(A.toLowerCase())||e.username.toLowerCase().includes(A.toLowerCase())).sort((e,t)=>"amount"===E?t.totalAmount-e.totalAmount:"amount-asc"===E?e.totalAmount-t.totalAmount:"name"===E?e.userName.localeCompare(t.userName):"count"===E?t.payrolls.length-e.payrolls.length:0).map((e,t)=>Nt.jsxs("div",{className:"relative border border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 hover:shadow-md transition",children:[Nt.jsx("div",{className:"absolute -top-2 -left-2 bg-orange-600 text-white text-xs font-bold rounded-full w-7 h-7 flex items-center justify-center shadow-lg",children:t+1}),Nt.jsxs("div",{className:"flex justify-between items-start ml-4",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("h3",{className:"font-bold text-lg",children:e.userName}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["@",e.username]}),Nt.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[Nt.jsxs("span",{className:"text-xs bg-orange-600 text-white px-2 py-1 rounded-full font-semibold",children:[e.payrolls.length," payroll",1!==e.payrolls.length?"s":""]}),e.payrolls.length>1&&Nt.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Avg: ",(e.totalAmount/e.payrolls.length).toFixed(2)]})]})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsxs("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:["",e.totalAmount.toLocaleString(void 0,{maximumFractionDigits:2})]}),Nt.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Unwithdrawn"})]})]}),Nt.jsxs("div",{className:"mt-3 ml-4",children:[Nt.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2",children:"Payroll Details:"}),Nt.jsx("div",{className:"flex flex-wrap gap-2",children:e.payrolls.sort((e,t)=>new Date(e.createdAt||e.date)-new Date(t.createdAt||t.date)).map((e,t)=>Nt.jsxs("span",{className:"px-3 py-1.5 bg-white dark:bg-gray-700 rounded-lg text-xs font-medium border border-gray-200 dark:border-gray-600 hover:shadow-sm transition",children:[Nt.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-300",children:new Date(e.createdAt||e.date).toLocaleDateString()}),Nt.jsxs("div",{className:"text-orange-600 dark:text-orange-400 font-bold",children:["",Number(e.totalSalary||0).toFixed(2)]})]},t))})]})]},e.userId))]})]}),d?Nt.jsxs("div",{className:"text-center py-12",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),Nt.jsx("p",{className:"mt-4 text-gray-500",children:"Loading withdrawals..."})]}):0===s.length?Nt.jsxs("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-lg",children:[Nt.jsx(M,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),Nt.jsxs("p",{className:"text-gray-500",children:["No ",l," withdrawal requests"]})]}):Nt.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(e=>{var t,n;return Nt.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md border-l-4 border-indigo-500 cursor-pointer hover:shadow-lg transition",onClick:()=>m(e),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx(Oe,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),Nt.jsx("h3",{className:"font-semibold",children:(null==(t=e.userId)?void 0:t.name)||(null==(n=e.userId)?void 0:n.username)})]}),D(e.status)]}),Nt.jsxs("div",{className:"space-y-2 text-sm",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Amount:"}),Nt.jsxs("span",{className:"font-bold text-green-600 dark:text-green-400",children:["",(e.amount||0).toLocaleString()]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Requested:"}),Nt.jsx("span",{className:"text-xs",children:new Date(e.createdAt).toLocaleDateString()})]}),e.approvedAt&&Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["approved"===e.status?"Approved":"Rejected",":"]}),Nt.jsx("span",{className:"text-xs",children:new Date(e.approvedAt).toLocaleDateString()})]})]})]},e._id)})}),p&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-bold",children:"Withdrawal Details"}),Nt.jsx("button",{onClick:()=>{m(null),x("")},className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:""})]}),Nt.jsxs("div",{className:"space-y-3 mb-6",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Employee:"}),Nt.jsx("p",{className:"font-semibold",children:(null==(a=p.userId)?void 0:a.name)||(null==(i=p.userId)?void 0:i.username)})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Amount:"}),Nt.jsxs("p",{className:"font-bold text-2xl text-green-600 dark:text-green-400",children:["",(p.amount||0).toLocaleString()]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status:"}),Nt.jsx("div",{className:"mt-1",children:D(p.status)})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Requested On:"}),Nt.jsx("p",{children:new Date(p.createdAt).toLocaleString()})]}),p.weekRange&&Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Week Range:"}),Nt.jsx("p",{children:p.weekRange})]}),"rejected"===p.status&&p.rejectionReason&&Nt.jsxs("div",{children:[Nt.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Rejection Reason:"}),Nt.jsx("p",{className:"text-red-600 dark:text-red-400",children:p.rejectionReason})]})]}),"pending"===p.status&&Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("button",{onClick:()=>{return e=p._id,h(null,null,function*(){var t,n;if(confirm("Approve this withdrawal request?"))try{yield pt.put(`${$$}/api/payroll/withdrawals/${e}/approve`,{adminId:null==v?void 0:v._id}),alert(" Withdrawal approved successfully!"),P(),m(null)}catch(r){console.error(" Failed to approve withdrawal:",r),alert("Failed to approve withdrawal: "+((null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||r.message))}});var e},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold",children:[Nt.jsx(k,{className:"w-5 h-5"}),"Approve Withdrawal"]}),Nt.jsxs("div",{children:[Nt.jsx("input",{type:"text",placeholder:"Reason for rejection...",value:g,onChange:e=>x(e.target.value),className:"w-full p-2 border rounded-lg mb-2 dark:bg-gray-700 dark:border-gray-600"}),Nt.jsxs("button",{onClick:()=>{return e=p._id,h(null,null,function*(){var t,n;if(g.trim()){if(confirm("Reject this withdrawal request?"))try{yield pt.put(`${$$}/api/payroll/withdrawals/${e}/reject`,{adminId:null==v?void 0:v._id,reason:g}),alert(" Withdrawal rejected"),P(),m(null),x("")}catch(r){console.error(" Failed to reject withdrawal:",r),alert("Failed to reject withdrawal: "+((null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||r.message))}}else alert("Please provide a reason for rejection")});var e},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold",children:[Nt.jsx(ve,{className:"w-5 h-5"}),"Reject Withdrawal"]})]})]})]})})]})}var Y$,X$,K$={exports:{}},q$={};var J$=(X$||(X$=1,K$.exports=(Y$||(Y$=1,q$.ConcurrentRoot=1,q$.ContinuousEventPriority=8,q$.DefaultEventPriority=32,q$.DiscreteEventPriority=2,q$.IdleEventPriority=268435456,q$.LegacyRoot=0,q$.NoEventPriority=0),q$)),K$.exports);
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Q$="181",Z$={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},eW={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tW=0,nW=1,rW=2,aW=100,iW=101,sW=102,oW=200,lW=201,cW=202,dW=203,uW=204,hW=205,pW=206,mW=207,gW=208,fW=209,xW=210,yW=211,vW=212,bW=213,wW=214,NW=0,SW=1,jW=2,_W=3,AW=4,CW=5,MW=6,kW=7,EW="attached",TW="detached",PW=300,DW=301,RW=302,IW=303,OW=304,BW=306,LW=1e3,FW=1001,UW=1002,zW=1003,HW=1004,GW=1005,VW=1006,$W=1007,WW=1008,YW=1008,XW=1009,KW=1010,qW=1011,JW=1012,QW=1013,ZW=1014,eY=1015,tY=1016,nY=1017,rY=1018,aY=1020,iY=35902,sY=35899,oY=1021,lY=1022,cY=1023,dY=1026,uY=1027,hY=1028,pY=1029,mY=1030,gY=1031,fY=1033,xY=33776,yY=33777,vY=33778,bY=33779,wY=35840,NY=35841,SY=35842,jY=35843,_Y=36196,AY=37492,CY=37496,MY=37808,kY=37809,EY=37810,TY=37811,PY=37812,DY=37813,RY=37814,IY=37815,OY=37816,BY=37817,LY=37818,FY=37819,UY=37820,zY=37821,HY=36492,GY=36494,VY=36495,$Y=36283,WY=36284,YY=36285,XY=36286,KY=2300,qY=2301,JY=2302,QY=2400,ZY=2401,eX=2402,tX=2500,nX=2501,rX="",aX="srgb",iX="srgb-linear",sX="linear",oX="srgb",lX=7680,cX=512,dX=513,uX=514,hX=515,pX=516,mX=517,gX=518,fX=519,xX=35044,yX="300 es",vX=2e3,bX=2001;function wX(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const NX={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function SX(e,t){return new NX[e](t)}function jX(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function _X(){const e=jX("canvas");return e.style.display="block",e}const AX={};let CX=null;function MX(...e){const t="THREE."+e.shift();CX?CX("log",t,...e):console.log(t,...e)}function kX(...e){const t="THREE."+e.shift();CX?CX("warn",t,...e):console.warn(t,...e)}function EX(...e){const t="THREE."+e.shift();CX?CX("error",t,...e):console.error(t,...e)}function TX(...e){const t=e.join(" ");t in AX||(AX[t]=!0,kX(...e))}let PX=class{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const r=n[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}};const DX=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let RX=1234567;const IX=Math.PI/180,OX=180/Math.PI;function BX(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(DX[255&e]+DX[e>>8&255]+DX[e>>16&255]+DX[e>>24&255]+"-"+DX[255&t]+DX[t>>8&255]+"-"+DX[t>>16&15|64]+DX[t>>24&255]+"-"+DX[63&n|128]+DX[n>>8&255]+"-"+DX[n>>16&255]+DX[n>>24&255]+DX[255&r]+DX[r>>8&255]+DX[r>>16&255]+DX[r>>24&255]).toLowerCase()}function LX(e,t,n){return Math.max(t,Math.min(n,e))}function FX(e,t){return(e%t+t)%t}function UX(e,t,n){return(1-n)*e+n*t}function zX(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function HX(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const GX={DEG2RAD:IX,RAD2DEG:OX,generateUUID:BX,clamp:LX,euclideanModulo:FX,mapLinear:function(e,t,n,r,a){return r+(e-t)*(a-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:UX,damp:function(e,t,n,r){return UX(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(FX(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(RX=e);let t=RX+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*IX},radToDeg:function(e){return e*OX},isPowerOfTwo:function(e){return!(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,a){const i=Math.cos,s=Math.sin,o=i(n/2),l=s(n/2),c=i((t+r)/2),d=s((t+r)/2),u=i((t-r)/2),h=s((t-r)/2),p=i((r-t)/2),m=s((r-t)/2);switch(a){case"XYX":e.set(o*d,l*u,l*h,o*c);break;case"YZY":e.set(l*h,o*d,l*u,o*c);break;case"ZXZ":e.set(l*u,l*h,o*d,o*c);break;case"XZX":e.set(o*d,l*m,l*p,o*c);break;case"YXY":e.set(l*p,o*d,l*m,o*c);break;case"ZYZ":e.set(l*m,l*p,o*d,o*c);break;default:kX("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}},normalize:HX,denormalize:zX};class VX{constructor(e=0,t=0){VX.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=LX(this.x,e.x,t.x),this.y=LX(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=LX(this.x,e,t),this.y=LX(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(LX(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(LX(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),a=this.x-e.x,i=this.y-e.y;return this.x=a*n-i*r+e.x,this.y=a*r+i*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class $X{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,a,i,s){let o=n[r+0],l=n[r+1],c=n[r+2],d=n[r+3],u=a[i+0],h=a[i+1],p=a[i+2],m=a[i+3];if(s<=0)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=d);if(s>=1)return e[t+0]=u,e[t+1]=h,e[t+2]=p,void(e[t+3]=m);if(d!==m||o!==u||l!==h||c!==p){let e=o*u+l*h+c*p+d*m;e<0&&(u=-u,h=-h,p=-p,m=-m,e=-e);let t=1-s;if(e<.9995){const n=Math.acos(e),r=Math.sin(n);t=Math.sin(t*n)/r,o=o*t+u*(s=Math.sin(s*n)/r),l=l*t+h*s,c=c*t+p*s,d=d*t+m*s}else{o=o*t+u*s,l=l*t+h*s,c=c*t+p*s,d=d*t+m*s;const e=1/Math.sqrt(o*o+l*l+c*c+d*d);o*=e,l*=e,c*=e,d*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,r,a,i){const s=n[r],o=n[r+1],l=n[r+2],c=n[r+3],d=a[i],u=a[i+1],h=a[i+2],p=a[i+3];return e[t]=s*p+c*d+o*h-l*u,e[t+1]=o*p+c*u+l*d-s*h,e[t+2]=l*p+c*h+s*u-o*d,e[t+3]=c*p-s*d-o*u-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,a=e._z,i=e._order,s=Math.cos,o=Math.sin,l=s(n/2),c=s(r/2),d=s(a/2),u=o(n/2),h=o(r/2),p=o(a/2);switch(i){case"XYZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"YXZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"ZXY":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"ZYX":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"YZX":this._x=u*c*d+l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d-u*h*p;break;case"XZY":this._x=u*c*d-l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d+u*h*p;break;default:kX("Quaternion: .setFromEuler() encountered an unknown order: "+i)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],a=t[8],i=t[1],s=t[5],o=t[9],l=t[2],c=t[6],d=t[10],u=n+s+d;if(u>0){const e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(c-o)*e,this._y=(a-l)*e,this._z=(i-r)*e}else if(n>s&&n>d){const e=2*Math.sqrt(1+n-s-d);this._w=(c-o)/e,this._x=.25*e,this._y=(r+i)/e,this._z=(a+l)/e}else if(s>d){const e=2*Math.sqrt(1+s-n-d);this._w=(a-l)/e,this._x=(r+i)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+d-n-s);this._w=(i-r)/e,this._x=(a+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(LX(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,a=e._z,i=e._w,s=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+i*s+r*l-a*o,this._y=r*c+i*o+a*s-n*l,this._z=a*c+i*l+n*o-r*s,this._w=i*c-n*s-r*o-a*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,a=e._z,i=e._w,s=this.dot(e);s<0&&(n=-n,r=-r,a=-a,i=-i,s=-s);let o=1-t;if(s<.9995){const e=Math.acos(s),l=Math.sin(e);o=Math.sin(o*e)/l,t=Math.sin(t*e)/l,this._x=this._x*o+n*t,this._y=this._y*o+r*t,this._z=this._z*o+a*t,this._w=this._w*o+i*t,this._onChangeCallback()}else this._x=this._x*o+n*t,this._y=this._y*o+r*t,this._z=this._z*o+a*t,this._w=this._w*o+i*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class WX{constructor(e=0,t=0,n=0){WX.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(XX.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(XX.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*r,this.y=a[1]*t+a[4]*n+a[7]*r,this.z=a[2]*t+a[5]*n+a[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,a=e.elements,i=1/(a[3]*t+a[7]*n+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*r+a[12])*i,this.y=(a[1]*t+a[5]*n+a[9]*r+a[13])*i,this.z=(a[2]*t+a[6]*n+a[10]*r+a[14])*i,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,a=e.x,i=e.y,s=e.z,o=e.w,l=2*(i*r-s*n),c=2*(s*t-a*r),d=2*(a*n-i*t);return this.x=t+o*l+i*d-s*c,this.y=n+o*c+s*l-a*d,this.z=r+o*d+a*c-i*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r,this.y=a[1]*t+a[5]*n+a[9]*r,this.z=a[2]*t+a[6]*n+a[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=LX(this.x,e.x,t.x),this.y=LX(this.y,e.y,t.y),this.z=LX(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=LX(this.x,e,t),this.y=LX(this.y,e,t),this.z=LX(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(LX(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,a=e.z,i=t.x,s=t.y,o=t.z;return this.x=r*o-a*s,this.y=a*i-n*o,this.z=n*s-r*i,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return YX.copy(this).projectOnVector(e),this.sub(YX)}reflect(e){return this.sub(YX.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(LX(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const YX=new WX,XX=new $X;class KX{constructor(e,t,n,r,a,i,s,o,l){KX.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,a,i,s,o,l)}set(e,t,n,r,a,i,s,o,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=a,c[5]=o,c[6]=n,c[7]=i,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,a=this.elements,i=n[0],s=n[3],o=n[6],l=n[1],c=n[4],d=n[7],u=n[2],h=n[5],p=n[8],m=r[0],g=r[3],f=r[6],x=r[1],y=r[4],v=r[7],b=r[2],w=r[5],N=r[8];return a[0]=i*m+s*x+o*b,a[3]=i*g+s*y+o*w,a[6]=i*f+s*v+o*N,a[1]=l*m+c*x+d*b,a[4]=l*g+c*y+d*w,a[7]=l*f+c*v+d*N,a[2]=u*m+h*x+p*b,a[5]=u*g+h*y+p*w,a[8]=u*f+h*v+p*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],s=e[5],o=e[6],l=e[7],c=e[8];return t*i*c-t*s*l-n*a*c+n*s*o+r*a*l-r*i*o}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],s=e[5],o=e[6],l=e[7],c=e[8],d=c*i-s*l,u=s*o-c*a,h=l*a-i*o,p=t*d+n*u+r*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=d*m,e[1]=(r*l-c*n)*m,e[2]=(s*n-r*i)*m,e[3]=u*m,e[4]=(c*t-r*o)*m,e[5]=(r*a-s*t)*m,e[6]=h*m,e[7]=(n*o-l*t)*m,e[8]=(i*t-n*a)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,a,i,s){const o=Math.cos(a),l=Math.sin(a);return this.set(n*o,n*l,-n*(o*i+l*s)+i+e,-r*l,r*o,-r*(-l*i+o*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(qX.makeScale(e,t)),this}rotate(e){return this.premultiply(qX.makeRotation(-e)),this}translate(e,t){return this.premultiply(qX.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const qX=new KX,JX=(new KX).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),QX=(new KX).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function ZX(){const e={enabled:!0,workingColorSpace:iX,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===oX&&(e.r=tK(e.r),e.g=tK(e.g),e.b=tK(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===oX&&(e.r=nK(e.r),e.g=nK(e.g),e.b=nK(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===rX?sX:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return TX("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return TX("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[iX]:{primaries:t,whitePoint:r,transfer:sX,toXYZ:JX,fromXYZ:QX,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:aX},outputColorSpaceConfig:{drawingBufferColorSpace:aX}},[aX]:{primaries:t,whitePoint:r,transfer:oX,toXYZ:JX,fromXYZ:QX,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:aX}}}),e}const eK=ZX();function tK(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function nK(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let rK;class aK{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{void 0===rK&&(rK=jX("canvas")),rK.width=e.width,rK.height=e.height;const t=rK.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),n=rK}return n.toDataURL(t)}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=jX("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),a=r.data;for(let e=0;e<a.length;e++)a[e]=255*tK(a[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*tK(t[e]/255)):t[e]=tK(t[e]);return{data:t,width:e.width,height:e.height}}return kX("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let iK=0;class sK{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:iK++}),this.uuid=BX(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(oK(r[t].image)):e.push(oK(r[t]))}else e=oK(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function oK(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?aK.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(kX("Texture: Unable to serialize Texture."),{})}let lK=0;const cK=new WX;class dK extends PX{constructor(e=dK.DEFAULT_IMAGE,t=dK.DEFAULT_MAPPING,n=1001,r=1001,a=1006,i=1008,s=1023,o=1009,l=dK.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:lK++}),this.uuid=BX(),this.name="",this.source=new sK(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=a,this.minFilter=i,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new VX(0,0),this.repeat=new VX(1,1),this.center=new VX(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new KX,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(cK).x}get height(){return this.source.getSize(cK).y}get depth(){return this.source.getSize(cK).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n){kX(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n:kX(`Texture.setValues(): property '${t}' does not exist.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==PW)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case LW:e.x=e.x-Math.floor(e.x);break;case FW:e.x=e.x<0?0:1;break;case UW:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case LW:e.y=e.y-Math.floor(e.y);break;case FW:e.y=e.y<0?0:1;break;case UW:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}dK.DEFAULT_IMAGE=null,dK.DEFAULT_MAPPING=PW,dK.DEFAULT_ANISOTROPY=1;class uK{constructor(e=0,t=0,n=0,r=1){uK.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,a=this.w,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r+i[12]*a,this.y=i[1]*t+i[5]*n+i[9]*r+i[13]*a,this.z=i[2]*t+i[6]*n+i[10]*r+i[14]*a,this.w=i[3]*t+i[7]*n+i[11]*r+i[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,a;const i=.01,s=.1,o=e.elements,l=o[0],c=o[4],d=o[8],u=o[1],h=o[5],p=o[9],m=o[2],g=o[6],f=o[10];if(Math.abs(c-u)<i&&Math.abs(d-m)<i&&Math.abs(p-g)<i){if(Math.abs(c+u)<s&&Math.abs(d+m)<s&&Math.abs(p+g)<s&&Math.abs(l+h+f-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(h+1)/2,x=(f+1)/2,y=(c+u)/4,v=(d+m)/4,b=(p+g)/4;return e>o&&e>x?e<i?(n=0,r=.707106781,a=.707106781):(n=Math.sqrt(e),r=y/n,a=v/n):o>x?o<i?(n=.707106781,r=0,a=.707106781):(r=Math.sqrt(o),n=y/r,a=b/r):x<i?(n=.707106781,r=.707106781,a=0):(a=Math.sqrt(x),n=v/a,r=b/a),this.set(n,r,a,t),this}let x=Math.sqrt((g-p)*(g-p)+(d-m)*(d-m)+(u-c)*(u-c));return Math.abs(x)<.001&&(x=1),this.x=(g-p)/x,this.y=(d-m)/x,this.z=(u-c)/x,this.w=Math.acos((l+h+f-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=LX(this.x,e.x,t.x),this.y=LX(this.y,e.y,t.y),this.z=LX(this.z,e.z,t.z),this.w=LX(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=LX(this.x,e,t),this.y=LX(this.y,e,t),this.z=LX(this.z,e,t),this.w=LX(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(LX(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class hK extends PX{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:VW,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new uK(0,0,e,t),this.scissorTest=!1,this.viewport=new uK(0,0,e,t);const r={width:e,height:t,depth:n.depth},a=new dK(r);this.textures=[];const i=n.count;for(let s=0;s<i;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:VW,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(t)}}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,a=this.textures.length;r<a;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,!0!==this.textures[r].isData3DTexture&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new sK(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class pK extends hK{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class mK extends dK{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=zW,this.minFilter=zW,this.wrapR=FW,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class gK extends dK{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=zW,this.minFilter=zW,this.wrapR=FW,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fK{constructor(e=new WX(1/0,1/0,1/0),t=new WX(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(yK.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(yK.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yK.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,yK):yK.fromBufferAttribute(r,t),yK.applyMatrix4(e.matrixWorld),this.expandByPoint(yK);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),vK.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),vK.copy(n.boundingBox)),vK.applyMatrix4(e.matrixWorld),this.union(vK)}const r=e.children;for(let a=0,i=r.length;a<i;a++)this.expandByObject(r[a],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,yK),yK.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(AK),CK.subVectors(this.max,AK),bK.subVectors(e.a,AK),wK.subVectors(e.b,AK),NK.subVectors(e.c,AK),SK.subVectors(wK,bK),jK.subVectors(NK,wK),_K.subVectors(bK,NK);let t=[0,-SK.z,SK.y,0,-jK.z,jK.y,0,-_K.z,_K.y,SK.z,0,-SK.x,jK.z,0,-jK.x,_K.z,0,-_K.x,-SK.y,SK.x,0,-jK.y,jK.x,0,-_K.y,_K.x,0];return!!EK(t,bK,wK,NK,CK)&&(t=[1,0,0,0,1,0,0,0,1],!!EK(t,bK,wK,NK,CK)&&(MK.crossVectors(SK,jK),t=[MK.x,MK.y,MK.z],EK(t,bK,wK,NK,CK)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,yK).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(yK).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(xK[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xK[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xK[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xK[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xK[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xK[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xK[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xK[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xK)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const xK=[new WX,new WX,new WX,new WX,new WX,new WX,new WX,new WX],yK=new WX,vK=new fK,bK=new WX,wK=new WX,NK=new WX,SK=new WX,jK=new WX,_K=new WX,AK=new WX,CK=new WX,MK=new WX,kK=new WX;function EK(e,t,n,r,a){for(let i=0,s=e.length-3;i<=s;i+=3){kK.fromArray(e,i);const s=a.x*Math.abs(kK.x)+a.y*Math.abs(kK.y)+a.z*Math.abs(kK.z),o=t.dot(kK),l=n.dot(kK),c=r.dot(kK);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>s)return!1}return!0}const TK=new fK,PK=new WX,DK=new WX;class RK{constructor(e=new WX,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):TK.setFromPoints(e).getCenter(n);let r=0;for(let a=0,i=e.length;a<i;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;PK.subVectors(e,this.center);const t=PK.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(PK,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(DK.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(PK.copy(e.center).add(DK)),this.expandByPoint(PK.copy(e.center).sub(DK))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const IK=new WX,OK=new WX,BK=new WX,LK=new WX,FK=new WX,UK=new WX,zK=new WX;class HK{constructor(e=new WX,t=new WX(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,IK)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=IK.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(IK.copy(this.origin).addScaledVector(this.direction,t),IK.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){OK.copy(e).add(t).multiplyScalar(.5),BK.copy(t).sub(e).normalize(),LK.copy(this.origin).sub(OK);const a=.5*e.distanceTo(t),i=-this.direction.dot(BK),s=LK.dot(this.direction),o=-LK.dot(BK),l=LK.lengthSq(),c=Math.abs(1-i*i);let d,u,h,p;if(c>0)if(d=i*o-s,u=i*s-o,p=a*c,d>=0)if(u>=-p)if(u<=p){const e=1/c;d*=e,u*=e,h=d*(d+i*u+2*s)+u*(i*d+u+2*o)+l}else u=a,d=Math.max(0,-(i*u+s)),h=-d*d+u*(u+2*o)+l;else u=-a,d=Math.max(0,-(i*u+s)),h=-d*d+u*(u+2*o)+l;else u<=-p?(d=Math.max(0,-(-i*a+s)),u=d>0?-a:Math.min(Math.max(-a,-o),a),h=-d*d+u*(u+2*o)+l):u<=p?(d=0,u=Math.min(Math.max(-a,-o),a),h=u*(u+2*o)+l):(d=Math.max(0,-(i*a+s)),u=d>0?a:Math.min(Math.max(-a,-o),a),h=-d*d+u*(u+2*o)+l);else u=i>0?-a:a,d=Math.max(0,-(i*u+s)),h=-d*d+u*(u+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(OK).addScaledVector(BK,u),h}intersectSphere(e,t){IK.subVectors(e.center,this.origin);const n=IK.dot(this.direction),r=IK.dot(IK)-n*n,a=e.radius*e.radius;if(r>a)return null;const i=Math.sqrt(a-r),s=n-i,o=n+i;return o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,a,i,s,o;const l=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,u=this.origin;return l>=0?(n=(e.min.x-u.x)*l,r=(e.max.x-u.x)*l):(n=(e.max.x-u.x)*l,r=(e.min.x-u.x)*l),c>=0?(a=(e.min.y-u.y)*c,i=(e.max.y-u.y)*c):(a=(e.max.y-u.y)*c,i=(e.min.y-u.y)*c),n>i||a>r?null:((a>n||isNaN(n))&&(n=a),(i<r||isNaN(r))&&(r=i),d>=0?(s=(e.min.z-u.z)*d,o=(e.max.z-u.z)*d):(s=(e.max.z-u.z)*d,o=(e.min.z-u.z)*d),n>o||s>r?null:((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,IK)}intersectTriangle(e,t,n,r,a){FK.subVectors(t,e),UK.subVectors(n,e),zK.crossVectors(FK,UK);let i,s=this.direction.dot(zK);if(s>0){if(r)return null;i=1}else{if(!(s<0))return null;i=-1,s=-s}LK.subVectors(this.origin,e);const o=i*this.direction.dot(UK.crossVectors(LK,UK));if(o<0)return null;const l=i*this.direction.dot(FK.cross(LK));if(l<0)return null;if(o+l>s)return null;const c=-i*LK.dot(zK);return c<0?null:this.at(c/s,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class GK{constructor(e,t,n,r,a,i,s,o,l,c,d,u,h,p,m,g){GK.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,a,i,s,o,l,c,d,u,h,p,m,g)}set(e,t,n,r,a,i,s,o,l,c,d,u,h,p,m,g){const f=this.elements;return f[0]=e,f[4]=t,f[8]=n,f[12]=r,f[1]=a,f[5]=i,f[9]=s,f[13]=o,f[2]=l,f[6]=c,f[10]=d,f[14]=u,f[3]=h,f[7]=p,f[11]=m,f[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new GK).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/VK.setFromMatrixColumn(e,0).length(),a=1/VK.setFromMatrixColumn(e,1).length(),i=1/VK.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,a=e.z,i=Math.cos(n),s=Math.sin(n),o=Math.cos(r),l=Math.sin(r),c=Math.cos(a),d=Math.sin(a);if("XYZ"===e.order){const e=i*c,n=i*d,r=s*c,a=s*d;t[0]=o*c,t[4]=-o*d,t[8]=l,t[1]=n+r*l,t[5]=e-a*l,t[9]=-s*o,t[2]=a-e*l,t[6]=r+n*l,t[10]=i*o}else if("YXZ"===e.order){const e=o*c,n=o*d,r=l*c,a=l*d;t[0]=e+a*s,t[4]=r*s-n,t[8]=i*l,t[1]=i*d,t[5]=i*c,t[9]=-s,t[2]=n*s-r,t[6]=a+e*s,t[10]=i*o}else if("ZXY"===e.order){const e=o*c,n=o*d,r=l*c,a=l*d;t[0]=e-a*s,t[4]=-i*d,t[8]=r+n*s,t[1]=n+r*s,t[5]=i*c,t[9]=a-e*s,t[2]=-i*l,t[6]=s,t[10]=i*o}else if("ZYX"===e.order){const e=i*c,n=i*d,r=s*c,a=s*d;t[0]=o*c,t[4]=r*l-n,t[8]=e*l+a,t[1]=o*d,t[5]=a*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*o,t[10]=i*o}else if("YZX"===e.order){const e=i*o,n=i*l,r=s*o,a=s*l;t[0]=o*c,t[4]=a-e*d,t[8]=r*d+n,t[1]=d,t[5]=i*c,t[9]=-s*c,t[2]=-l*c,t[6]=n*d+r,t[10]=e-a*d}else if("XZY"===e.order){const e=i*o,n=i*l,r=s*o,a=s*l;t[0]=o*c,t[4]=-d,t[8]=l*c,t[1]=e*d+a,t[5]=i*c,t[9]=n*d-r,t[2]=r*d-n,t[6]=s*c,t[10]=a*d+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(WK,e,YK)}lookAt(e,t,n){const r=this.elements;return qK.subVectors(e,t),0===qK.lengthSq()&&(qK.z=1),qK.normalize(),XK.crossVectors(n,qK),0===XK.lengthSq()&&(1===Math.abs(n.z)?qK.x+=1e-4:qK.z+=1e-4,qK.normalize(),XK.crossVectors(n,qK)),XK.normalize(),KK.crossVectors(qK,XK),r[0]=XK.x,r[4]=KK.x,r[8]=qK.x,r[1]=XK.y,r[5]=KK.y,r[9]=qK.y,r[2]=XK.z,r[6]=KK.z,r[10]=qK.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,a=this.elements,i=n[0],s=n[4],o=n[8],l=n[12],c=n[1],d=n[5],u=n[9],h=n[13],p=n[2],m=n[6],g=n[10],f=n[14],x=n[3],y=n[7],v=n[11],b=n[15],w=r[0],N=r[4],S=r[8],j=r[12],_=r[1],A=r[5],C=r[9],M=r[13],k=r[2],E=r[6],T=r[10],P=r[14],D=r[3],R=r[7],I=r[11],O=r[15];return a[0]=i*w+s*_+o*k+l*D,a[4]=i*N+s*A+o*E+l*R,a[8]=i*S+s*C+o*T+l*I,a[12]=i*j+s*M+o*P+l*O,a[1]=c*w+d*_+u*k+h*D,a[5]=c*N+d*A+u*E+h*R,a[9]=c*S+d*C+u*T+h*I,a[13]=c*j+d*M+u*P+h*O,a[2]=p*w+m*_+g*k+f*D,a[6]=p*N+m*A+g*E+f*R,a[10]=p*S+m*C+g*T+f*I,a[14]=p*j+m*M+g*P+f*O,a[3]=x*w+y*_+v*k+b*D,a[7]=x*N+y*A+v*E+b*R,a[11]=x*S+y*C+v*T+b*I,a[15]=x*j+y*M+v*P+b*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],a=e[12],i=e[1],s=e[5],o=e[9],l=e[13],c=e[2],d=e[6],u=e[10],h=e[14];return e[3]*(+a*o*d-r*l*d-a*s*u+n*l*u+r*s*h-n*o*h)+e[7]*(+t*o*h-t*l*u+a*i*u-r*i*h+r*l*c-a*o*c)+e[11]*(+t*l*d-t*s*h-a*i*d+n*i*h+a*s*c-n*l*c)+e[15]*(-r*s*c-t*o*d+t*s*u+r*i*d-n*i*u+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],s=e[5],o=e[6],l=e[7],c=e[8],d=e[9],u=e[10],h=e[11],p=e[12],m=e[13],g=e[14],f=e[15],x=d*g*l-m*u*l+m*o*h-s*g*h-d*o*f+s*u*f,y=p*u*l-c*g*l-p*o*h+i*g*h+c*o*f-i*u*f,v=c*m*l-p*d*l+p*s*h-i*m*h-c*s*f+i*d*f,b=p*d*o-c*m*o-p*s*u+i*m*u+c*s*g-i*d*g,w=t*x+n*y+r*v+a*b;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const N=1/w;return e[0]=x*N,e[1]=(m*u*a-d*g*a-m*r*h+n*g*h+d*r*f-n*u*f)*N,e[2]=(s*g*a-m*o*a+m*r*l-n*g*l-s*r*f+n*o*f)*N,e[3]=(d*o*a-s*u*a-d*r*l+n*u*l+s*r*h-n*o*h)*N,e[4]=y*N,e[5]=(c*g*a-p*u*a+p*r*h-t*g*h-c*r*f+t*u*f)*N,e[6]=(p*o*a-i*g*a-p*r*l+t*g*l+i*r*f-t*o*f)*N,e[7]=(i*u*a-c*o*a+c*r*l-t*u*l-i*r*h+t*o*h)*N,e[8]=v*N,e[9]=(p*d*a-c*m*a-p*n*h+t*m*h+c*n*f-t*d*f)*N,e[10]=(i*m*a-p*s*a+p*n*l-t*m*l-i*n*f+t*s*f)*N,e[11]=(c*s*a-i*d*a-c*n*l+t*d*l+i*n*h-t*s*h)*N,e[12]=b*N,e[13]=(c*m*r-p*d*r+p*n*u-t*m*u-c*n*g+t*d*g)*N,e[14]=(p*s*r-i*m*r-p*n*o+t*m*o+i*n*g-t*s*g)*N,e[15]=(i*d*r-c*s*r+c*n*o-t*d*o-i*n*u+t*s*u)*N,this}scale(e){const t=this.elements,n=e.x,r=e.y,a=e.z;return t[0]*=n,t[4]*=r,t[8]*=a,t[1]*=n,t[5]*=r,t[9]*=a,t[2]*=n,t[6]*=r,t[10]*=a,t[3]*=n,t[7]*=r,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),a=1-n,i=e.x,s=e.y,o=e.z,l=a*i,c=a*s;return this.set(l*i+n,l*s-r*o,l*o+r*s,0,l*s+r*o,c*s+n,c*o-r*i,0,l*o-r*s,c*o+r*i,a*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,a,i){return this.set(1,n,a,0,e,1,i,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,a=t._x,i=t._y,s=t._z,o=t._w,l=a+a,c=i+i,d=s+s,u=a*l,h=a*c,p=a*d,m=i*c,g=i*d,f=s*d,x=o*l,y=o*c,v=o*d,b=n.x,w=n.y,N=n.z;return r[0]=(1-(m+f))*b,r[1]=(h+v)*b,r[2]=(p-y)*b,r[3]=0,r[4]=(h-v)*w,r[5]=(1-(u+f))*w,r[6]=(g+x)*w,r[7]=0,r[8]=(p+y)*N,r[9]=(g-x)*N,r[10]=(1-(u+m))*N,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let a=VK.set(r[0],r[1],r[2]).length();const i=VK.set(r[4],r[5],r[6]).length(),s=VK.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],$K.copy(this);const o=1/a,l=1/i,c=1/s;return $K.elements[0]*=o,$K.elements[1]*=o,$K.elements[2]*=o,$K.elements[4]*=l,$K.elements[5]*=l,$K.elements[6]*=l,$K.elements[8]*=c,$K.elements[9]*=c,$K.elements[10]*=c,t.setFromRotationMatrix($K),n.x=a,n.y=i,n.z=s,this}makePerspective(e,t,n,r,a,i,s=2e3,o=!1){const l=this.elements,c=2*a/(t-e),d=2*a/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r);let p,m;if(o)p=a/(i-a),m=i*a/(i-a);else if(s===vX)p=-(i+a)/(i-a),m=-2*i*a/(i-a);else{if(s!==bX)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);p=-i/(i-a),m=-i*a/(i-a)}return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=d,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,a,i,s=2e3,o=!1){const l=this.elements,c=2/(t-e),d=2/(n-r),u=-(t+e)/(t-e),h=-(n+r)/(n-r);let p,m;if(o)p=1/(i-a),m=i/(i-a);else if(s===vX)p=-2/(i-a),m=-(i+a)/(i-a);else{if(s!==bX)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);p=-1/(i-a),m=-a/(i-a)}return l[0]=c,l[4]=0,l[8]=0,l[12]=u,l[1]=0,l[5]=d,l[9]=0,l[13]=h,l[2]=0,l[6]=0,l[10]=p,l[14]=m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const VK=new WX,$K=new GK,WK=new WX(0,0,0),YK=new WX(1,1,1),XK=new WX,KK=new WX,qK=new WX,JK=new GK,QK=new $X;class ZK{constructor(e=0,t=0,n=0,r=ZK.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,a=r[0],i=r[4],s=r[8],o=r[1],l=r[5],c=r[9],d=r[2],u=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin(LX(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-i,a)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-LX(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-d,a),this._z=0);break;case"ZXY":this._x=Math.asin(LX(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-i,l)):(this._y=0,this._z=Math.atan2(o,a));break;case"ZYX":this._y=Math.asin(-LX(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(o,a)):(this._x=0,this._z=Math.atan2(-i,l));break;case"YZX":this._z=Math.asin(LX(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(s,h));break;case"XZY":this._z=Math.asin(-LX(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,h),this._y=0);break;default:kX("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return JK.makeRotationFromQuaternion(e),this.setFromRotationMatrix(JK,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return QK.setFromEuler(this),this.setFromQuaternion(QK,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ZK.DEFAULT_ORDER="XYZ";class eq{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let tq=0;const nq=new WX,rq=new $X,aq=new GK,iq=new WX,sq=new WX,oq=new WX,lq=new $X,cq=new WX(1,0,0),dq=new WX(0,1,0),uq=new WX(0,0,1),hq={type:"added"},pq={type:"removed"},mq={type:"childadded",child:null},gq={type:"childremoved",child:null};class fq extends PX{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tq++}),this.uuid=BX(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=fq.DEFAULT_UP.clone();const e=new WX,t=new ZK,n=new $X,r=new WX(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new GK},normalMatrix:{value:new KX}}),this.matrix=new GK,this.matrixWorld=new GK,this.matrixAutoUpdate=fq.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=fq.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new eq,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rq.setFromAxisAngle(e,t),this.quaternion.multiply(rq),this}rotateOnWorldAxis(e,t){return rq.setFromAxisAngle(e,t),this.quaternion.premultiply(rq),this}rotateX(e){return this.rotateOnAxis(cq,e)}rotateY(e){return this.rotateOnAxis(dq,e)}rotateZ(e){return this.rotateOnAxis(uq,e)}translateOnAxis(e,t){return nq.copy(e).applyQuaternion(this.quaternion),this.position.add(nq.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(cq,e)}translateY(e){return this.translateOnAxis(dq,e)}translateZ(e){return this.translateOnAxis(uq,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(aq.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?iq.copy(e):iq.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),sq.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?aq.lookAt(sq,iq,this.up):aq.lookAt(iq,sq,this.up),this.quaternion.setFromRotationMatrix(aq),r&&(aq.extractRotation(r.matrixWorld),rq.setFromRotationMatrix(aq),this.quaternion.premultiply(rq.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(EX("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(hq),mq.child=e,this.dispatchEvent(mq),mq.child=null):EX("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(pq),gq.child=e,this.dispatchEvent(gq),gq.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),aq.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),aq.multiply(e.parent.matrixWorld)),e.applyMatrix4(aq),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(hq),mq.child=e,this.dispatchEvent(mq),mq.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let a=0,i=r.length;a<i;a++)r[a].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sq,e,oq),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sq,lq,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};function a(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(e=>c(l({},e),{boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(e=>l({},e)),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];a(e.shapes,r)}else a(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(a(e.materials,this.material[n]));r.material=t}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(a(e.animations,n))}}if(t){const t=i(e.geometries),r=i(e.materials),a=i(e.textures),s=i(e.images),o=i(e.shapes),l=i(e.skeletons),c=i(e.animations),d=i(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),a.length>0&&(n.textures=a),s.length>0&&(n.images=s),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),d.length>0&&(n.nodes=d)}return n.object=r,n;function i(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}fq.DEFAULT_UP=new WX(0,1,0),fq.DEFAULT_MATRIX_AUTO_UPDATE=!0,fq.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const xq=new WX,yq=new WX,vq=new WX,bq=new WX,wq=new WX,Nq=new WX,Sq=new WX,jq=new WX,_q=new WX,Aq=new WX,Cq=new uK,Mq=new uK,kq=new uK;class Eq{constructor(e=new WX,t=new WX,n=new WX){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),xq.subVectors(e,t),r.cross(xq);const a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(e,t,n,r,a){xq.subVectors(r,t),yq.subVectors(n,t),vq.subVectors(e,t);const i=xq.dot(xq),s=xq.dot(yq),o=xq.dot(vq),l=yq.dot(yq),c=yq.dot(vq),d=i*l-s*s;if(0===d)return a.set(0,0,0),null;const u=1/d,h=(l*o-s*c)*u,p=(i*c-s*o)*u;return a.set(1-h-p,p,h)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,bq)&&(bq.x>=0&&bq.y>=0&&bq.x+bq.y<=1)}static getInterpolation(e,t,n,r,a,i,s,o){return null===this.getBarycoord(e,t,n,r,bq)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(a,bq.x),o.addScaledVector(i,bq.y),o.addScaledVector(s,bq.z),o)}static getInterpolatedAttribute(e,t,n,r,a,i){return Cq.setScalar(0),Mq.setScalar(0),kq.setScalar(0),Cq.fromBufferAttribute(e,t),Mq.fromBufferAttribute(e,n),kq.fromBufferAttribute(e,r),i.setScalar(0),i.addScaledVector(Cq,a.x),i.addScaledVector(Mq,a.y),i.addScaledVector(kq,a.z),i}static isFrontFacing(e,t,n,r){return xq.subVectors(n,t),yq.subVectors(e,t),xq.cross(yq).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return xq.subVectors(this.c,this.b),yq.subVectors(this.a,this.b),.5*xq.cross(yq).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Eq.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Eq.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,a){return Eq.getInterpolation(e,this.a,this.b,this.c,t,n,r,a)}containsPoint(e){return Eq.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Eq.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,a=this.c;let i,s;wq.subVectors(r,n),Nq.subVectors(a,n),jq.subVectors(e,n);const o=wq.dot(jq),l=Nq.dot(jq);if(o<=0&&l<=0)return t.copy(n);_q.subVectors(e,r);const c=wq.dot(_q),d=Nq.dot(_q);if(c>=0&&d<=c)return t.copy(r);const u=o*d-c*l;if(u<=0&&o>=0&&c<=0)return i=o/(o-c),t.copy(n).addScaledVector(wq,i);Aq.subVectors(e,a);const h=wq.dot(Aq),p=Nq.dot(Aq);if(p>=0&&h<=p)return t.copy(a);const m=h*l-o*p;if(m<=0&&l>=0&&p<=0)return s=l/(l-p),t.copy(n).addScaledVector(Nq,s);const g=c*p-h*d;if(g<=0&&d-c>=0&&h-p>=0)return Sq.subVectors(a,r),s=(d-c)/(d-c+(h-p)),t.copy(r).addScaledVector(Sq,s);const f=1/(g+m+u);return i=m*f,s=u*f,t.copy(n).addScaledVector(wq,i).addScaledVector(Nq,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Tq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Pq={h:0,s:0,l:0},Dq={h:0,s:0,l:0};function Rq(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Iq{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=aX){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,eK.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=eK.workingColorSpace){return this.r=e,this.g=t,this.b=n,eK.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=eK.workingColorSpace){if(e=FX(e,1),t=LX(t,0,1),n=LX(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,a=2*n-r;this.r=Rq(a,r,e+1/3),this.g=Rq(a,r,e),this.b=Rq(a,r,e-1/3)}return eK.colorSpaceToWorking(this,r),this}setStyle(e,t=aX){function n(t){void 0!==t&&parseFloat(t)<1&&kX("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const i=r[1],s=r[2];switch(i){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:kX("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],a=n.length;if(3===a)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===a)return this.setHex(parseInt(n,16),t);kX("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=aX){const n=Tq[e.toLowerCase()];return void 0!==n?this.setHex(n,t):kX("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=tK(e.r),this.g=tK(e.g),this.b=tK(e.b),this}copyLinearToSRGB(e){return this.r=nK(e.r),this.g=nK(e.g),this.b=nK(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=aX){return eK.workingToColorSpace(Oq.copy(this),e),65536*Math.round(LX(255*Oq.r,0,255))+256*Math.round(LX(255*Oq.g,0,255))+Math.round(LX(255*Oq.b,0,255))}getHexString(e=aX){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=eK.workingColorSpace){eK.workingToColorSpace(Oq.copy(this),t);const n=Oq.r,r=Oq.g,a=Oq.b,i=Math.max(n,r,a),s=Math.min(n,r,a);let o,l;const c=(s+i)/2;if(s===i)o=0,l=0;else{const e=i-s;switch(l=c<=.5?e/(i+s):e/(2-i-s),i){case n:o=(r-a)/e+(r<a?6:0);break;case r:o=(a-n)/e+2;break;case a:o=(n-r)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t=eK.workingColorSpace){return eK.workingToColorSpace(Oq.copy(this),t),e.r=Oq.r,e.g=Oq.g,e.b=Oq.b,e}getStyle(e=aX){eK.workingToColorSpace(Oq.copy(this),e);const t=Oq.r,n=Oq.g,r=Oq.b;return e!==aX?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(Pq),this.setHSL(Pq.h+e,Pq.s+t,Pq.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Pq),e.getHSL(Dq);const n=UX(Pq.h,Dq.h,t),r=UX(Pq.s,Dq.s,t),a=UX(Pq.l,Dq.l,t);return this.setHSL(n,r,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*r,this.g=a[1]*t+a[4]*n+a[7]*r,this.b=a[2]*t+a[5]*n+a[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Oq=new Iq;Iq.NAMES=Tq;let Bq=0;class Lq extends PX{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Bq++}),this.uuid=BX(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=uW,this.blendDst=hW,this.blendEquation=aW,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Iq(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lX,this.stencilZFail=lX,this.stencilZPass=lX,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){kX(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:kX(`Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==uW&&(n.blendSrc=this.blendSrc),this.blendDst!==hW&&(n.blendDst=this.blendDst),this.blendEquation!==aW&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==lX&&(n.stencilFail=this.stencilFail),this.stencilZFail!==lX&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==lX&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),a=r(e.images);t.length>0&&(n.textures=t),a.length>0&&(n.images=a)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Fq extends Lq{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Iq(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ZK,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Uq=zq();function zq(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),a=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,a[l]=24,a[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,a[l]=-e-1,a[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,a[l]=13,a[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,a[l]=24,a[256|l]=24):(r[l]=31744,r[256|l]=64512,a[l]=13,a[256|l]=13)}const i=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;!(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,i[l]=e|t}for(let l=1024;l<2048;++l)i[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)s[l]=l<<23;s[31]=1199570944,s[32]=2147483648;for(let l=33;l<63;++l)s[l]=2147483648+(l-32<<23);s[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:a,mantissaTable:i,exponentTable:s,offsetTable:o}}function Hq(e){Math.abs(e)>65504&&kX("DataUtils.toHalfFloat(): Value out of range."),e=LX(e,-65504,65504),Uq.floatView[0]=e;const t=Uq.uint32View[0],n=t>>23&511;return Uq.baseTable[n]+((8388607&t)>>Uq.shiftTable[n])}function Gq(e){const t=e>>10;return Uq.uint32View[0]=Uq.mantissaTable[Uq.offsetTable[t]+(1023&e)]+Uq.exponentTable[t],Uq.floatView[0]}class Vq{static toHalfFloat(e){return Hq(e)}static fromHalfFloat(e){return Gq(e)}}const $q=new WX,Wq=new VX;let Yq=0;class Xq{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Yq++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=xX,this.updateRanges=[],this.gpuType=eY,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,a=this.itemSize;r<a;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Wq.fromBufferAttribute(this,t),Wq.applyMatrix3(e),this.setXY(t,Wq.x,Wq.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)$q.fromBufferAttribute(this,t),$q.applyMatrix3(e),this.setXYZ(t,$q.x,$q.y,$q.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)$q.fromBufferAttribute(this,t),$q.applyMatrix4(e),this.setXYZ(t,$q.x,$q.y,$q.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)$q.fromBufferAttribute(this,t),$q.applyNormalMatrix(e),this.setXYZ(t,$q.x,$q.y,$q.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)$q.fromBufferAttribute(this,t),$q.transformDirection(e),this.setXYZ(t,$q.x,$q.y,$q.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=zX(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=HX(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=zX(t,this.array)),t}setX(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=zX(t,this.array)),t}setY(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=zX(t,this.array)),t}setZ(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=zX(t,this.array)),t}setW(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array),r=HX(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,a){return e*=this.itemSize,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array),r=HX(r,this.array),a=HX(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==xX&&(e.usage=this.usage),e}}class Kq extends Xq{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class qq extends Xq{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Jq extends Xq{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Qq=0;const Zq=new GK,eJ=new fq,tJ=new WX,nJ=new fK,rJ=new fK,aJ=new WX;class iJ extends PX{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Qq++}),this.uuid=BX(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(wX(e)?qq:Kq)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new KX).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Zq.makeRotationFromQuaternion(e),this.applyMatrix4(Zq),this}rotateX(e){return Zq.makeRotationX(e),this.applyMatrix4(Zq),this}rotateY(e){return Zq.makeRotationY(e),this.applyMatrix4(Zq),this}rotateZ(e){return Zq.makeRotationZ(e),this.applyMatrix4(Zq),this}translate(e,t,n){return Zq.makeTranslation(e,t,n),this.applyMatrix4(Zq),this}scale(e,t,n){return Zq.makeScale(e,t,n),this.applyMatrix4(Zq),this}lookAt(e){return eJ.lookAt(e),eJ.updateMatrix(),this.applyMatrix4(eJ.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tJ).negate(),this.translate(tJ.x,tJ.y,tJ.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new Jq(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length>t.count&&kX("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fK);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return EX("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new WX(-1/0,-1/0,-1/0),new WX(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];nJ.setFromBufferAttribute(e),this.morphTargetsRelative?(aJ.addVectors(this.boundingBox.min,nJ.min),this.boundingBox.expandByPoint(aJ),aJ.addVectors(this.boundingBox.max,nJ.max),this.boundingBox.expandByPoint(aJ)):(this.boundingBox.expandByPoint(nJ.min),this.boundingBox.expandByPoint(nJ.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&EX('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new RK);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return EX("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new WX,1/0);if(e){const n=this.boundingSphere.center;if(nJ.setFromBufferAttribute(e),t)for(let e=0,a=t.length;e<a;e++){const n=t[e];rJ.setFromBufferAttribute(n),this.morphTargetsRelative?(aJ.addVectors(nJ.min,rJ.min),nJ.expandByPoint(aJ),aJ.addVectors(nJ.max,rJ.max),nJ.expandByPoint(aJ)):(nJ.expandByPoint(rJ.min),nJ.expandByPoint(rJ.max))}nJ.getCenter(n);let r=0;for(let t=0,a=e.count;t<a;t++)aJ.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(aJ));if(t)for(let a=0,i=t.length;a<i;a++){const i=t[a],s=this.morphTargetsRelative;for(let t=0,a=i.count;t<a;t++)aJ.fromBufferAttribute(i,t),s&&(tJ.fromBufferAttribute(e,t),aJ.add(tJ)),r=Math.max(r,n.distanceToSquared(aJ))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&EX('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void EX("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,a=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Xq(new Float32Array(4*n.count),4));const i=this.getAttribute("tangent"),s=[],o=[];for(let S=0;S<n.count;S++)s[S]=new WX,o[S]=new WX;const l=new WX,c=new WX,d=new WX,u=new VX,h=new VX,p=new VX,m=new WX,g=new WX;function f(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),d.fromBufferAttribute(n,r),u.fromBufferAttribute(a,e),h.fromBufferAttribute(a,t),p.fromBufferAttribute(a,r),c.sub(l),d.sub(l),h.sub(u),p.sub(u);const i=1/(h.x*p.y-p.x*h.y);isFinite(i)&&(m.copy(c).multiplyScalar(p.y).addScaledVector(d,-h.y).multiplyScalar(i),g.copy(d).multiplyScalar(h.x).addScaledVector(c,-p.x).multiplyScalar(i),s[e].add(m),s[t].add(m),s[r].add(m),o[e].add(g),o[t].add(g),o[r].add(g))}let x=this.groups;0===x.length&&(x=[{start:0,count:e.count}]);for(let S=0,j=x.length;S<j;++S){const t=x[S],n=t.start;for(let r=n,a=n+t.count;r<a;r+=3)f(e.getX(r+0),e.getX(r+1),e.getX(r+2))}const y=new WX,v=new WX,b=new WX,w=new WX;function N(e){b.fromBufferAttribute(r,e),w.copy(b);const t=s[e];y.copy(t),y.sub(b.multiplyScalar(b.dot(t))).normalize(),v.crossVectors(w,t);const n=v.dot(o[e])<0?-1:1;i.setXYZW(e,y.x,y.y,y.z,n)}for(let S=0,j=x.length;S<j;++S){const t=x[S],n=t.start;for(let r=n,a=n+t.count;r<a;r+=3)N(e.getX(r+0)),N(e.getX(r+1)),N(e.getX(r+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Xq(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new WX,a=new WX,i=new WX,s=new WX,o=new WX,l=new WX,c=new WX,d=new WX;if(e)for(let u=0,h=e.count;u<h;u+=3){const h=e.getX(u+0),p=e.getX(u+1),m=e.getX(u+2);r.fromBufferAttribute(t,h),a.fromBufferAttribute(t,p),i.fromBufferAttribute(t,m),c.subVectors(i,a),d.subVectors(r,a),c.cross(d),s.fromBufferAttribute(n,h),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),s.add(c),o.add(c),l.add(c),n.setXYZ(h,s.x,s.y,s.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(m,l.x,l.y,l.z)}else for(let e=0,u=t.count;e<u;e+=3)r.fromBufferAttribute(t,e+0),a.fromBufferAttribute(t,e+1),i.fromBufferAttribute(t,e+2),c.subVectors(i,a),d.subVectors(r,a),c.cross(d),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)aJ.fromBufferAttribute(e,t),aJ.normalize(),e.setXYZ(t,aJ.x,aJ.y,aJ.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,a=e.normalized,i=new n.constructor(t.length*r);let s=0,o=0;for(let l=0,c=t.length;l<c;l++){s=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)i[o++]=n[s++]}return new Xq(i,r,a)}if(null===this.index)return kX("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new iJ,n=this.index.array,r=this.attributes;for(const s in r){const a=e(r[s],n);t.setAttribute(s,a)}const a=this.morphAttributes;for(const s in a){const r=[],i=a[s];for(let t=0,a=i.length;t<a;t++){const a=e(i[t],n);r.push(a)}t.morphAttributes[s]=r}t.morphTargetsRelative=this.morphTargetsRelative;const i=this.groups;for(let s=0,o=i.length;s<o;s++){const e=i[s];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const r={};let a=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let r=0,a=t.length;r<a;r++){const a=t[r];n.push(a.toJSON(e.data))}n.length>0&&(r[o]=n,a=!0)}a&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const i=this.groups;i.length>0&&(e.data.groups=JSON.parse(JSON.stringify(i)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere=s.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const a=e.morphAttributes;for(const l in a){const e=[],n=a[l];for(let r=0,a=n.length;r<a;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const i=e.groups;for(let l=0,c=i.length;l<c;l++){const e=i[l];this.addGroup(e.start,e.count,e.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const sJ=new GK,oJ=new HK,lJ=new RK,cJ=new WX,dJ=new WX,uJ=new WX,hJ=new WX,pJ=new WX,mJ=new WX,gJ=new WX,fJ=new WX;class xJ extends fq{constructor(e=new iJ,t=new Fq){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,a=n.morphAttributes.position,i=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(a&&s){mJ.set(0,0,0);for(let n=0,r=a.length;n<r;n++){const r=s[n],o=a[n];0!==r&&(pJ.fromBufferAttribute(o,e),i?mJ.addScaledVector(pJ,r):mJ.addScaledVector(pJ.sub(t),r))}t.add(mJ)}return t}raycast(e,t){const n=this.geometry,r=this.material,a=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),lJ.copy(n.boundingSphere),lJ.applyMatrix4(a),oJ.copy(e.ray).recast(e.near),!1===lJ.containsPoint(oJ.origin)){if(null===oJ.intersectSphere(lJ,cJ))return;if(oJ.origin.distanceToSquared(cJ)>s(e.far-e.near,2))return}sJ.copy(a).invert(),oJ.copy(e.ray).applyMatrix4(sJ),null!==n.boundingBox&&!1===oJ.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,oJ)}}_computeIntersections(e,t,n){let r;const a=this.geometry,i=this.material,s=a.index,o=a.attributes.position,l=a.attributes.uv,c=a.attributes.uv1,d=a.attributes.normal,u=a.groups,h=a.drawRange;if(null!==s)if(Array.isArray(i))for(let p=0,m=u.length;p<m;p++){const a=u[p],o=i[a.materialIndex];for(let i=Math.max(a.start,h.start),u=Math.min(s.count,Math.min(a.start+a.count,h.start+h.count));i<u;i+=3){r=yJ(this,o,e,n,l,c,d,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=a.materialIndex,t.push(r))}}else{for(let a=Math.max(0,h.start),o=Math.min(s.count,h.start+h.count);a<o;a+=3){r=yJ(this,i,e,n,l,c,d,s.getX(a),s.getX(a+1),s.getX(a+2)),r&&(r.faceIndex=Math.floor(a/3),t.push(r))}}else if(void 0!==o)if(Array.isArray(i))for(let p=0,m=u.length;p<m;p++){const a=u[p],s=i[a.materialIndex];for(let i=Math.max(a.start,h.start),u=Math.min(o.count,Math.min(a.start+a.count,h.start+h.count));i<u;i+=3){r=yJ(this,s,e,n,l,c,d,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=a.materialIndex,t.push(r))}}else{for(let a=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);a<s;a+=3){r=yJ(this,i,e,n,l,c,d,a,a+1,a+2),r&&(r.faceIndex=Math.floor(a/3),t.push(r))}}}}function yJ(e,t,n,r,a,i,s,o,l,c){e.getVertexPosition(o,dJ),e.getVertexPosition(l,uJ),e.getVertexPosition(c,hJ);const d=function(e,t,n,r,a,i,s,o){let l;if(l=t.side===nW?r.intersectTriangle(s,i,a,!0,o):r.intersectTriangle(a,i,s,0===t.side,o),null===l)return null;fJ.copy(o),fJ.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(fJ);return c<n.near||c>n.far?null:{distance:c,point:fJ.clone(),object:e}}(e,t,n,r,dJ,uJ,hJ,gJ);if(d){const e=new WX;Eq.getBarycoord(gJ,dJ,uJ,hJ,e),a&&(d.uv=Eq.getInterpolatedAttribute(a,o,l,c,e,new VX)),i&&(d.uv1=Eq.getInterpolatedAttribute(i,o,l,c,e,new VX)),s&&(d.normal=Eq.getInterpolatedAttribute(s,o,l,c,e,new WX),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const t={a:o,b:l,c:c,normal:new WX,materialIndex:0};Eq.getNormal(dJ,uJ,hJ,t.normal),d.face=t,d.barycoord=e}return d}class vJ extends iJ{constructor(e=1,t=1,n=1,r=1,a=1,i=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:a,depthSegments:i};const s=this;r=Math.floor(r),a=Math.floor(a),i=Math.floor(i);const o=[],l=[],c=[],d=[];let u=0,h=0;function p(e,t,n,r,a,i,p,m,g,f,x){const y=i/g,v=p/f,b=i/2,w=p/2,N=m/2,S=g+1,j=f+1;let _=0,A=0;const C=new WX;for(let s=0;s<j;s++){const i=s*v-w;for(let o=0;o<S;o++){const u=o*y-b;C[e]=u*r,C[t]=i*a,C[n]=N,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=m>0?1:-1,c.push(C.x,C.y,C.z),d.push(o/g),d.push(1-s/f),_+=1}}for(let s=0;s<f;s++)for(let e=0;e<g;e++){const t=u+e+S*s,n=u+e+S*(s+1),r=u+(e+1)+S*(s+1),a=u+(e+1)+S*s;o.push(t,n,a),o.push(n,r,a),A+=6}s.addGroup(h,A,x),h+=A,u+=_}p("z","y","x",-1,-1,n,t,e,i,a,0),p("z","y","x",1,-1,n,t,-e,i,a,1),p("x","z","y",1,1,e,n,t,r,i,2),p("x","z","y",1,-1,e,n,-t,r,i,3),p("x","y","z",1,-1,e,t,n,r,a,4),p("x","y","z",-1,-1,e,t,-n,r,a,5),this.setIndex(o),this.setAttribute("position",new Jq(l,3)),this.setAttribute("normal",new Jq(c,3)),this.setAttribute("uv",new Jq(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vJ(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function bJ(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const a=e[n][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(kX("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=a.clone():Array.isArray(a)?t[n][r]=a.slice():t[n][r]=a}}return t}function wJ(e){const t={};for(let n=0;n<e.length;n++){const r=bJ(e[n]);for(const e in r)t[e]=r[e]}return t}function NJ(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:eK.workingColorSpace}const SJ={clone:bJ,merge:wJ};class jJ extends Lq{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bJ(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class _J extends fq{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new GK,this.projectionMatrix=new GK,this.projectionMatrixInverse=new GK,this.coordinateSystem=vX,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const AJ=new WX,CJ=new VX,MJ=new VX;class kJ extends _J{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*OX*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*IX*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*OX*Math.atan(Math.tan(.5*IX*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){AJ.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(AJ.x,AJ.y).multiplyScalar(-e/AJ.z),AJ.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(AJ.x,AJ.y).multiplyScalar(-e/AJ.z)}getViewSize(e,t){return this.getViewBounds(e,CJ,MJ),t.subVectors(MJ,CJ)}setViewOffset(e,t,n,r,a,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*IX*this.fov)/this.zoom,n=2*t,r=this.aspect*n,a=-.5*r;const i=this.view;if(null!==this.view&&this.view.enabled){const e=i.fullWidth,s=i.fullHeight;a+=i.offsetX*r/e,t-=i.offsetY*n/s,r*=i.width/e,n*=i.height/s}const s=this.filmOffset;0!==s&&(a+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const EJ=-90;class TJ extends fq{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new kJ(EJ,1,e,t);r.layers=this.layers,this.add(r);const a=new kJ(EJ,1,e,t);a.layers=this.layers,this.add(a);const i=new kJ(EJ,1,e,t);i.layers=this.layers,this.add(i);const s=new kJ(EJ,1,e,t);s.layers=this.layers,this.add(s);const o=new kJ(EJ,1,e,t);o.layers=this.layers,this.add(o);const l=new kJ(EJ,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,a,i,s,o]=t;for(const l of t)this.remove(l);if(e===vX)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),i.up.set(0,0,1),i.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==bX)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),i.up.set(0,0,-1),i.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,i,s,o,l,c]=this.children,d=e.getRenderTarget(),u=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const m=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,a),e.setRenderTarget(n,1,r),e.render(t,i),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,o),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=m,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(d,u,h),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class PJ extends dK{constructor(e=[],t=301,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,s,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class DJ extends pK{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new PJ(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new vJ(5,5,5),a=new jJ({name:"CubemapFromEquirect",uniforms:bJ(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:nW,blending:0});a.uniforms.tEquirect.value=t;const i=new xJ(r,a),s=t.minFilter;t.minFilter===WW&&(t.minFilter=VW);return new TJ(1,10,this).update(e,i),t.minFilter=s,i.geometry.dispose(),i.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const a=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(a)}}class RJ extends fq{constructor(){super(),this.isGroup=!0,this.type="Group"}}const IJ={type:"move"};class OJ{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new RJ,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new RJ,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new WX,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new WX),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new RJ,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new WX,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new WX),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,a=null,i=null;const s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){i=!0;for(const i of e.hand.values()){const e=t.getJointPose(i,n),r=this._getHandJoint(l,i);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],a=l.joints["thumb-tip"],s=r.position.distanceTo(a.position),o=.02,c=.005;l.inputState.pinching&&s>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),null!==a&&(o.matrix.fromArray(a.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,a.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(a.linearVelocity)):o.hasLinearVelocity=!1,a.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(a.angularVelocity)):o.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==a&&(r=a),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(IJ)))}return null!==s&&(s.visible=null!==r),null!==o&&(o.visible=null!==a),null!==l&&(l.visible=null!==i),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new RJ;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class BJ{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Iq(e),this.density=t}clone(){return new BJ(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class LJ{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Iq(e),this.near=t,this.far=n}clone(){return new LJ(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class FJ extends fq{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ZK,this.environmentIntensity=1,this.environmentRotation=new ZK,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class UJ{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=xX,this.updateRanges=[],this.version=0,this.uuid=BX()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,a=this.stride;r<a;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=BX()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=BX()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const zJ=new WX;class HJ{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)zJ.fromBufferAttribute(this,t),zJ.applyMatrix4(e),this.setXYZ(t,zJ.x,zJ.y,zJ.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)zJ.fromBufferAttribute(this,t),zJ.applyNormalMatrix(e),this.setXYZ(t,zJ.x,zJ.y,zJ.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)zJ.fromBufferAttribute(this,t),zJ.transformDirection(e),this.setXYZ(t,zJ.x,zJ.y,zJ.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=zX(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=HX(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=HX(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=HX(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=HX(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=HX(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=zX(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=zX(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=zX(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=zX(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array),r=HX(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array),r=HX(r,this.array),a=HX(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=a,this}clone(e){if(void 0===e){MX("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new Xq(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new HJ(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){MX("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class GJ extends Lq{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Iq(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let VJ;const $J=new WX,WJ=new WX,YJ=new WX,XJ=new VX,KJ=new VX,qJ=new GK,JJ=new WX,QJ=new WX,ZJ=new WX,eQ=new VX,tQ=new VX,nQ=new VX;class rQ extends fq{constructor(e=new GJ){if(super(),this.isSprite=!0,this.type="Sprite",void 0===VJ){VJ=new iJ;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new UJ(e,5);VJ.setIndex([0,1,2,0,2,3]),VJ.setAttribute("position",new HJ(t,3,0,!1)),VJ.setAttribute("uv",new HJ(t,2,3,!1))}this.geometry=VJ,this.material=e,this.center=new VX(.5,.5),this.count=1}raycast(e,t){null===e.camera&&EX('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),WJ.setFromMatrixScale(this.matrixWorld),qJ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),YJ.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&WJ.multiplyScalar(-YJ.z);const n=this.material.rotation;let r,a;0!==n&&(a=Math.cos(n),r=Math.sin(n));const i=this.center;aQ(JJ.set(-.5,-.5,0),YJ,i,WJ,r,a),aQ(QJ.set(.5,-.5,0),YJ,i,WJ,r,a),aQ(ZJ.set(.5,.5,0),YJ,i,WJ,r,a),eQ.set(0,0),tQ.set(1,0),nQ.set(1,1);let s=e.ray.intersectTriangle(JJ,QJ,ZJ,!1,$J);if(null===s&&(aQ(QJ.set(-.5,.5,0),YJ,i,WJ,r,a),tQ.set(0,1),s=e.ray.intersectTriangle(JJ,ZJ,QJ,!1,$J),null===s))return;const o=e.ray.origin.distanceTo($J);o<e.near||o>e.far||t.push({distance:o,point:$J.clone(),uv:Eq.getInterpolation($J,JJ,QJ,ZJ,eQ,tQ,nQ,new VX),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function aQ(e,t,n,r,a,i){XJ.subVectors(e,n).addScalar(.5).multiply(r),void 0!==a?(KJ.x=i*XJ.x-a*XJ.y,KJ.y=a*XJ.x+i*XJ.y):KJ.copy(XJ),e.copy(t),e.x+=KJ.x,e.y+=KJ.y,e.applyMatrix4(qJ)}const iQ=new WX,sQ=new WX;class oQ extends fq{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let a;for(a=0;a<r.length&&!(t<r[a].distance);a++);return r.splice(a,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){iQ.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(iQ);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){iQ.setFromMatrixPosition(e.matrixWorld),sQ.setFromMatrixPosition(this.matrixWorld);const n=iQ.distanceTo(sQ)/e.zoom;let r,a;for(t[0].object.visible=!0,r=1,a=t.length;r<a;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),!(n>=e))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<a;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,a=n.length;r<a;r++){const e=n[r];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const lQ=new WX,cQ=new uK,dQ=new uK,uQ=new WX,hQ=new GK,pQ=new WX,mQ=new RK,gQ=new GK,fQ=new HK;class xQ extends xJ{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=EW,this.bindMatrix=new GK,this.bindMatrixInverse=new GK,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new fK),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,pQ),this.boundingBox.expandByPoint(pQ)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new RK),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,pQ),this.boundingSphere.expandByPoint(pQ)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),mQ.copy(this.boundingSphere),mQ.applyMatrix4(r),!1!==e.ray.intersectsSphere(mQ)&&(gQ.copy(r).invert(),fQ.copy(e.ray).applyMatrix4(gQ),null!==this.boundingBox&&!1===fQ.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,fQ)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new uK,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===EW?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===TW?this.bindMatrixInverse.copy(this.bindMatrix).invert():kX("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;cQ.fromBufferAttribute(r.attributes.skinIndex,e),dQ.fromBufferAttribute(r.attributes.skinWeight,e),lQ.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const e=dQ.getComponent(a);if(0!==e){const r=cQ.getComponent(a);hQ.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(uQ.copy(lQ).applyMatrix4(hQ),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class yQ extends fq{constructor(){super(),this.isBone=!0,this.type="Bone"}}class vQ extends dK{constructor(e=null,t=1,n=1,r,a,i,s,o,l=1003,c=1003,d,u){super(null,i,s,o,l,c,r,a,d,u),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const bQ=new GK,wQ=new GK;class NQ{constructor(e=[],t=[]){this.uuid=BX(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){kX("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new GK)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new GK;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let a=0,i=e.length;a<i;a++){const r=e[a]?e[a].matrixWorld:wQ;bQ.multiplyMatrices(r,t[a]),bQ.toArray(n,16*a)}null!==r&&(r.needsUpdate=!0)}clone(){return new NQ(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new vQ(t,e,e,cY,eY);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let a=t[r];void 0===a&&(kX("Skeleton: No bone found with UUID:",r),a=new yQ),this.bones.push(a),this.boneInverses.push((new GK).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,a=t.length;r<a;r++){const a=t[r];e.bones.push(a.uuid);const i=n[r];e.boneInverses.push(i.toArray())}return e}}class SQ extends Xq{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const jQ=new GK,_Q=new GK,AQ=[],CQ=new fK,MQ=new GK,kQ=new xJ,EQ=new RK;class TQ extends xJ{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new SQ(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,MQ)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new fK),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,jQ),CQ.copy(e.boundingBox).applyMatrix4(jQ),this.boundingBox.union(CQ)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new RK),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,jQ),EQ.copy(e.boundingSphere).applyMatrix4(jQ),this.boundingSphere.union(EQ)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,a=e*(n.length+1)+1;for(let i=0;i<n.length;i++)n[i]=r[a+i]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(kQ.geometry=this.geometry,kQ.material=this.material,void 0!==kQ.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),EQ.copy(this.boundingSphere),EQ.applyMatrix4(n),!1!==e.ray.intersectsSphere(EQ)))for(let a=0;a<r;a++){this.getMatrixAt(a,jQ),_Q.multiplyMatrices(n,jQ),kQ.matrixWorld=_Q,kQ.raycast(e,AQ);for(let e=0,n=AQ.length;e<n;e++){const n=AQ[e];n.instanceId=a,n.object=this,t.push(n)}AQ.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new SQ(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new vQ(new Float32Array(r*this.count),r,this.count,hY,eY));const a=this.morphTexture.source.data.data;let i=0;for(let l=0;l<n.length;l++)i+=n[l];const s=this.geometry.morphTargetsRelative?1:1-i,o=r*e;a[o]=s,a.set(n,o+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const PQ=new WX,DQ=new WX,RQ=new KX;class IQ{constructor(e=new WX(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=PQ.subVectors(n,t).cross(DQ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(PQ),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||RQ.getNormalMatrix(e),r=this.coplanarPoint(PQ).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const OQ=new RK,BQ=new VX(.5,.5),LQ=new WX;class FQ{constructor(e=new IQ,t=new IQ,n=new IQ,r=new IQ,a=new IQ,i=new IQ){this.planes=[e,t,n,r,a,i]}set(e,t,n,r,a,i){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(a),s[5].copy(i),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=2e3,n=!1){const r=this.planes,a=e.elements,i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],d=a[5],u=a[6],h=a[7],p=a[8],m=a[9],g=a[10],f=a[11],x=a[12],y=a[13],v=a[14],b=a[15];if(r[0].setComponents(l-i,h-c,f-p,b-x).normalize(),r[1].setComponents(l+i,h+c,f+p,b+x).normalize(),r[2].setComponents(l+s,h+d,f+m,b+y).normalize(),r[3].setComponents(l-s,h-d,f-m,b-y).normalize(),n)r[4].setComponents(o,u,g,v).normalize(),r[5].setComponents(l-o,h-u,f-g,b-v).normalize();else if(r[4].setComponents(l-o,h-u,f-g,b-v).normalize(),t===vX)r[5].setComponents(l+o,h+u,f+g,b+v).normalize();else{if(t!==bX)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(o,u,g,v).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),OQ.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),OQ.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(OQ)}intersectsSprite(e){OQ.center.set(0,0,0);const t=BQ.distanceTo(e.center);return OQ.radius=.7071067811865476+t,OQ.applyMatrix4(e.matrixWorld),this.intersectsSphere(OQ)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let a=0;a<6;a++){if(t[a].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(LQ.x=r.normal.x>0?e.max.x:e.min.x,LQ.y=r.normal.y>0?e.max.y:e.min.y,LQ.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(LQ)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const UQ=new GK,zQ=new FQ;class HQ{constructor(){this.coordinateSystem=vX}intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(UQ.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),zQ.setFromProjectionMatrix(UQ,r.coordinateSystem,r.reversedDepth),zQ.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(UQ.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),zQ.setFromProjectionMatrix(UQ,r.coordinateSystem,r.reversedDepth),zQ.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(UQ.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),zQ.setFromProjectionMatrix(UQ,r.coordinateSystem,r.reversedDepth),zQ.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(UQ.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),zQ.setFromProjectionMatrix(UQ,r.coordinateSystem,r.reversedDepth),zQ.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(UQ.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),zQ.setFromProjectionMatrix(UQ,r.coordinateSystem,r.reversedDepth),zQ.containsPoint(e))return!0}return!1}clone(){return new HQ}}function GQ(e,t){return e-t}function VQ(e,t){return e.z-t.z}function $Q(e,t){return t.z-e.z}class WQ{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const a=this.pool,i=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});const s=a[this.index];i.push(s),this.index++,s.start=e,s.count=t,s.z=n,s.index=r}reset(){this.list.length=0,this.index=0}}const YQ=new GK,XQ=new Iq(1,1,1),KQ=new FQ,qQ=new HQ,JQ=new fK,QQ=new RK,ZQ=new WX,eZ=new WX,tZ=new WX,nZ=new WQ,rZ=new xJ,aZ=[];function iZ(e,t,n=0){const r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const a=e.count;for(let i=0;i<a;i++)for(let a=0;a<r;a++)t.setComponent(i+n,a,e.getComponent(i,a))}else t.array.set(e.array,n*r);t.needsUpdate=!0}function sZ(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)t[r]=e[r]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class oZ extends xJ{constructor(e,t,n=2*t,r){super(new iJ,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new vQ(t,e,e,cY,eY);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new vQ(t,e,e,pY,ZW);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new vQ(t,e,e,cY,eY);n.colorSpace=eK.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(!1===this._geometryInitialized){for(const r in e.attributes){const a=e.getAttribute(r),{array:i,itemSize:s,normalized:o}=a,l=new i.constructor(n*s),c=new Xq(l,s,o);t.setAttribute(r,c)}if(null!==e.getIndex()){const e=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new Xq(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),a=t.getAttribute(n);if(r.itemSize!==a.itemSize||r.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fK);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,YQ),this.getBoundingBoxAt(r,JQ).applyMatrix4(YQ),e.union(JQ)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new RK);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,YQ),this.getBoundingSphereAt(r,QQ).applyMatrix4(YQ),e.union(QQ)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const t={visible:!0,active:!0,geometryIndex:e};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(GQ),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));const r=this._matricesTexture;YQ.identity().toArray(r.image.data,16*n),r.needsUpdate=!0;const a=this._colorsTexture;return a&&(XQ.toArray(a.image.data,4*n),a.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=-1===t?e.getAttribute("position").count:t;const i=e.getIndex();if(null!==i&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=-1===n?i.count:n),-1!==r.indexStart&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let s;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(GQ),s=this._availableGeometryIds.shift(),a[s]=r):(s=this._geometryCount,this._geometryCount++,a.push(r)),this.setGeometryAt(s,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,s}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=null!==n.getIndex(),a=n.getIndex(),i=t.getIndex(),s=this._geometryInfo[e];if(r&&i.count>s.reservedIndexCount||t.attributes.position.count>s.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const o=s.vertexStart,l=s.reservedVertexCount;s.vertexCount=t.getAttribute("position").count;for(const c in n.attributes){const e=t.getAttribute(c),r=n.getAttribute(c);iZ(e,r,o);const a=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=o+t;for(let t=0;t<a;t++)r.setComponent(e,t,0)}r.needsUpdate=!0,r.addUpdateRange(o*a,l*a)}if(r){const e=s.indexStart,n=s.reservedIndexCount;s.indexCount=t.getIndex().count;for(let t=0;t<i.count;t++)a.setX(e+t,o+i.getX(t));for(let t=i.count,r=n;t<r;t++)a.setX(e+t,o);a.needsUpdate=!0,a.addUpdateRange(e,s.reservedIndexCount)}return s.start=r?s.indexStart:s.vertexStart,s.count=r?s.indexCount:s.vertexCount,s.boundingBox=null,null!==t.boundingBox&&(s.boundingBox=t.boundingBox.clone()),s.boundingSphere=null,null!==t.boundingSphere&&(s.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;const n=this._instanceInfo;for(let r=0,a=n.length;r<a;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((e,t)=>t).sort((e,t)=>n[e].vertexStart-n[t].vertexStart),a=this.geometry;for(let i=0,s=n.length;i<s;i++){const s=r[i],o=n[s];if(!1!==o.active){if(null!==a.index){if(o.indexStart!==t){const{indexStart:n,vertexStart:r,reservedIndexCount:i}=o,s=a.index,l=s.array,c=e-r;for(let e=n;e<n+i;e++)l[e]=l[e]+c;s.array.copyWithin(t,n,n+i),s.addUpdateRange(t,i),o.indexStart=t}t+=o.reservedIndexCount}if(o.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=o,r=a.attributes;for(const a in r){const i=r[a],{array:s,itemSize:o}=i;s.copyWithin(e*o,t*o,(t+n)*o),i.addUpdateRange(e*o,n*o)}o.vertexStart=e}e+=o.reservedVertexCount,o.start=a.index?o.indexStart:o.vertexStart,this._nextIndexStart=a.index?o.indexStart+o.reservedIndexCount:0,this._nextVertexStart=o.vertexStart+o.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingBox){const e=new fK,t=n.index,a=n.attributes.position;for(let n=r.start,i=r.start+r.count;n<i;n++){let r=n;t&&(r=t.getX(r)),e.expandByPoint(ZQ.fromBufferAttribute(a,r))}r.boundingBox=e}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingSphere){const t=new RK;this.getBoundingBoxAt(e,JQ),JQ.getCenter(t.center);const a=n.index,i=n.attributes.position;let s=0;for(let e=r.start,n=r.start+r.count;e<n;e++){let n=e;a&&(n=a.getX(n)),ZQ.fromBufferAttribute(i,n),s=Math.max(s,t.center.distanceToSquared(ZQ))}t.radius=Math.sqrt(s),r.boundingSphere=t}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,16*e),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(GQ);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),a=new Int32Array(e);sZ(this._multiDrawCounts,r),sZ(this._multiDrawStarts,a),this._multiDrawCounts=r,this._multiDrawStarts=a,this._maxInstanceCount=e;const i=this._indirectTexture,s=this._matricesTexture,o=this._colorsTexture;i.dispose(),this._initIndirectTexture(),sZ(i.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),sZ(s.image.data,this._matricesTexture.image.data),o&&(o.dispose(),this._initColorsTexture(),sZ(o.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(e=>e.active);if(Math.max(...n.map(e=>e.vertexStart+e.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index){if(Math.max(...n.map(e=>e.indexStart+e.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`)}const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new iJ,this._initializeGeometry(r));const a=this.geometry;r.index&&sZ(r.index.array,a.index.array);for(const i in r.attributes)sZ(r.attributes[i].array,a.attributes[i].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,a=this.matrixWorld,i=this.geometry;rZ.material=this.material,rZ.geometry.index=i.index,rZ.geometry.attributes=i.attributes,null===rZ.geometry.boundingBox&&(rZ.geometry.boundingBox=new fK),null===rZ.geometry.boundingSphere&&(rZ.geometry.boundingSphere=new RK);for(let s=0,o=n.length;s<o;s++){if(!n[s].visible||!n[s].active)continue;const i=n[s].geometryIndex,o=r[i];rZ.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(s,rZ.matrixWorld).premultiply(a),this.getBoundingBoxAt(i,rZ.geometry.boundingBox),this.getBoundingSphereAt(i,rZ.geometry.boundingSphere),rZ.raycast(e,aZ);for(let e=0,n=aZ.length;e<n;e++){const n=aZ[e];n.object=this,n.batchId=s,t.push(n)}aZ.length=0}rZ.material=null,rZ.geometry.index=null,rZ.geometry.attributes={},rZ.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(e=>c(l({},e),{boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(e=>l({},e)),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const i=r.getIndex(),s=null===i?1:i.array.BYTES_PER_ELEMENT,o=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,d=this._geometryInfo,u=this.perObjectFrustumCulled,h=this._indirectTexture,p=h.image.data,m=n.isArrayCamera?qQ:KQ;u&&!n.isArrayCamera&&(YQ.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),KQ.setFromProjectionMatrix(YQ,n.coordinateSystem,n.reversedDepth));let g=0;if(this.sortObjects){YQ.copy(this.matrixWorld).invert(),ZQ.setFromMatrixPosition(n.matrixWorld).applyMatrix4(YQ),eZ.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(YQ);for(let r=0,a=o.length;r<a;r++)if(o[r].visible&&o[r].active){const e=o[r].geometryIndex;this.getMatrixAt(r,YQ),this.getBoundingSphereAt(e,QQ).applyMatrix4(YQ);let t=!1;if(u&&(t=!m.intersectsSphere(QQ,n)),!t){const t=d[e],n=tZ.subVectors(QQ.center,ZQ).dot(eZ);nZ.push(t.start,t.count,n,r)}}const e=nZ.list,t=this.customSort;null===t?e.sort(a.transparent?$Q:VQ):t.call(this,e,n);for(let n=0,r=e.length;n<r;n++){const t=e[n];l[g]=t.start*s,c[g]=t.count,p[g]=t.index,g++}nZ.reset()}else for(let f=0,x=o.length;f<x;f++)if(o[f].visible&&o[f].active){const e=o[f].geometryIndex;let t=!1;if(u&&(this.getMatrixAt(f,YQ),this.getBoundingSphereAt(e,QQ).applyMatrix4(YQ),t=!m.intersectsSphere(QQ,n)),!t){const t=d[e];l[g]=t.start*s,c[g]=t.count,p[g]=f,g++}}h.needsUpdate=!0,this._multiDrawCount=g,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,a,i){this.onBeforeRender(e,null,r,a,i)}}class lZ extends Lq{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Iq(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const cZ=new WX,dZ=new WX,uZ=new GK,hZ=new HK,pZ=new RK,mZ=new WX,gZ=new WX;class fZ extends fq{constructor(e=new iJ,t=new lZ){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)cZ.fromBufferAttribute(t,e-1),dZ.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=cZ.distanceTo(dZ);e.setAttribute("lineDistance",new Jq(n,1))}else kX("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,a=e.params.Line.threshold,i=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),pZ.copy(n.boundingSphere),pZ.applyMatrix4(r),pZ.radius+=a,!1===e.ray.intersectsSphere(pZ))return;uZ.copy(r).invert(),hZ.copy(e.ray).applyMatrix4(uZ);const s=a/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=this.isLineSegments?2:1,c=n.index,d=n.attributes.position;if(null!==c){const n=Math.max(0,i.start),r=Math.min(c.count,i.start+i.count);for(let a=n,i=r-1;a<i;a+=l){const n=c.getX(a),r=c.getX(a+1),i=xZ(this,e,hZ,o,n,r,a);i&&t.push(i)}if(this.isLineLoop){const a=c.getX(r-1),i=c.getX(n),s=xZ(this,e,hZ,o,a,i,r-1);s&&t.push(s)}}else{const n=Math.max(0,i.start),r=Math.min(d.count,i.start+i.count);for(let a=n,i=r-1;a<i;a+=l){const n=xZ(this,e,hZ,o,a,a+1,a);n&&t.push(n)}if(this.isLineLoop){const a=xZ(this,e,hZ,o,r-1,n,r-1);a&&t.push(a)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function xZ(e,t,n,r,a,i,s){const o=e.geometry.attributes.position;cZ.fromBufferAttribute(o,a),dZ.fromBufferAttribute(o,i);if(n.distanceSqToSegment(cZ,dZ,mZ,gZ)>r)return;mZ.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(mZ);return l<t.near||l>t.far?void 0:{distance:l,point:gZ.clone().applyMatrix4(e.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:e}}const yZ=new WX,vZ=new WX;class bZ extends fZ{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)yZ.fromBufferAttribute(t,e),vZ.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+yZ.distanceTo(vZ);e.setAttribute("lineDistance",new Jq(n,1))}else kX("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class wZ extends fZ{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class NZ extends Lq{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Iq(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const SZ=new GK,jZ=new HK,_Z=new RK,AZ=new WX;class CZ extends fq{constructor(e=new iJ,t=new NZ){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,a=e.params.Points.threshold,i=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),_Z.copy(n.boundingSphere),_Z.applyMatrix4(r),_Z.radius+=a,!1===e.ray.intersectsSphere(_Z))return;SZ.copy(r).invert(),jZ.copy(e.ray).applyMatrix4(SZ);const s=a/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,i.start),a=Math.min(l.count,i.start+i.count);n<a;n++){const a=l.getX(n);AZ.fromBufferAttribute(c,a),MZ(AZ,a,o,r,e,t,this)}}else{for(let n=Math.max(0,i.start),a=Math.min(c.count,i.start+i.count);n<a;n++)AZ.fromBufferAttribute(c,n),MZ(AZ,n,o,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function MZ(e,t,n,r,a,i,s){const o=jZ.distanceSqToPoint(e);if(o<n){const n=new WX;jZ.closestPointToPoint(e,n),n.applyMatrix4(r);const l=a.ray.origin.distanceTo(n);if(l<a.near||l>a.far)return;i.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:s})}}class kZ extends dK{constructor(e,t,n,r,a=1006,i=1006,s,o,l){super(e,t,n,r,a,i,s,o,l),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const c=this;"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(function t(){c.needsUpdate=!0,c._requestVideoFrameCallbackId=e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class EZ extends dK{constructor(e,t,n,r,a,i,s,o,l,c,d,u){super(null,i,s,o,l,c,r,a,d,u),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class TZ extends dK{constructor(e,t,n=1014,r,a,i,s=1003,o=1003,l,c=1026,d=1){if(c!==dY&&c!==uY)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:d},r,a,i,s,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new sK(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class PZ extends dK{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class DZ extends iJ{constructor(e=1,t=1,n=4,r=8,a=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:a},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),a=Math.max(1,Math.floor(a));const i=[],s=[],o=[],l=[],c=t/2,d=Math.PI/2*e,u=t,h=2*d+u,p=2*n+a,m=r+1,g=new WX,f=new WX;for(let x=0;x<=p;x++){let y=0,v=0,b=0,w=0;if(x<=n){const t=x/n,r=t*Math.PI/2;v=-c-e*Math.cos(r),b=e*Math.sin(r),w=-e*Math.cos(r),y=t*d}else if(x<=n+a){const r=(x-n)/a;v=r*t-c,b=e,w=0,y=d+r*u}else{const t=(x-n-a)/n,r=t*Math.PI/2;v=c+e*Math.sin(r),b=e*Math.cos(r),w=e*Math.sin(r),y=d+u+t*d}const N=Math.max(0,Math.min(1,y/h));let S=0;0===x?S=.5/r:x===p&&(S=-.5/r);for(let e=0;e<=r;e++){const t=e/r,n=t*Math.PI*2,a=Math.sin(n),i=Math.cos(n);f.x=-b*i,f.y=v,f.z=b*a,s.push(f.x,f.y,f.z),g.set(-b*i,w,b*a),g.normalize(),o.push(g.x,g.y,g.z),l.push(t+S,N)}if(x>0){const e=(x-1)*m;for(let t=0;t<r;t++){const n=e+t,r=e+t+1,a=x*m+t,s=x*m+t+1;i.push(n,r,a),i.push(r,s,a)}}}this.setIndex(i),this.setAttribute("position",new Jq(s,3)),this.setAttribute("normal",new Jq(o,3)),this.setAttribute("uv",new Jq(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DZ(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class RZ extends iJ{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const a=[],i=[],s=[],o=[],l=new WX,c=new VX;i.push(0,0,0),s.push(0,0,1),o.push(.5,.5);for(let d=0,u=3;d<=t;d++,u+=3){const a=n+d/t*r;l.x=e*Math.cos(a),l.y=e*Math.sin(a),i.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(i[u]/e+1)/2,c.y=(i[u+1]/e+1)/2,o.push(c.x,c.y)}for(let d=1;d<=t;d++)a.push(d,d+1,0);this.setIndex(a),this.setAttribute("position",new Jq(i,3)),this.setAttribute("normal",new Jq(s,3)),this.setAttribute("uv",new Jq(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new RZ(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class IZ extends iJ{constructor(e=1,t=1,n=1,r=32,a=1,i=!1,s=0,o=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:a,openEnded:i,thetaStart:s,thetaLength:o};const l=this;r=Math.floor(r),a=Math.floor(a);const c=[],d=[],u=[],h=[];let p=0;const m=[],g=n/2;let f=0;function x(n){const a=p,i=new VX,m=new WX;let x=0;const y=!0===n?e:t,v=!0===n?1:-1;for(let e=1;e<=r;e++)d.push(0,g*v,0),u.push(0,v,0),h.push(.5,.5),p++;const b=p;for(let e=0;e<=r;e++){const t=e/r*o+s,n=Math.cos(t),a=Math.sin(t);m.x=y*a,m.y=g*v,m.z=y*n,d.push(m.x,m.y,m.z),u.push(0,v,0),i.x=.5*n+.5,i.y=.5*a*v+.5,h.push(i.x,i.y),p++}for(let e=0;e<r;e++){const t=a+e,r=b+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),x+=3}l.addGroup(f,x,!0===n?1:2),f+=x}!function(){const i=new WX,x=new WX;let y=0;const v=(t-e)/n;for(let l=0;l<=a;l++){const c=[],f=l/a,y=f*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,a=t*o+s,l=Math.sin(a),m=Math.cos(a);x.x=y*l,x.y=-f*n+g,x.z=y*m,d.push(x.x,x.y,x.z),i.set(l,v,m).normalize(),u.push(i.x,i.y,i.z),h.push(t,1-f),c.push(p++)}m.push(c)}for(let n=0;n<r;n++)for(let r=0;r<a;r++){const i=m[r][n],s=m[r+1][n],o=m[r+1][n+1],l=m[r][n+1];(e>0||0!==r)&&(c.push(i,s,l),y+=3),(t>0||r!==a-1)&&(c.push(s,o,l),y+=3)}l.addGroup(f,y,0),f+=y}(),!1===i&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(c),this.setAttribute("position",new Jq(d,3)),this.setAttribute("normal",new Jq(u,3)),this.setAttribute("uv",new Jq(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new IZ(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class OZ extends IZ{constructor(e=1,t=1,n=32,r=1,a=!1,i=0,s=2*Math.PI){super(0,e,t,n,r,a,i,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:i,thetaLength:s}}static fromJSON(e){return new OZ(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class BZ extends iJ{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const a=[],i=[];function s(e,t,n,r){const a=r+1,i=[];for(let s=0;s<=a;s++){i[s]=[];const r=e.clone().lerp(n,s/a),o=t.clone().lerp(n,s/a),l=a-s;for(let e=0;e<=l;e++)i[s][e]=0===e&&s===a?r:r.clone().lerp(o,e/l)}for(let s=0;s<a;s++)for(let e=0;e<2*(a-s)-1;e++){const t=Math.floor(e/2);e%2==0?(o(i[s][t+1]),o(i[s+1][t]),o(i[s][t])):(o(i[s][t+1]),o(i[s+1][t+1]),o(i[s+1][t]))}}function o(e){a.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(i[t]=e.x-1),0===n.x&&0===n.z&&(i[t]=r/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}function u(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){const n=new WX,r=new WX,a=new WX;for(let i=0;i<t.length;i+=3)l(t[i+0],n),l(t[i+1],r),l(t[i+2],a),s(n,r,a,e)}(r),function(e){const t=new WX;for(let n=0;n<a.length;n+=3)t.x=a[n+0],t.y=a[n+1],t.z=a[n+2],t.normalize().multiplyScalar(e),a[n+0]=t.x,a[n+1]=t.y,a[n+2]=t.z}(n),function(){const e=new WX;for(let t=0;t<a.length;t+=3){e.x=a[t+0],e.y=a[t+1],e.z=a[t+2];const n=d(e)/2/Math.PI+.5,r=u(e)/Math.PI+.5;i.push(n,1-r)}(function(){const e=new WX,t=new WX,n=new WX,r=new WX,s=new VX,o=new VX,l=new VX;for(let u=0,h=0;u<a.length;u+=9,h+=6){e.set(a[u+0],a[u+1],a[u+2]),t.set(a[u+3],a[u+4],a[u+5]),n.set(a[u+6],a[u+7],a[u+8]),s.set(i[h+0],i[h+1]),o.set(i[h+2],i[h+3]),l.set(i[h+4],i[h+5]),r.copy(e).add(t).add(n).divideScalar(3);const p=d(r);c(s,h+0,e,p),c(o,h+2,t,p),c(l,h+4,n,p)}})(),function(){for(let e=0;e<i.length;e+=6){const t=i[e+0],n=i[e+2],r=i[e+4],a=Math.max(t,n,r),s=Math.min(t,n,r);a>.9&&s<.1&&(t<.2&&(i[e+0]+=1),n<.2&&(i[e+2]+=1),r<.2&&(i[e+4]+=1))}}()}(),this.setAttribute("position",new Jq(a,3)),this.setAttribute("normal",new Jq(a.slice(),3)),this.setAttribute("uv",new Jq(i,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new BZ(e.vertices,e.indices,e.radius,e.details)}}class LZ extends BZ{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new LZ(e.radius,e.detail)}}const FZ=new WX,UZ=new WX,zZ=new WX,HZ=new Eq;class GZ extends iJ{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,r=Math.pow(10,n),a=Math.cos(IX*t),i=e.getIndex(),s=e.getAttribute("position"),o=i?i.count:s.count,l=[0,0,0],c=["a","b","c"],d=new Array(3),u={},h=[];for(let e=0;e<o;e+=3){i?(l[0]=i.getX(e),l[1]=i.getX(e+1),l[2]=i.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:o}=HZ;if(t.fromBufferAttribute(s,l[0]),n.fromBufferAttribute(s,l[1]),o.fromBufferAttribute(s,l[2]),HZ.getNormal(zZ),d[0]=`${Math.round(t.x*r)},${Math.round(t.y*r)},${Math.round(t.z*r)}`,d[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`,d[2]=`${Math.round(o.x*r)},${Math.round(o.y*r)},${Math.round(o.z*r)}`,d[0]!==d[1]&&d[1]!==d[2]&&d[2]!==d[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=d[e],r=d[t],i=HZ[c[e]],s=HZ[c[t]],o=`${n}_${r}`,p=`${r}_${n}`;p in u&&u[p]?(zZ.dot(u[p].normal)<=a&&(h.push(i.x,i.y,i.z),h.push(s.x,s.y,s.z)),u[p]=null):o in u||(u[o]={index0:l[e],index1:l[t],normal:zZ.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];FZ.fromBufferAttribute(s,t),UZ.fromBufferAttribute(s,n),h.push(FZ.x,FZ.y,FZ.z),h.push(UZ.x,UZ.y,UZ.z)}this.setAttribute("position",new Jq(h,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class VZ{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){kX("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),a=0;t.push(0);for(let i=1;i<=e;i++)n=this.getPoint(i/e),a+=n.distanceTo(r),t.push(a),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const a=n.length;let i;i=t||e*n[a-1];let s,o=0,l=a-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),s=n[r]-i,s<0)o=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===i)return r/(a-1);const c=n[r];return(r+(i-c)/(n[r+1]-c))/(a-1)}getTangent(e,t){const n=1e-4;let r=e-n,a=e+n;r<0&&(r=0),a>1&&(a=1);const i=this.getPoint(r),s=this.getPoint(a),o=t||(i.isVector2?new VX:new WX);return o.copy(s).sub(i).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new WX,r=[],a=[],i=[],s=new WX,o=new GK;for(let h=0;h<=e;h++){const t=h/e;r[h]=this.getTangentAt(t,new WX)}a[0]=new WX,i[0]=new WX;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),d=Math.abs(r[0].y),u=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),d<=l&&(l=d,n.set(0,1,0)),u<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),a[0].crossVectors(r[0],s),i[0].crossVectors(r[0],a[0]);for(let h=1;h<=e;h++){if(a[h]=a[h-1].clone(),i[h]=i[h-1].clone(),s.crossVectors(r[h-1],r[h]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(LX(r[h-1].dot(r[h]),-1,1));a[h].applyMatrix4(o.makeRotationAxis(s,e))}i[h].crossVectors(r[h],a[h])}if(!0===t){let t=Math.acos(LX(a[0].dot(a[e]),-1,1));t/=e,r[0].dot(s.crossVectors(a[0],a[e]))>0&&(t=-t);for(let n=1;n<=e;n++)a[n].applyMatrix4(o.makeRotationAxis(r[n],t*n)),i[n].crossVectors(r[n],a[n])}return{tangents:r,normals:a,binormals:i}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class $Z extends VZ{constructor(e=0,t=0,n=1,r=1,a=0,i=2*Math.PI,s=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=a,this.aEndAngle=i,this.aClockwise=s,this.aRotation=o}getPoint(e,t=new VX){const n=t,r=2*Math.PI;let a=this.aEndAngle-this.aStartAngle;const i=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=r;for(;a>r;)a-=r;a<Number.EPSILON&&(a=i?0:r),!0!==this.aClockwise||i||(a===r?a=-r:a-=r);const s=this.aStartAngle+e*a;let o=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,r=l-this.aY;o=n*e-r*t+this.aX,l=n*t+r*e+this.aY}return n.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class WZ extends $Z{constructor(e,t,n,r,a,i){super(e,t,n,n,r,a,i),this.isArcCurve=!0,this.type="ArcCurve"}}function YZ(){let e=0,t=0,n=0,r=0;function a(a,i,s,o){e=a,t=s,n=-3*a+3*i-2*s-o,r=2*a-2*i+s+o}return{initCatmullRom:function(e,t,n,r,i){a(t,n,i*(n-e),i*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,i,s,o){let l=(t-e)/i-(n-e)/(i+s)+(n-t)/s,c=(n-t)/s-(r-t)/(s+o)+(r-n)/o;l*=s,c*=s,a(t,n,l,c)},calc:function(a){const i=a*a;return e+t*a+n*i+r*(i*a)}}}const XZ=new WX,KZ=new YZ,qZ=new YZ,JZ=new YZ;class QZ extends VZ{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new WX){const n=t,r=this.points,a=r.length,i=(a-(this.closed?0:1))*e;let s,o,l=Math.floor(i),c=i-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/a)+1)*a:0===c&&l===a-1&&(l=a-2,c=1),this.closed||l>0?s=r[(l-1)%a]:(XZ.subVectors(r[0],r[1]).add(r[0]),s=XZ);const d=r[l%a],u=r[(l+1)%a];if(this.closed||l+2<a?o=r[(l+2)%a]:(XZ.subVectors(r[a-1],r[a-2]).add(r[a-1]),o=XZ),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(d),e),n=Math.pow(d.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),KZ.initNonuniformCatmullRom(s.x,d.x,u.x,o.x,t,n,r),qZ.initNonuniformCatmullRom(s.y,d.y,u.y,o.y,t,n,r),JZ.initNonuniformCatmullRom(s.z,d.z,u.z,o.z,t,n,r)}else"catmullrom"===this.curveType&&(KZ.initCatmullRom(s.x,d.x,u.x,o.x,this.tension),qZ.initCatmullRom(s.y,d.y,u.y,o.y,this.tension),JZ.initCatmullRom(s.z,d.z,u.z,o.z,this.tension));return n.set(KZ.calc(c),qZ.calc(c),JZ.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new WX).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function ZZ(e,t,n,r,a){const i=.5*(r-t),s=.5*(a-n),o=e*e;return(2*n-2*r+i+s)*(e*o)+(-3*n+3*r-2*i-s)*o+i*e+n}function e0(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function t0(e,t,n,r,a){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,a)}class n0 extends VZ{constructor(e=new VX,t=new VX,n=new VX,r=new VX){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new VX){const n=t,r=this.v0,a=this.v1,i=this.v2,s=this.v3;return n.set(t0(e,r.x,a.x,i.x,s.x),t0(e,r.y,a.y,i.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class r0 extends VZ{constructor(e=new WX,t=new WX,n=new WX,r=new WX){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new WX){const n=t,r=this.v0,a=this.v1,i=this.v2,s=this.v3;return n.set(t0(e,r.x,a.x,i.x,s.x),t0(e,r.y,a.y,i.y,s.y),t0(e,r.z,a.z,i.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class a0 extends VZ{constructor(e=new VX,t=new VX){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new VX){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new VX){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class i0 extends VZ{constructor(e=new WX,t=new WX){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new WX){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new WX){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class s0 extends VZ{constructor(e=new VX,t=new VX,n=new VX){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new VX){const n=t,r=this.v0,a=this.v1,i=this.v2;return n.set(e0(e,r.x,a.x,i.x),e0(e,r.y,a.y,i.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class o0 extends VZ{constructor(e=new WX,t=new WX,n=new WX){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new WX){const n=t,r=this.v0,a=this.v1,i=this.v2;return n.set(e0(e,r.x,a.x,i.x),e0(e,r.y,a.y,i.y),e0(e,r.z,a.z,i.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class l0 extends VZ{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new VX){const n=t,r=this.points,a=(r.length-1)*e,i=Math.floor(a),s=a-i,o=r[0===i?i:i-1],l=r[i],c=r[i>r.length-2?r.length-1:i+1],d=r[i>r.length-3?r.length-1:i+2];return n.set(ZZ(s,o.x,l.x,c.x,d.x),ZZ(s,o.y,l.y,c.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new VX).fromArray(n))}return this}}var c0=Object.freeze({__proto__:null,ArcCurve:WZ,CatmullRomCurve3:QZ,CubicBezierCurve:n0,CubicBezierCurve3:r0,EllipseCurve:$Z,LineCurve:a0,LineCurve3:i0,QuadraticBezierCurve:s0,QuadraticBezierCurve3:o0,SplineCurve:l0});class d0 extends VZ{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new c0[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let a=0;for(;a<r.length;){if(r[a]>=n){const e=r[a]-n,i=this.curves[a],s=i.getLength(),o=0===s?0:1-e/s;return i.getPointAt(o,t)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,a=this.curves;r<a.length;r++){const i=a[r],s=i.isEllipseCurve?2*e:i.isLineCurve||i.isLineCurve3?1:i.isSplineCurve?e*i.points.length:e,o=i.getPoints(s);for(let e=0;e<o.length;e++){const r=o[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new c0[n.type]).fromJSON(n))}return this}}class u0 extends d0{constructor(e){super(),this.type="Path",this.currentPoint=new VX,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new a0(this.currentPoint.clone(),new VX(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const a=new s0(this.currentPoint.clone(),new VX(e,t),new VX(n,r));return this.curves.push(a),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,a,i){const s=new n0(this.currentPoint.clone(),new VX(e,t),new VX(n,r),new VX(a,i));return this.curves.push(s),this.currentPoint.set(a,i),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new l0(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,a,i){const s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,n,r,a,i),this}absarc(e,t,n,r,a,i){return this.absellipse(e,t,n,n,r,a,i),this}ellipse(e,t,n,r,a,i,s,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,a,i,s,o),this}absellipse(e,t,n,r,a,i,s,o){const l=new $Z(e,t,n,r,a,i,s,o);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class h0 extends u0{constructor(e){super(e),this.uuid=BX(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new u0).fromJSON(n))}return this}}function p0(e,t,n=2){const r=t&&t.length,a=r?t[0]*n:e.length;let i=m0(e,0,a,n,!0);const s=[];if(!i||i.next===i.prev)return s;let o,l,c;if(r&&(i=function(e,t,n,r){const a=[];for(let i=0,s=t.length;i<s;i++){const n=m0(e,t[i]*r,i<s-1?t[i+1]*r:e.length,r,!1);n===n.next&&(n.steiner=!0),a.push(_0(n))}a.sort(w0);for(let i=0;i<a.length;i++)n=N0(a[i],n);return n}(e,t,i,n)),e.length>80*n){o=e[0],l=e[1];let t=o,r=l;for(let i=n;i<a;i+=n){const n=e[i],a=e[i+1];n<o&&(o=n),a<l&&(l=a),n>t&&(t=n),a>r&&(r=a)}c=Math.max(t-o,r-l),c=0!==c?32767/c:0}return f0(i,s,n,o,l,c,0),s}function m0(e,t,n,r,a){let i;if(a===function(e,t,n,r){let a=0;for(let i=t,s=n-r;i<n;i+=r)a+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return a}(e,t,n,r)>0)for(let s=t;s<n;s+=r)i=O0(s/r|0,e[s],e[s+1],i);else for(let s=n-r;s>=t;s-=r)i=O0(s/r|0,e[s],e[s+1],i);return i&&E0(i,i.next)&&(B0(i),i=i.next),i}function g0(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!E0(r,r.next)&&0!==k0(r.prev,r,r.next))r=r.next;else{if(B0(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function f0(e,t,n,r,a,i,s){if(!e)return;!s&&i&&function(e,t,n,r){let a=e;do{0===a.z&&(a.z=j0(a.x,a.y,t,n,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){let t,n=1;do{let r,a=e;e=null;let i=null;for(t=0;a;){t++;let s=a,o=0;for(let e=0;e<n&&(o++,s=s.nextZ,s);e++);let l=n;for(;o>0||l>0&&s;)0!==o&&(0===l||!s||a.z<=s.z)?(r=a,a=a.nextZ,o--):(r=s,s=s.nextZ,l--),i?i.nextZ=r:e=r,r.prevZ=i,i=r;a=s}i.nextZ=null,n*=2}while(t>1)}(a)}(e,r,a,i);let o=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(i?y0(e,r,a,i):x0(e))t.push(l.i,e.i,c.i),B0(e),e=c.next,o=c.next;else if((e=c)===o){s?1===s?f0(e=v0(g0(e),t),t,n,r,a,i,2):2===s&&b0(e,t,n,r,a,i):f0(g0(e),t,n,r,a,i,1);break}}}function x0(e){const t=e.prev,n=e,r=e.next;if(k0(t,n,r)>=0)return!1;const a=t.x,i=n.x,s=r.x,o=t.y,l=n.y,c=r.y,d=Math.min(a,i,s),u=Math.min(o,l,c),h=Math.max(a,i,s),p=Math.max(o,l,c);let m=r.next;for(;m!==t;){if(m.x>=d&&m.x<=h&&m.y>=u&&m.y<=p&&C0(a,o,i,l,s,c,m.x,m.y)&&k0(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function y0(e,t,n,r){const a=e.prev,i=e,s=e.next;if(k0(a,i,s)>=0)return!1;const o=a.x,l=i.x,c=s.x,d=a.y,u=i.y,h=s.y,p=Math.min(o,l,c),m=Math.min(d,u,h),g=Math.max(o,l,c),f=Math.max(d,u,h),x=j0(p,m,t,n,r),y=j0(g,f,t,n,r);let v=e.prevZ,b=e.nextZ;for(;v&&v.z>=x&&b&&b.z<=y;){if(v.x>=p&&v.x<=g&&v.y>=m&&v.y<=f&&v!==a&&v!==s&&C0(o,d,l,u,c,h,v.x,v.y)&&k0(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=p&&b.x<=g&&b.y>=m&&b.y<=f&&b!==a&&b!==s&&C0(o,d,l,u,c,h,b.x,b.y)&&k0(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=x;){if(v.x>=p&&v.x<=g&&v.y>=m&&v.y<=f&&v!==a&&v!==s&&C0(o,d,l,u,c,h,v.x,v.y)&&k0(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=g&&b.y>=m&&b.y<=f&&b!==a&&b!==s&&C0(o,d,l,u,c,h,b.x,b.y)&&k0(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function v0(e,t){let n=e;do{const r=n.prev,a=n.next.next;!E0(r,a)&&T0(r,n,n.next,a)&&R0(r,a)&&R0(a,r)&&(t.push(r.i,n.i,a.i),B0(n),B0(n.next),n=e=a),n=n.next}while(n!==e);return g0(n)}function b0(e,t,n,r,a,i){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&M0(s,e)){let o=I0(s,e);return s=g0(s,s.next),o=g0(o,o.next),f0(s,t,n,r,a,i,0),void f0(o,t,n,r,a,i,0)}e=e.next}s=s.next}while(s!==e)}function w0(e,t){let n=e.x-t.x;if(0===n&&(n=e.y-t.y,0===n)){n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return n}function N0(e,t){const n=function(e,t){let n=t;const r=e.x,a=e.y;let i,s=-1/0;if(E0(e,n))return n;do{if(E0(e,n.next))return n.next;if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const e=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s&&(s=e,i=n.x<n.next.x?n:n.next,e===r))return i}n=n.next}while(n!==t);if(!i)return null;const o=i,l=i.x,c=i.y;let d=1/0;n=i;do{if(r>=n.x&&n.x>=l&&r!==n.x&&A0(a<c?r:s,a,l,c,a<c?s:r,a,n.x,n.y)){const t=Math.abs(a-n.y)/(r-n.x);R0(n,e)&&(t<d||t===d&&(n.x>i.x||n.x===i.x&&S0(i,n)))&&(i=n,d=t)}n=n.next}while(n!==o);return i}(e,t);if(!n)return t;const r=I0(n,e);return g0(r,r.next),g0(n,n.next)}function S0(e,t){return k0(e.prev,e,t.prev)<0&&k0(t.next,e,e.next)<0}function j0(e,t,n,r,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*a|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*a|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _0(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function A0(e,t,n,r,a,i,s,o){return(a-s)*(t-o)>=(e-s)*(i-o)&&(e-s)*(r-o)>=(n-s)*(t-o)&&(n-s)*(i-o)>=(a-s)*(r-o)}function C0(e,t,n,r,a,i,s,o){return!(e===s&&t===o)&&A0(e,t,n,r,a,i,s,o)}function M0(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&T0(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(R0(e,t)&&R0(t,e)&&function(e,t){let n=e,r=!1;const a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&a<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(k0(e.prev,e,t.prev)||k0(e,t.prev,t))||E0(e,t)&&k0(e.prev,e,e.next)>0&&k0(t.prev,t,t.next)>0)}function k0(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function E0(e,t){return e.x===t.x&&e.y===t.y}function T0(e,t,n,r){const a=D0(k0(e,t,n)),i=D0(k0(e,t,r)),s=D0(k0(n,r,e)),o=D0(k0(n,r,t));return a!==i&&s!==o||(!(0!==a||!P0(e,n,t))||(!(0!==i||!P0(e,r,t))||(!(0!==s||!P0(n,e,r))||!(0!==o||!P0(n,t,r)))))}function P0(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function D0(e){return e>0?1:e<0?-1:0}function R0(e,t){return k0(e.prev,e,e.next)<0?k0(e,t,e.next)>=0&&k0(e,e.prev,t)>=0:k0(e,t,e.prev)<0||k0(e,e.next,t)<0}function I0(e,t){const n=L0(e.i,e.x,e.y),r=L0(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=a,a.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function O0(e,t,n,r){const a=L0(e,t,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function B0(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function L0(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class F0{static triangulate(e,t,n=2){return p0(e,t,n)}}class U0{static area(e){const t=e.length;let n=0;for(let r=t-1,a=0;a<t;r=a++)n+=e[r].x*e[a].y-e[a].x*e[r].y;return.5*n}static isClockWise(e){return U0.area(e)<0}static triangulateShape(e,t){const n=[],r=[],a=[];z0(e),H0(n,e);let i=e.length;t.forEach(z0);for(let o=0;o<t.length;o++)r.push(i),i+=t[o].length,H0(n,t[o]);const s=F0.triangulate(n,r);for(let o=0;o<s.length;o+=3)a.push(s.slice(o,o+3));return a}}function z0(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function H0(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class G0 extends iJ{constructor(e=new h0([new VX(.5,.5),new VX(-.5,.5),new VX(-.5,-.5),new VX(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],a=[];for(let s=0,o=e.length;s<o;s++){i(e[s])}function i(e){const i=[],s=void 0!==t.curveSegments?t.curveSegments:12,o=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,d=void 0!==t.bevelThickness?t.bevelThickness:.2,u=void 0!==t.bevelSize?t.bevelSize:d-.1,h=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const m=t.extrudePath,g=void 0!==t.UVGenerator?t.UVGenerator:V0;let f,x,y,v,b,w=!1;m&&(f=m.getSpacedPoints(o),w=!0,c=!1,x=m.computeFrenetFrames(o,!1),y=new WX,v=new WX,b=new WX),c||(p=0,d=0,u=0,h=0);const N=e.extractPoints(s);let S=N.shape;const j=N.holes;if(!U0.isClockWise(S)){S=S.reverse();for(let e=0,t=j.length;e<t;e++){const t=j[e];U0.isClockWise(t)&&(j[e]=t.reverse())}}function _(e){const t=1e-10*1e-10;let n=e[0];for(let r=1;r<=e.length;r++){const a=r%e.length,i=e[a],s=i.x-n.x,o=i.y-n.y,l=s*s+o*o,c=Math.max(Math.abs(i.x),Math.abs(i.y),Math.abs(n.x),Math.abs(n.y));l<=t*c*c?(e.splice(a,1),r--):n=i}}_(S),j.forEach(_);const A=j.length,C=S;for(let t=0;t<A;t++){const e=j[t];S=S.concat(e)}function M(e,t,n){return t||EX("ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const k=S.length;function E(e,t,n){let r,a,i;const s=e.x-t.x,o=e.y-t.y,l=n.x-e.x,c=n.y-e.y,d=s*s+o*o,u=s*c-o*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(d),h=Math.sqrt(l*l+c*c),p=t.x-o/u,m=t.y+s/u,g=((n.x-c/h-p)*c-(n.y+l/h-m)*l)/(s*c-o*l);r=p+s*g-e.x,a=m+o*g-e.y;const f=r*r+a*a;if(f<=2)return new VX(r,a);i=Math.sqrt(f/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(c)&&(e=!0),e?(r=-o,a=s,i=Math.sqrt(d)):(r=s,a=o,i=Math.sqrt(d/2))}return new VX(r/i,a/i)}const T=[];for(let t=0,n=C.length,r=n-1,a=t+1;t<n;t++,r++,a++)r===n&&(r=0),a===n&&(a=0),T[t]=E(C[t],C[r],C[a]);const P=[];let D,R,I=T.concat();for(let t=0,n=A;t<n;t++){const e=j[t];D=[];for(let t=0,n=e.length,r=n-1,a=t+1;t<n;t++,r++,a++)r===n&&(r=0),a===n&&(a=0),D[t]=E(e[t],e[r],e[a]);P.push(D),I=I.concat(D)}if(0===p)R=U0.triangulateShape(C,j);else{const e=[],t=[];for(let n=0;n<p;n++){const r=n/p,a=d*Math.cos(r*Math.PI/2),i=u*Math.sin(r*Math.PI/2)+h;for(let t=0,n=C.length;t<n;t++){const n=M(C[t],T[t],i);F(n.x,n.y,-a),0===r&&e.push(n)}for(let e=0,n=A;e<n;e++){const n=j[e];D=P[e];const s=[];for(let e=0,t=n.length;e<t;e++){const t=M(n[e],D[e],i);F(t.x,t.y,-a),0===r&&s.push(t)}0===r&&t.push(s)}}R=U0.triangulateShape(e,t)}const O=R.length,B=u+h;for(let t=0;t<k;t++){const e=c?M(S[t],I[t],B):S[t];w?(v.copy(x.normals[0]).multiplyScalar(e.x),y.copy(x.binormals[0]).multiplyScalar(e.y),b.copy(f[0]).add(v).add(y),F(b.x,b.y,b.z)):F(e.x,e.y,0)}for(let t=1;t<=o;t++)for(let e=0;e<k;e++){const n=c?M(S[e],I[e],B):S[e];w?(v.copy(x.normals[t]).multiplyScalar(n.x),y.copy(x.binormals[t]).multiplyScalar(n.y),b.copy(f[t]).add(v).add(y),F(b.x,b.y,b.z)):F(n.x,n.y,l/o*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=d*Math.cos(e*Math.PI/2),r=u*Math.sin(e*Math.PI/2)+h;for(let t=0,a=C.length;t<a;t++){const e=M(C[t],T[t],r);F(e.x,e.y,l+n)}for(let t=0,a=j.length;t<a;t++){const e=j[t];D=P[t];for(let t=0,a=e.length;t<a;t++){const a=M(e[t],D[t],r);w?F(a.x,a.y+f[o-1].y,f[o-1].x+n):F(a.x,a.y,l+n)}}}function L(e,t){let n=e.length;for(;--n>=0;){const r=n;let a=n-1;a<0&&(a=e.length-1);for(let e=0,n=o+2*p;e<n;e++){const n=k*e,i=k*(e+1);z(t+r+n,t+a+n,t+a+i,t+r+i)}}}function F(e,t,n){i.push(e),i.push(t),i.push(n)}function U(e,t,a){H(e),H(t),H(a);const i=r.length/3,s=g.generateTopUV(n,r,i-3,i-2,i-1);G(s[0]),G(s[1]),G(s[2])}function z(e,t,a,i){H(e),H(t),H(i),H(t),H(a),H(i);const s=r.length/3,o=g.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);G(o[0]),G(o[1]),G(o[3]),G(o[1]),G(o[2]),G(o[3])}function H(e){r.push(i[3*e+0]),r.push(i[3*e+1]),r.push(i[3*e+2])}function G(e){a.push(e.x),a.push(e.y)}!function(){const e=r.length/3;if(c){let e=0,t=k*e;for(let n=0;n<O;n++){const e=R[n];U(e[2]+t,e[1]+t,e[0]+t)}e=o+2*p,t=k*e;for(let n=0;n<O;n++){const e=R[n];U(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<O;e++){const t=R[e];U(t[2],t[1],t[0])}for(let e=0;e<O;e++){const t=R[e];U(t[0]+k*o,t[1]+k*o,t[2]+k*o)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;L(C,t),t+=C.length;for(let n=0,r=j.length;n<r;n++){const e=j[n];L(e,t),t+=e.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new Jq(r,3)),this.setAttribute("uv",new Jq(a,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let r=0,a=e.length;r<a;r++){const t=e[r];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let a=0,i=e.shapes.length;a<i;a++){const r=t[e.shapes[a]];n.push(r)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new c0[r.type]).fromJSON(r)),new G0(n,e.options)}}const V0={generateTopUV:function(e,t,n,r,a){const i=t[3*n],s=t[3*n+1],o=t[3*r],l=t[3*r+1],c=t[3*a],d=t[3*a+1];return[new VX(i,s),new VX(o,l),new VX(c,d)]},generateSideWallUV:function(e,t,n,r,a,i){const s=t[3*n],o=t[3*n+1],l=t[3*n+2],c=t[3*r],d=t[3*r+1],u=t[3*r+2],h=t[3*a],p=t[3*a+1],m=t[3*a+2],g=t[3*i],f=t[3*i+1],x=t[3*i+2];return Math.abs(o-d)<Math.abs(s-c)?[new VX(s,1-l),new VX(c,1-u),new VX(h,1-m),new VX(g,1-x)]:[new VX(o,1-l),new VX(d,1-u),new VX(p,1-m),new VX(f,1-x)]}};class $0 extends BZ{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $0(e.radius,e.detail)}}class W0 extends iJ{constructor(e=[new VX(0,-.5),new VX(.5,0),new VX(0,.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=LX(r,0,2*Math.PI);const a=[],i=[],s=[],o=[],l=[],c=1/t,d=new WX,u=new VX,h=new WX,p=new WX,m=new WX;let g=0,f=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:g=e[x+1].x-e[x].x,f=e[x+1].y-e[x].y,h.x=1*f,h.y=-g,h.z=0*f,m.copy(h),h.normalize(),o.push(h.x,h.y,h.z);break;case e.length-1:o.push(m.x,m.y,m.z);break;default:g=e[x+1].x-e[x].x,f=e[x+1].y-e[x].y,h.x=1*f,h.y=-g,h.z=0*f,p.copy(h),h.x+=m.x,h.y+=m.y,h.z+=m.z,h.normalize(),o.push(h.x,h.y,h.z),m.copy(p)}for(let x=0;x<=t;x++){const a=n+x*c*r,h=Math.sin(a),p=Math.cos(a);for(let n=0;n<=e.length-1;n++){d.x=e[n].x*h,d.y=e[n].y,d.z=e[n].x*p,i.push(d.x,d.y,d.z),u.x=x/t,u.y=n/(e.length-1),s.push(u.x,u.y);const r=o[3*n+0]*h,a=o[3*n+1],c=o[3*n+0]*p;l.push(r,a,c)}}for(let x=0;x<t;x++)for(let t=0;t<e.length-1;t++){const n=t+x*e.length,r=n,i=n+e.length,s=n+e.length+1,o=n+1;a.push(r,i,o),a.push(s,o,i)}this.setIndex(a),this.setAttribute("position",new Jq(i,3)),this.setAttribute("uv",new Jq(s,2)),this.setAttribute("normal",new Jq(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new W0(e.points,e.segments,e.phiStart,e.phiLength)}}class Y0 extends BZ{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Y0(e.radius,e.detail)}}class X0 extends iJ{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const a=e/2,i=t/2,s=Math.floor(n),o=Math.floor(r),l=s+1,c=o+1,d=e/s,u=t/o,h=[],p=[],m=[],g=[];for(let f=0;f<c;f++){const e=f*u-i;for(let t=0;t<l;t++){const n=t*d-a;p.push(n,-e,0),m.push(0,0,1),g.push(t/s),g.push(1-f/o)}}for(let f=0;f<o;f++)for(let e=0;e<s;e++){const t=e+l*f,n=e+l*(f+1),r=e+1+l*(f+1),a=e+1+l*f;h.push(t,n,a),h.push(n,r,a)}this.setIndex(h),this.setAttribute("position",new Jq(p,3)),this.setAttribute("normal",new Jq(m,3)),this.setAttribute("uv",new Jq(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new X0(e.width,e.height,e.widthSegments,e.heightSegments)}}class K0 extends iJ{constructor(e=.5,t=1,n=32,r=1,a=0,i=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:a,thetaLength:i},n=Math.max(3,n);const s=[],o=[],l=[],c=[];let d=e;const u=(t-e)/(r=Math.max(1,r)),h=new WX,p=new VX;for(let m=0;m<=r;m++){for(let e=0;e<=n;e++){const r=a+e/n*i;h.x=d*Math.cos(r),h.y=d*Math.sin(r),o.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(h.x/t+1)/2,p.y=(h.y/t+1)/2,c.push(p.x,p.y)}d+=u}for(let m=0;m<r;m++){const e=m*(n+1);for(let t=0;t<n;t++){const r=t+e,a=r,i=r+n+1,o=r+n+2,l=r+1;s.push(a,i,l),s.push(i,o,l)}}this.setIndex(s),this.setAttribute("position",new Jq(o,3)),this.setAttribute("normal",new Jq(l,3)),this.setAttribute("uv",new Jq(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K0(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class q0 extends iJ{constructor(e=new h0([new VX(0,.5),new VX(-.5,-.5),new VX(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],a=[],i=[];let s=0,o=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(s,o,c),s+=o,o=0;function l(e){const s=r.length/3,l=e.extractPoints(t);let c=l.shape;const d=l.holes;!1===U0.isClockWise(c)&&(c=c.reverse());for(let t=0,n=d.length;t<n;t++){const e=d[t];!0===U0.isClockWise(e)&&(d[t]=e.reverse())}const u=U0.triangulateShape(c,d);for(let t=0,n=d.length;t<n;t++){const e=d[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];r.push(e.x,e.y,0),a.push(0,0,1),i.push(e.x,e.y)}for(let t=0,r=u.length;t<r;t++){const e=u[t],r=e[0]+s,a=e[1]+s,i=e[2]+s;n.push(r,a,i),o+=3}}this.setIndex(n),this.setAttribute("position",new Jq(r,3)),this.setAttribute("normal",new Jq(a,3)),this.setAttribute("uv",new Jq(i,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,a=e.shapes.length;r<a;r++){const a=t[e.shapes[r]];n.push(a)}return new q0(n,e.curveSegments)}}class J0 extends iJ{constructor(e=1,t=32,n=16,r=0,a=2*Math.PI,i=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:a,thetaStart:i,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(i+s,Math.PI);let l=0;const c=[],d=new WX,u=new WX,h=[],p=[],m=[],g=[];for(let f=0;f<=n;f++){const h=[],x=f/n;let y=0;0===f&&0===i?y=.5/t:f===n&&o===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;d.x=-e*Math.cos(r+o*a)*Math.sin(i+x*s),d.y=e*Math.cos(i+x*s),d.z=e*Math.sin(r+o*a)*Math.sin(i+x*s),p.push(d.x,d.y,d.z),u.copy(d).normalize(),m.push(u.x,u.y,u.z),g.push(o+y,1-x),h.push(l++)}c.push(h)}for(let f=0;f<n;f++)for(let e=0;e<t;e++){const t=c[f][e+1],r=c[f][e],a=c[f+1][e],s=c[f+1][e+1];(0!==f||i>0)&&h.push(t,r,s),(f!==n-1||o<Math.PI)&&h.push(r,a,s)}this.setIndex(h),this.setAttribute("position",new Jq(p,3)),this.setAttribute("normal",new Jq(m,3)),this.setAttribute("uv",new Jq(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new J0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Q0 extends BZ{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Q0(e.radius,e.detail)}}class Z0 extends iJ{constructor(e=1,t=.4,n=12,r=48,a=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:a},n=Math.floor(n),r=Math.floor(r);const i=[],s=[],o=[],l=[],c=new WX,d=new WX,u=new WX;for(let h=0;h<=n;h++)for(let i=0;i<=r;i++){const p=i/r*a,m=h/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),s.push(d.x,d.y,d.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(d,c).normalize(),o.push(u.x,u.y,u.z),l.push(i/r),l.push(h/n)}for(let h=1;h<=n;h++)for(let e=1;e<=r;e++){const t=(r+1)*h+e-1,n=(r+1)*(h-1)+e-1,a=(r+1)*(h-1)+e,s=(r+1)*h+e;i.push(t,n,s),i.push(n,a,s)}this.setIndex(i),this.setAttribute("position",new Jq(s,3)),this.setAttribute("normal",new Jq(o,3)),this.setAttribute("uv",new Jq(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Z0(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class e1 extends iJ{constructor(e=1,t=.4,n=64,r=8,a=2,i=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:a,q:i},n=Math.floor(n),r=Math.floor(r);const s=[],o=[],l=[],c=[],d=new WX,u=new WX,h=new WX,p=new WX,m=new WX,g=new WX,f=new WX;for(let y=0;y<=n;++y){const s=y/n*a*Math.PI*2;x(s,a,i,e,h),x(s+.01,a,i,e,p),g.subVectors(p,h),f.addVectors(p,h),m.crossVectors(g,f),f.crossVectors(m,g),m.normalize(),f.normalize();for(let e=0;e<=r;++e){const a=e/r*Math.PI*2,i=-t*Math.cos(a),s=t*Math.sin(a);d.x=h.x+(i*f.x+s*m.x),d.y=h.y+(i*f.y+s*m.y),d.z=h.z+(i*f.z+s*m.z),o.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),l.push(u.x,u.y,u.z),c.push(y/n),c.push(e/r)}}for(let y=1;y<=n;y++)for(let e=1;e<=r;e++){const t=(r+1)*(y-1)+(e-1),n=(r+1)*y+(e-1),a=(r+1)*y+e,i=(r+1)*(y-1)+e;s.push(t,n,i),s.push(n,a,i)}function x(e,t,n,r,a){const i=Math.cos(e),s=Math.sin(e),o=n/t*e,l=Math.cos(o);a.x=r*(2+l)*.5*i,a.y=r*(2+l)*s*.5,a.z=r*Math.sin(o)*.5}this.setIndex(s),this.setAttribute("position",new Jq(o,3)),this.setAttribute("normal",new Jq(l,3)),this.setAttribute("uv",new Jq(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new e1(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class t1 extends iJ{constructor(e=new o0(new WX(-1,-1,0),new WX(-1,1,0),new WX(1,1,0)),t=64,n=1,r=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:a};const i=e.computeFrenetFrames(t,a);this.tangents=i.tangents,this.normals=i.normals,this.binormals=i.binormals;const s=new WX,o=new WX,l=new VX;let c=new WX;const d=[],u=[],h=[],p=[];function m(a){c=e.getPointAt(a/t,c);const l=i.normals[a],h=i.binormals[a];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,a=Math.sin(t),i=-Math.cos(t);o.x=i*l.x+a*h.x,o.y=i*l.y+a*h.y,o.z=i*l.z+a*h.z,o.normalize(),u.push(o.x,o.y,o.z),s.x=c.x+n*o.x,s.y=c.y+n*o.y,s.z=c.z+n*o.z,d.push(s.x,s.y,s.z)}}!function(){for(let e=0;e<t;e++)m(e);m(!1===a?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,h.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),a=(r+1)*e+(t-1),i=(r+1)*e+t,s=(r+1)*(e-1)+t;p.push(n,a,s),p.push(a,i,s)}}()}(),this.setIndex(p),this.setAttribute("position",new Jq(d,3)),this.setAttribute("normal",new Jq(u,3)),this.setAttribute("uv",new Jq(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new t1((new c0[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class n1 extends iJ{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new WX,a=new WX;if(null!==e.index){const i=e.attributes.position,s=e.index;let o=e.groups;0===o.length&&(o=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){const l=o[e],c=l.start;for(let e=c,o=c+l.count;e<o;e+=3)for(let l=0;l<3;l++){const o=s.getX(e+l),c=s.getX(e+(l+1)%3);r.fromBufferAttribute(i,o),a.fromBufferAttribute(i,c),!0===r1(r,a,n)&&(t.push(r.x,r.y,r.z),t.push(a.x,a.y,a.z))}}}else{const i=e.attributes.position;for(let e=0,s=i.count/3;e<s;e++)for(let o=0;o<3;o++){const s=3*e+o,l=3*e+(o+1)%3;r.fromBufferAttribute(i,s),a.fromBufferAttribute(i,l),!0===r1(r,a,n)&&(t.push(r.x,r.y,r.z),t.push(a.x,a.y,a.z))}}this.setAttribute("position",new Jq(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function r1(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,a=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==n.has(r)&&!0!==n.has(a)&&(n.add(r),n.add(a),!0)}var a1=Object.freeze({__proto__:null,BoxGeometry:vJ,CapsuleGeometry:DZ,CircleGeometry:RZ,ConeGeometry:OZ,CylinderGeometry:IZ,DodecahedronGeometry:LZ,EdgesGeometry:GZ,ExtrudeGeometry:G0,IcosahedronGeometry:$0,LatheGeometry:W0,OctahedronGeometry:Y0,PlaneGeometry:X0,PolyhedronGeometry:BZ,RingGeometry:K0,ShapeGeometry:q0,SphereGeometry:J0,TetrahedronGeometry:Q0,TorusGeometry:Z0,TorusKnotGeometry:e1,TubeGeometry:t1,WireframeGeometry:n1});class i1 extends Lq{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Iq(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class s1 extends jJ{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class o1 extends Lq{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Iq(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Iq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new VX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ZK,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class l1 extends o1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new VX(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return LX(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Iq(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Iq(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Iq(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class c1 extends Lq{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Iq(16777215),this.specular=new Iq(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Iq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new VX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ZK,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class d1 extends Lq{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Iq(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Iq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new VX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class u1 extends Lq{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new VX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class h1 extends Lq{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Iq(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Iq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new VX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ZK,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class p1 extends Lq{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class m1 extends Lq{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class g1 extends Lq{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Iq(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new VX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class f1 extends lZ{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function x1(e,t){return e&&e.constructor!==t?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function y1(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function v1(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n}function b1(e,t,n){const r=e.length,a=new e.constructor(r);for(let i=0,s=0;s!==r;++i){const r=n[i]*t;for(let n=0;n!==t;++n)a[s++]=e[r+n]}return a}function w1(e,t,n,r){let a=1,i=e[0];for(;void 0!==i&&void 0===i[r];)i=e[a++];if(void 0===i)return;let s=i[r];if(void 0!==s)if(Array.isArray(s))do{s=i[r],void 0!==s&&(t.push(i.time),n.push(...s)),i=e[a++]}while(void 0!==i);else if(void 0!==s.toArray)do{s=i[r],void 0!==s&&(t.push(i.time),s.toArray(n,n.length)),i=e[a++]}while(void 0!==i);else do{s=i[r],void 0!==s&&(t.push(i.time),n.push(s)),i=e[a++]}while(void 0!==i)}class N1{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],a=t[n-1];e:{t:{let i;n:{r:if(!(e<r)){for(let i=n+2;;){if(void 0===r){if(e<a)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===i)break;if(a=r,r=t[++n],e<r)break t}i=t.length;break n}if(!(e>=a)){const s=t[1];e<s&&(n=2,a=s);for(let i=n-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(n===i)break;if(r=a,a=t[--n-1],e>=a)break t}i=n,n=0;break n}break e}for(;n<i;){const r=n+i>>>1;e<t[r]?i=r:n=r+1}if(r=t[n],a=t[n-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,r)}return this.interpolate_(n,a,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r;for(let i=0;i!==r;++i)t[i]=n[a+i];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class S1 extends N1{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:QY,endingEnd:QY}}intervalChanged_(e,t,n){const r=this.parameterPositions;let a=e-2,i=e+1,s=r[a],o=r[i];if(void 0===s)switch(this.getSettings_().endingStart){case ZY:a=e,s=2*t-n;break;case eX:a=r.length-2,s=t+r[a]-r[a+1];break;default:a=e,s=n}if(void 0===o)switch(this.getSettings_().endingEnd){case ZY:i=e,o=2*n-t;break;case eX:i=1,o=n+r[1]-r[0];break;default:i=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-n),this._offsetPrev=a*c,this._offsetNext=i*c}interpolate_(e,t,n,r){const a=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,p=(n-t)/(r-t),m=p*p,g=m*p,f=-u*g+2*u*m-u*p,x=(1+u)*g+(-1.5-2*u)*m+(-.5+u)*p+1,y=(-1-h)*g+(1.5+h)*m+.5*p,v=h*g-h*m;for(let b=0;b!==s;++b)a[b]=f*i[c+b]+x*i[l+b]+y*i[o+b]+v*i[d+b];return a}}class j1 extends N1{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const a=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=(n-t)/(r-t),d=1-c;for(let u=0;u!==s;++u)a[u]=i[l+u]*d+i[o+u]*c;return a}}class _1 extends N1{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class A1{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=x1(t,this.TimeBufferType),this.values=x1(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:x1(e.times,Array),values:x1(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new _1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new j1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new S1(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case KY:t=this.InterpolantFactoryMethodDiscrete;break;case qY:t=this.InterpolantFactoryMethodLinear;break;case JY:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return kX("KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return KY;case this.InterpolantFactoryMethodLinear:return qY;case this.InterpolantFactoryMethodSmooth:return JY}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let a=0,i=r-1;for(;a!==r&&n[a]<e;)++a;for(;-1!==i&&n[i]>t;)--i;if(++i,0!==a||i!==r){a>=i&&(i=Math.max(i,1),a=i-1);const e=this.getValueSize();this.times=n.slice(a,i),this.values=this.values.slice(a*e,i*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(EX("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,a=n.length;0===a&&(EX("KeyframeTrack: Track is empty.",this),e=!1);let i=null;for(let s=0;s!==a;s++){const t=n[s];if("number"==typeof t&&isNaN(t)){EX("KeyframeTrack: Time is not a valid number.",this,s,t),e=!1;break}if(null!==i&&i>t){EX("KeyframeTrack: Out of order keys.",this,s,t,i),e=!1;break}i=t}if(void 0!==r&&y1(r))for(let s=0,o=r.length;s!==o;++s){const t=r[s];if(isNaN(t)){EX("KeyframeTrack: Value is not a valid number.",this,s,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===JY,a=e.length-1;let i=1;for(let s=1;s<a;++s){let a=!1;const o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0]))if(r)a=!0;else{const e=s*n,r=e-n,i=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[i+s]){a=!0;break}}}if(a){if(s!==i){e[i]=e[s];const r=s*n,a=i*n;for(let e=0;e!==n;++e)t[a+e]=t[r+e]}++i}}if(a>0){e[i]=e[a];for(let e=a*n,r=i*n,s=0;s!==n;++s)t[r+s]=t[e+s];++i}return i!==e.length?(this.times=e.slice(0,i),this.values=t.slice(0,i*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}A1.prototype.ValueTypeName="",A1.prototype.TimeBufferType=Float32Array,A1.prototype.ValueBufferType=Float32Array,A1.prototype.DefaultInterpolation=qY;class C1 extends A1{constructor(e,t,n){super(e,t,n)}}C1.prototype.ValueTypeName="bool",C1.prototype.ValueBufferType=Array,C1.prototype.DefaultInterpolation=KY,C1.prototype.InterpolantFactoryMethodLinear=void 0,C1.prototype.InterpolantFactoryMethodSmooth=void 0;class M1 extends A1{constructor(e,t,n,r){super(e,t,n,r)}}M1.prototype.ValueTypeName="color";class k1 extends A1{constructor(e,t,n,r){super(e,t,n,r)}}k1.prototype.ValueTypeName="number";class E1 extends N1{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const a=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=(n-t)/(r-t);let l=e*s;for(let c=l+s;l!==c;l+=4)$X.slerpFlat(a,0,i,l-s,i,l,o);return a}}class T1 extends A1{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new E1(this.times,this.values,this.getValueSize(),e)}}T1.prototype.ValueTypeName="quaternion",T1.prototype.InterpolantFactoryMethodSmooth=void 0;class P1 extends A1{constructor(e,t,n){super(e,t,n)}}P1.prototype.ValueTypeName="string",P1.prototype.ValueBufferType=Array,P1.prototype.DefaultInterpolation=KY,P1.prototype.InterpolantFactoryMethodLinear=void 0,P1.prototype.InterpolantFactoryMethodSmooth=void 0;class D1 extends A1{constructor(e,t,n,r){super(e,t,n,r)}}D1.prototype.ValueTypeName="vector";class R1{constructor(e="",t=-1,n=[],r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=BX(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let i=0,s=n.length;i!==s;++i)t.push(I1(n[i]).scale(r));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a.userData=JSON.parse(e.userData||"{}"),a}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let a=0,i=n.length;a!==i;++a)t.push(A1.toJSON(n[a]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const a=t.length,i=[];for(let s=0;s<a;s++){let e=[],o=[];e.push((s+a-1)%a,s,(s+1)%a),o.push(0,1,0);const l=v1(e);e=b1(e,1,l),o=b1(o,1,l),r||0!==e[0]||(e.push(a),o.push(o[0])),i.push(new k1(".morphTargetInfluences["+t[s].name+"]",e,o).scale(1/n))}return new this(e,-1,i)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},a=/^([\w-]*?)([\d]+)$/;for(let s=0,o=e.length;s<o;s++){const t=e[s],n=t.name.match(a);if(n&&n.length>1){const e=n[1];let a=r[e];a||(r[e]=a=[]),a.push(t)}}const i=[];for(const s in r)i.push(this.CreateFromMorphTargetSequence(s,r[s],t,n));return i}static parseAnimation(e,t){if(kX("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return EX("AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,a){if(0!==n.length){const i=[],s=[];w1(n,i,s,r),0!==i.length&&a.push(new e(t,i,s))}},r=[],a=e.name||"default",i=e.fps||30,s=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const a in t){const t=[],i=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),i.push(r.morphTarget===a?1:0)}r.push(new k1(".morphTargetInfluence["+a+"]",t,i))}o=t.length*i}else{const a=".bones["+t[c].name+"]";n(D1,a+".position",e,"pos",r),n(T1,a+".quaternion",e,"rot",r),n(D1,a+".scale",e,"scl",r)}}if(0===r.length)return null;return new this(a,o,r,s)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function I1(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return k1;case"vector":case"vector2":case"vector3":case"vector4":return D1;case"color":return M1;case"quaternion":return T1;case"bool":case"boolean":return C1;case"string":return P1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];w1(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const O1={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class B1{constructor(e,t,n){const r=this;let a,i=!1,s=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,s,o),i=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,o),s===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return a?a(e):e},this.setURLModifier=function(e){return a=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const L1=new B1;class F1{constructor(e){this.manager=void 0!==e?e:L1,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,a){n.load(e,r,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}F1.DEFAULT_MATERIAL_NAME="__DEFAULT";const U1={};class z1 extends Error{constructor(e,t){super(e),this.response=t}}class H1 extends F1{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=O1.get(`file:${e}`);if(void 0!==a)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(void 0!==U1[e])return void U1[e].push({onLoad:t,onProgress:n,onError:r});U1[e]=[],U1[e].push({onLoad:t,onProgress:n,onError:r});const i=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),s=this.mimeType,o=this.responseType;fetch(i).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&kX("FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=U1[e],r=t.body.getReader(),a=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),i=a?parseInt(a):0,s=0!==i;let o=0;const l=new ReadableStream({start(e){!function t(){r.read().then(({done:r,value:a})=>{if(r)e.close();else{o+=a.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:o,total:i});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(a),t()}},t=>{e.error(t)})}()}});return new Response(l)}throw new z1(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,s));case"json":return e.json();default:if(""===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{O1.add(`file:${e}`,t);const n=U1[e];delete U1[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}}).catch(t=>{const n=U1[e];if(void 0===n)throw this.manager.itemError(e),t;delete U1[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const G1=new WeakMap;class V1 extends F1{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,i=O1.get(`image:${e}`);if(void 0!==i){if(!0===i.complete)a.manager.itemStart(e),setTimeout(function(){t&&t(i),a.manager.itemEnd(e)},0);else{let e=G1.get(i);void 0===e&&(e=[],G1.set(i,e)),e.push({onLoad:t,onError:r})}return i}const s=jX("img");function o(){c(),t&&t(this);const n=G1.get(this)||[];for(let e=0;e<n.length;e++){const t=n[e];t.onLoad&&t.onLoad(this)}G1.delete(this),a.manager.itemEnd(e)}function l(t){c(),r&&r(t),O1.remove(`image:${e}`);const n=G1.get(this)||[];for(let e=0;e<n.length;e++){const r=n[e];r.onError&&r.onError(t)}G1.delete(this),a.manager.itemError(e),a.manager.itemEnd(e)}function c(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),O1.add(`image:${e}`,s),a.manager.itemStart(e),s.src=e,s}}class $1 extends F1{constructor(e){super(e)}load(e,t,n,r){const a=new PJ;a.colorSpace=aX;const i=new V1(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);let s=0;function o(n){i.load(e[n],function(e){a.images[n]=e,s++,6===s&&(a.needsUpdate=!0,t&&t(a))},void 0,r)}for(let l=0;l<e.length;++l)o(l);return a}}class W1 extends F1{constructor(e){super(e)}load(e,t,n,r){const a=this,i=new vQ,s=new H1(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(a.withCredentials),s.load(e,function(e){let n;try{n=a.parse(e)}catch(s){if(void 0===r)return void s(s);r(s)}void 0!==n.image?i.image=n.image:void 0!==n.data&&(i.image.width=n.width,i.image.height=n.height,i.image.data=n.data),i.wrapS=void 0!==n.wrapS?n.wrapS:FW,i.wrapT=void 0!==n.wrapT?n.wrapT:FW,i.magFilter=void 0!==n.magFilter?n.magFilter:VW,i.minFilter=void 0!==n.minFilter?n.minFilter:VW,i.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(i.colorSpace=n.colorSpace),void 0!==n.flipY&&(i.flipY=n.flipY),void 0!==n.format&&(i.format=n.format),void 0!==n.type&&(i.type=n.type),void 0!==n.mipmaps&&(i.mipmaps=n.mipmaps,i.minFilter=WW),1===n.mipmapCount&&(i.minFilter=VW),void 0!==n.generateMipmaps&&(i.generateMipmaps=n.generateMipmaps),i.needsUpdate=!0,t&&t(i,n)},n,r),i}}class Y1 extends F1{constructor(e){super(e)}load(e,t,n,r){const a=new dK,i=new V1(this.manager);return i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),i.load(e,function(e){a.image=e,a.needsUpdate=!0,void 0!==t&&t(a)},n,r),a}}class X1 extends fq{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Iq(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class K1 extends X1{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(fq.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Iq(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const q1=new GK,J1=new WX,Q1=new WX;class Z1{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new VX(512,512),this.mapType=XW,this.map=null,this.mapPass=null,this.matrix=new GK,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new FQ,this._frameExtents=new VX(1,1),this._viewportCount=1,this._viewports=[new uK(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;J1.setFromMatrixPosition(e.matrixWorld),t.position.copy(J1),Q1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Q1),t.updateMatrixWorld(),q1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(q1,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(q1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class e2 extends Z1{constructor(){super(new kJ(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=2*OX*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,a=e.distance||t.far;n===t.fov&&r===t.aspect&&a===t.far||(t.fov=n,t.aspect=r,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class t2 extends X1{constructor(e,t,n=0,r=Math.PI/3,a=0,i=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(fq.DEFAULT_UP),this.updateMatrix(),this.target=new fq,this.distance=n,this.angle=r,this.penumbra=a,this.decay=i,this.map=null,this.shadow=new e2}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const n2=new GK,r2=new WX,a2=new WX;class i2 extends Z1{constructor(){super(new kJ(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new VX(4,2),this._viewportCount=6,this._viewports=[new uK(2,1,1,1),new uK(0,1,1,1),new uK(3,1,1,1),new uK(1,1,1,1),new uK(3,0,1,1),new uK(1,0,1,1)],this._cubeDirections=[new WX(1,0,0),new WX(-1,0,0),new WX(0,0,1),new WX(0,0,-1),new WX(0,1,0),new WX(0,-1,0)],this._cubeUps=[new WX(0,1,0),new WX(0,1,0),new WX(0,1,0),new WX(0,1,0),new WX(0,0,1),new WX(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),r2.setFromMatrixPosition(e.matrixWorld),n.position.copy(r2),a2.copy(n.position),a2.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a2),n.updateMatrixWorld(),r.makeTranslation(-r2.x,-r2.y,-r2.z),n2.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n2,n.coordinateSystem,n.reversedDepth)}}class s2 extends X1{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new i2}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class o2 extends _J{constructor(e=-1,t=1,n=1,r=-1,a=.1,i=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=a,this.far=i,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,a,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let a=n-e,i=n+e,s=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=e*this.view.offsetX,i=a+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(a,i,s,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class l2 extends Z1{constructor(){super(new o2(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class c2 extends X1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(fq.DEFAULT_UP),this.updateMatrix(),this.target=new fq,this.shadow=new l2}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class d2 extends X1{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class u2 extends X1{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class h2{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new WX)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,a=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*r),t.addScaledVector(i[2],.488603*a),t.addScaledVector(i[3],.488603*n),t.addScaledVector(i[4],n*r*1.092548),t.addScaledVector(i[5],r*a*1.092548),t.addScaledVector(i[6],.315392*(3*a*a-1)),t.addScaledVector(i[7],n*a*1.092548),t.addScaledVector(i[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,a=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*r),t.addScaledVector(i[2],1.023328*a),t.addScaledVector(i[3],1.023328*n),t.addScaledVector(i[4],.858086*n*r),t.addScaledVector(i[5],.858086*r*a),t.addScaledVector(i[6],.743125*a*a-.247708),t.addScaledVector(i[7],.858086*n*a),t.addScaledVector(i[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,a=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*a,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*n*a,t[8]=.546274*(n*n-r*r)}}class p2 extends X1{constructor(e=new h2,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class m2 extends F1{constructor(e){super(e),this.textures={}}load(e,t,n,r){const a=this,i=new H1(a.manager);i.setPath(a.path),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,function(n){try{t(a.parse(JSON.parse(n)))}catch(bI){r?r(bI):EX(bI),a.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&kX("MaterialLoader: Undefined texture",e),t[e]}const r=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Iq).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(r.dispersion=e.dispersion),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const a in e.uniforms){const t=e.uniforms[a];switch(r.uniforms[a]={},t.type){case"t":r.uniforms[a].value=n(t.value);break;case"c":r.uniforms[a].value=(new Iq).setHex(t.value);break;case"v2":r.uniforms[a].value=(new VX).fromArray(t.value);break;case"v3":r.uniforms[a].value=(new WX).fromArray(t.value);break;case"v4":r.uniforms[a].value=(new uK).fromArray(t.value);break;case"m3":r.uniforms[a].value=(new KX).fromArray(t.value);break;case"m4":r.uniforms[a].value=(new GK).fromArray(t.value);break;default:r.uniforms[a].value=t.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const a in e.extensions)r.extensions[a]=e.extensions[a];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new VX).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new VX).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return m2.createMaterialFromType(e)}static createMaterialFromType(e){return new{ShadowMaterial:i1,SpriteMaterial:GJ,RawShaderMaterial:s1,ShaderMaterial:jJ,PointsMaterial:NZ,MeshPhysicalMaterial:l1,MeshStandardMaterial:o1,MeshPhongMaterial:c1,MeshToonMaterial:d1,MeshNormalMaterial:u1,MeshLambertMaterial:h1,MeshDepthMaterial:p1,MeshDistanceMaterial:m1,MeshBasicMaterial:Fq,MeshMatcapMaterial:g1,LineDashedMaterial:f1,LineBasicMaterial:lZ,Material:Lq}[e]}}class g2{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class f2 extends iJ{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class x2 extends F1{constructor(e){super(e)}load(e,t,n,r){const a=this,i=new H1(a.manager);i.setPath(a.path),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,function(n){try{t(a.parse(JSON.parse(n)))}catch(bI){r?r(bI):EX(bI),a.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const a=e.interleavedBuffers[r],i=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers,a=r[t],i=new Uint32Array(a).buffer;return n[t]=i,i}(e,a.buffer),s=SX(a.type,i),o=new UJ(s,a.stride);return o.uuid=a.uuid,t[r]=o,o}const a=e.isInstancedBufferGeometry?new f2:new iJ,i=e.data.index;if(void 0!==i){const e=SX(i.type,i.array);a.setIndex(new Xq(e,1))}const s=e.data.attributes;for(const d in s){const t=s[d];let n;if(t.isInterleavedBufferAttribute){const a=r(e.data,t.data);n=new HJ(a,t.itemSize,t.offset,t.normalized)}else{const e=SX(t.type,t.array);n=new(t.isInstancedBufferAttribute?SQ:Xq)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),a.setAttribute(d,n)}const o=e.data.morphAttributes;if(o)for(const d in o){const t=o[d],n=[];for(let a=0,i=t.length;a<i;a++){const i=t[a];let s;if(i.isInterleavedBufferAttribute){const t=r(e.data,i.data);s=new HJ(t,i.itemSize,i.offset,i.normalized)}else{const e=SX(i.type,i.array);s=new Xq(e,i.itemSize,i.normalized)}void 0!==i.name&&(s.name=i.name),n.push(s)}a.morphAttributes[d]=n}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let d=0,u=l.length;d!==u;++d){const e=l[d];a.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;return void 0!==c&&(a.boundingSphere=(new RK).fromJSON(c)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}const y2={UVMapping:PW,CubeReflectionMapping:DW,CubeRefractionMapping:RW,EquirectangularReflectionMapping:IW,EquirectangularRefractionMapping:OW,CubeUVReflectionMapping:BW},v2={RepeatWrapping:LW,ClampToEdgeWrapping:FW,MirroredRepeatWrapping:UW},b2={NearestFilter:zW,NearestMipmapNearestFilter:HW,NearestMipmapLinearFilter:GW,LinearFilter:VW,LinearMipmapNearestFilter:$W,LinearMipmapLinearFilter:WW},w2=new WeakMap;class N2 extends F1{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&kX("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&kX("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,i=O1.get(`image-bitmap:${e}`);if(void 0!==i)return a.manager.itemStart(e),i.then?void i.then(n=>{if(!0!==w2.has(i))return t&&t(n),a.manager.itemEnd(e),n;r&&r(w2.get(i)),a.manager.itemError(e),a.manager.itemEnd(e)}):(setTimeout(function(){t&&t(i),a.manager.itemEnd(e)},0),i);const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,s.signal="function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const o=fetch(e,s).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(n){return O1.add(`image-bitmap:${e}`,n),t&&t(n),a.manager.itemEnd(e),n}).catch(function(t){r&&r(t),w2.set(o,t),O1.remove(`image-bitmap:${e}`),a.manager.itemError(e),a.manager.itemEnd(e)});O1.add(`image-bitmap:${e}`,o),a.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let S2;class j2{static getContext(){return void 0===S2&&(S2=new(window.AudioContext||window.webkitAudioContext)),S2}static setContext(e){S2=e}}const _2=new GK,A2=new GK,C2=new GK;class M2 extends kJ{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class k2{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const E2=new WX,T2=new $X,P2=new WX,D2=new WX,R2=new WX;class I2 extends fq{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void kX("Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void kX("Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;kX("Audio: this Audio has no playback control.")}stop(e=0){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this;kX("Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;kX("Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(kX("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;kX("Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),"buffer"!==e.sourceType?(kX("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const O2=new WX,B2=new $X,L2=new WX,F2=new WX;class U2{constructor(e,t,n){let r,a,i;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,a=this._slerpAdditive,i=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,a=this._select,i=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,a=this._lerpAdditive,i=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=a,this._setIdentity=i,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,a=e*r+r;let i=this.cumulativeWeight;if(0===i){for(let e=0;e!==r;++e)n[a+e]=n[e];i=t}else{i+=t;const e=t/i;this._mixBufferRegion(n,a,0,e,r)}this.cumulativeWeight=i}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,a=this.cumulativeWeight,i=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-a,t)}i>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){s.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let a=n,i=r;a!==i;++a)t[a]=t[r+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,a){if(r>=.5)for(let i=0;i!==a;++i)e[t+i]=e[n+i]}_slerp(e,t,n,r){$X.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,a){const i=this._workIndex*a;$X.multiplyQuaternionsFlat(e,i,e,t,e,n),$X.slerpFlat(e,t,e,t,e,i,r)}_lerp(e,t,n,r,a){const i=1-r;for(let s=0;s!==a;++s){const a=t+s;e[a]=e[a]*i+e[n+s]*r}}_lerpAdditive(e,t,n,r,a){for(let i=0;i!==a;++i){const a=t+i;e[a]=e[a]+e[n+i]*r}}}const z2="\\[\\]\\.:\\/",H2=new RegExp("["+z2+"]","g"),G2="[^"+z2+"]",V2="[^"+z2.replace("\\.","")+"]",$2=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",G2)+/(WCOD+)?/.source.replace("WCOD",V2)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",G2)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",G2)+"$"),W2=["material","materials","bones","map"];class Y2{constructor(e,t,n){this.path=t,this.parsedPath=n||Y2.parseTrackName(t),this.node=Y2.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Y2.Composite(e,t,n):new Y2(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(H2,"")}static parseTrackName(e){const t=$2.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==W2.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const a=e[r];if(a.name===t||a.uuid===t)return a;const i=n(a.children);if(i)return i}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let a=t.propertyIndex;if(e||(e=Y2.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void kX("PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void EX("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void EX("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void EX("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void EX("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void EX("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void EX("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void EX("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const i=e[r];if(void 0===i){return void EX("PropertyBinding: Trying to update property for track: "+t.nodeName+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?s=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===r){if(!e.geometry)return void EX("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void EX("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[a]&&(a=e.morphTargetDictionary[a])}o=this.BindingType.ArrayElement,this.resolvedProperty=i,this.propertyIndex=a}else void 0!==i.fromArray&&void 0!==i.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=i):Array.isArray(i)?(o=this.BindingType.EntireArray,this.resolvedProperty=i):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Y2.Composite=class{constructor(e,t,n){const r=n||Y2.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Y2.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Y2.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Y2.prototype.GetterByBindingType=[Y2.prototype._getValue_direct,Y2.prototype._getValue_array,Y2.prototype._getValue_arrayElement,Y2.prototype._getValue_toArray],Y2.prototype.SetterByBindingTypeAndVersioning=[[Y2.prototype._setValue_direct,Y2.prototype._setValue_direct_setNeedsUpdate,Y2.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Y2.prototype._setValue_array,Y2.prototype._setValue_array_setNeedsUpdate,Y2.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Y2.prototype._setValue_arrayElement,Y2.prototype._setValue_arrayElement_setNeedsUpdate,Y2.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Y2.prototype._setValue_fromArray,Y2.prototype._setValue_fromArray_setNeedsUpdate,Y2.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class X2{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const a=t.tracks,i=a.length,s=new Array(i),o={endingStart:QY,endingEnd:QY};for(let l=0;l!==i;++l){const e=a[l].createInterpolant(null);s[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),!0===n){const n=this._clip.duration,r=e._clip.duration,a=r/n,i=n/r;e.warp(1,a,t),this.warp(i,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,a=r.time,i=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const o=s.parameterPositions,l=s.sampleValues;return o[0]=a,o[1]=a+n,l[0]=e/i,l[1]=t/i,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const a=this._startTime;if(null!==a){const r=(e-a)*n;r<0||0===n?t=0:(this._startTime=null,t=n*r)}t*=this._updateTimeScale(e);const i=this._updateTime(t),s=this._updateWeight(e);if(s>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===nX)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(i),t[n].accumulateAdditive(s);else for(let n=0,a=e.length;n!==a;++n)e[n].evaluate(i),t[n].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,a=this._loopCount;const i=2202===n;if(0===e)return-1===a||!i||1&~a?r:t-r;if(2200===n){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===a&&(e>=0?(a=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,a+=Math.abs(n);const s=this.repetitions-a;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){const t=e<0;this._setEndings(t,!t,i)}else this._setEndings(!1,!1,i);this._loopCount=a,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(i&&!(1&~a))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=ZY,r.endingEnd=ZY):(r.endingStart=e?this.zeroSlopeAtStart?ZY:QY:eX,r.endingEnd=t?this.zeroSlopeAtEnd?ZY:QY:eX)}_scheduleFading(e,t,n){const r=this._mixer,a=r.time;let i=this._weightInterpolant;null===i&&(i=r._lendControlInterpolant(),this._weightInterpolant=i);const s=i.parameterPositions,o=i.sampleValues;return s[0]=a,o[0]=t,s[1]=a+e,o[1]=n,this}}const K2=new Float32Array(1);class q2{constructor(e){this.value=e}clone(){return new q2(void 0===this.value.clone?this.value:this.value.clone())}}let J2=0;const Q2=new GK;class Z2{constructor(e,t,n=0,r=1/0){this.ray=new HK(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new eq,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):EX("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Q2.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Q2),this}intersectObject(e,t=!0,n=[]){return t3(e,this,n,t),n.sort(e3),n}intersectObjects(e,t=!0,n=[]){for(let r=0,a=e.length;r<a;r++)t3(e[r],this,n,t);return n.sort(e3),n}}function e3(e,t){return e.distance-t.distance}function t3(e,t,n,r){let a=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(a=!1)}if(!0===a&&!0===r){const r=e.children;for(let e=0,a=r.length;e<a;e++)t3(r[e],t,n,!0)}}function n3(){!1===this._document.hidden&&this.reset()}class r3{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=LX(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(LX(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class a3{constructor(e,t,n,r){a3.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const a=this.elements;return a[0]=e,a[2]=t,a[1]=n,a[3]=r,this}}const i3=new VX;const s3=new WX,o3=new WX,l3=new WX,c3=new WX,d3=new WX,u3=new WX,h3=new WX;const p3=new WX;const m3=new WX,g3=new GK,f3=new GK;function x3(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push(...x3(e.children[n]));return t}const y3=new WX,v3=new Iq,b3=new Iq;const w3=new WX,N3=new WX,S3=new WX;const j3=new WX,_3=new _J;function A3(e,t,n,r,a,i,s){j3.set(a,i,s).unproject(r);const o=t[e];if(void 0!==o){const e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],j3.x,j3.y,j3.z)}}const C3=new fK;const M3=new WX;let k3,E3;function T3(e,t,n,r){const a=function(e){switch(e){case XW:case KW:return{byteLength:1,components:1};case JW:case qW:case tY:return{byteLength:2,components:1};case nY:case rY:return{byteLength:2,components:4};case ZW:case QW:case eY:return{byteLength:4,components:1};case iY:case sY:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(r);switch(n){case oY:return e*t;case hY:case pY:return e*t/a.components*a.byteLength;case mY:case gY:return e*t*2/a.components*a.byteLength;case lY:return e*t*3/a.components*a.byteLength;case cY:case fY:return e*t*4/a.components*a.byteLength;case xY:case yY:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case vY:case bY:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case NY:case jY:return Math.max(e,16)*Math.max(t,8)/4;case wY:case SY:return Math.max(e,8)*Math.max(t,8)/2;case _Y:case AY:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case CY:case MY:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case kY:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case EY:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case TY:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case PY:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case DY:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case RY:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case IY:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case OY:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case BY:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case LY:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case FY:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case UY:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case zY:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case HY:case GY:case VY:return Math.ceil(e/4)*Math.ceil(t/4)*16;case $Y:case WY:return Math.ceil(e/4)*Math.ceil(t/4)*8;case YY:case XY:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
function P3(){let e=null,t=!1,n=null,r=null;function a(t,i){n(t,i),r=e.requestAnimationFrame(a)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(a),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function D3(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const a=t.get(n);if(void 0===a)t.set(n,function(t,n){const r=t.array,a=t.usage,i=r.byteLength,s=e.createBuffer();let o;if(e.bindBuffer(n,s),e.bufferData(n,r,a),t.onUploadCallback(),r instanceof Float32Array)o=e.FLOAT;else if("undefined"!=typeof Float16Array&&r instanceof Float16Array)o=e.HALF_FLOAT;else if(r instanceof Uint16Array)o=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)o=e.SHORT;else if(r instanceof Uint32Array)o=e.UNSIGNED_INT;else if(r instanceof Int32Array)o=e.INT;else if(r instanceof Int8Array)o=e.BYTE;else if(r instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);o=e.UNSIGNED_BYTE}return{buffer:s,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:i}}(n,r));else if(a.version<n.version){if(a.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const a=n.array,i=n.updateRanges;if(e.bindBuffer(r,t),0===i.length)e.bufferSubData(r,0,a);else{i.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<i.length;e++){const n=i[t],r=i[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,i[t]=r)}i.length=t+1;for(let n=0,s=i.length;n<s;n++){const t=i[n];e.bufferSubData(r,t.start*a.BYTES_PER_ELEMENT,a,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(a.buffer,n,r),a.version=n.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Q$}})),"undefined"!=typeof window&&(window.__THREE__?kX("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Q$);const R3={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 uv = vec2( roughness, dotNV );\n\treturn texture2D( dfgLUT, uv ).rg;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNV * dotNV), 0.0, dotNV), material.roughness );\n\tvec2 dfgL = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNL * dotNL), 0.0, dotNL), material.roughness );\n\tvec3 FssEss_V = material.specularColor * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColor * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColor + ( 1.0 - material.specularColor ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},I3={common:{diffuse:{value:new Iq(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new KX},alphaMap:{value:null},alphaMapTransform:{value:new KX},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new KX}},envmap:{envMap:{value:null},envMapRotation:{value:new KX},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new KX}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new KX}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new KX},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new KX},normalScale:{value:new VX(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new KX},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new KX}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new KX}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new KX}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Iq(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Iq(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new KX},alphaTest:{value:0},uvTransform:{value:new KX}},sprite:{diffuse:{value:new Iq(16777215)},opacity:{value:1},center:{value:new VX(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new KX},alphaMap:{value:null},alphaMapTransform:{value:new KX},alphaTest:{value:0}}},O3={basic:{uniforms:wJ([I3.common,I3.specularmap,I3.envmap,I3.aomap,I3.lightmap,I3.fog]),vertexShader:R3.meshbasic_vert,fragmentShader:R3.meshbasic_frag},lambert:{uniforms:wJ([I3.common,I3.specularmap,I3.envmap,I3.aomap,I3.lightmap,I3.emissivemap,I3.bumpmap,I3.normalmap,I3.displacementmap,I3.fog,I3.lights,{emissive:{value:new Iq(0)}}]),vertexShader:R3.meshlambert_vert,fragmentShader:R3.meshlambert_frag},phong:{uniforms:wJ([I3.common,I3.specularmap,I3.envmap,I3.aomap,I3.lightmap,I3.emissivemap,I3.bumpmap,I3.normalmap,I3.displacementmap,I3.fog,I3.lights,{emissive:{value:new Iq(0)},specular:{value:new Iq(1118481)},shininess:{value:30}}]),vertexShader:R3.meshphong_vert,fragmentShader:R3.meshphong_frag},standard:{uniforms:wJ([I3.common,I3.envmap,I3.aomap,I3.lightmap,I3.emissivemap,I3.bumpmap,I3.normalmap,I3.displacementmap,I3.roughnessmap,I3.metalnessmap,I3.fog,I3.lights,{emissive:{value:new Iq(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:R3.meshphysical_vert,fragmentShader:R3.meshphysical_frag},toon:{uniforms:wJ([I3.common,I3.aomap,I3.lightmap,I3.emissivemap,I3.bumpmap,I3.normalmap,I3.displacementmap,I3.gradientmap,I3.fog,I3.lights,{emissive:{value:new Iq(0)}}]),vertexShader:R3.meshtoon_vert,fragmentShader:R3.meshtoon_frag},matcap:{uniforms:wJ([I3.common,I3.bumpmap,I3.normalmap,I3.displacementmap,I3.fog,{matcap:{value:null}}]),vertexShader:R3.meshmatcap_vert,fragmentShader:R3.meshmatcap_frag},points:{uniforms:wJ([I3.points,I3.fog]),vertexShader:R3.points_vert,fragmentShader:R3.points_frag},dashed:{uniforms:wJ([I3.common,I3.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:R3.linedashed_vert,fragmentShader:R3.linedashed_frag},depth:{uniforms:wJ([I3.common,I3.displacementmap]),vertexShader:R3.depth_vert,fragmentShader:R3.depth_frag},normal:{uniforms:wJ([I3.common,I3.bumpmap,I3.normalmap,I3.displacementmap,{opacity:{value:1}}]),vertexShader:R3.meshnormal_vert,fragmentShader:R3.meshnormal_frag},sprite:{uniforms:wJ([I3.sprite,I3.fog]),vertexShader:R3.sprite_vert,fragmentShader:R3.sprite_frag},background:{uniforms:{uvTransform:{value:new KX},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:R3.background_vert,fragmentShader:R3.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new KX}},vertexShader:R3.backgroundCube_vert,fragmentShader:R3.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:R3.cube_vert,fragmentShader:R3.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:R3.equirect_vert,fragmentShader:R3.equirect_frag},distanceRGBA:{uniforms:wJ([I3.common,I3.displacementmap,{referencePosition:{value:new WX},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:R3.distanceRGBA_vert,fragmentShader:R3.distanceRGBA_frag},shadow:{uniforms:wJ([I3.lights,I3.fog,{color:{value:new Iq(0)},opacity:{value:1}}]),vertexShader:R3.shadow_vert,fragmentShader:R3.shadow_frag}};O3.physical={uniforms:wJ([O3.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new KX},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new KX},clearcoatNormalScale:{value:new VX(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new KX},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new KX},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new KX},sheen:{value:0},sheenColor:{value:new Iq(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new KX},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new KX},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new KX},transmissionSamplerSize:{value:new VX},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new KX},attenuationDistance:{value:0},attenuationColor:{value:new Iq(0)},specularColor:{value:new Iq(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new KX},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new KX},anisotropyVector:{value:new VX},anisotropyMap:{value:null},anisotropyMapTransform:{value:new KX}}]),vertexShader:R3.meshphysical_vert,fragmentShader:R3.meshphysical_frag};const B3={r:0,b:0,g:0},L3=new ZK,F3=new GK;function U3(e,t,n,r,a,i,s){const o=new Iq(0);let l,c,d=!0===i?0:1,u=null,h=0,p=null;function m(e){let r=!0===e.isScene?e.background:null;if(r&&r.isTexture){r=(e.backgroundBlurriness>0?n:t).get(r)}return r}function g(t,n){t.getRGB(B3,NJ(e)),r.buffers.color.setClear(B3.r,B3.g,B3.b,n,s)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),d=t,g(o,d)},getClearAlpha:function(){return d},setClearAlpha:function(e){d=e,g(o,d)},render:function(t){let n=!1;const a=m(t);null===a?g(o,d):a&&a.isColor&&(g(a,1),n=!0);const i=e.xr.getEnvironmentBlendMode();"additive"===i?r.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===i&&r.buffers.color.setClear(0,0,0,0,s),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=m(n);r&&(r.isCubeTexture||r.mapping===BW)?(void 0===c&&(c=new xJ(new vJ(1,1,1),new jJ({name:"BackgroundCubeMaterial",uniforms:bJ(O3.backgroundCube.uniforms),vertexShader:O3.backgroundCube.vertexShader,fragmentShader:O3.backgroundCube.fragmentShader,side:nW,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(c)),L3.copy(n.backgroundRotation),L3.x*=-1,L3.y*=-1,L3.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(L3.y*=-1,L3.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(F3.makeRotationFromEuler(L3)),c.material.toneMapped=eK.getTransfer(r.colorSpace)!==oX,u===r&&h===r.version&&p===e.toneMapping||(c.material.needsUpdate=!0,u=r,h=r.version,p=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new xJ(new X0(2,2),new jJ({name:"BackgroundMaterial",uniforms:bJ(O3.background.uniforms),vertexShader:O3.background.vertexShader,fragmentShader:O3.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=eK.getTransfer(r.colorSpace)!==oX,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),u===r&&h===r.version&&p===e.toneMapping||(l.material.needsUpdate=!0,u=r,h=r.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function z3(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},a=c(null);let i=a,s=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],a=[];for(let i=0;i<n;i++)t[i]=0,r[i]=0,a[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:a,object:e,attributes:{},index:null}}function d(){const e=i.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function u(e){h(e,0)}function h(t,n){const r=i.newAttributes,a=i.enabledAttributes,s=i.attributeDivisors;r[t]=1,0===a[t]&&(e.enableVertexAttribArray(t),a[t]=1),s[t]!==n&&(e.vertexAttribDivisor(t,n),s[t]=n)}function p(){const t=i.newAttributes,n=i.enabledAttributes;for(let r=0,a=n.length;r<a;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function m(t,n,r,a,i,s,o){!0===o?e.vertexAttribIPointer(t,n,r,i,s):e.vertexAttribPointer(t,n,r,a,i,s)}function g(){f(),s=!0,i!==a&&(i=a,o(i.object))}function f(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:function(n,a,l,g,f){let x=!1;const y=function(t,n,a){const i=!0===a.wireframe;let s=r[t.id];void 0===s&&(s={},r[t.id]=s);let o=s[n.id];void 0===o&&(o={},s[n.id]=o);let l=o[i];void 0===l&&(l=c(e.createVertexArray()),o[i]=l);return l}(g,l,a);i!==y&&(i=y,o(i.object)),x=function(e,t,n,r){const a=i.attributes,s=t.attributes;let o=0;const l=n.getAttributes();for(const i in l){if(l[i].location>=0){const t=a[i];let n=s[i];if(void 0===n&&("instanceMatrix"===i&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===i&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return i.attributesNum!==o||i.index!==r}(n,g,l,f),x&&function(e,t,n,r){const a={},s=t.attributes;let o=0;const l=n.getAttributes();for(const i in l){if(l[i].location>=0){let t=s[i];void 0===t&&("instanceMatrix"===i&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===i&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),a[i]=n,o++}}i.attributes=a,i.attributesNum=o,i.index=r}(n,g,l,f),null!==f&&t.update(f,e.ELEMENT_ARRAY_BUFFER),(x||s)&&(s=!1,function(n,r,a,i){d();const s=i.attributes,o=a.getAttributes(),l=r.defaultAttributeValues;for(const c in o){const r=o[c];if(r.location>=0){let a=s[c];if(void 0===a&&("instanceMatrix"===c&&n.instanceMatrix&&(a=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(a=n.instanceColor)),void 0!==a){const s=a.normalized,o=a.itemSize,l=t.get(a);if(void 0===l)continue;const c=l.buffer,d=l.type,p=l.bytesPerElement,g=d===e.INT||d===e.UNSIGNED_INT||a.gpuType===QW;if(a.isInterleavedBufferAttribute){const t=a.data,l=t.stride,f=a.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)h(r.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===i._maxInstanceCount&&(i._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<r.locationSize;e++)u(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)m(r.location+e,o/r.locationSize,d,s,l*p,(f+o/r.locationSize*e)*p,g)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)h(r.location+e,a.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===i._maxInstanceCount&&(i._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<r.locationSize;e++)u(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)m(r.location+e,o/r.locationSize,d,s,o*p,o/r.locationSize*e*p,g)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(r.location,t);break;case 3:e.vertexAttrib3fv(r.location,t);break;case 4:e.vertexAttrib4fv(r.location,t);break;default:e.vertexAttrib1fv(r.location,t)}}}}p()}(n,a,l,g),null!==f&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(f).buffer))},reset:g,resetDefaultState:f,dispose:function(){g();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const a=n[e.id];for(const e in a)l(a[e].object),delete a[e];delete n[e.id]}},initAttributes:d,enableAttribute:u,disableUnusedAttributes:p}}function H3(e,t,n){let r;function a(t,a,i){0!==i&&(e.drawArraysInstanced(r,t,a,i),n.update(a,r,i))}this.setMode=function(e){r=e},this.render=function(t,a){e.drawArrays(r,t,a),n.update(a,r,1)},this.renderInstances=a,this.renderMultiDraw=function(e,a,i){if(0===i)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,a,0,i);let s=0;for(let t=0;t<i;t++)s+=a[t];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,i,s,o){if(0===s)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)a(e[t],i[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,i,0,o,0,s);let t=0;for(let e=0;e<s;e++)t+=i[e]*o[e];n.update(t,r,1)}}}function G3(e,t,n,r){let a;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==n.precision?n.precision:"highp";const o=i(s);o!==s&&(kX("WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),d=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==a)return a;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");a=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a},getMaxPrecision:i,textureFormatReadable:function(t){return t===cY||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const a=n===tY&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==XW&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==eY&&!a)},precision:s,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:d,maxVertexTextures:u,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:u>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function V3(e){const t=this;let n=null,r=0,a=!1,i=!1;const s=new IQ,o=new KX,l={value:null,needsUpdate:!1};function c(e,n,r,a){const i=null!==e?e.length:0;let c=null;if(0!==i){if(c=l.value,!0!==a||null===c){const t=r+4*i,a=n.matrixWorldInverse;o.getNormalMatrix(a),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=r;n!==i;++n,l+=4)s.copy(e[n]).applyMatrix4(a,o),s.normal.toArray(c,l),c[l+3]=s.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=i,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||a;return a=t,r=e.length,n},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(s,o,d){const u=s.clippingPlanes,h=s.clipIntersection,p=s.clipShadows,m=e.get(s);if(!a||null===u||0===u.length||i&&!p)i?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{const e=i?0:r,t=4*e;let a=m.clippingState||null;l.value=a,a=c(u,o,t,d);for(let r=0;r!==t;++r)a[r]=n[r];m.clippingState=a,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function $3(e){let t=new WeakMap;function n(e,t){return t===IW?e.mapping=DW:t===OW&&(e.mapping=RW),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const a=t.get(n);void 0!==a&&(t.delete(n),a.dispose())}return{get:function(a){if(a&&a.isTexture){const i=a.mapping;if(i===IW||i===OW){if(t.has(a)){return n(t.get(a).texture,a.mapping)}{const i=a.image;if(i&&i.height>0){const s=new DJ(i.height);return s.fromEquirectangularTexture(e,a),t.set(a,s),a.addEventListener("dispose",r),n(s.texture,a.mapping)}return null}}}return a},dispose:function(){t=new WeakMap}}}const W3=[.125,.215,.35,.446,.526,.582],Y3=20,X3=new o2,K3=new Iq;let q3=null,J3=0,Q3=0,Z3=!1;const e4=new WX;class t4{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,a={}){const{size:i=256,position:s=e4}=a;q3=this._renderer.getRenderTarget(),J3=this._renderer.getActiveCubeFace(),Q3=this._renderer.getActiveMipmapLevel(),Z3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(i);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,r,o,s),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=i4(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=a4(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(q3,J3,Q3),this._renderer.xr.enabled=Z3,e.scissorTest=!1,r4(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===DW||e.mapping===RW?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),q3=this._renderer.getRenderTarget(),J3=this._renderer.getActiveCubeFace(),Q3=this._renderer.getActiveMipmapLevel(),Z3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:VW,minFilter:VW,generateMipmaps:!1,type:tY,format:cY,colorSpace:iX,depthBuffer:!1},r=n4(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=n4(e,t,n);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let a=e;const i=e-4+1+W3.length;for(let s=0;s<i;s++){const i=Math.pow(2,a);t.push(i);let o=1/i;s>e-4?o=W3[s-e+4-1]:0===s&&(o=0),n.push(o);const l=1/(i-2),c=-l,d=1+l,u=[c,c,d,c,d,d,c,c,d,d,c,d],h=6,p=6,m=3,g=2,f=1,x=new Float32Array(m*p*h),y=new Float32Array(g*p*h),v=new Float32Array(f*p*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];x.set(r,m*p*e),y.set(u,g*p*e);const a=[e,e,e,e,e,e];v.set(a,f*p*e)}const b=new iJ;b.setAttribute("position",new Xq(x,m)),b.setAttribute("uv",new Xq(y,g)),b.setAttribute("faceIndex",new Xq(v,f)),r.push(new xJ(b,null)),a>4&&a--}return{lodMeshes:r,sizeLods:t,sigmas:n}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(Y3),a=new WX(0,1,0),i=new jJ({name:"SphericalGaussianBlur",defines:{n:Y3,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:s4(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return i}(r,e,t)}return r}_compileMaterial(e){const t=new xJ(new iJ,e);this._renderer.compile(t,X3)}_sceneToCubeUV(e,t,n,r,a){const i=new kJ(90,1,t,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,d=l.toneMapping;l.getClearColor(K3),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(r),l.clearDepth(),l.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new xJ(new vJ,new Fq({name:"PMREM.Background",side:nW,depthWrite:!1,depthTest:!1})));const u=this._backgroundBox,h=u.material;let p=!1;const m=e.background;m?m.isColor&&(h.color.copy(m),e.background=null,p=!0):(h.color.copy(K3),p=!0);for(let g=0;g<6;g++){const t=g%3;0===t?(i.up.set(0,s[g],0),i.position.set(a.x,a.y,a.z),i.lookAt(a.x+o[g],a.y,a.z)):1===t?(i.up.set(0,0,s[g]),i.position.set(a.x,a.y,a.z),i.lookAt(a.x,a.y+o[g],a.z)):(i.up.set(0,s[g],0),i.position.set(a.x,a.y,a.z),i.lookAt(a.x,a.y,a.z+o[g]));const n=this._cubeSize;r4(r,t*n,g>2?n:0,n,n),l.setRenderTarget(r),p&&l.render(u,i),l.render(e,i)}l.toneMapping=d,l.autoClear=c,e.background=m}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===DW||e.mapping===RW;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=i4()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=a4());const a=r?this._cubemapMaterial:this._equirectMaterial,i=this._lodMeshes[0];i.material=a;a.uniforms.envMap.value=e;const s=this._cubeSize;r4(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(i,X3)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let a=1;a<r;a++)this._applyGGXFilter(e,a-1,a);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,a=this._pingPongRenderTarget;if(null===this._ggxMaterial){const e=3*Math.max(this._cubeSize,16),t=4*this._cubeSize;this._ggxMaterial=function(e,t,n){const r=new jJ({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:s4(),fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:0,depthTest:!1,depthWrite:!1});return r}(this._lodMax,e,t)}const i=this._ggxMaterial,s=this._lodMeshes[n];s.material=i;const o=i.uniforms,l=n/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),d=Math.sqrt(l*l-c*c)*(.05+.95*l),{_lodMax:u}=this,h=this._sizeLods[n],p=3*h*(n>u-4?n-u+4:0),m=4*(this._cubeSize-h);o.envMap.value=e.texture,o.roughness.value=d,o.mipInt.value=u-t,r4(a,p,m,3*h,2*h),r.setRenderTarget(a),r.render(s,X3),o.envMap.value=a.texture,o.roughness.value=0,o.mipInt.value=u-n,r4(e,p,m,3*h,2*h),r.setRenderTarget(e),r.render(s,X3)}_blur(e,t,n,r,a){const i=this._pingPongRenderTarget;this._halfBlur(e,i,t,n,r,"latitudinal",a),this._halfBlur(i,e,n,n,r,"longitudinal",a)}_halfBlur(e,t,n,r,a,i,s){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&EX("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[r];c.material=l;const d=l.uniforms,u=this._sizeLods[n]-1,h=isFinite(a)?Math.PI/(2*u):2*Math.PI/39,p=a/h,m=isFinite(a)?1+Math.floor(3*p):Y3;m>Y3&&kX(`sigmaRadians, ${a}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const g=[];let f=0;for(let v=0;v<Y3;++v){const e=v/p,t=Math.exp(-e*e/2);g.push(t),0===v?f+=t:v<m&&(f+=2*t)}for(let v=0;v<g.length;v++)g[v]=g[v]/f;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=g,d.latitudinal.value="latitudinal"===i,s&&(d.poleAxis.value=s);const{_lodMax:x}=this;d.dTheta.value=h,d.mipInt.value=x-n;const y=this._sizeLods[r];r4(t,3*y*(r>x-4?r-x+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,X3)}}function n4(e,t,n){const r=new pK(e,t,n);return r.texture.mapping=BW,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function r4(e,t,n,r,a){e.viewport.set(t,n,r,a),e.scissor.set(t,n,r,a)}function a4(){return new jJ({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:s4(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function i4(){return new jJ({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:s4(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function s4(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function o4(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const a=t.get(n);void 0!==a&&(t.delete(n),a.dispose())}return{get:function(a){if(a&&a.isTexture){const i=a.mapping,s=i===IW||i===OW,o=i===DW||i===RW;if(s||o){let i=t.get(a);const l=void 0!==i?i.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==l)return null===n&&(n=new t4(e)),i=s?n.fromEquirectangular(a,i):n.fromCubemap(a,i),i.texture.pmremVersion=a.pmremVersion,t.set(a,i),i.texture;if(void 0!==i)return i.texture;{const l=a.image;return s&&l&&l.height>0||o&&l&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(l)?(null===n&&(n=new t4(e)),i=s?n.fromEquirectangular(a):n.fromCubemap(a),i.texture.pmremVersion=a.pmremVersion,t.set(a,i),a.addEventListener("dispose",r),i.texture):null}}}return a},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function l4(e){const t={};function n(n){if(void 0!==t[n])return t[n];const r=e.getExtension(n);return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&TX("WebGLRenderer: "+e+" extension not supported."),t}}}function c4(e,t,n,r){const a={},i=new WeakMap;function s(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",s),delete a[o.id];const l=i.get(o);l&&(t.remove(l),i.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],r=e.index,a=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],a=e[t+1],i=e[t+2];n.push(r,a,a,i,i,r)}}else{if(void 0===a)return;{const e=a.array;s=a.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,a=t+2;n.push(e,r,r,a,a,e)}}}const o=new(wX(n)?qq:Kq)(n,1);o.version=s;const l=i.get(e);l&&t.remove(l),i.set(e,o)}return{get:function(e,t){return!0===a[t.id]||(t.addEventListener("dispose",s),a[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const a in r)t.update(r[a],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=i.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return i.get(e)}}}function d4(e,t,n){let r,a,i;function s(t,s,o){0!==o&&(e.drawElementsInstanced(r,s,a,t*i,o),n.update(s,r,o))}this.setMode=function(e){r=e},this.setIndex=function(e){a=e.type,i=e.bytesPerElement},this.render=function(t,s){e.drawElements(r,s,a,t*i),n.update(s,r,1)},this.renderInstances=s,this.renderMultiDraw=function(e,i,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,i,0,a,e,0,s);let o=0;for(let t=0;t<s;t++)o+=i[t];n.update(o,r,1)},this.renderMultiDrawInstances=function(e,o,l,c){if(0===l)return;const d=t.get("WEBGL_multi_draw");if(null===d)for(let t=0;t<e.length;t++)s(e[t]/i,o[t],c[t]);else{d.multiDrawElementsInstancedWEBGL(r,o,0,a,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e]*c[e];n.update(t,r,1)}}}function u4(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,a){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=a*(n/3);break;case e.LINES:t.lines+=a*(n/2);break;case e.LINE_STRIP:t.lines+=a*(n-1);break;case e.LINE_LOOP:t.lines+=a*n;break;case e.POINTS:t.points+=a*n;break;default:EX("WebGLInfo: Unknown draw mode:",r)}}}}function h4(e,t,n){const r=new WeakMap,a=new uK;return{update:function(i,s,o){const l=i.morphTargetInfluences,c=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,d=void 0!==c?c.length:0;let u=r.get(s);if(void 0===u||u.count!==d){let e=function(){x.dispose(),r.delete(s),s.removeEventListener("dispose",e)};void 0!==u&&u.texture.dispose();const n=void 0!==s.morphAttributes.position,i=void 0!==s.morphAttributes.normal,o=void 0!==s.morphAttributes.color,l=s.morphAttributes.position||[],c=s.morphAttributes.normal||[],h=s.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===i&&(p=2),!0===o&&(p=3);let m=s.attributes.position.count*p,g=1;m>t.maxTextureSize&&(g=Math.ceil(m/t.maxTextureSize),m=t.maxTextureSize);const f=new Float32Array(m*g*4*d),x=new mK(f,m,g,d);x.type=eY,x.needsUpdate=!0;const y=4*p;for(let t=0;t<d;t++){const e=l[t],r=c[t],s=h[t],d=m*g*4*t;for(let t=0;t<e.count;t++){const l=t*y;!0===n&&(a.fromBufferAttribute(e,t),f[d+l+0]=a.x,f[d+l+1]=a.y,f[d+l+2]=a.z,f[d+l+3]=0),!0===i&&(a.fromBufferAttribute(r,t),f[d+l+4]=a.x,f[d+l+5]=a.y,f[d+l+6]=a.z,f[d+l+7]=0),!0===o&&(a.fromBufferAttribute(s,t),f[d+l+8]=a.x,f[d+l+9]=a.y,f[d+l+10]=a.z,f[d+l+11]=4===s.itemSize?a.w:1)}}u={count:d,texture:x,size:new VX(m,g)},r.set(s,u),s.addEventListener("dispose",e)}if(!0===i.isInstancedMesh&&null!==i.morphTexture)o.getUniforms().setValue(e,"morphTexture",i.morphTexture,n);else{let t=0;for(let e=0;e<l.length;e++)t+=l[e];const n=s.morphTargetsRelative?1:1-t;o.getUniforms().setValue(e,"morphTargetBaseInfluence",n),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",u.texture,n),o.getUniforms().setValue(e,"morphTargetsTextureSize",u.size)}}}function p4(e,t,n,r){let a=new WeakMap;function i(e){const t=e.target;t.removeEventListener("dispose",i),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(s){const o=r.render.frame,l=s.geometry,c=t.get(s,l);if(a.get(c)!==o&&(t.update(c),a.set(c,o)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",i)&&s.addEventListener("dispose",i),a.get(s)!==o&&(n.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&n.update(s.instanceColor,e.ARRAY_BUFFER),a.set(s,o))),s.isSkinnedMesh){const e=s.skeleton;a.get(e)!==o&&(e.update(),a.set(e,o))}return c},dispose:function(){a=new WeakMap}}}const m4=new dK,g4=new TZ(1,1),f4=new mK,x4=new gK,y4=new PJ,v4=[],b4=[],w4=new Float32Array(16),N4=new Float32Array(9),S4=new Float32Array(4);function j4(e,t,n){const r=e[0];if(r<=0||r>0)return e;const a=t*n;let i=v4[a];if(void 0===i&&(i=new Float32Array(a),v4[a]=i),0!==t){r.toArray(i,0);for(let r=1,a=0;r!==t;++r)a+=n,e[r].toArray(i,a)}return i}function _4(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function A4(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function C4(e,t){let n=b4[t];void 0===n&&(n=new Int32Array(t),b4[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function M4(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function k4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(_4(n,t))return;e.uniform2fv(this.addr,t),A4(n,t)}}function E4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(_4(n,t))return;e.uniform3fv(this.addr,t),A4(n,t)}}function T4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(_4(n,t))return;e.uniform4fv(this.addr,t),A4(n,t)}}function P4(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(_4(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),A4(n,t)}else{if(_4(n,r))return;S4.set(r),e.uniformMatrix2fv(this.addr,!1,S4),A4(n,r)}}function D4(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(_4(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),A4(n,t)}else{if(_4(n,r))return;N4.set(r),e.uniformMatrix3fv(this.addr,!1,N4),A4(n,r)}}function R4(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(_4(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),A4(n,t)}else{if(_4(n,r))return;w4.set(r),e.uniformMatrix4fv(this.addr,!1,w4),A4(n,r)}}function I4(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function O4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(_4(n,t))return;e.uniform2iv(this.addr,t),A4(n,t)}}function B4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(_4(n,t))return;e.uniform3iv(this.addr,t),A4(n,t)}}function L4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(_4(n,t))return;e.uniform4iv(this.addr,t),A4(n,t)}}function F4(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function U4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(_4(n,t))return;e.uniform2uiv(this.addr,t),A4(n,t)}}function z4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(_4(n,t))return;e.uniform3uiv(this.addr,t),A4(n,t)}}function H4(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(_4(n,t))return;e.uniform4uiv(this.addr,t),A4(n,t)}}function G4(e,t,n){const r=this.cache,a=n.allocateTextureUnit();let i;r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),this.type===e.SAMPLER_2D_SHADOW?(g4.compareFunction=515,i=g4):i=m4,n.setTexture2D(t||i,a)}function V4(e,t,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture3D(t||x4,a)}function $4(e,t,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTextureCube(t||y4,a)}function W4(e,t,n){const r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture2DArray(t||f4,a)}function Y4(e,t){e.uniform1fv(this.addr,t)}function X4(e,t){const n=j4(t,this.size,2);e.uniform2fv(this.addr,n)}function K4(e,t){const n=j4(t,this.size,3);e.uniform3fv(this.addr,n)}function q4(e,t){const n=j4(t,this.size,4);e.uniform4fv(this.addr,n)}function J4(e,t){const n=j4(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Q4(e,t){const n=j4(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Z4(e,t){const n=j4(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function e5(e,t){e.uniform1iv(this.addr,t)}function t5(e,t){e.uniform2iv(this.addr,t)}function n5(e,t){e.uniform3iv(this.addr,t)}function r5(e,t){e.uniform4iv(this.addr,t)}function a5(e,t){e.uniform1uiv(this.addr,t)}function i5(e,t){e.uniform2uiv(this.addr,t)}function s5(e,t){e.uniform3uiv(this.addr,t)}function o5(e,t){e.uniform4uiv(this.addr,t)}function l5(e,t,n){const r=this.cache,a=t.length,i=C4(n,a);_4(r,i)||(e.uniform1iv(this.addr,i),A4(r,i));for(let s=0;s!==a;++s)n.setTexture2D(t[s]||m4,i[s])}function c5(e,t,n){const r=this.cache,a=t.length,i=C4(n,a);_4(r,i)||(e.uniform1iv(this.addr,i),A4(r,i));for(let s=0;s!==a;++s)n.setTexture3D(t[s]||x4,i[s])}function d5(e,t,n){const r=this.cache,a=t.length,i=C4(n,a);_4(r,i)||(e.uniform1iv(this.addr,i),A4(r,i));for(let s=0;s!==a;++s)n.setTextureCube(t[s]||y4,i[s])}function u5(e,t,n){const r=this.cache,a=t.length,i=C4(n,a);_4(r,i)||(e.uniform1iv(this.addr,i),A4(r,i));for(let s=0;s!==a;++s)n.setTexture2DArray(t[s]||f4,i[s])}class h5{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return M4;case 35664:return k4;case 35665:return E4;case 35666:return T4;case 35674:return P4;case 35675:return D4;case 35676:return R4;case 5124:case 35670:return I4;case 35667:case 35671:return O4;case 35668:case 35672:return B4;case 35669:case 35673:return L4;case 5125:return F4;case 36294:return U4;case 36295:return z4;case 36296:return H4;case 35678:case 36198:case 36298:case 36306:case 35682:return G4;case 35679:case 36299:case 36307:return V4;case 35680:case 36300:case 36308:case 36293:return $4;case 36289:case 36303:case 36311:case 36292:return W4}}(t.type)}}class p5{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Y4;case 35664:return X4;case 35665:return K4;case 35666:return q4;case 35674:return J4;case 35675:return Q4;case 35676:return Z4;case 5124:case 35670:return e5;case 35667:case 35671:return t5;case 35668:case 35672:return n5;case 35669:case 35673:return r5;case 5125:return a5;case 36294:return i5;case 36295:return s5;case 36296:return o5;case 35678:case 36198:case 36298:case 36306:case 35682:return l5;case 35679:case 36299:case 36307:return c5;case 35680:case 36300:case 36308:case 36293:return d5;case 36289:case 36303:case 36311:case 36292:return u5}}(t.type)}}class m5{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let a=0,i=r.length;a!==i;++a){const i=r[a];i.setValue(e,t[i.id],n)}}}const g5=/(\w+)(\])?(\[|\.)?/g;function f5(e,t){e.seq.push(t),e.map[t.id]=t}function x5(e,t,n){const r=e.name,a=r.length;for(g5.lastIndex=0;;){const i=g5.exec(r),s=g5.lastIndex;let o=i[1];const l="]"===i[2],c=i[3];if(l&&(o|=0),void 0===c||"["===c&&s+2===a){f5(n,void 0===c?new h5(o,e,t):new p5(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new m5(o),f5(n,e)),n=e}}}class y5{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);x5(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const a=this.map[t];void 0!==a&&a.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let a=0,i=t.length;a!==i;++a){const i=t[a],s=n[i.id];!1!==s.needsUpdate&&i.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,a=e.length;r!==a;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function v5(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let b5=0;const w5=new KX;function N5(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),a=(e.getShaderInfoLog(t)||"").trim();if(r&&""===a)return"";const i=/ERROR: 0:(\d+)/.exec(a);if(i){const r=parseInt(i[1]);return n.toUpperCase()+"\n\n"+a+"\n\n"+function(e,t){const n=e.split("\n"),r=[],a=Math.max(t-6,0),i=Math.min(t+6,n.length);for(let s=a;s<i;s++){const e=s+1;r.push(`${e===t?">":" "} ${e}: ${n[s]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return a}function S5(e,t){const n=function(e){eK._getMatrix(w5,eK.workingColorSpace,e);const t=`mat3( ${w5.elements.map(e=>e.toFixed(4))} )`;switch(eK.getTransfer(e)){case sX:return[t,"LinearTransferOETF"];case oX:return[t,"sRGBTransferOETF"];default:return kX("WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function j5(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom";break;default:kX("WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const _5=new WX;function A5(){eK.getLuminanceCoefficients(_5);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${_5.x.toFixed(4)}, ${_5.y.toFixed(4)}, ${_5.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function C5(e){return""!==e}function M5(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function k5(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const E5=/^[ \t]*#include +<([\w\d./]+)>/gm;function T5(e){return e.replace(E5,D5)}const P5=new Map;function D5(e,t){let n=R3[t];if(void 0===n){const e=P5.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=R3[e],kX('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return T5(n)}const R5=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function I5(e){return e.replace(R5,O5)}function O5(e,t,n,r){let a="";for(let i=parseInt(t);i<parseInt(n);i++)a+=r.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return a}function B5(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function L5(e,t,n,r){const a=e.getContext(),i=n.defines;let s=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case DW:case RW:t="ENVMAP_TYPE_CUBE";break;case BW:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===RW&&(t="ENVMAP_MODE_REFRACTION");return t}(n),u=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),h=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),p=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(C5).join("\n")}(n),m=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(i),g=a.createProgram();let f,x,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(f=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(C5).join("\n"),f.length>0&&(f+="\n"),x=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(C5).join("\n"),x.length>0&&(x+="\n")):(f=[B5(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(C5).join("\n"),x=[B5(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",n.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?R3.tonemapping_pars_fragment:"",0!==n.toneMapping?j5("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",R3.colorspace_pars_fragment,S5("linearToOutputTexel",n.outputColorSpace),A5(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(C5).join("\n")),s=T5(s),s=M5(s,n),s=k5(s,n),o=T5(o),o=M5(o,n),o=k5(o,n),s=I5(s),o=I5(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",f=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+f,x=["#define varying in",n.glslVersion===yX?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===yX?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x);const v=y+f+s,b=y+x+o,w=v5(a,a.VERTEX_SHADER,v),N=v5(a,a.FRAGMENT_SHADER,b);function S(t){if(e.debug.checkShaderErrors){const n=a.getProgramInfoLog(g)||"",r=a.getShaderInfoLog(w)||"",i=a.getShaderInfoLog(N)||"",s=n.trim(),o=r.trim(),l=i.trim();let c=!0,d=!0;if(!1===a.getProgramParameter(g,a.LINK_STATUS))if(c=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(a,g,w,N);else{const e=N5(a,w,"vertex"),n=N5(a,N,"fragment");EX("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(g,a.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+s+"\n"+e+"\n"+n)}else""!==s?kX("WebGLProgram: Program Info Log:",s):""!==o&&""!==l||(d=!1);d&&(t.diagnostics={runnable:c,programLog:s,vertexShader:{log:o,prefix:f},fragmentShader:{log:l,prefix:x}})}a.deleteShader(w),a.deleteShader(N),j=new y5(a,g),_=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let a=0;a<r;a++){const r=e.getActiveAttrib(t,a),i=r.name;let s=1;r.type===e.FLOAT_MAT2&&(s=2),r.type===e.FLOAT_MAT3&&(s=3),r.type===e.FLOAT_MAT4&&(s=4),n[i]={type:r.type,location:e.getAttribLocation(t,i),locationSize:s}}return n}(a,g)}let j,_;a.attachShader(g,w),a.attachShader(g,N),void 0!==n.index0AttributeName?a.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&a.bindAttribLocation(g,0,"position"),a.linkProgram(g),this.getUniforms=function(){return void 0===j&&S(this),j},this.getAttributes=function(){return void 0===_&&S(this),_};let A=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===A&&(A=a.getProgramParameter(g,37297)),A},this.destroy=function(){r.releaseStatesOfProgram(this),a.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=b5++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=N,this}let F5=0;class U5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),a=this._getShaderStage(n),i=this._getShaderCacheForMaterial(e);return!1===i.has(r)&&(i.add(r),r.usedTimes++),!1===i.has(a)&&(i.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new z5(e),t.set(e,n)),n}}class z5{constructor(e){this.id=F5++,this.code=e,this.usedTimes=0}}function H5(e,t,n,r,a,i,s){const o=new eq,l=new U5,c=new Set,d=[],u=a.logarithmicDepthBuffer,h=a.vertexTextures;let p=a.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(e){return c.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(i,o,d,f,x){const y=f.fog,v=x.geometry,b=i.isMeshStandardMaterial?f.environment:null,w=(i.isMeshStandardMaterial?n:t).get(i.envMap||b),N=w&&w.mapping===BW?w.image.height:null,S=m[i.type];null!==i.precision&&(p=a.getMaxPrecision(i.precision),p!==i.precision&&kX("WebGLProgram.getParameters:",i.precision,"not supported, using",p,"instead."));const j=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,_=void 0!==j?j.length:0;let A,C,M,k,E=0;if(void 0!==v.morphAttributes.position&&(E=1),void 0!==v.morphAttributes.normal&&(E=2),void 0!==v.morphAttributes.color&&(E=3),S){const e=O3[S];A=e.vertexShader,C=e.fragmentShader}else A=i.vertexShader,C=i.fragmentShader,l.update(i),M=l.getVertexShaderID(i),k=l.getFragmentShaderID(i);const T=e.getRenderTarget(),P=e.state.buffers.depth.getReversed(),D=!0===x.isInstancedMesh,R=!0===x.isBatchedMesh,I=!!i.map,O=!!i.matcap,B=!!w,L=!!i.aoMap,F=!!i.lightMap,U=!!i.bumpMap,z=!!i.normalMap,H=!!i.displacementMap,G=!!i.emissiveMap,V=!!i.metalnessMap,$=!!i.roughnessMap,W=i.anisotropy>0,Y=i.clearcoat>0,X=i.dispersion>0,K=i.iridescence>0,q=i.sheen>0,J=i.transmission>0,Q=W&&!!i.anisotropyMap,Z=Y&&!!i.clearcoatMap,ee=Y&&!!i.clearcoatNormalMap,te=Y&&!!i.clearcoatRoughnessMap,ne=K&&!!i.iridescenceMap,re=K&&!!i.iridescenceThicknessMap,ae=q&&!!i.sheenColorMap,ie=q&&!!i.sheenRoughnessMap,se=!!i.specularMap,oe=!!i.specularColorMap,le=!!i.specularIntensityMap,ce=J&&!!i.transmissionMap,de=J&&!!i.thicknessMap,ue=!!i.gradientMap,he=!!i.alphaMap,pe=i.alphaTest>0,me=!!i.alphaHash,ge=!!i.extensions;let fe=0;i.toneMapped&&(null!==T&&!0!==T.isXRRenderTarget||(fe=e.toneMapping));const xe={shaderID:S,shaderType:i.type,shaderName:i.name,vertexShader:A,fragmentShader:C,defines:i.defines,customVertexShaderID:M,customFragmentShaderID:k,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:p,batching:R,batchingColor:R&&null!==x._colorsTexture,instancing:D,instancingColor:D&&null!==x.instanceColor,instancingMorph:D&&null!==x.morphTexture,supportsVertexTextures:h,outputColorSpace:null===T?e.outputColorSpace:!0===T.isXRRenderTarget?T.texture.colorSpace:iX,alphaToCoverage:!!i.alphaToCoverage,map:I,matcap:O,envMap:B,envMapMode:B&&w.mapping,envMapCubeUVHeight:N,aoMap:L,lightMap:F,bumpMap:U,normalMap:z,displacementMap:h&&H,emissiveMap:G,normalMapObjectSpace:z&&1===i.normalMapType,normalMapTangentSpace:z&&0===i.normalMapType,metalnessMap:V,roughnessMap:$,anisotropy:W,anisotropyMap:Q,clearcoat:Y,clearcoatMap:Z,clearcoatNormalMap:ee,clearcoatRoughnessMap:te,dispersion:X,iridescence:K,iridescenceMap:ne,iridescenceThicknessMap:re,sheen:q,sheenColorMap:ae,sheenRoughnessMap:ie,specularMap:se,specularColorMap:oe,specularIntensityMap:le,transmission:J,transmissionMap:ce,thicknessMap:de,gradientMap:ue,opaque:!1===i.transparent&&1===i.blending&&!1===i.alphaToCoverage,alphaMap:he,alphaTest:pe,alphaHash:me,combine:i.combine,mapUv:I&&g(i.map.channel),aoMapUv:L&&g(i.aoMap.channel),lightMapUv:F&&g(i.lightMap.channel),bumpMapUv:U&&g(i.bumpMap.channel),normalMapUv:z&&g(i.normalMap.channel),displacementMapUv:H&&g(i.displacementMap.channel),emissiveMapUv:G&&g(i.emissiveMap.channel),metalnessMapUv:V&&g(i.metalnessMap.channel),roughnessMapUv:$&&g(i.roughnessMap.channel),anisotropyMapUv:Q&&g(i.anisotropyMap.channel),clearcoatMapUv:Z&&g(i.clearcoatMap.channel),clearcoatNormalMapUv:ee&&g(i.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:te&&g(i.clearcoatRoughnessMap.channel),iridescenceMapUv:ne&&g(i.iridescenceMap.channel),iridescenceThicknessMapUv:re&&g(i.iridescenceThicknessMap.channel),sheenColorMapUv:ae&&g(i.sheenColorMap.channel),sheenRoughnessMapUv:ie&&g(i.sheenRoughnessMap.channel),specularMapUv:se&&g(i.specularMap.channel),specularColorMapUv:oe&&g(i.specularColorMap.channel),specularIntensityMapUv:le&&g(i.specularIntensityMap.channel),transmissionMapUv:ce&&g(i.transmissionMap.channel),thicknessMapUv:de&&g(i.thicknessMap.channel),alphaMapUv:he&&g(i.alphaMap.channel),vertexTangents:!!v.attributes.tangent&&(z||W),vertexColors:i.vertexColors,vertexAlphas:!0===i.vertexColors&&!!v.attributes.color&&4===v.attributes.color.itemSize,pointsUvs:!0===x.isPoints&&!!v.attributes.uv&&(I||he),fog:!!y,useFog:!0===i.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===i.flatShading&&!1===i.wireframe,sizeAttenuation:!0===i.sizeAttenuation,logarithmicDepthBuffer:u,reversedDepthBuffer:P,skinning:!0===x.isSkinnedMesh,morphTargets:void 0!==v.morphAttributes.position,morphNormals:void 0!==v.morphAttributes.normal,morphColors:void 0!==v.morphAttributes.color,morphTargetsCount:_,morphTextureStride:E,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:fe,decodeVideoTexture:I&&!0===i.map.isVideoTexture&&eK.getTransfer(i.map.colorSpace)===oX,decodeVideoTextureEmissive:G&&!0===i.emissiveMap.isVideoTexture&&eK.getTransfer(i.emissiveMap.colorSpace)===oX,premultipliedAlpha:i.premultipliedAlpha,doubleSided:2===i.side,flipSided:i.side===nW,useDepthPacking:i.depthPacking>=0,depthPacking:i.depthPacking||0,index0AttributeName:i.index0AttributeName,extensionClipCullDistance:ge&&!0===i.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ge&&!0===i.extensions.multiDraw||R)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:i.customProgramCacheKey()};return xe.vertexUv1s=c.has(1),xe.vertexUv2s=c.has(2),xe.vertexUv3s=c.has(3),c.clear(),xe},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.supportsVertexTextures&&o.enable(0);t.instancing&&o.enable(1);t.instancingColor&&o.enable(2);t.instancingMorph&&o.enable(3);t.matcap&&o.enable(4);t.envMap&&o.enable(5);t.normalMapObjectSpace&&o.enable(6);t.normalMapTangentSpace&&o.enable(7);t.clearcoat&&o.enable(8);t.iridescence&&o.enable(9);t.alphaTest&&o.enable(10);t.vertexColors&&o.enable(11);t.vertexAlphas&&o.enable(12);t.vertexUv1s&&o.enable(13);t.vertexUv2s&&o.enable(14);t.vertexUv3s&&o.enable(15);t.vertexTangents&&o.enable(16);t.anisotropy&&o.enable(17);t.alphaHash&&o.enable(18);t.batching&&o.enable(19);t.dispersion&&o.enable(20);t.batchingColor&&o.enable(21);t.gradientMap&&o.enable(22);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.reversedDepthBuffer&&o.enable(4);t.skinning&&o.enable(5);t.morphTargets&&o.enable(6);t.morphNormals&&o.enable(7);t.morphColors&&o.enable(8);t.premultipliedAlpha&&o.enable(9);t.shadowMapEnabled&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);t.decodeVideoTexture&&o.enable(19);t.decodeVideoTextureEmissive&&o.enable(20);t.alphaToCoverage&&o.enable(21);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=m[e.type];let n;if(t){const e=O3[t];n=SJ.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,a=d.length;e<a;e++){const t=d[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new L5(e,n,t,i),d.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=d.indexOf(e);d[t]=d[d.length-1],d.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:d,dispose:function(){l.dispose()}}}function G5(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function V5(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function $5(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function W5(){const e=[];let t=0;const n=[],r=[],a=[];function i(n,r,a,i,s,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:a,groupOrder:i,renderOrder:n.renderOrder,z:s,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=a,l.groupOrder=i,l.renderOrder=n.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:n,transmissive:r,transparent:a,init:function(){t=0,n.length=0,r.length=0,a.length=0},push:function(e,t,s,o,l,c){const d=i(e,t,s,o,l,c);s.transmission>0?r.push(d):!0===s.transparent?a.push(d):n.push(d)},unshift:function(e,t,s,o,l,c){const d=i(e,t,s,o,l,c);s.transmission>0?r.unshift(d):!0===s.transparent?a.unshift(d):n.unshift(d)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||V5),r.length>1&&r.sort(t||$5),a.length>1&&a.sort(t||$5)}}}function Y5(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let a;return void 0===r?(a=new W5,e.set(t,[a])):n>=r.length?(a=new W5,r.push(a)):a=r[n],a},dispose:function(){e=new WeakMap}}}function X5(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new WX,color:new Iq};break;case"SpotLight":n={position:new WX,direction:new WX,color:new Iq,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new WX,color:new Iq,distance:0,decay:0};break;case"HemisphereLight":n={direction:new WX,skyColor:new Iq,groundColor:new Iq};break;case"RectAreaLight":n={color:new Iq,position:new WX,halfWidth:new WX,halfHeight:new WX}}return e[t.id]=n,n}}}let K5=0;function q5(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function J5(e){const t=new X5,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new VX};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new VX,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)r.probe.push(new WX);const a=new WX,i=new GK,s=new GK;return{setup:function(a){let i=0,s=0,o=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let l=0,c=0,d=0,u=0,h=0,p=0,m=0,g=0,f=0,x=0,y=0;a.sort(q5);for(let e=0,b=a.length;e<b;e++){const v=a[e],b=v.color,w=v.intensity,N=v.distance,S=v.shadow&&v.shadow.map?v.shadow.map.texture:null;if(v.isAmbientLight)i+=b.r*w,s+=b.g*w,o+=b.b*w;else if(v.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(v.sh.coefficients[e],w);y++}else if(v.isDirectionalLight){const e=t.get(v);if(e.color.copy(v.color).multiplyScalar(v.intensity),v.castShadow){const e=v.shadow,t=n.get(v);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[l]=t,r.directionalShadowMap[l]=S,r.directionalShadowMatrix[l]=v.shadow.matrix,p++}r.directional[l]=e,l++}else if(v.isSpotLight){const e=t.get(v);e.position.setFromMatrixPosition(v.matrixWorld),e.color.copy(b).multiplyScalar(w),e.distance=N,e.coneCos=Math.cos(v.angle),e.penumbraCos=Math.cos(v.angle*(1-v.penumbra)),e.decay=v.decay,r.spot[d]=e;const a=v.shadow;if(v.map&&(r.spotLightMap[f]=v.map,f++,a.updateMatrices(v),v.castShadow&&x++),r.spotLightMatrix[d]=a.matrix,v.castShadow){const e=n.get(v);e.shadowIntensity=a.intensity,e.shadowBias=a.bias,e.shadowNormalBias=a.normalBias,e.shadowRadius=a.radius,e.shadowMapSize=a.mapSize,r.spotShadow[d]=e,r.spotShadowMap[d]=S,g++}d++}else if(v.isRectAreaLight){const e=t.get(v);e.color.copy(b).multiplyScalar(w),e.halfWidth.set(.5*v.width,0,0),e.halfHeight.set(0,.5*v.height,0),r.rectArea[u]=e,u++}else if(v.isPointLight){const e=t.get(v);if(e.color.copy(v.color).multiplyScalar(v.intensity),e.distance=v.distance,e.decay=v.decay,v.castShadow){const e=v.shadow,t=n.get(v);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[c]=t,r.pointShadowMap[c]=S,r.pointShadowMatrix[c]=v.shadow.matrix,m++}r.point[c]=e,c++}else if(v.isHemisphereLight){const e=t.get(v);e.skyColor.copy(v.color).multiplyScalar(w),e.groundColor.copy(v.groundColor).multiplyScalar(w),r.hemi[h]=e,h++}}u>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=I3.LTC_FLOAT_1,r.rectAreaLTC2=I3.LTC_FLOAT_2):(r.rectAreaLTC1=I3.LTC_HALF_1,r.rectAreaLTC2=I3.LTC_HALF_2)),r.ambient[0]=i,r.ambient[1]=s,r.ambient[2]=o;const v=r.hash;v.directionalLength===l&&v.pointLength===c&&v.spotLength===d&&v.rectAreaLength===u&&v.hemiLength===h&&v.numDirectionalShadows===p&&v.numPointShadows===m&&v.numSpotShadows===g&&v.numSpotMaps===f&&v.numLightProbes===y||(r.directional.length=l,r.spot.length=d,r.rectArea.length=u,r.point.length=c,r.hemi.length=h,r.directionalShadow.length=p,r.directionalShadowMap.length=p,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=p,r.pointShadowMatrix.length=m,r.spotLightMatrix.length=g+f-x,r.spotLightMap.length=f,r.numSpotLightShadowsWithMaps=x,r.numLightProbes=y,v.directionalLength=l,v.pointLength=c,v.spotLength=d,v.rectAreaLength=u,v.hemiLength=h,v.numDirectionalShadows=p,v.numPointShadows=m,v.numSpotShadows=g,v.numSpotMaps=f,v.numLightProbes=y,r.version=K5++)},setupView:function(e,t){let n=0,o=0,l=0,c=0,d=0;const u=t.matrixWorldInverse;for(let h=0,p=e.length;h<p;h++){const t=e[h];if(t.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(u),n++}else if(t.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(u),l++}else if(t.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),s.identity(),i.copy(t.matrixWorld),i.premultiply(u),s.extractRotation(i),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(t.isPointLight){const e=r.point[o];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),o++}else if(t.isHemisphereLight){const e=r.hemi[d];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(u),d++}}},state:r}}function Q5(e){const t=new J5(e),n=[],r=[];const a={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){a.camera=e,n.length=0,r.length=0},state:a,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function Z5(e){let t=new WeakMap;return{get:function(n,r=0){const a=t.get(n);let i;return void 0===a?(i=new Q5(e),t.set(n,[i])):r>=a.length?(i=new Q5(e),a.push(i)):i=a[r],i},dispose:function(){t=new WeakMap}}}function e6(e,t,n){let r=new FQ;const a=new VX,i=new VX,s=new uK,o=new p1({depthPacking:3201}),l=new m1,c={},d=n.maxTextureSize,u={[tW]:nW,[nW]:0,[rW]:2},h=new jJ({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new VX},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const m=new iJ;m.setAttribute("position",new Xq(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new xJ(m,h),f=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let x=this.type;function y(n,r){const i=t.update(g);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new pK(a.x,a.y)),h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,g,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,g,null)}function v(t,n,r,a){let i=null;const s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)i=s;else if(i=!0===r.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=i.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let a=r[t];void 0===a&&(a=i.clone(),r[t]=a,n.addEventListener("dispose",w)),i=a}if(i.visible=n.visible,i.wireframe=n.wireframe,i.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],i.alphaMap=n.alphaMap,i.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,i.map=n.map,i.clipShadows=n.clipShadows,i.clippingPlanes=n.clippingPlanes,i.clipIntersection=n.clipIntersection,i.displacementMap=n.displacementMap,i.displacementScale=n.displacementScale,i.displacementBias=n.displacementBias,i.wireframeLinewidth=n.wireframeLinewidth,i.linewidth=n.linewidth,!0===r.isPointLight&&!0===i.isMeshDistanceMaterial){e.properties.get(i).light=r}return i}function b(n,a,i,s,o){if(!1===n.visible)return;if(n.layers.test(a.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld);const r=t.update(n),l=n.material;if(Array.isArray(l)){const t=r.groups;for(let c=0,d=t.length;c<d;c++){const d=t[c],u=l[d.materialIndex];if(u&&u.visible){const t=v(n,u,s,o);n.onBeforeShadow(e,n,a,i,r,t,d),e.renderBufferDirect(i,null,r,t,n,d),n.onAfterShadow(e,n,a,i,r,t,d)}}}else if(l.visible){const t=v(n,l,s,o);n.onBeforeShadow(e,n,a,i,r,t,null),e.renderBufferDirect(i,null,r,t,n,null),n.onAfterShadow(e,n,a,i,r,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],a,i,s,o)}function w(e){e.target.removeEventListener("dispose",w);for(const t in c){const n=c[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,o){if(!1===f.enabled)return;if(!1===f.autoUpdate&&!1===f.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),!0===h.buffers.depth.getReversed()?h.buffers.color.setClear(0,0,0,0):h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const p=3!==x&&3===this.type,m=3===x&&3!==this.type;for(let g=0,f=t.length;g<f;g++){const l=t[g],c=l.shadow;if(void 0===c){kX("WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;a.copy(c.mapSize);const u=c.getFrameExtents();if(a.multiply(u),i.copy(c.mapSize),(a.x>d||a.y>d)&&(a.x>d&&(i.x=Math.floor(d/u.x),a.x=i.x*u.x,c.mapSize.x=i.x),a.y>d&&(i.y=Math.floor(d/u.y),a.y=i.y*u.y,c.mapSize.y=i.y)),null===c.map||!0===p||!0===m){const e=3!==this.type?{minFilter:zW,magFilter:zW}:{};null!==c.map&&c.map.dispose(),c.map=new pK(a.x,a.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const f=c.getViewportCount();for(let e=0;e<f;e++){const t=c.getViewport(e);s.set(i.x*t.x,i.y*t.y,i.x*t.z,i.y*t.w),h.viewport(s),c.updateMatrices(l,e),r=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&y(c,o),c.needsUpdate=!1}x=this.type,f.needsUpdate=!1,e.setRenderTarget(l,c,u)}}const t6={[NW]:1,[jW]:6,[AW]:7,[_W]:5,[SW]:0,[MW]:2,[kW]:4,[CW]:3};function n6(e,t){const n=new function(){let t=!1;const n=new uK;let r=null;const a=new uK(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,i,s,o){!0===o&&(t*=s,r*=s,i*=s),n.set(t,r,i,s),!1===a.equals(n)&&(e.clearColor(t,r,i,s),a.copy(n))},reset:function(){t=!1,r=null,a.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,a=null,i=null,s=null;return{setReversed:function(e){if(r!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=e;const a=s;s=null,this.setClear(a)}},getReversed:function(){return r},setTest:function(t){t?U(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(t){a===t||n||(e.depthMask(t),a=t)},setFunc:function(t){if(r&&(t=t6[t]),i!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}i=t}},setLocked:function(e){n=e},setClear:function(t){s!==t&&(r&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){n=!1,a=null,i=null,s=null,r=!1}}},a=new function(){let t=!1,n=null,r=null,a=null,i=null,s=null,o=null,l=null,c=null;return{setTest:function(n){t||(n?U(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&a===n&&i===s||(e.stencilFunc(t,n,s),r=t,a=n,i=s)},setOp:function(t,n,r){s===t&&o===n&&l===r||(e.stencilOp(t,n,r),s=t,o=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,a=null,i=null,s=null,o=null,l=null,c=null}}},i=new WeakMap,s=new WeakMap;let o={},l={},c=new WeakMap,d=[],u=null,h=!1,p=null,m=null,g=null,f=null,x=null,y=null,v=null,b=new Iq(0,0,0),w=0,N=!1,S=null,j=null,_=null,A=null,C=null;const M=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let k=!1,E=0;const T=e.getParameter(e.VERSION);-1!==T.indexOf("WebGL")?(E=parseFloat(/^WebGL (\d)/.exec(T)[1]),k=E>=1):-1!==T.indexOf("OpenGL ES")&&(E=parseFloat(/^OpenGL ES (\d)/.exec(T)[1]),k=E>=2);let P=null,D={};const R=e.getParameter(e.SCISSOR_BOX),I=e.getParameter(e.VIEWPORT),O=(new uK).fromArray(R),B=(new uK).fromArray(I);function L(t,n,r,a){const i=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,a,0,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return s}const F={};function U(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function z(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}F[e.TEXTURE_2D]=L(e.TEXTURE_2D,e.TEXTURE_2D,1),F[e.TEXTURE_CUBE_MAP]=L(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),F[e.TEXTURE_2D_ARRAY]=L(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),F[e.TEXTURE_3D]=L(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),a.setClear(0),U(e.DEPTH_TEST),r.setFunc(3),$(!1),W(1),U(e.CULL_FACE),V(0);const H={[aW]:e.FUNC_ADD,[iW]:e.FUNC_SUBTRACT,[sW]:e.FUNC_REVERSE_SUBTRACT};H[103]=e.MIN,H[104]=e.MAX;const G={[oW]:e.ZERO,[lW]:e.ONE,[cW]:e.SRC_COLOR,[uW]:e.SRC_ALPHA,[xW]:e.SRC_ALPHA_SATURATE,[gW]:e.DST_COLOR,[pW]:e.DST_ALPHA,[dW]:e.ONE_MINUS_SRC_COLOR,[hW]:e.ONE_MINUS_SRC_ALPHA,[fW]:e.ONE_MINUS_DST_COLOR,[mW]:e.ONE_MINUS_DST_ALPHA,[yW]:e.CONSTANT_COLOR,[vW]:e.ONE_MINUS_CONSTANT_COLOR,[bW]:e.CONSTANT_ALPHA,[wW]:e.ONE_MINUS_CONSTANT_ALPHA};function V(t,n,r,a,i,s,o,l,c,d){if(0!==t){if(!1===h&&(U(e.BLEND),h=!0),5===t)i=i||n,s=s||r,o=o||a,n===m&&i===x||(e.blendEquationSeparate(H[n],H[i]),m=n,x=i),r===g&&a===f&&s===y&&o===v||(e.blendFuncSeparate(G[r],G[a],G[s],G[o]),g=r,f=a,y=s,v=o),!1!==l.equals(b)&&c===w||(e.blendColor(l.r,l.g,l.b,c),b.copy(l),w=c),p=t,N=!1;else if(t!==p||d!==N){if(m===aW&&x===aW||(e.blendEquation(e.FUNC_ADD),m=aW,x=aW),d)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:EX("WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 3:EX("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:EX("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:EX("WebGLState: Invalid blending: ",t)}g=null,f=null,y=null,v=null,b.set(0,0,0),w=0,p=t,N=d}}else!0===h&&(z(e.BLEND),h=!1)}function $(t){S!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),S=t)}function W(t){0!==t?(U(e.CULL_FACE),t!==j&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),j=t}function Y(t,n,r){t?(U(e.POLYGON_OFFSET_FILL),A===n&&C===r||(e.polygonOffset(n,r),A=n,C=r)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:a},enable:U,disable:z,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=d,a=!1;if(t){r=c.get(n),void 0===r&&(r=[],c.set(n,r));const i=t.textures;if(r.length!==i.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=i.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=i.length,a=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,a=!0);a&&e.drawBuffers(r)},useProgram:function(t){return u!==t&&(e.useProgram(t),u=t,!0)},setBlending:V,setMaterial:function(t,i){2===t.side?z(e.CULL_FACE):U(e.CULL_FACE);let s=t.side===nW;i&&(s=!s),$(s),1===t.blending&&!1===t.transparent?V(0):V(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite);const o=t.stencilWrite;a.setTest(o),o&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?U(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:$,setCullFace:W,setLineWidth:function(t){t!==_&&(k&&e.lineWidth(t),_=t)},setPolygonOffset:Y,setScissorTest:function(t){t?U(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+M-1),P!==t&&(e.activeTexture(t),P=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===P?e.TEXTURE0+M-1:P);let a=D[r];void 0===a&&(a={type:void 0,texture:void 0},D[r]=a),a.type===t&&a.texture===n||(P!==r&&(e.activeTexture(r),P=r),e.bindTexture(t,n||F[t]),a.type=t,a.texture=n)},unbindTexture:function(){const t=D[P];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(t){t("WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(t){t("WebGLState:",t)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(t){t("WebGLState:",t)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(t){t("WebGLState:",t)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let a=r.get(t);void 0===a&&(a=e.getUniformBlockIndex(n,t.name),r.set(t,a))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);i.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),i.set(n,r))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(t){t("WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(t){t("WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(t){t("WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(t){t("WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(t){t("WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(t){t("WebGLState:",t)}},scissor:function(t){!1===O.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),O.copy(t))},viewport:function(t){!1===B.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),B.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),r.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},P=null,D={},l={},c=new WeakMap,d=[],u=null,h=!1,p=null,m=null,g=null,f=null,x=null,y=null,v=null,b=new Iq(0,0,0),w=0,N=!1,S=null,j=null,_=null,A=null,C=null,O.set(0,0,e.canvas.width,e.canvas.height),B.set(0,0,e.canvas.width,e.canvas.height),n.reset(),r.reset(),a.reset()}}}function r6(e,t,n,r,a,i,s){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new VX,d=new WeakMap;let u;const h=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(V){}function m(e,t){return p?new OffscreenCanvas(e,t):jX("canvas")}function g(e,t,n){let r=1;const a=G(e);if((a.width>n||a.height>n)&&(r=n/Math.max(a.width,a.height)),r<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*a.width),i=Math.floor(r*a.height);void 0===u&&(u=m(n,i));const s=t?m(n,i):u;s.width=n,s.height=i;return s.getContext("2d").drawImage(e,0,0,n,i),kX("WebGLRenderer: Texture has been resized from ("+a.width+"x"+a.height+") to ("+n+"x"+i+")."),s}return"data"in e&&kX("WebGLRenderer: Image in DataTexture is too big ("+a.width+"x"+a.height+")."),e}return e}function f(e){return e.generateMipmaps}function x(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function v(n,r,a,i,s=!1){if(null!==n){if(void 0!==e[n])return e[n];kX("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=r;if(r===e.RED&&(a===e.FLOAT&&(o=e.R32F),a===e.HALF_FLOAT&&(o=e.R16F),a===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RED_INTEGER&&(a===e.UNSIGNED_BYTE&&(o=e.R8UI),a===e.UNSIGNED_SHORT&&(o=e.R16UI),a===e.UNSIGNED_INT&&(o=e.R32UI),a===e.BYTE&&(o=e.R8I),a===e.SHORT&&(o=e.R16I),a===e.INT&&(o=e.R32I)),r===e.RG&&(a===e.FLOAT&&(o=e.RG32F),a===e.HALF_FLOAT&&(o=e.RG16F),a===e.UNSIGNED_BYTE&&(o=e.RG8)),r===e.RG_INTEGER&&(a===e.UNSIGNED_BYTE&&(o=e.RG8UI),a===e.UNSIGNED_SHORT&&(o=e.RG16UI),a===e.UNSIGNED_INT&&(o=e.RG32UI),a===e.BYTE&&(o=e.RG8I),a===e.SHORT&&(o=e.RG16I),a===e.INT&&(o=e.RG32I)),r===e.RGB_INTEGER&&(a===e.UNSIGNED_BYTE&&(o=e.RGB8UI),a===e.UNSIGNED_SHORT&&(o=e.RGB16UI),a===e.UNSIGNED_INT&&(o=e.RGB32UI),a===e.BYTE&&(o=e.RGB8I),a===e.SHORT&&(o=e.RGB16I),a===e.INT&&(o=e.RGB32I)),r===e.RGBA_INTEGER&&(a===e.UNSIGNED_BYTE&&(o=e.RGBA8UI),a===e.UNSIGNED_SHORT&&(o=e.RGBA16UI),a===e.UNSIGNED_INT&&(o=e.RGBA32UI),a===e.BYTE&&(o=e.RGBA8I),a===e.SHORT&&(o=e.RGBA16I),a===e.INT&&(o=e.RGBA32I)),r===e.RGB&&(a===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),a===e.UNSIGNED_INT_10F_11F_11F_REV&&(o=e.R11F_G11F_B10F)),r===e.RGBA){const t=s?sX:eK.getTransfer(i);a===e.FLOAT&&(o=e.RGBA32F),a===e.HALF_FLOAT&&(o=e.RGBA16F),a===e.UNSIGNED_BYTE&&(o=t===oX?e.SRGB8_ALPHA8:e.RGBA8),a===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),a===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return o!==e.R16F&&o!==e.R32F&&o!==e.RG16F&&o!==e.RG32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function b(t,n){let r;return t?null===n||n===ZW||n===aY?r=e.DEPTH24_STENCIL8:n===eY?r=e.DEPTH32F_STENCIL8:n===JW&&(r=e.DEPTH24_STENCIL8,kX("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===ZW||n===aY?r=e.DEPTH_COMPONENT24:n===eY?r=e.DEPTH_COMPONENT32F:n===JW&&(r=e.DEPTH_COMPONENT16),r}function w(e,t){return!0===f(e)||e.isFramebufferTexture&&e.minFilter!==zW&&e.minFilter!==VW?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function N(e){const t=e.target;t.removeEventListener("dispose",N),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,a=h.get(n);if(a){const r=a[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&j(e),0===Object.keys(a).length&&h.delete(n)}r.remove(e)}(t),t.isVideoTexture&&d.delete(t)}function S(t){const n=t.target;n.removeEventListener("dispose",S),function(t){const n=r.get(t);t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++){if(Array.isArray(n.__webglFramebuffer[r]))for(let t=0;t<n.__webglFramebuffer[r].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[r][t]);else e.deleteFramebuffer(n.__webglFramebuffer[r]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[r])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const a=t.textures;for(let i=0,o=a.length;i<o;i++){const t=r.get(a[i]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),r.remove(a[i])}r.remove(t)}(n)}function j(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const a=t.source;delete h.get(a)[n.__cacheKey],s.memory.textures--}let _=0;function A(t,a){const i=r.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;d.get(e)!==t&&(d.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&i.__version!==t.version){const e=t.image;if(null===e)kX("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void D(i,t,a);kX("WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(i.__webglTexture=t.sourceTexture?t.sourceTexture:null);n.bindTexture(e.TEXTURE_2D,i.__webglTexture,e.TEXTURE0+a)}const C={[LW]:e.REPEAT,[FW]:e.CLAMP_TO_EDGE,[UW]:e.MIRRORED_REPEAT},M={[zW]:e.NEAREST,[HW]:e.NEAREST_MIPMAP_NEAREST,[GW]:e.NEAREST_MIPMAP_LINEAR,[VW]:e.LINEAR,[$W]:e.LINEAR_MIPMAP_NEAREST,[WW]:e.LINEAR_MIPMAP_LINEAR},k={[cX]:e.NEVER,[fX]:e.ALWAYS,[dX]:e.LESS,[hX]:e.LEQUAL,[uX]:e.EQUAL,[gX]:e.GEQUAL,[pX]:e.GREATER,[mX]:e.NOTEQUAL};function E(n,i){if(i.type!==eY||!1!==t.has("OES_texture_float_linear")||i.magFilter!==VW&&i.magFilter!==$W&&i.magFilter!==GW&&i.magFilter!==WW&&i.minFilter!==VW&&i.minFilter!==$W&&i.minFilter!==GW&&i.minFilter!==WW||kX("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,C[i.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,C[i.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,C[i.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,M[i.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,M[i.minFilter]),i.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,k[i.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(i.magFilter===zW)return;if(i.minFilter!==GW&&i.minFilter!==WW)return;if(i.type===eY&&!1===t.has("OES_texture_float_linear"))return;if(i.anisotropy>1||r.get(i).__currentAnisotropy){const s=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,a.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy}}}function T(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",N));const a=n.source;let i=h.get(a);void 0===i&&(i={},h.set(a,i));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===i[o]&&(i[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),i[o].usedTimes++;const a=i[t.__cacheKey];void 0!==a&&(i[t.__cacheKey].usedTimes--,0===a.usedTimes&&j(n)),t.__cacheKey=o,t.__webglTexture=i[o].texture}return r}function P(e,t,n){return Math.floor(Math.floor(e/n)/t)}function D(t,s,o){let l=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(l=e.TEXTURE_3D);const c=T(t,s),d=s.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const u=r.get(d);if(d.version!==u.__version||!0===c){n.activeTexture(e.TEXTURE0+o);const t=eK.getPrimaries(eK.workingColorSpace),r=s.colorSpace===rX?null:eK.getPrimaries(s.colorSpace),h=s.colorSpace===rX||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let p=g(s.image,!1,a.maxTextureSize);p=H(s,p);const m=i.convert(s.format,s.colorSpace),y=i.convert(s.type);let N,S=v(s.internalFormat,m,y,s.colorSpace,s.isVideoTexture);E(l,s);const j=s.mipmaps,_=!0!==s.isVideoTexture,A=void 0===u.__version||!0===c,C=d.dataReady,M=w(s,p);if(s.isDepthTexture)S=b(s.format===uY,s.type),A&&(_?n.texStorage2D(e.TEXTURE_2D,1,S,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,S,p.width,p.height,0,m,y,null));else if(s.isDataTexture)if(j.length>0){_&&A&&n.texStorage2D(e.TEXTURE_2D,M,S,j[0].width,j[0].height);for(let t=0,r=j.length;t<r;t++)N=j[t],_?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,N.width,N.height,m,y,N.data):n.texImage2D(e.TEXTURE_2D,t,S,N.width,N.height,0,m,y,N.data);s.generateMipmaps=!1}else _?(A&&n.texStorage2D(e.TEXTURE_2D,M,S,p.width,p.height),C&&function(t,r,a,i){const s=t.updateRanges;if(0===s.length)n.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,a,i,r.data);else{s.sort((e,t)=>e.start-t.start);let o=0;for(let e=1;e<s.length;e++){const t=s[o],n=s[e],a=t.start+t.count,i=P(n.start,r.width,4),l=P(t.start,r.width,4);n.start<=a+1&&i===l&&P(n.start+n.count-1,r.width,4)===i?t.count=Math.max(t.count,n.start+n.count-t.start):(++o,s[o]=n)}s.length=o+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),d=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,r.width);for(let t=0,u=s.length;t<u;t++){const o=s[t],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),d=l%r.width,u=Math.floor(l/r.width),h=c,p=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,d),e.pixelStorei(e.UNPACK_SKIP_ROWS,u),n.texSubImage2D(e.TEXTURE_2D,0,d,u,h,p,a,i,r.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,d)}}(s,p,m,y)):n.texImage2D(e.TEXTURE_2D,0,S,p.width,p.height,0,m,y,p.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){_&&A&&n.texStorage3D(e.TEXTURE_2D_ARRAY,M,S,j[0].width,j[0].height,p.depth);for(let t=0,r=j.length;t<r;t++)if(N=j[t],s.format!==cY)if(null!==m)if(_){if(C)if(s.layerUpdates.size>0){const r=T3(N.width,N.height,s.format,s.type);for(const a of s.layerUpdates){const i=N.data.subarray(a*r/N.data.BYTES_PER_ELEMENT,(a+1)*r/N.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,a,N.width,N.height,1,m,i)}s.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,N.width,N.height,p.depth,m,N.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,S,N.width,N.height,p.depth,0,N.data,0,0);else kX("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else _?C&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,N.width,N.height,p.depth,m,y,N.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,S,N.width,N.height,p.depth,0,m,y,N.data)}else{_&&A&&n.texStorage2D(e.TEXTURE_2D,M,S,j[0].width,j[0].height);for(let t=0,r=j.length;t<r;t++)N=j[t],s.format!==cY?null!==m?_?C&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,N.width,N.height,m,N.data):n.compressedTexImage2D(e.TEXTURE_2D,t,S,N.width,N.height,0,N.data):kX("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,N.width,N.height,m,y,N.data):n.texImage2D(e.TEXTURE_2D,t,S,N.width,N.height,0,m,y,N.data)}else if(s.isDataArrayTexture)if(_){if(A&&n.texStorage3D(e.TEXTURE_2D_ARRAY,M,S,p.width,p.height,p.depth),C)if(s.layerUpdates.size>0){const t=T3(p.width,p.height,s.format,s.type);for(const r of s.layerUpdates){const a=p.data.subarray(r*t/p.data.BYTES_PER_ELEMENT,(r+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,p.width,p.height,1,m,y,a)}s.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,m,y,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,S,p.width,p.height,p.depth,0,m,y,p.data);else if(s.isData3DTexture)_?(A&&n.texStorage3D(e.TEXTURE_3D,M,S,p.width,p.height,p.depth),C&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,m,y,p.data)):n.texImage3D(e.TEXTURE_3D,0,S,p.width,p.height,p.depth,0,m,y,p.data);else if(s.isFramebufferTexture){if(A)if(_)n.texStorage2D(e.TEXTURE_2D,M,S,p.width,p.height);else{let t=p.width,r=p.height;for(let a=0;a<M;a++)n.texImage2D(e.TEXTURE_2D,a,S,t,r,0,m,y,null),t>>=1,r>>=1}}else if(j.length>0){if(_&&A){const t=G(j[0]);n.texStorage2D(e.TEXTURE_2D,M,S,t.width,t.height)}for(let t=0,r=j.length;t<r;t++)N=j[t],_?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,m,y,N):n.texImage2D(e.TEXTURE_2D,t,S,m,y,N);s.generateMipmaps=!1}else if(_){if(A){const t=G(p);n.texStorage2D(e.TEXTURE_2D,M,S,t.width,t.height)}C&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,m,y,p)}else n.texImage2D(e.TEXTURE_2D,0,S,m,y,p);f(s)&&x(l),u.__version=d.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function R(t,a,s,l,c,d){const u=i.convert(s.format,s.colorSpace),h=i.convert(s.type),p=v(s.internalFormat,u,h,s.colorSpace),m=r.get(a),g=r.get(s);if(g.__renderTarget=a,!m.__hasExternalTextures){const t=Math.max(1,a.width>>d),r=Math.max(1,a.height>>d);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,d,p,t,r,a.depth,0,u,h,null):n.texImage2D(c,d,p,t,r,0,u,h,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),z(a)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,g.__webglTexture,0,U(a)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,g.__webglTexture,d),n.bindFramebuffer(e.FRAMEBUFFER,null)}function I(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const a=n.depthTexture,i=a&&a.isDepthTexture?a.type:null,s=b(n.stencilBuffer,i),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=U(n);z(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,s,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,s,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,s,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let a=0;a<t.length;a++){const s=t[a],l=i.convert(s.format,s.colorSpace),c=i.convert(s.type),d=v(s.internalFormat,l,c,s.colorSpace),u=U(n);r&&!1===z(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,d,n.width,n.height):z(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,d,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,d,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function O(t,a){if(a&&a.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!a.depthTexture||!a.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const i=r.get(a.depthTexture);i.__renderTarget=a,i.__webglTexture&&a.depthTexture.image.width===a.width&&a.depthTexture.image.height===a.height||(a.depthTexture.image.width=a.width,a.depthTexture.image.height=a.height,a.depthTexture.needsUpdate=!0),A(a.depthTexture,0);const s=i.__webglTexture,l=U(a);if(a.depthTexture.format===dY)z(a)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(a.depthTexture.format!==uY)throw new Error("Unknown depthTexture format");z(a)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}function B(t){const a=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(a.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(a.__depthDisposeCallback&&a.__depthDisposeCallback(),e){const t=()=>{delete a.__boundDepthTexture,delete a.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),a.__depthDisposeCallback=t}a.__boundDepthTexture=e}if(t.depthTexture&&!a.__autoAllocateDepthBuffer){if(i)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?O(a.__webglFramebuffer[0],t):O(a.__webglFramebuffer,t)}else if(i){a.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(e.FRAMEBUFFER,a.__webglFramebuffer[r]),void 0===a.__webglDepthbuffer[r])a.__webglDepthbuffer[r]=e.createRenderbuffer(),I(a.__webglDepthbuffer[r],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=a.__webglDepthbuffer[r];e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}}else{const r=t.texture.mipmaps;if(r&&r.length>0?n.bindFramebuffer(e.FRAMEBUFFER,a.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,a.__webglFramebuffer),void 0===a.__webglDepthbuffer)a.__webglDepthbuffer=e.createRenderbuffer(),I(a.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,r=a.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,r)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const L=[],F=[];function U(e){return Math.min(a.maxSamples,e.samples)}function z(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function H(e,t){const n=e.colorSpace,r=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==iX&&n!==rX&&(eK.getTransfer(n)===oX?r===cY&&a===XW||kX("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):EX("WebGLTextures: Unsupported texture color space:",n)),t}function G(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=_;return e>=a.maxTextures&&kX("WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+a.maxTextures),_+=1,e},this.resetTextureUnits=function(){_=0},this.setTexture2D=A,this.setTexture2DArray=function(t,a){const i=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&i.__version!==t.version?D(i,t,a):(t.isExternalTexture&&(i.__webglTexture=t.sourceTexture?t.sourceTexture:null),n.bindTexture(e.TEXTURE_2D_ARRAY,i.__webglTexture,e.TEXTURE0+a))},this.setTexture3D=function(t,a){const i=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&i.__version!==t.version?D(i,t,a):n.bindTexture(e.TEXTURE_3D,i.__webglTexture,e.TEXTURE0+a)},this.setTextureCube=function(t,s){const o=r.get(t);t.version>0&&o.__version!==t.version?function(t,s,o){if(6!==s.image.length)return;const l=T(t,s),c=s.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const d=r.get(c);if(c.version!==d.__version||!0===l){n.activeTexture(e.TEXTURE0+o);const t=eK.getPrimaries(eK.workingColorSpace),r=s.colorSpace===rX?null:eK.getPrimaries(s.colorSpace),u=s.colorSpace===rX||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,u);const h=s.isCompressedTexture||s.image[0].isCompressedTexture,p=s.image[0]&&s.image[0].isDataTexture,m=[];for(let e=0;e<6;e++)m[e]=h||p?p?s.image[e].image:s.image[e]:g(s.image[e],!0,a.maxCubemapSize),m[e]=H(s,m[e]);const y=m[0],b=i.convert(s.format,s.colorSpace),N=i.convert(s.type),S=v(s.internalFormat,b,N,s.colorSpace),j=!0!==s.isVideoTexture,_=void 0===d.__version||!0===l,A=c.dataReady;let C,M=w(s,y);if(E(e.TEXTURE_CUBE_MAP,s),h){j&&_&&n.texStorage2D(e.TEXTURE_CUBE_MAP,M,S,y.width,y.height);for(let t=0;t<6;t++){C=m[t].mipmaps;for(let r=0;r<C.length;r++){const a=C[r];s.format!==cY?null!==b?j?A&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,a.width,a.height,b,a.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,S,a.width,a.height,0,a.data):kX("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):j?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,a.width,a.height,b,N,a.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,S,a.width,a.height,0,b,N,a.data)}}}else{if(C=s.mipmaps,j&&_){C.length>0&&M++;const t=G(m[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,M,S,t.width,t.height)}for(let t=0;t<6;t++)if(p){j?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,m[t].width,m[t].height,b,N,m[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,S,m[t].width,m[t].height,0,b,N,m[t].data);for(let r=0;r<C.length;r++){const a=C[r].image[t].image;j?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,a.width,a.height,b,N,a.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,S,a.width,a.height,0,b,N,a.data)}}else{j?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,b,N,m[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,S,b,N,m[t]);for(let r=0;r<C.length;r++){const a=C[r];j?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,b,N,a.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,S,b,N,a.image[t])}}}f(s)&&x(e.TEXTURE_CUBE_MAP),d.__version=c.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(o,t,s):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,n,a){const i=r.get(t);void 0!==n&&R(i.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==a&&B(t)},this.setupRenderTarget=function(t){const a=t.texture,o=r.get(t),l=r.get(a);t.addEventListener("dispose",S);const c=t.textures,d=!0===t.isWebGLCubeRenderTarget,u=c.length>1;if(u||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=a.version,s.memory.textures++),d){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(a.mipmaps&&a.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<a.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(a.mipmaps&&a.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<a.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(u)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===z(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const a=i.convert(r.format,r.colorSpace),s=i.convert(r.type),l=v(r.internalFormat,a,s,r.colorSpace,!0===t.isXRRenderTarget),d=U(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,d,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),I(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),E(e.TEXTURE_CUBE_MAP,a);for(let n=0;n<6;n++)if(a.mipmaps&&a.mipmaps.length>0)for(let r=0;r<a.mipmaps.length;r++)R(o.__webglFramebuffer[n][r],t,a,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else R(o.__webglFramebuffer[n],t,a,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);f(a)&&x(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(u){for(let a=0,i=c.length;a<i;a++){const i=c[a],s=r.get(i);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(l,s.__webglTexture),E(l,i),R(o.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0+a,l,0),f(i)&&x(l)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),E(r,a),a.mipmaps&&a.mipmaps.length>0)for(let n=0;n<a.mipmaps.length;n++)R(o.__webglFramebuffer[n],t,a,e.COLOR_ATTACHMENT0,r,n);else R(o.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0,r,0);f(a)&&x(r),n.unbindTexture()}t.depthBuffer&&B(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let a=0,i=t.length;a<i;a++){const i=t[a];if(f(i)){const t=y(e),a=r.get(i).__webglTexture;n.bindTexture(t,a),x(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===z(t)){const a=t.textures,i=t.width,s=t.height;let o=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=r.get(t),u=a.length>1;if(u)for(let t=0;t<a.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,d.__webglMultisampledFramebuffer);const h=t.texture.mipmaps;h&&h.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer);for(let n=0;n<a.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),u){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,d.__webglColorRenderbuffer[n]);const t=r.get(a[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,i,s,0,0,i,s,o,e.NEAREST),!0===l&&(L.length=0,F.length=0,L.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(L.push(c),F.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,F)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,L))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),u)for(let t=0;t<a.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,d.__webglColorRenderbuffer[t]);const i=r.get(a[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,i,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=B,this.setupFrameBufferTexture=R,this.useMultisampledRTT=z}function a6(e,t){return{convert:function(n,r=""){let a;const i=eK.getTransfer(r);if(n===XW)return e.UNSIGNED_BYTE;if(n===nY)return e.UNSIGNED_SHORT_4_4_4_4;if(n===rY)return e.UNSIGNED_SHORT_5_5_5_1;if(n===iY)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===sY)return e.UNSIGNED_INT_10F_11F_11F_REV;if(n===KW)return e.BYTE;if(n===qW)return e.SHORT;if(n===JW)return e.UNSIGNED_SHORT;if(n===QW)return e.INT;if(n===ZW)return e.UNSIGNED_INT;if(n===eY)return e.FLOAT;if(n===tY)return e.HALF_FLOAT;if(n===oY)return e.ALPHA;if(n===lY)return e.RGB;if(n===cY)return e.RGBA;if(n===dY)return e.DEPTH_COMPONENT;if(n===uY)return e.DEPTH_STENCIL;if(n===hY)return e.RED;if(n===pY)return e.RED_INTEGER;if(n===mY)return e.RG;if(n===gY)return e.RG_INTEGER;if(n===fY)return e.RGBA_INTEGER;if(n===xY||n===yY||n===vY||n===bY)if(i===oX){if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(n===xY)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===yY)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===vY)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===bY)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=t.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(n===xY)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===yY)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===vY)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===bY)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===wY||n===NY||n===SY||n===jY){if(a=t.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(n===wY)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===NY)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===SY)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===jY)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===_Y||n===AY||n===CY){if(a=t.get("WEBGL_compressed_texture_etc"),null===a)return null;if(n===_Y||n===AY)return i===oX?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===CY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(n===MY||n===kY||n===EY||n===TY||n===PY||n===DY||n===RY||n===IY||n===OY||n===BY||n===LY||n===FY||n===UY||n===zY){if(a=t.get("WEBGL_compressed_texture_astc"),null===a)return null;if(n===MY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===kY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===EY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===TY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===PY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===DY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===RY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===IY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===OY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===BY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===LY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===FY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===UY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===zY)return i===oX?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===HY||n===GY||n===VY){if(a=t.get("EXT_texture_compression_bptc"),null===a)return null;if(n===HY)return i===oX?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===GY)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===VY)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===$Y||n===WY||n===YY||n===XY){if(a=t.get("EXT_texture_compression_rgtc"),null===a)return null;if(n===$Y)return a.COMPRESSED_RED_RGTC1_EXT;if(n===WY)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===YY)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===XY)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===aY?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class i6{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new PZ(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new jJ({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new xJ(new X0(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class s6 extends PX{constructor(e,t){super();const n=this;let r=null,a=1,i=null,s="local-floor",o=1,l=null,c=null,d=null,u=null,p=null,m=null;const g="undefined"!=typeof XRWebGLBinding,f=new i6,x={},y=t.getContextAttributes();let v=null,b=null;const w=[],N=[],S=new VX;let j=null;const _=new kJ;_.viewport=new uK;const A=new kJ;A.viewport=new uK;const C=[_,A],M=new M2;let k=null,E=null;function T(e){const t=N.indexOf(e.inputSource);if(-1===t)return;const n=w[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||i),n.dispatchEvent({type:e.type,data:e.inputSource}))}function P(){r.removeEventListener("select",T),r.removeEventListener("selectstart",T),r.removeEventListener("selectend",T),r.removeEventListener("squeeze",T),r.removeEventListener("squeezestart",T),r.removeEventListener("squeezeend",T),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",D);for(let e=0;e<w.length;e++){const t=N[e];null!==t&&(N[e]=null,w[e].disconnect(t))}k=null,E=null,f.reset();for(const e in x)delete x[e];e.setRenderTarget(v),p=null,u=null,d=null,r=null,b=null,L.stop(),n.isPresenting=!1,e.setPixelRatio(j),e.setSize(S.width,S.height,!1),n.dispatchEvent({type:"sessionend"})}function D(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=N.indexOf(n);r>=0&&(N[r]=null,w[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=N.indexOf(n);if(-1===r){for(let e=0;e<w.length;e++){if(e>=N.length){N.push(n),r=e;break}if(null===N[e]){N[e]=n,r=e;break}}if(-1===r)break}const a=w[r];a&&a.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=w[e];return void 0===t&&(t=new OJ,w[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=w[e];return void 0===t&&(t=new OJ,w[e]=t),t.getGripSpace()},this.getHand=function(e){let t=w[e];return void 0===t&&(t=new OJ,w[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){a=e,!0===n.isPresenting&&kX("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&kX("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||i},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==u?u:p},this.getBinding=function(){return null===d&&g&&(d=new XRWebGLBinding(r,t)),d},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(c){return h(this,null,function*(){if(r=c,null!==r){v=e.getRenderTarget(),r.addEventListener("select",T),r.addEventListener("selectstart",T),r.addEventListener("selectend",T),r.addEventListener("squeeze",T),r.addEventListener("squeezestart",T),r.addEventListener("squeezeend",T),r.addEventListener("end",P),r.addEventListener("inputsourceschange",D),!0!==y.xrCompatible&&(yield t.makeXRCompatible()),j=e.getPixelRatio(),e.getSize(S);if(g&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,i=null,s=null;y.depth&&(s=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=y.stencil?uY:dY,i=y.stencil?aY:ZW);const o={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:a};d=this.getBinding(),u=d.createProjectionLayer(o),r.updateRenderState({layers:[u]}),e.setPixelRatio(1),e.setSize(u.textureWidth,u.textureHeight,!1),b=new pK(u.textureWidth,u.textureHeight,{format:cY,type:XW,depthTexture:new TZ(u.textureWidth,u.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0,resolveDepthBuffer:!1===u.ignoreDepthValues,resolveStencilBuffer:!1===u.ignoreDepthValues})}else{const n={antialias:y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:a};p=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),b=new pK(p.framebufferWidth,p.framebufferHeight,{format:cY,type:XW,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil,resolveDepthBuffer:!1===p.ignoreDepthValues,resolveStencilBuffer:!1===p.ignoreDepthValues})}b.isXRRenderTarget=!0,this.setFoveation(o),l=null,i=yield r.requestReferenceSpace(s),L.setContext(r),L.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return f.getDepthTexture()};const R=new WX,I=new WX;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;let t=e.near,n=e.far;null!==f.texture&&(f.depthNear>0&&(t=f.depthNear),f.depthFar>0&&(n=f.depthFar)),M.near=A.near=_.near=t,M.far=A.far=_.far=n,k===M.near&&E===M.far||(r.updateRenderState({depthNear:M.near,depthFar:M.far}),k=M.near,E=M.far),M.layers.mask=6|e.layers.mask,_.layers.mask=3&M.layers.mask,A.layers.mask=5&M.layers.mask;const a=e.parent,i=M.cameras;O(M,a);for(let r=0;r<i.length;r++)O(i[r],a);2===i.length?function(e,t,n){R.setFromMatrixPosition(t.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const r=R.distanceTo(I),a=t.projectionMatrix.elements,i=n.projectionMatrix.elements,s=a[14]/(a[10]-1),o=a[14]/(a[10]+1),l=(a[9]+1)/a[5],c=(a[9]-1)/a[5],d=(a[8]-1)/a[0],u=(i[8]+1)/i[0],h=s*d,p=s*u,m=r/(-d+u),g=m*-d;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(g),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===a[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=s+m,n=o+m,a=h-g,i=p+(r-g),d=l*o/n*t,u=c*o/n*t;e.projectionMatrix.makePerspective(a,i,d,u,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(M,_,A):M.projectionMatrix.copy(_.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*OX*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,M,a)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==u||null!==p)return o},this.setFoveation=function(e){o=e,null!==u&&(u.fixedFoveation=e),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==f.texture},this.getDepthSensingMesh=function(){return f.getMesh(M)},this.getCameraTexture=function(e){return x[e]};let B=null;const L=new P3;L.setAnimationLoop(function(t,a){if(c=a.getViewerPose(l||i),m=a,null!==c){const t=c.views;null!==p&&(e.setRenderTargetFramebuffer(b,p.framebuffer),e.setRenderTarget(b));let a=!1;t.length!==M.cameras.length&&(M.cameras.length=0,a=!0);for(let n=0;n<t.length;n++){const r=t[n];let i=null;if(null!==p)i=p.getViewport(r);else{const t=d.getViewSubImage(u,r);i=t.viewport,0===n&&(e.setRenderTargetTextures(b,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(b))}let s=C[n];void 0===s&&(s=new kJ,s.layers.enable(n),s.viewport=new uK,C[n]=s),s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(r.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(i.x,i.y,i.width,i.height),0===n&&(M.matrix.copy(s.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===a&&M.cameras.push(s)}const i=r.enabledFeatures;if(i&&i.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&g){d=n.getBinding();const e=d.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&f.init(e,r.renderState)}if(i&&i.includes("camera-access")&&g){e.state.unbindTexture(),d=n.getBinding();for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=x[n];e||(e=new PZ,x[n]=e);const t=d.getCameraImage(n);e.sourceTexture=t}}}}for(let e=0;e<w.length;e++){const t=N[e],n=w[e];null!==t&&void 0!==n&&n.update(t,a,l||i)}B&&B(t,a),a.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:a}),m=null}),this.setAnimationLoop=function(e){B=e},this.dispose=function(){}}}const o6=new ZK,l6=new GK;function c6(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,r.side===nW&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),r.side===nW&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const a=t.get(r),i=a.envMap,s=a.envMapRotation;i&&(e.envMap.value=i,o6.copy(s),o6.x*=-1,o6.y*=-1,o6.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(o6.y*=-1,o6.z*=-1),e.envMapRotation.value.setFromMatrix4(l6.makeRotationFromEuler(o6)),e.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,NJ(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,a,i,s,o){a.isMeshBasicMaterial||a.isMeshLambertMaterial?r(e,a):a.isMeshToonMaterial?(r(e,a),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,a)):a.isMeshPhongMaterial?(r(e,a),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,a)):a.isMeshStandardMaterial?(r(e,a),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,a),a.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===nW&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,a,o)):a.isMeshMatcapMaterial?(r(e,a),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,a)):a.isMeshDepthMaterial?r(e,a):a.isMeshDistanceMaterial?(r(e,a),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,a)):a.isMeshNormalMaterial?r(e,a):a.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,a),a.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,a)):a.isPointsMaterial?function(e,t,r,a){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*a,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,a,i,s):a.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,a):a.isShadowMaterial?(e.color.value.copy(a.color),e.opacity.value=a.opacity):a.isShaderMaterial&&(a.uniformsNeedUpdate=!1)}}}function d6(e,t,n,r){let a={},i={},s=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const a=e.value,i=t+"_"+n;if(void 0===r[i])return r[i]="number"==typeof a||"boolean"==typeof a?a:a.clone(),!0;{const e=r[i];if("number"==typeof a||"boolean"==typeof a){if(e!==a)return r[i]=a,!0}else if(!1===e.equals(a))return e.copy(a),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?kX("WebGLRenderer: Texture samplers can not be part of an uniforms group."):kX("WebGLRenderer: Unsupported uniform value type.",e),t}function d(t){const n=t.target;n.removeEventListener("dispose",d);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(a[n.id]),delete a[n.id],delete i[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,u){let h=a[n.id];void 0===h&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let i=0,s=t.length;i<s;i++){const e=Array.isArray(t[i])?t[i]:[t[i]];for(let t=0,a=e.length;t<a;t++){const a=e[t],i=Array.isArray(a.value)?a.value:[a.value];for(let e=0,t=i.length;e<t;e++){const t=c(i[e]),s=n%r,o=s%t.boundary,l=s+o;n+=o,0!==l&&r-l<t.storage&&(n+=r-l),a.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),a.__offset=n,n+=t.storage}}}const a=n%r;a>0&&(n+=r-a);e.__size=n,e.__cache={}}(n),h=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return EX("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),a=t.__size,i=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,a,i),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),a[n.id]=h,n.addEventListener("dispose",d));const p=u.program;r.updateUBOMapping(n,p);const m=t.render.frame;i[n.id]!==m&&(!function(t){const n=a[t.id],r=t.uniforms,i=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let a=0,s=r.length;a<s;a++){const t=Array.isArray(r[a])?r[a]:[r[a]];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!0===l(r,a,n,i)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let a=0;for(let i=0;i<n.length;i++){const s=n[i],o=c(s);"number"==typeof s||"boolean"==typeof s?(r.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,t+a,r.__data)):s.isMatrix3?(r.__data[0]=s.elements[0],r.__data[1]=s.elements[1],r.__data[2]=s.elements[2],r.__data[3]=0,r.__data[4]=s.elements[3],r.__data[5]=s.elements[4],r.__data[6]=s.elements[5],r.__data[7]=0,r.__data[8]=s.elements[6],r.__data[9]=s.elements[7],r.__data[10]=s.elements[8],r.__data[11]=0):(s.toArray(r.__data,a),a+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),i[n.id]=m)},dispose:function(){for(const t in a)e.deleteBuffer(a[t]);s=[],a={},i={}}}}const u6=new Uint16Array([11481,15204,11534,15171,11808,15015,12385,14843,12894,14716,13396,14600,13693,14483,13976,14366,14237,14171,14405,13961,14511,13770,14605,13598,14687,13444,14760,13305,14822,13066,14876,12857,14923,12675,14963,12517,14997,12379,15025,12230,15049,12023,15070,11843,15086,11687,15100,11551,15111,11433,15120,11330,15127,11217,15132,11060,15135,10922,15138,10801,15139,10695,15139,10600,13012,14923,13020,14917,13064,14886,13176,14800,13349,14666,13513,14526,13724,14398,13960,14230,14200,14020,14383,13827,14488,13651,14583,13491,14667,13348,14740,13132,14803,12908,14856,12713,14901,12542,14938,12394,14968,12241,14992,12017,15010,11822,15024,11654,15034,11507,15041,11380,15044,11269,15044,11081,15042,10913,15037,10764,15031,10635,15023,10520,15014,10419,15003,10330,13657,14676,13658,14673,13670,14660,13698,14622,13750,14547,13834,14442,13956,14317,14112,14093,14291,13889,14407,13704,14499,13538,14586,13389,14664,13201,14733,12966,14792,12758,14842,12577,14882,12418,14915,12272,14940,12033,14959,11826,14972,11646,14980,11490,14983,11355,14983,11212,14979,11008,14971,10830,14961,10675,14950,10540,14936,10420,14923,10315,14909,10204,14894,10041,14089,14460,14090,14459,14096,14452,14112,14431,14141,14388,14186,14305,14252,14130,14341,13941,14399,13756,14467,13585,14539,13430,14610,13272,14677,13026,14737,12808,14790,12617,14833,12449,14869,12303,14896,12065,14916,11845,14929,11655,14937,11490,14939,11347,14936,11184,14930,10970,14921,10783,14912,10621,14900,10480,14885,10356,14867,10247,14848,10062,14827,9894,14805,9745,14400,14208,14400,14206,14402,14198,14406,14174,14415,14122,14427,14035,14444,13913,14469,13767,14504,13613,14548,13463,14598,13324,14651,13082,14704,12858,14752,12658,14795,12483,14831,12330,14860,12106,14881,11875,14895,11675,14903,11501,14905,11351,14903,11178,14900,10953,14892,10757,14880,10589,14865,10442,14847,10313,14827,10162,14805,9965,14782,9792,14757,9642,14731,9507,14562,13883,14562,13883,14563,13877,14566,13862,14570,13830,14576,13773,14584,13689,14595,13582,14613,13461,14637,13336,14668,13120,14704,12897,14741,12695,14776,12516,14808,12358,14835,12150,14856,11910,14870,11701,14878,11519,14882,11361,14884,11187,14880,10951,14871,10748,14858,10572,14842,10418,14823,10286,14801,10099,14777,9897,14751,9722,14725,9567,14696,9430,14666,9309,14702,13604,14702,13604,14702,13600,14703,13591,14705,13570,14707,13533,14709,13477,14712,13400,14718,13305,14727,13106,14743,12907,14762,12716,14784,12539,14807,12380,14827,12190,14844,11943,14855,11727,14863,11539,14870,11376,14871,11204,14868,10960,14858,10748,14845,10565,14829,10406,14809,10269,14786,10058,14761,9852,14734,9671,14705,9512,14674,9374,14641,9253,14608,9076,14821,13366,14821,13365,14821,13364,14821,13358,14821,13344,14821,13320,14819,13252,14817,13145,14815,13011,14814,12858,14817,12698,14823,12539,14832,12389,14841,12214,14850,11968,14856,11750,14861,11558,14866,11390,14867,11226,14862,10972,14853,10754,14840,10565,14823,10401,14803,10259,14780,10032,14754,9820,14725,9635,14694,9473,14661,9333,14627,9203,14593,8988,14557,8798,14923,13014,14922,13014,14922,13012,14922,13004,14920,12987,14919,12957,14915,12907,14909,12834,14902,12738,14894,12623,14888,12498,14883,12370,14880,12203,14878,11970,14875,11759,14873,11569,14874,11401,14872,11243,14865,10986,14855,10762,14842,10568,14825,10401,14804,10255,14781,10017,14754,9799,14725,9611,14692,9445,14658,9301,14623,9139,14587,8920,14548,8729,14509,8562,15008,12672,15008,12672,15008,12671,15007,12667,15005,12656,15001,12637,14997,12605,14989,12556,14978,12490,14966,12407,14953,12313,14940,12136,14927,11934,14914,11742,14903,11563,14896,11401,14889,11247,14879,10992,14866,10767,14851,10570,14833,10400,14812,10252,14789,10007,14761,9784,14731,9592,14698,9424,14663,9279,14627,9088,14588,8868,14548,8676,14508,8508,14467,8360,15080,12386,15080,12386,15079,12385,15078,12383,15076,12378,15072,12367,15066,12347,15057,12315,15045,12253,15030,12138,15012,11998,14993,11845,14972,11685,14951,11530,14935,11383,14920,11228,14904,10981,14887,10762,14870,10567,14850,10397,14827,10248,14803,9997,14774,9771,14743,9578,14710,9407,14674,9259,14637,9048,14596,8826,14555,8632,14514,8464,14471,8317,14427,8182,15139,12008,15139,12008,15138,12008,15137,12007,15135,12003,15130,11990,15124,11969,15115,11929,15102,11872,15086,11794,15064,11693,15041,11581,15013,11459,14987,11336,14966,11170,14944,10944,14921,10738,14898,10552,14875,10387,14850,10239,14824,9983,14794,9758,14762,9563,14728,9392,14692,9244,14653,9014,14611,8791,14569,8597,14526,8427,14481,8281,14436,8110,14391,7885,15188,11617,15188,11617,15187,11617,15186,11618,15183,11617,15179,11612,15173,11601,15163,11581,15150,11546,15133,11495,15110,11427,15083,11346,15051,11246,15024,11057,14996,10868,14967,10687,14938,10517,14911,10362,14882,10206,14853,9956,14821,9737,14787,9543,14752,9375,14715,9228,14675,8980,14632,8760,14589,8565,14544,8395,14498,8248,14451,8049,14404,7824,14357,7630,15228,11298,15228,11298,15227,11299,15226,11301,15223,11303,15219,11302,15213,11299,15204,11290,15191,11271,15174,11217,15150,11129,15119,11015,15087,10886,15057,10744,15024,10599,14990,10455,14957,10318,14924,10143,14891,9911,14856,9701,14820,9516,14782,9352,14744,9200,14703,8946,14659,8725,14615,8533,14568,8366,14521,8220,14472,7992,14423,7770,14374,7578,14315,7408,15260,10819,15260,10819,15259,10822,15258,10826,15256,10832,15251,10836,15246,10841,15237,10838,15225,10821,15207,10788,15183,10734,15151,10660,15120,10571,15087,10469,15049,10359,15012,10249,14974,10041,14937,9837,14900,9647,14860,9475,14820,9320,14779,9147,14736,8902,14691,8688,14646,8499,14598,8335,14549,8189,14499,7940,14448,7720,14397,7529,14347,7363,14256,7218,15285,10410,15285,10411,15285,10413,15284,10418,15282,10425,15278,10434,15272,10442,15264,10449,15252,10445,15235,10433,15210,10403,15179,10358,15149,10301,15113,10218,15073,10059,15033,9894,14991,9726,14951,9565,14909,9413,14865,9273,14822,9073,14777,8845,14730,8641,14682,8459,14633,8300,14583,8129,14531,7883,14479,7670,14426,7482,14373,7321,14305,7176,14201,6939,15305,9939,15305,9940,15305,9945,15304,9955,15302,9967,15298,9989,15293,10010,15286,10033,15274,10044,15258,10045,15233,10022,15205,9975,15174,9903,15136,9808,15095,9697,15053,9578,15009,9451,14965,9327,14918,9198,14871,8973,14825,8766,14775,8579,14725,8408,14675,8259,14622,8058,14569,7821,14515,7615,14460,7435,14405,7276,14350,7108,14256,6866,14149,6653,15321,9444,15321,9445,15321,9448,15320,9458,15317,9470,15314,9490,15310,9515,15302,9540,15292,9562,15276,9579,15251,9577,15226,9559,15195,9519,15156,9463,15116,9389,15071,9304,15025,9208,14978,9023,14927,8838,14878,8661,14827,8496,14774,8344,14722,8206,14667,7973,14612,7749,14556,7555,14499,7382,14443,7229,14385,7025,14322,6791,14210,6588,14100,6409,15333,8920,15333,8921,15332,8927,15332,8943,15329,8965,15326,9002,15322,9048,15316,9106,15307,9162,15291,9204,15267,9221,15244,9221,15212,9196,15175,9134,15133,9043,15088,8930,15040,8801,14990,8665,14938,8526,14886,8391,14830,8261,14775,8087,14719,7866,14661,7664,14603,7482,14544,7322,14485,7178,14426,6936,14367,6713,14281,6517,14166,6348,14054,6198,15341,8360,15341,8361,15341,8366,15341,8379,15339,8399,15336,8431,15332,8473,15326,8527,15318,8585,15302,8632,15281,8670,15258,8690,15227,8690,15191,8664,15149,8612,15104,8543,15055,8456,15001,8360,14948,8259,14892,8122,14834,7923,14776,7734,14716,7558,14656,7397,14595,7250,14534,7070,14472,6835,14410,6628,14350,6443,14243,6283,14125,6135,14010,5889,15348,7715,15348,7717,15348,7725,15347,7745,15345,7780,15343,7836,15339,7905,15334,8e3,15326,8103,15310,8193,15293,8239,15270,8270,15240,8287,15204,8283,15163,8260,15118,8223,15067,8143,15014,8014,14958,7873,14899,7723,14839,7573,14778,7430,14715,7293,14652,7164,14588,6931,14524,6720,14460,6531,14396,6362,14330,6210,14207,6015,14086,5781,13969,5576,15352,7114,15352,7116,15352,7128,15352,7159,15350,7195,15348,7237,15345,7299,15340,7374,15332,7457,15317,7544,15301,7633,15280,7703,15251,7754,15216,7775,15176,7767,15131,7733,15079,7670,15026,7588,14967,7492,14906,7387,14844,7278,14779,7171,14714,6965,14648,6770,14581,6587,14515,6420,14448,6269,14382,6123,14299,5881,14172,5665,14049,5477,13929,5310,15355,6329,15355,6330,15355,6339,15355,6362,15353,6410,15351,6472,15349,6572,15344,6688,15337,6835,15323,6985,15309,7142,15287,7220,15260,7277,15226,7310,15188,7326,15142,7318,15090,7285,15036,7239,14976,7177,14914,7045,14849,6892,14782,6736,14714,6581,14645,6433,14576,6293,14506,6164,14438,5946,14369,5733,14270,5540,14140,5369,14014,5216,13892,5043,15357,5483,15357,5484,15357,5496,15357,5528,15356,5597,15354,5692,15351,5835,15347,6011,15339,6195,15328,6317,15314,6446,15293,6566,15268,6668,15235,6746,15197,6796,15152,6811,15101,6790,15046,6748,14985,6673,14921,6583,14854,6479,14785,6371,14714,6259,14643,6149,14571,5946,14499,5750,14428,5567,14358,5401,14242,5250,14109,5111,13980,4870,13856,4657,15359,4555,15359,4557,15358,4573,15358,4633,15357,4715,15355,4841,15353,5061,15349,5216,15342,5391,15331,5577,15318,5770,15299,5967,15274,6150,15243,6223,15206,6280,15161,6310,15111,6317,15055,6300,14994,6262,14928,6208,14860,6141,14788,5994,14715,5838,14641,5684,14566,5529,14492,5384,14418,5247,14346,5121,14216,4892,14079,4682,13948,4496,13822,4330,15359,3498,15359,3501,15359,3520,15359,3598,15358,3719,15356,3860,15355,4137,15351,4305,15344,4563,15334,4809,15321,5116,15303,5273,15280,5418,15250,5547,15214,5653,15170,5722,15120,5761,15064,5763,15002,5733,14935,5673,14865,5597,14792,5504,14716,5400,14640,5294,14563,5185,14486,5041,14410,4841,14335,4655,14191,4482,14051,4325,13918,4183,13790,4012,15360,2282,15360,2285,15360,2306,15360,2401,15359,2547,15357,2748,15355,3103,15352,3349,15345,3675,15336,4020,15324,4272,15307,4496,15285,4716,15255,4908,15220,5086,15178,5170,15128,5214,15072,5234,15010,5231,14943,5206,14871,5166,14796,5102,14718,4971,14639,4833,14559,4687,14480,4541,14402,4401,14315,4268,14167,4142,14025,3958,13888,3747,13759,3556,15360,923,15360,925,15360,946,15360,1052,15359,1214,15357,1494,15356,1892,15352,2274,15346,2663,15338,3099,15326,3393,15309,3679,15288,3980,15260,4183,15226,4325,15185,4437,15136,4517,15080,4570,15018,4591,14950,4581,14877,4545,14800,4485,14720,4411,14638,4325,14556,4231,14475,4136,14395,3988,14297,3803,14145,3628,13999,3465,13861,3314,13729,3177,15360,263,15360,264,15360,272,15360,325,15359,407,15358,548,15356,780,15352,1144,15347,1580,15339,2099,15328,2425,15312,2795,15292,3133,15264,3329,15232,3517,15191,3689,15143,3819,15088,3923,15025,3978,14956,3999,14882,3979,14804,3931,14722,3855,14639,3756,14554,3645,14470,3529,14388,3409,14279,3289,14124,3173,13975,3055,13834,2848,13701,2658,15360,49,15360,49,15360,52,15360,75,15359,111,15358,201,15356,283,15353,519,15348,726,15340,1045,15329,1415,15314,1795,15295,2173,15269,2410,15237,2649,15197,2866,15150,3054,15095,3140,15032,3196,14963,3228,14888,3236,14808,3224,14725,3191,14639,3146,14553,3088,14466,2976,14382,2836,14262,2692,14103,2549,13952,2409,13808,2278,13674,2154,15360,4,15360,4,15360,4,15360,13,15359,33,15358,59,15357,112,15353,199,15348,302,15341,456,15331,628,15316,827,15297,1082,15272,1332,15241,1601,15202,1851,15156,2069,15101,2172,15039,2256,14970,2314,14894,2348,14813,2358,14728,2344,14640,2311,14551,2263,14463,2203,14376,2133,14247,2059,14084,1915,13930,1761,13784,1609,13648,1464,15360,0,15360,0,15360,0,15360,3,15359,18,15358,26,15357,53,15354,80,15348,97,15341,165,15332,238,15318,326,15299,427,15275,529,15245,654,15207,771,15161,885,15108,994,15046,1089,14976,1170,14900,1229,14817,1266,14731,1284,14641,1282,14550,1260,14460,1223,14370,1174,14232,1116,14066,1050,13909,981,13761,910,13623,839]);let h6=null;class p6{constructor(e={}){const{canvas:t=_X(),context:n=null,depth:r=!0,stencil:a=!1,alpha:i=!1,antialias:s=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:u=!1}=e;let p;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=n.getContextAttributes().alpha}else p=i;const m=new Set([fY,gY,pY]),g=new Set([XW,ZW,JW,aY,nY,rY]),f=new Uint32Array(4),x=new Int32Array(4);let y=null,v=null;const b=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const N=this;let S=!1;this._outputColorSpace=aX;let j=0,_=0,A=null,C=-1,M=null;const k=new uK,E=new uK;let T=null;const P=new Iq(0);let D=0,R=t.width,I=t.height,O=1,B=null,L=null;const F=new uK(0,0,R,I),U=new uK(0,0,R,I);let z=!1;const H=new FQ;let G=!1,V=!1;const $=new GK,W=new WX,Y=new uK,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let K=!1;function q(){return null===A?O:1}let J,Q,Z,ee,te,ne,re,ae,ie,se,oe,le,ce,de,ue,he,pe,me,ge,fe,xe,ye,ve,be,we=n;function Ne(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:r,stencil:a,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Q$}`),t.addEventListener("webglcontextlost",_e,!1),t.addEventListener("webglcontextrestored",Ae,!1),t.addEventListener("webglcontextcreationerror",Ce,!1),null===we){const t="webgl2";if(we=Ne(t,e),null===we)throw Ne(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch($e){throw $e("WebGLRenderer: "+$e.message),$e}function Se(){J=new l4(we),J.init(),ye=new a6(we,J),Q=new G3(we,J,e,ye),Z=new n6(we,J),Q.reversedDepthBuffer&&u&&Z.buffers.depth.setReversed(!0),ee=new u4(we),te=new G5,ne=new r6(we,J,Z,te,Q,ye,ee),re=new $3(N),ae=new o4(N),ie=new D3(we),ve=new z3(we,ie),se=new c4(we,ie,ee,ve),oe=new p4(we,se,ie,ee),ge=new h4(we,Q,ne),he=new V3(te),le=new H5(N,re,ae,J,Q,ve,he),ce=new c6(N,te),de=new Y5,ue=new Z5(J),me=new U3(N,re,ae,Z,oe,p,o),pe=new e6(N,oe,Q),be=new d6(we,ee,Q,Z),fe=new H3(we,J,ee),xe=new d4(we,J,ee),ee.programs=le.programs,N.capabilities=Q,N.extensions=J,N.properties=te,N.renderLists=de,N.shadowMap=pe,N.state=Z,N.info=ee}Se();const je=new s6(N,we);function _e(e){e.preventDefault(),MX("WebGLRenderer: Context Lost."),S=!0}function Ae(){MX("WebGLRenderer: Context Restored."),S=!1;const e=ee.autoReset,t=pe.enabled,n=pe.autoUpdate,r=pe.needsUpdate,a=pe.type;Se(),ee.autoReset=e,pe.enabled=t,pe.autoUpdate=n,pe.needsUpdate=r,pe.type=a}function Ce(e){EX("WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Me(e){const t=e.target;t.removeEventListener("dispose",Me),function(e){(function(e){const t=te.get(e).programs;void 0!==t&&(t.forEach(function(e){le.releaseProgram(e)}),e.isShaderMaterial&&le.releaseShaderCache(e))})(e),te.remove(e)}(t)}function ke(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=nW,e.needsUpdate=!0,Fe(e,t,n),e.side=0,e.needsUpdate=!0,Fe(e,t,n),e.side=2):Fe(e,t,n)}this.xr=je,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const e=J.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=J.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(e){void 0!==e&&(O=e,this.setSize(R,I,!1))},this.getSize=function(e){return e.set(R,I)},this.setSize=function(e,n,r=!0){je.isPresenting?kX("WebGLRenderer: Can't change size while VR device is presenting."):(R=e,I=n,t.width=Math.floor(e*O),t.height=Math.floor(n*O),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(R*O,I*O).floor()},this.setDrawingBufferSize=function(e,n,r){R=e,I=n,O=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(k)},this.getViewport=function(e){return e.copy(F)},this.setViewport=function(e,t,n,r){e.isVector4?F.set(e.x,e.y,e.z,e.w):F.set(e,t,n,r),Z.viewport(k.copy(F).multiplyScalar(O).round())},this.getScissor=function(e){return e.copy(U)},this.setScissor=function(e,t,n,r){e.isVector4?U.set(e.x,e.y,e.z,e.w):U.set(e,t,n,r),Z.scissor(E.copy(U).multiplyScalar(O).round())},this.getScissorTest=function(){return z},this.setScissorTest=function(e){Z.setScissorTest(z=e)},this.setOpaqueSort=function(e){B=e},this.setTransparentSort=function(e){L=e},this.getClearColor=function(e){return e.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor(...arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha(...arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==A){const t=A.texture.format;e=m.has(t)}if(e){const e=A.texture.type,t=g.has(e),n=me.getClearColor(),r=me.getClearAlpha(),a=n.r,i=n.g,s=n.b;t?(f[0]=a,f[1]=i,f[2]=s,f[3]=r,we.clearBufferuiv(we.COLOR,0,f)):(x[0]=a,x[1]=i,x[2]=s,x[3]=r,we.clearBufferiv(we.COLOR,0,x))}else r|=we.COLOR_BUFFER_BIT}t&&(r|=we.DEPTH_BUFFER_BIT),n&&(r|=we.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),we.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",_e,!1),t.removeEventListener("webglcontextrestored",Ae,!1),t.removeEventListener("webglcontextcreationerror",Ce,!1),me.dispose(),de.dispose(),ue.dispose(),te.dispose(),re.dispose(),ae.dispose(),oe.dispose(),ve.dispose(),be.dispose(),le.dispose(),je.dispose(),je.removeEventListener("sessionstart",Te),je.removeEventListener("sessionend",Pe),De.stop()},this.renderBufferDirect=function(e,t,n,r,a,i){null===t&&(t=X);const s=a.isMesh&&a.matrixWorld.determinant()<0,o=function(e,t,n,r,a){!0!==t.isScene&&(t=X);ne.resetTextureUnits();const i=t.fog,s=r.isMeshStandardMaterial?t.environment:null,o=null===A?N.outputColorSpace:!0===A.isXRRenderTarget?A.texture.colorSpace:iX,l=(r.isMeshStandardMaterial?ae:re).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,d=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),u=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let m=0;r.toneMapped&&(null!==A&&!0!==A.isXRRenderTarget||(m=N.toneMapping));const g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,f=void 0!==g?g.length:0,x=te.get(r),y=v.state.lights;if(!0===G&&(!0===V||e!==M)){const t=e===M&&r.id===C;he.setState(r,e,t)}let b=!1;r.version===x.__version?x.needsLights&&x.lightsStateVersion!==y.state.version||x.outputColorSpace!==o||a.isBatchedMesh&&!1===x.batching?b=!0:a.isBatchedMesh||!0!==x.batching?a.isBatchedMesh&&!0===x.batchingColor&&null===a.colorTexture||a.isBatchedMesh&&!1===x.batchingColor&&null!==a.colorTexture||a.isInstancedMesh&&!1===x.instancing?b=!0:a.isInstancedMesh||!0!==x.instancing?a.isSkinnedMesh&&!1===x.skinning?b=!0:a.isSkinnedMesh||!0!==x.skinning?a.isInstancedMesh&&!0===x.instancingColor&&null===a.instanceColor||a.isInstancedMesh&&!1===x.instancingColor&&null!==a.instanceColor||a.isInstancedMesh&&!0===x.instancingMorph&&null===a.morphTexture||a.isInstancedMesh&&!1===x.instancingMorph&&null!==a.morphTexture||x.envMap!==l||!0===r.fog&&x.fog!==i?b=!0:void 0===x.numClippingPlanes||x.numClippingPlanes===he.numPlanes&&x.numIntersection===he.numIntersection?(x.vertexAlphas!==c||x.vertexTangents!==d||x.morphTargets!==u||x.morphNormals!==h||x.morphColors!==p||x.toneMapping!==m||x.morphTargetsCount!==f)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,x.__version=r.version);let w=x.currentProgram;!0===b&&(w=Fe(r,t,a));let S=!1,j=!1,_=!1;const k=w.getUniforms(),E=x.uniforms;Z.useProgram(w.program)&&(S=!0,j=!0,_=!0);r.id!==C&&(C=r.id,j=!0);if(S||M!==e){Z.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),k.setValue(we,"projectionMatrix",e.projectionMatrix),k.setValue(we,"viewMatrix",e.matrixWorldInverse);const t=k.map.cameraPosition;void 0!==t&&t.setValue(we,W.setFromMatrixPosition(e.matrixWorld)),Q.logarithmicDepthBuffer&&k.setValue(we,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&k.setValue(we,"isOrthographic",!0===e.isOrthographicCamera),M!==e&&(M=e,j=!0,_=!0)}if(a.isSkinnedMesh){k.setOptional(we,a,"bindMatrix"),k.setOptional(we,a,"bindMatrixInverse");const e=a.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),k.setValue(we,"boneTexture",e.boneTexture,ne))}a.isBatchedMesh&&(k.setOptional(we,a,"batchingTexture"),k.setValue(we,"batchingTexture",a._matricesTexture,ne),k.setOptional(we,a,"batchingIdTexture"),k.setValue(we,"batchingIdTexture",a._indirectTexture,ne),k.setOptional(we,a,"batchingColorTexture"),null!==a._colorsTexture&&k.setValue(we,"batchingColorTexture",a._colorsTexture,ne));const T=n.morphAttributes;void 0===T.position&&void 0===T.normal&&void 0===T.color||ge.update(a,n,w);(j||x.receiveShadow!==a.receiveShadow)&&(x.receiveShadow=a.receiveShadow,k.setValue(we,"receiveShadow",a.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(E.envMap.value=l,E.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(E.envMapIntensity.value=t.environmentIntensity);void 0!==E.dfgLUT&&(E.dfgLUT.value=(null===h6&&(h6=new vQ(u6,32,32,mY,tY),h6.minFilter=VW,h6.magFilter=VW,h6.wrapS=FW,h6.wrapT=FW,h6.generateMipmaps=!1,h6.needsUpdate=!0),h6));j&&(k.setValue(we,"toneMappingExposure",N.toneMappingExposure),x.needsLights&&(D=_,(P=E).ambientLightColor.needsUpdate=D,P.lightProbe.needsUpdate=D,P.directionalLights.needsUpdate=D,P.directionalLightShadows.needsUpdate=D,P.pointLights.needsUpdate=D,P.pointLightShadows.needsUpdate=D,P.spotLights.needsUpdate=D,P.spotLightShadows.needsUpdate=D,P.rectAreaLights.needsUpdate=D,P.hemisphereLights.needsUpdate=D),i&&!0===r.fog&&ce.refreshFogUniforms(E,i),ce.refreshMaterialUniforms(E,r,O,I,v.state.transmissionRenderTarget[e.id]),y5.upload(we,Ue(x),E,ne));var P,D;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(y5.upload(we,Ue(x),E,ne),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&k.setValue(we,"center",a.center);if(k.setValue(we,"modelViewMatrix",a.modelViewMatrix),k.setValue(we,"normalMatrix",a.normalMatrix),k.setValue(we,"modelMatrix",a.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];be.update(n,w),be.bind(n,w)}}return w}(e,t,n,r,a);Z.setMaterial(r,s);let l=n.index,c=1;if(!0===r.wireframe){if(l=se.getWireframeAttribute(n),void 0===l)return;c=2}const d=n.drawRange,u=n.attributes.position;let h=d.start*c,p=(d.start+d.count)*c;null!==i&&(h=Math.max(h,i.start*c),p=Math.min(p,(i.start+i.count)*c)),null!==l?(h=Math.max(h,0),p=Math.min(p,l.count)):null!=u&&(h=Math.max(h,0),p=Math.min(p,u.count));const m=p-h;if(m<0||m===1/0)return;let g;ve.setup(a,r,o,n,l);let f=fe;if(null!==l&&(g=ie.get(l),f=xe,f.setIndex(g)),a.isMesh)!0===r.wireframe?(Z.setLineWidth(r.wireframeLinewidth*q()),f.setMode(we.LINES)):f.setMode(we.TRIANGLES);else if(a.isLine){let e=r.linewidth;void 0===e&&(e=1),Z.setLineWidth(e*q()),a.isLineSegments?f.setMode(we.LINES):a.isLineLoop?f.setMode(we.LINE_LOOP):f.setMode(we.LINE_STRIP)}else a.isPoints?f.setMode(we.POINTS):a.isSprite&&f.setMode(we.TRIANGLES);if(a.isBatchedMesh)if(null!==a._multiDrawInstances)TX("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),f.renderMultiDrawInstances(a._multiDrawStarts,a._multiDrawCounts,a._multiDrawCount,a._multiDrawInstances);else if(J.get("WEBGL_multi_draw"))f.renderMultiDraw(a._multiDrawStarts,a._multiDrawCounts,a._multiDrawCount);else{const e=a._multiDrawStarts,t=a._multiDrawCounts,n=a._multiDrawCount,i=l?ie.get(l).bytesPerElement:1,s=te.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)s.setValue(we,"_gl_DrawID",r),f.render(e[r]/i,t[r])}else if(a.isInstancedMesh)f.renderInstances(h,m,a.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);f.renderInstances(h,m,t)}else f.render(h,m)},this.compile=function(e,t,n=null){null===n&&(n=e),v=ue.get(n),v.init(t),w.push(v),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(v.pushLight(e),e.castShadow&&v.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(v.pushLight(e),e.castShadow&&v.pushShadow(e))}),v.setupLights();const r=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let a=0;a<t.length;a++){const i=t[a];ke(i,n,e),r.add(i)}else ke(t,n,e),r.add(t)}),v=w.pop(),r},this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise(t=>{function n(){r.forEach(function(e){te.get(e).currentProgram.isReady()&&r.delete(e)}),0!==r.size?setTimeout(n,10):t(e)}null!==J.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let Ee=null;function Te(){De.stop()}function Pe(){De.start()}const De=new P3;function Re(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)v.pushLight(e),e.castShadow&&v.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||H.intersectsSprite(e)){r&&Y.setFromMatrixPosition(e.matrixWorld).applyMatrix4($);const t=oe.update(e),a=e.material;a.visible&&y.push(e,t,a,n,Y.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||H.intersectsObject(e))){const t=oe.update(e),a=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),Y.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),Y.copy(t.boundingSphere.center)),Y.applyMatrix4(e.matrixWorld).applyMatrix4($)),Array.isArray(a)){const r=t.groups;for(let i=0,s=r.length;i<s;i++){const s=r[i],o=a[s.materialIndex];o&&o.visible&&y.push(e,t,o,n,Y.z,s)}}else a.visible&&y.push(e,t,a,n,Y.z,null)}const a=e.children;for(let i=0,s=a.length;i<s;i++)Re(a[i],t,n,r)}function Ie(e,t,n,r){const{opaque:a,transmissive:i,transparent:s}=e;v.setupLightsView(n),!0===G&&he.setGlobalState(N.clippingPlanes,n),r&&Z.viewport(k.copy(r)),a.length>0&&Be(a,t,n),i.length>0&&Be(i,t,n),s.length>0&&Be(s,t,n),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1)}function Oe(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===v.state.transmissionRenderTarget[r.id]&&(v.state.transmissionRenderTarget[r.id]=new pK(1,1,{generateMipmaps:!0,type:J.has("EXT_color_buffer_half_float")||J.has("EXT_color_buffer_float")?tY:XW,minFilter:WW,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:eK.workingColorSpace}));const i=v.state.transmissionRenderTarget[r.id],s=r.viewport||k;i.setSize(s.z*N.transmissionResolutionScale,s.w*N.transmissionResolutionScale);const o=N.getRenderTarget(),l=N.getActiveCubeFace(),c=N.getActiveMipmapLevel();N.setRenderTarget(i),N.getClearColor(P),D=N.getClearAlpha(),D<1&&N.setClearColor(16777215,.5),N.clear(),K&&me.render(n);const d=N.toneMapping;N.toneMapping=0;const u=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),v.setupLightsView(r),!0===G&&he.setGlobalState(N.clippingPlanes,r),Be(e,n,r),ne.updateMultisampleRenderTarget(i),ne.updateRenderTargetMipmap(i),!1===J.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let a=0,i=t.length;a<i;a++){const i=t[a],{object:s,geometry:o,material:l,group:c}=i;if(2===l.side&&s.layers.test(r.layers)){const t=l.side;l.side=nW,l.needsUpdate=!0,Le(s,n,r,o,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(ne.updateMultisampleRenderTarget(i),ne.updateRenderTargetMipmap(i))}N.setRenderTarget(o,l,c),N.setClearColor(P,D),void 0!==u&&(r.viewport=u),N.toneMapping=d}function Be(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let a=0,i=e.length;a<i;a++){const i=e[a],{object:s,geometry:o,group:l}=i;let c=i.material;!0===c.allowOverride&&null!==r&&(c=r),s.layers.test(n.layers)&&Le(s,t,n,o,c,l)}}function Le(e,t,n,r,a,i){e.onBeforeRender(N,t,n,r,a,i),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),a.onBeforeRender(N,t,n,r,e,i),!0===a.transparent&&2===a.side&&!1===a.forceSinglePass?(a.side=nW,a.needsUpdate=!0,N.renderBufferDirect(n,t,r,a,e,i),a.side=0,a.needsUpdate=!0,N.renderBufferDirect(n,t,r,a,e,i),a.side=2):N.renderBufferDirect(n,t,r,a,e,i),e.onAfterRender(N,t,n,r,a,i)}function Fe(e,t,n){!0!==t.isScene&&(t=X);const r=te.get(e),a=v.state.lights,i=v.state.shadowsArray,s=a.state.version,o=le.getParameters(e,a.state,i,t,n),l=le.getProgramCacheKey(o);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ae:re).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Me),c=new Map,r.programs=c);let d=c.get(l);if(void 0!==d){if(r.currentProgram===d&&r.lightsStateVersion===s)return ze(e,o),d}else o.uniforms=le.getUniforms(e),e.onBeforeCompile(o,N),d=le.acquireProgram(o,l),c.set(l,d),r.uniforms=o.uniforms;const u=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(u.clippingPlanes=he.uniform),ze(e,o),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(u.ambientLightColor.value=a.state.ambient,u.lightProbe.value=a.state.probe,u.directionalLights.value=a.state.directional,u.directionalLightShadows.value=a.state.directionalShadow,u.spotLights.value=a.state.spot,u.spotLightShadows.value=a.state.spotShadow,u.rectAreaLights.value=a.state.rectArea,u.ltc_1.value=a.state.rectAreaLTC1,u.ltc_2.value=a.state.rectAreaLTC2,u.pointLights.value=a.state.point,u.pointLightShadows.value=a.state.pointShadow,u.hemisphereLights.value=a.state.hemi,u.directionalShadowMap.value=a.state.directionalShadowMap,u.directionalShadowMatrix.value=a.state.directionalShadowMatrix,u.spotShadowMap.value=a.state.spotShadowMap,u.spotLightMatrix.value=a.state.spotLightMatrix,u.spotLightMap.value=a.state.spotLightMap,u.pointShadowMap.value=a.state.pointShadowMap,u.pointShadowMatrix.value=a.state.pointShadowMatrix),r.currentProgram=d,r.uniformsList=null,d}function Ue(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=y5.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function ze(e,t){const n=te.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}De.setAnimationLoop(function(e){Ee&&Ee(e)}),"undefined"!=typeof self&&De.setContext(self),this.setAnimationLoop=function(e){Ee=e,je.setAnimationLoop(e),null===e?De.stop():De.start()},je.addEventListener("sessionstart",Te),je.addEventListener("sessionend",Pe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void EX("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===S)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===je.enabled&&!0===je.isPresenting&&(!0===je.cameraAutoUpdate&&je.updateCamera(t),t=je.getCamera()),!0===e.isScene&&e.onBeforeRender(N,e,t,A),v=ue.get(e,w.length),v.init(t),w.push(v),$.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),H.setFromProjectionMatrix($,vX,t.reversedDepth),V=this.localClippingEnabled,G=he.init(this.clippingPlanes,V),y=de.get(e,b.length),y.init(),b.push(y),!0===je.enabled&&!0===je.isPresenting){const e=N.xr.getDepthSensingMesh();null!==e&&Re(e,t,-1/0,N.sortObjects)}Re(e,t,0,N.sortObjects),y.finish(),!0===N.sortObjects&&y.sort(B,L),K=!1===je.enabled||!1===je.isPresenting||!1===je.hasDepthSensing(),K&&me.addToRenderList(y,e),this.info.render.frame++,!0===G&&he.beginShadows();const n=v.state.shadowsArray;pe.render(n,e,t),!0===G&&he.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=y.opaque,a=y.transmissive;if(v.setupLights(),t.isArrayCamera){const n=t.cameras;if(a.length>0)for(let t=0,i=n.length;t<i;t++){Oe(r,a,e,n[t])}K&&me.render(e);for(let t=0,r=n.length;t<r;t++){const r=n[t];Ie(y,e,r,r.viewport)}}else a.length>0&&Oe(r,a,e,t),K&&me.render(e),Ie(y,e,t);null!==A&&0===_&&(ne.updateMultisampleRenderTarget(A),ne.updateRenderTargetMipmap(A)),!0===e.isScene&&e.onAfterRender(N,e,t),ve.resetDefaultState(),C=-1,M=null,w.pop(),w.length>0?(v=w[w.length-1],!0===G&&he.setGlobalState(N.clippingPlanes,v.state.camera)):v=null,b.pop(),y=b.length>0?b[b.length-1]:null},this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(e,t,n){const r=te.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),te.get(e.texture).__webglTexture=t,te.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=te.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const He=we.createFramebuffer();this.setRenderTarget=function(e,t=0,n=0){A=e,j=t,_=n;let r=!0,a=null,i=!1,s=!1;if(e){const o=te.get(e);if(void 0!==o.__useDefaultFramebuffer)Z.bindFramebuffer(we.FRAMEBUFFER,null),r=!1;else if(void 0===o.__webglFramebuffer)ne.setupRenderTarget(e);else if(o.__hasExternalTextures)ne.rebindTextures(e,te.get(e.texture).__webglTexture,te.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(o.__boundDepthTexture!==t){if(null!==t&&te.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ne.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(s=!0);const c=te.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(a=Array.isArray(c[t])?c[t][n]:c[t],i=!0):a=e.samples>0&&!1===ne.useMultisampledRTT(e)?te.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,k.copy(e.viewport),E.copy(e.scissor),T=e.scissorTest}else k.copy(F).multiplyScalar(O).floor(),E.copy(U).multiplyScalar(O).floor(),T=z;0!==n&&(a=He);if(Z.bindFramebuffer(we.FRAMEBUFFER,a)&&r&&Z.drawBuffers(e,a),Z.viewport(k),Z.scissor(E),Z.setScissorTest(T),i){const r=te.get(e.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(s){const r=t;for(let t=0;t<e.textures.length;t++){const a=te.get(e.textures[t]);we.framebufferTextureLayer(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0+t,a.__webglTexture,n,r)}}else if(null!==e&&0!==n){const t=te.get(e.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,t.__webglTexture,n)}C=-1},this.readRenderTargetPixels=function(e,t,n,r,a,i,s,o=0){if(!e||!e.isWebGLRenderTarget)return void EX("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=te.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){Z.bindFramebuffer(we.FRAMEBUFFER,l);try{const s=e.textures[o],l=s.format,c=s.type;if(!Q.textureFormatReadable(l))return void EX("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Q.textureTypeReadable(c))return void EX("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-a&&(e.textures.length>1&&we.readBuffer(we.COLOR_ATTACHMENT0+o),we.readPixels(t,n,r,a,ye.convert(l),ye.convert(c),i))}finally{const e=null!==A?te.get(A).__webglFramebuffer:null;Z.bindFramebuffer(we.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=function(e,t,n,r,a,i,s,o=0){return h(this,null,function*(){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=te.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-a){Z.bindFramebuffer(we.FRAMEBUFFER,l);const s=e.textures[o],c=s.format,d=s.type;if(!Q.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Q.textureTypeReadable(d))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const u=we.createBuffer();we.bindBuffer(we.PIXEL_PACK_BUFFER,u),we.bufferData(we.PIXEL_PACK_BUFFER,i.byteLength,we.STREAM_READ),e.textures.length>1&&we.readBuffer(we.COLOR_ATTACHMENT0+o),we.readPixels(t,n,r,a,ye.convert(c),ye.convert(d),0);const h=null!==A?te.get(A).__webglFramebuffer:null;Z.bindFramebuffer(we.FRAMEBUFFER,h);const p=we.fenceSync(we.SYNC_GPU_COMMANDS_COMPLETE,0);return we.flush(),yield function(e,t,n){return new Promise(function(r,a){setTimeout(function i(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:a();break;case e.TIMEOUT_EXPIRED:setTimeout(i,n);break;default:r()}},n)})}(we,p,4),we.bindBuffer(we.PIXEL_PACK_BUFFER,u),we.getBufferSubData(we.PIXEL_PACK_BUFFER,0,i),we.deleteBuffer(u),we.deleteSync(p),i}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}})},this.copyFramebufferToTexture=function(e,t=null,n=0){const r=Math.pow(2,-n),a=Math.floor(e.image.width*r),i=Math.floor(e.image.height*r),s=null!==t?t.x:0,o=null!==t?t.y:0;ne.setTexture2D(e,0),we.copyTexSubImage2D(we.TEXTURE_2D,n,0,0,s,o,a,i),Z.unbindTexture()};const Ge=we.createFramebuffer(),Ve=we.createFramebuffer();this.copyTextureToTexture=function(e,t,n=null,r=null,a=0,i=null){let s,o,l,c,d,u,h,p,m;null===i&&(0!==a?(TX("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),i=a,a=0):i=0);const g=e.isCompressedTexture?e.mipmaps[i]:e.image;if(null!==n)s=n.max.x-n.min.x,o=n.max.y-n.min.y,l=n.isBox3?n.max.z-n.min.z:1,c=n.min.x,d=n.min.y,u=n.isBox3?n.min.z:0;else{const t=Math.pow(2,-a);s=Math.floor(g.width*t),o=Math.floor(g.height*t),l=e.isDataArrayTexture?g.depth:e.isData3DTexture?Math.floor(g.depth*t):1,c=0,d=0,u=0}null!==r?(h=r.x,p=r.y,m=r.z):(h=0,p=0,m=0);const f=ye.convert(t.format),x=ye.convert(t.type);let y;t.isData3DTexture?(ne.setTexture3D(t,0),y=we.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(ne.setTexture2DArray(t,0),y=we.TEXTURE_2D_ARRAY):(ne.setTexture2D(t,0),y=we.TEXTURE_2D),we.pixelStorei(we.UNPACK_FLIP_Y_WEBGL,t.flipY),we.pixelStorei(we.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),we.pixelStorei(we.UNPACK_ALIGNMENT,t.unpackAlignment);const v=we.getParameter(we.UNPACK_ROW_LENGTH),b=we.getParameter(we.UNPACK_IMAGE_HEIGHT),w=we.getParameter(we.UNPACK_SKIP_PIXELS),N=we.getParameter(we.UNPACK_SKIP_ROWS),S=we.getParameter(we.UNPACK_SKIP_IMAGES);we.pixelStorei(we.UNPACK_ROW_LENGTH,g.width),we.pixelStorei(we.UNPACK_IMAGE_HEIGHT,g.height),we.pixelStorei(we.UNPACK_SKIP_PIXELS,c),we.pixelStorei(we.UNPACK_SKIP_ROWS,d),we.pixelStorei(we.UNPACK_SKIP_IMAGES,u);const j=e.isDataArrayTexture||e.isData3DTexture,_=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const n=te.get(e),r=te.get(t),g=te.get(n.__renderTarget),f=te.get(r.__renderTarget);Z.bindFramebuffer(we.READ_FRAMEBUFFER,g.__webglFramebuffer),Z.bindFramebuffer(we.DRAW_FRAMEBUFFER,f.__webglFramebuffer);for(let x=0;x<l;x++)j&&(we.framebufferTextureLayer(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,te.get(e).__webglTexture,a,u+x),we.framebufferTextureLayer(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,te.get(t).__webglTexture,i,m+x)),we.blitFramebuffer(c,d,s,o,h,p,s,o,we.DEPTH_BUFFER_BIT,we.NEAREST);Z.bindFramebuffer(we.READ_FRAMEBUFFER,null),Z.bindFramebuffer(we.DRAW_FRAMEBUFFER,null)}else if(0!==a||e.isRenderTargetTexture||te.has(e)){const n=te.get(e),r=te.get(t);Z.bindFramebuffer(we.READ_FRAMEBUFFER,Ge),Z.bindFramebuffer(we.DRAW_FRAMEBUFFER,Ve);for(let e=0;e<l;e++)j?we.framebufferTextureLayer(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,n.__webglTexture,a,u+e):we.framebufferTexture2D(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,n.__webglTexture,a),_?we.framebufferTextureLayer(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,r.__webglTexture,i,m+e):we.framebufferTexture2D(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,r.__webglTexture,i),0!==a?we.blitFramebuffer(c,d,s,o,h,p,s,o,we.COLOR_BUFFER_BIT,we.NEAREST):_?we.copyTexSubImage3D(y,i,h,p,m+e,c,d,s,o):we.copyTexSubImage2D(y,i,h,p,c,d,s,o);Z.bindFramebuffer(we.READ_FRAMEBUFFER,null),Z.bindFramebuffer(we.DRAW_FRAMEBUFFER,null)}else _?e.isDataTexture||e.isData3DTexture?we.texSubImage3D(y,i,h,p,m,s,o,l,f,x,g.data):t.isCompressedArrayTexture?we.compressedTexSubImage3D(y,i,h,p,m,s,o,l,f,g.data):we.texSubImage3D(y,i,h,p,m,s,o,l,f,x,g):e.isDataTexture?we.texSubImage2D(we.TEXTURE_2D,i,h,p,s,o,f,x,g.data):e.isCompressedTexture?we.compressedTexSubImage2D(we.TEXTURE_2D,i,h,p,g.width,g.height,f,g.data):we.texSubImage2D(we.TEXTURE_2D,i,h,p,s,o,f,x,g);we.pixelStorei(we.UNPACK_ROW_LENGTH,v),we.pixelStorei(we.UNPACK_IMAGE_HEIGHT,b),we.pixelStorei(we.UNPACK_SKIP_PIXELS,w),we.pixelStorei(we.UNPACK_SKIP_ROWS,N),we.pixelStorei(we.UNPACK_SKIP_IMAGES,S),0===i&&t.generateMipmaps&&we.generateMipmap(y),Z.unbindTexture()},this.initRenderTarget=function(e){void 0===te.get(e).__webglFramebuffer&&ne.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?ne.setTextureCube(e,0):e.isData3DTexture?ne.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ne.setTexture2DArray(e,0):ne.setTexture2D(e,0),Z.unbindTexture()},this.resetState=function(){j=0,_=0,A=null,Z.reset(),ve.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return vX}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=eK._getDrawingBufferColorSpace(e),t.unpackColorSpace=eK._getUnpackColorSpace()}}const m6=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:4,AddEquation:aW,AddOperation:2,AdditiveAnimationBlendMode:nX,AdditiveBlending:2,AgXToneMapping:6,AlphaFormat:oY,AlwaysCompare:519,AlwaysDepth:1,AlwaysStencilFunc:519,AmbientLight:d2,AnimationAction:X2,AnimationClip:R1,AnimationLoader:class extends F1{constructor(e){super(e)}load(e,t,n,r){const a=this,i=new H1(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(n){try{t(a.parse(JSON.parse(n)))}catch(bI){r?r(bI):EX(bI),a.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=R1.parse(e[n]);t.push(r)}return t}},AnimationMixer:class extends PX{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,a=r.length,i=e._propertyBindings,s=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let c=l[o];void 0===c&&(c={},l[o]=c);for(let d=0;d!==a;++d){const e=r[d],a=e.name;let l=c[a];if(void 0!==l)++l.referenceCount,i[d]=l;else{if(l=i[d],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,a));continue}const r=t&&t._propertyBindings[d].binding.parsedPath;l=new U2(Y2.create(n,a,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,a),i[d]=l}s[d].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,a=this._actionsByClip;let i=a[t];if(void 0===i)i={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=i;else{const t=i.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),i.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const a=e._clip.uuid,i=this._actionsByClip,s=i[a],o=s.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;delete s.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete i[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,a=this._bindings;let i=r[t];void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,a=n.path,i=this._bindingsByRootAndName,s=i[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[a],0===Object.keys(s).length&&delete i[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new j1(new Float32Array(2),new Float32Array(2),1,K2),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,a=t[r];e.__cacheIndex=r,t[r]=e,a.__cacheIndex=n,t[n]=a}clipAction(e,t,n){const r=t||this._root,a=r.uuid;let i="string"==typeof e?R1.findByName(r,e):e;const s=null!==i?i.uuid:e,o=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==i?i.blendMode:tX),void 0!==o){const e=o.actionByRoot[a];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===i&&(i=l._clip)}if(null===i)return null;const c=new X2(this,i,t,n);return this._bindAction(c,l),this._addInactiveAction(c,s,a),c}existingAction(e,t){const n=t||this._root,r=n.uuid,a="string"==typeof e?R1.findByName(n,e):e,i=a?a.uuid:e,s=this._actionsByClip[i];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,a=Math.sign(e),i=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(r,e,a,i)}const s=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)s[l].apply(i);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,a=r[n];if(void 0!==a){const e=a.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const a=r._cacheIndex,i=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,i._cacheIndex=a,t[a]=i,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const e=n[a].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const a in r){const e=r[a];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},AnimationObjectGroup:class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=BX(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,a=this._bindings,i=a.length;let s,o=e.length,l=this.nCachedObjects_;for(let c=0,d=arguments.length;c!==d;++c){const d=arguments[c],u=d.uuid;let h=t[u];if(void 0===h){h=o++,t[u]=h,e.push(d);for(let e=0,t=i;e!==t;++e)a[e].push(new Y2(d,n[e],r[e]))}else if(h<l){s=e[h];const o=--l,c=e[o];t[c.uuid]=h,e[h]=c,t[u]=o,e[o]=d;for(let e=0,t=i;e!==t;++e){const t=a[e],i=t[o];let s=t[h];t[h]=i,void 0===s&&(s=new Y2(d,n[e],r[e])),t[o]=s}}else e[h]!==s&&EX("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let a=this.nCachedObjects_;for(let i=0,s=arguments.length;i!==s;++i){const s=arguments[i],o=s.uuid,l=t[o];if(void 0!==l&&l>=a){const i=a++,c=e[i];t[c.uuid]=l,e[l]=c,t[o]=i,e[i]=s;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[i],a=t[l];t[l]=r,t[i]=a}}}this.nCachedObjects_=a}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let a=this.nCachedObjects_,i=e.length;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s].uuid,l=t[o];if(void 0!==l)if(delete t[o],l<a){const s=--a,o=e[s],c=--i,d=e[c];t[o.uuid]=l,e[l]=o,t[d.uuid]=s,e[s]=d,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[s],a=t[c];t[l]=r,t[s]=a,t.pop()}}else{const a=--i,s=e[a];a>0&&(t[s.uuid]=l),e[l]=s,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[a],t.pop()}}}this.nCachedObjects_=a}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const a=this._bindings;if(void 0!==r)return a[r];const i=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,d=new Array(l);r=a.length,n[e]=r,i.push(e),s.push(t),a.push(d);for(let u=c,h=o.length;u!==h;++u){const n=o[u];d[u]=new Y2(n,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,a=this._parsedPaths,i=this._bindings,s=i.length-1,o=i[s];t[e[s]]=n,i[n]=o,i.pop(),a[n]=a[s],a.pop(),r[n]=r[s],r.pop()}}},AnimationUtils:class{static convertArray(e,t){return x1(e,t)}static isTypedArray(e){return y1(e)}static getKeyframeOrder(e){return v1(e)}static sortedArray(e,t,n){return b1(e,t,n)}static flattenJSON(e,t,n,r){w1(e,t,n,r)}static subclip(e,t,n,r,a=30){return function(e,t,n,r,a=30){const i=e.clone();i.name=t;const s=[];for(let l=0;l<i.tracks.length;++l){const e=i.tracks[l],t=e.getValueSize(),o=[],c=[];for(let i=0;i<e.times.length;++i){const s=e.times[i]*a;if(!(s<n||s>=r)){o.push(e.times[i]);for(let n=0;n<t;++n)c.push(e.values[i*t+n])}}0!==o.length&&(e.times=x1(o,e.times.constructor),e.values=x1(c,e.values.constructor),s.push(e))}i.tracks=s;let o=1/0;for(let l=0;l<i.tracks.length;++l)o>i.tracks[l].times[0]&&(o=i.tracks[l].times[0]);for(let l=0;l<i.tracks.length;++l)i.tracks[l].shift(-1*o);return i.resetDuration(),i}(e,t,n,r,a)}static makeClipAdditive(e,t=0,n=e,r=30){return function(e,t=0,n=e,r=30){r<=0&&(r=30);const a=n.tracks.length,i=t/r;for(let s=0;s<a;++s){const t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)continue;const a=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===r});if(void 0===a)continue;let o=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);let c=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=d/3);const u=t.times.length-1;let h;if(i<=t.times[0]){const e=o,n=l-o;h=t.values.slice(e,n)}else if(i>=t.times[u]){const e=u*l+o,n=e+l-o;h=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=o,r=l-o;e.evaluate(i),h=e.resultBuffer.slice(n,r)}"quaternion"===r&&(new $X).fromArray(h).normalize().conjugate().toArray(h);const p=a.times.length;for(let e=0;e<p;++e){const t=e*d+c;if("quaternion"===r)$X.multiplyQuaternionsFlat(a.values,t,h,0,a.values,t);else{const e=d-2*c;for(let n=0;n<e;++n)a.values[t+n]-=h[n]}}}return e.blendMode=nX,e}(e,t,n,r)}},ArcCurve:WZ,ArrayCamera:M2,ArrowHelper:class extends fq{constructor(e=new WX(0,0,1),t=new WX(0,0,0),n=1,r=16776960,a=.2*n,i=.2*a){super(),this.type="ArrowHelper",void 0===k3&&(k3=new iJ,k3.setAttribute("position",new Jq([0,0,0,0,1,0],3)),E3=new OZ(.5,1,5,1),E3.translate(0,-.5,0)),this.position.copy(t),this.line=new fZ(k3,new lZ({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new xJ(E3,new Fq({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,a,i)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{M3.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(M3,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},AttachedBindMode:EW,Audio:I2,AudioAnalyser:class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}},AudioContext:j2,AudioListener:class extends fq{constructor(){super(),this.type="AudioListener",this.context=j2.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new k2}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(E2,T2,P2),D2.set(0,0,-1).applyQuaternion(T2),R2.set(0,1,0).applyQuaternion(T2),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(E2.x,e),t.positionY.linearRampToValueAtTime(E2.y,e),t.positionZ.linearRampToValueAtTime(E2.z,e),t.forwardX.linearRampToValueAtTime(D2.x,e),t.forwardY.linearRampToValueAtTime(D2.y,e),t.forwardZ.linearRampToValueAtTime(D2.z,e),t.upX.linearRampToValueAtTime(R2.x,e),t.upY.linearRampToValueAtTime(R2.y,e),t.upZ.linearRampToValueAtTime(R2.z,e)}else t.setPosition(E2.x,E2.y,E2.z),t.setOrientation(D2.x,D2.y,D2.z,R2.x,R2.y,R2.z)}},AudioLoader:class extends F1{constructor(e){super(e)}load(e,t,n,r){const a=this,i=new H1(this.manager);function s(t){r?r(t):EX(t),a.manager.itemError(e)}i.setResponseType("arraybuffer"),i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(e){try{const n=e.slice(0);j2.getContext().decodeAudioData(n,function(e){t(e)}).catch(s)}catch(bI){s(bI)}},n,r)}},AxesHelper:class extends bZ{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new iJ;n.setAttribute("position",new Jq(t,3)),n.setAttribute("color",new Jq([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new lZ({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Iq,a=this.geometry.attributes.color.array;return r.set(e),r.toArray(a,0),r.toArray(a,3),r.set(t),r.toArray(a,6),r.toArray(a,9),r.set(n),r.toArray(a,12),r.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BackSide:nW,BasicDepthPacking:3200,BasicShadowMap:0,BatchedMesh:oZ,Bone:yQ,BooleanKeyframeTrack:C1,Box2:class{constructor(e=new VX(1/0,1/0),t=new VX(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=i3.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,i3).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Box3:fK,Box3Helper:class extends bZ{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new iJ;r.setIndex(new Xq(n,1)),r.setAttribute("position",new Jq([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new lZ({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},BoxGeometry:vJ,BoxHelper:class extends bZ{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),a=new iJ;a.setIndex(new Xq(n,1)),a.setAttribute("position",new Xq(r,3)),super(a,new lZ({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&C3.setFromObject(this.object),C3.isEmpty())return;const e=C3.min,t=C3.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BufferAttribute:Xq,BufferGeometry:iJ,BufferGeometryLoader:x2,ByteType:KW,Cache:O1,Camera:_J,CameraHelper:class extends bZ{constructor(e){const t=new iJ,n=new lZ({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],a=[],i={};function s(e,t){o(e),o(t)}function o(e){r.push(0,0,0),a.push(0,0,0),void 0===i[e]&&(i[e]=[]),i[e].push(r.length/3-1)}s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4"),t.setAttribute("position",new Jq(r,3)),t.setAttribute("color",new Jq(a,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=i,this.update();const l=new Iq(16755200),c=new Iq(16711680),d=new Iq(43775),u=new Iq(16777215),h=new Iq(3355443);this.setColors(l,c,d,u,h)}setColors(e,t,n,r,a){const i=this.geometry.getAttribute("color");return i.setXYZ(0,e.r,e.g,e.b),i.setXYZ(1,e.r,e.g,e.b),i.setXYZ(2,e.r,e.g,e.b),i.setXYZ(3,e.r,e.g,e.b),i.setXYZ(4,e.r,e.g,e.b),i.setXYZ(5,e.r,e.g,e.b),i.setXYZ(6,e.r,e.g,e.b),i.setXYZ(7,e.r,e.g,e.b),i.setXYZ(8,e.r,e.g,e.b),i.setXYZ(9,e.r,e.g,e.b),i.setXYZ(10,e.r,e.g,e.b),i.setXYZ(11,e.r,e.g,e.b),i.setXYZ(12,e.r,e.g,e.b),i.setXYZ(13,e.r,e.g,e.b),i.setXYZ(14,e.r,e.g,e.b),i.setXYZ(15,e.r,e.g,e.b),i.setXYZ(16,e.r,e.g,e.b),i.setXYZ(17,e.r,e.g,e.b),i.setXYZ(18,e.r,e.g,e.b),i.setXYZ(19,e.r,e.g,e.b),i.setXYZ(20,e.r,e.g,e.b),i.setXYZ(21,e.r,e.g,e.b),i.setXYZ(22,e.r,e.g,e.b),i.setXYZ(23,e.r,e.g,e.b),i.setXYZ(24,t.r,t.g,t.b),i.setXYZ(25,t.r,t.g,t.b),i.setXYZ(26,t.r,t.g,t.b),i.setXYZ(27,t.r,t.g,t.b),i.setXYZ(28,t.r,t.g,t.b),i.setXYZ(29,t.r,t.g,t.b),i.setXYZ(30,t.r,t.g,t.b),i.setXYZ(31,t.r,t.g,t.b),i.setXYZ(32,n.r,n.g,n.b),i.setXYZ(33,n.r,n.g,n.b),i.setXYZ(34,n.r,n.g,n.b),i.setXYZ(35,n.r,n.g,n.b),i.setXYZ(36,n.r,n.g,n.b),i.setXYZ(37,n.r,n.g,n.b),i.setXYZ(38,r.r,r.g,r.b),i.setXYZ(39,r.r,r.g,r.b),i.setXYZ(40,a.r,a.g,a.b),i.setXYZ(41,a.r,a.g,a.b),i.setXYZ(42,a.r,a.g,a.b),i.setXYZ(43,a.r,a.g,a.b),i.setXYZ(44,a.r,a.g,a.b),i.setXYZ(45,a.r,a.g,a.b),i.setXYZ(46,a.r,a.g,a.b),i.setXYZ(47,a.r,a.g,a.b),i.setXYZ(48,a.r,a.g,a.b),i.setXYZ(49,a.r,a.g,a.b),i.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap;let n,r;if(_3.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),!0===this.camera.reversedDepth)n=1,r=0;else if(this.camera.coordinateSystem===vX)n=-1,r=1;else{if(this.camera.coordinateSystem!==bX)throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);n=0,r=1}A3("c",t,e,_3,0,0,n),A3("t",t,e,_3,0,0,r),A3("n1",t,e,_3,-1,-1,n),A3("n2",t,e,_3,1,-1,n),A3("n3",t,e,_3,-1,1,n),A3("n4",t,e,_3,1,1,n),A3("f1",t,e,_3,-1,-1,r),A3("f2",t,e,_3,1,-1,r),A3("f3",t,e,_3,-1,1,r),A3("f4",t,e,_3,1,1,r),A3("u1",t,e,_3,.7,1.1,n),A3("u2",t,e,_3,-.7,1.1,n),A3("u3",t,e,_3,0,2,n),A3("cf1",t,e,_3,-1,0,r),A3("cf2",t,e,_3,1,0,r),A3("cf3",t,e,_3,0,-1,r),A3("cf4",t,e,_3,0,1,r),A3("cn1",t,e,_3,-1,0,n),A3("cn2",t,e,_3,1,0,n),A3("cn3",t,e,_3,0,-1,n),A3("cn4",t,e,_3,0,1,n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},CanvasTexture:class extends dK{constructor(e,t,n,r,a,i,s,o,l){super(e,t,n,r,a,i,s,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},CapsuleGeometry:DZ,CatmullRomCurve3:QZ,CineonToneMapping:3,CircleGeometry:RZ,ClampToEdgeWrapping:FW,Clock:k2,Color:Iq,ColorKeyframeTrack:M1,ColorManagement:eK,CompressedArrayTexture:class extends EZ{constructor(e,t,n,r,a,i){super(e,t,n,a,i),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=FW,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},CompressedCubeTexture:class extends EZ{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,DW),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}},CompressedTexture:EZ,CompressedTextureLoader:class extends F1{constructor(e){super(e)}load(e,t,n,r){const a=this,i=[],s=new EZ,o=new H1(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(a.withCredentials);let l=0;function c(c){o.load(e[c],function(e){const n=a.parse(e,!0);i[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=VW),s.image=i,s.format=n.format,s.needsUpdate=!0,t&&t(s))},n,r)}if(Array.isArray(e))for(let d=0,u=e.length;d<u;++d)c(d);else o.load(e,function(e){const n=a.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){i[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)i[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),i[t].format=n.format,i[t].width=n.width,i[t].height=n.height}s.image=i}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=VW),s.format=n.format,s.needsUpdate=!0,t&&t(s)},n,r);return s}},ConeGeometry:OZ,ConstantAlphaFactor:213,ConstantColorFactor:211,Controls:class extends PX{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):kX("Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}},CubeCamera:TJ,CubeReflectionMapping:DW,CubeRefractionMapping:RW,CubeTexture:PJ,CubeTextureLoader:$1,CubeUVReflectionMapping:BW,CubicBezierCurve:n0,CubicBezierCurve3:r0,CubicInterpolant:S1,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,CullFaceNone:0,Curve:VZ,CurvePath:d0,CustomBlending:5,CustomToneMapping:5,CylinderGeometry:IZ,Cylindrical:class{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}},Data3DTexture:gK,DataArrayTexture:mK,DataTexture:vQ,DataTextureLoader:W1,DataUtils:Vq,DecrementStencilOp:7683,DecrementWrapStencilOp:34056,DefaultLoadingManager:L1,DepthFormat:dY,DepthStencilFormat:uY,DepthTexture:TZ,DetachedBindMode:TW,DirectionalLight:c2,DirectionalLightHelper:class extends fq{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new iJ;r.setAttribute("position",new Jq([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new lZ({fog:!1,toneMapped:!1});this.lightPlane=new fZ(r,a),this.add(this.lightPlane),r=new iJ,r.setAttribute("position",new Jq([0,0,0,0,0,1],3)),this.targetLine=new fZ(r,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),w3.setFromMatrixPosition(this.light.matrixWorld),N3.setFromMatrixPosition(this.light.target.matrixWorld),S3.subVectors(N3,w3),this.lightPlane.lookAt(N3),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(N3),this.targetLine.scale.z=S3.length()}},DiscreteInterpolant:_1,DodecahedronGeometry:LZ,DoubleSide:2,DstAlphaFactor:206,DstColorFactor:208,DynamicCopyUsage:35050,DynamicDrawUsage:35048,DynamicReadUsage:35049,EdgesGeometry:GZ,EllipseCurve:$Z,EqualCompare:514,EqualDepth:4,EqualStencilFunc:514,EquirectangularReflectionMapping:IW,EquirectangularRefractionMapping:OW,Euler:ZK,EventDispatcher:PX,ExternalTexture:PZ,ExtrudeGeometry:G0,FileLoader:H1,Float16BufferAttribute:class extends Xq{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Gq(this.array[e*this.itemSize]);return this.normalized&&(t=zX(t,this.array)),t}setX(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize]=Hq(t),this}getY(e){let t=Gq(this.array[e*this.itemSize+1]);return this.normalized&&(t=zX(t,this.array)),t}setY(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize+1]=Hq(t),this}getZ(e){let t=Gq(this.array[e*this.itemSize+2]);return this.normalized&&(t=zX(t,this.array)),t}setZ(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize+2]=Hq(t),this}getW(e){let t=Gq(this.array[e*this.itemSize+3]);return this.normalized&&(t=zX(t,this.array)),t}setW(e,t){return this.normalized&&(t=HX(t,this.array)),this.array[e*this.itemSize+3]=Hq(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array)),this.array[e+0]=Hq(t),this.array[e+1]=Hq(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array),r=HX(r,this.array)),this.array[e+0]=Hq(t),this.array[e+1]=Hq(n),this.array[e+2]=Hq(r),this}setXYZW(e,t,n,r,a){return e*=this.itemSize,this.normalized&&(t=HX(t,this.array),n=HX(n,this.array),r=HX(r,this.array),a=HX(a,this.array)),this.array[e+0]=Hq(t),this.array[e+1]=Hq(n),this.array[e+2]=Hq(r),this.array[e+3]=Hq(a),this}},Float32BufferAttribute:Jq,FloatType:eY,Fog:LJ,FogExp2:BJ,FramebufferTexture:class extends dK{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=zW,this.minFilter=zW,this.generateMipmaps=!1,this.needsUpdate=!0}},FrontSide:0,Frustum:FQ,FrustumArray:HQ,GLBufferAttribute:class{constructor(e,t,n,r,a,i=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=a,this.normalized=i,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},GLSL1:"100",GLSL3:yX,GreaterCompare:516,GreaterDepth:6,GreaterEqualCompare:518,GreaterEqualDepth:5,GreaterEqualStencilFunc:518,GreaterStencilFunc:516,GridHelper:class extends bZ{constructor(e=10,t=10,n=4473924,r=8947848){n=new Iq(n),r=new Iq(r);const a=t/2,i=e/t,s=e/2,o=[],l=[];for(let d=0,u=0,h=-s;d<=t;d++,h+=i){o.push(-s,0,h,s,0,h),o.push(h,0,-s,h,0,s);const e=d===a?n:r;e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3}const c=new iJ;c.setAttribute("position",new Jq(o,3)),c.setAttribute("color",new Jq(l,3));super(c,new lZ({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},Group:RJ,HalfFloatType:tY,HemisphereLight:K1,HemisphereLightHelper:class extends fq{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Y0(t);r.rotateY(.5*Math.PI),this.material=new Fq({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const a=r.getAttribute("position"),i=new Float32Array(3*a.count);r.setAttribute("color",new Xq(i,3)),this.add(new xJ(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");v3.copy(this.light.color),b3.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?v3:b3;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(y3.setFromMatrixPosition(this.light.matrixWorld).negate())}},IcosahedronGeometry:$0,ImageBitmapLoader:N2,ImageLoader:V1,ImageUtils:aK,IncrementStencilOp:7682,IncrementWrapStencilOp:34055,InstancedBufferAttribute:SQ,InstancedBufferGeometry:f2,InstancedInterleavedBuffer:class extends UJ{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}},InstancedMesh:TQ,Int16BufferAttribute:class extends Xq{constructor(e,t,n){super(new Int16Array(e),t,n)}},Int32BufferAttribute:class extends Xq{constructor(e,t,n){super(new Int32Array(e),t,n)}},Int8BufferAttribute:class extends Xq{constructor(e,t,n){super(new Int8Array(e),t,n)}},IntType:QW,InterleavedBuffer:UJ,InterleavedBufferAttribute:HJ,Interpolant:N1,InterpolateDiscrete:KY,InterpolateLinear:qY,InterpolateSmooth:JY,InterpolationSamplingMode:{NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"},InterpolationSamplingType:{PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},InvertStencilOp:5386,KeepStencilOp:lX,KeyframeTrack:A1,LOD:oQ,LatheGeometry:W0,Layers:eq,LessCompare:513,LessDepth:2,LessEqualCompare:515,LessEqualDepth:3,LessEqualStencilFunc:515,LessStencilFunc:513,Light:X1,LightProbe:p2,Line:fZ,Line3:class{constructor(e=new WX,t=new WX){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){s3.subVectors(e,this.start),o3.subVectors(this.end,this.start);const n=o3.dot(o3);let r=o3.dot(s3)/n;return t&&(r=LX(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=u3,n=h3){const r=1e-8*1e-8;let a,i;const s=this.start,o=e.start,l=this.end,c=e.end;l3.subVectors(l,s),c3.subVectors(c,o),d3.subVectors(s,o);const d=l3.dot(l3),u=c3.dot(c3),h=c3.dot(d3);if(d<=r&&u<=r)return t.copy(s),n.copy(o),t.sub(n),t.dot(t);if(d<=r)a=0,i=h/u,i=LX(i,0,1);else{const e=l3.dot(d3);if(u<=r)i=0,a=LX(-e/d,0,1);else{const t=l3.dot(c3),n=d*u-t*t;a=0!==n?LX((t*h-e*u)/n,0,1):0,i=(t*a+h)/u,i<0?(i=0,a=LX(-e/d,0,1)):i>1&&(i=1,a=LX((t-e)/d,0,1))}}return t.copy(s).add(l3.multiplyScalar(a)),n.copy(o).add(c3.multiplyScalar(i)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},LineBasicMaterial:lZ,LineCurve:a0,LineCurve3:i0,LineDashedMaterial:f1,LineLoop:wZ,LineSegments:bZ,LinearFilter:VW,LinearInterpolant:j1,LinearMipMapLinearFilter:YW,LinearMipMapNearestFilter:1007,LinearMipmapLinearFilter:WW,LinearMipmapNearestFilter:$W,LinearSRGBColorSpace:iX,LinearToneMapping:1,LinearTransfer:sX,Loader:F1,LoaderUtils:g2,LoadingManager:B1,LoopOnce:2200,LoopPingPong:2202,LoopRepeat:2201,MOUSE:Z$,Material:Lq,MaterialLoader:m2,MathUtils:GX,Matrix2:a3,Matrix3:KX,Matrix4:GK,MaxEquation:104,Mesh:xJ,MeshBasicMaterial:Fq,MeshDepthMaterial:p1,MeshDistanceMaterial:m1,MeshLambertMaterial:h1,MeshMatcapMaterial:g1,MeshNormalMaterial:u1,MeshPhongMaterial:c1,MeshPhysicalMaterial:l1,MeshStandardMaterial:o1,MeshToonMaterial:d1,MinEquation:103,MirroredRepeatWrapping:UW,MixOperation:1,MultiplyBlending:4,MultiplyOperation:0,NearestFilter:zW,NearestMipMapLinearFilter:1005,NearestMipMapNearestFilter:1004,NearestMipmapLinearFilter:GW,NearestMipmapNearestFilter:HW,NeutralToneMapping:7,NeverCompare:512,NeverDepth:0,NeverStencilFunc:512,NoBlending:0,NoColorSpace:rX,NoToneMapping:0,NormalAnimationBlendMode:tX,NormalBlending:1,NotEqualCompare:517,NotEqualDepth:7,NotEqualStencilFunc:517,NumberKeyframeTrack:k1,Object3D:fq,ObjectLoader:class extends F1{constructor(e){super(e)}load(e,t,n,r){const a=this,i=""===this.path?g2.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new H1(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){let i=null;try{i=JSON.parse(n)}catch(o){return void 0!==r&&r(o),void o("ObjectLoader: Can't parse "+e+".",o.message)}const s=i.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void EX("ObjectLoader: Can't load "+e);a.parse(i,t)},n,r)}loadAsync(e,t){return h(this,null,function*(){const n=""===this.path?g2.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new H1(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const a=yield r.loadAsync(e,t),i=JSON.parse(a),s=i.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield this.parseAsync(i)})}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,function(){void 0!==t&&t(l)}),s=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,a,o,s,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(const t in i)if(i[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}parseAsync(e){return h(this,null,function*(){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),a=yield this.parseImagesAsync(e.images),i=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,i),o=this.parseObject(e.object,r,s,i,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),this.bindLightTargets(o),o})}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new h0).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(e){e.isBone&&(r[e.uuid]=e)}),void 0!==e)for(let a=0,i=e.length;a<i;a++){const t=(new NQ).fromJSON(e[a],r);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new x2;for(let a=0,i=e.length;a<i;a++){let i;const s=e[a];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":i=r.parse(s);break;default:s.type in a1?i=a1[s.type].fromJSON(s,t):kX(`ObjectLoader: Unsupported geometry type "${s.type}"`)}i.uuid=s.uuid,void 0!==s.name&&(i.name=s.name),void 0!==s.userData&&(i.userData=s.userData),n[s.uuid]=i}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const a=new m2;a.setTextures(t);for(let t=0,i=e.length;t<i;t++){const i=e[t];void 0===n[i.uuid]&&(n[i.uuid]=a.parse(i)),r[i.uuid]=n[i.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],a=R1.parse(r);t[a.uuid]=a}return t}parseImages(e,t){const n=this,r={};let a;function i(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),a.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:SX(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new B1(t);a=new V1(n),a.setCrossOrigin(this.crossOrigin);for(let t=0,a=e.length;t<a;t++){const n=e[t],a=n.url;if(Array.isArray(a)){const e=[];for(let t=0,n=a.length;t<n;t++){const n=i(a[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new vQ(n.data,n.width,n.height)))}r[n.uuid]=new sK(e)}else{const e=i(n.url);r[n.uuid]=new sK(e)}}}return r}parseImagesAsync(e){return h(this,null,function*(){const t=this,n={};let r;function a(e){return h(this,null,function*(){if("string"==typeof e){const n=e,a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return yield r.loadAsync(a)}return e.data?{data:SX(e.type,e.data),width:e.width,height:e.height}:null})}if(void 0!==e&&e.length>0){r=new V1(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],i=r.url;if(Array.isArray(i)){const e=[];for(let t=0,n=i.length;t<n;t++){const n=i[t],r=yield a(n);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new vQ(r.data,r.width,r.height)))}n[r.uuid]=new sK(e)}else{const e=yield a(r.url);n[r.uuid]=new sK(e)}}}return n})}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:(kX("ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let a=0,i=e.length;a<i;a++){const i=e[a];void 0===i.image&&kX('ObjectLoader: No "image" specified for',i.uuid),void 0===t[i.image]&&kX("ObjectLoader: Undefined image",i.image);const s=t[i.image],o=s.data;let l;Array.isArray(o)?(l=new PJ,6===o.length&&(l.needsUpdate=!0)):(l=o&&o.data?new vQ:new dK,o&&(l.needsUpdate=!0)),l.source=s,l.uuid=i.uuid,void 0!==i.name&&(l.name=i.name),void 0!==i.mapping&&(l.mapping=n(i.mapping,y2)),void 0!==i.channel&&(l.channel=i.channel),void 0!==i.offset&&l.offset.fromArray(i.offset),void 0!==i.repeat&&l.repeat.fromArray(i.repeat),void 0!==i.center&&l.center.fromArray(i.center),void 0!==i.rotation&&(l.rotation=i.rotation),void 0!==i.wrap&&(l.wrapS=n(i.wrap[0],v2),l.wrapT=n(i.wrap[1],v2)),void 0!==i.format&&(l.format=i.format),void 0!==i.internalFormat&&(l.internalFormat=i.internalFormat),void 0!==i.type&&(l.type=i.type),void 0!==i.colorSpace&&(l.colorSpace=i.colorSpace),void 0!==i.minFilter&&(l.minFilter=n(i.minFilter,b2)),void 0!==i.magFilter&&(l.magFilter=n(i.magFilter,b2)),void 0!==i.anisotropy&&(l.anisotropy=i.anisotropy),void 0!==i.flipY&&(l.flipY=i.flipY),void 0!==i.generateMipmaps&&(l.generateMipmaps=i.generateMipmaps),void 0!==i.premultiplyAlpha&&(l.premultiplyAlpha=i.premultiplyAlpha),void 0!==i.unpackAlignment&&(l.unpackAlignment=i.unpackAlignment),void 0!==i.compareFunction&&(l.compareFunction=i.compareFunction),void 0!==i.userData&&(l.userData=i.userData),r[i.uuid]=l}return r}parseObject(e,t,n,r,a){let i,s,o;function d(e){return void 0===t[e]&&kX("ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,a=e.length;r<a;r++){const a=e[r];void 0===n[a]&&kX("ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&kX("ObjectLoader: Undefined material",e),n[e]}}function h(e){return void 0===r[e]&&kX("ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":i=new FJ,void 0!==e.background&&(Number.isInteger(e.background)?i.background=new Iq(e.background):i.background=h(e.background)),void 0!==e.environment&&(i.environment=h(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new LJ(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new BJ(e.fog.color,e.fog.density)),""!==e.fog.name&&(i.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(i.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(i.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&i.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(i.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&i.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":i=new kJ(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new o2(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new d2(e.color,e.intensity);break;case"DirectionalLight":i=new c2(e.color,e.intensity),i.target=e.target||"";break;case"PointLight":i=new s2(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new u2(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new t2(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),i.target=e.target||"";break;case"HemisphereLight":i=new K1(e.color,e.groundColor,e.intensity);break;case"LightProbe":i=(new p2).fromJSON(e);break;case"SkinnedMesh":s=d(e.geometry),o=u(e.material),i=new xQ(s,o),void 0!==e.bindMode&&(i.bindMode=e.bindMode),void 0!==e.bindMatrix&&i.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(i.skeleton=e.skeleton);break;case"Mesh":s=d(e.geometry),o=u(e.material),i=new xJ(s,o);break;case"InstancedMesh":s=d(e.geometry),o=u(e.material);const t=e.count,n=e.instanceMatrix,r=e.instanceColor;i=new TQ(s,o,t),i.instanceMatrix=new SQ(new Float32Array(n.array),16),void 0!==r&&(i.instanceColor=new SQ(new Float32Array(r.array),r.itemSize));break;case"BatchedMesh":s=d(e.geometry),o=u(e.material),i=new oZ(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,o),i.geometry=s,i.perObjectFrustumCulled=e.perObjectFrustumCulled,i.sortObjects=e.sortObjects,i._drawRanges=e.drawRanges,i._reservedRanges=e.reservedRanges,i._geometryInfo=e.geometryInfo.map(e=>{let t=null,n=null;return void 0!==e.boundingBox&&(t=(new fK).fromJSON(e.boundingBox)),void 0!==e.boundingSphere&&(n=(new RK).fromJSON(e.boundingSphere)),c(l({},e),{boundingBox:t,boundingSphere:n})}),i._instanceInfo=e.instanceInfo,i._availableInstanceIds=e._availableInstanceIds,i._availableGeometryIds=e._availableGeometryIds,i._nextIndexStart=e.nextIndexStart,i._nextVertexStart=e.nextVertexStart,i._geometryCount=e.geometryCount,i._maxInstanceCount=e.maxInstanceCount,i._maxVertexCount=e.maxVertexCount,i._maxIndexCount=e.maxIndexCount,i._geometryInitialized=e.geometryInitialized,i._matricesTexture=h(e.matricesTexture.uuid),i._indirectTexture=h(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(i._colorsTexture=h(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(i.boundingSphere=(new RK).fromJSON(e.boundingSphere)),void 0!==e.boundingBox&&(i.boundingBox=(new fK).fromJSON(e.boundingBox));break;case"LOD":i=new oQ;break;case"Line":i=new fZ(d(e.geometry),u(e.material));break;case"LineLoop":i=new wZ(d(e.geometry),u(e.material));break;case"LineSegments":i=new bZ(d(e.geometry),u(e.material));break;case"PointCloud":case"Points":i=new CZ(d(e.geometry),u(e.material));break;case"Sprite":i=new rQ(u(e.material));break;case"Group":i=new RJ;break;case"Bone":i=new yQ;break;default:i=new fq}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.up&&i.up.fromArray(e.up),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(i.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(i.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.layers&&(i.layers.mask=e.layers),void 0!==e.children){const s=e.children;for(let e=0;e<s.length;e++)i.add(this.parseObject(s[e],t,n,r,a))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];i.animations.push(a[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(i.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=i.getObjectByProperty("uuid",n.object);void 0!==r&&i.addLevel(r,n.distance,n.hysteresis)}}return i}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?kX("ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);t.target=void 0!==r?r:new fq}})}},ObjectSpaceNormalMap:1,OctahedronGeometry:Y0,OneFactor:201,OneMinusConstantAlphaFactor:214,OneMinusConstantColorFactor:212,OneMinusDstAlphaFactor:207,OneMinusDstColorFactor:209,OneMinusSrcAlphaFactor:hW,OneMinusSrcColorFactor:203,OrthographicCamera:o2,PCFShadowMap:1,PCFSoftShadowMap:2,PMREMGenerator:t4,Path:u0,PerspectiveCamera:kJ,Plane:IQ,PlaneGeometry:X0,PlaneHelper:class extends fZ{constructor(e,t=1,n=16776960){const r=n,a=new iJ;a.setAttribute("position",new Jq([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),a.computeBoundingSphere(),super(a,new lZ({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const i=new iJ;i.setAttribute("position",new Jq([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new xJ(i,new Fq({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},PointLight:s2,PointLightHelper:class extends xJ{constructor(e,t,n){super(new J0(t,4,2),new Fq({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Points:CZ,PointsMaterial:NZ,PolarGridHelper:class extends bZ{constructor(e=10,t=16,n=8,r=64,a=4473924,i=8947848){a=new Iq(a),i=new Iq(i);const s=[],o=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),r=Math.sin(n)*e,l=Math.cos(n)*e;s.push(0,0,0),s.push(r,0,l);const d=1&c?a:i;o.push(d.r,d.g,d.b),o.push(d.r,d.g,d.b)}for(let c=0;c<n;c++){const t=1&c?a:i,l=e-e/n*c;for(let e=0;e<r;e++){let n=e/r*(2*Math.PI),a=Math.sin(n)*l,i=Math.cos(n)*l;s.push(a,0,i),o.push(t.r,t.g,t.b),n=(e+1)/r*(2*Math.PI),a=Math.sin(n)*l,i=Math.cos(n)*l,s.push(a,0,i),o.push(t.r,t.g,t.b)}}const l=new iJ;l.setAttribute("position",new Jq(s,3)),l.setAttribute("color",new Jq(o,3));super(l,new lZ({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},PolyhedronGeometry:BZ,PositionalAudio:class extends I2{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(O2,B2,L2),F2.set(0,0,1).applyQuaternion(B2);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(O2.x,e),t.positionY.linearRampToValueAtTime(O2.y,e),t.positionZ.linearRampToValueAtTime(O2.z,e),t.orientationX.linearRampToValueAtTime(F2.x,e),t.orientationY.linearRampToValueAtTime(F2.y,e),t.orientationZ.linearRampToValueAtTime(F2.z,e)}else t.setPosition(O2.x,O2.y,O2.z),t.setOrientation(F2.x,F2.y,F2.z)}},PropertyBinding:Y2,PropertyMixer:U2,QuadraticBezierCurve:s0,QuadraticBezierCurve3:o0,Quaternion:$X,QuaternionKeyframeTrack:T1,QuaternionLinearInterpolant:E1,RED_GREEN_RGTC2_Format:YY,RED_RGTC1_Format:$Y,REVISION:Q$,RGBADepthPacking:3201,RGBAFormat:cY,RGBAIntegerFormat:fY,RGBA_ASTC_10x10_Format:FY,RGBA_ASTC_10x5_Format:OY,RGBA_ASTC_10x6_Format:BY,RGBA_ASTC_10x8_Format:LY,RGBA_ASTC_12x10_Format:UY,RGBA_ASTC_12x12_Format:zY,RGBA_ASTC_4x4_Format:MY,RGBA_ASTC_5x4_Format:kY,RGBA_ASTC_5x5_Format:EY,RGBA_ASTC_6x5_Format:TY,RGBA_ASTC_6x6_Format:PY,RGBA_ASTC_8x5_Format:DY,RGBA_ASTC_8x6_Format:RY,RGBA_ASTC_8x8_Format:IY,RGBA_BPTC_Format:HY,RGBA_ETC2_EAC_Format:CY,RGBA_PVRTC_2BPPV1_Format:jY,RGBA_PVRTC_4BPPV1_Format:SY,RGBA_S3TC_DXT1_Format:yY,RGBA_S3TC_DXT3_Format:vY,RGBA_S3TC_DXT5_Format:bY,RGBDepthPacking:3202,RGBFormat:lY,RGBIntegerFormat:1032,RGB_BPTC_SIGNED_Format:GY,RGB_BPTC_UNSIGNED_Format:VY,RGB_ETC1_Format:_Y,RGB_ETC2_Format:AY,RGB_PVRTC_2BPPV1_Format:NY,RGB_PVRTC_4BPPV1_Format:wY,RGB_S3TC_DXT1_Format:xY,RGDepthPacking:3203,RGFormat:mY,RGIntegerFormat:gY,RawShaderMaterial:s1,Ray:HK,Raycaster:Z2,RectAreaLight:u2,RedFormat:hY,RedIntegerFormat:pY,ReinhardToneMapping:2,RenderTarget:hK,RenderTarget3D:class extends hK{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new gK(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},RepeatWrapping:LW,ReplaceStencilOp:7681,ReverseSubtractEquation:102,RingGeometry:K0,SIGNED_RED_GREEN_RGTC2_Format:XY,SIGNED_RED_RGTC1_Format:WY,SRGBColorSpace:aX,SRGBTransfer:oX,Scene:FJ,ShaderChunk:R3,ShaderLib:O3,ShaderMaterial:jJ,ShadowMaterial:i1,Shape:h0,ShapeGeometry:q0,ShapePath:class{constructor(){this.type="ShapePath",this.color=new Iq,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new u0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,a,i){return this.currentPath.bezierCurveTo(e,t,n,r,a,i),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let r=!1;for(let a=n-1,i=0;i<n;a=i++){let n=t[a],s=t[i],o=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[i],o=-o,s=t[a],l=-l),e.y<n.y||e.y>s.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-o*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x)return!0}}return r}const n=U0.isClockWise,r=this.subPaths;if(0===r.length)return[];let a,i,s;const o=[];if(1===r.length)return i=r[0],s=new h0,s.curves=i.curves,o.push(s),o;let l=!n(r[0].getPoints());l=e?!l:l;const c=[],d=[];let u,h,p=[],m=0;d[m]=void 0,p[m]=[];for(let g=0,f=r.length;g<f;g++)i=r[g],u=i.getPoints(),a=n(u),a=e?!a:a,a?(!l&&d[m]&&m++,d[m]={s:new h0,p:u},d[m].s.curves=i.curves,l&&m++,p[m]=[]):p[m].push({h:i,p:u[0]});if(!d[0])return function(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],a=new h0;a.curves=r.curves,t.push(a)}return t}(r);if(d.length>1){let e=!1,n=0;for(let t=0,r=d.length;t<r;t++)c[t]=[];for(let r=0,a=d.length;r<a;r++){const a=p[r];for(let i=0;i<a.length;i++){const s=a[i];let o=!0;for(let a=0;a<d.length;a++)t(s.p,d[a].p)&&(r!==a&&n++,o?(o=!1,c[a].push(s)):e=!0);o&&c[r].push(s)}}n>0&&!1===e&&(p=c)}for(let g=0,f=d.length;g<f;g++){s=d[g].s,o.push(s),h=p[g];for(let e=0,t=h.length;e<t;e++)s.holes.push(h[e].h)}return o}},ShapeUtils:U0,ShortType:qW,Skeleton:NQ,SkeletonHelper:class extends bZ{constructor(e){const t=x3(e),n=new iJ,r=[],a=[];for(let o=0;o<t.length;o++){const e=t[o];e.parent&&e.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),a.push(0,0,0),a.push(0,0,0))}n.setAttribute("position",new Jq(r,3)),n.setAttribute("color",new Jq(a,3));super(n,new lZ({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const i=new Iq(255),s=new Iq(65280);this.setColors(i,s)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");f3.copy(this.root.matrixWorld).invert();for(let a=0,i=0;a<t.length;a++){const e=t[a];e.parent&&e.parent.isBone&&(g3.multiplyMatrices(f3,e.matrixWorld),m3.setFromMatrixPosition(g3),r.setXYZ(i,m3.x,m3.y,m3.z),g3.multiplyMatrices(f3,e.parent.matrixWorld),m3.setFromMatrixPosition(g3),r.setXYZ(i+1,m3.x,m3.y,m3.z),i+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const n=this.geometry.getAttribute("color");for(let r=0;r<n.count;r+=2)n.setXYZ(r,e.r,e.g,e.b),n.setXYZ(r+1,t.r,t.g,t.b);return n.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},SkinnedMesh:xQ,Source:sK,Sphere:RK,SphereGeometry:J0,Spherical:r3,SphericalHarmonics3:h2,SplineCurve:l0,SpotLight:t2,SpotLightHelper:class extends fq{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new iJ,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let i=0,s=1,o=32;i<o;i++,s++){const e=i/o*Math.PI*2,t=s/o*Math.PI*2;r.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new Jq(r,3));const a=new lZ({fog:!1,toneMapped:!1});this.cone=new bZ(n,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),p3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(p3),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Sprite:rQ,SpriteMaterial:GJ,SrcAlphaFactor:uW,SrcAlphaSaturateFactor:210,SrcColorFactor:202,StaticCopyUsage:35046,StaticDrawUsage:xX,StaticReadUsage:35045,StereoCamera:class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new kJ,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new kJ,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,C2.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,a=t.near*Math.tan(IX*t.fov*.5)/t.zoom;let i,s;A2.elements[12]=-n,_2.elements[12]=n,i=-a*t.aspect+r,s=a*t.aspect+r,C2.elements[0]=2*t.near/(s-i),C2.elements[8]=(s+i)/(s-i),this.cameraL.projectionMatrix.copy(C2),i=-a*t.aspect-r,s=a*t.aspect-r,C2.elements[0]=2*t.near/(s-i),C2.elements[8]=(s+i)/(s-i),this.cameraR.projectionMatrix.copy(C2)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(A2),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(_2)}},StreamCopyUsage:35042,StreamDrawUsage:35040,StreamReadUsage:35041,StringKeyframeTrack:P1,SubtractEquation:101,SubtractiveBlending:3,TOUCH:eW,TangentSpaceNormalMap:0,TetrahedronGeometry:Q0,Texture:dK,TextureLoader:Y1,TextureUtils:class{static contain(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}(e,t)}static cover(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}(e,t)}static fill(e){return function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}(e)}static getByteLength(e,t,n,r){return T3(e,t,n,r)}},Timer:class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,void 0!==e.hidden&&(this._pageVisibilityHandler=n3.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){null!==this._pageVisibilityHandler&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return null!==this._pageVisibilityHandler&&!0===this._document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==e?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}},TimestampQuery:{COMPUTE:"compute",RENDER:"render"},TorusGeometry:Z0,TorusKnotGeometry:e1,Triangle:Eq,TriangleFanDrawMode:2,TriangleStripDrawMode:1,TrianglesDrawMode:0,TubeGeometry:t1,UVMapping:PW,Uint16BufferAttribute:Kq,Uint32BufferAttribute:qq,Uint8BufferAttribute:class extends Xq{constructor(e,t,n){super(new Uint8Array(e),t,n)}},Uint8ClampedBufferAttribute:class extends Xq{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},Uniform:q2,UniformsGroup:class extends PX{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:J2++}),this.name="",this.usage=xX,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}},UniformsLib:I3,UniformsUtils:SJ,UnsignedByteType:XW,UnsignedInt101111Type:sY,UnsignedInt248Type:aY,UnsignedInt5999Type:iY,UnsignedIntType:ZW,UnsignedShort4444Type:nY,UnsignedShort5551Type:rY,UnsignedShortType:JW,VSMShadowMap:3,Vector2:VX,Vector3:WX,Vector4:uK,VectorKeyframeTrack:D1,VideoFrameTexture:class extends kZ{constructor(e,t,n,r,a,i,s,o){super({},e,t,n,r,a,i,s,o),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}},VideoTexture:kZ,WebGL3DRenderTarget:class extends pK{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new gK(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},WebGLArrayRenderTarget:class extends pK{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new mK(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},WebGLCoordinateSystem:vX,WebGLCubeRenderTarget:DJ,WebGLRenderTarget:pK,WebGLRenderer:p6,WebGLUtils:a6,WebGPUCoordinateSystem:bX,WebXRController:OJ,WireframeGeometry:n1,WrapAroundEnding:eX,ZeroCurvatureEnding:QY,ZeroFactor:200,ZeroSlopeEnding:ZY,ZeroStencilOp:0,createCanvasElement:_X,error:EX,getConsoleFunction:function(){return CX},log:MX,setConsoleFunction:function(e){CX=e},warn:kX,warnOnce:TX},Symbol.toStringTag,{value:"Module"})),g6=e=>{let t;const n=new Set,r=(e,r)=>{const a="function"==typeof e?e(t):e;if(!Object.is(a,t)){const e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,i={setState:r,getState:a,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(r,a,i);return i},{useSyncExternalStoreWithSelector:f6}=wm,x6=e=>e;const y6=(e,t)=>{const n=(e=>e?g6(e):g6)(e),r=(e,r=t)=>function(e,t=x6,n){const r=f6(e.subscribe,e.getState,e.getInitialState,t,n);return v.useDebugValue(r),r}(n,e,r);return Object.assign(r,n),r},v6=(e,t)=>e?y6(e,t):y6,b6=[];function w6(e,t,n=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let a=0;a<r;a++)if(!n(e[a],t[a]))return!1;return!0}function N6(e,t=null,n=!1,r={}){null===t&&(t=[e]);for(const s of b6)if(w6(t,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!n)throw s.promise}const a={keys:t,equal:r.equal,remove:()=>{const e=b6.indexOf(a);-1!==e&&b6.splice(e,1)},promise:(i=e,"object"==typeof i&&"function"==typeof i.then?e:e(...t)).then(e=>{a.response=e,r.lifespan&&r.lifespan>0&&(a.timeout=setTimeout(a.remove,r.lifespan))}).catch(e=>a.error=e)};var i;if(b6.push(a),!n)throw a.promise}var S6,j6,_6,A6,C6={exports:{}},M6={exports:{}},k6={exports:{}},E6={};function T6(){return j6||(j6=1,k6.exports=(S6||(S6=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<i&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],d=1,u=null,h=3,p=!1,m=!1,g=!1,f="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var a=n(c);null!==a;){if(null===a.callback)r(c);else{if(!(a.startTime<=e))break;r(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function b(e){if(g=!1,v(e),!m)if(null!==n(l))m=!0,E();else{var t=n(c);null!==t&&T(b,t.startTime-e)}}var w,N=!1,S=-1,j=5,_=-1;function A(){return!(e.unstable_now()-_<j)}function C(){if(N){var t=e.unstable_now();_=t;var a=!0;try{e:{m=!1,g&&(g=!1,x(S),S=-1),p=!0;var i=h;try{t:{for(v(t),u=n(l);null!==u&&!(u.expirationTime>t&&A());){var s=u.callback;if("function"==typeof s){u.callback=null,h=u.priorityLevel;var o=s(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof o){u.callback=o,v(t),a=!0;break t}u===n(l)&&r(l),v(t)}else r(l);u=n(l)}if(null!==u)a=!0;else{var d=n(c);null!==d&&T(b,d.startTime-t),a=!1}}break e}finally{u=null,h=i,p=!1}a=void 0}}finally{a?w():N=!1}}}if("function"==typeof y)w=function(){y(C)};else if("undefined"!=typeof MessageChannel){var M=new MessageChannel,k=M.port2;M.port1.onmessage=C,w=function(){k.postMessage(null)}}else w=function(){f(C,0)};function E(){N||(N=!0,w())}function T(t,n){S=f(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,E())},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(r,a,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,r){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return r={id:d++,callback:a,priorityLevel:r,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(r.sortIndex=i,t(c,r),null===n(l)&&r===n(c)&&(g?(x(S),S=-1):g=!0,T(b,i-s))):(r.sortIndex=o,t(l,r),m||p||(m=!0,E())),r},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(E6)),E6)),k6.exports}
/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function P6(){return _6||(_6=1,(e=M6).exports=function(e){function t(e,t,n,r){return new ja(e,t,n,r)}function n(){}function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=li&&e[li]||e["@@iterator"])?e:null}function i(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===ci?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Ka:return"Fragment";case Xa:return"Portal";case Ja:return"Profiler";case qa:return"StrictMode";case ni:return"Suspense";case ri:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case ei:return(e.displayName||"Context")+".Provider";case Za:return(e._context.displayName||"Context")+".Consumer";case ti:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case ai:return null!==(t=e.displayName||null)?t:i(e.type)||"Memo";case ii:t=e._payload,e=e._init;try{return i(e(t))}catch(H7){}}return null}function s(e){if(void 0===Ua)try{throw Error()}catch(H7){var t=H7.stack.trim().match(/\n( *(at )?)/);Ua=t&&t[1]||"",za=-1<H7.stack.indexOf("\n    at")?" (<anonymous>)":-1<H7.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Ua+e+za}function o(e,t){if(!e||ui)return"";ui=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(H7){var r=H7}Reflect.construct(e,[],n)}else{try{n.call()}catch(a){r=a}e.call(n.prototype)}}else{try{throw Error()}catch(i){r=i}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"==typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),o=i[0],l=i[1];if(o&&l){var c=o.split("\n"),d=l.split("\n");for(a=r=0;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;for(;a<d.length&&!d[a].includes("DetermineComponentFrameRoot");)a++;if(r===c.length||a===d.length)for(r=c.length-1,a=d.length-1;1<=r&&0<=a&&c[r]!==d[a];)a--;for(;1<=r&&0<=a;r--,a--)if(c[r]!==d[a]){if(1!==r||1!==a)do{if(r--,0>--a||c[r]!==d[a]){var u="\n"+c[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{ui=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?s(n):""}function l(e){switch(e.tag){case 26:case 27:case 5:return s(e.type);case 16:return s("Lazy");case 13:return s("Suspense");case 19:return s("SuspenseList");case 0:case 15:return e=o(e.type,!1);case 11:return e=o(e.type.render,!1);case 1:return e=o(e.type,!0);default:return""}}function c(e){try{var t="";do{t+=l(e),e=e.return}while(e);return t}catch(H7){return"\nError generating stack: "+H7.message+"\n"+H7.stack}}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function u(e){if(d(e)!==e)throw Error(r(188))}function h(e){var t=e.alternate;if(!t){if(null===(t=d(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,a=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(a=i.return)){n=a;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return u(i),e;if(s===a)return u(i),t;s=s.sibling}throw Error(r(188))}if(n.return!==a.return)n=i,a=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,a=s;break}if(l===a){o=!0,a=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,a=i;break}if(l===a){o=!0,a=s,n=i;break}l=l.sibling}if(!o)throw Error(r(189))}}if(n.alternate!==a)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}function m(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=m(e)))return t;e=e.sibling}return null}function g(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(4!==e.tag&&null!==(t=g(e)))return t;e=e.sibling}return null}function f(e){return{current:e}}function x(e){0>yo||(e.current=xo[yo],xo[yo]=null,yo--)}function y(e,t){yo++,xo[yo]=e.current,e.current=t}function v(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function b(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=e.warmLanes;e=0!==e.finishedLanes;var o=134217727&n;return 0!==o?0!==(n=o&~a)?r=v(n):0!==(i&=o)?r=v(i):e||0!==(s=o&~s)&&(r=v(s)):0!==(o=n&~a)?r=v(o):0!==i?r=v(i):e||0!==(s=n&~s)&&(r=v(s)),0===r?0:0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(s=t&-t)||32===a&&4194176&s)?t:r}function w(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function N(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function S(){var e=So;return!(4194176&(So<<=1))&&(So=128),e}function j(){var e=jo;return!(62914560&(jo<<=1))&&(jo=4194304),e}function _(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function A(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function C(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-bo(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&n}function M(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-bo(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function k(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function E(e){if("function"==typeof Ro&&Io(e),Bo&&"function"==typeof Bo.setStrictMode)try{Bo.setStrictMode(Oo,e)}catch(t){}}function T(e,t){if("object"==typeof e&&null!==e){var n=Fo.get(e);return void 0!==n?n:(t={value:e,source:t,stack:c(t)},Fo.set(e,t),t)}return{value:e,source:t,stack:c(t)}}function P(e,t){Uo[zo++]=Go,Uo[zo++]=Ho,Ho=e,Go=t}function D(e,t,n){Vo[$o++]=Yo,Vo[$o++]=Xo,Vo[$o++]=Wo,Wo=e;var r=Yo;e=Xo;var a=32-bo(r)-1;r&=~(1<<a),n+=1;var i=32-bo(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Yo=1<<32-bo(t)+a|n<<a|r,Xo=i+e}else Yo=1<<i|n<<a|r,Xo=e}function R(e){null!==e.return&&(P(e,1),D(e,1,0))}function I(e){for(;e===Ho;)Ho=Uo[--zo],Uo[zo]=null,Go=Uo[--zo],Uo[zo]=null;for(;e===Wo;)Wo=Vo[--$o],Vo[$o]=null,Xo=Vo[--$o],Vo[$o]=null,Yo=Vo[--$o],Vo[$o]=null}function O(e,t){y(Jo,t),y(qo,e),y(Ko,null),e=xi(t),x(Ko),y(Ko,e)}function B(){x(Ko),x(qo),x(Jo)}function L(e){null!==e.memoizedState&&y(Qo,e);var t=Ko.current,n=yi(t,e.type);t!==n&&(y(qo,e),y(Ko,n))}function F(e){qo.current===e&&(x(Ko),x(qo)),Qo.current===e&&(x(Qo),ki?Wi._currentValue=$i:Wi._currentValue2=$i)}function U(e){throw $(T(Error(r(418,"")),e)),al}function z(e,t){if(!Pi)throw Error(r(175));Fs(e.stateNode,e.type,e.memoizedProps,t,e)||U(e)}function H(e){for(Zo=e.return;Zo;)switch(Zo.tag){case 3:case 27:return void(rl=!0);case 5:case 13:return void(rl=!1);default:Zo=Zo.return}}function G(e){if(!Pi||e!==Zo)return!1;if(!tl)return H(e),tl=!0,!1;var t=!1;if(uo?3!==e.tag&&27!==e.tag&&(5!==e.tag||Ys(e.type)&&!ji(e.type,e.memoizedProps))&&(t=!0):3!==e.tag&&(5!==e.tag||Ys(e.type)&&!ji(e.type,e.memoizedProps))&&(t=!0),t&&el&&U(e),H(e),13===e.tag){if(!Pi)throw Error(r(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));el=Hs(e)}else el=Zo?Ps(e.stateNode):null;return!0}function V(){Pi&&(el=Zo=null,tl=!1)}function $(e){null===nl?nl=[e]:nl.push(e)}function W(){for(var e=sl,t=ol=sl=0;t<e;){var n=il[t];il[t++]=null;var r=il[t];il[t++]=null;var a=il[t];il[t++]=null;var i=il[t];if(il[t++]=null,null!==r&&null!==a){var s=r.pending;null===s?a.next=a:(a.next=s.next,s.next=a),r.pending=a}0!==i&&q(n,a,i)}}function Y(e,t,n,r){il[sl++]=e,il[sl++]=t,il[sl++]=n,il[sl++]=r,ol|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function X(e,t,n,r){return Y(e,t,n,r),J(e)}function K(e,t){return Y(e,null,null,t),J(e)}function q(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;a&&null!==t&&3===e.tag&&(i=e.stateNode,a=31-bo(n),null===(e=(i=i.hiddenUpdates)[a])?i[a]=[t]:e.push(t),t.lane=536870912|n)}function J(e){if(50<nd)throw nd=0,rd=null,Error(r(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}function Q(e){var t;e!==cl&&null===e.next&&(null===cl?ll=cl=e:cl=cl.next=e),ul=!0,dl||(dl=!0,t=ee,Xi?Ki(function(){6&Mc?_o(Eo,t):t()}):_o(Eo,t))}function Z(e,t){if(!hl&&ul){hl=!0;do{for(var n=!1,r=ll;null!==r;){if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var s=r.suspendedLanes,o=r.pingedLanes;i=(1<<31-bo(42|e)+1)-1,i=201326677&(i&=a&~(s&~o))?201326677&i|1:i?2|i:0}0!==i&&(n=!0,re(r,i))}else i=Tc,!(3&(i=b(r,r===kc?i:0)))||w(r,i)||(n=!0,re(r,i));r=r.next}}while(n);hl=!1}}function ee(){ul=dl=!1;var e=0;0!==pl&&(Li()&&(e=pl),pl=0);for(var t=ko(),n=null,r=ll;null!==r;){var a=r.next,i=te(r,t);0===i?(r.next=null,null===n?ll=a:n.next=a,null===a&&(cl=n)):(n=r,(0!==e||3&i)&&(ul=!0)),r=a}Z(e)}function te(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var s=31-bo(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=N(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}if(n=Tc,n=b(e,e===(t=kc)?n:0),r=e.callbackNode,0===n||e===t&&2===Pc||null!==e.cancelPendingCommit)return null!==r&&null!==r&&Ao(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||w(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&Ao(r),k(n)){case 2:case 8:n=To;break;case 32:default:n=Po;break;case 268435456:n=Do}return r=ne.bind(null,e),n=_o(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&Ao(r),e.callbackPriority=2,e.callbackNode=null,2}function ne(e,t){var n=e.callbackNode;if(fa()&&e.callbackNode!==n)return null;var r=Tc;return 0===(r=b(e,e===kc?r:0))?null:(Yr(e,r,t),te(e,ko()),null!=e.callbackNode&&e.callbackNode===n?ne.bind(null,e):null)}function re(e,t){if(fa())return null;Yr(e,t,!0)}function ae(){return 0===pl&&(pl=S()),pl}function ie(){if(0===--gl&&null!==ml){null!==xl&&(xl.status="fulfilled");var e=ml;ml=null,fl=0,xl=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function se(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function oe(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function le(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ce(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Mc){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=J(e),q(e,null,n),t}return Y(e,r,t,n),J(e)}function de(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194176&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,M(e,n)}}function ue(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function he(){if(vl&&null!==xl)throw xl}function pe(e,t,n,r){vl=!1;var a=e.updateQueue;yl=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var d=e.alternate;null!==d&&(o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l)}if(null!==i){var u=a.baseState;for(s=0,d=c=l=null,o=i;;){var h=-536870913&o.lane,p=h!==o.lane;if(p?(Tc&h)===h:(r&h)===h){0!==h&&h===fl&&(vl=!0),null!==d&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;h=t;var f=n;switch(g.tag){case 1:if("function"==typeof(m=g.payload)){u=m.call(f,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=g.payload)?m.call(f,u,h):m))break e;u=$a({},u,h);break e;case 2:yl=!0}}null!==(h=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[h]:p.push(h))}else p={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null===i&&(a.shared.lanes=0),Fc|=s,e.lanes=s,e.memoizedState=u}}function me(e,t){if("function"!=typeof e)throw Error(r(191,e));e.call(t)}function ge(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)me(n[e],t)}function fe(e,t){if(Lo(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!bl.call(t,a)||!Lo(e[a],t[a]))return!1}return!0}function xe(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ye(){}function ve(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(ye,ye),t=n),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===wl)throw Error(r(483));throw e;default:if("string"==typeof t.status)t.then(ye,ye);else{if(null!==(e=kc)&&100<e.shellSuspendCounter)throw Error(r(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===wl)throw Error(r(483));throw e}throw jl=t,wl}}function be(){if(null===jl)throw Error(r(459));var e=jl;return jl=null,e}function we(e){var t=Al;return Al+=1,null===_l&&(_l=[]),ve(_l,e,t)}function Ne(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Se(e,t){if(t.$$typeof===Wa)throw Error(r(525));throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function je(e){return(0,e._init)(e._payload)}function _e(e){function n(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function i(t,r){if(!e)return null;for(;null!==r;)n(t,r),r=r.sibling;return null}function s(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,t){return(e=Aa(e,t)).index=0,e.sibling=null,e}function l(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=33554434,n):r:(t.flags|=33554434,n):(t.flags|=1048576,n)}function c(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function d(e,t,n,r){return null===t||6!==t.tag?((t=Ta(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function u(e,t,n,r){var a=n.type;return a===Ka?p(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===ii&&je(a)===t.type)?(Ne(t=o(t,n.props),n),t.return=e,t):(Ne(t=Ma(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function h(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pa(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function p(e,t,n,r,a){return null===t||7!==t.tag?((t=ka(n,e.mode,r,a)).return=e,t):((t=o(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Ta(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Ya:return Ne(n=Ma(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case Xa:return(t=Pa(t,e.mode,n)).return=e,t;case ii:return m(e,t=(0,t._init)(t._payload),n)}if(hi(t)||a(t))return(t=ka(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return m(e,we(t),n);if(t.$$typeof===ei)return m(e,Dn(e,t),n);Se(e,t)}return null}function g(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==i?null:d(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Ya:return n.key===i?u(e,t,n,r):null;case Xa:return n.key===i?h(e,t,n,r):null;case ii:return g(e,t,n=(i=n._init)(n._payload),r)}if(hi(n)||a(n))return null!==i?null:p(e,t,n,r,null);if("function"==typeof n.then)return g(e,t,we(n),r);if(n.$$typeof===ei)return g(e,t,Dn(e,n),r);Se(e,n)}return null}function f(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return d(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Ya:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case Xa:return h(t,e=e.get(null===r.key?n:r.key)||null,r,i);case ii:return f(e,t,n,r=(0,r._init)(r._payload),i)}if(hi(r)||a(r))return p(t,e=e.get(n)||null,r,i,null);if("function"==typeof r.then)return f(e,t,n,we(r),i);if(r.$$typeof===ei)return f(e,t,n,Dn(t,r),i);Se(t,r)}return null}function x(t,d,u,h){if("object"==typeof u&&null!==u&&u.type===Ka&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case Ya:e:{for(var p=u.key;null!==d;){if(d.key===p){if((p=u.type)===Ka){if(7===d.tag){i(t,d.sibling),(h=o(d,u.props.children)).return=t,t=h;break e}}else if(d.elementType===p||"object"==typeof p&&null!==p&&p.$$typeof===ii&&je(p)===d.type){i(t,d.sibling),Ne(h=o(d,u.props),u),h.return=t,t=h;break e}i(t,d);break}n(t,d),d=d.sibling}u.type===Ka?((h=ka(u.props.children,t.mode,h,u.key)).return=t,t=h):(Ne(h=Ma(u.type,u.key,u.props,null,t.mode,h),u),h.return=t,t=h)}return c(t);case Xa:e:{for(p=u.key;null!==d;){if(d.key===p){if(4===d.tag&&d.stateNode.containerInfo===u.containerInfo&&d.stateNode.implementation===u.implementation){i(t,d.sibling),(h=o(d,u.children||[])).return=t,t=h;break e}i(t,d);break}n(t,d),d=d.sibling}(h=Pa(u,t.mode,h)).return=t,t=h}return c(t);case ii:return x(t,d,u=(p=u._init)(u._payload),h)}if(hi(u))return function(t,r,a,o){for(var c=null,d=null,u=r,h=r=0,p=null;null!==u&&h<a.length;h++){u.index>h?(p=u,u=null):p=u.sibling;var x=g(t,u,a[h],o);if(null===x){null===u&&(u=p);break}e&&u&&null===x.alternate&&n(t,u),r=l(x,r,h),null===d?c=x:d.sibling=x,d=x,u=p}if(h===a.length)return i(t,u),tl&&P(t,h),c;if(null===u){for(;h<a.length;h++)null!==(u=m(t,a[h],o))&&(r=l(u,r,h),null===d?c=u:d.sibling=u,d=u);return tl&&P(t,h),c}for(u=s(u);h<a.length;h++)null!==(p=f(u,t,h,a[h],o))&&(e&&null!==p.alternate&&u.delete(null===p.key?h:p.key),r=l(p,r,h),null===d?c=p:d.sibling=p,d=p);return e&&u.forEach(function(e){return n(t,e)}),tl&&P(t,h),c}(t,d,u,h);if(a(u)){if("function"!=typeof(p=a(u)))throw Error(r(150));return function(t,a,o,c){if(null==o)throw Error(r(151));for(var d=null,u=null,h=a,p=a=0,x=null,y=o.next();null!==h&&!y.done;p++,y=o.next()){h.index>p?(x=h,h=null):x=h.sibling;var v=g(t,h,y.value,c);if(null===v){null===h&&(h=x);break}e&&h&&null===v.alternate&&n(t,h),a=l(v,a,p),null===u?d=v:u.sibling=v,u=v,h=x}if(y.done)return i(t,h),tl&&P(t,p),d;if(null===h){for(;!y.done;p++,y=o.next())null!==(y=m(t,y.value,c))&&(a=l(y,a,p),null===u?d=y:u.sibling=y,u=y);return tl&&P(t,p),d}for(h=s(h);!y.done;p++,y=o.next())null!==(y=f(h,t,p,y.value,c))&&(e&&null!==y.alternate&&h.delete(null===y.key?p:y.key),a=l(y,a,p),null===u?d=y:u.sibling=y,u=y);return e&&h.forEach(function(e){return n(t,e)}),tl&&P(t,p),d}(t,d,u=p.call(u),h)}if("function"==typeof u.then)return x(t,d,we(u),h);if(u.$$typeof===ei)return x(t,d,Dn(t,u),h);Se(t,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==d&&6===d.tag?(i(t,d.sibling),(h=o(d,u)).return=t,t=h):(i(t,d),(h=Ta(u,t.mode,h)).return=t,t=h),c(t)):i(t,d)}return function(e,n,r,a){try{Al=0;var i=x(e,n,r,a);return _l=null,i}catch(H7){if(H7===wl)throw H7;var s=t(29,H7,null,e.mode);return s.lanes=a,s.return=e,s}}}function Ae(e,t){y(El,e=Bc),y(kl,t),Bc=e|t.baseLanes}function Ce(){y(El,Bc),y(kl,kl.current)}function Me(){Bc=El.current,x(kl),x(El)}function ke(e){var t=e.alternate;y(Dl,1&Dl.current),y(Tl,e),null===Pl&&(null===t||null!==kl.current||null!==t.memoizedState)&&(Pl=e)}function Ee(e){if(22===e.tag){if(y(Dl,Dl.current),y(Tl,e),null===Pl){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Pl=e)}}else Te()}function Te(){y(Dl,Dl.current),y(Tl,Tl.current)}function Pe(e){x(Tl),Pl===e&&(Pl=null),x(Dl)}function De(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||As(n)||Cs(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Re(){throw Error(r(321))}function Ie(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Lo(e[n],t[n]))return!1;return!0}function Oe(e,t,n,r,a,i){return Rl=i,Il=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,di.H=null===e||null===e.memoizedState?Yl:Xl,Ul=!1,i=n(r,a),Ul=!1,Fl&&(i=Le(t,n,r,a)),Be(e),i}function Be(e){di.H=Wl;var t=null!==Ol&&null!==Ol.next;if(Rl=0,Bl=Ol=Il=null,Ll=!1,Hl=0,Gl=null,t)throw Error(r(300));null===e||Zl||null!==(e=e.dependencies)&&En(e)&&(Zl=!0)}function Le(e,t,n,a){Il=e;var i=0;do{if(Fl&&(Gl=null),Hl=0,Fl=!1,25<=i)throw Error(r(301));if(i+=1,Bl=Ol=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}di.H=Kl,s=t(n,a)}while(Fl);return s}function Fe(){var e=di.H,t=e.useState()[0];return t="function"==typeof t.then?$e(t):t,e=e.useState()[0],(null!==Ol?Ol.memoizedState:null)!==e&&(Il.flags|=1024),t}function Ue(){var e=0!==zl;return zl=0,e}function ze(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function He(e){if(Ll){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ll=!1}Rl=0,Bl=Ol=Il=null,Fl=!1,Hl=zl=0,Gl=null}function Ge(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Bl?Il.memoizedState=Bl=e:Bl=Bl.next=e,Bl}function Ve(){if(null===Ol){var e=Il.alternate;e=null!==e?e.memoizedState:null}else e=Ol.next;var t=null===Bl?Il.memoizedState:Bl.next;if(null!==t)Bl=t,Ol=e;else{if(null===e){if(null===Il.alternate)throw Error(r(467));throw Error(r(310))}e={memoizedState:(Ol=e).memoizedState,baseState:Ol.baseState,baseQueue:Ol.baseQueue,queue:Ol.queue,next:null},null===Bl?Il.memoizedState=Bl=e:Bl=Bl.next=e}return Bl}function $e(e){var t=Hl;return Hl+=1,null===Gl&&(Gl=[]),e=ve(Gl,e,t),t=Il,null===(null===Bl?t.memoizedState:Bl.next)&&(t=t.alternate,di.H=null===t||null===t.memoizedState?Yl:Xl),e}function We(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return $e(e);if(e.$$typeof===ei)return Pn(e)}throw Error(r(438,String(e)))}function Ye(e){var t=null,n=Il.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Il.alternate;null!==r&&null!==(r=r.updateQueue)&&null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===n&&(n=$l(),Il.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=oi;return t.index++,n}function Xe(e,t){return"function"==typeof t?t(e):t}function Ke(e){return qe(Ve(),Ol,e)}function qe(e,t,n){var a=e.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=n;var i=e.baseQueue,s=a.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}t.baseQueue=i=s,a.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=o=null,c=null,d=t=i.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(Tc&h)===h:(Rl&h)===h){var p=d.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===fl&&(u=!0);else{if((Rl&p)===p){d=d.next,p===fl&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,Il.lanes|=p,Fc|=p}h=d.action,Ul&&n(s,h),s=d.hasEagerState?d.eagerState:n(s,h)}else p={lane:h,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=p,o=s):c=c.next=p,Il.lanes|=h,Fc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?o=s:c.next=l,!Lo(s,e.memoizedState)&&(Zl=!0,u&&null!==(n=xl)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,a.lastRenderedState=s}return null===i&&(a.lanes=0),[e.memoizedState,a.dispatch]}function Je(e){var t=Ve(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);Lo(s,t.memoizedState)||(Zl=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,a]}function Qe(e,t,n){var a=Il,i=Ve(),s=tl;if(s){if(void 0===n)throw Error(r(407));n=n()}else n=t();var o=!Lo((Ol||i).memoizedState,n);if(o&&(i.memoizedState=n,Zl=!0),i=i.queue,St(tt.bind(null,a,i,e),[e]),i.getSnapshot!==t||o||null!==Bl&&1&Bl.memoizedState.tag){if(a.flags|=2048,yt(9,et.bind(null,a,i,n,t),{destroy:void 0},null),null===kc)throw Error(r(349));s||60&Rl||Ze(a,t,n)}return n}function Ze(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Il.updateQueue)?(t=$l(),Il.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function et(e,t,n,r){t.value=n,t.getSnapshot=r,nt(t)&&rt(e)}function tt(e,t,n){return n(function(){nt(t)&&rt(e)})}function nt(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Lo(e,n)}catch(r){return!0}}function rt(e){var t=K(e,2);null!==t&&Wr(t,0,2)}function at(e){var t=Ge();if("function"==typeof e){var n=e;if(e=n(),Ul){E(!0);try{n()}finally{E(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xe,lastRenderedState:e},t}function it(e,t,n,r){return e.baseState=n,qe(e,Ol,"function"==typeof r?r:Xe)}function st(e,t,n,a,i){if(Gt(e))throw Error(r(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==di.T?n(!0):s.isTransition=!1,a(s),null===(n=t.pending)?(s.next=t.pending=s,ot(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ot(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=di.T,s={};di.T=s;try{var o=n(a,r),l=di.S;null!==l&&l(s,o),lt(e,t,o)}catch(c){dt(e,t,c)}finally{di.T=i}}else try{lt(e,t,i=n(a,r))}catch(d){dt(e,t,d)}}function lt(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){ct(e,t,n)},function(n){return dt(e,t,n)}):ct(e,t,n)}function ct(e,t,n){t.status="fulfilled",t.value=n,ut(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ot(e,n)))}function dt(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,ut(t),t=t.next}while(t!==r)}e.action=null}function ut(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ht(e,t){return t}function pt(e,t){if(tl){var n=kc.formState;if(null!==n){e:{var r=Il;if(tl){if(el){var a=Es(el,rl);if(a){el=Ps(a),r=Ts(a);break e}}U(r)}r=!1}r&&(t=n[0])}}(n=Ge()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ht,lastRenderedState:t},n.queue=r,n=Ut.bind(null,Il,r),r.dispatch=n,r=at(!1);var i=Ht.bind(null,Il,!1,r.queue);return a={state:t,dispatch:null,action:e,pending:null},(r=Ge()).queue=a,n=st.bind(null,Il,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function mt(e){return gt(Ve(),Ol,e)}function gt(e,t,n){t=qe(e,t,ht)[0],e=Ke(Xe)[0],t="object"==typeof t&&null!==t&&"function"==typeof t.then?$e(t):t;var r=Ve(),a=r.queue,i=a.dispatch;return n!==r.memoizedState&&(Il.flags|=2048,yt(9,ft.bind(null,a,n),{destroy:void 0},null)),[t,i,e]}function ft(e,t){e.action=t}function xt(e){var t=Ve(),n=Ol;if(null!==n)return gt(t,n,e);Ve(),t=t.memoizedState;var r=(n=Ve()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function yt(e,t,n,r){return e={tag:e,create:t,inst:n,deps:r,next:null},null===(t=Il.updateQueue)&&(t=$l(),Il.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function vt(){return Ve().memoizedState}function bt(e,t,n,r){var a=Ge();Il.flags|=e,a.memoizedState=yt(1|t,n,{destroy:void 0},void 0===r?null:r)}function wt(e,t,n,r){var a=Ve();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==Ol&&null!==r&&Ie(r,Ol.memoizedState.deps)?a.memoizedState=yt(t,n,i,r):(Il.flags|=e,a.memoizedState=yt(1|t,n,i,r))}function Nt(e,t){bt(8390656,8,e,t)}function St(e,t){wt(2048,8,e,t)}function jt(e,t){return wt(4,2,e,t)}function _t(e,t){return wt(4,4,e,t)}function At(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ct(e,t,n){n=null!=n?n.concat([e]):null,wt(4,4,At.bind(null,t,e),n)}function Mt(){}function kt(e,t){var n=Ve();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Ie(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Et(e,t){var n=Ve();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Ie(t,r[1]))return r[0];if(r=e(),Ul){E(!0);try{e()}finally{E(!1)}}return n.memoizedState=[r,t],r}function Tt(e,t,n){return void 0===n||1073741824&Rl?e.memoizedState=t:(e.memoizedState=n,e=$r(),Il.lanes|=e,Fc|=e,n)}function Pt(e,t,n,r){return Lo(n,t)?n:null!==kl.current?(e=Tt(e,n,r),Lo(e,t)||(Zl=!0),e):42&Rl?(e=$r(),Il.lanes|=e,Fc|=e,t):(Zl=!0,e.memoizedState=n)}function Dt(e,t,n,r,a){var i=Oi();Ii(0!==i&&8>i?i:8);var s,o,l,c=di.T,d={};di.T=d,Ht(e,!1,t,n);try{var u=a(),h=di.S;if(null!==h&&h(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then){var p=(s=r,o=[],l={status:"pending",value:null,reason:null,then:function(e){o.push(e)}},u.then(function(){l.status="fulfilled",l.value=s;for(var e=0;e<o.length;e++)(0,o[e])(s)},function(e){for(l.status="rejected",l.reason=e,e=0;e<o.length;e++)(0,o[e])(void 0)}),l);zt(e,t,p,Vr())}else zt(e,t,r,Vr())}catch(m){zt(e,t,{then:function(){},status:"rejected",reason:m},Vr())}finally{Ii(i),di.T=c}}function Rt(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:$i,baseState:$i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xe,lastRenderedState:$i},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xe,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function It(){return Pn(Wi)}function Ot(){return Ve().memoizedState}function Bt(){return Ve().memoizedState}function Lt(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Vr(),r=ce(t,e=le(n),n);return null!==r&&(Wr(r,0,n),de(r,t,n)),t={cache:In()},void(e.payload=t)}t=t.return}}function Ft(e,t,n){var r=Vr();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Gt(e)?Vt(t,n):null!==(n=X(e,t,n,r))&&(Wr(n,0,r),$t(n,t,r))}function Ut(e,t,n){zt(e,t,n,Vr())}function zt(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gt(e))Vt(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,Lo(o,s))return Y(e,t,a,0),null===kc&&W(),!1}catch(l){}if(null!==(n=X(e,t,a,r)))return Wr(n,0,r),$t(n,t,r),!0}return!1}function Ht(e,t,n,a){if(a={lane:2,revertLane:ae(),action:a,hasEagerState:!1,eagerState:null,next:null},Gt(e)){if(t)throw Error(r(479))}else null!==(t=X(e,n,a,2))&&Wr(t,0,2)}function Gt(e){var t=e.alternate;return e===Il||null!==t&&t===Il}function Vt(e,t){Fl=Ll=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $t(e,t,n){if(4194176&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,M(e,n)}}function Wt(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:$a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}function Yt(e,t,n,r,a,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!(t.prototype&&t.prototype.isPureReactComponent&&fe(n,r)&&fe(a,i))}function Xt(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ql.enqueueReplaceState(t,t.state,null)}function Kt(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=$a({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function qt(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(bI){setTimeout(function(){throw bI})}}function Jt(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(bI){setTimeout(function(){throw bI})}}function Qt(e,t,n){return(n=le(n)).tag=3,n.payload={element:null},n.callback=function(){qt(e,t)},n}function Zt(e){return(e=le(e)).tag=3,e}function en(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Jt(t,n,r)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){Jt(t,n,r),"function"!=typeof a&&(null===qc?qc=new Set([this]):qc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}function tn(e,t,n,r){t.child=null===e?Ml(t,null,n,r):Cl(t,e.child,n,r)}function nn(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return Tn(t),r=Oe(e,t,n,s,i,a),o=Ue(),null===e||Zl?(tl&&o&&R(t),t.flags|=1,tn(e,t,r,a),t.child):(ze(e,t,a),Nn(e,t,a))}function rn(e,t,n,r,a){if(null===e){var i=n.type;return"function"!=typeof i||_a(i)||void 0!==i.defaultProps||null!==n.compare?((e=Ma(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,an(e,t,i,r,a))}if(i=e.child,!Sn(e,a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:fe)(s,r)&&e.ref===t.ref)return Nn(e,t,a)}return t.flags|=1,(e=Aa(i,r)).ref=t.ref,e.return=t,t.child=e}function an(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(fe(i,r)&&e.ref===t.ref){if(Zl=!1,t.pendingProps=r=i,!Sn(e,a))return t.lanes=e.lanes,Nn(e,t,a);131072&e.flags&&(Zl=!0)}}return cn(e,t,n,r,a)}function sn(e,t,n){var r=t.pendingProps,a=r.children,i=!!(2&t.stateNode._pendingVisibility),s=null!==e?e.memoizedState:null;if(ln(e,t),"hidden"===r.mode||i){if(128&t.flags){if(r=null!==s?s.baseLanes|n:n,null!==e){for(a=t.child=e.child,i=0;null!==a;)i=i|a.lanes|a.childLanes,a=a.sibling;t.childLanes=i&~r}else t.childLanes=0,t.child=null;return on(e,t,r,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,on(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ln(0,null!==s?s.cachePool:null),null!==s?Ae(t,s):Ce(),Ee(t)}else null!==s?(Ln(0,s.cachePool),Ae(t,s),Te(),t.memoizedState=null):(null!==e&&Ln(0,null),Ce(),Te());return tn(e,t,a,n),t.child}function on(e,t,n,r){var a=Bn();return a=null===a?null:{parent:ki?oc._currentValue:oc._currentValue2,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Ln(0,null),Ce(),Ee(t),null!==e&&kn(e,t,r,!0),null}function ln(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(r(284));null!==e&&e.ref===n||(t.flags|=2097664)}}function cn(e,t,n,r,a){return Tn(t),n=Oe(e,t,n,r,void 0,a),r=Ue(),null===e||Zl?(tl&&r&&R(t),t.flags|=1,tn(e,t,n,a),t.child):(ze(e,t,a),Nn(e,t,a))}function dn(e,t,n,r,a,i){return Tn(t),t.updateQueue=null,n=Le(t,r,n,a),Be(e),r=Ue(),null===e||Zl?(tl&&r&&R(t),t.flags|=1,tn(e,t,n,i),t.child):(ze(e,t,i),Nn(e,t,i))}function un(e,t,n,r,a){if(Tn(t),null===t.stateNode){var i=vo,s=n.contextType;"object"==typeof s&&null!==s&&(i=Pn(s)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=ql,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},se(t),s=n.contextType,i.context="object"==typeof s&&null!==s?Pn(s):vo,i.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(Wt(t,n,s,r),i.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(s=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&ql.enqueueReplaceState(i,i.state,null),pe(t,r,i,a),he(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var o=t.memoizedProps,l=Kt(n,o);i.props=l;var c=i.context,d=n.contextType;s=vo,"object"==typeof d&&null!==d&&(s=Pn(d));var u=n.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o||c!==s)&&Xt(t,i,r,s),yl=!1;var h=t.memoizedState;i.state=h,pe(t,r,i,a),he(),c=t.memoizedState,o||h!==c||yl?("function"==typeof u&&(Wt(t,n,u,r),c=t.memoizedState),(l=yl||Yt(t,n,l,r,h,c,s))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=s,r=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,oe(e,t),d=Kt(n,s=t.memoizedProps),i.props=d,u=t.pendingProps,h=i.context,c=n.contextType,l=vo,"object"==typeof c&&null!==c&&(l=Pn(c)),(c="function"==typeof(o=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==u||h!==l)&&Xt(t,i,r,l),yl=!1,h=t.memoizedState,i.state=h,pe(t,r,i,a),he();var p=t.memoizedState;s!==u||h!==p||yl||null!==e&&null!==e.dependencies&&En(e.dependencies)?("function"==typeof o&&(Wt(t,n,o,r),p=t.memoizedState),(d=yl||Yt(t,n,d,r,h,p,l)||null!==e&&null!==e.dependencies&&En(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,p,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),i.props=r,i.state=p,i.context=l,r=d):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,ln(e,t),r=!!(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=Cl(t,e.child,null,a),t.child=Cl(t,null,n,a)):tn(e,t,n,a),t.memoizedState=i.state,e=t.child):e=Nn(e,t,a),e}function hn(e,t,n,r){return V(),t.flags|=256,tn(e,t,n,r),t.child}function pn(e){return{baseLanes:e,cachePool:Fn()}}function mn(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Hc),e}function gn(e,n,a){var i,s=n.pendingProps,o=!1,l=!!(128&n.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&!!(2&Dl.current)),i&&(o=!0,n.flags&=-129),i=!!(32&n.flags),n.flags&=-33,null===e){if(tl){if(o?ke(n):Te(),tl){var c,d=el;(c=d)&&(null!==(d=Ls(d,rl))?(n.memoizedState={dehydrated:d,treeContext:null!==Wo?{id:Yo,overflow:Xo}:null,retryLane:536870912},(c=t(18,null,null,0)).stateNode=d,c.return=n,n.child=c,Zo=n,el=null,c=!0):c=!1),c||U(n)}if(null!==(d=n.memoizedState)&&null!==(d=d.dehydrated))return Cs(d)?n.lanes=16:n.lanes=536870912,null;Pe(n)}return d=s.children,s=s.fallback,o?(Te(),d=xn({mode:"hidden",children:d},o=n.mode),s=ka(s,o,a,null),d.return=n,s.return=n,d.sibling=s,n.child=d,(o=n.child).memoizedState=pn(a),o.childLanes=mn(e,i,a),n.memoizedState=ec,s):(ke(n),fn(n,d))}if(null!==(c=e.memoizedState)&&null!==(d=c.dehydrated)){if(l)256&n.flags?(ke(n),n.flags&=-257,n=yn(e,n,a)):null!==n.memoizedState?(Te(),n.child=e.child,n.flags|=128,n=null):(Te(),o=s.fallback,d=n.mode,s=xn({mode:"visible",children:s.children},d),(o=ka(o,d,a,null)).flags|=2,s.return=n,o.return=n,s.sibling=o,n.child=s,Cl(n,e.child,null,a),(s=n.child).memoizedState=pn(a),s.childLanes=mn(e,i,a),n.memoizedState=ec,n=o);else if(ke(n),Cs(d))i=Ms(d).digest,(s=Error(r(419))).stack="",s.digest=i,$({value:s,source:null,stack:null}),n=yn(e,n,a);else if(Zl||kn(e,n,a,!1),i=0!==(a&e.childLanes),Zl||i){if(null!==(i=kc)){if(42&(s=a&-a))s=1;else switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=64;break;case 268435456:s=134217728;break;default:s=0}if(0!==(s=0!==(s&(i.suspendedLanes|a))?0:s)&&s!==c.retryLane)throw c.retryLane=s,K(e,s),Wr(i,0,s),Ql}As(d)||ia(),n=yn(e,n,a)}else As(d)?(n.flags|=128,n.child=e.child,n=Na.bind(null,e),ks(d,n),n=null):(e=c.treeContext,Pi&&(el=Is(d),Zo=n,tl=!0,nl=null,rl=!1,null!==e&&(Vo[$o++]=Yo,Vo[$o++]=Xo,Vo[$o++]=Wo,Yo=e.id,Xo=e.overflow,Wo=n)),(n=fn(n,s.children)).flags|=4096);return n}return o?(Te(),o=s.fallback,d=n.mode,l=(c=e.child).sibling,(s=Aa(c,{mode:"hidden",children:s.children})).subtreeFlags=31457280&c.subtreeFlags,null!==l?o=Aa(l,o):(o=ka(o,d,a,null)).flags|=2,o.return=n,s.return=n,s.sibling=o,n.child=s,s=o,o=n.child,null===(d=e.child.memoizedState)?d=pn(a):(null!==(c=d.cachePool)?(l=ki?oc._currentValue:oc._currentValue2,c=c.parent!==l?{parent:l,pool:l}:c):c=Fn(),d={baseLanes:d.baseLanes|a,cachePool:c}),o.memoizedState=d,o.childLanes=mn(e,i,a),n.memoizedState=ec,s):(ke(n),e=(a=e.child).sibling,(a=Aa(a,{mode:"visible",children:s.children})).return=n,a.sibling=null,null!==e&&(null===(i=n.deletions)?(n.deletions=[e],n.flags|=16):i.push(e)),n.child=a,n.memoizedState=null,a)}function fn(e,t){return(t=xn({mode:"visible",children:t},e.mode)).return=e,e.child=t}function xn(e,t){return Ea(e,t,0,null)}function yn(e,t,n){return Cl(t,e.child,null,n),(e=fn(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function vn(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Cn(e.return,t,n)}function bn(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function wn(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(tn(e,t,r.children,n),2&(r=Dl.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&vn(e,n,t);else if(19===e.tag)vn(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(y(Dl,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===De(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),bn(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===De(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}bn(t,!0,n,null,i);break;case"together":bn(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Nn(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(kn(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Aa(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Aa(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Sn(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!En(e))}function jn(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Zl=!0;else{if(!(Sn(e,n)||128&t.flags))return Zl=!1,function(e,t,n){switch(t.tag){case 3:O(t,t.stateNode.containerInfo),_n(0,oc,e.memoizedState.cache),V();break;case 27:case 5:L(t);break;case 4:O(t,t.stateNode.containerInfo);break;case 10:_n(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ke(t),t.flags|=128,null):0!==(n&t.child.childLanes)?gn(e,t,n):(ke(t),null!==(e=Nn(e,t,n))?e.sibling:null);ke(t);break;case 19:var a=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(kn(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return wn(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),y(Dl,Dl.current),r)break;return null;case 22:case 23:return t.lanes=0,sn(e,t,n);case 24:_n(0,oc,e.memoizedState.cache)}return Nn(e,t,n)}(e,t,n);Zl=!!(131072&e.flags)}else Zl=!1,tl&&1048576&t.flags&&D(t,Go,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,s=a._init;if(a=s(a._payload),t.type=a,"function"!=typeof a){if(null!=a){if((s=a.$$typeof)===ti){t.tag=11,t=nn(null,t,a,e,n);break e}if(s===ai){t.tag=14,t=rn(null,t,a,e,n);break e}}throw t=i(a)||a,Error(r(306,t,""))}_a(a)?(e=Kt(a,e),t.tag=1,t=un(null,t,a,e,n)):(t.tag=0,t=cn(null,t,a,e,n))}return t;case 0:return cn(e,t,t.type,t.pendingProps,n);case 1:return un(e,t,a=t.type,s=Kt(a,t.pendingProps),n);case 3:e:{if(O(t,t.stateNode.containerInfo),null===e)throw Error(r(387));var o=t.pendingProps;a=(s=t.memoizedState).element,oe(e,t),pe(t,o,null,n);var l=t.memoizedState;if(o=l.cache,_n(0,oc,o),o!==s.cache&&Mn(t,[oc],n,!0),he(),o=l.element,Pi&&s.isDehydrated){if(s={element:o,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=hn(e,t,o,n);break e}if(o!==a){$(a=T(Error(r(424)),t)),t=hn(e,t,o,n);break e}for(Pi&&(el=Rs(t.stateNode.containerInfo),Zo=t,tl=!0,nl=null,rl=!0),n=Ml(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(V(),o===a){t=Nn(e,t,n);break e}tn(e,t,o,n)}t=t.child}return t;case 26:if(qs)return ln(e,t),null===e?(n=Zs(t.type,null,t.pendingProps,null))?t.memoizedState=n:tl||(t.stateNode=io(t.type,t.pendingProps,Jo.current,t)):t.memoizedState=Zs(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:if(uo)return L(t),null===e&&uo&&tl&&(a=t.stateNode=ho(t.type,t.pendingProps,Jo.current,Ko.current,!1),Zo=t,rl=!0,el=Ds(a)),a=t.pendingProps.children,null!==e||tl?tn(e,t,a,n):t.child=Cl(t,null,a,n),ln(e,t),t.child;case 5:return null===e&&tl&&(Xs(t.type,t.pendingProps,Ko.current),(s=a=el)&&(null!==(a=Os(a,t.type,t.pendingProps,rl))?(t.stateNode=a,Zo=t,el=Ds(a),rl=!1,s=!0):s=!1),s||U(t)),L(t),s=t.type,o=t.pendingProps,l=null!==e?e.memoizedProps:null,a=o.children,ji(s,o)?a=null:null!==l&&ji(s,l)&&(t.flags|=32),null!==t.memoizedState&&(s=Oe(e,t,Fe,null,null,n),ki?Wi._currentValue=s:Wi._currentValue2=s),ln(e,t),tn(e,t,a,n),t.child;case 6:return null===e&&tl&&(Ks(t.pendingProps,Ko.current),(e=n=el)&&(null!==(n=Bs(n,t.pendingProps,rl))?(t.stateNode=n,Zo=t,el=null,e=!0):e=!1),e||U(t)),null;case 13:return gn(e,t,n);case 4:return O(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=Cl(t,null,a,n):tn(e,t,a,n),t.child;case 11:return nn(e,t,t.type,t.pendingProps,n);case 7:return tn(e,t,t.pendingProps,n),t.child;case 8:case 12:return tn(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,_n(0,t.type,a.value),tn(e,t,a.children,n),t.child;case 9:return s=t.type._context,a=t.pendingProps.children,Tn(t),a=a(s=Pn(s)),t.flags|=1,tn(e,t,a,n),t.child;case 14:return rn(e,t,t.type,t.pendingProps,n);case 15:return an(e,t,t.type,t.pendingProps,n);case 19:return wn(e,t,n);case 22:return sn(e,t,n);case 24:return Tn(t),a=Pn(oc),null===e?(null===(s=Bn())&&(s=kc,o=In(),s.pooledCache=o,o.refCount++,null!==o&&(s.pooledCacheLanes|=n),s=o),t.memoizedState={parent:a,cache:s},se(t),_n(0,oc,s)):(0!==(e.lanes&n)&&(oe(e,t),pe(t,null,null,n),he()),s=e.memoizedState,o=t.memoizedState,s.parent!==a?(s={parent:a,cache:a},t.memoizedState=s,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=s),_n(0,oc,a)):(a=o.cache,_n(0,oc,a),a!==s.cache&&Mn(t,[oc],n,!0))),tn(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(r(156,t.tag))}function _n(e,t,n){ki?(y(tc,t._currentValue),t._currentValue=n):(y(tc,t._currentValue2),t._currentValue2=n)}function An(e){var t=tc.current;ki?e._currentValue=t:e._currentValue2=t,x(tc)}function Cn(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Mn(e,t,n,a){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var o=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Cn(s.return,n,e),a||(o=null);break e}s=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(r(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),Cn(o,n,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function kn(e,t,n,a){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(524288&i.flags)s=!0;else if(262144&i.flags)break;if(10===i.tag){var o=i.alternate;if(null===o)throw Error(r(387));if(null!==(o=o.memoizedProps)){var l=i.type;Lo(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===Qo.current){if(null===(o=i.alternate))throw Error(r(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Wi):e=[Wi])}i=i.return}null!==e&&Mn(t,e,n,a),t.flags|=262144}function En(e){for(e=e.firstContext;null!==e;){var t=e.context;if(!Lo(ki?t._currentValue:t._currentValue2,e.memoizedValue))return!0;e=e.next}return!1}function Tn(e){nc=e,rc=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pn(e){return Rn(nc,e)}function Dn(e,t){return null===nc&&Tn(e),Rn(e,t)}function Rn(e,t){var n=ki?t._currentValue:t._currentValue2;if(t={context:t,memoizedValue:n,next:null},null===rc){if(null===e)throw Error(r(308));rc=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else rc=rc.next=t;return n}function In(){return{controller:new ac,data:new Map,refCount:0}}function On(e){e.refCount--,0===e.refCount&&ic(sc,function(){e.controller.abort()})}function Bn(){var e=cc.current;return null!==e?e:kc.pooledCache}function Ln(e,t){y(cc,null===t?cc.current:t.pool)}function Fn(){var e=Bn();return null===e?null:{parent:ki?oc._currentValue:oc._currentValue2,pool:e}}function Un(e){e.flags|=4}function zn(e,t){if(null!==e&&e.child===t.child)return!1;if(16&t.flags)return!0;for(e=t.child;null!==e;){if(13878&e.flags||13878&e.subtreeFlags)return!0;e=e.sibling}return!1}function Hn(e,t,n,r){if(Ei)for(n=t.child;null!==n;){if(5===n.tag||6===n.tag)Ni(e,n.stateNode);else if(!(4===n.tag||uo&&27===n.tag)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else if(Ti)for(var a=t.child;null!==a;){if(5===a.tag){var i=a.stateNode;n&&r&&(i=js(i,a.type,a.memoizedProps)),Ni(e,i)}else if(6===a.tag)i=a.stateNode,n&&r&&(i=_s(i,a.memoizedProps)),Ni(e,i);else if(4!==a.tag)if(22===a.tag&&null!==a.memoizedState)null!==(i=a.child)&&(i.return=a),Hn(e,a,!0,!0);else if(null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}}function Gn(e,t,n,r){if(Ti)for(var a=t.child;null!==a;){if(5===a.tag){var i=a.stateNode;n&&r&&(i=js(i,a.type,a.memoizedProps)),ws(e,i)}else if(6===a.tag)i=a.stateNode,n&&r&&(i=_s(i,a.memoizedProps)),ws(e,i);else if(4!==a.tag)if(22===a.tag&&null!==a.memoizedState)null!==(i=a.child)&&(i.return=a),Gn(e,a,!(null!==a.memoizedProps&&"manual"===a.memoizedProps.mode),!0);else if(null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}}function Vn(e,t){if(Ti&&zn(e,t)){var n=(e=t.stateNode).containerInfo,r=bs();Gn(r,t,!1,!1),e.pendingChildren=r,Un(t),Ns(n,r)}}function $n(e,t,n,r){if(Ei)e.memoizedProps!==r&&Un(t);else if(Ti){var a=e.stateNode,i=e.memoizedProps;if((e=zn(e,t))||i!==r){var s=Ko.current;(i=vs(a,n,i,r,!e,null))===a?t.stateNode=a:(Si(i,n,r,s)&&Un(t),t.stateNode=i,e?Hn(i,t,!1,!1):Un(t))}else t.stateNode=a}}function Wn(e,t,n){if(Ui(t,n)){if(e.flags|=16777216,!zi(t,n)){if(!na())throw jl=Sl,Nl;e.flags|=8192}}else e.flags&=-16777217}function Yn(e,t){if(oo(t)){if(e.flags|=16777216,!lo(t)){if(!na())throw jl=Sl,Nl;e.flags|=8192}}else e.flags&=-16777217}function Xn(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?j():536870912,e.lanes|=t,Gc|=t)}function Kn(e,t){if(!tl)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qn(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=31457280&a.subtreeFlags,r|=31457280&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Jn(e,t,n){var a=t.pendingProps;switch(I(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return qn(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),An(oc),B(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(G(t)?Un(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==nl&&(Xr(nl),nl=null))),Vn(e,t),qn(t),null;case 26:if(qs){n=t.type;var i=t.memoizedState;return null===e?(Un(t),null!==i?(qn(t),Yn(t,i)):(qn(t),Wn(t,n,a))):i?i!==e.memoizedState?(Un(t),qn(t),Yn(t,i)):(qn(t),t.flags&=-16777217):(Ei?e.memoizedProps!==a&&Un(t):$n(e,t,n,a),qn(t),Wn(t,n,a)),null}case 27:if(uo){if(F(t),n=Jo.current,i=t.type,null!==e&&null!=t.stateNode)Ei?e.memoizedProps!==a&&Un(t):$n(e,t,i,a);else{if(!a){if(null===t.stateNode)throw Error(r(166));return qn(t),null}e=Ko.current,G(t)?z(t,e):(e=ho(i,a,n,e,!0),t.stateNode=e,Un(t))}return qn(t),null}case 5:if(F(t),n=t.type,null!==e&&null!=t.stateNode)$n(e,t,n,a);else{if(!a){if(null===t.stateNode)throw Error(r(166));return qn(t),null}e=Ko.current,G(t)?z(t,e):(Hn(i=wi(n,a,Jo.current,e,t),t,!1,!1),t.stateNode=i,Si(i,n,a,e)&&Un(t))}return qn(t),Wn(t,t.type,t.pendingProps),null;case 6:if(e&&null!=t.stateNode)n=e.memoizedProps,Ei?n!==a&&Un(t):Ti&&(n!==a?(t.stateNode=_i(a,Jo.current,Ko.current,t),Un(t)):t.stateNode=e.stateNode);else{if("string"!=typeof a&&null===t.stateNode)throw Error(r(166));if(e=Jo.current,n=Ko.current,G(t)){if(!Pi)throw Error(r(176));if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(i=Zo))switch(i.tag){case 27:case 5:a=i.memoizedProps}Us(e,n,t,a)||U(t)}else t.stateNode=_i(a,e,n,t)}return qn(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=G(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!Pi)throw Error(r(344));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));zs(i,t)}else V(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qn(t),i=!1}else null!==nl&&(Xr(nl),nl=null),i=!0;if(!i)return 256&t.flags?(Pe(t),t):(Pe(t),null)}if(Pe(t),128&t.flags)return t.lanes=n,t;if(n=null!==a,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(i=a.alternate.memoizedState.cachePool.pool);var s=null;null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(s=a.memoizedState.cachePool.pool),s!==i&&(a.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Xn(t,t.updateQueue),qn(t),null;case 4:return B(),Vn(e,t),null===e&&Ri(t.stateNode.containerInfo),qn(t),null;case 10:return An(t.type),qn(t),null;case 19:if(x(Dl),null===(i=t.memoizedState))return qn(t),null;if(a=!!(128&t.flags),null===(s=i.rendering))if(a)Kn(i,!1);else{if(0!==Lc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(s=De(e))){for(t.flags|=128,Kn(i,!1),e=s.updateQueue,t.updateQueue=e,Xn(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Ca(n,e),n=n.sibling;return y(Dl,1&Dl.current|2),t.child}e=e.sibling}null!==i.tail&&ko()>Xc&&(t.flags|=128,a=!0,Kn(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=De(s))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,Xn(t,e),Kn(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!tl)return qn(t),null}else 2*ko()-i.renderingStartTime>Xc&&536870912!==n&&(t.flags|=128,a=!0,Kn(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=ko(),t.sibling=null,e=Dl.current,y(Dl,a?1&e|2:1&e),t):(qn(t),null);case 22:case 23:return Pe(t),Me(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?!!(536870912&n)&&!(128&t.flags)&&(qn(t),6&t.subtreeFlags&&(t.flags|=8192)):qn(t),null!==(n=t.updateQueue)&&Xn(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&x(cc),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),An(oc),qn(t),null;case 25:return null}throw Error(r(156,t.tag))}function Qn(e,t){switch(I(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return An(oc),B(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return F(t),null;case 13:if(Pe(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));V()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return x(Dl),null;case 4:return B(),null;case 10:return An(t.type),null;case 22:case 23:return Pe(t),Me(),null!==e&&x(cc),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return An(oc),null;default:return null}}function Zn(e,t){switch(I(t),t.tag){case 3:An(oc),B();break;case 26:case 27:case 5:F(t);break;case 4:B();break;case 13:Pe(t);break;case 19:x(Dl);break;case 10:An(t.type);break;case 22:case 23:Pe(t),Me(),null!==e&&x(cc);break;case 24:An(oc)}}function er(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,s=n.inst;r=i(),s.destroy=r}n=n.next}while(n!==a)}}catch(o){ya(t,t.return,o)}}function tr(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,a=t;var l=n;try{o()}catch(c){ya(a,l,c)}}}r=r.next}while(r!==i)}}catch(c){ya(t,t.return,c)}}function nr(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ge(t,n)}catch(r){ya(e,e.return,r)}}}function rr(e,t,n){n.props=Kt(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){ya(e,t,r)}}function ar(e,t){try{var n=e.ref;if(null!==n){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var a=fi(r);break;default:a=r}"function"==typeof n?e.refCleanup=n(a):n.current=a}}catch(i){ya(e,t,i)}}function ir(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r()}catch(a){ya(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(i){ya(e,t,i)}else n.current=null}function sr(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{os(r,t,n,e)}catch(a){ya(e,e.return,a)}}function or(e,t,n){try{ls(e.stateNode,e.type,n,t,e)}catch(r){ya(e,e.return,r)}}function lr(e){return 5===e.tag||3===e.tag||!!qs&&26===e.tag||!!uo&&27===e.tag||4===e.tag}function cr(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||lr(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&(!uo||27!==e.tag)&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function dr(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ds(n,e,t):is(n,e);else if(!(4===r||uo&&27===r)&&null!==(e=e.child))for(dr(e,t,n),e=e.sibling;null!==e;)dr(e,t,n),e=e.sibling}function ur(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?cs(n,e,t):as(n,e);else if(!(4===r||uo&&27===r)&&null!==(e=e.child))for(ur(e,t,n),e=e.sibling;null!==e;)ur(e,t,n),e=e.sibling}function hr(e,t,n){e=e.containerInfo;try{Ss(e,n)}catch(r){ya(t,t.return,r)}}function pr(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Sr(e,n),4&r&&er(5,n);break;case 1:if(Sr(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){ya(n,n.return,o)}else{var a=Kt(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){ya(n,n.return,l)}}64&r&&nr(n),512&r&&ar(n,n.return);break;case 3:if(Sr(e,n),64&r&&null!==(r=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 27:case 5:e=fi(n.child.stateNode);break;case 1:e=n.child.stateNode}try{ge(r,e)}catch(o){ya(n,n.return,o)}}break;case 26:if(qs){Sr(e,n),512&r&&ar(n,n.return);break}case 27:case 5:Sr(e,n),null===t&&4&r&&sr(n),512&r&&ar(n,n.return);break;case 12:Sr(e,n);break;case 13:Sr(e,n),4&r&&xr(e,n);break;case 22:if(!(a=null!==n.memoizedState||dc)){t=null!==t&&null!==t.memoizedState||uc;var i=dc,s=uc;dc=a,(uc=t)&&!s?_r(e,n,!!(8772&n.subtreeFlags)):Sr(e,n),dc=i,uc=s}512&r&&("manual"===n.memoizedProps.mode?ar(n,n.return):ir(n,n.return));break;default:Sr(e,n)}}function mr(e){var t=e.alternate;null!==t&&(e.alternate=null,mr(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&Fi(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gr(e,t,n){for(n=n.child;null!==n;)fr(e,t,n),n=n.sibling}function fr(e,t,n){if(Bo&&"function"==typeof Bo.onCommitFiberUnmount)try{Bo.onCommitFiberUnmount(Oo,n)}catch(i){}switch(n.tag){case 26:if(qs){uc||ir(n,t),gr(e,t,n),n.memoizedState?to(n.memoizedState):n.stateNode&&ao(n.stateNode);break}case 27:if(uo){uc||ir(n,t);var r=fc,a=xc;fc=n.stateNode,gr(e,t,n),go(n.stateNode),fc=r,xc=a;break}case 5:uc||ir(n,t);case 6:if(Ei){if(r=fc,a=xc,fc=null,gr(e,t,n),xc=a,null!==(fc=r))if(xc)try{hs(fc,n.stateNode)}catch(s){ya(n,t,s)}else try{us(fc,n.stateNode)}catch(s){ya(n,t,s)}}else gr(e,t,n);break;case 18:Ei&&null!==fc&&(xc?Ws(fc,n.stateNode):$s(fc,n.stateNode));break;case 4:Ei?(r=fc,a=xc,fc=n.stateNode.containerInfo,xc=!0,gr(e,t,n),fc=r,xc=a):(Ti&&hr(n.stateNode,n,bs()),gr(e,t,n));break;case 0:case 11:case 14:case 15:uc||tr(2,n,t),uc||tr(4,n,t),gr(e,t,n);break;case 1:uc||(ir(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&rr(n,t,r)),gr(e,t,n);break;case 21:gr(e,t,n);break;case 22:uc||ir(n,t),uc=(r=uc)||null!==n.memoizedState,gr(e,t,n),uc=r;break;default:gr(e,t,n)}}function xr(e,t){if(Pi&&null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{Vs(e)}catch(n){ya(t,t.return,n)}}function yr(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new pc),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new pc),t;default:throw Error(r(435,e.tag))}}(e);t.forEach(function(t){var r=Sa.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function vr(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var i=n[a],s=e,o=t;if(Ei){var l=o;e:for(;null!==l;){switch(l.tag){case 27:case 5:fc=l.stateNode,xc=!1;break e;case 3:case 4:fc=l.stateNode.containerInfo,xc=!0;break e}l=l.return}if(null===fc)throw Error(r(160));fr(s,o,i),fc=null,xc=!1}else fr(s,o,i);null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)br(t,e),t=t.sibling}function br(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:vr(t,e),wr(e),4&a&&(tr(3,e,e.return),er(3,e),tr(5,e,e.return));break;case 1:vr(t,e),wr(e),512&a&&(uc||null===n||ir(n,n.return)),64&a&&dc&&null!==(e=e.updateQueue)&&null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a));break;case 26:if(qs){var i=yc;vr(t,e),wr(e),512&a&&(uc||null===n||ir(n,n.return)),4&a&&(a=null!==n?n.memoizedState:null,t=e.memoizedState,null===n?null===t?null===e.stateNode?e.stateNode=no(i,e.type,e.memoizedProps,e):ro(i,e.type,e.stateNode):e.stateNode=eo(i,t,e.memoizedProps):a!==t?(null===a?null!==n.stateNode&&ao(n.stateNode):to(a),null===t?ro(i,e.type,e.stateNode):eo(i,t,e.memoizedProps)):null===t&&null!==e.stateNode&&or(e,e.memoizedProps,n.memoizedProps));break}case 27:if(uo&&4&a&&null===e.alternate){i=e.stateNode;var s=e.memoizedProps;try{po(i),mo(e.type,s,i,e)}catch(u){ya(e,e.return,u)}}case 5:if(vr(t,e),wr(e),512&a&&(uc||null===n||ir(n,n.return)),Ei){if(32&e.flags){t=e.stateNode;try{ps(t)}catch(u){ya(e,e.return,u)}}4&a&&null!=e.stateNode&&or(e,t=e.memoizedProps,null!==n?n.memoizedProps:t),1024&a&&(hc=!0)}break;case 6:if(vr(t,e),wr(e),4&a&&Ei){if(null===e.stateNode)throw Error(r(162));a=e.memoizedProps,n=null!==n?n.memoizedProps:a,t=e.stateNode;try{ss(t,n,a)}catch(u){ya(e,e.return,u)}}break;case 3:if(qs?(so(),i=yc,yc=Qs(t.containerInfo),vr(t,e),yc=i):vr(t,e),wr(e),4&a){if(Ei&&Pi&&null!==n&&n.memoizedState.isDehydrated)try{Gs(t.containerInfo)}catch(u){ya(e,e.return,u)}if(Ti){a=t.containerInfo,n=t.pendingChildren;try{Ss(a,n)}catch(u){ya(e,e.return,u)}}}hc&&(hc=!1,Nr(e));break;case 4:qs?(n=yc,yc=Qs(e.stateNode.containerInfo),vr(t,e),wr(e),yc=n):(vr(t,e),wr(e)),4&a&&Ti&&hr(e.stateNode,e,e.stateNode.pendingChildren);break;case 12:vr(t,e),wr(e);break;case 13:vr(t,e),wr(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Yc=ko()),4&a&&null!==(a=e.updateQueue)&&(e.updateQueue=null,yr(e,a));break;case 22:512&a&&(uc||null===n||ir(n,n.return)),i=null!==e.memoizedState;var o=null!==n&&null!==n.memoizedState,l=dc,c=uc;if(dc=l||i,uc=c||o,vr(t,e),uc=c,dc=l,wr(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&a&&(t._visibility=i?-2&t._visibility:1|t._visibility,i&&(t=dc||uc,null===n||o||t||jr(e)),Ei&&(null===e.memoizedProps||"manual"!==e.memoizedProps.mode)))e:if(n=null,Ei)for(t=e;;){if(5===t.tag||qs&&26===t.tag||uo&&27===t.tag){if(null===n){o=n=t;try{s=o.stateNode,i?ms(s):fs(o.stateNode,o.memoizedProps)}catch(u){ya(o,o.return,u)}}}else if(6===t.tag){if(null===n){o=t;try{var d=o.stateNode;i?gs(d):xs(d,o.memoizedProps)}catch(u){ya(o,o.return,u)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&null!==(a=e.updateQueue)&&null!==(n=a.retryQueue)&&(a.retryQueue=null,yr(e,n));break;case 19:vr(t,e),wr(e),4&a&&null!==(a=e.updateQueue)&&(e.updateQueue=null,yr(e,a));break;case 21:break;default:vr(t,e),wr(e)}}function wr(e){var t=e.flags;if(2&t){try{if(Ei&&(!uo||27!==e.tag)){e:{for(var n=e.return;null!==n;){if(lr(n)){var a=n;break e}n=n.return}throw Error(r(160))}switch(a.tag){case 27:if(uo){var i=a.stateNode;ur(e,cr(e),i);break}case 5:var s=a.stateNode;32&a.flags&&(ps(s),a.flags&=-33),ur(e,cr(e),s);break;case 3:case 4:var o=a.stateNode.containerInfo;dr(e,cr(e),o);break;default:throw Error(r(161))}}}catch(l){ya(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Nr(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Nr(t),5===t.tag&&1024&t.flags&&Yi(t.stateNode),e=e.sibling}}function Sr(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)pr(e,t.alternate,t),t=t.sibling}function jr(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:tr(4,t,t.return),jr(t);break;case 1:ir(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&rr(t,t.return,n),jr(t);break;case 26:case 27:case 5:ir(t,t.return),jr(t);break;case 22:ir(t,t.return),null===t.memoizedState&&jr(t);break;default:jr(t)}e=e.sibling}}function _r(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:_r(a,i,n),er(4,i);break;case 1:if(_r(a,i,n),"function"==typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){ya(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)me(l[a],o)}catch(c){ya(r,r.return,c)}}n&&64&s&&nr(i),ar(i,i.return);break;case 26:case 27:case 5:_r(a,i,n),n&&null===r&&4&s&&sr(i),ar(i,i.return);break;case 12:default:_r(a,i,n);break;case 13:_r(a,i,n),n&&4&s&&xr(a,i);break;case 22:null===i.memoizedState&&_r(a,i,n),ar(i,i.return)}t=t.sibling}}function Ar(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&On(n))}function Cr(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&On(e))}function Mr(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)kr(e,t,n,r),t=t.sibling}function kr(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Mr(e,t,n,r),2048&a&&er(9,t);break;case 3:Mr(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&On(e)));break;case 12:if(2048&a){Mr(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;"function"==typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){ya(t,t.return,l)}}else Mr(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,null!==t.memoizedState?4&i._visibility?Mr(e,t,n,r):Tr(e,t):4&i._visibility?Mr(e,t,n,r):(i._visibility|=4,Er(e,t,n,r,!!(10256&t.subtreeFlags))),2048&a&&Ar(t.alternate,t);break;case 24:Mr(e,t,n,r),2048&a&&Cr(t.alternate,t);break;default:Mr(e,t,n,r)}}function Er(e,t,n,r,a){for(a=a&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Er(i,s,o,l,a),er(8,s);break;case 23:break;case 22:var d=s.stateNode;null!==s.memoizedState?4&d._visibility?Er(i,s,o,l,a):Tr(i,s):(d._visibility|=4,Er(i,s,o,l,a)),a&&2048&c&&Ar(s.alternate,s);break;case 24:Er(i,s,o,l,a),a&&2048&c&&Cr(s.alternate,s);break;default:Er(i,s,o,l,a)}t=t.sibling}}function Tr(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:Tr(n,r),2048&a&&Ar(r.alternate,r);break;case 24:Tr(n,r),2048&a&&Cr(r.alternate,r);break;default:Tr(n,r)}t=t.sibling}}function Pr(e){if(e.subtreeFlags&vc)for(e=e.child;null!==e;)Dr(e),e=e.sibling}function Dr(e){switch(e.tag){case 26:Pr(e),e.flags&vc&&(null!==e.memoizedState?co(yc,e.memoizedState,e.memoizedProps):Gi(e.type,e.memoizedProps));break;case 5:Pr(e),e.flags&vc&&Gi(e.type,e.memoizedProps);break;case 3:case 4:if(qs){var t=yc;yc=Qs(e.stateNode.containerInfo),Pr(e),yc=t}else Pr(e);break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=vc,vc=16777216,Pr(e),vc=t):Pr(e));break;default:Pr(e)}}function Rr(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Ir(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];mc=r,Lr(r,e)}Rr(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Or(e),e=e.sibling}function Or(e){switch(e.tag){case 0:case 11:case 15:Ir(e),2048&e.flags&&tr(9,e,e.return);break;case 3:case 12:default:Ir(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Br(e)):Ir(e)}}function Br(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];mc=r,Lr(r,e)}Rr(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:tr(8,t,t.return),Br(t);break;case 22:4&(n=t.stateNode)._visibility&&(n._visibility&=-5,Br(t));break;default:Br(t)}e=e.sibling}}function Lr(e,t){for(;null!==mc;){var n=mc;switch(n.tag){case 0:case 11:case 15:tr(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:On(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,mc=r;else e:for(n=e;null!==mc;){var a=(r=mc).sibling,i=r.return;if(mr(r),r===n){mc=null;break e}if(null!==a){a.return=i,mc=a;break e}mc=i}}}function Fr(e){var t=Di(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(r(364));return t}if(null===(e=Ji(e)))throw Error(r(362));return e.stateNode.current}function Ur(e,t){var n=e.tag;switch(t.$$typeof){case wc:if(e.type===t.value)return!0;break;case Nc:e:{for(t=t.value,e=[e,0],n=0;n<e.length;){var a=e[n++],i=a.tag,s=e[n++],o=t[s];if(5!==i&&26!==i&&27!==i||!es(a)){for(;null!=o&&Ur(a,o);)o=t[++s];if(s===t.length){t=!0;break e}for(a=a.child;null!==a;)e.push(a,s),a=a.sibling}}t=!1}return t;case Sc:if((5===n||26===n||27===n)&&ts(e.stateNode,t.value))return!0;break;case _c:if((5===n||6===n||26===n||27===n)&&null!==(e=Zi(e))&&0<=e.indexOf(t.value))return!0;break;case jc:if((5===n||26===n||27===n)&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error(r(365))}return!1}function zr(e){switch(e.$$typeof){case wc:return"<"+(i(e.value)||"Unknown")+">";case Nc:return":has("+(zr(e)||"")+")";case Sc:return'[role="'+e.value+'"]';case _c:return'"'+e.value+'"';case jc:return'[data-testname="'+e.value+'"]';default:throw Error(r(365))}}function Hr(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var a=e[r++],i=a.tag,s=e[r++],o=t[s];if(5!==i&&26!==i&&27!==i||!es(a)){for(;null!=o&&Ur(a,o);)o=t[++s];if(s===t.length)n.push(a);else for(a=a.child;null!==a;)e.push(a,s),a=a.sibling}}return n}function Gr(e,t){if(!qi)throw Error(r(363));e=Hr(e=Fr(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var a=e[n++],i=a.tag;if(5===i||26===i||27===i)es(a)||t.push(a.stateNode);else for(a=a.child;null!==a;)e.push(a),a=a.sibling}return t}function Vr(){return 2&Mc&&0!==Tc?Tc&-Tc:null!==di.T?0!==fl?fl:ae():Bi()}function $r(){0===Hc&&(Hc=536870912&Tc&&!tl?536870912:S());var e=Tl.current;return null!==e&&(e.flags|=32),Hc}function Wr(e,t,n){(e===kc&&2===Pc||null!==e.cancelPendingCommit)&&(ea(e,0),Jr(e,Tc,Hc,!1)),A(e,n),2&Mc&&e===kc||(e===kc&&(!(2&Mc)&&(Uc|=n),4===Lc&&Jr(e,Tc,Hc,!1)),Q(e))}function Yr(e,t,n){if(6&Mc)throw Error(r(327));for(var a=!n&&!(60&t)&&0===(t&e.expiredLanes)||w(e,t),i=a?function(e,t){var n=Mc;Mc|=2;var a=ra(),i=aa();kc!==e||Tc!==t?(Kc=null,Xc=ko()+500,ea(e,t)):Ic=w(e,t);e:for(;;)try{if(0!==Pc&&null!==Ec){t=Ec;var s=Dc;t:switch(Pc){case 1:Pc=0,Dc=null,ua(e,t,s,1);break;case 2:if(xe(s)){Pc=0,Dc=null,da(t);break}t=function(){2===Pc&&kc===e&&(Pc=7),Q(e)},s.then(t,t);break e;case 3:Pc=7;break e;case 4:Pc=5;break e;case 7:xe(s)?(Pc=0,Dc=null,da(t)):(Pc=0,Dc=null,ua(e,t,s,7));break;case 5:var o=null;switch(Ec.tag){case 26:o=Ec.memoizedState;case 5:case 27:var l=Ec,c=l.type,d=l.pendingProps;if(o?lo(o):zi(c,d)){Pc=0,Dc=null;var u=l.sibling;if(null!==u)Ec=u;else{var h=l.return;null!==h?(Ec=h,ha(h)):Ec=null}break t}}Pc=0,Dc=null,ua(e,t,s,5);break;case 6:Pc=0,Dc=null,ua(e,t,s,6);break;case 8:Zr(),Lc=6;break e;default:throw Error(r(462))}}la();break}catch(p){ta(e,p)}return rc=nc=null,di.H=a,di.A=i,Mc=n,null!==Ec?0:(kc=null,Tc=0,W(),Lc)}(e,t):sa(e,t,!0),s=a;;){if(0===i){Ic&&!a&&Jr(e,t,0,!1);break}if(6===i)Jr(e,t,0,!Rc);else{if(n=e.current.alternate,s&&!qr(n)){i=sa(e,t,!1),s=!1;continue}if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!=(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;i=Vc;var c=Pi&&l.current.memoizedState.isDehydrated;if(c&&(ea(l,o).flags|=256),2!==(o=sa(l,o,!1))){if(Oc&&!c){l.errorRecoveryDisabledLanes|=s,Uc|=s,i=4;break e}s=$c,$c=i,null!==s&&Xr(s)}i=o}if(s=!1,2!==i)continue}}if(1===i){ea(e,0),Jr(e,t,0,!0);break}e:{switch(a=e,i){case 0:case 1:throw Error(r(345));case 4:if((4194176&t)===t){Jr(a,t,Hc,!Rc);break e}break;case 2:$c=null;break;case 3:case 5:break;default:throw Error(r(329))}if(a.finishedWork=n,a.finishedLanes=t,(62914560&t)===t&&10<(s=Yc+300-ko())){if(Jr(a,t,Hc,!Rc),0!==b(a,0))break e;a.timeoutHandle=Ai(Kr.bind(null,a,n,$c,Kc,Wc,t,Hc,Uc,Gc,Rc,2,-0,0),s)}else Kr(a,n,$c,Kc,Wc,t,Hc,Uc,Gc,Rc,0,-0,0)}}break}Q(e)}function Xr(e){null===$c?$c=e:$c.push.apply($c,e)}function Kr(e,t,n,r,a,i,s,o,l,c,d,u,h){var p=t.subtreeFlags;if((8192&p||!(16785408&~p))&&(Hi(),Dr(t),null!==(t=Vi())))return e.cancelPendingCommit=t(ma.bind(null,e,n,r,a,s,o,l,1,u,h)),void Jr(e,i,s,!c);ma(e,n,r,a,s,o,l)}function qr(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&null!==(n=t.updateQueue)&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Lo(i(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Jr(e,t,n,r){t&=~zc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-bo(a),s=1<<i;r[i]=-1,a&=~s}0!==n&&C(e,n,t)}function Qr(){return!!(6&Mc)||(Z(0),!1)}function Zr(){if(null!==Ec){if(0===Pc)var e=Ec.return;else rc=nc=null,He(e=Ec),_l=null,Al=0,e=Ec;for(;null!==e;)Zn(e.alternate,e),e=e.return;Ec=null}}function ea(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==Mi&&(e.timeoutHandle=Mi,Ci(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Zr(),kc=e,Ec=n=Aa(e.current,null),Tc=t,Pc=0,Dc=null,Rc=!1,Ic=w(e,t),Oc=!1,Gc=Hc=zc=Uc=Fc=Lc=0,$c=Vc=null,Wc=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-bo(r),i=1<<a;t|=e[a],r&=~i}return Bc=t,W(),n}function ta(e,t){Il=null,di.H=Wl,t===wl?(t=be(),Pc=3):t===Nl?(t=be(),Pc=4):Pc=t===Ql?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,Dc=t,null===Ec&&(Lc=1,qt(e,T(t,e.current)))}function na(){var e=Tl.current;return null===e||((4194176&Tc)===Tc?null===Pl:!!((62914560&Tc)===Tc||536870912&Tc)&&e===Pl)}function ra(){var e=di.H;return di.H=Wl,null===e?Wl:e}function aa(){var e=di.A;return di.A=bc,e}function ia(){Lc=4,Rc||(4194176&Tc)!==Tc&&null!==Tl.current||(Ic=!0),!(134217727&Fc)&&!(134217727&Uc)||null===kc||Jr(kc,Tc,Hc,!1)}function sa(e,t,n){var r=Mc;Mc|=2;var a=ra(),i=aa();kc===e&&Tc===t||(Kc=null,ea(e,t)),t=!1;var s=Lc;e:for(;;)try{if(0!==Pc&&null!==Ec){var o=Ec,l=Dc;switch(Pc){case 8:Zr(),s=6;break e;case 3:case 2:case 6:null===Tl.current&&(t=!0);var c=Pc;if(Pc=0,Dc=null,ua(e,o,l,c),n&&Ic){s=0;break e}break;default:c=Pc,Pc=0,Dc=null,ua(e,o,l,c)}}oa(),s=Lc;break}catch(d){ta(e,d)}return t&&e.shellSuspendCounter++,rc=nc=null,Mc=r,di.H=a,di.A=i,null===Ec&&(kc=null,Tc=0,W()),s}function oa(){for(;null!==Ec;)ca(Ec)}function la(){for(;null!==Ec&&!Co();)ca(Ec)}function ca(e){var t=jn(e.alternate,e,Bc);e.memoizedProps=e.pendingProps,null===t?ha(e):Ec=t}function da(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=dn(n,t,t.pendingProps,t.type,void 0,Tc);break;case 11:t=dn(n,t,t.pendingProps,t.type.render,t.ref,Tc);break;case 5:He(t);default:Zn(n,t),t=jn(n,t=Ec=Ca(t,Bc),Bc)}e.memoizedProps=e.pendingProps,null===t?ha(e):Ec=t}function ua(e,t,n,a){rc=nc=null,He(t),_l=null,Al=0;var i=t.return;try{if(function(e,t,n,a,i){if(n.flags|=32768,null!==a&&"object"==typeof a&&"function"==typeof a.then){if(null!==(t=n.alternate)&&kn(t,n,i,!0),null!==(n=Tl.current)){switch(n.tag){case 13:return null===Pl?ia():null===n.alternate&&0===Lc&&(Lc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,a===Sl?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),va(e,a,i)),!1;case 22:return n.flags|=65536,a===Sl?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),va(e,a,i)),!1}throw Error(r(435,n.tag))}return va(e,a,i),ia(),!1}if(tl)return null!==(t=Tl.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,a!==al&&$(T(e=Error(r(422),{cause:a}),n))):(a!==al&&$(T(t=Error(r(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,a=T(a,n),ue(e,i=Qt(e.stateNode,a,i)),4!==Lc&&(Lc=2)),!1;var s=Error(r(520),{cause:a});if(s=T(s,n),null===Vc?Vc=[s]:Vc.push(s),4!==Lc&&(Lc=2),null===t)return!0;a=T(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,ue(n,e=Qt(n.stateNode,a,e)),!1;case 1:if(t=n.type,s=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===s||"function"!=typeof s.componentDidCatch||null!==qc&&qc.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,en(i=Zt(i),e,n,a),ue(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,Tc))return Lc=1,qt(e,T(n,e.current)),void(Ec=null)}catch(s){if(null!==i)throw Ec=i,s;return Lc=1,qt(e,T(n,e.current)),void(Ec=null)}32768&t.flags?(tl||1===a?e=!0:Ic||536870912&Tc?e=!1:(Rc=e=!0,(2===a||3===a||6===a)&&null!==(a=Tl.current)&&13===a.tag&&(a.flags|=16384)),pa(t,e)):ha(t)}function ha(e){var t=e;do{if(32768&t.flags)return void pa(t,Rc);e=t.return;var n=Jn(t.alternate,t,Bc);if(null!==n)return void(Ec=n);if(null!==(t=t.sibling))return void(Ec=t);Ec=t=e}while(null!==t);0===Lc&&(Lc=5)}function pa(e,t){do{var n=Qn(e.alternate,e);if(null!==n)return n.flags&=32767,void(Ec=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(Ec=e);Ec=e=n}while(null!==e);Lc=6,Ec=null}function ma(e,t,n,a,i,s,o,l,c,d){var u=di.T,h=Oi();try{Ii(2),di.T=null,function(e,t,n,a,i,s,o,l){do{fa()}while(null!==Qc);if(6&Mc)throw Error(r(327));var c=e.finishedWork;if(a=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var d=c.lanes|c.childLanes;if(function(e,t,n,r,a,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var d=31-bo(n),u=1<<d;o[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var p=h[d];null!==p&&(p.lane&=-536870913)}n&=~u}0!==r&&C(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,a,d|=ol,s,o,l),e===kc&&(Ec=kc=null,Tc=0),!(10256&c.subtreeFlags)&&!(10256&c.flags)||Jc||(Jc=!0,ed=d,td=n,_o(Po,function(){return fa(),null})),n=!!(15990&c.flags),15990&c.subtreeFlags||n?(n=di.T,di.T=null,s=Oi(),Ii(2),o=Mc,Mc|=4,function(e,t){for(vi(e.containerInfo),mc=t;null!==mc;)if(t=(e=mc).child,1028&e.subtreeFlags&&null!==t)t.return=e,mc=t;else for(;null!==mc;){var n=(e=mc).alternate;switch(t=e.flags,e.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&t&&null!==n){t=void 0;var a=e,i=n.memoizedProps;n=n.memoizedState;var s=a.stateNode;try{var o=Kt(a.type,i,(a.elementType,a.type));t=s.getSnapshotBeforeUpdate(o,n),s.__reactInternalSnapshotBeforeUpdate=t}catch(l){ya(a,a.return,l)}}break;case 3:1024&t&&Ei&&ys(e.stateNode.containerInfo);break;default:if(1024&t)throw Error(r(163))}if(null!==(t=e.sibling)){t.return=e.return,mc=t;break}mc=e.return}o=gc,gc=!1}(e,c),br(c,e),bi(e.containerInfo),e.current=c,pr(e,c.alternate,c),Mo(),Mc=o,Ii(s),di.T=n):e.current=c,Jc?(Jc=!1,Qc=e,Zc=a):ga(e,d),0===(d=e.pendingLanes)&&(qc=null),function(e){if(Bo&&"function"==typeof Bo.onCommitFiberRoot)try{Bo.onCommitFiberRoot(Oo,e,void 0,!(128&~e.current.flags))}catch(t){}}(c.stateNode),Q(e),null!==t)for(i=e.onRecoverableError,c=0;c<t.length;c++)d=t[c],i(d.value,{componentStack:d.stack});!!(3&Zc)&&fa(),d=e.pendingLanes,4194218&a&&42&d?e===rd?nd++:(nd=0,rd=e):nd=0,Z(0)}(e,t,n,a,h,i,s,o)}finally{di.T=u,Ii(h)}}function ga(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,On(t))}function fa(){if(null!==Qc){var e=Qc,t=ed;ed=0;var n=k(Zc),a=32>n?32:n;n=di.T;var i=Oi();try{if(Ii(a),di.T=null,null===Qc)var s=!1;else{a=td,td=null;var o=Qc,l=Zc;if(Qc=null,Zc=0,6&Mc)throw Error(r(331));var c=Mc;if(Mc|=4,Or(o.current),kr(o,o.current,l,a),Mc=c,Z(0),Bo&&"function"==typeof Bo.onPostCommitFiberRoot)try{Bo.onPostCommitFiberRoot(Oo,o)}catch(d){}s=!0}return s}finally{Ii(i),di.T=n,ga(e,t)}}return!1}function xa(e,t,n){t=T(n,t),null!==(e=ce(e,t=Qt(e.stateNode,t,2),2))&&(A(e,2),Q(e))}function ya(e,t,n){if(3===e.tag)xa(e,e,n);else for(;null!==t;){if(3===t.tag){xa(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===qc||!qc.has(r))){e=T(n,e),null!==(r=ce(t,n=Zt(2),2))&&(en(n,r,t,e),A(r,2),Q(r));break}}t=t.return}}function va(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Cc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(Oc=!0,a.add(n),e=ba.bind(null,e,t,n),t.then(e,e))}function ba(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,kc===e&&(Tc&n)===n&&(4===Lc||3===Lc&&(62914560&Tc)===Tc&&300>ko()-Yc?!(2&Mc)&&ea(e,0):zc|=n,Gc===Tc&&(Gc=0)),Q(e)}function wa(e,t){0===t&&(t=j()),null!==(e=K(e,t))&&(A(e,t),Q(e))}function Na(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),wa(e,n)}function Sa(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(r(314))}null!==a&&a.delete(t),wa(e,n)}function ja(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _a(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Aa(e,n){var r=e.alternate;return null===r?((r=t(e.tag,n,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=31457280&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Ca(e,t){e.flags&=31457282;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ma(e,n,a,i,s,o){var l=0;if(i=e,"function"==typeof e)_a(e)&&(l=1);else if("string"==typeof e)l=qs&&uo?Js(e,a,Ko.current)?26:fo(e)?27:5:qs?Js(e,a,Ko.current)?26:5:uo&&fo(e)?27:5;else e:switch(e){case Ka:return ka(a.children,s,o,n);case qa:l=8,s|=24;break;case Ja:return(e=t(12,a,n,2|s)).elementType=Ja,e.lanes=o,e;case ni:return(e=t(13,a,n,s)).elementType=ni,e.lanes=o,e;case ri:return(e=t(19,a,n,s)).elementType=ri,e.lanes=o,e;case si:return Ea(a,s,o,n);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Qa:case ei:l=10;break e;case Za:l=9;break e;case ti:l=11;break e;case ai:l=14;break e;case ii:l=16,i=null;break e}l=29,a=Error(r(130,null===e?"null":typeof e,"")),i=null}return(n=t(l,a,n,s)).elementType=e,n.type=i,n.lanes=o,n}function ka(e,n,r,a){return(e=t(7,e,a,n)).lanes=r,e}function Ea(e,n,a,i){(e=t(22,e,i,n)).elementType=si,e.lanes=a;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=s._current;if(null===e)throw Error(r(456));if(!(2&s._pendingVisibility)){var t=K(e,2);null!==t&&(s._pendingVisibility|=2,Wr(t,0,2))}},attach:function(){var e=s._current;if(null===e)throw Error(r(456));if(2&s._pendingVisibility){var t=K(e,2);null!==t&&(s._pendingVisibility&=-3,Wr(t,0,2))}}};return e.stateNode=s,e}function Ta(e,n,r){return(e=t(6,e,null,n)).lanes=r,e}function Pa(e,n,r){return(n=t(4,null!==e.children?e.children:[],e.key,n)).lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Da(e,t,n,r,a,i,s,o){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Mi,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_(0),this.hiddenUpdates=_(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Ra(e,n,r,a,i,s,o,l,c,d,u,h){return e=new Da(e,n,r,o,l,c,d,h),n=1,!0===s&&(n|=24),s=t(3,null,null,n),e.current=s,s.stateNode=e,(n=In()).refCount++,e.pooledCache=n,n.refCount++,s.memoizedState={element:a,isDehydrated:r,cache:n},se(s),e}function Ia(e){return e?e=vo:vo}function Oa(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return null===(e=null!==(e=h(t))?m(e):null)?null:fi(e.stateNode)}function Ba(e,t,n,r,a,i){a=Ia(a),null===r.context?r.context=a:r.pendingContext=a,(r=le(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=ce(e,r,t))&&(Wr(n,0,t),de(n,e,t))}function La(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Fa(e,t){La(e,t),(e=e.alternate)&&La(e,t)}var Ua,za,Ha={},Ga=p(),Va=T6(),$a=Object.assign,Wa=Symbol.for("react.element"),Ya=Symbol.for("react.transitional.element"),Xa=Symbol.for("react.portal"),Ka=Symbol.for("react.fragment"),qa=Symbol.for("react.strict_mode"),Ja=Symbol.for("react.profiler"),Qa=Symbol.for("react.provider"),Za=Symbol.for("react.consumer"),ei=Symbol.for("react.context"),ti=Symbol.for("react.forward_ref"),ni=Symbol.for("react.suspense"),ri=Symbol.for("react.suspense_list"),ai=Symbol.for("react.memo"),ii=Symbol.for("react.lazy"),si=Symbol.for("react.offscreen"),oi=Symbol.for("react.memo_cache_sentinel"),li=Symbol.iterator,ci=Symbol.for("react.client.reference"),di=Ga.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ui=!1,hi=Array.isArray,pi=e.rendererVersion,mi=e.rendererPackageName,gi=e.extraDevToolsConfig,fi=e.getPublicInstance,xi=e.getRootHostContext,yi=e.getChildHostContext,vi=e.prepareForCommit,bi=e.resetAfterCommit,wi=e.createInstance,Ni=e.appendInitialChild,Si=e.finalizeInitialChildren,ji=e.shouldSetTextContent,_i=e.createTextInstance,Ai=e.scheduleTimeout,Ci=e.cancelTimeout,Mi=e.noTimeout,ki=e.isPrimaryRenderer;e.warnsIfNotActing;var Ei=e.supportsMutation,Ti=e.supportsPersistence,Pi=e.supportsHydration,Di=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Ri=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Ii=e.setCurrentUpdatePriority,Oi=e.getCurrentUpdatePriority,Bi=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Li=e.shouldAttemptEagerTransition,Fi=e.detachDeletedInstance;e.requestPostPaintCallback;var Ui=e.maySuspendCommit,zi=e.preloadInstance,Hi=e.startSuspendingCommit,Gi=e.suspendInstance,Vi=e.waitForCommitToBeReady,$i=e.NotPendingTransition,Wi=e.HostTransitionContext,Yi=e.resetFormInstance;e.bindToConsole;var Xi=e.supportsMicrotasks,Ki=e.scheduleMicrotask,qi=e.supportsTestSelectors,Ji=e.findFiberRoot,Qi=e.getBoundingRect,Zi=e.getTextContent,es=e.isHiddenSubtree,ts=e.matchAccessibilityRole,ns=e.setFocusIfFocusable,rs=e.setupIntersectionObserver,as=e.appendChild,is=e.appendChildToContainer,ss=e.commitTextUpdate,os=e.commitMount,ls=e.commitUpdate,cs=e.insertBefore,ds=e.insertInContainerBefore,us=e.removeChild,hs=e.removeChildFromContainer,ps=e.resetTextContent,ms=e.hideInstance,gs=e.hideTextInstance,fs=e.unhideInstance,xs=e.unhideTextInstance,ys=e.clearContainer,vs=e.cloneInstance,bs=e.createContainerChildSet,ws=e.appendChildToContainerChildSet,Ns=e.finalizeContainerChildren,Ss=e.replaceContainerChildren,js=e.cloneHiddenInstance,_s=e.cloneHiddenTextInstance,As=e.isSuspenseInstancePending,Cs=e.isSuspenseInstanceFallback,Ms=e.getSuspenseInstanceFallbackErrorDetails,ks=e.registerSuspenseInstanceRetry,Es=e.canHydrateFormStateMarker,Ts=e.isFormStateMarkerMatching,Ps=e.getNextHydratableSibling,Ds=e.getFirstHydratableChild,Rs=e.getFirstHydratableChildWithinContainer,Is=e.getFirstHydratableChildWithinSuspenseInstance,Os=e.canHydrateInstance,Bs=e.canHydrateTextInstance,Ls=e.canHydrateSuspenseInstance,Fs=e.hydrateInstance,Us=e.hydrateTextInstance,zs=e.hydrateSuspenseInstance,Hs=e.getNextHydratableInstanceAfterSuspenseInstance,Gs=e.commitHydratedContainer,Vs=e.commitHydratedSuspenseInstance,$s=e.clearSuspenseBoundary,Ws=e.clearSuspenseBoundaryFromContainer,Ys=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Xs=e.validateHydratableInstance,Ks=e.validateHydratableTextInstance,qs=e.supportsResources,Js=e.isHostHoistableType,Qs=e.getHoistableRoot,Zs=e.getResource,eo=e.acquireResource,to=e.releaseResource,no=e.hydrateHoistable,ro=e.mountHoistable,ao=e.unmountHoistable,io=e.createHoistableInstance,so=e.prepareToCommitHoistables,oo=e.mayResourceSuspendCommit,lo=e.preloadResource,co=e.suspendResource,uo=e.supportsSingletons,ho=e.resolveSingletonInstance,po=e.clearSingleton,mo=e.acquireSingletonInstance,go=e.releaseSingletonInstance,fo=e.isHostSingletonType,xo=[],yo=-1,vo={},bo=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(wo(e)/No|0)|0},wo=Math.log,No=Math.LN2,So=128,jo=4194304,_o=Va.unstable_scheduleCallback,Ao=Va.unstable_cancelCallback,Co=Va.unstable_shouldYield,Mo=Va.unstable_requestPaint,ko=Va.unstable_now,Eo=Va.unstable_ImmediatePriority,To=Va.unstable_UserBlockingPriority,Po=Va.unstable_NormalPriority,Do=Va.unstable_IdlePriority,Ro=Va.log,Io=Va.unstable_setDisableYieldValue,Oo=null,Bo=null,Lo="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Fo=new WeakMap,Uo=[],zo=0,Ho=null,Go=0,Vo=[],$o=0,Wo=null,Yo=1,Xo="",Ko=f(null),qo=f(null),Jo=f(null),Qo=f(null),Zo=null,el=null,tl=!1,nl=null,rl=!1,al=Error(r(519)),il=[],sl=0,ol=0,ll=null,cl=null,dl=!1,ul=!1,hl=!1,pl=0,ml=null,gl=0,fl=0,xl=null,yl=!1,vl=!1,bl=Object.prototype.hasOwnProperty,wl=Error(r(460)),Nl=Error(r(474)),Sl={then:function(){}},jl=null,_l=null,Al=0,Cl=_e(!0),Ml=_e(!1),kl=f(null),El=f(0),Tl=f(null),Pl=null,Dl=f(0),Rl=0,Il=null,Ol=null,Bl=null,Ll=!1,Fl=!1,Ul=!1,zl=0,Hl=0,Gl=null,Vl=0,$l=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Wl={readContext:Pn,use:We,useCallback:Re,useContext:Re,useEffect:Re,useImperativeHandle:Re,useLayoutEffect:Re,useInsertionEffect:Re,useMemo:Re,useReducer:Re,useRef:Re,useState:Re,useDebugValue:Re,useDeferredValue:Re,useTransition:Re,useSyncExternalStore:Re,useId:Re};Wl.useCacheRefresh=Re,Wl.useMemoCache=Re,Wl.useHostTransitionStatus=Re,Wl.useFormState=Re,Wl.useActionState=Re,Wl.useOptimistic=Re;var Yl={readContext:Pn,use:We,useCallback:function(e,t){return Ge().memoizedState=[e,void 0===t?null:t],e},useContext:Pn,useEffect:Nt,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,bt(4194308,4,At.bind(null,t,e),n)},useLayoutEffect:function(e,t){return bt(4194308,4,e,t)},useInsertionEffect:function(e,t){bt(4,2,e,t)},useMemo:function(e,t){var n=Ge();t=void 0===t?null:t;var r=e();if(Ul){E(!0);try{e()}finally{E(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Ge();if(void 0!==n){var a=n(t);if(Ul){E(!0);try{n(t)}finally{E(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=Ft.bind(null,Il,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ge().memoizedState=e},useState:function(e){var t=(e=at(e)).queue,n=Ut.bind(null,Il,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Mt,useDeferredValue:function(e,t){return Tt(Ge(),e,t)},useTransition:function(){var e=at(!1);return e=Dt.bind(null,Il,e.queue,!0,!1),Ge().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Il,i=Ge();if(tl){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===kc)throw Error(r(349));60&Tc||Ze(a,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Nt(tt.bind(null,a,s,e),[e]),a.flags|=2048,yt(9,et.bind(null,a,s,n,t),{destroy:void 0},null),n},useId:function(){var e=Ge(),t=kc.identifierPrefix;if(tl){var n=Xo;t=":"+t+"R"+(n=(Yo&~(1<<32-bo(Yo)-1)).toString(32)+n),0<(n=zl++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Vl++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return Ge().memoizedState=Lt.bind(null,Il)}};Yl.useMemoCache=Ye,Yl.useHostTransitionStatus=It,Yl.useFormState=pt,Yl.useActionState=pt,Yl.useOptimistic=function(e){var t=Ge();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Ht.bind(null,Il,!0,n),n.dispatch=t,[e,t]};var Xl={readContext:Pn,use:We,useCallback:kt,useContext:Pn,useEffect:St,useImperativeHandle:Ct,useInsertionEffect:jt,useLayoutEffect:_t,useMemo:Et,useReducer:Ke,useRef:vt,useState:function(){return Ke(Xe)},useDebugValue:Mt,useDeferredValue:function(e,t){return Pt(Ve(),Ol.memoizedState,e,t)},useTransition:function(){var e=Ke(Xe)[0],t=Ve().memoizedState;return["boolean"==typeof e?e:$e(e),t]},useSyncExternalStore:Qe,useId:Ot};Xl.useCacheRefresh=Bt,Xl.useMemoCache=Ye,Xl.useHostTransitionStatus=It,Xl.useFormState=mt,Xl.useActionState=mt,Xl.useOptimistic=function(e,t){return it(Ve(),0,e,t)};var Kl={readContext:Pn,use:We,useCallback:kt,useContext:Pn,useEffect:St,useImperativeHandle:Ct,useInsertionEffect:jt,useLayoutEffect:_t,useMemo:Et,useReducer:Je,useRef:vt,useState:function(){return Je(Xe)},useDebugValue:Mt,useDeferredValue:function(e,t){var n=Ve();return null===Ol?Tt(n,e,t):Pt(n,Ol.memoizedState,e,t)},useTransition:function(){var e=Je(Xe)[0],t=Ve().memoizedState;return["boolean"==typeof e?e:$e(e),t]},useSyncExternalStore:Qe,useId:Ot};Kl.useCacheRefresh=Bt,Kl.useMemoCache=Ye,Kl.useHostTransitionStatus=It,Kl.useFormState=xt,Kl.useActionState=xt,Kl.useOptimistic=function(e,t){var n=Ve();return null!==Ol?it(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])};var ql={isMounted:function(e){return!!(e=e._reactInternals)&&d(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Vr(),a=le(r);a.payload=t,null!=n&&(a.callback=n),null!==(t=ce(e,a,r))&&(Wr(t,0,r),de(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Vr(),a=le(r);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=ce(e,a,r))&&(Wr(t,0,r),de(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Vr(),r=le(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=ce(e,r,n))&&(Wr(t,0,n),de(t,e,n))}},Jl="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ql=Error(r(461)),Zl=!1,ec={dehydrated:null,treeContext:null,retryLane:0},tc=f(null),nc=null,rc=null,ac="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},ic=Va.unstable_scheduleCallback,sc=Va.unstable_NormalPriority,oc={$$typeof:ei,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},lc=di.S;di.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===ml){var n=ml=[];gl=0,fl=ae(),xl={status:"pending",value:void 0,then:function(e){n.push(e)}}}gl++,t.then(ie,ie)}(0,t),null!==lc&&lc(e,t)};var cc=f(null),dc=!1,uc=!1,hc=!1,pc="function"==typeof WeakSet?WeakSet:Set,mc=null,gc=!1,fc=null,xc=!1,yc=null,vc=8192,bc={getCacheForType:function(e){var t=Pn(oc),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},wc=0,Nc=1,Sc=2,jc=3,_c=4;if("function"==typeof Symbol&&Symbol.for){var Ac=Symbol.for;wc=Ac("selector.component"),Nc=Ac("selector.has_pseudo_class"),Sc=Ac("selector.role"),jc=Ac("selector.test_id"),_c=Ac("selector.text")}var Cc="function"==typeof WeakMap?WeakMap:Map,Mc=0,kc=null,Ec=null,Tc=0,Pc=0,Dc=null,Rc=!1,Ic=!1,Oc=!1,Bc=0,Lc=0,Fc=0,Uc=0,zc=0,Hc=0,Gc=0,Vc=null,$c=null,Wc=!1,Yc=0,Xc=1/0,Kc=null,qc=null,Jc=!1,Qc=null,Zc=0,ed=0,td=null,nd=0,rd=null;return Ha.attemptContinuousHydration=function(e){if(13===e.tag){var t=K(e,67108864);null!==t&&Wr(t,0,67108864),Fa(e,67108864)}},Ha.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Vr(),n=K(e,t);null!==n&&Wr(n,0,t),Fa(e,t)}},Ha.attemptSynchronousHydration=function(e){switch(e.tag){case 3:if((e=e.stateNode).current.memoizedState.isDehydrated){var t=v(e.pendingLanes);if(0!==t){for(e.pendingLanes|=2,e.entangledLanes|=2;t;){var n=1<<31-bo(t);e.entanglements[1]|=n,t&=~n}Q(e),!(6&Mc)&&(Xc=ko()+500,Z(0))}}break;case 13:null!==(t=K(e,2))&&Wr(t,0,2),Qr(),Fa(e,2)}},Ha.batchedUpdates=function(e,t){return e(t)},Ha.createComponentSelector=function(e){return{$$typeof:wc,value:e}},Ha.createContainer=function(e,t,n,r,a,i,s,o,l,c){return Ra(e,t,!1,null,0,r,i,s,o,l,0,null)},Ha.createHasPseudoClassSelector=function(e){return{$$typeof:Nc,value:e}},Ha.createHydrationContainer=function(e,t,n,r,a,i,s,o,l,c,d,u,h){return(e=Ra(n,r,!0,e,0,i,o,l,c,d,0,h)).context=Ia(null),n=e.current,(a=le(r=Vr())).callback=null!=t?t:null,ce(n,a,r),e.current.lanes=r,A(e,r),Q(e),e},Ha.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Xa,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},Ha.createRoleSelector=function(e){return{$$typeof:Sc,value:e}},Ha.createTestNameSelector=function(e){return{$$typeof:jc,value:e}},Ha.createTextSelector=function(e){return{$$typeof:_c,value:e}},Ha.defaultOnCaughtError=function(e){console.error(e)},Ha.defaultOnRecoverableError=function(e){Jl(e)},Ha.defaultOnUncaughtError=function(e){Jl(e)},Ha.deferredUpdates=function(e){var t=di.T,n=Oi();try{return Ii(32),di.T=null,e()}finally{Ii(n),di.T=t}},Ha.discreteUpdates=function(e,t,n,r,a){var i=di.T,s=Oi();try{return Ii(2),di.T=null,e(t,n,r,a)}finally{Ii(s),di.T=i,0===Mc&&(Xc=ko()+500)}},Ha.findAllNodes=Gr,Ha.findBoundingRects=function(e,t){if(!qi)throw Error(r(363));t=Gr(e,t),e=[];for(var n=0;n<t.length;n++)e.push(Qi(t[n]));for(t=e.length-1;0<t;t--)for(var a=(n=e[t]).x,i=a+n.width,s=n.y,o=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],d=c.x,u=d+c.width,h=c.y,p=h+c.height;if(a>=d&&s>=h&&i<=u&&o<=p){e.splice(t,1);break}if(!(a!==d||n.width!==c.width||p<s||h>o)){h>s&&(c.height+=h-s,c.y=s),p<o&&(c.height=o-h),e.splice(t,1);break}if(!(s!==h||n.height!==c.height||u<a||d>i)){d>a&&(c.width+=d-a,c.x=a),u<i&&(c.width=i-d),e.splice(t,1);break}}return e},Ha.findHostInstance=Oa,Ha.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=h(e))?g(e):null)?null:fi(e.stateNode)},Ha.findHostInstanceWithWarning=function(e){return Oa(e)},Ha.flushPassiveEffects=fa,Ha.flushSyncFromReconciler=function(e){var t=Mc;Mc|=1;var n=di.T,r=Oi();try{if(Ii(2),di.T=null,e)return e()}finally{Ii(r),di.T=n,!(6&(Mc=t))&&Z(0)}},Ha.flushSyncWork=Qr,Ha.focusWithin=function(e,t){if(!qi)throw Error(r(363));for(t=Hr(e=Fr(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++],a=n.tag;if(!es(n)){if((5===a||26===a||27===a)&&ns(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},Ha.getFindAllNodesFailureDescription=function(e,t){if(!qi)throw Error(r(363));var n=0,a=[];e=[Fr(e),0];for(var i=0;i<e.length;){var s=e[i++],o=s.tag,l=e[i++],c=t[l];if((5!==o&&26!==o&&27!==o||!es(s))&&(Ur(s,c)&&(a.push(zr(c)),++l>n&&(n=l)),l<t.length))for(s=s.child;null!==s;)e.push(s,l),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(zr(t[n]));return"findAllNodes was able to match part of the selector:\n  "+a.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},Ha.getPublicRootInstance=function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 27:case 5:return fi(e.child.stateNode);default:return e.child.stateNode}},Ha.injectIntoDevTools=function(){var e={bundleType:0,version:pi,rendererPackageName:mi,currentDispatcherRef:di,findFiberByHostInstance:Di,reconcilerVersion:"19.0.0"};if(null!==gi&&(e.rendererConfig=gi),"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Oo=t.inject(e),Bo=t}catch(n){}e=!!t.checkDCE}}return e},Ha.isAlreadyRendering=function(){return!1},Ha.observeVisibleRects=function(e,t,n,a){if(!qi)throw Error(r(363));e=Gr(e,t);var i=rs(e,n,a).disconnect;return{disconnect:function(){i()}}},Ha.shouldError=function(){return null},Ha.shouldSuspend=function(){return!1},Ha.startHostTransition=function(e,t,a,i){if(5!==e.tag)throw Error(r(476));var s=Rt(e).queue;Dt(e,s,t,$i,null===a?n:function(){var t=Rt(e).next.queue;return zt(e,t,{},Vr()),a(i)})},Ha.updateContainer=function(e,t,n,r){var a=t.current,i=Vr();return Ba(a,i,e,t,n,r),i},Ha.updateContainerSync=function(e,t,n,r){return 0===t.tag&&fa(),Ba(t.current,2,e,t,n,r),2},Ha},e.exports.default=e.exports,Object.defineProperty(e.exports,"__esModule",{value:!0})),M6.exports;var e}const D6=g((A6||(A6=1,C6.exports=P6()),C6.exports));var R6,I6,O6={exports:{}},B6={};var L6=(I6||(I6=1,O6.exports=(R6||(R6=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<i&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],d=1,u=null,h=3,p=!1,m=!1,g=!1,f="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var a=n(c);null!==a;){if(null===a.callback)r(c);else{if(!(a.startTime<=e))break;r(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function b(e){if(g=!1,v(e),!m)if(null!==n(l))m=!0,E();else{var t=n(c);null!==t&&T(b,t.startTime-e)}}var w,N=!1,S=-1,j=5,_=-1;function A(){return!(e.unstable_now()-_<j)}function C(){if(N){var t=e.unstable_now();_=t;var a=!0;try{e:{m=!1,g&&(g=!1,x(S),S=-1),p=!0;var i=h;try{t:{for(v(t),u=n(l);null!==u&&!(u.expirationTime>t&&A());){var s=u.callback;if("function"==typeof s){u.callback=null,h=u.priorityLevel;var o=s(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof o){u.callback=o,v(t),a=!0;break t}u===n(l)&&r(l),v(t)}else r(l);u=n(l)}if(null!==u)a=!0;else{var d=n(c);null!==d&&T(b,d.startTime-t),a=!1}}break e}finally{u=null,h=i,p=!1}a=void 0}}finally{a?w():N=!1}}}if("function"==typeof y)w=function(){y(C)};else if("undefined"!=typeof MessageChannel){var M=new MessageChannel,k=M.port2;M.port1.onmessage=C,w=function(){k.postMessage(null)}}else w=function(){f(C,0)};function E(){N||(N=!0,w())}function T(t,n){S=f(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,E())},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(r,a,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,r){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return r={id:d++,callback:a,priorityLevel:r,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(r.sortIndex=i,t(c,r),null===n(l)&&r===n(c)&&(g?(x(S),S=-1):g=!0,T(b,i-s))):(r.sortIndex=o,t(l,r),m||p||(m=!0,E())),r},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(B6)),B6)),O6.exports);function F6(e,t,n){if(!e)return;if(!0===n(e))return e;let r=t?e.return:e.child;for(;r;){const e=F6(r,t,n);if(e)return e;r=t?null:r.sibling}}function U6(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(NI){return e}}const z6=U6(f.createContext(null));class H6 extends f.Component{render(){return f.createElement(z6.Provider,{value:this._reactInternals},this.props.children)}}function G6(){const e=f.useContext(z6);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=f.useId();return f.useMemo(()=>{for(const n of[e,null==e?void 0:e.alternate]){if(!n)continue;const e=F6(n,!1,e=>{let n=e.memoizedState;for(;n;){if(n.memoizedState===t)return!0;n=n.next}});if(e)return e}},[e,t])}const V6=Symbol.for("react.context"),$6=e=>null!==e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===V6;function W6(){const e=function(){const e=G6(),[t]=f.useState(()=>new Map);t.clear();let n=e;for(;n;){const e=n.type;$6(e)&&e!==z6&&!t.has(e)&&t.set(e,f.use(U6(e))),n=n.return}return t}();return f.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>r=>f.createElement(t,null,f.createElement(n.Provider,c(l({},r),{value:e.get(n)}))),e=>f.createElement(H6,l({},e))),[e])}function Y6(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const X6=e=>e&&e.isOrthographicCamera,K6=e=>null!=e&&("string"==typeof e||"number"==typeof e||e.isColor),q6=((e,t)=>"undefined"!=typeof window&&((null==(e=window.document)?void 0:e.createElement)||"ReactNative"===(null==(t=window.navigator)?void 0:t.product)))()?f.useLayoutEffect:f.useEffect;function J6(e){const t=f.useRef(e);return q6(()=>{t.current=e},[e]),t}function Q6({set:e}){return q6(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const Z6=(e=>(e=class extends f.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function e8(e){var t;const n="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function t8(e){var t;return null==(t=e.__r3f)?void 0:t.root.getState()}const n8={obj:e=>e===Object(e)&&!n8.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,nul:e=>null===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:a=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(n8.str(e)||n8.num(e)||n8.boo(e))return e===t;const i=n8.obj(e);if(i&&"reference"===r)return e===t;const s=n8.arr(e);if(s&&"reference"===n)return e===t;if((s||i)&&e===t)return!0;let o;for(o in e)if(!(o in t))return!1;if(i&&"shallow"===n&&"shallow"===r){for(o in a?t:e)if(!n8.equ(e[o],t[o],{strict:a,objects:"reference"}))return!1}else for(o in a?t:e)if(e[o]!==t[o])return!1;if(n8.und(o)){if(s&&0===e.length&&0===t.length)return!0;if(i&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};const r8=["children","key","ref"];function a8(e){const t={};for(const n in e)r8.includes(n)||(t[n]=e[n]);return t}function i8(e,t,n,r){const a=e;let i=null==a?void 0:a.__r3f;return i||(i={root:t,type:n,parent:null,children:[],props:a8(r),object:a,eventCount:0,handlers:{},isHidden:!1},a&&(a.__r3f=i)),i}function s8(e,t){if(!t.includes("-"))return{root:e,key:t,target:e[t]};if(t in e)return{root:e,key:t,target:e[t]};let n=e;const r=t.split("-");for(const a of r){if("object"!=typeof n||null===n){if(void 0!==n){return{root:n,key:r.slice(r.indexOf(a)).join("-"),target:void 0}}return{root:e,key:t,target:void 0}}e=n,n=n[t=a]}return{root:e,key:t,target:n}}const o8=/-\d+$/;function l8(e,t){if(n8.str(t.props.attach)){if(o8.test(t.props.attach)){const n=t.props.attach.replace(o8,""),{root:r,key:a}=s8(e.object,n);Array.isArray(r[a])||(r[a]=[])}const{root:n,key:r}=s8(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else n8.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function c8(e,t){if(n8.str(t.props.attach)){const{root:n,key:r}=s8(e.object,t.props.attach),a=t.previousAttach;void 0===a?delete n[r]:n[r]=a}else null==t.previousAttach||t.previousAttach(e.object,t.object);delete t.previousAttach}const d8=[...r8,"args","dispose","attach","object","onUpdate","dispose"],u8=new Map;function h8(e){let t=u8.get(e.constructor);try{t||(t=new e.constructor,u8.set(e.constructor,t))}catch(bI){}return t}const p8=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],m8=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function g8(e,t){var n;const r=e.__r3f,a=r&&Y6(r).getState(),i=null==r?void 0:r.eventCount;for(const o in t){let n=t[o];if(d8.includes(o))continue;if(r&&m8.test(o)){"function"==typeof n?r.handlers[o]=n:delete r.handlers[o],r.eventCount=Object.keys(r.handlers).length;continue}if(void 0===n)continue;let{root:i,key:l,target:c}=s8(e,o);if(void 0===c&&("object"!=typeof i||null===i))throw Error(`R3F: Cannot set "${o}". Ensure it is an object before setting "${l}".`);if(c instanceof eq&&n instanceof eq)c.mask=n.mask;else if(c instanceof Iq&&K6(n))c.set(n);else if(null!==c&&"object"==typeof c&&"function"==typeof c.set&&"function"==typeof c.copy&&null!=n&&n.constructor&&c.constructor===n.constructor)c.copy(n);else if(null!==c&&"object"==typeof c&&"function"==typeof c.set&&Array.isArray(n))"function"==typeof c.fromArray?c.fromArray(n):c.set(...n);else if(null!==c&&"object"==typeof c&&"function"==typeof c.set&&"number"==typeof n)"function"==typeof c.setScalar?c.setScalar(n):c.set(n);else{var s;i[l]=n,a&&!a.linear&&p8.includes(l)&&null!=(s=i[l])&&s.isTexture&&i[l].format===cY&&i[l].type===XW&&(i[l].colorSpace=aX)}}if(null!=r&&r.parent&&null!=a&&a.internal&&null!=(n=r.object)&&n.isObject3D&&i!==r.eventCount){const e=r.object,t=a.internal.interaction.indexOf(e);t>-1&&a.internal.interaction.splice(t,1),r.eventCount&&null!==e.raycast&&a.internal.interaction.push(e)}return r&&void 0===r.props.attach&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&f8(r),e}function f8(e){var t;if(!e.parent)return;null==e.props.onUpdate||e.props.onUpdate(e.object);const n=null==(t=e.root)||null==t.getState?void 0:t.getState();n&&0===n.internal.frames&&n.invalidate()}function x8(e,t){e.manual||(X6(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const y8=e=>null==e?void 0:e.isObject3D;function v8(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function b8(e,t,n,r){const a=n.get(t);a&&(n.delete(t),0===n.size&&(e.delete(r),a.target.releasePointerCapture(r)))}function w8(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){const r=e.eventObject.__r3f;if(n.hovered.delete(v8(e)),null!=r&&r.eventCount){const n=r.handlers,a=c(l({},e),{intersections:t});null==n.onPointerOut||n.onPointerOut(a),null==n.onPointerLeave||n.onPointerLeave(a)}}}function r(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))})}}return function(i){const{onPointerMissed:s,internal:o}=e.getState();o.lastEvent.current=i;const d="onPointerMove"===a,u="onClick"===a||"onContextMenu"===a||"onDoubleClick"===a,h=function(t,n){const r=e.getState(),a=new Set,i=[],s=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<s.length;e++){const t=t8(s[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let o=s.flatMap(function(e){const n=t8(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r}).sort((e,t)=>{const n=t8(e.object),r=t8(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{const t=v8(e);return!a.has(t)&&(a.add(t),!0)});r.events.filter&&(o=r.events.filter(o,r));for(const e of o){let t=e.object;for(;t;){var d;null!=(d=t.__r3f)&&d.eventCount&&i.push(c(l({},e),{eventObject:t})),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())a.has(v8(e.intersection))||i.push(e.intersection);return i}(i,d?t:void 0),p=u?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],a=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+a*a))}(i):0;"onPointerDown"===a&&(o.initialClick=[i.offsetX,i.offsetY],o.initialHits=h.map(e=>e.eventObject)),u&&!h.length&&p<=2&&(r(i,o.interaction),s&&s(i)),d&&n(h),function(e,t,r,a){if(e.length){const i={stopped:!1};for(const s of e){let o=t8(s.object);if(o||s.object.traverseAncestors(e=>{const t=t8(e);if(t)return o=t,!1}),o){const{raycaster:d,pointer:u,camera:h,internal:p}=o,m=new WX(u.x,u.y,0).unproject(h),g=e=>{var t,n;return null!=(t=null==(n=p.capturedMap.get(e))?void 0:n.has(s.eventObject))&&t},f=e=>{const n={intersection:s,target:t.target};p.capturedMap.has(e)?p.capturedMap.get(e).set(s.eventObject,n):p.capturedMap.set(e,new Map([[s.eventObject,n]])),t.target.setPointerCapture(e)},x=e=>{const t=p.capturedMap.get(e);t&&b8(p.capturedMap,s.eventObject,t,e)};let y={};for(let e in t){let n=t[e];"function"!=typeof n&&(y[e]=n)}let v=c(l(l({},s),y),{pointer:u,intersections:e,stopped:i.stopped,delta:r,unprojectedPoint:m,ray:d.ray,camera:h,stopPropagation(){const r="pointerId"in t&&p.capturedMap.get(t.pointerId);(!r||r.has(s.eventObject))&&(v.stopped=i.stopped=!0,p.hovered.size&&Array.from(p.hovered.values()).find(e=>e.eventObject===s.eventObject))&&n([...e.slice(0,e.indexOf(s)),s])},target:{hasPointerCapture:g,setPointerCapture:f,releasePointerCapture:x},currentTarget:{hasPointerCapture:g,setPointerCapture:f,releasePointerCapture:x},nativeEvent:t});if(a(v),!0===i.stopped)break}}}}(h,i,p,function(e){const t=e.eventObject,n=t.__r3f;if(null==n||!n.eventCount)return;const s=n.handlers;if(d){if(s.onPointerOver||s.onPointerEnter||s.onPointerOut||s.onPointerLeave){const t=v8(e),n=o.hovered.get(t);n?n.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==s.onPointerOver||s.onPointerOver(e),null==s.onPointerEnter||s.onPointerEnter(e))}null==s.onPointerMove||s.onPointerMove(e)}else{const n=s[a];n?u&&!o.initialHits.includes(t)||(r(i,o.interaction.filter(e=>!o.initialHits.includes(e))),n(e)):u&&o.initialHits.includes(t)&&r(i,o.interaction.filter(e=>!o.initialHits.includes(e)))}})}}}}const N8=e=>!(null==e||!e.render),S8=f.createContext(null);function j8(){const e=f.useContext(S8);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function _8(e=e=>e,t){return j8()(e,t)}function A8(e,t=0){const n=j8(),r=n.getState().internal.subscribe,a=J6(e);return q6(()=>r(a,t,n),[t,r,n]),null}const C8=new WeakMap;function M8(e,t){return function(n,...r){let a;var i,s;return"function"==typeof(i=n)&&(null==i||null==(s=i.prototype)?void 0:s.constructor)===i?(a=C8.get(n),a||(a=new n,C8.set(n,a))):a=n,e&&e(a),Promise.all(r.map(e=>new Promise((n,r)=>a.load(e,e=>{y8(null==e?void 0:e.scene)&&Object.assign(e,function(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material),e.isMesh&&!t.meshes[e.name]&&(t.meshes[e.name]=e)}),t}(e.scene)),n(e)},t,t=>r(new Error(`Could not load ${e}: ${null==t?void 0:t.message}`))))))}}function k8(e,t,n,r){const a=Array.isArray(t)?t:[t],i=((e,t,n)=>N6(e,t,!1,n))(M8(n,r),[e,...a],{equal:n8.equ});return Array.isArray(t)?i:i[0]}function E8(e){const t=D6(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:f.version}),t}k8.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return((e,t,n)=>{N6(e,t,!0,n)})(M8(n),[e,...r])},k8.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)b6.splice(0,b6.length);else{const t=b6.find(t=>w6(e,t.keys,t.equal));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};const T8={},P8=/^three(?=[A-Z])/,D8=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let R8=0;function I8(e){if("function"==typeof e){const t=""+R8++;return T8[t]=e,t}Object.assign(T8,e)}function O8(e,t){const n=D8(e),r=T8[n];if("primitive"!==e&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if("primitive"===e&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(void 0!==t.args&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function B8(e){var t;e.isHidden&&(e.props.attach&&null!=(t=e.parent)&&t.object?l8(e.parent,e):y8(e.object)&&!1!==e.props.visible&&(e.object.visible=!0),e.isHidden=!1,f8(e))}function L8(e,t,n){const r=t.root.getState();if(e.parent||e.object===r.scene){if(!t.object){var a,i;const e=T8[D8(t.type)];t.object=null!=(a=t.props.object)?a:new e(...null!=(i=t.props.args)?i:[]),t.object.__r3f=t}if(g8(t.object,t.props),t.props.attach)l8(e,t);else if(y8(t.object)&&y8(e.object)){const r=e.object.children.indexOf(null==n?void 0:n.object);if(n&&-1!==r){const n=e.object.children.indexOf(t.object);if(-1!==n){e.object.children.splice(n,1);const a=n<r?r-1:r;e.object.children.splice(a,0,t.object)}else t.object.parent=e.object,e.object.children.splice(r,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const e of t.children)L8(t,e);f8(t)}}function F8(e,t){t&&(t.parent=e,e.children.push(t),L8(e,t))}function U8(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);-1!==r?e.children.splice(r,0,t):e.children.push(t),L8(e,t,n)}function z8(e){if("function"==typeof e.dispose){const t=()=>{try{e.dispose()}catch(bI){}};"undefined"!=typeof IS_REACT_ACT_ENVIRONMENT?t():L6.unstable_scheduleCallback(L6.unstable_IdlePriority,t)}}function H8(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);-1!==r&&e.children.splice(r,1),t.props.attach?c8(e,t):y8(t.object)&&y8(e.object)&&(e.object.remove(t.object),function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}),n.capturedMap.forEach((e,r)=>{b8(n.capturedMap,t,e,r)})}(Y6(t),t.object));const a=null!==t.props.dispose&&!1!==n;for(let i=t.children.length-1;i>=0;i--){H8(t,t.children[i],a)}t.children.length=0,delete t.object.__r3f,a&&"primitive"!==t.type&&"Scene"!==t.object.type&&z8(t.object),void 0===n&&f8(t)}function G8(e,t){for(const n of[e,e.alternate])if(null!==n)if("function"==typeof n.ref){null==n.refCleanup||n.refCleanup();const e=n.ref(t);"function"==typeof e&&(n.refCleanup=e)}else n.ref&&(n.ref.current=t)}const V8=[];const $8=()=>{},W8={};let Y8=0;const X8=E8({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:function(e,t,n){var r;return O8(e=D8(e)in T8?e:e.replace(P8,""),t),"primitive"===e&&null!=(r=t.object)&&r.__r3f&&delete t.object.__r3f,i8(t.object,n,e,t)},removeChild:H8,appendChild:F8,appendInitialChild:F8,insertBefore:U8,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;t&&n&&F8(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;t&&n&&H8(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;t&&n&&r&&U8(r,t,n)},getRootHostContext:()=>W8,getChildHostContext:()=>W8,commitUpdate(e,t,n,r,a){var i,s,o;O8(t,r);let c=!1;if(("primitive"===e.type&&n.object!==r.object||(null==(i=r.args)?void 0:i.length)!==(null==(s=n.args)?void 0:s.length)||null!=(o=r.args)&&o.some((e,t)=>{var r;return e!==(null==(r=n.args)?void 0:r[t])}))&&(c=!0),c)V8.push([e,l({},r),a]);else{const t=function(e,t){const n={};for(const r in t)if(!d8.includes(r)&&!n8.equ(t[r],e.props[r])){n[r]=t[r];for(const e in t)e.startsWith(`${r}-`)&&(n[e]=t[e])}for(const r in e.props){if(d8.includes(r)||t.hasOwnProperty(r))continue;const{root:a,key:i}=s8(e.object,r);if(a.constructor&&0===a.constructor.length){const e=h8(a);n8.und(e)||(n[i]=e[i])}else n[i]=0}return n}(e,r);Object.keys(t).length&&(Object.assign(e.props,t),g8(e.object,t))}(null===a.sibling||!(4&a.flags))&&function(){for(const[n]of V8){const e=n.parent;if(e){n.props.attach?c8(e,n):y8(n.object)&&y8(e.object)&&e.object.remove(n.object);for(const e of n.children)e.props.attach?c8(n,e):y8(e.object)&&y8(n.object)&&n.object.remove(e.object)}n.isHidden&&B8(n),n.object.__r3f&&delete n.object.__r3f,"primitive"!==n.type&&z8(n.object)}for(const[n,r,a]of V8){n.props=r;const i=n.parent;if(i){var e,t;const r=T8[D8(n.type)];n.object=null!=(e=n.props.object)?e:new r(...null!=(t=n.props.args)?t:[]),n.object.__r3f=n,G8(a,n.object),g8(n.object,n.props),n.props.attach?l8(i,n):y8(n.object)&&y8(i.object)&&i.object.add(n.object);for(const e of n.children)e.props.attach?l8(n,e):y8(e.object)&&y8(n.object)&&n.object.add(e.object);f8(n)}}V8.length=0}()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>null==e?void 0:e.object,prepareForCommit:()=>null,preparePortalMount:e=>i8(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:function(e){var t;e.isHidden||(e.props.attach&&null!=(t=e.parent)&&t.object?c8(e.parent,e):y8(e.object)&&(e.object.visible=!1),e.isHidden=!0,f8(e))},unhideInstance:B8,createTextInstance:$8,hideTextInstance:$8,unhideTextInstance:$8,scheduleTimeout:"function"==typeof setTimeout?setTimeout:void 0,cancelTimeout:"function"==typeof clearTimeout?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:f.createContext(null),setCurrentUpdatePriority(e){Y8=e},getCurrentUpdatePriority:()=>Y8,resolveUpdatePriority(){var e;if(0!==Y8)return Y8;switch("undefined"!=typeof window&&(null==(e=window.event)?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return J$.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return J$.ContinuousEventPriority;default:return J$.DefaultEventPriority}},resetFormInstance(){}}),K8=new Map,q8={objects:"shallow",strict:!1};function J8(e){const t=K8.get(e),n=null==t?void 0:t.fiber,r=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const a="function"==typeof reportError?reportError:console.error,i=r||((e,t)=>{const n=v6((n,r)=>{const a=new WX,i=new WX,s=new WX;function o(e=r().camera,t=i,n=r().size){const{width:o,height:l,top:c,left:d}=n,u=o/l;t.isVector3?s.copy(t):s.set(...t);const h=e.getWorldPosition(a).distanceTo(s);if(X6(e))return{width:o/e.zoom,height:l/e.zoom,top:c,left:d,factor:1,distance:h,aspect:u};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*h,r=n*(o/l);return{width:r,height:n,top:c,left:d,factor:o/r,distance:h,aspect:u}}}let d;const u=e=>n(t=>({performance:c(l({},t.performance),{current:e})})),h=new VX;return{set:n,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(t=1)=>e(r(),t),advance:(e,n)=>t(e,n,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new k2,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();d&&clearTimeout(d),e.performance.current!==e.performance.min&&u(e.performance.min),d=setTimeout(()=>u(r().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:o},setEvents:e=>n(t=>c(l({},t),{events:l(l({},t.events),e)})),setSize:(e,t,a=0,s=0)=>{const c=r().camera,d={width:e,height:t,top:a,left:s};n(e=>({size:d,viewport:l(l({},e.viewport),o(c,i,d))}))},setDpr:e=>n(t=>{const n=e8(e);return{viewport:c(l({},t.viewport),{dpr:n,initialDpr:t.viewport.initialDpr||n})}}),setFrameloop:(e="always")=>{const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n(()=>({frameloop:e}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:f.createRef(),active:!1,frames:0,priority:0,subscribe:(e,t,n)=>{const a=r().internal;return a.priority=a.priority+(t>0?1:0),a.subscribers.push({ref:e,priority:t,store:n}),a.subscribers=a.subscribers.sort((e,t)=>e.priority-t.priority),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}}}),r=n.getState();let a=r.size,i=r.viewport.dpr,s=r.camera;return n.subscribe(()=>{const{camera:e,size:t,viewport:r,gl:o,set:c}=n.getState();if(t.width!==a.width||t.height!==a.height||r.dpr!==i){a=t,i=r.dpr,x8(e,t),r.dpr>0&&o.setPixelRatio(r.dpr);const n="undefined"!=typeof HTMLCanvasElement&&o.domElement instanceof HTMLCanvasElement;o.setSize(t.width,t.height,n)}e!==s&&(s=e,c(t=>({viewport:l(l({},t.viewport),t.viewport.getCurrentViewport(e))})))}),n.subscribe(t=>e(t)),n})(g7,f7),s=n||X8.createContainer(i,J$.ConcurrentRoot,null,!1,null,"",a,a,a,null);let o,u;t||K8.set(e,{fiber:s,store:i});let p=!1,m=null;return{configure(){return h(this,arguments,function*(t={}){let n;m=new Promise(e=>n=e);let{gl:r,size:a,scene:s,events:c,onCreated:h,shadows:g=!1,linear:f=!1,flat:x=!1,legacy:y=!1,orthographic:v=!1,frameloop:b="always",dpr:w=[1,2],performance:N,raycaster:S,camera:j,onPointerMissed:_}=t,A=i.getState(),C=A.gl;if(!A.gl){const t={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},n="function"==typeof r?yield r(t):r;C=N8(n)?n:new p6(l(l({},t),r)),A.set({gl:C})}let M=A.raycaster;M||A.set({raycaster:M=new Z2});const k=S||{},{params:E}=k,T=d(k,["params"]);if(n8.equ(T,M,q8)||g8(M,l({},T)),n8.equ(E,M.params,q8)||g8(M,{params:l(l({},M.params),E)}),!A.camera||A.camera===u&&!n8.equ(u,j,q8)){u=j;const e=null==j?void 0:j.isCamera,t=e?j:v?new o2(0,0,0,0,.1,1e3):new kJ(75,0,.1,1e3);e||(t.position.z=5,j&&(g8(t,j),t.manual||("aspect"in j||"left"in j||"right"in j||"bottom"in j||"top"in j)&&(t.manual=!0,t.updateProjectionMatrix())),A.camera||null!=j&&j.rotation||t.lookAt(0,0,0)),A.set({camera:t}),M.camera=t}if(!A.scene){let e;null!=s&&s.isScene?(e=s,i8(e,i,"",{})):(e=new FJ,i8(e,i,"",{}),s&&g8(e,s)),A.set({scene:e})}c&&!A.events.handlers&&A.set({events:c(i)});const P=function(e,t){if(!t&&"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:r,left:a}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:a}}return!t&&"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:l({width:0,height:0,top:0,left:0},t)}(e,a);if(n8.equ(P,A.size,q8)||A.setSize(P.width,P.height,P.top,P.left),w&&A.viewport.dpr!==e8(w)&&A.setDpr(w),A.frameloop!==b&&A.setFrameloop(b),A.onPointerMissed||A.set({onPointerMissed:_}),N&&!n8.equ(N,A.performance,q8)&&A.set(e=>({performance:l(l({},e.performance),N)})),!A.xr){var D;const e=(e,t)=>{const n=i.getState();"never"!==n.frameloop&&f7(e,!0,n,t)},t=()=>{const t=i.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||g7(t)},n={connect(){const e=i.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=i.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(D=C.xr)?void 0:D.addEventListener)&&n.connect(),A.set({xr:n})}if(C.shadowMap){const e=C.shadowMap.enabled,t=C.shadowMap.type;if(C.shadowMap.enabled=!!g,n8.boo(g))C.shadowMap.type=2;else if(n8.str(g)){var R;const e={basic:0,percentage:1,soft:2,variance:3};C.shadowMap.type=null!=(R=e[g])?R:2}else n8.obj(g)&&Object.assign(C.shadowMap,g);e===C.shadowMap.enabled&&t===C.shadowMap.type||(C.shadowMap.needsUpdate=!0)}return eK.enabled=!y,p||(C.outputColorSpace=f?iX:aX,C.toneMapping=x?0:4),A.legacy!==y&&A.set(()=>({legacy:y})),A.linear!==f&&A.set(()=>({linear:f})),A.flat!==x&&A.set(()=>({flat:x})),!r||n8.fun(r)||N8(r)||n8.equ(r,C,q8)||g8(C,r),o=h,p=!0,n(),this})},render(t){return p||m||this.configure(),m.then(()=>{X8.updateContainer(Nt.jsx(Q8,{store:i,children:t,onCreated:o,rootElement:e}),s,null,()=>{})}),i},unmount(){Z8(e)}}}function Q8({store:e,children:t,onCreated:n,rootElement:r}){return q6(()=>{const t=e.getState();t.set(e=>({internal:c(l({},e.internal),{active:!0})})),n&&n(t),e.getState().events.connected||null==t.events.connect||t.events.connect(r)},[]),Nt.jsx(S8.Provider,{value:e,children:t})}function Z8(e,t){const n=K8.get(e),r=null==n?void 0:n.fiber;if(r){const t=null==n?void 0:n.store.getState();t&&(t.internal.active=!1),X8.updateContainer(null,r,null,()=>{t&&setTimeout(()=>{try{var n,r,a,i;null==t.events.disconnect||t.events.disconnect(),null==(n=t.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(a=t.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(i=t.gl)&&i.xr&&t.xr.disconnect(),function(e){"Scene"!==e.type&&(null==e.dispose||e.dispose());for(const t in e){const n=e[t];"Scene"!==(null==n?void 0:n.type)&&(null==n||null==n.dispose||n.dispose())}}(t.scene),K8.delete(e)}catch(bI){}},500)})}}function e7({state:e={},children:t,container:n}){const r=e,{events:a,size:i}=r,s=d(r,["events","size"]),o=j8(),[u]=f.useState(()=>new Z2),[h]=f.useState(()=>new VX),p=J6((e,t)=>{let r;if(t.camera&&i){const n=t.camera;r=e.viewport.getCurrentViewport(n,new WX,i),n!==e.camera&&x8(n,i)}return c(l(l({},e),t),{scene:n,raycaster:u,pointer:h,mouse:h,previousRoot:o,events:l(l(l({},e.events),t.events),a),size:l(l({},e.size),i),viewport:l(l({},e.viewport),r),setEvents:e=>t.set(t=>c(l({},t),{events:l(l({},t.events),e)}))})}),m=f.useMemo(()=>{const e=v6((e,t)=>c(l({},s),{set:e,get:t})),t=t=>e.setState(e=>p.current(t,e));return t(o.getState()),o.subscribe(t),e},[o,n]);return Nt.jsx(Nt.Fragment,{children:X8.createPortal(Nt.jsx(S8.Provider,{value:m,children:t}),m,null)})}const t7=new Set,n7=new Set,r7=new Set;function a7(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function i7(e,t){switch(e){case"before":return a7(t7,t);case"after":return a7(n7,t);case"tail":return a7(r7,t)}}let s7,o7;function l7(e,t,n){let r=t.clock.getDelta();"never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),s7=t.internal.subscribers;for(let a=0;a<s7.length;a++)o7=s7[a],o7.ref.current(o7.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}let c7,d7,u7,h7=!1,p7=!1;function m7(e){d7=requestAnimationFrame(m7),h7=!0,c7=0,i7("before",e),p7=!0;for(const n of K8.values()){var t;u7=n.store.getState(),!u7.internal.active||!("always"===u7.frameloop||u7.internal.frames>0)||null!=(t=u7.gl.xr)&&t.isPresenting||(c7+=l7(e,u7))}if(p7=!1,i7("after",e),0===c7)return i7("tail",e),h7=!1,cancelAnimationFrame(d7)}function g7(e,t=1){var n;if(!e)return K8.forEach(e=>g7(e.store.getState(),t));null!=(n=e.gl.xr)&&n.isPresenting||!e.internal.active||"never"===e.frameloop||(e.internal.frames=t>1?Math.min(60,e.internal.frames+t):p7?2:1,h7||(h7=!0,requestAnimationFrame(m7)))}function f7(e,t=!0,n,r){if(t&&i7("before",e),n)l7(e,n,r);else for(const a of K8.values())l7(e,a.store.getState());t&&i7("after",e)}const x7={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function y7(e){const{handlePointer:t}=w8(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(x7).reduce((e,n)=>c(l({},e),{[n]:t(n)}),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=e.getState();if(null==r.disconnect||r.disconnect(),n(e=>({events:c(l({},e.events),{connected:t})})),r.handlers)for(const e in r.handlers){const n=r.handlers[e],[a,i]=x7[e];t.addEventListener(a,n,{passive:i})}},disconnect:()=>{const{set:t,events:n}=e.getState();if(n.connected){if(n.handlers)for(const e in n.handlers){const t=n.handlers[e],[r]=x7[e];n.connected.removeEventListener(r,t)}t(e=>({events:c(l({},e.events),{connected:void 0})}))}}}}function v7(e,t){let n;return(...r)=>{window.clearTimeout(n),n=window.setTimeout(()=>e(...r),t)}}function b7({debounce:e,scroll:t,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const a=n||("undefined"==typeof window?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[i,s]=f.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=f.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:i,orientationHandler:null}),l=e?"number"==typeof e?e:e.scroll:null,c=e?"number"==typeof e?e:e.resize:null,d=f.useRef(!1);f.useEffect(()=>(d.current=!0,()=>{d.current=!1}));const[u,h,p]=f.useMemo(()=>{const e=()=>{if(!o.current.element)return;const{left:e,top:t,width:n,height:a,bottom:i,right:l,x:c,y:u}=o.current.element.getBoundingClientRect(),h={left:e,top:t,width:n,height:a,bottom:i,right:l,x:c,y:u};o.current.element instanceof HTMLElement&&r&&(h.height=o.current.element.offsetHeight,h.width=o.current.element.offsetWidth),Object.freeze(h),d.current&&!S7(o.current.lastBounds,h)&&s(o.current.lastBounds=h)};return[e,c?v7(e,c):e,l?v7(e,l):e]},[s,r,l,c]);function m(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",p,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function g(){o.current.element&&(o.current.resizeObserver=new a(p),o.current.resizeObserver.observe(o.current.element),t&&o.current.scrollContainers&&o.current.scrollContainers.forEach(e=>e.addEventListener("scroll",p,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}return function(e,t){f.useEffect(()=>{if(t){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[e,t])}(p,!!t),function(e){f.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[e])}(h),f.useEffect(()=>{m(),g()},[t,p,h]),f.useEffect(()=>m,[]),[e=>{!e||e===o.current.element||(m(),o.current.element=e,o.current.scrollContainers=w7(e),g())},i,u]}function w7(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:a}=window.getComputedStyle(e);return[n,r,a].some(e=>"auto"===e||"scroll"===e)&&t.push(e),[...t,...w7(e.parentElement)]}const N7=["x","y","top","bottom","left","right","width","height"],S7=(e,t)=>N7.every(n=>e[n]===t[n]);function j7(e){var t=e,{ref:n,children:r,fallback:a,resize:i,style:s,gl:o,events:u=y7,eventSource:p,eventPrefix:m,shadows:g,linear:x,flat:y,legacy:v,orthographic:b,frameloop:w,dpr:N,performance:S,raycaster:j,camera:_,scene:A,onPointerMissed:C,onCreated:M}=t,k=d(t,["ref","children","fallback","resize","style","gl","events","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated"]);f.useMemo(()=>I8(m6),[]);const E=function(){const e=G6(),t=W6();return f.useMemo(()=>({children:n})=>{const r=F6(e,!0,e=>e.type===f.StrictMode)?f.StrictMode:f.Fragment;return Nt.jsx(r,{children:Nt.jsx(t,{children:n})})},[e,t])}(),[T,P]=b7(l({scroll:!0,debounce:{scroll:50,resize:0}},i)),D=f.useRef(null),R=f.useRef(null);f.useImperativeHandle(n,()=>D.current);const I=J6(C),[O,B]=f.useState(!1),[L,F]=f.useState(!1);if(O)throw O;if(L)throw L;const U=f.useRef(null);q6(()=>{const e=D.current;if(P.width>0&&P.height>0&&e){function t(){return h(this,null,function*(){yield U.current.configure({gl:o,scene:A,events:u,shadows:g,linear:x,flat:y,legacy:v,orthographic:b,frameloop:w,dpr:N,performance:S,raycaster:j,camera:_,size:P,onPointerMissed:(...e)=>null==I.current?void 0:I.current(...e),onCreated:e=>{var t;null==e.events.connect||e.events.connect(p?(t=p)&&t.hasOwnProperty("current")?p.current:p:R.current),m&&e.setEvents({compute:(e,t)=>{const n=e[m+"X"],r=e[m+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==M||M(e)}}),U.current.render(Nt.jsx(E,{children:Nt.jsx(Z6,{set:F,children:Nt.jsx(f.Suspense,{fallback:Nt.jsx(Q6,{set:B}),children:null!=r?r:null})})}))})}U.current||(U.current=J8(e)),t()}}),f.useEffect(()=>{const e=D.current;if(e)return()=>Z8(e)},[]);const z=p?"none":"auto";return Nt.jsx("div",c(l({ref:R,style:l({position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:z},s)},k),{children:Nt.jsx("div",{ref:T,style:{width:"100%",height:"100%"},children:Nt.jsx("canvas",{ref:D,style:{display:"block"},children:a})})}))}function _7(e){return Nt.jsx(H6,{children:Nt.jsx(j7,l({},e))})}function A7(){return A7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A7.apply(null,arguments)}const C7=(()=>parseInt(Q$.replace(/\D+/g,"")))();function M7(e,t){if(0===t)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(2===t||1===t){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const r=n.count-2,a=[];if(n)if(2===t)for(let e=1;e<=r;e++)a.push(n.getX(0)),a.push(n.getX(e)),a.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(a.push(n.getX(e)),a.push(n.getX(e+1)),a.push(n.getX(e+2))):(a.push(n.getX(e+2)),a.push(n.getX(e+1)),a.push(n.getX(e)));a.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=e.clone();return i.setIndex(a),i.clearGroups(),i}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}var k7=Uint8Array,E7=Uint16Array,T7=Uint32Array,P7=new k7([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),D7=new k7([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),R7=new k7([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),I7=function(e,t){for(var n=new E7(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var a=new T7(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)a[i]=i-n[r]<<5|r;return[n,a]},O7=I7(P7,2),B7=O7[0],L7=O7[1];B7[28]=258,L7[258]=28;for(var F7=I7(D7,0)[0],U7=new E7(32768),z7=0;z7<32768;++z7){var H7=(43690&z7)>>>1|(21845&z7)<<1;H7=(61680&(H7=(52428&H7)>>>2|(13107&H7)<<2))>>>4|(3855&H7)<<4,U7[z7]=((65280&H7)>>>8|(255&H7)<<8)>>>1}var G7=function(e,t,n){for(var r=e.length,a=0,i=new E7(t);a<r;++a)++i[e[a]-1];var s,o=new E7(t);for(a=0;a<t;++a)o[a]=o[a-1]+i[a-1]<<1;if(n){s=new E7(1<<t);var l=15-t;for(a=0;a<r;++a)if(e[a])for(var c=a<<4|e[a],d=t-e[a],u=o[e[a]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)s[U7[u]>>>l]=c}else for(s=new E7(r),a=0;a<r;++a)e[a]&&(s[a]=U7[o[e[a]-1]++]>>>15-e[a]);return s},V7=new k7(288);for(z7=0;z7<144;++z7)V7[z7]=8;for(z7=144;z7<256;++z7)V7[z7]=9;for(z7=256;z7<280;++z7)V7[z7]=7;for(z7=280;z7<288;++z7)V7[z7]=8;var $7=new k7(32);for(z7=0;z7<32;++z7)$7[z7]=5;var W7=G7(V7,9,1),Y7=G7($7,5,1),X7=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},K7=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},q7=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},J7=function(e){return(e/8|0)+(7&e&&1)},Q7=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new k7(0);var a=!t||n,i=!n||n.i;n||(n={}),t||(t=new k7(3*r));var s=function(e){var n=t.length;if(e>n){var r=new k7(Math.max(2*n,e));r.set(t),t=r}},o=n.f||0,l=n.p||0,c=n.b||0,d=n.l,u=n.d,h=n.m,p=n.n,m=8*r;do{if(!d){n.f=o=K7(e,l,1);var g=K7(e,l+1,3);if(l+=3,!g){var f=e[(C=J7(l)+4)-4]|e[C-3]<<8,x=C+f;if(x>r){if(i)throw"unexpected EOF";break}a&&s(c+f),t.set(e.subarray(C,x),c),n.b=c+=f,n.p=l=8*x;continue}if(1==g)d=W7,u=Y7,h=9,p=5;else{if(2!=g)throw"invalid block type";var y=K7(e,l,31)+257,v=K7(e,l+10,15)+4,b=y+K7(e,l+5,31)+1;l+=14;for(var w=new k7(b),N=new k7(19),S=0;S<v;++S)N[R7[S]]=K7(e,l+3*S,7);l+=3*v;var j=X7(N),_=(1<<j)-1,A=G7(N,j,1);for(S=0;S<b;){var C,M=A[K7(e,l,_)];if(l+=15&M,(C=M>>>4)<16)w[S++]=C;else{var k=0,E=0;for(16==C?(E=3+K7(e,l,3),l+=2,k=w[S-1]):17==C?(E=3+K7(e,l,7),l+=3):18==C&&(E=11+K7(e,l,127),l+=7);E--;)w[S++]=k}}var T=w.subarray(0,y),P=w.subarray(y);h=X7(T),p=X7(P),d=G7(T,h,1),u=G7(P,p,1)}if(l>m){if(i)throw"unexpected EOF";break}}a&&s(c+131072);for(var D=(1<<h)-1,R=(1<<p)-1,I=l;;I=l){var O=(k=d[q7(e,l)&D])>>>4;if((l+=15&k)>m){if(i)throw"unexpected EOF";break}if(!k)throw"invalid length/literal";if(O<256)t[c++]=O;else{if(256==O){I=l,d=null;break}var B=O-254;if(O>264){var L=P7[S=O-257];B=K7(e,l,(1<<L)-1)+B7[S],l+=L}var F=u[q7(e,l)&R],U=F>>>4;if(!F)throw"invalid distance";l+=15&F;P=F7[U];if(U>3){L=D7[U];P+=q7(e,l)&(1<<L)-1,l+=L}if(l>m){if(i)throw"unexpected EOF";break}a&&s(c+131072);for(var z=c+B;c<z;c+=4)t[c]=t[c-P],t[c+1]=t[c+1-P],t[c+2]=t[c+2-P],t[c+3]=t[c+3-P];c=z}}n.l=d,n.p=I,n.b=c,d&&(o=1,n.m=h,n.d=u,n.n=p)}while(!o);return c==t.length?t:function(e,t,n){(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof E7?E7:e instanceof T7?T7:k7)(n-t);return r.set(e.subarray(t,n)),r}(t,0,c)},Z7=new k7(0);function e9(e,t){return Q7((function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"}(e),e.subarray(2,-4)),t)}var t9="undefined"!=typeof TextDecoder&&new TextDecoder;try{t9.decode(Z7,{stream:!0})}catch(bI){}class n9 extends xJ{constructor(e,t){var n,r;const a=(i=e)&&i.isCubeTexture;var i;const s=(null!=(r=a?null==(n=e.image[0])?void 0:n.width:e.image.width)?r:1024)/4,o=Math.floor(Math.log2(s)),l=Math.pow(2,o),c=[a?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH "+1/(3*Math.max(l,112)),"#define CUBEUV_TEXEL_HEIGHT "+1/(4*l),`#define CUBEUV_MAX_MIP ${o}.0`].join("\n")+`\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <${C7>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n        `,d={map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}};super(new $0(1,16),new jJ({uniforms:d,fragmentShader:c,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:2}))}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var r9=Object.defineProperty,a9=(e,t,n)=>(((e,t,n)=>{t in e?r9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n),n);class i9{constructor(){a9(this,"_listeners")}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}var s9=Object.defineProperty,o9=(e,t,n)=>(((e,t,n)=>{t in e?s9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const l9=new HK,c9=new IQ,d9=Math.cos(Math.PI/180*70),u9=(e,t)=>(e%t+t)%t;let h9=class extends i9{constructor(e,t){super(),o9(this,"object"),o9(this,"domElement"),o9(this,"enabled",!0),o9(this,"target",new WX),o9(this,"minDistance",0),o9(this,"maxDistance",1/0),o9(this,"minZoom",0),o9(this,"maxZoom",1/0),o9(this,"minPolarAngle",0),o9(this,"maxPolarAngle",Math.PI),o9(this,"minAzimuthAngle",-1/0),o9(this,"maxAzimuthAngle",1/0),o9(this,"enableDamping",!1),o9(this,"dampingFactor",.05),o9(this,"enableZoom",!0),o9(this,"zoomSpeed",1),o9(this,"enableRotate",!0),o9(this,"rotateSpeed",1),o9(this,"enablePan",!0),o9(this,"panSpeed",1),o9(this,"screenSpacePanning",!0),o9(this,"keyPanSpeed",7),o9(this,"zoomToCursor",!1),o9(this,"autoRotate",!1),o9(this,"autoRotateSpeed",2),o9(this,"reverseOrbit",!1),o9(this,"reverseHorizontalOrbit",!1),o9(this,"reverseVerticalOrbit",!1),o9(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),o9(this,"mouseButtons",{LEFT:Z$.ROTATE,MIDDLE:Z$.DOLLY,RIGHT:Z$.PAN}),o9(this,"touches",{ONE:eW.ROTATE,TWO:eW.DOLLY_PAN}),o9(this,"target0"),o9(this,"position0"),o9(this,"zoom0"),o9(this,"_domElementKeyEvents",null),o9(this,"getPolarAngle"),o9(this,"getAzimuthalAngle"),o9(this,"setPolarAngle"),o9(this,"setAzimuthalAngle"),o9(this,"getDistance"),o9(this,"getZoomScale"),o9(this,"listenToKeyEvents"),o9(this,"stopListenToKeyEvents"),o9(this,"saveState"),o9(this,"reset"),o9(this,"update"),o9(this,"connect"),o9(this,"dispose"),o9(this,"dollyIn"),o9(this,"dollyOut"),o9(this,"getScale"),o9(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=u9(e,2*Math.PI),r=c.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let a=Math.abs(t-r);2*Math.PI-a<a&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=u9(e,2*Math.PI),r=c.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let a=Math.abs(t-r);2*Math.PI-a<a&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",q),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",q),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),o=s.NONE},this.update=(()=>{const t=new WX,a=new WX(0,1,0),i=(new $X).setFromUnitVectors(e.up,a),p=i.clone().invert(),m=new WX,g=new $X,f=2*Math.PI;return function(){const x=n.object.position;i.setFromUnitVectors(e.up,a),p.copy(i).invert(),t.copy(x).sub(n.target),t.applyQuaternion(i),c.setFromVector3(t),n.autoRotate&&o===s.NONE&&M(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=d.theta*n.dampingFactor,c.phi+=d.phi*n.dampingFactor):(c.theta+=d.theta,c.phi+=d.phi);let y=n.minAzimuthAngle,v=n.maxAzimuthAngle;isFinite(y)&&isFinite(v)&&(y<-Math.PI?y+=f:y>Math.PI&&(y-=f),v<-Math.PI?v+=f:v>Math.PI&&(v-=f),c.theta=y<=v?Math.max(y,Math.min(v,c.theta)):c.theta>(y+v)/2?Math.max(y,c.theta):Math.min(v,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),n.zoomToCursor&&j||n.object.isOrthographicCamera?c.radius=B(c.radius):c.radius=B(c.radius*u),t.setFromSpherical(c),t.applyQuaternion(p),x.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),h.set(0,0,0));let b=!1;if(n.zoomToCursor&&j){let r=null;if(n.object instanceof kJ&&n.object.isPerspectiveCamera){const e=t.length();r=B(e*u);const a=e-r;n.object.position.addScaledVector(N,a),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new WX(S.x,S.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix(),b=!0;const a=new WX(S.x,S.y,0);a.unproject(n.object),n.object.position.sub(a).add(e),n.object.updateMatrixWorld(),r=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==r&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(r).add(n.object.position):(l9.origin.copy(n.object.position),l9.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(l9.direction))<d9?e.lookAt(n.target):(c9.setFromNormalAndCoplanarPoint(n.object.up,n.target),l9.intersectPlane(c9,n.target))))}else n.object instanceof o2&&n.object.isOrthographicCamera&&(b=1!==u,b&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix()));return u=1,j=!1,!!(b||m.distanceToSquared(n.object.position)>l||8*(1-g.dot(n.object.quaternion))>l)&&(n.dispatchEvent(r),m.copy(n.object.position),g.copy(n.object.quaternion),b=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",J),n.domElement.addEventListener("pointerdown",W),n.domElement.addEventListener("pointercancel",X),n.domElement.addEventListener("wheel",K)},this.dispose=()=>{var e,t,r,a,i,s;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",J),null==(t=n.domElement)||t.removeEventListener("pointerdown",W),null==(r=n.domElement)||r.removeEventListener("pointercancel",X),null==(a=n.domElement)||a.removeEventListener("wheel",K),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",Y),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointerup",X),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",q)};const n=this,r={type:"change"},a={type:"start"},i={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=s.NONE;const l=1e-6,c=new r3,d=new r3;let u=1;const h=new WX,p=new VX,m=new VX,g=new VX,f=new VX,x=new VX,y=new VX,v=new VX,b=new VX,w=new VX,N=new WX,S=new VX;let j=!1;const _=[],A={};function C(){return Math.pow(.95,n.zoomSpeed)}function M(e){n.reverseOrbit||n.reverseHorizontalOrbit?d.theta+=e:d.theta-=e}function k(e){n.reverseOrbit||n.reverseVerticalOrbit?d.phi+=e:d.phi-=e}const E=(()=>{const e=new WX;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),h.add(e)}})(),T=(()=>{const e=new WX;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),h.add(e)}})(),P=(()=>{const e=new WX;return function(t,r){const a=n.domElement;if(a&&n.object instanceof kJ&&n.object.isPerspectiveCamera){const i=n.object.position;e.copy(i).sub(n.target);let s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180),E(2*t*s/a.clientHeight,n.object.matrix),T(2*r*s/a.clientHeight,n.object.matrix)}else a&&n.object instanceof o2&&n.object.isOrthographicCamera?(E(t*(n.object.right-n.object.left)/n.object.zoom/a.clientWidth,n.object.matrix),T(r*(n.object.top-n.object.bottom)/n.object.zoom/a.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function D(e){n.object instanceof kJ&&n.object.isPerspectiveCamera||n.object instanceof o2&&n.object.isOrthographicCamera?u=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function R(e){D(u/e)}function I(e){D(u*e)}function O(e){if(!n.zoomToCursor||!n.domElement)return;j=!0;const t=n.domElement.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top,i=t.width,s=t.height;S.x=r/i*2-1,S.y=-a/s*2+1,N.set(S.x,S.y,1).unproject(n.object).sub(n.object.position).normalize()}function B(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function L(e){p.set(e.clientX,e.clientY)}function F(e){f.set(e.clientX,e.clientY)}function U(){if(1==_.length)p.set(_[0].pageX,_[0].pageY);else{const e=.5*(_[0].pageX+_[1].pageX),t=.5*(_[0].pageY+_[1].pageY);p.set(e,t)}}function z(){if(1==_.length)f.set(_[0].pageX,_[0].pageY);else{const e=.5*(_[0].pageX+_[1].pageX),t=.5*(_[0].pageY+_[1].pageY);f.set(e,t)}}function H(){const e=_[0].pageX-_[1].pageX,t=_[0].pageY-_[1].pageY,n=Math.sqrt(e*e+t*t);v.set(0,n)}function G(e){if(1==_.length)m.set(e.pageX,e.pageY);else{const t=Z(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);m.set(n,r)}g.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(M(2*Math.PI*g.x/t.clientHeight),k(2*Math.PI*g.y/t.clientHeight)),p.copy(m)}function V(e){if(1==_.length)x.set(e.pageX,e.pageY);else{const t=Z(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);x.set(n,r)}y.subVectors(x,f).multiplyScalar(n.panSpeed),P(y.x,y.y),f.copy(x)}function $(e){const t=Z(e),r=e.pageX-t.x,a=e.pageY-t.y,i=Math.sqrt(r*r+a*a);b.set(0,i),w.set(0,Math.pow(b.y/v.y,n.zoomSpeed)),R(w.y),v.copy(b)}function W(e){var t,r;!1!==n.enabled&&(0===_.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",Y),null==(r=n.domElement)||r.ownerDocument.addEventListener("pointerup",X)),function(e){_.push(e)}(e),"touch"===e.pointerType?function(e){switch(Q(e),_.length){case 1:switch(n.touches.ONE){case eW.ROTATE:if(!1===n.enableRotate)return;U(),o=s.TOUCH_ROTATE;break;case eW.PAN:if(!1===n.enablePan)return;z(),o=s.TOUCH_PAN;break;default:o=s.NONE}break;case 2:switch(n.touches.TWO){case eW.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&H(),n.enablePan&&z(),o=s.TOUCH_DOLLY_PAN;break;case eW.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&H(),n.enableRotate&&U(),o=s.TOUCH_DOLLY_ROTATE;break;default:o=s.NONE}break;default:o=s.NONE}o!==s.NONE&&n.dispatchEvent(a)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Z$.DOLLY:if(!1===n.enableZoom)return;!function(e){O(e),v.set(e.clientX,e.clientY)}(e),o=s.DOLLY;break;case Z$.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;F(e),o=s.PAN}else{if(!1===n.enableRotate)return;L(e),o=s.ROTATE}break;case Z$.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;L(e),o=s.ROTATE}else{if(!1===n.enablePan)return;F(e),o=s.PAN}break;default:o=s.NONE}o!==s.NONE&&n.dispatchEvent(a)}(e))}function Y(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(Q(e),o){case s.TOUCH_ROTATE:if(!1===n.enableRotate)return;G(e),n.update();break;case s.TOUCH_PAN:if(!1===n.enablePan)return;V(e),n.update();break;case s.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&$(e),n.enablePan&&V(e)}(e),n.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&$(e),n.enableRotate&&G(e)}(e),n.update();break;default:o=s.NONE}}(e):function(e){if(!1===n.enabled)return;switch(o){case s.ROTATE:if(!1===n.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),g.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(M(2*Math.PI*g.x/t.clientHeight),k(2*Math.PI*g.y/t.clientHeight)),p.copy(m),n.update()}(e);break;case s.DOLLY:if(!1===n.enableZoom)return;!function(e){b.set(e.clientX,e.clientY),w.subVectors(b,v),w.y>0?R(C()):w.y<0&&I(C()),v.copy(b),n.update()}(e);break;case s.PAN:if(!1===n.enablePan)return;!function(e){x.set(e.clientX,e.clientY),y.subVectors(x,f).multiplyScalar(n.panSpeed),P(y.x,y.y),f.copy(x),n.update()}(e)}}(e))}function X(e){var t,r,a;!function(e){delete A[e.pointerId];for(let t=0;t<_.length;t++)if(_[t].pointerId==e.pointerId)return void _.splice(t,1)}(e),0===_.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",Y),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointerup",X)),n.dispatchEvent(i),o=s.NONE}function K(e){!1===n.enabled||!1===n.enableZoom||o!==s.NONE&&o!==s.ROTATE||(e.preventDefault(),n.dispatchEvent(a),function(e){O(e),e.deltaY<0?I(C()):e.deltaY>0&&R(C()),n.update()}(e),n.dispatchEvent(i))}function q(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:P(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:P(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:P(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:P(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function J(e){!1!==n.enabled&&e.preventDefault()}function Q(e){let t=A[e.pointerId];void 0===t&&(t=new VX,A[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Z(e){const t=e.pointerId===_[0].pointerId?_[1]:_[0];return A[t.pointerId]}this.dollyIn=(e=C())=>{I(e),n.update()},this.dollyOut=(e=C())=>{R(e),n.update()},this.getScale=()=>u,this.setScale=e=>{D(e),n.update()},this.getZoomScale=()=>C(),void 0!==t&&this.connect(t),this.update()}};function p9(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(bI){return t}}const m9="srgb",g9="srgb-linear";class f9 extends F1{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new N9(e)}),this.register(function(e){return new S9(e)}),this.register(function(e){return new P9(e)}),this.register(function(e){return new D9(e)}),this.register(function(e){return new R9(e)}),this.register(function(e){return new _9(e)}),this.register(function(e){return new A9(e)}),this.register(function(e){return new C9(e)}),this.register(function(e){return new M9(e)}),this.register(function(e){return new w9(e)}),this.register(function(e){return new k9(e)}),this.register(function(e){return new j9(e)}),this.register(function(e){return new T9(e)}),this.register(function(e){return new E9(e)}),this.register(function(e){return new v9(e)}),this.register(function(e){return new I9(e)}),this.register(function(e){return new O9(e)})}load(e,t,n,r){const a=this;let i;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){const t=g2.extractUrlBase(e);i=g2.resolveURL(t,this.path)}else i=g2.extractUrlBase(e);this.manager.itemStart(e);const s=function(t){r?r(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},o=new H1(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(n){try{a.parse(n,i,function(n){t(n),a.manager.itemEnd(e)},s)}catch(bI){s(bI)}},n,s)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let a;const i={},s={};if("string"==typeof e)a=JSON.parse(e);else if(e instanceof ArrayBuffer){if(p9(new Uint8Array(e.slice(0,4)))===B9){try{i[y9.KHR_BINARY_GLTF]=new U9(e)}catch(l){return void(r&&r(l))}a=JSON.parse(i[y9.KHR_BINARY_GLTF].content)}else a=JSON.parse(p9(new Uint8Array(e)))}else a=e;if(void 0===a.asset||a.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const o=new hee(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](o);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),s[e.name]=e,i[e.name]=!0}if(a.extensionsUsed)for(let c=0;c<a.extensionsUsed.length;++c){const e=a.extensionsUsed[c],t=a.extensionsRequired||[];switch(e){case y9.KHR_MATERIALS_UNLIT:i[e]=new b9;break;case y9.KHR_DRACO_MESH_COMPRESSION:i[e]=new z9(a,this.dracoLoader);break;case y9.KHR_TEXTURE_TRANSFORM:i[e]=new H9;break;case y9.KHR_MESH_QUANTIZATION:i[e]=new G9;break;default:t.indexOf(e)>=0&&void 0===s[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}o.setExtensions(i),o.setPlugins(s),o.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,a){n.parse(e,t,r,a)})}}function x9(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const y9={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class v9{constructor(e){this.parser=e,this.name=y9.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const a=t.json,i=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let s;const o=new Iq(16777215);void 0!==i.color&&o.setRGB(i.color[0],i.color[1],i.color[2],g9);const l=void 0!==i.range?i.range:0;switch(i.type){case"directional":s=new c2(o),s.target.position.set(0,0,-1),s.add(s.target);break;case"point":s=new s2(o),s.distance=l;break;case"spot":s=new t2(o),s.distance=l,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,s.angle=i.spot.outerConeAngle,s.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,s.target.position.set(0,0,-1),s.add(s.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return s.position.set(0,0,0),s.decay=2,see(s,i),void 0!==i.intensity&&(s.intensity=i.intensity),s.name=t.createUniqueName(i.name||"light_"+e),r=Promise.resolve(s),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(e){return n._getNodeRef(t.cache,a,e)})}}class b9{constructor(){this.name=y9.KHR_MATERIALS_UNLIT}getMaterialType(){return Fq}extendParams(e,t,n){const r=[];e.color=new Iq(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const t=a.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],g9),e.opacity=t[3]}void 0!==a.baseColorTexture&&r.push(n.assignTexture(e,"map",a.baseColorTexture,m9))}return Promise.all(r)}}class w9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class N9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];if(void 0!==i.clearcoatFactor&&(t.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&a.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&a.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(a.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){const e=i.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new VX(e,e)}return Promise.all(a)}}class S9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.dispersion=void 0!==r.dispersion?r.dispersion:0,Promise.resolve()}}class j9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&a.push(n.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&a.push(n.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(a)}}class _9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new Iq(0,0,0),t.sheenRoughness=0,t.sheen=1;const i=r.extensions[this.name];if(void 0!==i.sheenColorFactor){const e=i.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],g9)}return void 0!==i.sheenRoughnessFactor&&(t.sheenRoughness=i.sheenRoughnessFactor),void 0!==i.sheenColorTexture&&a.push(n.assignTexture(t,"sheenColorMap",i.sheenColorTexture,m9)),void 0!==i.sheenRoughnessTexture&&a.push(n.assignTexture(t,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(a)}}class A9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&a.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(a)}}class C9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];t.thickness=void 0!==i.thicknessFactor?i.thicknessFactor:0,void 0!==i.thicknessTexture&&a.push(n.assignTexture(t,"thicknessMap",i.thicknessTexture)),t.attenuationDistance=i.attenuationDistance||1/0;const s=i.attenuationColor||[1,1,1];return t.attenuationColor=(new Iq).setRGB(s[0],s[1],s[2],g9),Promise.all(a)}}class M9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class k9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];t.specularIntensity=void 0!==i.specularFactor?i.specularFactor:1,void 0!==i.specularTexture&&a.push(n.assignTexture(t,"specularIntensityMap",i.specularTexture));const s=i.specularColorFactor||[1,1,1];return t.specularColor=(new Iq).setRGB(s[0],s[1],s[2],g9),void 0!==i.specularColorTexture&&a.push(n.assignTexture(t,"specularColorMap",i.specularColorTexture,m9)),Promise.all(a)}}class E9{constructor(e){this.parser=e,this.name=y9.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&a.push(n.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(a)}}class T9{constructor(e){this.parser=e,this.name=y9.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?l1:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const a=[],i=r.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&a.push(n.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(a)}}class P9{constructor(e){this.parser=e,this.name=y9.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const a=r.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,i)}}class D9{constructor(e){this.parser=e,this.name=y9.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,a=r.textures[e];if(!a.extensions||!a.extensions[t])return null;const i=a.extensions[t],s=r.images[i.source];let o=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(o=e)}return this.detectSupport().then(function(a){if(a)return n.loadTextureImage(e,i.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class R9{constructor(e){this.parser=e,this.name=y9.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,a=r.textures[e];if(!a.extensions||!a.extensions[t])return null;const i=a.extensions[t],s=r.images[i.source];let o=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(o=e)}return this.detectSupport().then(function(a){if(a)return n.loadTextureImage(e,i.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class I9{constructor(e){this.name=y9.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(t){const n=e.byteOffset||0,r=e.byteLength||0,i=e.count,s=e.byteStride,o=new Uint8Array(t,n,r);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(i,s,o,e.mode,e.filter).then(function(e){return e.buffer}):a.ready.then(function(){const t=new ArrayBuffer(i*s);return a.decodeGltfBuffer(new Uint8Array(t),i,s,o,e.mode,e.filter),t})})}return null}}class O9{constructor(e){this.name=y9.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const o of r.primitives)if(o.mode!==Y9.TRIANGLES&&o.mode!==Y9.TRIANGLE_STRIP&&o.mode!==Y9.TRIANGLE_FAN&&void 0!==o.mode)return null;const a=n.extensions[this.name].attributes,i=[],s={};for(const o in a)i.push(this.parser.getDependency("accessor",a[o]).then(e=>(s[o]=e,s[o])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{const t=e.pop(),n=t.isGroup?t.children:[t],r=e[0].count,a=[];for(const i of n){const e=new GK,t=new WX,n=new $X,o=new WX(1,1,1),l=new TQ(i.geometry,i.material,r);for(let a=0;a<r;a++)s.TRANSLATION&&t.fromBufferAttribute(s.TRANSLATION,a),s.ROTATION&&n.fromBufferAttribute(s.ROTATION,a),s.SCALE&&o.fromBufferAttribute(s.SCALE,a),l.setMatrixAt(a,e.compose(t,n,o));for(const r in s)if("_COLOR_0"===r){const e=s[r];l.instanceColor=new SQ(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&i.geometry.setAttribute(r,s[r]);fq.prototype.copy.call(l,i),this.parser.assignFinalMaterial(l),a.push(l)}return t.isGroup?(t.clear(),t.add(...a),t):a[0]}))}}const B9="glTF",L9=1313821514,F9=5130562;class U9{constructor(e){this.name=y9.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:p9(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==B9)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let a=0;for(;a<n;){const t=r.getUint32(a,!0);a+=4;const n=r.getUint32(a,!0);if(a+=4,n===L9){const n=new Uint8Array(e,12+a,t);this.content=p9(n)}else if(n===F9){const n=12+a;this.body=e.slice(n,n+t)}a+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class z9{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=y9.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,a=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,s={},o={},l={};for(const c in i){const e=Q9[c]||c.toLowerCase();s[e]=i[c]}for(const c in e.attributes){const t=Q9[c]||c.toLowerCase();if(void 0!==i[c]){const r=n.accessors[e.attributes[c]],a=X9[r.componentType];l[t]=a.name,o[t]=!0===r.normalized}}return t.getDependency("bufferView",a).then(function(e){return new Promise(function(t,n){r.decodeDracoFile(e,function(e){for(const t in e.attributes){const n=e.attributes[t],r=o[t];void 0!==r&&(n.normalized=r)}t(e)},s,l,g9,n)})})}}class H9{constructor(){this.name=y9.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class G9{constructor(){this.name=y9.KHR_MESH_QUANTIZATION}}class V9 extends N1{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r*3+r;for(let i=0;i!==r;i++)t[i]=n[a+i];return t}interpolate_(e,t,n,r){const a=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=2*s,l=3*s,c=r-t,d=(n-t)/c,u=d*d,h=u*d,p=e*l,m=p-l,g=-2*h+3*u,f=h-u,x=1-g,y=f-u+d;for(let v=0;v!==s;v++){const e=i[m+v+s],t=i[m+v+o]*c,n=i[p+v+s],r=i[p+v]*c;a[v]=x*e+y*t+g*n+f*r}return a}}const $9=new $X;class W9 extends V9{interpolate_(e,t,n,r){const a=super.interpolate_(e,t,n,r);return $9.fromArray(a).normalize().toArray(a),a}}const Y9={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},X9={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},K9={9728:zW,9729:VW,9984:HW,9985:$W,9986:GW,9987:WW},q9={33071:FW,33648:UW,10497:LW},J9={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Q9=c(l({POSITION:"position",NORMAL:"normal",TANGENT:"tangent"},C7>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"}),{COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"}),Z9={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},eee={CUBICSPLINE:void 0,LINEAR:qY,STEP:KY},tee="OPAQUE",nee="MASK",ree="BLEND";function aee(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new o1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),e.DefaultMaterial}function iee(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function see(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function oee(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function lee(e){let t;const n=e.extensions&&e.extensions[y9.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+cee(n.attributes):e.indices+":"+cee(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,a=e.targets.length;r<a;r++)t+=":"+cee(e.targets[r]);return t}function cee(e){let t="";const n=Object.keys(e).sort();for(let r=0,a=n.length;r<a;r++)t+=n[r]+":"+e[n[r]]+";";return t}function dee(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const uee=new GK;class hee{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new x9,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,a=-1;"undefined"!=typeof navigator&&void 0!==navigator.userAgent&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,a=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||n||r&&a<98?this.textureLoader=new Y1(this.options.manager):this.textureLoader=new N2(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new H1(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(t){const i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};return iee(a,i,r),see(i,r),Promise.all(n._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){for(const e of i.scenes)e.updateMatrixWorld();e(i)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,a=t.length;r<a;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let r=0,a=e.length;r<a;r++){const t=e[r];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),a=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[r,i]of e.children.entries())a(i,t.children[r])};return a(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const a=e(t[r]);a&&n.push(a)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":r=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map(function(t,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[y9.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(e,a){n.load(g2.resolveURL(t.uri,r.path),e,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const e=J9[r.type],t=X9[r.componentType],n=!0===r.normalized,a=new t(r.count*e);return Promise.resolve(new Xq(a,e,n))}const a=[];return void 0!==r.bufferView?a.push(this.getDependency("bufferView",r.bufferView)):a.push(null),void 0!==r.sparse&&(a.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(a).then(function(e){const a=e[0],i=J9[r.type],s=X9[r.componentType],o=s.BYTES_PER_ELEMENT,l=o*i,c=r.byteOffset||0,d=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,u=!0===r.normalized;let h,p;if(d&&d!==l){const e=Math.floor(c/d),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let l=t.cache.get(n);l||(h=new s(a,e*d,r.count*d/o),l=new UJ(h,d/o),t.cache.add(n,l)),p=new HJ(l,i,c%d/o,u)}else h=null===a?new s(r.count*i):new s(a,c,r.count*i),p=new Xq(h,i,u);if(void 0!==r.sparse){const t=J9.SCALAR,n=X9[r.sparse.indices.componentType],o=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,c=new n(e[1],o,r.sparse.count*t),d=new s(e[2],l,r.sparse.count*i);null!==a&&(p=new Xq(p.array.slice(),p.itemSize,p.normalized));for(let e=0,r=c.length;e<r;e++){const t=c[e];if(p.setX(t,d[e*i]),i>=2&&p.setY(t,d[e*i+1]),i>=3&&p.setZ(t,d[e*i+2]),i>=4&&p.setW(t,d[e*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,a=t.images[r];let i=this.textureLoader;if(a.uri){const e=n.manager.getHandler(a.uri);null!==e&&(i=e)}return this.loadTextureImage(e,r,i)}loadTextureImage(e,t,n){const r=this,a=this.json,i=a.textures[e],s=a.images[t],o=(s.uri||s.bufferView)+":"+i.sampler;if(this.textureCache[o])return this.textureCache[o];const l=this.loadImageSource(t,n).then(function(t){t.flipY=!1,t.name=i.name||s.name||"",""===t.name&&"string"==typeof s.uri&&!1===s.uri.startsWith("data:image/")&&(t.name=s.uri);const n=(a.samplers||{})[i.sampler]||{};return t.magFilter=K9[n.magFilter]||VW,t.minFilter=K9[n.minFilter]||WW,t.wrapS=q9[n.wrapS]||LW,t.wrapT=q9[n.wrapT]||LW,r.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[o]=l,l}loadImageSource(e,t){const n=this,r=this.json,a=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());const i=r.images[e],s=self.URL||self.webkitURL;let o=i.uri||"",l=!1;if(void 0!==i.bufferView)o=n.getDependency("bufferView",i.bufferView).then(function(e){l=!0;const t=new Blob([e],{type:i.mimeType});return o=s.createObjectURL(t),o});else if(void 0===i.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(o).then(function(e){return new Promise(function(n,r){let i=n;!0===t.isImageBitmapLoader&&(i=function(e){const t=new dK(e);t.needsUpdate=!0,n(t)}),t.load(g2.resolveURL(e,a.path),i,void 0,r)})}).then(function(e){var t;return!0===l&&s.revokeObjectURL(o),see(e,i),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=c,c}assignTexture(e,t,n,r){const a=this;return this.getDependency("texture",n.index).then(function(i){if(!i)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((i=i.clone()).channel=n.texCoord),a.extensions[y9.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[y9.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=a.associations.get(i);i=a.extensions[y9.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),a.associations.set(i,t)}}return void 0!==r&&("number"==typeof r&&(r=3001===r?m9:g9),"colorSpace"in i?i.colorSpace=r:i.encoding=r===m9?3001:3e3),e[t]=i,i})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,a=void 0!==t.attributes.color,i=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new NZ,Lq.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new lZ,Lq.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(r||a||i){let e="ClonedMaterial:"+n.uuid+":";r&&(e+="derivative-tangents:"),a&&(e+="vertex-colors:"),i&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),a&&(t.vertexColors=!0),i&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return o1}loadMaterial(e){const t=this,n=this.json,r=this.extensions,a=n.materials[e];let i;const s={},o=[];if((a.extensions||{})[y9.KHR_MATERIALS_UNLIT]){const e=r[y9.KHR_MATERIALS_UNLIT];i=e.getMaterialType(),o.push(e.extendParams(s,a,t))}else{const n=a.pbrMetallicRoughness||{};if(s.color=new Iq(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;s.color.setRGB(e[0],e[1],e[2],g9),s.opacity=e[3]}void 0!==n.baseColorTexture&&o.push(t.assignTexture(s,"map",n.baseColorTexture,m9)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(o.push(t.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),o.push(t.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture))),i=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),o.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)})))}!0===a.doubleSided&&(s.side=2);const l=a.alphaMode||tee;if(l===ree?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,l===nee&&(s.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&i!==Fq&&(o.push(t.assignTexture(s,"normalMap",a.normalTexture)),s.normalScale=new VX(1,1),void 0!==a.normalTexture.scale)){const e=a.normalTexture.scale;s.normalScale.set(e,e)}if(void 0!==a.occlusionTexture&&i!==Fq&&(o.push(t.assignTexture(s,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(s.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&i!==Fq){const e=a.emissiveFactor;s.emissive=(new Iq).setRGB(e[0],e[1],e[2],g9)}return void 0!==a.emissiveTexture&&i!==Fq&&o.push(t.assignTexture(s,"emissiveMap",a.emissiveTexture,m9)),Promise.all(o).then(function(){const n=new i(s);return a.name&&(n.name=a.name),see(n,a),t.associations.set(n,{materials:e}),a.extensions&&iee(r,n,a),n})}createUniqueName(e){const t=Y2.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function a(e){return n[y9.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(n){return pee(n,e,t)})}const i=[];for(let s=0,o=e.length;s<o;s++){const n=e[s],o=lee(n),l=r[o];if(l)i.push(l.promise);else{let e;e=n.extensions&&n.extensions[y9.KHR_DRACO_MESH_COMPRESSION]?a(n):pee(new iJ,n,t),r[o]={primitive:n,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){const t=this,n=this.json,r=this.extensions,a=n.meshes[e],i=a.primitives,s=[];for(let o=0,l=i.length;o<l;o++){const e=void 0===i[o].material?aee(this.cache):this.getDependency("material",i[o].material);s.push(e)}return s.push(t.loadGeometries(i)),Promise.all(s).then(function(n){const s=n.slice(0,n.length-1),o=n[n.length-1],l=[];for(let d=0,u=o.length;d<u;d++){const n=o[d],c=i[d];let u;const h=s[d];if(c.mode===Y9.TRIANGLES||c.mode===Y9.TRIANGLE_STRIP||c.mode===Y9.TRIANGLE_FAN||void 0===c.mode)u=!0===a.isSkinnedMesh?new xQ(n,h):new xJ(n,h),!0===u.isSkinnedMesh&&u.normalizeSkinWeights(),c.mode===Y9.TRIANGLE_STRIP?u.geometry=M7(u.geometry,1):c.mode===Y9.TRIANGLE_FAN&&(u.geometry=M7(u.geometry,2));else if(c.mode===Y9.LINES)u=new bZ(n,h);else if(c.mode===Y9.LINE_STRIP)u=new fZ(n,h);else if(c.mode===Y9.LINE_LOOP)u=new wZ(n,h);else{if(c.mode!==Y9.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);u=new CZ(n,h)}Object.keys(u.geometry.morphAttributes).length>0&&oee(u,a),u.name=t.createUniqueName(a.name||"mesh_"+e),see(u,a),c.extensions&&iee(r,u,c),t.assignFinalMaterial(u),l.push(u)}for(let r=0,a=l.length;r<a;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return a.extensions&&iee(r,l[0],a),l[0];const c=new RJ;a.extensions&&iee(r,c,a),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new kJ(GX.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new o2(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),see(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,a=t.joints.length;r<a;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(e){const n=e.pop(),r=e,a=[],i=[];for(let s=0,o=r.length;s<o;s++){const e=r[s];if(e){a.push(e);const t=new GK;null!==n&&t.fromArray(n.array,16*s),i.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[s])}return new NQ(a,i)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],a=r.name?r.name:"animation_"+e,i=[],s=[],o=[],l=[],c=[];for(let d=0,u=r.channels.length;d<u;d++){const e=r.channels[d],t=r.samplers[e.sampler],n=e.target,a=n.node,u=void 0!==r.parameters?r.parameters[t.input]:t.input,h=void 0!==r.parameters?r.parameters[t.output]:t.output;void 0!==n.node&&(i.push(this.getDependency("node",a)),s.push(this.getDependency("accessor",u)),o.push(this.getDependency("accessor",h)),l.push(t),c.push(n))}return Promise.all([Promise.all(i),Promise.all(s),Promise.all(o),Promise.all(l),Promise.all(c)]).then(function(e){const t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],l=[];for(let a=0,c=t.length;a<c;a++){const e=t[a],c=r[a],d=i[a],u=s[a],h=o[a];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const p=n._createAnimationTracks(e,c,d,u,h);if(p)for(let t=0;t<p.length;t++)l.push(p[t])}return new R1(a,void 0,l)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]}),t})}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),a=[],i=n.children||[];for(let o=0,l=i.length;o<l;o++)a.push(t.getDependency("node",i[o]));const s=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(a),s]).then(function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(r,uee)});for(let a=0,i=n.length;a<i;a++)t.add(n[a]);return t})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const a=t.nodes[e],i=a.name?r.createUniqueName(a.name):"",s=[],o=r._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return o&&s.push(o),void 0!==a.camera&&s.push(r.getDependency("camera",a.camera).then(function(e){return r._getNodeRef(r.cameraCache,a.camera,e)})),r._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){s.push(e)}),this.nodeCache[e]=Promise.all(s).then(function(t){let s;if(s=!0===a.isBone?new yQ:t.length>1?new RJ:1===t.length?t[0]:new fq,s!==t[0])for(let e=0,n=t.length;e<n;e++)s.add(t[e]);if(a.name&&(s.userData.name=a.name,s.name=i),see(s,a),a.extensions&&iee(n,s,a),void 0!==a.matrix){const e=new GK;e.fromArray(a.matrix),s.applyMatrix4(e)}else void 0!==a.translation&&s.position.fromArray(a.translation),void 0!==a.rotation&&s.quaternion.fromArray(a.rotation),void 0!==a.scale&&s.scale.fromArray(a.scale);return r.associations.has(s)||r.associations.set(s,{}),r.associations.get(s).nodes=e,s}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,a=new RJ;n.name&&(a.name=r.createUniqueName(n.name)),see(a,n),n.extensions&&iee(t,a,n);const i=n.nodes||[],s=[];for(let o=0,l=i.length;o<l;o++)s.push(r.getDependency("node",i[o]));return Promise.all(s).then(function(e){for(let t=0,n=e.length;t<n;t++)a.add(e[t]);return r.associations=(e=>{const t=new Map;for(const[n,a]of r.associations)(n instanceof Lq||n instanceof dK)&&t.set(n,a);return e.traverse(e=>{const n=r.associations.get(e);null!=n&&t.set(e,n)}),t})(a),a})}_createAnimationTracks(e,t,n,r,a){const i=[],s=e.name?e.name:e.uuid,o=[];let l;switch(Z9[a.path]===Z9.weights?e.traverse(function(e){e.morphTargetInfluences&&o.push(e.name?e.name:e.uuid)}):o.push(s),Z9[a.path]){case Z9.weights:l=k1;break;case Z9.rotation:l=T1;break;case Z9.position:case Z9.scale:l=D1;break;default:if(1===n.itemSize)l=k1;else l=D1}const c=void 0!==r.interpolation?eee[r.interpolation]:qY,d=this._getArrayFromAccessor(n);for(let u=0,h=o.length;u<h;u++){const e=new l(o[u]+"."+Z9[a.path],t.array,d,c);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(e),i.push(e)}return i}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=dee(t.constructor),n=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r++)n[r]=t[r]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof T1?W9:V9)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function pee(e,t,n){const r=t.attributes,a=[];function i(t,r){return n.getDependency("accessor",t).then(function(t){e.setAttribute(r,t)})}for(const s in r){const t=Q9[s]||s.toLowerCase();t in e.attributes||a.push(i(r[s],t))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});a.push(r)}return see(e,t),function(e,t,n){const r=t.attributes,a=new fK;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,i=e.max;if(void 0===t||void 0===i)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(a.set(new WX(t[0],t[1],t[2]),new WX(i[0],i[1],i[2])),e.normalized){const t=dee(X9[e.componentType]);a.min.multiplyScalar(t),a.max.multiplyScalar(t)}}const i=t.targets;if(void 0!==i){const e=new WX,t=new WX;for(let r=0,a=i.length;r<a;r++){const a=i[r];if(void 0!==a.POSITION){const r=n.json.accessors[a.POSITION],i=r.min,s=r.max;if(void 0!==i&&void 0!==s){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(s[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(s[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(s[2]))),r.normalized){const e=dee(X9[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(e)}e.boundingBox=a;const s=new RK;a.getCenter(s.center),s.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=s}(e,t,n),Promise.all(a).then(function(){return void 0!==t.targets?function(e,t,n){let r=!1,a=!1,i=!1;for(let c=0,d=t.length;c<d;c++){const e=t[c];if(void 0!==e.POSITION&&(r=!0),void 0!==e.NORMAL&&(a=!0),void 0!==e.COLOR_0&&(i=!0),r&&a&&i)break}if(!r&&!a&&!i)return Promise.resolve(e);const s=[],o=[],l=[];for(let c=0,d=t.length;c<d;c++){const d=t[c];if(r){const t=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;s.push(t)}if(a){const t=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal;o.push(t)}if(i){const t=void 0!==d.COLOR_0?n.getDependency("accessor",d.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(l)]).then(function(t){const n=t[0],s=t[1],o=t[2];return r&&(e.morphAttributes.position=n),a&&(e.morphAttributes.normal=s),i&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,n):e})}class mee extends W1{constructor(e){super(e),this.type=tY}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,n){t=t||1024;let r=e.pos,a=-1,i=0,s="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(a=o.indexOf("\n"))&&i<t&&r<e.byteLength;)s+=o,i+=o.length,r+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<a&&(e.pos+=i+a+1,s+o.slice(0,a))},r=function(e,t,n,r){const a=e[t+3],i=Math.pow(2,a-128)/255;n[r+0]=e[t+0]*i,n[r+1]=e[t+1]*i,n[r+2]=e[t+2]*i,n[r+3]=1},a=function(e,t,n,r){const a=e[t+3],i=Math.pow(2,a-128)/255;n[r+0]=Vq.toHalfFloat(Math.min(e[t+0]*i,65504)),n[r+1]=Vq.toHalfFloat(Math.min(e[t+1]*i,65504)),n[r+2]=Vq.toHalfFloat(Math.min(e[t+2]*i,65504)),n[r+3]=Vq.toHalfFloat(1)},i=new Uint8Array(e);i.pos=0;const s=function(e){const r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,o={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((e.pos>=e.byteLength||!(l=n(e)))&&t(1,"no header found"),(c=l.match(/^#\?(\S+)/))||t(3,"bad initial token"),o.valid|=1,o.programtype=c[1],o.string+=l+"\n";l=n(e),!1!==l;)if(o.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(r))&&(o.gamma=parseFloat(c[1])),(c=l.match(a))&&(o.exposure=parseFloat(c[1])),(c=l.match(i))&&(o.valid|=2,o.format=c[1]),(c=l.match(s))&&(o.valid|=4,o.height=parseInt(c[1],10),o.width=parseInt(c[2],10)),2&o.valid&&4&o.valid)break}else o.comments+=l+"\n";return 2&o.valid||t(3,"missing format specifier"),4&o.valid||t(3,"missing image size specifier"),o}(i),o=s.width,l=s.height,c=function(e,n,r){const a=n;if(a<8||a>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);a!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const i=new Uint8Array(4*n*r);i.length||t(4,"unable to allocate buffer space");let s=0,o=0;const l=4*a,c=new Uint8Array(4),d=new Uint8Array(l);let u=r;for(;u>0&&o<e.byteLength;){o+4>e.byteLength&&t(1),c[0]=e[o++],c[1]=e[o++],c[2]=e[o++],c[3]=e[o++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==a||t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&o<e.byteLength;){n=e[o++];const a=n>128;if(a&&(n-=128),(0===n||r+n>l)&&t(3,"bad scanline data"),a){const t=e[o++];for(let e=0;e<n;e++)d[r++]=t}else d.set(e.subarray(o,o+n),r),r+=n,o+=n}const h=a;for(let e=0;e<h;e++){let t=0;i[s]=d[e+t],t+=a,i[s+1]=d[e+t],t+=a,i[s+2]=d[e+t],t+=a,i[s+3]=d[e+t],s+=4}u--}return i}(i.subarray(i.pos),o,l);let d,u,h;switch(this.type){case eY:h=c.length/4;const e=new Float32Array(4*h);for(let n=0;n<h;n++)r(c,4*n,e,4*n);d=e,u=eY;break;case tY:h=c.length/4;const t=new Uint16Array(4*h);for(let n=0;n<h;n++)a(c,4*n,t,4*n);d=t,u=tY;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:o,height:l,data:d,header:s.string,gamma:s.gamma,exposure:s.exposure,type:u}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){switch(e.type){case eY:case tY:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=VW,e.magFilter=VW,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)},n,r)}}const gee=C7>=152;class fee extends W1{constructor(e){super(e),this.type=tY}parse(e){const t=65536,n=14,r=65537,a=16384,i=Math.pow(2.7182818,2.2);const s={l:0,c:0,lc:0};function o(e,t,n,r,a){for(;n<e;)t=t<<8|z(r,a),n+=8;n-=e,s.l=t>>n&(1<<e)-1,s.c=t,s.lc=n}const l=new Array(59);function c(e,t,n,a,i,c,d){for(var u=n,h=0,p=0;i<=c;i++){if(u.value-n.value>a)return!1;o(6,h,p,e,u);var m=s.l;if(h=s.c,p=s.lc,d[i]=m,63==m){if(u.value-n.value>a)throw"Something wrong with hufUnpackEncTable";o(8,h,p,e,u);var g=s.l+6;if(h=s.c,p=s.lc,i+g>c+1)throw"Something wrong with hufUnpackEncTable";for(;g--;)d[i++]=0;i--}else if(m>=59){if(i+(g=m-59+2)>c+1)throw"Something wrong with hufUnpackEncTable";for(;g--;)d[i++]=0;i--}}!function(e){for(var t=0;t<=58;++t)l[t]=0;for(t=0;t<r;++t)l[e[t]]+=1;var n=0;for(t=58;t>0;--t){var a=n+l[t]>>1;l[t]=n,n=a}for(t=0;t<r;++t){var i=e[t];i>0&&(e[t]=i|l[i]++<<6)}}(d)}function d(e){return 63&e}function u(e){return e>>6}const h={c:0,lc:0};function p(e,t,n,r){e=e<<8|z(n,r),t+=8,h.c=e,h.lc=t}const m={c:0,lc:0};function g(e,t,n,r,a,i,s,o,l,c){if(e==t){r<8&&(p(n,r,a,s),n=h.c,r=h.lc);var d=n>>(r-=8);d=new Uint8Array([d])[0];if(l.value+d>c)return!1;for(var u=o[l.value-1];d-- >0;)o[l.value++]=u}else{if(!(l.value<c))return!1;o[l.value++]=e}m.c=n,m.lc=r}function f(e){return 65535&e}function x(e){var t=f(e);return t>32767?t-65536:t}const y={a:0,b:0};function v(e,t){var n=x(e),r=x(t),a=n+(1&r)+(r>>1),i=a,s=a-r;y.a=i,y.b=s}function b(e,t){var n=f(e),r=f(t),a=n-(r>>1)&65535,i=r+a-32768&65535;y.a=i,y.b=a}function w(e,t,n,r,a,i,s){for(var o,l=s<16384,c=n>a?a:n,d=1;d<=c;)d<<=1;for(o=d>>=1,d>>=1;d>=1;){for(var u,h,p,m,g=0,f=g+i*(a-o),x=i*d,w=i*o,N=r*d,S=r*o;g<=f;g+=w){for(var j=g,_=g+r*(n-o);j<=_;j+=S){var A=j+N,C=(M=j+x)+N;l?(v(e[j+t],e[M+t]),u=y.a,p=y.b,v(e[A+t],e[C+t]),h=y.a,m=y.b,v(u,h),e[j+t]=y.a,e[A+t]=y.b,v(p,m),e[M+t]=y.a,e[C+t]=y.b):(b(e[j+t],e[M+t]),u=y.a,p=y.b,b(e[A+t],e[C+t]),h=y.a,m=y.b,b(u,h),e[j+t]=y.a,e[A+t]=y.b,b(p,m),e[M+t]=y.a,e[C+t]=y.b)}if(n&d){var M=j+x;l?v(e[j+t],e[M+t]):b(e[j+t],e[M+t]),u=y.a,e[M+t]=y.b,e[j+t]=u}}if(a&d)for(j=g,_=g+r*(n-o);j<=_;j+=S){A=j+N;l?v(e[j+t],e[A+t]):b(e[j+t],e[A+t]),u=y.a,e[A+t]=y.b,e[j+t]=u}o=d,d>>=1}return g}function N(e,t,i,s,o,l){var f=i.value,x=U(t,i),y=U(t,i);i.value+=4;var v=U(t,i);if(i.value+=4,x<0||x>=r||y<0||y>=r)throw"Something wrong with HUF_ENCSIZE";var b=new Array(r),w=new Array(a);if(function(e){for(var t=0;t<a;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(w),c(e,0,i,s-(i.value-f),x,y,b),v>8*(s-(i.value-f)))throw"Something wrong with hufUncompress";!function(e,t,r,a){for(;t<=r;t++){var i=u(e[t]),s=d(e[t]);if(i>>s)throw"Invalid table entry";if(s>n){if((h=a[i>>s-n]).len)throw"Invalid table entry";if(h.lit++,h.p){var o=h.p;h.p=new Array(h.lit);for(var l=0;l<h.lit-1;++l)h.p[l]=o[l]}else h.p=new Array(1);h.p[h.lit-1]=t}else if(s){var c=0;for(l=1<<n-s;l>0;l--){var h;if((h=a[(i<<n-s)+c]).len||h.p)throw"Invalid table entry";h.len=s,h.lit=t,c++}}}}(b,x,y,w),function(e,t,r,a,i,s,o,l,c,f){for(var x=0,y=0,v=l,b=Math.trunc(i.value+(s+7)/8);i.value<b;)for(p(x,y,r,i),x=h.c,y=h.lc;y>=n;)if((j=t[x>>y-n&16383]).len)y-=j.len,g(j.lit,o,x,y,r,0,i,c,f,v),x=m.c,y=m.lc;else{if(!j.p)throw"hufDecode issues";var w;for(w=0;w<j.lit;w++){for(var N=d(e[j.p[w]]);y<N&&i.value<b;)p(x,y,r,i),x=h.c,y=h.lc;if(y>=N&&u(e[j.p[w]])==(x>>y-N&(1<<N)-1)){y-=N,g(j.p[w],o,x,y,r,0,i,c,f,v),x=m.c,y=m.lc;break}}if(w==j.lit)throw"hufDecode issues"}var S=8-s&7;for(x>>=S,y-=S;y>0;){var j;if(!(j=t[x<<n-y&16383]).len)throw"hufDecode issues";y-=j.len,g(j.lit,o,x,y,r,0,i,c,f,v),x=m.c,y=m.lc}}(b,w,e,0,i,v,y,l,o,{value:0})}function S(e){for(var t=1;t<e.length;t++){var n=e[t-1]+e[t]-128;e[t]=n}}function j(e,t){for(var n=0,r=Math.floor((e.length+1)/2),a=0,i=e.length-1;!(a>i||(t[a++]=e[n++],a>i));)t[a++]=e[r++]}function _(e){for(var t=e.byteLength,n=new Array,r=0,a=new DataView(e);t>0;){var i=a.getInt8(r++);if(i<0){t-=(o=-i)+1;for(var s=0;s<o;s++)n.push(a.getUint8(r++))}else{var o=i;t-=2;var l=a.getUint8(r++);for(s=0;s<o+1;s++)n.push(l)}}return n}function A(e,t,n){for(var r,a=1;a<64;)65280==(r=t[e.value])?a=64:r>>8==255?a+=255&r:(n[a]=r,a++),e.value++}function C(e,t){t[0]=W(e[0]),t[1]=W(e[1]),t[2]=W(e[5]),t[3]=W(e[6]),t[4]=W(e[14]),t[5]=W(e[15]),t[6]=W(e[27]),t[7]=W(e[28]),t[8]=W(e[2]),t[9]=W(e[4]),t[10]=W(e[7]),t[11]=W(e[13]),t[12]=W(e[16]),t[13]=W(e[26]),t[14]=W(e[29]),t[15]=W(e[42]),t[16]=W(e[3]),t[17]=W(e[8]),t[18]=W(e[12]),t[19]=W(e[17]),t[20]=W(e[25]),t[21]=W(e[30]),t[22]=W(e[41]),t[23]=W(e[43]),t[24]=W(e[9]),t[25]=W(e[11]),t[26]=W(e[18]),t[27]=W(e[24]),t[28]=W(e[31]),t[29]=W(e[40]),t[30]=W(e[44]),t[31]=W(e[53]),t[32]=W(e[10]),t[33]=W(e[19]),t[34]=W(e[23]),t[35]=W(e[32]),t[36]=W(e[39]),t[37]=W(e[45]),t[38]=W(e[52]),t[39]=W(e[54]),t[40]=W(e[20]),t[41]=W(e[22]),t[42]=W(e[33]),t[43]=W(e[38]),t[44]=W(e[46]),t[45]=W(e[51]),t[46]=W(e[55]),t[47]=W(e[60]),t[48]=W(e[21]),t[49]=W(e[34]),t[50]=W(e[37]),t[51]=W(e[47]),t[52]=W(e[50]),t[53]=W(e[56]),t[54]=W(e[59]),t[55]=W(e[61]),t[56]=W(e[35]),t[57]=W(e[36]),t[58]=W(e[48]),t[59]=W(e[49]),t[60]=W(e[57]),t[61]=W(e[58]),t[62]=W(e[62]),t[63]=W(e[63])}function M(e){const t=.5*Math.cos(.7853975),n=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),a=.5*Math.cos(3*3.14159/16),i=.5*Math.cos(.981746875),s=.5*Math.cos(3*3.14159/8),o=.5*Math.cos(1.374445625);for(var l=new Array(4),c=new Array(4),d=new Array(4),u=new Array(4),h=0;h<8;++h){var p=8*h;l[0]=r*e[p+2],l[1]=s*e[p+2],l[2]=r*e[p+6],l[3]=s*e[p+6],c[0]=n*e[p+1]+a*e[p+3]+i*e[p+5]+o*e[p+7],c[1]=a*e[p+1]-o*e[p+3]-n*e[p+5]-i*e[p+7],c[2]=i*e[p+1]-n*e[p+3]+o*e[p+5]+a*e[p+7],c[3]=o*e[p+1]-i*e[p+3]+a*e[p+5]-n*e[p+7],d[0]=t*(e[p+0]+e[p+4]),d[3]=t*(e[p+0]-e[p+4]),d[1]=l[0]+l[3],d[2]=l[1]-l[2],u[0]=d[0]+d[1],u[1]=d[3]+d[2],u[2]=d[3]-d[2],u[3]=d[0]-d[1],e[p+0]=u[0]+c[0],e[p+1]=u[1]+c[1],e[p+2]=u[2]+c[2],e[p+3]=u[3]+c[3],e[p+4]=u[3]-c[3],e[p+5]=u[2]-c[2],e[p+6]=u[1]-c[1],e[p+7]=u[0]-c[0]}for(var m=0;m<8;++m)l[0]=r*e[16+m],l[1]=s*e[16+m],l[2]=r*e[48+m],l[3]=s*e[48+m],c[0]=n*e[8+m]+a*e[24+m]+i*e[40+m]+o*e[56+m],c[1]=a*e[8+m]-o*e[24+m]-n*e[40+m]-i*e[56+m],c[2]=i*e[8+m]-n*e[24+m]+o*e[40+m]+a*e[56+m],c[3]=o*e[8+m]-i*e[24+m]+a*e[40+m]-n*e[56+m],d[0]=t*(e[m]+e[32+m]),d[3]=t*(e[m]-e[32+m]),d[1]=l[0]+l[3],d[2]=l[1]-l[2],u[0]=d[0]+d[1],u[1]=d[3]+d[2],u[2]=d[3]-d[2],u[3]=d[0]-d[1],e[0+m]=u[0]+c[0],e[8+m]=u[1]+c[1],e[16+m]=u[2]+c[2],e[24+m]=u[3]+c[3],e[32+m]=u[3]-c[3],e[40+m]=u[2]-c[2],e[48+m]=u[1]-c[1],e[56+m]=u[0]-c[0]}function k(e){for(var t=0;t<64;++t){var n=e[0][t],r=e[1][t],a=e[2][t];e[0][t]=n+1.5747*a,e[1][t]=n-.1873*r-.4682*a,e[2][t]=n+1.8556*r}}function E(e,t,n){for(var r=0;r<64;++r)t[n+r]=Vq.toHalfFloat(T(e[r]))}function T(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(i,Math.abs(e)-1)}function P(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function D(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),n=new Uint8Array(_(t)),r=new Uint8Array(n.length);return S(n),j(n,r),new DataView(r.buffer)}function R(e){var t=e9(e.array.slice(e.offset.value,e.offset.value+e.size)),n=new Uint8Array(t.length);return S(t),j(t,n),new DataView(n.buffer)}function I(e){for(var n=e.viewer,r={value:e.offset.value},a=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),i=new Uint8Array(8192),s=0,o=new Array(e.channels),l=0;l<e.channels;l++)o[l]={},o[l].start=s,o[l].end=o[l].start,o[l].nx=e.width,o[l].ny=e.lines,o[l].size=e.type,s+=o[l].nx*o[l].ny*o[l].size;var c=Y(n,r),d=Y(n,r);if(d>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=d)for(l=0;l<d-c+1;l++)i[l+c]=H(n,r);var u=new Uint16Array(t),h=function(e,n){for(var r=0,a=0;a<t;++a)(0==a||e[a>>3]&1<<(7&a))&&(n[r++]=a);for(var i=r-1;r<t;)n[r++]=0;return i}(i,u),p=U(n,r);N(e.array,n,r,p,a,s);for(l=0;l<e.channels;++l)for(var m=o[l],g=0;g<o[l].size;++g)w(a,m.start+g,m.nx,m.size,m.ny,m.nx*m.size,h);!function(e,t,n){for(var r=0;r<n;++r)t[r]=e[t[r]]}(u,a,s);for(var f=0,x=new Uint8Array(a.buffer.byteLength),y=0;y<e.lines;y++)for(var v=0;v<e.channels;v++){var b=(m=o[v]).nx*m.size,S=new Uint8Array(a.buffer,2*m.end,2*b);x.set(S,f),f+=2*b,m.end+=b}return new DataView(x.buffer)}function O(e){var t=e9(e.array.slice(e.offset.value,e.offset.value+e.size));const n=e.lines*e.channels*e.width,r=1==e.type?new Uint16Array(n):new Uint32Array(n);let a=0,i=0;const s=new Array(4);for(let o=0;o<e.lines;o++)for(let n=0;n<e.channels;n++){let n=0;switch(e.type){case 1:s[0]=a,s[1]=s[0]+e.width,a=s[1]+e.width;for(let a=0;a<e.width;++a){n+=t[s[0]++]<<8|t[s[1]++],r[i]=n,i++}break;case 2:s[0]=a,s[1]=s[0]+e.width,s[2]=s[1]+e.width,a=s[2]+e.width;for(let a=0;a<e.width;++a){n+=t[s[0]++]<<24|t[s[1]++]<<16|t[s[2]++]<<8,r[i]=n,i++}}}return new DataView(r.buffer)}function B(e){var t=e.viewer,n={value:e.offset.value},r=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),a={version:G(t,n),unknownUncompressedSize:G(t,n),unknownCompressedSize:G(t,n),acCompressedSize:G(t,n),dcCompressedSize:G(t,n),rleCompressedSize:G(t,n),rleUncompressedSize:G(t,n),rleRawSize:G(t,n),totalAcUncompressedCount:G(t,n),totalDcUncompressedCount:G(t,n),acCompression:G(t,n)};if(a.version<2)throw"EXRLoader.parse: "+Z.compression+" version "+a.version+" is unsupported";for(var i=new Array,s=Y(t,n)-2;s>0;){var o=L(t.buffer,n),l=H(t,n),c=l>>2&3,d=new Int8Array([(l>>4)-1])[0],u=H(t,n);i.push({name:o,index:d,type:u,compression:c}),s-=o.length+3}for(var h=Z.channels,p=new Array(e.channels),m=0;m<e.channels;++m){var g=p[m]={},f=h[m];g.name=f.name,g.compression=0,g.decoded=!1,g.type=f.pixelType,g.pLinear=f.pLinear,g.width=e.width,g.height=e.lines}for(var x={idx:new Array(3)},y=0;y<e.channels;++y)for(g=p[y],m=0;m<i.length;++m){var v=i[m];g.name==v.name&&(g.compression=v.compression,v.index>=0&&(x.idx[v.index]=y),g.offset=y)}if(a.acCompressedSize>0)switch(a.acCompression){case 0:var b=new Uint16Array(a.totalAcUncompressedCount);N(e.array,t,n,a.acCompressedSize,b,a.totalAcUncompressedCount);break;case 1:var w=e9(e.array.slice(n.value,n.value+a.totalAcUncompressedCount));b=new Uint16Array(w.buffer);n.value+=a.totalAcUncompressedCount}if(a.dcCompressedSize>0){var S={array:e.array,offset:n,size:a.dcCompressedSize},j=new Uint16Array(R(S).buffer);n.value+=a.dcCompressedSize}if(a.rleRawSize>0){var T=_((w=e9(e.array.slice(n.value,n.value+a.rleCompressedSize))).buffer);n.value+=a.rleCompressedSize}var P=0,D=new Array(p.length);for(m=0;m<D.length;++m)D[m]=new Array;for(var I=0;I<e.lines;++I)for(var O=0;O<p.length;++O)D[O].push(P),P+=p[O].width*e.type*2;!function(e,t,n,r,a,i){var s=new DataView(i.buffer),o=n[e.idx[0]].width,l=n[e.idx[0]].height,c=Math.floor(o/8),d=Math.ceil(o/8),u=Math.ceil(l/8),h=o-8*(d-1),p=l-8*(u-1),m={value:0},g=new Array(3),f=new Array(3),x=new Array(3),y=new Array(3),v=new Array(3);for(let A=0;A<3;++A)v[A]=t[e.idx[A]],g[A]=A<1?0:g[A-1]+d*u,f[A]=new Float32Array(64),x[A]=new Uint16Array(64),y[A]=new Uint16Array(64*d);for(let P=0;P<u;++P){var b=8;P==u-1&&(b=p);var w=8;for(let e=0;e<d;++e){e==d-1&&(w=h);for(let e=0;e<3;++e)x[e].fill(0),x[e][0]=a[g[e]++],A(m,r,x[e]),C(x[e],f[e]),M(f[e]);k(f);for(let t=0;t<3;++t)E(f[t],y[t],64*e)}let t=0;for(let r=0;r<3;++r){const a=n[e.idx[r]].type;for(let e=8*P;e<8*P+b;++e){t=v[r][e];for(let n=0;n<c;++n){const i=64*n+8*(7&e);s.setUint16(t+0*a,y[r][i+0],!0),s.setUint16(t+2*a,y[r][i+1],!0),s.setUint16(t+4*a,y[r][i+2],!0),s.setUint16(t+6*a,y[r][i+3],!0),s.setUint16(t+8*a,y[r][i+4],!0),s.setUint16(t+10*a,y[r][i+5],!0),s.setUint16(t+12*a,y[r][i+6],!0),s.setUint16(t+14*a,y[r][i+7],!0),t+=16*a}}if(c!=d)for(let e=8*P;e<8*P+b;++e){const t=v[r][e]+8*c*2*a,n=64*c+8*(7&e);for(let e=0;e<w;++e)s.setUint16(t+2*e*a,y[r][n+e],!0)}}}for(var N=new Uint16Array(o),S=(s=new DataView(i.buffer),0);S<3;++S){n[e.idx[S]].decoded=!0;var j=n[e.idx[S]].type;if(2==n[S].type)for(var _=0;_<l;++_){const e=v[S][_];for(var T=0;T<o;++T)N[T]=s.getUint16(e+2*T*j,!0);for(T=0;T<o;++T)s.setFloat32(e+2*T*j,W(N[T]),!0)}}}(x,D,p,b,j,r);for(m=0;m<p.length;++m){if(!(g=p[m]).decoded){if(2!==g.compression)throw"EXRLoader.parse: unsupported channel compression";var B=0,F=0;for(I=0;I<e.lines;++I){for(var U=D[m][B],z=0;z<g.width;++z){for(var V=0;V<2*g.type;++V)r[U++]=T[F+V*g.width*g.height];F++}B++}}}return new DataView(r.buffer)}function L(e,t){for(var n=new Uint8Array(e),r=0;0!=n[t.value+r];)r+=1;var a=(new TextDecoder).decode(n.slice(t.value,t.value+r));return t.value=t.value+r+1,a}function F(e,t){var n=e.getInt32(t.value,!0);return t.value=t.value+4,n}function U(e,t){var n=e.getUint32(t.value,!0);return t.value=t.value+4,n}function z(e,t){var n=e[t.value];return t.value=t.value+1,n}function H(e,t){var n=e.getUint8(t.value);return t.value=t.value+1,n}const G=function(e,t){let n;return n="getBigInt64"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,n};function V(e,t){var n=e.getFloat32(t.value,!0);return t.value+=4,n}function $(e,t){return Vq.toHalfFloat(V(e,t))}function W(e){var t=(31744&e)>>10,n=1023&e;return(e>>15?-1:1)*(t?31===t?n?NaN:1/0:Math.pow(2,t-15)*(1+n/1024):n/1024*6103515625e-14)}function Y(e,t){var n=e.getUint16(t.value,!0);return t.value+=2,n}function X(e,t){return W(Y(e,t))}function K(e,t,n,r,a){return"string"===r||"stringvector"===r||"iccProfile"===r?function(e,t,n){var r=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+n));return t.value=t.value+n,r}(t,n,a):"chlist"===r?function(e,t,n,r){for(var a=n.value,i=[];n.value<a+r-1;){var s=L(t,n),o=F(e,n),l=H(e,n);n.value+=3;var c=F(e,n),d=F(e,n);i.push({name:s,pixelType:o,pLinear:l,xSampling:c,ySampling:d})}return n.value+=1,i}(e,t,n,a):"chromaticities"===r?function(e,t){return{redX:V(e,t),redY:V(e,t),greenX:V(e,t),greenY:V(e,t),blueX:V(e,t),blueY:V(e,t),whiteX:V(e,t),whiteY:V(e,t)}}(e,n):"compression"===r?function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][H(e,t)]}(e,n):"box2i"===r?function(e,t){return{xMin:U(e,t),yMin:U(e,t),xMax:U(e,t),yMax:U(e,t)}}(e,n):"lineOrder"===r?function(e,t){return["INCREASING_Y"][H(e,t)]}(e,n):"float"===r?V(e,n):"v2f"===r?function(e,t){return[V(e,t),V(e,t)]}(e,n):"v3f"===r?function(e,t){return[V(e,t),V(e,t),V(e,t)]}(e,n):"int"===r?F(e,n):"rational"===r?function(e,t){return[F(e,t),U(e,t)]}(e,n):"timecode"===r?function(e,t){return[U(e,t),U(e,t)]}(e,n):"preview"===r?(n.value+=a,"skipped"):void(n.value+=a)}const q=new DataView(e),J=new Uint8Array(e),Q={value:0},Z=function(e,t,n){const r={};if(20000630!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";r.version=e.getUint8(4);const a=e.getUint8(5);r.spec={singleTile:!!(2&a),longName:!!(4&a),deepFormat:!!(8&a),multiPart:!!(16&a)},n.value=8;for(var i=!0;i;){var s=L(t,n);if(0==s)i=!1;else{var o=L(t,n),l=K(e,t,n,o,U(e,n));void 0===l?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${o}'.`):r[s]=l}}if(-5&a)throw console.error("EXRHeader:",r),"THREE.EXRLoader: provided file is currently unsupported.";return r}(q,e,Q),ee=function(e,t,n,r,a){const i={size:0,viewer:t,array:n,offset:r,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[gee?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":i.lines=1,i.uncompress=P;break;case"RLE_COMPRESSION":i.lines=1,i.uncompress=D;break;case"ZIPS_COMPRESSION":i.lines=1,i.uncompress=R;break;case"ZIP_COMPRESSION":i.lines=16,i.uncompress=R;break;case"PIZ_COMPRESSION":i.lines=32,i.uncompress=I;break;case"PXR24_COMPRESSION":i.lines=16,i.uncompress=O;break;case"DWAA_COMPRESSION":i.lines=32,i.uncompress=B;break;case"DWAB_COMPRESSION":i.lines=256,i.uncompress=B;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(i.scanlineBlockSize=i.lines,1==i.type)switch(a){case eY:i.getter=X,i.inputSize=2;break;case tY:i.getter=Y,i.inputSize=2}else{if(2!=i.type)throw"EXRLoader.parse: unsupported pixelType "+i.type+" for "+e.compression+".";switch(a){case eY:i.getter=V,i.inputSize=4;break;case tY:i.getter=$,i.inputSize=4}}i.blockCount=(e.dataWindow.yMax+1)/i.scanlineBlockSize;for(var s=0;s<i.blockCount;s++)G(t,r);i.outputChannels=3==i.channels?4:i.channels;const o=i.width*i.height*i.outputChannels;switch(a){case eY:i.byteArray=new Float32Array(o),i.channels<i.outputChannels&&i.byteArray.fill(1,0,o);break;case tY:i.byteArray=new Uint16Array(o),i.channels<i.outputChannels&&i.byteArray.fill(15360,0,o);break;default:console.error("THREE.EXRLoader: unsupported type: ",a)}return i.bytesPerLine=i.width*i.inputSize*i.channels,4==i.outputChannels?i.format=cY:i.format=hY,gee?i.colorSpace="srgb-linear":i.encoding=3e3,i}(Z,q,J,Q,this.type),te={value:0},ne={R:0,G:1,B:2,A:3,Y:0};for(let re=0;re<ee.height/ee.scanlineBlockSize;re++){const e=U(q,Q);ee.size=U(q,Q),ee.lines=e+ee.scanlineBlockSize>ee.height?ee.height-e:ee.scanlineBlockSize;const t=ee.size<ee.lines*ee.bytesPerLine?ee.uncompress(ee):P(ee);Q.value+=ee.size;for(let n=0;n<ee.scanlineBlockSize;n++){const e=n+re*ee.scanlineBlockSize;if(e>=ee.height)break;for(let r=0;r<ee.channels;r++){const a=ne[Z.channels[r].name];for(let i=0;i<ee.width;i++){te.value=(n*(ee.channels*ee.width)+r*ee.width+i)*ee.inputSize;const s=(ee.height-1-e)*(ee.width*ee.outputChannels)+i*ee.outputChannels+a;ee.byteArray[s]=ee.getter(t,te)}}}}return{header:Z,width:ee.width,height:ee.height,data:ee.byteArray,format:ee.format,[gee?"colorSpace":"encoding"]:ee[gee?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){gee?e.colorSpace=n.colorSpace:e.encoding=n.encoding,e.minFilter=VW,e.magFilter=VW,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,n)},n,r)}}const xee=new WeakMap;class yee extends F1{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const a=new H1(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,a).then(t)}decodeGeometry(e,t){for(const o in t.attributeTypes){const e=t.attributeTypes[o];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[o]=e.name)}const n=JSON.stringify(t);if(xee.has(e)){const t=xee.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const a=this.workerNextTaskID++,i=e.byteLength,s=this._getWorker(a,i).then(n=>(r=n,new Promise((n,i)=>{r._callbacks[a]={resolve:n,reject:i},r.postMessage({type:"decode",id:a,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return s.catch(()=>!0).then(()=>{r&&a&&this._releaseTask(r,a)}),xee.set(e,{key:n,promise:s}),s}_createGeometry(e){const t=new iJ;e.index&&t.setIndex(new Xq(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],a=r.name,i=r.array,s=r.itemSize;t.setAttribute(a,new Xq(i,s))}return t}_loadLibrary(e,t){const n=new H1(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((t,r)=>{n.load(e,t,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=vee.toString(),a=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function vee(){let e,t;function n(e,t,n,r,a,i){const s=i.num_components(),o=n.num_points()*s,l=o*a.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,a),d=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,i,c,l,d);const u=new a(e.HEAPF32.buffer,d,o).slice();return e._free(d),{name:r,array:u,itemSize:s}}onmessage=function(r){const a=r.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":const r=a.buffer,i=a.taskConfig;t.then(e=>{const t=e.draco,s=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(r),r.byteLength);try{const e=function(e,t,r,a){const i=a.attributeIDs,s=a.attributeTypes;let o,l;const c=t.GetEncodedGeometryType(r);if(c===e.TRIANGULAR_MESH)o=new e.Mesh,l=t.DecodeBufferToMesh(r,o);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,l=t.DecodeBufferToPointCloud(r,o)}if(!l.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const d={index:null,attributes:[]};for(const u in i){const r=self[s[u]];let l,c;if(a.useUniqueIDs)c=i[u],l=t.GetAttributeByUniqueId(o,c);else{if(c=t.GetAttributeId(o,e[i[u]]),-1===c)continue;l=t.GetAttribute(o,c)}d.attributes.push(n(e,t,o,u,r,l))}c===e.TRIANGULAR_MESH&&(d.index=function(e,t,n){const r=n.num_faces(),a=3*r,i=4*a,s=e._malloc(i);t.GetTrianglesUInt32Array(n,i,s);const o=new Uint32Array(e.HEAPF32.buffer,s,a).slice();return e._free(s),{array:o,itemSize:1}}(e,t,o));return e.destroy(o),d}(t,s,o,i),r=e.attributes.map(e=>e.array.buffer);e.index&&r.push(e.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:e},r)}catch(l){console.error(l),self.postMessage({type:"error",id:a.id,error:l.message})}finally{t.destroy(o),t.destroy(s)}})}}}let bee;const wee=()=>{if(bee)return bee;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};let n,r="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(r="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB");const a=WebAssembly.instantiate(function(e){const n=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const r=e.charCodeAt(t);n[t]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}let r=0;for(let a=0;a<e.length;++a)n[r++]=n[a]<60?t[n[a]]:64*(n[a]-60)+n[++a];return n.buffer.slice(0,r)}(r),{}).then(e=>{n=e.instance,n.exports.__wasm_call_ctors()});function i(e,t,r,a,i,s){const o=n.exports.sbrk,l=r+3&-4,c=o(l*a),d=o(i.length),u=new Uint8Array(n.exports.memory.buffer);u.set(i,d);const h=e(c,r,a,d,i.length);if(0===h&&s&&s(c,l,a),t.set(u.subarray(c,c+r*a)),o(c-o(0)),0!==h)throw new Error(`Malformed buffer data: ${h}`)}const s={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},o={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return bee={ready:a,supported:!0,decodeVertexBuffer(e,t,r,a,o){i(n.exports.meshopt_decodeVertexBuffer,e,t,r,a,n.exports[s[o]])},decodeIndexBuffer(e,t,r,a){i(n.exports.meshopt_decodeIndexBuffer,e,t,r,a)},decodeIndexSequence(e,t,r,a){i(n.exports.meshopt_decodeIndexSequence,e,t,r,a)},decodeGltfBuffer(e,t,r,a,l,c){i(n.exports[o[l]],e,t,r,a,n.exports[s[c]])}},bee};function Nee(e,t,n,r){var a;return(a=class extends jJ{constructor(r){super(l({vertexShader:t,fragmentShader:n},r));for(const t in e)this.uniforms[t]=new q2(e[t]),Object.defineProperty(this,t,{get(){return this.uniforms[t].value},set(e){this.uniforms[t].value=e}});this.uniforms=SJ.clone(this.uniforms)}}).key=GX.generateUUID(),a}const See=(()=>parseInt(Q$.replace(/\D+/g,"")))();let jee=null,_ee="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Aee(e=!0,t=!0,n){return r=>{n&&n(r),e&&(jee||(jee=new yee),jee.setDecoderPath("string"==typeof e?e:_ee),r.setDRACOLoader(jee)),t&&r.setMeshoptDecoder(wee())}}const Cee=(e,t,n,r)=>k8(f9,e,Aee(t,n,r));Cee.preload=(e,t,n,r)=>k8.preload(f9,e,Aee(t,n,r)),Cee.clear=e=>k8.clear(f9,e),Cee.setDecoderPath=e=>{_ee=e};const Mee=f.forwardRef((e,t)=>{var n=e,{makeDefault:r,camera:a,regress:i,domElement:s,enableDamping:o=!0,keyEvents:l=!1,onChange:c,onStart:u,onEnd:h}=n,p=d(n,["makeDefault","camera","regress","domElement","enableDamping","keyEvents","onChange","onStart","onEnd"]);const m=_8(e=>e.invalidate),g=_8(e=>e.camera),x=_8(e=>e.gl),y=_8(e=>e.events),v=_8(e=>e.setEvents),b=_8(e=>e.set),w=_8(e=>e.get),N=_8(e=>e.performance),S=a||g,j=s||y.connected||x.domElement,_=f.useMemo(()=>new h9(S),[S]);return A8(()=>{_.enabled&&_.update()},-1),f.useEffect(()=>(l&&_.connect(!0===l?j:l),_.connect(j),()=>{_.dispose()}),[l,j,i,_,m]),f.useEffect(()=>{const e=e=>{m(),i&&N.regress(),c&&c(e)},t=e=>{u&&u(e)},n=e=>{h&&h(e)};return _.addEventListener("change",e),_.addEventListener("start",t),_.addEventListener("end",n),()=>{_.removeEventListener("start",t),_.removeEventListener("end",n),_.removeEventListener("change",e)}},[c,u,h,_,m,v]),f.useEffect(()=>{if(r){const e=w().controls;return b({controls:_}),()=>b({controls:e})}},[r,_]),f.createElement("primitive",A7({ref:t,object:_,enableDamping:o},p))}),kee=Nee({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Iq,sectionColor:new Iq,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new WX,worldPlanePosition:new WX},"\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform vec3 worldPlanePosition;\n    uniform float fadeDistance;\n    uniform bool infiniteGrid;\n    uniform bool followCamera;\n\n    void main() {\n      localPosition = position.xzy;\n      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;\n      \n      worldPosition = modelMatrix * vec4(localPosition, 1.0);\n      if (followCamera) {\n        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);\n        localPosition = (inverse(modelMatrix) * worldPosition).xyz;\n      }\n\n      gl_Position = projectionMatrix * viewMatrix * worldPosition;\n    }\n  ",`\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform float cellSize;\n    uniform float sectionSize;\n    uniform vec3 cellColor;\n    uniform vec3 sectionColor;\n    uniform float fadeDistance;\n    uniform float fadeStrength;\n    uniform float fadeFrom;\n    uniform float cellThickness;\n    uniform float sectionThickness;\n\n    float getGrid(float size, float thickness) {\n      vec2 r = localPosition.xz / size;\n      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n      float line = min(grid.x, grid.y) + 1.0 - thickness;\n      return 1.0 - min(line, 1.0);\n    }\n\n    void main() {\n      float g1 = getGrid(cellSize, cellThickness);\n      float g2 = getGrid(sectionSize, sectionThickness);\n\n      vec3 from = worldCamProjPosition*vec3(fadeFrom);\n      float dist = distance(from, worldPosition.xyz);\n      float d = 1.0 - min(dist / fadeDistance, 1.0);\n      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));\n\n      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));\n      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);\n      if (gl_FragColor.a <= 0.0) discard;\n\n      #include <tonemapping_fragment>\n      #include <${See>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `),Eee=f.forwardRef((e,t)=>{var n=e,{args:r,cellColor:a="#000000",sectionColor:i="#2080ff",cellSize:s=.5,sectionSize:o=1,followCamera:l=!1,infiniteGrid:c=!1,fadeDistance:u=100,fadeStrength:h=1,fadeFrom:p=1,cellThickness:m=.5,sectionThickness:g=1,side:x=nW}=n,y=d(n,["args","cellColor","sectionColor","cellSize","sectionSize","followCamera","infiniteGrid","fadeDistance","fadeStrength","fadeFrom","cellThickness","sectionThickness","side"]);I8({GridMaterial:kee});const v=f.useRef(null);f.useImperativeHandle(t,()=>v.current,[]);const b=new IQ,w=new WX(0,1,0),N=new WX(0,0,0);A8(e=>{b.setFromNormalAndCoplanarPoint(w,N).applyMatrix4(v.current.matrixWorld);const t=v.current.material,n=t.uniforms.worldCamProjPosition,r=t.uniforms.worldPlanePosition;b.projectPoint(e.camera.position,n.value),r.value.set(0,0,0).applyMatrix4(v.current.matrixWorld)});const S={cellSize:s,sectionSize:o,cellColor:a,sectionColor:i,cellThickness:m,sectionThickness:g},j={fadeDistance:u,fadeStrength:h,fadeFrom:p,infiniteGrid:c,followCamera:l};return f.createElement("mesh",A7({ref:v,frustumCulled:!1},y),f.createElement("gridMaterial",A7({transparent:!0,"extensions-derivatives":!0,side:x},S,j)),f.createElement("planeGeometry",{args:r}))}),Tee=f.forwardRef(function(e,t){var n=e,{children:r,object:a,disable:i,disableX:s,disableY:o,disableZ:l,left:c,right:u,top:h,bottom:p,front:m,back:g,onCentered:x,precise:y=!0,cacheKey:v=0}=n,b=d(n,["children","object","disable","disableX","disableY","disableZ","left","right","top","bottom","front","back","onCentered","precise","cacheKey"]);const w=f.useRef(null),N=f.useRef(null),S=f.useRef(null),[j]=f.useState(()=>new fK),[_]=f.useState(()=>new WX),[A]=f.useState(()=>new RK);return f.useLayoutEffect(()=>{N.current.matrixWorld.identity(),j.setFromObject(null!=a?a:S.current,y);const e=j.max.x-j.min.x,t=j.max.y-j.min.y,n=j.max.z-j.min.z;j.getCenter(_),j.getBoundingSphere(A);const r=h?t/2:p?-t/2:0,d=c?-e/2:u?e/2:0,f=m?n/2:g?-n/2:0;N.current.position.set(i||s?0:-_.x+d,i||o?0:-_.y+r,i||l?0:-_.z+f),null==x||x({parent:w.current.parent,container:w.current,width:e,height:t,depth:n,boundingBox:j,boundingSphere:A,center:_,verticalAlignment:r,horizontalAlignment:d,depthAlignment:f})},[v,x,h,c,m,i,s,o,l,a,y,u,p,g,j,_,A]),f.useImperativeHandle(t,()=>w.current,[]),f.createElement("group",A7({ref:w},b),f.createElement("group",{ref:N},f.createElement("group",{ref:S},r)))}),Pee=(e,t,n)=>{let r;switch(e){case XW:r=new Uint8ClampedArray(t*n*4);break;case tY:r=new Uint16Array(t*n*4);break;case ZW:r=new Uint32Array(t*n*4);break;case KW:r=new Int8Array(t*n*4);break;case qW:r=new Int16Array(t*n*4);break;case QW:r=new Int32Array(t*n*4);break;case eY:r=new Float32Array(t*n*4);break;default:throw new Error("Unsupported data type")}return r};let Dee;class Ree{constructor(e){var t,n,r,a,i,s,o,l,c,d,u,h,p,m,g,f;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(bI){throw this._renderer.setRenderTarget(null),bI}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const x={format:cY,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:void 0!==(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)?null===(n=e.renderTargetOptions)||void 0===n?void 0:n.anisotropy:1,generateMipmaps:void 0!==(null===(r=e.renderTargetOptions)||void 0===r?void 0:r.generateMipmaps)&&(null===(a=e.renderTargetOptions)||void 0===a?void 0:a.generateMipmaps),magFilter:void 0!==(null===(i=e.renderTargetOptions)||void 0===i?void 0:i.magFilter)?null===(s=e.renderTargetOptions)||void 0===s?void 0:s.magFilter:VW,minFilter:void 0!==(null===(o=e.renderTargetOptions)||void 0===o?void 0:o.minFilter)?null===(l=e.renderTargetOptions)||void 0===l?void 0:l.minFilter:VW,samples:void 0!==(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.samples)?null===(d=e.renderTargetOptions)||void 0===d?void 0:d.samples:void 0,wrapS:void 0!==(null===(u=e.renderTargetOptions)||void 0===u?void 0:u.wrapS)?null===(h=e.renderTargetOptions)||void 0===h?void 0:h.wrapS:FW,wrapT:void 0!==(null===(p=e.renderTargetOptions)||void 0===p?void 0:p.wrapT)?null===(m=e.renderTargetOptions)||void 0===m?void 0:m.wrapT:FW};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=Ree.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new FJ,this._camera=new o2,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!((e,t,n,r)=>{if(void 0!==Dee)return Dee;const a=new pK(1,1,r);t.setRenderTarget(a);const i=new xJ(new X0,new Fq({color:16777215}));t.render(i,n),t.setRenderTarget(null);const s=Pee(e,a.width,a.height);return t.readRenderTargetPixels(a,0,0,a.width,a.height,s),a.dispose(),i.geometry.dispose(),i.material.dispose(),Dee=0!==s[0],Dee})(this._type,this._renderer,this._camera,x)){let e;if(this._type===tY)e=this._renderer.extensions.has("EXT_color_buffer_float")?eY:void 0;void 0!==e?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to 1015`),this._type=e):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new xJ(new X0,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new pK(this.width,this.height,x),this._renderTarget.texture.mapping=void 0!==(null===(g=e.renderTargetOptions)||void 0===g?void 0:g.mapping)?null===(f=e.renderTargetOptions)||void 0===f?void 0:f.mapping:PW}static instantiateRenderer(){const e=new p6;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=Pee(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new vQ(this.toArray(),this.width,this.height,cY,this._type,(null==e?void 0:e.mapping)||PW,(null==e?void 0:e.wrapS)||FW,(null==e?void 0:e.wrapT)||FW,(null==e?void 0:e.magFilter)||VW,(null==e?void 0:e.minFilter)||VW,(null==e?void 0:e.anisotropy)||1,iX);return t.generateMipmaps=void 0!==(null==e?void 0:e.generateMipmaps)&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof jJ&&Object.values(this.material.uniforms).forEach(e=>{e.value instanceof dK&&e.value.dispose()}),Object.values(this.material).forEach(e=>{e instanceof dK&&e.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class Iee extends jJ{constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:a,maxDisplayBoost:i,hdrCapacityMin:s,hdrCapacityMax:o,sdr:l,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:l},gainMap:{value:c},gamma:{value:new WX(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:(new WX).fromArray(t)},offsetSdr:{value:(new WX).fromArray(n)},gainMapMin:{value:(new WX).fromArray(r)},gainMapMax:{value:(new WX).fromArray(a)},weightFactor:{value:(Math.log2(i)-s)/(o-s)}},blending:0,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=i,this._hdrCapacityMin=s,this._hdrCapacityMax=o,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class Oee extends Error{}class Bee extends Error{}const Lee=(e,t,n)=>{const r=new RegExp(`${t}="([^"]*)"`,"i").exec(e);if(r)return r[1];const a=new RegExp(`<${t}[^>]*>([\\s\\S]*?)</${t}>`,"i").exec(e);if(a){const e=a[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return e&&3===e.length?e.map(e=>e.replace(/<\/?rdf:li>/g,"")):a[1].trim()}if(void 0!==n)return n;throw new Error(`Can't find ${t} in gainmap metadata`)};class Fee{constructor(e){this.options={debug:!(!e||void 0===e.debug)&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,a=new DataView(e.buffer);if(65496!==a.getUint16(0))return void n(new Error("Not a valid jpeg"));const i=a.byteLength;let s,o=2,l=0;for(;o<i;){if(++l>250)return void n(new Error(`Found no marker after ${l} loops `));if(255!==a.getUint8(o))return void n(new Error(`Not a valid marker at offset 0x${o.toString(16)}, found: 0x${a.getUint8(o).toString(16)}`));if(s=a.getUint8(o+1),r&&console.log(`Marker: ${s.toString(16)}`),226===s){r&&console.log("Found APP2 marker (0xffe2)");const e=o+4;if(1297106432===a.getUint32(e)){const r=e+4;let i;if(18761===a.getUint16(r))i=!1;else{if(19789!==a.getUint16(r))return void n(new Error("No valid endianness marker found in TIFF header"));i=!0}if(42!==a.getUint16(r+2,!i))return void n(new Error("Not valid TIFF data! (no 0x002A marker)"));const s=a.getUint32(r+4,!i);if(s<8)return void n(new Error("Not valid TIFF data! (First offset less than 8)"));const o=r+s,l=a.getUint16(o,!i),c=o+2;let d=0;for(let e=c;e<c+12*l;e+=12)45057===a.getUint16(e,!i)&&(d=a.getUint32(e+8,!i));const u=o+2+12*l+4,h=[];for(let e=u;e<u+16*d;e+=16){const t={MPType:a.getUint32(e,!i),size:a.getUint32(e+4,!i),dataOffset:a.getUint32(e+8,!i),dependantImages:a.getUint32(e+12,!i),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=r+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,h.push(t)}if(this.options.extractNonFII&&h.length){const e=new Blob([a]),n=[];for(const t of h){if(t.isFII&&!this.options.extractFII)continue;const r=e.slice(t.start,t.end+1,"image/jpeg");n.push(r)}t(n)}}}o+=2+a.getUint16(o+2)}})}}const Uee=e=>h(null,null,function*(){const t=(e=>{let t;t="undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):e.toString();let n=t.indexOf("<x:xmpmeta");for(;-1!==n;){const e=t.indexOf("x:xmpmeta>",n),r=t.slice(n,e+10);try{const e=Lee(r,"hdrgm:GainMapMin","0"),t=Lee(r,"hdrgm:GainMapMax"),n=Lee(r,"hdrgm:Gamma","1"),a=Lee(r,"hdrgm:OffsetSDR","0.015625"),i=Lee(r,"hdrgm:OffsetHDR","0.015625"),s=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),o=s?s[1]:"0",l=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!l)throw new Error("Incomplete gainmap metadata");const c=l[1];return{gainMapMin:Array.isArray(e)?e.map(e=>parseFloat(e)):[parseFloat(e),parseFloat(e),parseFloat(e)],gainMapMax:Array.isArray(t)?t.map(e=>parseFloat(e)):[parseFloat(t),parseFloat(t),parseFloat(t)],gamma:Array.isArray(n)?n.map(e=>parseFloat(e)):[parseFloat(n),parseFloat(n),parseFloat(n)],offsetSdr:Array.isArray(a)?a.map(e=>parseFloat(e)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetHdr:Array.isArray(i)?i.map(e=>parseFloat(e)):[parseFloat(i),parseFloat(i),parseFloat(i)],hdrCapacityMin:parseFloat(o),hdrCapacityMax:parseFloat(c)}}catch(bI){}n=t.indexOf("<x:xmpmeta",e)}})(e);if(!t)throw new Bee("Gain map XMP metadata not found");const n=new Fee({extractFII:!0,extractNonFII:!0}),r=yield n.extract(e);if(2!==r.length)throw new Oee("Gain map recovery image not found");return{sdr:new Uint8Array(yield r[0].arrayBuffer()),gainMap:new Uint8Array(yield r[1].arrayBuffer()),metadata:t}}),zee=e=>new Promise((t,n)=>{const r=document.createElement("img");r.onload=()=>{t(r)},r.onerror=e=>{n(e)},r.src=URL.createObjectURL(e)});class Hee extends F1{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new B1}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new Iee({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new dK,sdr:new dK});return new Ree({width:16,height:16,type:tY,colorSpace:iX,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}render(e,t,n,r){return h(this,null,function*(){const a=r?new Blob([r],{type:"image/jpeg"}):void 0,i=new Blob([n],{type:"image/jpeg"});let s,o,l=!1;if("undefined"==typeof createImageBitmap){const e=yield Promise.all([a?zee(a):Promise.resolve(void 0),zee(i)]);o=e[0],s=e[1],l=!0}else{const e=yield Promise.all([a?createImageBitmap(a,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(i,{imageOrientation:"flipY"})]);o=e[0],s=e[1]}const c=new dK(o||new ImageData(2,2),PW,FW,FW,VW,YW,cY,XW,1,iX);c.flipY=l,c.needsUpdate=!0;const d=new dK(s,PW,FW,FW,VW,YW,cY,XW,1,aX);d.flipY=l,d.needsUpdate=!0,e.width=s.width,e.height=s.height,e.material.gainMap=c,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()})}}class Gee extends Hee{load([e,t,n],r,a,i){const s=this.prepareQuadRenderer();let o,l,c;const d=()=>h(this,null,function*(){if(o&&l&&c){try{yield this.render(s,c,o,l)}catch(a){return this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),"function"==typeof i&&i(a),void s.disposeOnDemandRenderer()}"function"==typeof r&&r(s),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),s.disposeOnDemandRenderer()}});let u=!0,p=0,m=0,g=!0,f=0,x=0,y=!0,v=0,b=0;const w=()=>{if("function"==typeof a){a(new ProgressEvent("progress",{lengthComputable:u&&g&&y,loaded:m+x+b,total:p+f+v}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const N=new H1(this._internalLoadingManager);N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(e,e=>h(this,null,function*(){if("string"==typeof e)throw new Error("Invalid sdr buffer");o=e,yield d()}),e=>{u=e.lengthComputable,m=e.loaded,p=e.total,w()},t=>{this.manager.itemError(e),"function"==typeof i&&i(t)});const S=new H1(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(t,e=>h(this,null,function*(){if("string"==typeof e)throw new Error("Invalid gainmap buffer");l=e,yield d()}),e=>{g=e.lengthComputable,x=e.loaded,f=e.total,w()},e=>{this.manager.itemError(t),"function"==typeof i&&i(e)});const j=new H1(this._internalLoadingManager);return j.setRequestHeader(this.requestHeader),j.setPath(this.path),j.setWithCredentials(this.withCredentials),j.load(n,e=>h(this,null,function*(){if("string"!=typeof e)throw new Error("Invalid metadata string");c=JSON.parse(e),yield d()}),e=>{y=e.lengthComputable,b=e.loaded,v=e.total,w()},e=>{this.manager.itemError(n),"function"==typeof i&&i(e)}),s}}class Vee extends Hee{load(e,t,n,r){const a=this.prepareQuadRenderer(),i=new H1(this._internalLoadingManager);return i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setPath(this.path),i.setWithCredentials(this.withCredentials),this.manager.itemStart(e),i.load(e,n=>h(this,null,function*(){if("string"==typeof n)throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const i=new Uint8Array(n);let s,o,l;try{const e=yield Uee(i);s=e.sdr,o=e.gainMap,l=e.metadata}catch(bI){if(!(bI instanceof Bee||bI instanceof Oee))throw bI;console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),l={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},s=i}try{yield this.render(a,l,s,o)}catch(c){return this.manager.itemError(e),"function"==typeof r&&r(c),void a.disposeOnDemandRenderer()}"function"==typeof t&&t(a),this.manager.itemEnd(e),a.disposeOnDemandRenderer()}),n,t=>{this.manager.itemError(e),"function"==typeof r&&r(t)}),a}}const $ee={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},Wee="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Yee=e=>Array.isArray(e),Xee=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Kee({files:e=Xee,path:t="",preset:n,colorSpace:r,extensions:a}={}){n&&(Qee(n),e=$ee[n],t=Wee);const i=Yee(e),{extension:s,isCubemap:o}=Zee(e),l=ete(s);if(!l)throw new Error("useEnvironment: Unrecognized file extension: "+e);const c=_8(e=>e.gl);f.useLayoutEffect(()=>{"webp"!==s&&"jpg"!==s&&"jpeg"!==s||c.domElement.addEventListener("webglcontextlost",function(){k8.clear(l,i?[e]:e)},{once:!0})},[e,c.domElement]);const d=k8(l,i?[e]:e,e=>{"webp"!==s&&"jpg"!==s&&"jpeg"!==s||e.setRenderer(c),null==e.setPath||e.setPath(t),a&&a(e)});let u=i?d[0]:d;var h;"jpg"!==s&&"jpeg"!==s&&"webp"!==s||(u=null==(h=u.renderTarget)?void 0:h.texture);return u.mapping=o?DW:IW,u.colorSpace=null!=r?r:o?"srgb":"srgb-linear",u}const qee={files:Xee,path:"",preset:void 0,extensions:void 0};Kee.preload=e=>{const t=l(l({},qee),e);let{files:n,path:r=""}=t;const{preset:a,extensions:i}=t;a&&(Qee(a),n=$ee[a],r=Wee);const{extension:s}=Zee(n);if("webp"===s||"jpg"===s||"jpeg"===s)throw new Error("useEnvironment: Preloading gainmaps is not supported");const o=ete(s);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+n);k8.preload(o,Yee(n)?[n]:n,e=>{null==e.setPath||e.setPath(r),i&&i(e)})};const Jee={files:Xee,preset:void 0};function Qee(e){if(!(e in $ee))throw new Error("Preset must be one of: "+Object.keys($ee).join(", "))}function Zee(e){var t;const n=Yee(e)&&6===e.length,r=Yee(e)&&3===e.length&&e.some(e=>e.endsWith("json")),a=Yee(e)?e[0]:e;return{extension:n?"cube":r?"webp":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":a.startsWith("data:image/jpeg")?"jpg":null==(t=a.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function ete(e){return"cube"===e?$1:"hdr"===e?mee:"exr"===e?fee:"jpg"===e||"jpeg"===e?Vee:"webp"===e?Gee:null}Kee.clear=e=>{const t=l(l({},Jee),e);let{files:n}=t;const{preset:r}=t;r&&(Qee(r),n=$ee[r]);const{extension:a}=Zee(n),i=ete(a);if(!i)throw new Error("useEnvironment: Unrecognized file extension: "+n);k8.clear(i,Yee(n)?[n]:n)};function tte(e,t,n,r,a={}){var i,s,o,c;a=l({backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0]},a);const d=(e=>{return(t=e).current&&t.current.isScene?e.current:e;var t})(t||n),u=d.background,h=d.environment,p={backgroundBlurriness:d.backgroundBlurriness,backgroundIntensity:d.backgroundIntensity,backgroundRotation:null!==(i=null==(s=d.backgroundRotation)||null==s.clone?void 0:s.clone())&&void 0!==i?i:[0,0,0],environmentIntensity:d.environmentIntensity,environmentRotation:null!==(o=null==(c=d.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==o?o:[0,0,0]};return"only"!==e&&(d.environment=r),e&&(d.background=r),g8(d,a),()=>{"only"!==e&&(d.environment=h),e&&(d.background=u),g8(d,p)}}function nte(e){var t=e,{scene:n,background:r=!1,map:a}=t,i=d(t,["scene","background","map"]);const s=_8(e=>e.scene);return f.useLayoutEffect(()=>{if(a)return tte(r,n,s,a,i)}),null}function rte(e){var t=e,{background:n=!1,scene:r,blur:a,backgroundBlurriness:i,backgroundIntensity:s,backgroundRotation:o,environmentIntensity:l,environmentRotation:c}=t;const u=Kee(d(t,["background","scene","blur","backgroundBlurriness","backgroundIntensity","backgroundRotation","environmentIntensity","environmentRotation"])),h=_8(e=>e.scene);return f.useLayoutEffect(()=>tte(n,r,h,u,{backgroundBlurriness:null!=a?a:i,backgroundIntensity:s,backgroundRotation:o,environmentIntensity:l,environmentRotation:c})),f.useEffect(()=>()=>{u.dispose()},[u]),null}function ate({children:e,near:t=.1,far:n=1e3,resolution:r=256,frames:a=1,map:i,background:s=!1,blur:o,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:d,environmentIntensity:u,environmentRotation:h,scene:p,files:m,path:g,preset:x,extensions:y}){const v=_8(e=>e.gl),b=_8(e=>e.scene),w=f.useRef(null),[N]=f.useState(()=>new FJ),S=f.useMemo(()=>{const e=new DJ(r);return e.texture.type=tY,e},[r]);f.useEffect(()=>()=>{S.dispose()},[S]),f.useLayoutEffect(()=>{if(1===a){const e=v.autoClear;v.autoClear=!0,w.current.update(v,N),v.autoClear=e}return tte(s,p,b,S.texture,{backgroundBlurriness:null!=o?o:l,backgroundIntensity:c,backgroundRotation:d,environmentIntensity:u,environmentRotation:h})},[e,N,S.texture,p,b,s,a,v]);let j=1;return A8(()=>{if(a===1/0||j<a){const e=v.autoClear;v.autoClear=!0,w.current.update(v,N),v.autoClear=e,j++}}),f.createElement(f.Fragment,null,function(e,t,n){return Nt.jsx(e7,{children:e,container:t,state:n})}(f.createElement(f.Fragment,null,e,f.createElement("cubeCamera",{ref:w,args:[t,n,S]}),m||x?f.createElement(rte,{background:!0,files:m,preset:x,path:g,extensions:y}):i?f.createElement(nte,{background:!0,map:i,extensions:y}):null),N))}function ite(e){var t,n,r,a;const i=Kee(e),s=e.map||i;f.useMemo(()=>I8({GroundProjectedEnvImpl:n9}),[]),f.useEffect(()=>()=>{i.dispose()},[i]);const o=f.useMemo(()=>[s],[s]),l=null==(t=e.ground)?void 0:t.height,c=null==(n=e.ground)?void 0:n.radius,d=null!==(r=null==(a=e.ground)?void 0:a.scale)&&void 0!==r?r:1e3;return f.createElement(f.Fragment,null,f.createElement(nte,A7({},e,{map:s})),f.createElement("groundProjectedEnvImpl",{args:o,scale:d,height:l,radius:c}))}function ste(e){return e.ground?f.createElement(ite,e):e.map?f.createElement(nte,e):e.children?f.createElement(ate,e):f.createElement(rte,e)}function ote({url:e,rotation:t}){const{scene:n}=Cee(e),r=f.useRef();return f.useEffect(()=>{r.current&&t&&(r.current.rotation.x=t.x*Math.PI/180,r.current.rotation.y=t.y*Math.PI/180,r.current.rotation.z=t.z*Math.PI/180)},[t]),Nt.jsx(Tee,{children:Nt.jsx("primitive",{ref:r,object:n})})}function lte(){const e=f.useRef();return A8(t=>{e.current&&(e.current.rotation.x=.5*t.clock.getElapsedTime(),e.current.rotation.y=.3*t.clock.getElapsedTime())}),Nt.jsxs("mesh",{ref:e,children:[Nt.jsx("boxGeometry",{args:[2,2,2]}),Nt.jsx("meshStandardMaterial",{color:"#4f46e5",wireframe:!0})]})}function cte({modelData:e,modelName:t,rotation:n={x:0,y:0,z:0},isDark:r=!1}){const[a,i]=f.useState(!1),[s,o]=f.useState(null);return f.useEffect(()=>{if(e)try{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),a=new Uint8Array(r);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);const s=new Blob([r],{type:n}),l=URL.createObjectURL(s);return o(l),i(!1),()=>{URL.revokeObjectURL(l)}}catch(t){console.error("Failed to load GLB:",t),i(!0)}else i(!0)},[e]),e?a||!s?Nt.jsx("div",{className:"w-full h-full flex items-center justify-center rounded border "+(r?"bg-gray-900 border-gray-700 text-red-400":"bg-gray-100 border-gray-300 text-red-600"),children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-lg mb-2",children:" Failed to load model"}),Nt.jsx("p",{className:"text-sm",children:t||"Unknown file"})]})}):Nt.jsxs("div",{className:"w-full h-full rounded border "+(r?"bg-gray-900 border-gray-700":"bg-gray-100 border-gray-300"),children:[Nt.jsx(_7,{camera:{position:[5,5,5],fov:50},style:{width:"100%",height:"100%"},children:Nt.jsxs(f.Suspense,{fallback:Nt.jsx(lte,{}),children:[Nt.jsx("ambientLight",{intensity:.5}),Nt.jsx("directionalLight",{position:[10,10,5],intensity:1}),Nt.jsx("directionalLight",{position:[-10,-10,-5],intensity:.3}),Nt.jsx(ote,{url:s,rotation:n}),Nt.jsx(Eee,{args:[20,20],cellSize:.5,cellThickness:.5,cellColor:"#6b7280",sectionSize:2,sectionThickness:1,sectionColor:"#4b5563",fadeDistance:30,fadeStrength:1,infiniteGrid:!0}),Nt.jsx(ste,{preset:"city"}),Nt.jsx(Mee,{enablePan:!0,enableZoom:!0,enableRotate:!0,autoRotate:!1,autoRotateSpeed:2})]})}),t&&Nt.jsxs("div",{className:`absolute top-2 left-2 px-3 py-1 rounded ${r?"bg-gray-800 text-gray-300":"bg-white text-gray-700"} shadow text-sm`,children:[" ",t]}),Nt.jsx("div",{className:`absolute bottom-2 left-2 px-3 py-1 rounded ${r?"bg-gray-800 text-gray-400":"bg-white text-gray-600"} shadow text-xs`,children:" Drag to rotate  Scroll to zoom  Right-click to pan"})]}):Nt.jsx("div",{className:"w-full h-full flex items-center justify-center rounded border "+(r?"bg-gray-900 border-gray-700 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"),children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-lg mb-2",children:" No 3D Model"}),Nt.jsx("p",{className:"text-sm",children:"Upload a GLB or GLTF file"})]})})}function dte(){var e,t,n,r,a,i;const{user:s,settings:o}=f.useContext($c),d=zc(),[u,p]=f.useState(!0),[m,g]=f.useState(!1),[x,y]=f.useState(null),[v,b]=f.useState([]),[w,N]=f.useState("select"),[S,j]=f.useState([]),[_,A]=f.useState(1),[C,M]=f.useState({x:0,y:0}),[k,T]=f.useState(null),[P,D]=f.useState(null),[I,O]=f.useState(null),[B,L]=f.useState({}),[F,U]=f.useState(!1),[z,H]=f.useState(!0),[G,V]=f.useState([]),[$,W]=f.useState(!1),[Y,X]=f.useState([]),[K,q]=f.useState(null),[J,Q]=f.useState({}),[Z,ee]=f.useState(!1),[te,ne]=f.useState(!1),[re,ae]=f.useState(null),[ie,se]=f.useState(""),[oe,le]=f.useState({x:0,y:0,z:0}),[ce]=f.useState({0:"rgba(99,102,241,0.35)",1:"rgba(16,185,129,0.35)",2:"rgba(239,68,68,0.35)",3:"rgba(251,146,60,0.35)",4:"rgba(168,85,247,0.35)",5:"rgba(59,130,246,0.35)"}),de=f.useRef(null),ue=f.useRef(null),he=["admin","super_admin","declarator"].includes(null==s?void 0:s.role),pe=["teller","supervisor","supervisor_teller"].includes(null==s?void 0:s.role);f.useEffect(()=>{h(null,null,function*(){try{const e=localStorage.getItem("token"),t=e?{headers:{Authorization:`Bearer ${e}`}}:{},[n,r,a]=yield Promise.all([pt.get(`${d}/api/map-config`,t),pt.get(`${d}/api/teller-management`,t),pt.get(`${d}/api/deployments`,t)]);y(n.data);const i=r.data||[],s=i.filter(e=>{var t;return"teller"===e.role||"supervisor_teller"===e.role||(null==(t=e.role)?void 0:t.includes("teller"))});b(s.length>0?s:i),V(a.data||[]),n.data.tellerPositions&&Q(n.data.tellerPositions),n.data.model3DData&&ae(n.data.model3DData),n.data.model3DName&&se(n.data.model3DName)}catch(bI){console.error("Failed to load map config:",bI)}finally{p(!1)}})},[]),f.useEffect(()=>{if(!re){fetch("/default-model.glb").then(e=>e.blob()).then(e=>{const t=new FileReader;t.onload=e=>{ae(e.target.result),se("default-model.glb")},t.readAsDataURL(e)})}},[re]),f.useEffect(()=>{const e=window.globalSocket||null;if(!e)return;const t=e=>y(e);return e.on("mapConfigUpdated",t),()=>e.off("mapConfigUpdated",t)},[]);const me=()=>{O(null)},ge="dark"===(null==(e=null==o?void 0:o.theme)?void 0:e.mode)?"#0f172a":"#f8fafc",fe="dark"===(null==(t=null==o?void 0:o.theme)?void 0:t.mode);return Nt.jsxs("div",{className:"p-4 space-y-4",style:{background:ge},children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("h1",{className:"text-2xl font-semibold",children:[" Live Map ",pe&&"(View Only)"]}),he&&Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>H(!z),title:"Toggle labels",className:"p-2 rounded "+(z?"bg-indigo-600 text-white":"bg-gray-300"),children:z?Nt.jsx(ye,{size:18}):Nt.jsx(De,{size:18})}),Nt.jsx("button",{onClick:()=>U(!F),title:"Heat map (assignments)",className:"p-2 rounded "+(F?"bg-orange-600 text-white":"bg-gray-300"),children:""}),Nt.jsx("button",{onClick:()=>W(!$),title:"Show items",className:"p-2 rounded "+($?"bg-cyan-600 text-white":"bg-gray-300"),children:""}),re&&Nt.jsx("button",{onClick:()=>ne(!te),title:"Toggle 2D/3D view",className:"p-2 rounded "+(te?"bg-purple-600 text-white":"bg-gray-300"),children:Nt.jsx(Le,{size:18})}),Nt.jsx("button",{onClick:()=>{A(1),M({x:0,y:0})},title:"Reset zoom/pan",className:"p-2 rounded bg-gray-300",children:Nt.jsx(Fe,{size:18})})]}),pe&&Nt.jsxs("div",{className:"flex gap-2 flex-wrap",children:[Nt.jsx("button",{onClick:()=>H(!z),title:"Toggle labels",className:"p-2 rounded "+(z?"bg-indigo-600 text-white":"bg-gray-300"),children:z?Nt.jsx(ye,{size:18}):Nt.jsx(De,{size:18})}),Nt.jsx("button",{onClick:()=>U(!F),title:"View assignments",className:"p-2 rounded "+(F?"bg-orange-600 text-white":"bg-gray-300"),children:""}),re&&Nt.jsx("button",{onClick:()=>ne(!te),title:"Toggle 2D/3D view",className:"p-2 rounded "+(te?"bg-purple-600 text-white":"bg-gray-300"),children:Nt.jsx(Le,{size:18})}),Nt.jsx("button",{onClick:()=>{A(1),M({x:0,y:0})},title:"Reset zoom/pan",className:"p-2 rounded bg-gray-300",children:Nt.jsx(Fe,{size:18})})]})]}),u&&Nt.jsx("div",{className:"text-center py-8",children:"Loading map"}),!u&&!(null==x?void 0:x.imageData)&&he&&Nt.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[Nt.jsxs("div",{className:`flex-1 border-2 border-dashed rounded p-6 ${fe?"bg-gray-800 border-gray-600":"bg-white border-gray-300"} shadow`,children:[Nt.jsx("p",{className:"mb-3 text-sm font-medium",children:" Upload your branch/region map image (PNG/JPG)"}),Nt.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;const r=new FileReader;r.onload=e=>{const t=new Image;t.onload=()=>{const n=c(l({},x||{}),{imageData:e.target.result,imageWidth:t.width,imageHeight:t.height});y(n)},t.src=e.target.result},r.readAsDataURL(n)},className:"mb-2"}),Nt.jsx("p",{className:"text-xs text-gray-500",children:"Base64 encoded for offline availability"})]}),Nt.jsxs("div",{className:`flex-1 border-2 border-dashed rounded p-6 ${fe?"bg-gray-800 border-gray-600":"bg-white border-gray-300"} shadow`,children:[Nt.jsx("p",{className:"mb-3 text-sm font-medium",children:" Upload 3D model (GLB/GLTF)"}),Nt.jsx("input",{type:"file",accept:".glb,.gltf",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;if(!n.name.toLowerCase().endsWith(".glb")&&!n.name.toLowerCase().endsWith(".gltf"))return void alert("Please upload a GLB or GLTF file");const r=new FileReader;r.onload=e=>{ae(e.target.result),se(n.name)},r.readAsDataURL(n)},className:"mb-2"}),Nt.jsx("p",{className:"text-xs text-gray-500",children:"Optional 3D facility layout"})]})]}),!u&&!(null==x?void 0:x.imageData)&&!re&&he&&Nt.jsx("p",{className:"text-xs text-gray-500 text-center py-4",children:"Upload either a 2D map or 3D model (or both) to get started"}),!u&&!(null==x?void 0:x.imageData)&&pe&&Nt.jsx("div",{className:"border rounded p-6 "+(fe?"bg-gray-800 border-gray-700":"bg-blue-50 border-blue-300"),children:Nt.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:" No map available yet. Contact an administrator to set up the map."})}),(null==x?void 0:x.imageData)&&Nt.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[Nt.jsxs("div",{className:"flex-1 space-y-2",children:[he&&Nt.jsx("div",{className:"flex gap-2 items-center flex-wrap",children:Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("button",{onClick:()=>N("add-label"===w?"select":"add-label"),title:"Add label / marker",className:"px-3 py-1.5 rounded text-sm font-medium flex items-center gap-1 "+("add-label"===w?"bg-indigo-600 text-white":"bg-gray-200 dark:bg-gray-700"),children:" Label"}),Nt.jsx("button",{onClick:()=>N("add-region"===w?"select":"add-region"),title:"Draw region polygon",className:"px-3 py-1.5 rounded text-sm font-medium flex items-center gap-1 "+("add-region"===w?"bg-green-600 text-white":"bg-gray-200 dark:bg-gray-700"),children:" Region"}),"add-region"===w&&S.length>=3&&Nt.jsx("button",{onClick:()=>{if(S.length<3)return void j([]);const e=`reg_${Date.now()}`,t=c(l({},x||{}),{regions:[...(null==x?void 0:x.regions)||[],{id:e,name:"Region",points:S,tellerIds:[]}]});y(t),j([]),N("select")},className:"px-3 py-1.5 rounded text-sm bg-green-600 text-white font-medium",children:" Finish"}),S.length>0&&Nt.jsxs("button",{onClick:()=>j([]),className:"px-3 py-1.5 rounded text-sm bg-red-600 text-white font-medium flex items-center gap-1",children:[Nt.jsx(R,{size:14})," Clear"]}),Nt.jsx("button",{disabled:m,onClick:()=>h(null,null,function*(){if(x){g(!0);try{const e={imageData:x.imageData,imageWidth:x.imageWidth,imageHeight:x.imageHeight,markers:x.markers||[],regions:x.regions||[],tellerPositions:J,model3DData:re,model3DName:ie},t=yield pt.put(`${d}/api/map-config`,e);y(t.data),t.data.tellerPositions&&Q(t.data.tellerPositions),t.data.model3DData&&ae(t.data.model3DData),t.data.model3DName&&se(t.data.model3DName)}catch(bI){console.error("Save failed:",bI)}finally{g(!1)}}}),className:"px-3 py-1.5 rounded text-sm bg-blue-600 text-white disabled:opacity-50 font-medium",children:m?" Saving":" Save"}),Nt.jsxs("div",{className:"flex gap-1 ml-auto",children:[Nt.jsx("button",{onClick:()=>{if(!x)return;const e=JSON.stringify(x,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`map-config-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(n)},title:"Export to JSON",className:"p-1.5 rounded bg-purple-600 text-white",children:Nt.jsx(E,{size:16})}),Nt.jsxs("label",{title:"Import from JSON",className:"p-1.5 rounded bg-purple-600 text-white cursor-pointer",children:[Nt.jsx(Ue,{size:16}),Nt.jsx("input",{type:"file",accept:".json",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;const r=new FileReader;r.onload=e=>{try{const t=JSON.parse(e.target.result);y(t)}catch(t){alert("Invalid JSON file")}},r.readAsText(n)},className:"hidden"})]})]})]})}),!te&&x.imageData?Nt.jsxs("div",{className:"relative border rounded overflow-hidden "+(fe?"bg-gray-900":"bg-white"),style:{aspectRatio:`${x.imageWidth}/${x.imageHeight}`},children:[Nt.jsx("div",{ref:ue,className:"relative w-full h-full overflow-auto",style:{cursor:he&&"select"!==w?"crosshair":"grab"},onMouseDown:e=>{"select"===w&&k&&O({type:"marker",id:k,startX:e.clientX,startY:e.clientY})},onMouseMove:e=>{if(!I)return;const t=ue.current;if(!t)return;const n=t.getBoundingClientRect(),r=x.markers.find(e=>e.id===I.id);if(!r)return;const a=(e.clientX-I.startX)/n.width,i=(e.clientY-I.startY)/n.height,s=Math.max(0,Math.min(1,r.position.x+a)),o=Math.max(0,Math.min(1,r.position.y+i)),d=c(l({},x||{}),{markers:(x.markers||[]).map(e=>e.id===I.id?c(l({},e),{position:{x:Number(s.toFixed(4)),y:Number(o.toFixed(4))}}):e)});y(d),O(c(l({},I),{startX:e.clientX,startY:e.clientY}))},onMouseUp:me,onMouseLeave:me,onClick:e=>{if(!he)return;const t=((e,t)=>{if(!de.current)return null;const n=de.current.getBoundingClientRect(),r=(e-n.left)/n.width,a=(t-n.top)/n.height;return{x:Number(r.toFixed(4)),y:Number(a.toFixed(4))}})(e.clientX,e.clientY);if(t)if("add-label"===w){const e=`lbl_${Date.now()}`,n=c(l({},x||{}),{markers:[...(null==x?void 0:x.markers)||[],{id:e,label:"New",position:t}]});y(n),N("select")}else"add-region"===w&&j(e=>[...e,t])},onDragOver:e=>{K&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")},onDrop:e=>{if(!K||!ue.current)return;e.preventDefault();const t=ue.current.getBoundingClientRect(),n=(e.clientX-t.left)/t.width,r=(e.clientY-t.top)/t.height,a=(x.regions||[]).find(e=>{if(!e.points||e.points.length<3)return!1;const t=e.points;let a=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const e=t[i].x,o=t[i].y,l=t[s].x,c=t[s].y;o>r!=c>r&&n<(l-e)*(r-o)/(c-o)+e&&(a=!a)}return a});if(!a)return alert("Please drop the teller inside a region"),void q(null);const i=c(l({},x||{}),{regions:(x.regions||[]).map(e=>e.id===a.id?c(l({},e),{tellerIds:[K._id]}):e)});y(i),Q(e=>c(l({},e),{[K._id]:{regionId:a.id,x:n,y:r}})),q(null)},children:Nt.jsxs("div",{style:{transform:`translate(${C.x}px, ${C.y}px) scale(${_})`,transformOrigin:"0 0",transition:I?"none":"transform 0.2s"},children:[Nt.jsx("img",{ref:de,src:x.imageData,alt:"Map",className:"w-full h-full object-contain select-none"}),S.length>0&&Nt.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",children:[Nt.jsx("polygon",{points:S.map(e=>`${100*e.x}%,${100*e.y}%`).join(" "),fill:"rgba(99,102,241,0.3)",stroke:"#6366f1",strokeWidth:2}),S.map((e,t)=>Nt.jsx("circle",{cx:100*e.x+"%",cy:100*e.y+"%",r:"4",fill:"#6366f1"},t))]}),(x.regions||[]).map((e,t)=>{var n;return Nt.jsx("div",{className:"absolute inset-0 w-full h-full pointer-events-none",children:Nt.jsxs("svg",{className:"absolute inset-0 w-full h-full",children:[Nt.jsx("polygon",{points:e.points.map(e=>`${100*e.x}%,${100*e.y}%`).join(" "),fill:F&&(null==(n=e.tellerIds)?void 0:n.length)?"rgba(34,197,94,0.4)":ce[t%6],stroke:P===e.id?"#f59e0b":"#10b981",strokeWidth:P===e.id?3:2,style:{cursor:he?"pointer":"default"},onClick:t=>{t.stopPropagation(),D(P===e.id?null:e.id)}}),e.points.map((e,t)=>Nt.jsx("circle",{cx:100*e.x+"%",cy:100*e.y+"%",r:"3",fill:"#10b981",opacity:.6},t))]})},e.id)}),z&&(x.markers||[]).map(e=>Nt.jsx("div",{className:"absolute px-2 py-1 rounded text-xs font-semibold shadow cursor-move border-2 "+(k===e.id?"bg-yellow-300 border-yellow-600 text-black":"bg-white/90 border-gray-300 text-gray-900"),style:{left:100*e.position.x+"%",top:100*e.position.y+"%",transform:"translate(-50%, -50%)",zIndex:k===e.id?50:10},onClick:t=>{t.stopPropagation(),T(k===e.id?null:e.id)},children:he&&k===e.id?Nt.jsx("input",{value:e.label,onChange:t=>((e,t)=>{const n=c(l({},x||{}),{markers:(x.markers||[]).map(n=>n.id===e?c(l({},n),{label:t}):n)});y(n)})(e.id,t.target.value),className:"bg-transparent outline-none text-[11px] w-16 font-bold",autoFocus:!0}):e.label},e.id))]})}),Nt.jsxs("div",{className:"absolute bottom-2 right-2 flex flex-col gap-1",children:[Nt.jsx("button",{onClick:()=>A(Math.min(4,_+.2)),className:"p-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:Nt.jsx(ze,{size:16})}),Nt.jsx("button",{onClick:()=>A(Math.max(.5,_-.2)),className:"p-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:Nt.jsx(He,{size:16})})]})]}):te&&re?Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsx("div",{style:{height:"500px",position:"relative"},children:Nt.jsx(cte,{modelData:re,modelName:ie,rotation:oe,isDark:fe})}),Nt.jsxs("div",{className:"p-3 rounded border grid grid-cols-3 gap-2 "+(fe?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("div",{className:"col-span-3",children:Nt.jsx("p",{className:"text-xs font-semibold mb-2",children:" Rotation Controls"})}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-[10px] font-medium mb-1",children:"X (Pitch)"}),Nt.jsxs("div",{className:"flex gap-1",children:[Nt.jsx("button",{onClick:()=>le(c(l({},oe),{x:oe.x-5})),className:"flex-1 px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600",children:"-"}),Nt.jsxs("span",{className:"flex-1 px-2 py-1 rounded bg-gray-200 dark:bg-gray-700 text-xs text-center",children:[oe.x.toFixed(0),""]}),Nt.jsx("button",{onClick:()=>le(c(l({},oe),{x:oe.x+5})),className:"flex-1 px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600",children:"+"})]})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-[10px] font-medium mb-1",children:"Y (Yaw)"}),Nt.jsxs("div",{className:"flex gap-1",children:[Nt.jsx("button",{onClick:()=>le(c(l({},oe),{y:oe.y-5})),className:"flex-1 px-2 py-1 rounded bg-green-500 text-white text-xs hover:bg-green-600",children:"-"}),Nt.jsxs("span",{className:"flex-1 px-2 py-1 rounded bg-gray-200 dark:bg-gray-700 text-xs text-center",children:[oe.y.toFixed(0),""]}),Nt.jsx("button",{onClick:()=>le(c(l({},oe),{y:oe.y+5})),className:"flex-1 px-2 py-1 rounded bg-green-500 text-white text-xs hover:bg-green-600",children:"+"})]})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-[10px] font-medium mb-1",children:"Z (Roll)"}),Nt.jsxs("div",{className:"flex gap-1",children:[Nt.jsx("button",{onClick:()=>le(c(l({},oe),{z:oe.z-5})),className:"flex-1 px-2 py-1 rounded bg-blue-500 text-white text-xs hover:bg-blue-600",children:"-"}),Nt.jsxs("span",{className:"flex-1 px-2 py-1 rounded bg-gray-200 dark:bg-gray-700 text-xs text-center",children:[oe.z.toFixed(0),""]}),Nt.jsx("button",{onClick:()=>le(c(l({},oe),{z:oe.z+5})),className:"flex-1 px-2 py-1 rounded bg-blue-500 text-white text-xs hover:bg-blue-600",children:"+"})]})]}),Nt.jsx("button",{onClick:()=>le({x:0,y:0,z:0}),className:"col-span-3 px-3 py-2 rounded bg-gray-600 text-white text-xs hover:bg-gray-700 font-medium",children:" Reset Rotation"})]})]}):Nt.jsx("div",{className:`relative border rounded overflow-hidden ${fe?"bg-gray-900":"bg-white"} p-8 text-center`,children:Nt.jsxs("p",{className:"text-gray-500",children:["No 2D map uploaded. ",re?"Switch to 3D view or":""," upload a map image to get started."]})}),he&&"add-region"===w&&S.length>0&&Nt.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 p-2 rounded text-xs text-blue-900 dark:text-blue-100",children:[" Points: ",S.length,' | Click 3+ points, then press "Finish Region"']})]}),Nt.jsxs("div",{className:"w-full lg:w-80 space-y-4 "+(fe?"text-gray-100":""),children:[Nt.jsxs("div",{className:"p-4 rounded border shadow "+(fe?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("h2",{className:"font-bold text-sm mb-3 flex items-center gap-2",children:[" Regions (",(null==(n=x.regions)?void 0:n.length)||0,")"]}),0===(x.regions||[]).length&&Nt.jsx("p",{className:"text-xs text-gray-400",children:"No regions yet. Draw one to get started!"}),(x.regions||[]).map((e,t)=>{var n;return Nt.jsxs("div",{className:"mb-3 p-2 rounded border "+(P===e.id?"border-yellow-500 bg-yellow-50 dark:bg-gray-700":"border-gray-200 dark:border-gray-600"),children:[Nt.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("input",{value:e.name,onChange:t=>{const n=c(l({},x||{}),{regions:(x.regions||[]).map(n=>n.id===e.id?c(l({},n),{name:t.target.value}):n)});y(n)},className:"w-full text-xs font-medium rounded px-1 py-0.5 border "+(fe?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),placeholder:"Region name"}),Nt.jsxs("p",{className:"text-[10px] text-gray-500 mt-1",children:[e.points.length," points"]})]}),Nt.jsxs("div",{className:"flex gap-1",children:[Nt.jsx("button",{onClick:()=>(e=>{const t=x.regions.find(t=>t.id===e);if(!t)return;const n=`reg_${Date.now()}`,r=c(l({},t),{id:n,name:`${t.name} (copy)`}),a=c(l({},x||{}),{regions:[...x.regions||[],r]});y(a)})(e.id),title:"Duplicate",className:"p-1 rounded bg-purple-500 text-white hover:bg-purple-600",children:Nt.jsx(Ge,{size:12})}),Nt.jsx("button",{onClick:()=>(e=>{const t=c(l({},x||{}),{regions:(x.regions||[]).filter(t=>t.id!==e)});y(t),D(null)})(e.id),title:"Delete",className:"p-1 rounded bg-red-500 text-white hover:bg-red-600",children:Nt.jsx(R,{size:12})})]})]}),Nt.jsxs("select",{value:(null==(n=e.tellerIds)?void 0:n[0])||"",onChange:t=>((e,t)=>{const n=c(l({},x||{}),{regions:(x.regions||[]).map(n=>n.id===e?c(l({},n),{tellerIds:[t]}):n)});y(n)})(e.id,t.target.value),className:"w-full text-xs rounded px-1 py-1 border font-medium "+(fe?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"",children:" Assign Teller"}),v.map(e=>Nt.jsx("option",{value:e._id,children:e.name||e.username},e._id))]})]},e.id)})]}),Nt.jsxs("div",{className:"p-4 rounded border shadow "+(fe?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("h2",{className:"font-bold text-sm mb-3",children:[" Markers (",(null==(r=x.markers)?void 0:r.length)||0,")"]}),0===(x.markers||[]).length&&Nt.jsx("p",{className:"text-xs text-gray-400",children:"No markers yet."}),(x.markers||[]).map(e=>Nt.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 p-2 rounded border "+(k===e.id?"bg-yellow-50 dark:bg-gray-700 border-yellow-400":"border-gray-200 dark:border-gray-600"),children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-xs font-semibold",children:e.label||"Unnamed"}),Nt.jsxs("p",{className:"text-[10px] text-gray-500",children:["(",(100*e.position.x).toFixed(0),"%, ",(100*e.position.y).toFixed(0),"%)"]})]}),Nt.jsx("button",{onClick:()=>(e=>{const t=c(l({},x||{}),{markers:(x.markers||[]).filter(t=>t.id!==e)});y(t),T(null)})(e.id),className:"p-1 rounded bg-red-500 text-white hover:bg-red-600",children:Nt.jsx(R,{size:12})})]},e.id))]}),F&&Nt.jsxs("div",{className:`p-3 rounded border ${fe?"bg-green-900 border-green-700":"bg-green-50 border-green-300"} text-sm`,children:[Nt.jsx("p",{className:"font-bold",children:" Coverage"}),Nt.jsxs("p",{className:"text-xs mt-1",children:["Assigned: ",(x.regions||[]).filter(e=>{var t;return(null==(t=e.tellerIds)?void 0:t.length)>0}).length," / ",(null==(a=x.regions)?void 0:a.length)||0]})]}),$&&P&&Nt.jsxs("div",{className:"p-4 rounded border shadow "+(fe?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("h2",{className:"font-bold text-sm mb-3",children:[' Items in "',(null==(i=(x.regions||[]).find(e=>e.id===P))?void 0:i.name)||"Region",'"']}),0===G.length&&Nt.jsx("p",{className:"text-xs text-gray-400",children:"No items available."}),G.length>0&&Nt.jsx("div",{className:"space-y-2 mb-3",children:G.map(e=>{var t;const n=(null==(t=(x.regions||[]).find(e=>e.id===P))?void 0:t.itemIds)||[],r=n.includes(e._id);return Nt.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 rounded border text-xs "+(r?"bg-cyan-50 dark:bg-cyan-900 border-cyan-400":"border-gray-300 dark:border-gray-600"),children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold",children:e.itemName||e.itemType}),Nt.jsxs("p",{className:"text-[10px] text-gray-500",children:["Qty: ",e.quantity]})]}),r?Nt.jsx("button",{onClick:()=>((e,t)=>{const n=c(l({},x||{}),{regions:(x.regions||[]).map(n=>n.id===e?c(l({},n),{itemIds:(n.itemIds||[]).filter(e=>e!==t)}):n)});y(n)})(P,e._id),className:"p-1 rounded bg-red-500 text-white hover:bg-red-600",children:Nt.jsx(R,{size:12})}):Nt.jsx("button",{onClick:()=>((e,t)=>{const n=c(l({},x||{}),{regions:(x.regions||[]).map(n=>n.id===e?c(l({},n),{itemIds:[...n.itemIds||[],t]}):n)});y(n)})(P,e._id),className:"p-1 rounded bg-green-600 text-white hover:bg-green-700",children:"+"})]},e._id)})})]}),he&&Nt.jsxs("div",{className:"p-4 rounded border shadow "+(fe?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("button",{onClick:()=>ee(!Z),className:"w-full font-bold text-sm mb-3 p-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 flex items-center justify-between",children:[Nt.jsxs("span",{children:[" Drag Tellers (",v.length,")"]}),Nt.jsx("span",{children:Z?"":""})]}),Z&&Nt.jsxs("div",{className:"space-y-2",children:[0===v.length&&Nt.jsx("p",{className:"text-xs text-gray-400",children:"No tellers available."}),v.map(e=>{const t=(x.regions||[]).find(t=>{var n;return null==(n=t.tellerIds)?void 0:n.includes(e._id)});return Nt.jsxs("div",{draggable:!0,onDragStart:t=>((e,t)=>{q(t),e.dataTransfer.effectAllowed="copy"})(t,e),className:"p-2 rounded border text-xs cursor-move transition "+((null==K?void 0:K._id)===e._id?"bg-indigo-100 dark:bg-indigo-900 border-indigo-400 opacity-50":t?"bg-green-50 dark:bg-green-900 border-green-400":"bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:border-indigo-400"),children:[Nt.jsx("div",{className:"font-semibold",children:e.name||e.username}),t&&Nt.jsxs("p",{className:"text-[10px] text-gray-600 dark:text-gray-400",children:[" ",t.name]}),Nt.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400",children:" Drag to map to assign"})]},e._id)})]}),Nt.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-3 italic",children:" Tip: Drag a teller name and drop it inside a region on the map to assign."})]})]})]}),!u&&!(null==x?void 0:x.imageData)&&!he&&Nt.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:" No map configured. Contact administrator to set up regions and markers."})]})}function ute(){var e,t,n,r,a,i,s,o,l,c,d,u,p,m,g,x,y,v,b,w,N,S,j,_,A,C,k,T,P,D,R,I,O,B,L;const{user:F,settings:U}=f.useContext($c),{showToast:z}=Kc(),H="dark"===(null==(e=null==U?void 0:U.theme)?void 0:e.mode),G=zc(),[V,$]=f.useState(!0),[W,Y]=f.useState(null),[X,K]=f.useState((new Date).toISOString().split("T")[0]);if("admin"!==(null==F?void 0:F.role)||!(null==F?void 0:F.isSuperAdmin))return Nt.jsxs("div",{className:"p-8 rounded-lg border-2 "+(H?"bg-red-900/20 border-red-700":"bg-red-50 border-red-200"),children:[Nt.jsx("h2",{className:H?"text-red-200":"text-red-800",children:"Access Denied"}),Nt.jsx("p",{className:H?"text-red-300":"text-red-700",children:"This report is only available to SuperAdmins."})]});f.useEffect(()=>{q()},[X]);const q=()=>h(null,null,function*(){try{$(!0);const e=localStorage.getItem("token"),t=yield pt.get(`${G}/api/admin/financial-summary/${X}`,{headers:{Authorization:`Bearer ${e}`},timeout:3e4});Y(t.data)}catch(e){console.error("Failed to fetch financial summary:",e),z({type:"error",message:"Failed to load financial summary"})}finally{$(!1)}});return V?Nt.jsxs("div",{className:"flex items-center justify-center p-12",children:[Nt.jsx(Ae,{className:"animate-spin mr-2"}),Nt.jsx("span",{children:"Loading financial summary..."})]}):W?Nt.jsxs("div",{className:"p-6 rounded-lg "+(H?"bg-gray-900 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Daily Financial Summary"}),Nt.jsxs("div",{className:"flex gap-4 items-center",children:[Nt.jsx("input",{type:"date",value:X,onChange:e=>K(e.target.value),className:"px-4 py-2 rounded border "+(H?"bg-gray-800 border-gray-700":"bg-white border-gray-300")}),Nt.jsxs("button",{onClick:q,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2",children:[Nt.jsx(Ae,{size:16}),"Refresh"]}),Nt.jsxs("button",{onClick:()=>{W&&z({type:"info",message:"Export feature coming soon"})},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center gap-2",children:[Nt.jsx(E,{size:16}),"Export"]})]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"p-4 rounded-lg mb-4 "+(H?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"),children:[Nt.jsx("h3",{className:"font-bold text-lg mb-3",children:"Cash Position"}),Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Revolving Money:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(n=null==(t=W.cashPosition)?void 0:t.revolvingMoney)?void 0:n.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"System Balance:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(a=null==(r=W.cashPosition)?void 0:r.systemBalance)?void 0:a.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Cash on Hand:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(s=null==(i=W.cashPosition)?void 0:i.cashOnHand)?void 0:s.toLocaleString())||"0"]})]}),Nt.jsx("hr",{className:"my-2 "+(H?"border-gray-700":"border-gray-300")}),Nt.jsxs("div",{className:"flex justify-between text-blue-500 font-bold",children:[Nt.jsx("span",{children:"Difference:"}),Nt.jsxs("span",{children:["",(null==(l=null==(o=W.cashPosition)?void 0:o.difference)?void 0:l.toLocaleString())||"0"]})]})]})]}),Nt.jsxs("div",{className:"p-4 rounded-lg "+(H?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"),children:[Nt.jsx("h3",{className:"font-bold text-lg mb-3",children:"Salary & Over"}),Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Total Salary:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(d=null==(c=W.salary)?void 0:c.totalSalary)?void 0:d.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Over:"}),Nt.jsxs("span",{className:"font-semibold text-green-500",children:["+",(null==(p=null==(u=W.salary)?void 0:u.totalOver)?void 0:p.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"OP Commission:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(g=null==(m=W.salary)?void 0:m.opCommission)?void 0:g.toLocaleString())||"0"]})]}),Nt.jsx("hr",{className:"my-2 "+(H?"border-gray-700":"border-gray-300")}),Nt.jsxs("div",{className:"flex justify-between font-bold",children:[Nt.jsx("span",{children:"Admin Expense:"}),Nt.jsxs("span",{className:"text-red-500",children:["-",(null==(y=null==(x=W.salary)?void 0:x.adminExpense)?void 0:y.toLocaleString())||"0"]})]})]})]})]}),Nt.jsxs("div",{children:[Nt.jsxs("div",{className:"p-4 rounded-lg "+(H?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"),children:[Nt.jsx("h3",{className:"font-bold text-lg mb-3",children:"Expenses by Role"}),Nt.jsx("div",{className:"space-y-2 text-sm",children:W.expenseByRole&&Object.entries(W.expenseByRole).map(([e,t])=>{var n;return Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsxs("span",{className:"capitalize",children:[e,":"]}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(n=t.totalSalary)?void 0:n.toLocaleString())||"0"]})]},e)})||Nt.jsx("p",{className:"text-gray-500",children:"No expenses recorded"})})]}),Nt.jsxs("div",{className:"p-4 rounded-lg mt-4 "+(H?"bg-gray-800 border border-gray-700":"bg-gray-50 border border-gray-200"),children:[Nt.jsx("h3",{className:"font-bold text-lg mb-3",children:"Cashflow Expenses"}),Nt.jsxs("div",{className:"space-y-2 text-sm",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Petty Cash:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(b=null==(v=W.expenses)?void 0:v.pettyCash)?void 0:b.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Registration:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(N=null==(w=W.expenses)?void 0:w.registration)?void 0:N.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Meals:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(j=null==(S=W.expenses)?void 0:S.meals)?void 0:j.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Water:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(A=null==(_=W.expenses)?void 0:_.water)?void 0:A.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Thermal:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(k=null==(C=W.expenses)?void 0:C.thermal)?void 0:k.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Other:"}),Nt.jsxs("span",{className:"font-semibold",children:["",(null==(P=null==(T=W.expenses)?void 0:T.other)?void 0:P.toLocaleString())||"0"]})]})]})]})]})]}),Nt.jsx("div",{className:"p-4 rounded-lg border-2 "+(H?"bg-gray-800 border-blue-700":"bg-blue-50 border-blue-300"),children:Nt.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Payroll Expense"}),Nt.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["",(null==(R=null==(D=W.totals)?void 0:D.totalPayrollExpense)?void 0:R.toLocaleString())||"0"]})]}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Cash Expense"}),Nt.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",(null==(O=null==(I=W.totals)?void 0:I.totalCashExpense)?void 0:O.toLocaleString())||"0"]})]}),Nt.jsxs("div",{colSpan:2,className:"col-span-2",children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Grand Total"}),Nt.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:["",(null==(L=null==(B=W.totals)?void 0:B.grandTotal)?void 0:L.toLocaleString())||"0"]})]})]})})]}):Nt.jsxs("div",{className:"p-8 rounded-lg border-2 "+(H?"bg-yellow-900/20 border-yellow-700":"bg-yellow-50 border-yellow-200"),children:[Nt.jsx(M,{className:"inline mr-2"}),Nt.jsxs("span",{children:["No financial data available for ",X]})]})}const hte=new class{constructor(){this.apiUrl=zc()}decodeHtmlEntities(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}fetchLeaderboardData(){return h(this,null,function*(){try{const e=yield fetch(`${this.apiUrl}/api/external-betting/leaderboard`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=yield e.json().catch(()=>({}));throw new Error(t.error||`HTTP error! status: ${e.status}`)}const t=yield e.json();if(!t.success)throw new Error(t.error||"Failed to fetch leaderboard data");return console.log(` Fetched ${t.totalDraws} draws from GTArena leaderboard`),t.data}catch(e){console.error(" Error fetching external leaderboard data:",e),console.log(" Falling back to local draws data...");try{const e=yield fetch(`${this.apiUrl}/api/draws`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=yield e.json();if(t.success)return console.log(` Fallback: Fetched ${t.totalDraws} draws from local database`),t.data}}catch(t){console.error(" Fallback also failed:",t)}throw e}})}getLatestCompletedDraw(){return h(this,null,function*(){return(yield this.fetchLeaderboardData()).find(e=>"completed"===e.status)||null})}getCurrentDraw(){return h(this,null,function*(){try{const e=yield this.fetchLeaderboardData();return e.length>0?e[0]:null}catch(e){console.error(" Error fetching current draw:",e);try{const e=yield fetch(`${this.apiUrl}/api/draws/current`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=yield e.json();return t.success?t.data:null}}catch(t){console.error(" Current draw fallback failed:",t)}return null}})}getBettingStats(){return h(this,null,function*(){const e=(yield this.fetchLeaderboardData()).filter(e=>"completed"===e.status),t=e.length,n=e.reduce((e,t)=>e+t.totalBets,0),r=e.reduce((e,t)=>e+t.totalBetAmount,0);return{totalDraws:t,totalBets:n,totalBetAmount:r,totalWonAmount:e.reduce((e,t)=>e+t.totalWonAmount,0),averageBetAmount:t>0?r/t:0,averageBetsPerDraw:t>0?n/t:0}})}},pte=()=>{var e,t,n,r,a,i,s,o,d,u;const[p,m]=f.useState([]),[g,x]=f.useState(!1),[y,v]=f.useState(!1),[b,w]=f.useState(null),[N,S]=f.useState(null),[j,_]=f.useState(null),[A,C]=f.useState(null),[M,k]=f.useState(!1),[E,T]=f.useState(null),[P,D]=f.useState(new Date),[R,I]=f.useState([]),[O,B]=f.useState(0),{showToast:L}=Kc();f.useEffect(()=>{if(null==j?void 0:j.details){const e=j.details.redTotalBetAmount+j.details.blueTotalBetAmount+(j.details.drawTotalBetAmount||0);if(e>O){const t=Math.min(Math.floor((e-O)/1e3),15),n=Array.from({length:t}).map((e,t)=>({id:`${Date.now()}-${t}`,createdAt:Date.now(),animationStarted:!1}));I(e=>[...e,...n]),B(e)}}},[null==j?void 0:j.details,O]),f.useEffect(()=>{const e=setTimeout(()=>{I(e=>e.map(e=>c(l({},e),{animationStarted:!0})))},3500);return()=>clearTimeout(e)},[R.length]);const F=(e=!1)=>h(null,null,function*(){e?v(!0):x(!0),w(null);try{const[t,n,r]=yield Promise.all([hte.fetchLeaderboardData(),hte.getBettingStats(),hte.getCurrentDraw()]);m(t),S(n),_(r),T(new Date),e||L({type:"success",message:`Loaded ${t.length} draws from external leaderboard`})}catch(t){console.error("Error fetching leaderboard data:",t),e||(w(t.message),L({type:"error",message:"Failed to load leaderboard data"}))}finally{e?v(!1):x(!1)}});f.useEffect(()=>{F(!1);const e=Vc();if(C(e),e){e.on("connect",()=>{console.log(" Leaderboard socket connected"),k(!0),e.emit("subscribe-leaderboard"),e.emit("subscribe-betting"),F(!0)}),e.on("disconnect",()=>{console.log(" Leaderboard socket disconnected"),k(!1)}),e.on("leaderboard-update",e=>{console.log(" Leaderboard update received:",e),e.draws&&m(e.draws),e.currentDraw&&_(e.currentDraw),e.stats&&S(e.stats),T(new Date)}),e.on("betting-update",e=>{console.log(" Betting update received:",e),e.currentDraw&&(_(e.currentDraw),T(new Date))});const t=setInterval(()=>{F(!0)},2e3);return()=>{e.off("connect"),e.off("disconnect"),e.off("leaderboard-update"),e.off("betting-update"),clearInterval(t)}}},[]),f.useEffect(()=>{const e=setInterval(()=>{D(new Date)},1e3);return()=>clearInterval(e)},[]);const U=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t))return"";let n=t.getHours();const r=String(t.getMinutes()).padStart(2,"0"),a=n>=12?"PM":"AM";n%=12,n=n||12;return`${String(n).padStart(2,"0")}:${r} ${a}`}catch(bI){return""}},z=e=>{try{const t=localStorage.getItem(`fight-time-${e}`);return t?JSON.parse(t):null}catch(bI){return null}};f.useEffect(()=>{let e=0;p.forEach(t=>{if(t.id){if(!z(t.id)){let n;if(t.createdAt)n=U(t.createdAt);else{const t=e*2.5,r=new Date((new Date).getTime()-60*t*1e3);n=U(r.toISOString())}((e,t)=>{try{localStorage.setItem(`fight-time-${e}`,JSON.stringify(t))}catch(bI){console.warn("Failed to store fight time:",bI)}})(t.id,n),e++}}})},[p.map(e=>e.id).join(",")]);const H=()=>{const e=new Date;let t=e.getHours();const n=String(e.getMinutes()).padStart(2,"0"),r=String(e.getSeconds()).padStart(2,"0"),a=t>=12?"PM":"AM";t%=12,t=t||12;return`${String(t).padStart(2,"0")}:${n}:${r} ${a}`},G=(e,...t)=>{let n=0;for(let r=0;r<Math.min(e.length,20);r++){const a=e[r].result1;if(!t.some(e=>a===e||"meron"===e&&"red"===a||"wala"===e&&"blue"===a))break;n++}return n};return g&&0===p.length?Nt.jsx("div",{className:"min-h-screen bg-black text-white",children:Nt.jsxs("div",{className:"flex items-center justify-center h-screen",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),Nt.jsx("span",{className:"ml-3 text-lg",children:"Loading leaderboard data..."})]})}):b&&0===p.length?Nt.jsx("div",{className:"min-h-screen bg-black text-white p-6",children:Nt.jsx("div",{className:"bg-red-900 border border-red-700 rounded-lg p-4",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:Nt.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium text-red-200",children:"Error Loading Data"}),Nt.jsx("div",{className:"mt-2 text-sm text-red-300",children:b}),Nt.jsx("div",{className:"mt-4",children:Nt.jsx("button",{onClick:()=>F(!1),className:"bg-red-800 hover:bg-red-700 text-red-200 px-3 py-2 rounded-md text-sm font-medium",children:"Try Again"})})]})]})})}):Nt.jsxs("div",{className:"min-h-screen bg-black text-white font-sans flex",children:[Nt.jsxs("div",{className:"w-80 bg-gray-900 border-r border-gray-700 flex flex-col",children:[Nt.jsxs("div",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:[Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("h2",{className:"text-lg font-semibold text-white",children:"FIGHT RESULTS"}),Nt.jsxs("div",{className:"flex items-center space-x-2",children:[Nt.jsx("button",{onClick:()=>F(!0),disabled:y,className:"text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 px-2 py-1 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:""}),Nt.jsx("div",{className:"w-2 h-2 rounded-full "+(M?"bg-green-500":"bg-red-500")})]})]}),Nt.jsxs("div",{className:"text-xs text-gray-400 mt-1 flex justify-between items-center",children:[Nt.jsxs("div",{className:"flex items-center space-x-2",children:[Nt.jsx("span",{children:M?"Live Updates":"Online"}),y&&Nt.jsxs("div",{className:"flex items-center",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border border-gray-500 border-t-transparent"}),Nt.jsx("span",{className:"ml-1",children:"Updating..."})]})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsxs("div",{className:"text-green-400 font-medium",children:["Total Comm: ",(V=p.reduce((e,t)=>t.details&&t.result1&&"draw"!==t.result1?e+.055*(t.details.redTotalBetAmount+t.details.blueTotalBetAmount+(t.details.drawTotalBetAmount||0)):e,0),new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(V))]}),Nt.jsxs("div",{className:"text-xs text-blue-400 font-mono",children:[" ",H()]}),E&&Nt.jsxs("div",{className:"text-xs text-gray-500",children:["Updated: ",U(E.toISOString())]})]})]})]}),Nt.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:p.slice(0,300).map((e,t)=>{var n;return Nt.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 border border-gray-700",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-2",children:[Nt.jsxs("div",{className:"text-sm font-medium text-gray-300",children:["Fight #",(null==(n=e.batch)?void 0:n.fightSequence)||e.id]}),Nt.jsx("div",{className:"text-sm font-bold "+("red"===e.result1?"text-red-400":"blue"===e.result1?"text-blue-400":"draw"===e.result1?"text-green-400":"text-gray-400"),children:e.result1?"red"===e.result1?"MERON":"blue"===e.result1?"WALA":e.result1.toUpperCase():"CANCEL"})]}),Nt.jsx("div",{className:"text-xs text-gray-500 mb-1",children:z(e.id)||U(e.createdAt)||"N/A"}),Nt.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[Nt.jsxs("span",{children:["Total: ",e.details?(e.details.redTotalBetAmount+e.details.blueTotalBetAmount+(e.details.drawTotalBetAmount||0)).toLocaleString():"0"]}),e.result1&&"draw"!==e.result1?Nt.jsxs("span",{children:["Comm: ",e.details?(.055*(e.details.redTotalBetAmount+e.details.blueTotalBetAmount+(e.details.drawTotalBetAmount||0))).toFixed(2):"0.00"]}):null]})]},e.id)})}),Nt.jsx("div",{className:"p-4 border-t border-gray-700",children:Nt.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Last updated: ",H()]})})]}),Nt.jsxs("div",{className:"flex-1 flex flex-col",children:[Nt.jsx("div",{className:"bg-gray-900 border-b border-gray-700 px-6 py-4",children:Nt.jsxs("div",{className:"flex justify-between items-center max-w-6xl mx-auto",children:[Nt.jsxs("div",{className:"flex items-center space-x-6",children:[Nt.jsx("div",{className:"text-xl font-bold text-white",children:H()}),Nt.jsx("div",{className:"text-sm text-gray-400",children:(new Date).toLocaleString("en-PH",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).toUpperCase()})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-lg font-bold text-yellow-400",children:"RMI FRIDAY - 90 FIGHTS"}),Nt.jsx("div",{className:"text-xs text-gray-500",children:"DECEMBER 19, 2025 MINIMUM BET 100"})]})]})}),Nt.jsx("div",{className:"p-8",children:Nt.jsx("div",{className:"max-w-4xl mx-auto",children:j?Nt.jsxs("div",{className:"bg-gray-900 rounded-lg p-8 border border-gray-700 mb-8 relative overflow-hidden",children:[Nt.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden rounded-lg",style:{zIndex:5},children:[Nt.jsx("style",{children:`\n                    @keyframes fallCoin1 {\n                      0% {\n                        transform: translateY(-100px) translateX(-120px) rotateX(0deg) rotateZ(0deg) rotateY(0deg);\n                        opacity: 1;\n                      }\n                      100% {\n                        transform: translateY(calc(100% - 0px)) translateX(-80px) rotateX(900deg) rotateZ(${360*Math.random()}deg) rotateY(${360*Math.random()}deg);\n                        opacity: 1;\n                      }\n                    }\n                    @keyframes fallCoin2 {\n                      0% {\n                        transform: translateY(-100px) translateX(-40px) rotateX(0deg) rotateZ(0deg) rotateY(0deg);\n                        opacity: 1;\n                      }\n                      100% {\n                        transform: translateY(calc(100% - 0px)) translateX(-10px) rotateX(900deg) rotateZ(${360*Math.random()}deg) rotateY(${360*Math.random()}deg);\n                        opacity: 1;\n                      }\n                    }\n                    @keyframes fallCoin3 {\n                      0% {\n                        transform: translateY(-100px) translateX(40px) rotateX(0deg) rotateZ(0deg) rotateY(0deg);\n                        opacity: 1;\n                      }\n                      100% {\n                        transform: translateY(calc(100% - 0px)) translateX(40px) rotateX(900deg) rotateZ(${360*Math.random()}deg) rotateY(${360*Math.random()}deg);\n                        opacity: 1;\n                      }\n                    }\n                    @keyframes fallCoin4 {\n                      0% {\n                        transform: translateY(-100px) translateX(120px) rotateX(0deg) rotateZ(0deg) rotateY(0deg);\n                        opacity: 1;\n                      }\n                      100% {\n                        transform: translateY(calc(100% - 0px)) translateX(80px) rotateX(900deg) rotateZ(${360*Math.random()}deg) rotateY(${360*Math.random()}deg);\n                        opacity: 1;\n                      }\n                    }\n                    .falling-coin {\n                      position: absolute;\n                      font-size: 2.8rem;\n                      left: 50%;\n                      margin-left: -1.4rem;\n                      top: 0;\n                      text-shadow: 0 0 12px rgba(255, 215, 0, 0.6);\n                      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4));\n                    }\n                    .falling-coin.coin-1 {\n                      animation: fallCoin1 1.8s ease-in forwards;\n                    }\n                    .falling-coin.coin-2 {\n                      animation: fallCoin2 1.8s ease-in forwards;\n                    }\n                    .falling-coin.coin-3 {\n                      animation: fallCoin3 1.8s ease-in forwards;\n                    }\n                    .falling-coin.coin-4 {\n                      animation: fallCoin4 1.8s ease-in forwards;\n                    }\n                    .coins-pile {\n                      position: absolute;\n                      bottom: 0;\n                      left: 50%;\n                      width: 300px;\n                      height: 160px;\n                      margin-left: -150px;\n                      display: block;\n                    }\n                    .coin-settled {\n                      position: absolute;\n                      font-size: 2.8rem;\n                      opacity: 0.95;\n                      text-shadow: 0 0 8px rgba(255, 215, 0, 0.3);\n                      filter: drop-shadow(2px 2px 5px rgba(0, 0, 0, 0.6));\n                      animation: none !important;\n                      transform: none !important;\n                    }\n                  `}),R.map((e,t)=>{const n=t%4;return!e.animationStarted&&Nt.jsx("div",{className:"falling-coin coin-"+(n%4+1),style:{animationDelay:t%4*.15+"s",zIndex:20},children:""},e.id)}),Nt.jsx("div",{className:"coins-pile",children:R.map((e,t)=>{if(!e.animationStarted)return null;const n=260*Math.random(),r=32*Math.floor(5*Math.random()),a=360*Math.random(),i=180*Math.random()-90,s=180*Math.random();return Nt.jsx("div",{className:"coin-settled",style:{left:`${n}px`,bottom:`${r}px`,transform:`perspective(600px) rotateZ(${a}deg) rotateX(${i}deg) rotateY(${s}deg)`,zIndex:t,position:"absolute"},children:""},`settled-${e.id}`)})})]}),Nt.jsxs("div",{className:"relative z-10 mb-8 flex justify-center items-center h-40",children:[Nt.jsx("style",{children:"\n                    @keyframes roosterLeftFight {\n                      0% { \n                        transform: translateX(-80px) translateY(0) scaleX(-1) rotateZ(0deg);\n                        opacity: 1;\n                      }\n                      15% { \n                        transform: translateX(-40px) translateY(-20px) scaleX(-1) rotateZ(-15deg);\n                        opacity: 1;\n                      }\n                      30% { \n                        transform: translateX(0px) translateY(0px) scaleX(-1) rotateZ(-25deg);\n                        opacity: 1;\n                      }\n                      45% { \n                        transform: translateX(-20px) translateY(-30px) scaleX(-1) rotateZ(-20deg);\n                        opacity: 1;\n                      }\n                      60% { \n                        transform: translateX(-60px) translateY(-15px) scaleX(-1) rotateZ(-10deg);\n                        opacity: 1;\n                      }\n                      75% { \n                        transform: translateX(-40px) translateY(0px) scaleX(-1) rotateZ(-5deg);\n                        opacity: 1;\n                      }\n                      100% { \n                        transform: translateX(-80px) translateY(0) scaleX(-1) rotateZ(0deg);\n                        opacity: 1;\n                      }\n                    }\n                    @keyframes roosterRightFight {\n                      0% { \n                        transform: translateX(80px) translateY(0) rotateZ(0deg);\n                        opacity: 1;\n                      }\n                      15% { \n                        transform: translateX(40px) translateY(-20px) rotateZ(15deg);\n                        opacity: 1;\n                      }\n                      30% { \n                        transform: translateX(0px) translateY(0px) rotateZ(25deg);\n                        opacity: 1;\n                      }\n                      45% { \n                        transform: translateX(20px) translateY(-30px) rotateZ(20deg);\n                        opacity: 1;\n                      }\n                      60% { \n                        transform: translateX(60px) translateY(-15px) rotateZ(10deg);\n                        opacity: 1;\n                      }\n                      75% { \n                        transform: translateX(40px) translateY(0px) rotateZ(5deg);\n                        opacity: 1;\n                      }\n                      100% { \n                        transform: translateX(80px) translateY(0) rotateZ(0deg);\n                        opacity: 1;\n                      }\n                    }\n                    @keyframes wingFlap {\n                      0%, 100% { opacity: 1; }\n                      20% { opacity: 0.4; }\n                      40% { opacity: 1; }\n                      60% { opacity: 0.4; }\n                      80% { opacity: 1; }\n                    }\n                    .rooster-left {\n                      animation: roosterLeftFight 2s ease-in-out infinite, wingFlap 2s ease-in-out infinite;\n                      font-size: 6rem;\n                      filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.3));\n                    }\n                    .rooster-right {\n                      animation: roosterRightFight 2s ease-in-out infinite, wingFlap 2s ease-in-out infinite;\n                      font-size: 6rem;\n                      filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));\n                    }\n                    .fight-label {\n                      font-size: 1.2rem;\n                      font-weight: bold;\n                      color: #ef4444;\n                      text-shadow: 0 0 10px rgba(239, 68, 68, 0.6);\n                      position: absolute;\n                      top: 0;\n                    }\n                  "}),Nt.jsx("div",{className:"fight-label",children:" LIVE FIGHT "}),Nt.jsx("div",{className:"rooster-left",children:""}),Nt.jsx("div",{className:"rooster-right",children:""})]}),Nt.jsxs("div",{className:"text-center mb-8 relative z-10",children:[Nt.jsx("div",{className:"text-6xl font-bold text-white mb-4",children:"CURRENT FIGHT"}),Nt.jsx("div",{className:"text-2xl text-gray-300 mb-4",children:"completed"===j.status?`RESULT: ${("red"===j.result1?"MERON":"blue"===j.result1?"WALA":null==(e=j.result1)?void 0:e.toUpperCase())||"PENDING"}`:"LIVE BETTING"}),Nt.jsx("div",{className:"text-xl font-bold "+("started"===j.status?"text-green-400":"text-gray-400"),children:"started"===j.status?"BETTING IS OPEN":"BETTING CLOSED"})]}),Nt.jsxs("div",{className:"grid grid-cols-3 gap-8 mb-8 relative z-10",children:[Nt.jsxs("div",{className:"bg-red-600 hover:bg-red-500 rounded-lg p-6 text-center cursor-pointer transition-all duration-300 border-4 border-red-500 transform hover:scale-105",children:[Nt.jsx("div",{className:"text-3xl font-bold text-white mb-4",children:"MERON"}),Nt.jsx("div",{className:"text-2xl text-red-100 font-semibold mb-2",children:(null==(t=j.details)?void 0:t.formattedRedOdds)||"1.47"}),Nt.jsxs("div",{className:"text-lg text-red-200",children:["",(null==(r=null==(n=j.details)?void 0:n.redTotalBetAmount)?void 0:r.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"bg-green-600 hover:bg-green-500 rounded-lg p-6 text-center cursor-pointer transition-all duration-300 border-4 border-green-500 transform hover:scale-105",children:[Nt.jsx("div",{className:"text-3xl font-bold text-white mb-4",children:"DRAW"}),Nt.jsx("div",{className:"text-2xl text-green-100 font-semibold mb-2",children:(null==(a=j.details)?void 0:a.formattedDrawOdds)||"8.00"}),Nt.jsxs("div",{className:"text-lg text-green-200",children:["",(null==(s=null==(i=j.details)?void 0:i.drawTotalBetAmount)?void 0:s.toLocaleString())||"0"]})]}),Nt.jsxs("div",{className:"bg-blue-600 hover:bg-blue-500 rounded-lg p-6 text-center cursor-pointer transition-all duration-300 border-4 border-blue-500 transform hover:scale-105",children:[Nt.jsx("div",{className:"text-3xl font-bold text-white mb-4",children:"WALA"}),Nt.jsx("div",{className:"text-2xl text-blue-100 font-semibold mb-2",children:(null==(o=j.details)?void 0:o.formattedBlueOdds)||"2.63"}),Nt.jsxs("div",{className:"text-lg text-blue-200",children:["",(null==(u=null==(d=j.details)?void 0:d.blueTotalBetAmount)?void 0:u.toLocaleString())||"0"]})]})]}),Nt.jsxs("div",{className:"text-center relative z-10",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"TOTAL BETS"}),Nt.jsxs("div",{className:"text-2xl font-bold text-white",children:["",j.details?(j.details.redTotalBetAmount+j.details.blueTotalBetAmount+(j.details.drawTotalBetAmount||0)).toLocaleString():"0"]})]})]}):Nt.jsx("div",{className:"bg-gray-900 rounded-lg p-8 border border-gray-700 mb-8",children:Nt.jsxs("div",{className:"text-center text-gray-400",children:[Nt.jsx("div",{className:"text-2xl mb-4",children:"No Active Fight"}),Nt.jsx("div",{className:"text-lg",children:"Waiting for next fight to begin..."})]})})})}),Nt.jsx("div",{className:"p-8",children:Nt.jsx("div",{className:"max-w-4xl mx-auto",children:Nt.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700",children:[Nt.jsxs("div",{className:"text-center mb-6",children:[Nt.jsx("h3",{className:"text-xl font-bold text-white",children:"FIGHT HISTORY PATTERN"}),Nt.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Recent fight results"})]}),Nt.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 max-w-5xl mx-auto",children:[Nt.jsxs("div",{className:"text-center mb-4",children:[Nt.jsx("h4",{className:"text-lg font-semibold text-white",children:"REGLA PATTERN"}),Nt.jsx("div",{className:"text-xs text-gray-400",children:"Each column shows consecutive wins of the same result"})]}),Nt.jsx("div",{className:"relative max-w-6xl mx-auto",children:(()=>{const e=[...p].sort((e,t)=>{var n,r;return((null==(n=e.batch)?void 0:n.fightSequence)||e.id||0)-((null==(r=t.batch)?void 0:r.fightSequence)||t.id||0)}).slice(0,360);return Nt.jsx("div",{className:"flex justify-center gap-1 overflow-x-auto pb-4",children:Array.from({length:60},(t,n)=>Nt.jsxs("div",{className:"flex flex-col gap-1",children:[n%10==0&&Nt.jsxs("div",{className:"text-center text-xs text-gray-500 mb-1",children:[6*n+1,"-",Math.min(6*(n+1),e.length)]}),Array.from({length:6},(t,r)=>{var a;const i=e[6*n+r],s=null==i?void 0:i.result1,o="meron"===s||"red"===s?"meron":"wala"===s||"blue"===s?"wala":"draw"===s?"draw":"cancel",l=(null==(a=null==i?void 0:i.batch)?void 0:a.fightSequence)||(null==i?void 0:i.id),c="meron"===o,d="wala"===o,u="draw"===o;return Nt.jsx("div",{className:"w-6 h-6 rounded-full border flex items-center justify-center text-xs font-bold "+(i?c?"bg-red-600 border-red-500 text-white":d?"bg-blue-600 border-blue-500 text-white":u?"bg-green-600 border-green-500 text-white":"bg-gray-600 border-gray-500 text-gray-300":"border-gray-700 bg-gray-800"),title:i?`Fight ${l}: ${o.toUpperCase()}`:"No result",children:i?l>99?"..":l:""},`${n}-${r}`)})]},n))})})()}),Nt.jsxs("div",{className:"mt-4 grid grid-cols-4 gap-4 text-center text-sm",children:[Nt.jsxs("div",{className:"bg-red-900 bg-opacity-50 rounded p-2",children:[Nt.jsx("div",{className:"text-red-300 font-bold text-lg",children:p.slice(0,100).filter(e=>"meron"===e.result1||"red"===e.result1).length}),Nt.jsx("div",{className:"text-red-400 text-xs",children:"Meron"})]}),Nt.jsxs("div",{className:"bg-blue-900 bg-opacity-50 rounded p-2",children:[Nt.jsx("div",{className:"text-blue-300 font-bold text-lg",children:p.slice(0,100).filter(e=>"wala"===e.result1||"blue"===e.result1).length}),Nt.jsx("div",{className:"text-blue-400 text-xs",children:"Wala"})]}),Nt.jsxs("div",{className:"bg-green-900 bg-opacity-50 rounded p-2",children:[Nt.jsx("div",{className:"text-green-300 font-bold text-lg",children:p.slice(0,100).filter(e=>"draw"===e.result1).length}),Nt.jsx("div",{className:"text-green-400 text-xs",children:"Draw"})]}),Nt.jsxs("div",{className:"bg-gray-900 bg-opacity-50 rounded p-2",children:[Nt.jsx("div",{className:"text-gray-300 font-bold text-lg",children:p.slice(0,100).filter(e=>!e.result1||"cancel"===e.result1).length}),Nt.jsx("div",{className:"text-gray-400 text-xs",children:"Cancel"})]})]}),Nt.jsx("div",{className:"mt-4 text-center text-xs text-gray-400",children:Nt.jsxs("div",{className:"flex justify-center space-x-4",children:[Nt.jsxs("span",{children:[" Meron Streak: ",G(p,"meron","red")]}),Nt.jsxs("span",{children:[" Wala Streak: ",G(p,"wala","blue")]}),Nt.jsxs("span",{children:[" Draw Streak: ",G(p,"draw")]})]})})]})]})})}),Nt.jsx("div",{className:"text-center py-4 text-sm text-gray-500 border-t border-gray-800",children:"Payout less than 1.40 shall be canceled  Live updates every few seconds"})]}),Nt.jsx("div",{className:"fixed bottom-6 right-6",children:Nt.jsxs("button",{onClick:F,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 shadow-lg text-sm font-medium",children:[Nt.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Nt.jsx("span",{children:"REFRESH"})]})})]});var V};function mte(){var e;const{user:t,settings:n}=f.useContext($c),r=zc(),[a,i]=f.useState([]),[s,o]=f.useState(!0),[d,u]=f.useState(null),[p,m]=f.useState(null),[g,x]=f.useState(!1),[y,v]=f.useState(!1),[b,w]=f.useState({username:"",password:""}),[N,S]=f.useState(!1),[j,_]=f.useState(!1),A="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),C=A?"#0f172a":"#f8fafc",k=["admin","super_admin"].includes(null==t?void 0:t.role),E=()=>h(null,null,function*(){var e,t;x(!0),u(null);try{const e=localStorage.getItem("token"),t=yield pt.get(`${r}/api/betting-data/export`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&(i(t.data.data||[]),m(new Date(t.data.lastFetch)),_(t.data.isDemo||!1))}catch(n){try{const e=localStorage.getItem("token"),t=yield pt.get(`${r}/api/external-betting/teller-bets`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&(i(t.data.data||[]),m(new Date(t.data.lastFetch)),_(t.data.isDemo||!1),t.data.message&&console.log(t.data.message))}catch(a){u((null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.error)||"Failed to fetch betting data")}}finally{x(!1)}});if(f.useEffect(()=>{if(k){E();const e=setInterval(E,3e5);return()=>clearInterval(e)}},[k]),!k)return Nt.jsx("div",{className:"p-4 text-center",children:Nt.jsx("p",{className:"text-red-600",children:"Access denied. Only admins can view this page."})});const T=a.reduce((e,t)=>e+(t.totalBet||0),0);return Nt.jsxs("div",{className:"p-4 space-y-4",style:{background:C},children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("h1",{className:"text-2xl font-semibold",children:" Teller Betting Data"}),j&&Nt.jsx("span",{className:"px-3 py-1 text-xs font-semibold bg-amber-100 text-amber-800 rounded-full",children:"DEMO DATA"})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:E,disabled:g,className:"px-4 py-2 rounded text-sm font-medium flex items-center gap-2 "+(g?"bg-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[Nt.jsx(Ae,{size:16,className:g?"animate-spin":""}),g?"Refreshing...":"Refresh"]}),Nt.jsx("button",{onClick:()=>v(!0),className:"px-4 py-2 rounded text-sm font-medium bg-purple-600 text-white hover:bg-purple-700",children:" Credentials"})]})]}),d&&Nt.jsxs("div",{className:"p-4 rounded flex gap-2 "+(A?"bg-red-900 text-red-100":"bg-red-50 text-red-800"),children:[Nt.jsx(M,{size:20,className:"flex-shrink-0"}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold",children:"Error"}),Nt.jsx("p",{className:"text-sm",children:d})]})]}),j&&Nt.jsxs("div",{className:"p-4 rounded flex gap-2 "+(A?"bg-blue-900 text-blue-100":"bg-blue-50 text-blue-800"),children:[Nt.jsx(M,{size:20,className:"flex-shrink-0"}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold",children:"Showing Demo Data"}),Nt.jsx("p",{className:"text-sm",children:"The GTArena website couldn't be accessed. This is demo data to show you how the system works. Real data will display once your GTArena credentials are verified. Check the server logs for details on why the connection failed."})]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Nt.jsxs("div",{className:"p-4 rounded border "+(A?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("p",{className:"text-sm text-gray-500",children:"Total Betting"}),Nt.jsx("p",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(T)})]}),Nt.jsxs("div",{className:"p-4 rounded border "+(A?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("p",{className:"text-sm text-gray-500",children:"Total Tellers"}),Nt.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),Nt.jsxs("div",{className:"p-4 rounded border "+(A?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("p",{className:"text-sm text-gray-500",children:"Average Bet"}),Nt.jsx("p",{className:"text-2xl font-bold",children:new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(a.length>0?T/a.length:0)})]})]}),p&&Nt.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",new Date(p).toLocaleString()]}),s&&Nt.jsx("div",{className:"text-center py-8",children:"Loading betting data..."}),!s&&a.length>0&&Nt.jsx("div",{className:"rounded border overflow-x-auto "+(A?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:""+(A?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Username"}),Nt.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Total Bet"}),Nt.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"M/W Bet %"}),Nt.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Percentage"})]})}),Nt.jsx("tbody",{children:a.sort((e,t)=>(t.totalBet||0)-(e.totalBet||0)).map((e,t)=>Nt.jsxs("tr",{className:"border-t "+(A?"border-gray-700 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50"),children:[Nt.jsx("td",{className:"px-4 py-3",children:e.username}),Nt.jsx("td",{className:"px-4 py-3 text-right font-semibold",children:new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(e.totalBet||0)}),Nt.jsxs("td",{className:"px-4 py-3 text-right text-blue-600 font-semibold",children:[(e.mwBetPercent||0).toFixed(1),"%"]}),Nt.jsxs("td",{className:"px-4 py-3 text-right",children:[((e.totalBet||0)/T*100||0).toFixed(1),"%"]})]},t))})]})}),!s&&0===a.length&&!d&&Nt.jsx("div",{className:"p-8 rounded text-center "+(A?"bg-gray-800":"bg-gray-50"),children:Nt.jsx("p",{className:"text-gray-500",children:'No betting data available. Click "Refresh" to fetch data.'})}),y&&Nt.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded max-w-md w-full "+(A?"bg-gray-800":"bg-white"),children:[Nt.jsx("h2",{className:"text-lg font-bold mb-4",children:"GTArena Credentials"}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),Nt.jsx("input",{type:"text",value:b.username,onChange:e=>w(c(l({},b),{username:e.target.value})),className:"w-full px-3 py-2 rounded border "+(A?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),placeholder:"Enter GTArena username"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Password"}),Nt.jsx("input",{type:"password",value:b.password,onChange:e=>w(c(l({},b),{password:e.target.value})),className:"w-full px-3 py-2 rounded border "+(A?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),placeholder:"Enter GTArena password"})]}),Nt.jsx("p",{className:"text-xs text-gray-500",children:" These credentials are stored securely on the server and used only to fetch betting data."})]}),Nt.jsxs("div",{className:"flex gap-2 mt-6",children:[Nt.jsx("button",{onClick:()=>v(!1),className:"flex-1 px-4 py-2 rounded font-medium "+(A?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;if(b.username&&b.password){S(!0);try{const e=localStorage.getItem("token");yield pt.post(`${r}/api/external-betting/set-credentials`,b,{headers:{Authorization:`Bearer ${e}`}}),v(!1),u(null),w({username:"",password:""}),setTimeout(E,500)}catch(n){u((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.error)||"Failed to set credentials")}finally{S(!1)}}else u("Username and password required")}),disabled:N,className:"flex-1 px-4 py-2 rounded font-medium bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:N?"Saving...":"Save & Fetch"})]})]})})]})}function gte(){var e;const{user:t,settings:n}=f.useContext($c),r=zc(),[a,i]=f.useState([]),[s,o]=f.useState(!0),[d,u]=f.useState(null),[p,m]=f.useState(!1),[g,x]=f.useState({username:"",totalBet:"",mwBetPercent:""}),[y,v]=f.useState(null),[b,w]=f.useState({}),N="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),S=N?"#0f172a":"#f8fafc",j=["admin","super_admin"].includes(null==t?void 0:t.role),_=()=>h(null,null,function*(){var e,t;o(!0);try{const e=localStorage.getItem("token"),t=yield pt.get(`${r}/api/betting-data/list`,{headers:{Authorization:`Bearer ${e}`}});i(t.data.data||[]),u(null)}catch(n){u((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.error)||"Failed to fetch betting data")}finally{o(!1)}});f.useEffect(()=>{j&&_()},[j]);return j?Nt.jsxs("div",{className:"p-4 space-y-4",style:{background:S},children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("h1",{className:"text-2xl font-semibold",children:" Manage Betting Data"}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>{const e=[["Username","Total Bet","M/W Bet %"],...a.map(e=>[e.username,e.totalBet,e.mwBetPercent])].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`betting-data-${(new Date).toISOString().split("T")[0]}.csv`,r.click()},className:"px-4 py-2 rounded text-sm font-medium bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[Nt.jsx(E,{size:16}),"Export CSV"]}),Nt.jsxs("button",{onClick:()=>m(!p),className:"px-4 py-2 rounded text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[Nt.jsx(le,{size:16}),"Add Entry"]})]})]}),d&&Nt.jsx("div",{className:"p-4 rounded "+(N?"bg-red-900 text-red-100":"bg-red-50 text-red-800"),children:Nt.jsx("p",{className:"text-sm",children:d})}),p&&Nt.jsxs("div",{className:"p-4 rounded border space-y-3 "+(N?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("h3",{className:"font-semibold",children:"Add New Entry"}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[Nt.jsx("input",{type:"text",placeholder:"Username",value:g.username,onChange:e=>x(c(l({},g),{username:e.target.value})),className:"px-3 py-2 rounded border text-sm "+(N?"bg-gray-700 border-gray-600":"bg-white border-gray-300")}),Nt.jsx("input",{type:"number",placeholder:"Total Bet",value:g.totalBet,onChange:e=>x(c(l({},g),{totalBet:e.target.value})),className:"px-3 py-2 rounded border text-sm "+(N?"bg-gray-700 border-gray-600":"bg-white border-gray-300")}),Nt.jsx("input",{type:"number",placeholder:"M/W Bet %",step:"0.1",value:g.mwBetPercent,onChange:e=>x(c(l({},g),{mwBetPercent:e.target.value})),className:"px-3 py-2 rounded border text-sm "+(N?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;if(g.username&&g.totalBet&&g.mwBetPercent)try{const e=localStorage.getItem("token");yield pt.post(`${r}/api/betting-data/add`,g,{headers:{Authorization:`Bearer ${e}`}}),x({username:"",totalBet:"",mwBetPercent:""}),m(!1),u(null),_()}catch(n){u((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.error)||"Failed to add entry")}else u("All fields required")}),className:"px-4 py-2 rounded text-sm font-medium bg-green-600 text-white hover:bg-green-700",children:"Save"}),Nt.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 rounded text-sm font-medium "+(N?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Cancel"})]})]}),s&&Nt.jsx("div",{className:"text-center py-8",children:"Loading betting data..."}),!s&&a.length>0&&Nt.jsx("div",{className:"rounded border overflow-x-auto "+(N?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:""+(N?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Username"}),Nt.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Total Bet"}),Nt.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"M/W Bet %"}),Nt.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Actions"})]})}),Nt.jsx("tbody",{children:a.map(e=>Nt.jsx("tr",{className:"border-t "+(N?"border-gray-700 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50"),children:y===e._id?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("td",{className:"px-4 py-3",children:Nt.jsx("input",{type:"text",value:b.username||"",onChange:e=>w(c(l({},b),{username:e.target.value})),className:"w-full px-2 py-1 rounded border text-sm "+(N?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})}),Nt.jsx("td",{className:"px-4 py-3 text-right",children:Nt.jsx("input",{type:"number",value:b.totalBet||"",onChange:e=>w(c(l({},b),{totalBet:e.target.value})),className:"w-full px-2 py-1 rounded border text-sm text-right "+(N?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})}),Nt.jsx("td",{className:"px-4 py-3 text-right",children:Nt.jsx("input",{type:"number",step:"0.1",value:b.mwBetPercent||"",onChange:e=>w(c(l({},b),{mwBetPercent:e.target.value})),className:"w-full px-2 py-1 rounded border text-sm text-right "+(N?"bg-gray-700 border-gray-600":"bg-white border-gray-300")})}),Nt.jsxs("td",{className:"px-4 py-3 text-center space-x-2",children:[Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){var e,n;try{const e=localStorage.getItem("token");yield pt.put(`${r}/api/betting-data/${t}`,b,{headers:{Authorization:`Bearer ${e}`}}),v(null),w({}),u(null),_()}catch(a){u((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.error)||"Failed to update entry")}});var t},className:"px-3 py-1 rounded text-xs bg-green-600 text-white hover:bg-green-700",children:"Save"}),Nt.jsx("button",{onClick:()=>v(null),className:"px-3 py-1 rounded text-xs "+(N?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Cancel"})]})]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("td",{className:"px-4 py-3",children:e.username}),Nt.jsx("td",{className:"px-4 py-3 text-right font-semibold",children:new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(e.totalBet||0)}),Nt.jsxs("td",{className:"px-4 py-3 text-right text-blue-600 font-semibold",children:[(e.mwBetPercent||0).toFixed(1),"%"]}),Nt.jsxs("td",{className:"px-4 py-3 text-center space-x-2",children:[Nt.jsx("button",{onClick:()=>{v(e._id),w(e)},className:"px-3 py-1 rounded text-xs bg-blue-600 text-white hover:bg-blue-700",children:"Edit"}),Nt.jsxs("button",{onClick:()=>{return t=e._id,h(null,null,function*(){var e,n;if(confirm("Are you sure you want to delete this entry?"))try{const e=localStorage.getItem("token");yield pt.delete(`${r}/api/betting-data/${t}`,{headers:{Authorization:`Bearer ${e}`}}),u(null),_()}catch(a){u((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.error)||"Failed to delete entry")}});var t},className:"px-3 py-1 rounded text-xs bg-red-600 text-white hover:bg-red-700 inline-flex items-center gap-1",children:[Nt.jsx(R,{size:12}),"Delete"]})]})]})},e._id))})]})}),!s&&0===a.length&&Nt.jsx("div",{className:"p-8 rounded text-center "+(N?"bg-gray-800":"bg-gray-50"),children:Nt.jsx("p",{className:"text-gray-500",children:'No betting data. Click "Add Entry" to get started.'})})]}):Nt.jsx("div",{className:"p-4 text-center",children:Nt.jsx("p",{className:"text-red-600",children:"Access denied. Only admins can manage betting data."})})}const fte=()=>{var e,t,n,r,a,i;const{isDarkMode:s}=f.useContext($c),{addToast:o}=Kc(),l=zc(),[c,d]=f.useState([]),[u,p]=f.useState(!1),[m,g]=f.useState(null),[x,y]=f.useState("week"),[v,b]=f.useState("all"),[w,N]=f.useState(null);f.useEffect(()=>{S()},[x,v]);const S=()=>h(null,null,function*(){var e,t;p(!0),g(null);try{const e=localStorage.getItem("authToken"),t=yield pt.get(`${l}/api/betting-data/list`,{headers:{Authorization:`Bearer ${e}`}});if(t.data.success){const e=t.data.data;d(e),j(e)}}catch(n){const r=(null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.error)||"Failed to fetch analytics";g(r),o(r,"error")}finally{p(!1)}}),j=e=>{if(!e||0===e.length)return void N(null);let t=e;"all"!==v&&(t=e.filter(e=>e.username===v));const n=t.reduce((e,t)=>e+(t.totalBet||0),0),r=t.length>0?(t.reduce((e,t)=>e+(t.mwBetPercent||0),0)/t.length).toFixed(2):0,a=t.length>0?(n/t.length).toFixed(0):0,i=t.length>0?t.reduce((e,t)=>t.totalBet>e.totalBet?t:e,t[0]):null,s=t.length>0?t.reduce((e,t)=>t.totalBet<e.totalBet?t:e,t[0]):null,o=[...e].sort((e,t)=>t.totalBet-e.totalBet).slice(0,5),l=[...e].sort((e,t)=>t.mwBetPercent-e.mwBetPercent).slice(0,5);N({totalBets:n,avgMWBet:r,avgBetPerTeller:a,highestBetter:i,lowestBetter:s,topPerformers:o,mwBetTrends:l,tellerCount:new Set(e.map(e=>e.username)).size,dataPoints:t.length})},_=({title:e,value:t,icon:n,trend:r,subtitle:a})=>Nt.jsxs("div",{className:"p-6 rounded-lg border "+(s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-start justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:e}),Nt.jsx("p",{className:"text-2xl font-bold mt-2 "+(s?"text-white":"text-gray-900"),children:t}),a&&Nt.jsx("p",{className:"text-xs mt-1 text-gray-500",children:a})]}),Nt.jsx("div",{className:"p-3 rounded-lg "+(s?"bg-gray-700":"bg-gray-100"),children:Nt.jsx(n,{size:24,className:"text-blue-500"})})]}),r&&Nt.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[r>0?Nt.jsx(K,{size:16,className:"text-green-500"}):Nt.jsx(fe,{size:16,className:"text-red-500"}),Nt.jsxs("span",{className:r>0?"text-green-500":"text-red-500",children:[r>0?"+":"",r,"%"]})]})]}),A=({data:e,type:t="topPerformers"})=>Nt.jsxs("div",{className:"p-6 rounded-lg border "+(s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-4 "+(s?"text-white":"text-gray-900"),children:"topPerformers"===t?"Top 5 Performers":"Top 5 by M/W Bet %"}),Nt.jsx("div",{className:"space-y-3",children:e&&e.length>0?e.map((e,t)=>{var n;return Nt.jsxs("div",{className:"p-3 rounded-lg flex items-center justify-between "+(s?"bg-gray-700":"bg-gray-50"),children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm "+(0===t?"bg-yellow-500":1===t?"bg-gray-400":2===t?"bg-orange-600":"bg-blue-500"),children:t+1}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold "+(s?"text-white":"text-gray-900"),children:e.username}),Nt.jsxs("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:["Total: ",(null==(n=e.totalBet)?void 0:n.toLocaleString())||0]})]})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsxs("p",{className:"font-semibold text-blue-500",children:[e.mwBetPercent,"%"]}),Nt.jsx("p",{className:"text-xs text-gray-500",children:"M/W Bet"})]})]},t)}):Nt.jsx("p",{className:s?"text-gray-400":"text-gray-600",children:"No data available"})})]});return Nt.jsxs("div",{className:"min-h-screen p-8 "+(s?"bg-gray-900":"bg-gray-50"),children:[Nt.jsxs("div",{className:"mb-8",children:[Nt.jsx("h1",{className:"text-3xl font-bold "+(s?"text-white":"text-gray-900"),children:"Betting Analytics"}),Nt.jsx("p",{className:s?"text-gray-400":"text-gray-600",children:"Real-time insights and trends in teller betting activity"})]}),Nt.jsx("div",{className:"p-6 rounded-lg border mb-8 "+(s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:Nt.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx(he,{size:18,className:"text-gray-500"}),Nt.jsx("label",{className:"text-sm font-medium "+(s?"text-gray-300":"text-gray-700"),children:"Date Range:"}),Nt.jsxs("select",{value:x,onChange:e=>y(e.target.value),className:"px-3 py-2 rounded-lg border "+(s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:[Nt.jsx("option",{value:"week",children:"This Week"}),Nt.jsx("option",{value:"month",children:"This Month"}),Nt.jsx("option",{value:"all",children:"All Time"})]})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("label",{className:"text-sm font-medium "+(s?"text-gray-300":"text-gray-700"),children:"Teller:"}),Nt.jsxs("select",{value:v,onChange:e=>b(e.target.value),className:"px-3 py-2 rounded-lg border "+(s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:[Nt.jsx("option",{value:"all",children:"All Tellers"}),c&&c.map(e=>Nt.jsx("option",{value:e.username,children:e.username},e.username))]})]}),Nt.jsxs("div",{className:"flex gap-2 ml-auto",children:[Nt.jsx("button",{onClick:S,disabled:u,className:"p-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white disabled:opacity-50",title:"Refresh data",children:Nt.jsx(Ae,{size:18,className:u?"animate-spin":""})}),Nt.jsx("button",{onClick:()=>{if(w)try{let e="Betting Analytics Report\n";e+=`Generated: ${(new Date).toLocaleString()}\n`,e+=`Date Range: ${x}\n`,e+=`Selected Teller: ${"all"===v?"All":v}\n\n`,e+="Key Metrics\n",e+=`Total Bets,${w.totalBets}\n`,e+=`Average M/W Bet %,${w.avgMWBet}%\n`,e+=`Average Bet Per Teller,${w.avgBetPerTeller}\n`,e+=`Total Tellers,${w.tellerCount}\n\n`,e+="Top Performers\n",e+="Username,Total Bet,M/W Bet %\n",w.topPerformers.forEach(t=>{e+=`${t.username},${t.totalBet},${t.mwBetPercent}\n`}),e+="\nTop M/W Bet %\n",e+="Username,Total Bet,M/W Bet %\n",w.mwBetTrends.forEach(t=>{e+=`${t.username},${t.totalBet},${t.mwBetPercent}\n`});const t=new Blob([e],{type:"text/csv"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=`betting-analytics-${(new Date).toISOString().split("T")[0]}.csv`,n.click(),o("Analytics exported successfully","success")}catch(e){o("Failed to export analytics","error")}else o("No data to export","error")},className:"p-2 rounded-lg bg-green-500 hover:bg-green-600 text-white",title:"Export as CSV",children:Nt.jsx(E,{size:18})})]})]})}),m&&Nt.jsxs("div",{className:"mb-8 p-4 rounded-lg bg-red-100 border border-red-300 flex items-gap-2",children:[Nt.jsx(M,{size:20,className:"text-red-600 mt-0.5"}),Nt.jsx("span",{className:"text-red-800",children:m})]}),u&&Nt.jsxs("div",{className:"text-center py-12",children:[Nt.jsx("div",{className:"inline-block animate-spin",children:Nt.jsx(Ae,{size:32,className:"text-blue-500"})}),Nt.jsx("p",{className:"mt-4 "+(s?"text-gray-400":"text-gray-600"),children:"Loading analytics data..."})]}),!u&&w&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[Nt.jsx(_,{title:"Total Bets",value:`${w.totalBets.toLocaleString()}`,icon:K,subtitle:`${w.dataPoints} data points`}),Nt.jsx(_,{title:"Avg M/W Bet %",value:`${w.avgMWBet}%`,icon:X,subtitle:"Across all tellers"}),Nt.jsx(_,{title:"Avg Bet Per Teller",value:`${w.avgBetPerTeller.toLocaleString()}`,icon:W,subtitle:`${w.tellerCount} tellers`}),Nt.jsx(_,{title:"Bet Range",value:`${((null==(e=w.highestBetter)?void 0:e.totalBet)-(null==(t=w.lowestBetter)?void 0:t.totalBet)).toLocaleString()}`,icon:fe,subtitle:`${null==(n=w.lowestBetter)?void 0:n.username} to ${null==(r=w.highestBetter)?void 0:r.username}`})]}),Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[Nt.jsx(A,{data:w.topPerformers,type:"topPerformers"}),Nt.jsx(A,{data:w.mwBetTrends,type:"mwBetTrends"})]}),Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8",children:[Nt.jsxs("div",{className:"p-6 rounded-lg border "+(s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-4 "+(s?"text-white":"text-gray-900"),children:"Highest Bettor"}),w.highestBetter&&Nt.jsxs("div",{className:"p-4 rounded-lg "+(s?"bg-gray-700":"bg-green-50"),children:[Nt.jsx("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:"Username"}),Nt.jsx("p",{className:"text-2xl font-bold "+(s?"text-green-400":"text-green-600"),children:w.highestBetter.username}),Nt.jsxs("p",{className:"text-sm mt-2 "+(s?"text-gray-400":"text-gray-600"),children:["Total Bets: ",null==(a=w.highestBetter.totalBet)?void 0:a.toLocaleString()]}),Nt.jsxs("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:["M/W Bet %: ",w.highestBetter.mwBetPercent,"%"]})]})]}),Nt.jsxs("div",{className:"p-6 rounded-lg border "+(s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-4 "+(s?"text-white":"text-gray-900"),children:"Lowest Bettor"}),w.lowestBetter&&Nt.jsxs("div",{className:"p-4 rounded-lg "+(s?"bg-gray-700":"bg-red-50"),children:[Nt.jsx("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:"Username"}),Nt.jsx("p",{className:"text-2xl font-bold "+(s?"text-red-400":"text-red-600"),children:w.lowestBetter.username}),Nt.jsxs("p",{className:"text-sm mt-2 "+(s?"text-gray-400":"text-gray-600"),children:["Total Bets: ",null==(i=w.lowestBetter.totalBet)?void 0:i.toLocaleString()]}),Nt.jsxs("p",{className:"text-sm "+(s?"text-gray-400":"text-gray-600"),children:["M/W Bet %: ",w.lowestBetter.mwBetPercent,"%"]})]})]})]})]}),!u&&!w&&!m&&Nt.jsxs("div",{className:"text-center py-12",children:[Nt.jsx(X,{size:48,className:"mx-auto text-gray-400 mb-4"}),Nt.jsx("p",{className:s?"text-gray-400":"text-gray-600",children:"No betting data available yet"})]})]})},xte=()=>{const{isDarkMode:e}=f.useContext($c),{addToast:t}=Kc(),n=zc(),[r,a]=f.useState([]),[i,s]=f.useState([]),[o,d]=f.useState([]),[u,p]=f.useState(!1),[m,g]=f.useState(!1),[x,y]=f.useState(!1),[v,b]=f.useState(null),[w,N]=f.useState(null),[S,j]=f.useState({name:"",description:"",region:""}),[_,A]=f.useState({tellerId:"",zoneId:""});f.useEffect(()=>{C()},[]);const C=()=>h(null,null,function*(){var e,r;p(!0);try{const e={Authorization:`Bearer ${localStorage.getItem("authToken")}`},t=yield pt.get(`${n}/api/teller-zones/list`,{headers:e});t.data.success&&a(t.data.data);const r=yield pt.get(`${n}/api/users/tellers`,{headers:e});r.data.success&&s(r.data.data);const i=yield pt.get(`${n}/api/betting-data/list`,{headers:e});i.data.success&&d(i.data.data)}catch(i){const n=(null==(r=null==(e=i.response)?void 0:e.data)?void 0:r.error)||"Failed to fetch data";t(n,"error")}finally{p(!1)}}),M=({zone:i})=>{const s=(e=>{if(!e.assignedTellers||0===e.assignedTellers.length)return{totalBets:0,avgMWBet:0,tellerCount:0};const t=o.filter(t=>e.assignedTellers.includes(t.username));return{totalBets:t.reduce((e,t)=>e+(t.totalBet||0),0),avgMWBet:t.length>0?(t.reduce((e,t)=>e+(t.mwBetPercent||0),0)/t.length).toFixed(2):0,tellerCount:e.assignedTellers.length}})(i);return Nt.jsxs("div",{className:`p-6 rounded-lg border ${e?"bg-gray-800 border-gray-700 hover:border-blue-500":"bg-white border-gray-200 hover:border-blue-500"} transition-colors`,children:[Nt.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"p-2 rounded-lg bg-blue-500 bg-opacity-20",children:Nt.jsx(te,{size:20,className:"text-blue-500"})}),Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"font-semibold "+(e?"text-white":"text-gray-900"),children:i.name}),Nt.jsx("p",{className:"text-sm "+(e?"text-gray-400":"text-gray-600"),children:i.region})]})]}),Nt.jsx("button",{onClick:()=>{return e=i._id,h(null,null,function*(){var i,s;if(window.confirm("Are you sure you want to delete this zone?"))try{const i=localStorage.getItem("authToken");(yield pt.delete(`${n}/api/teller-zones/${e}`,{headers:{Authorization:`Bearer ${i}`}})).data.success&&(a(r.filter(t=>t._id!==e)),t("Zone deleted successfully","success"))}catch(o){t((null==(s=null==(i=o.response)?void 0:i.data)?void 0:s.error)||"Failed to delete zone","error")}});var e},className:"p-2 rounded-lg hover:bg-red-500 hover:bg-opacity-20 text-red-500",title:"Delete zone",children:Nt.jsx(R,{size:18})})]}),i.description&&Nt.jsx("p",{className:"text-sm mb-4 "+(e?"text-gray-400":"text-gray-600"),children:i.description}),Nt.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4 pb-4 border-b border-gray-700",children:[Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-xs text-gray-500",children:"Total Bets"}),Nt.jsxs("p",{className:"font-bold text-green-500",children:["",s.totalBets.toLocaleString()]})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-xs text-gray-500",children:"Avg M/W %"}),Nt.jsxs("p",{className:"font-bold text-blue-500",children:[s.avgMWBet,"%"]})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("p",{className:"text-xs text-gray-500",children:"Tellers"}),Nt.jsx("p",{className:"font-bold text-purple-500",children:s.tellerCount})]})]}),i.assignedTellers&&i.assignedTellers.length>0&&Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm font-semibold mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Assigned Tellers:"}),Nt.jsx("div",{className:"flex flex-wrap gap-2",children:i.assignedTellers.map((e,t)=>Nt.jsx("span",{className:"px-3 py-1 rounded-full text-sm bg-blue-500 bg-opacity-20 text-blue-500",children:e},t))})]})]})};return Nt.jsxs("div",{className:"min-h-screen p-8 "+(e?"bg-gray-900":"bg-gray-50"),children:[Nt.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold "+(e?"text-white":"text-gray-900"),children:"Advanced Teller Assignment"}),Nt.jsx("p",{className:e?"text-gray-400":"text-gray-600",children:"Manage zones and assign tellers for regional performance tracking"})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white flex items-center gap-2",children:[Nt.jsx(le,{size:18}),"Add Zone"]}),Nt.jsxs("button",{onClick:()=>y(!0),className:"px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white flex items-center gap-2",children:[Nt.jsx(U,{size:18}),"Assign Teller"]})]})]}),m&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-lg w-full max-w-md "+(e?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-bold "+(e?"text-white":"text-gray-900"),children:"Create New Zone"}),Nt.jsx("button",{onClick:()=>g(!1),className:"p-1 hover:bg-gray-700 rounded",children:Nt.jsx(ce,{size:20})})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Zone Name *"}),Nt.jsx("input",{type:"text",value:S.name,onChange:e=>j(c(l({},S),{name:e.target.value})),placeholder:"e.g., Metro Manila North",className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Region *"}),Nt.jsx("input",{type:"text",value:S.region,onChange:e=>j(c(l({},S),{region:e.target.value})),placeholder:"e.g., Luzon",className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Description"}),Nt.jsx("textarea",{value:S.description,onChange:e=>j(c(l({},S),{description:e.target.value})),placeholder:"Additional details about this zone",rows:"3",className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("div",{className:"flex gap-3 pt-4",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,i;if(S.name.trim()&&S.region.trim())try{const e=localStorage.getItem("authToken"),i=yield pt.post(`${n}/api/teller-zones/create`,S,{headers:{Authorization:`Bearer ${e}`}});i.data.success&&(a([...r,i.data.data]),j({name:"",description:"",region:""}),g(!1),t("Zone created successfully","success"))}catch(s){t((null==(i=null==(e=s.response)?void 0:e.data)?void 0:i.error)||"Failed to create zone","error")}else t("Zone name and region are required","error")}),className:"flex-1 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center gap-2",children:[Nt.jsx(Ee,{size:18}),"Create Zone"]}),Nt.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 rounded-lg border "+(e?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"})]})]})]})}),x&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-lg w-full max-w-md "+(e?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-bold "+(e?"text-white":"text-gray-900"),children:"Assign Teller to Zone"}),Nt.jsx("button",{onClick:()=>y(!1),className:"p-1 hover:bg-gray-700 rounded",children:Nt.jsx(ce,{size:20})})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Select Teller *"}),Nt.jsxs("select",{value:_.tellerId,onChange:e=>A(c(l({},_),{tellerId:e.target.value})),className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"",children:"Choose a teller..."}),i.map(e=>Nt.jsxs("option",{value:e._id,children:[e.username," (",e.role,")"]},e._id))]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Select Zone *"}),Nt.jsxs("select",{value:_.zoneId,onChange:e=>A(c(l({},_),{zoneId:e.target.value})),className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"",children:"Choose a zone..."}),r.map(e=>Nt.jsxs("option",{value:e._id,children:[e.name," (",e.region,")"]},e._id))]})]}),Nt.jsxs("div",{className:"flex gap-3 pt-4",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,i;if(_.tellerId&&_.zoneId)try{const e=localStorage.getItem("authToken");if((yield pt.post(`${n}/api/teller-zones/assign`,_,{headers:{Authorization:`Bearer ${e}`}})).data.success){const e=r.map(e=>e._id===_.zoneId?c(l({},e),{assignedTellers:[...e.assignedTellers||[],_.tellerId]}):e);a(e),A({tellerId:"",zoneId:""}),y(!1),t("Teller assigned successfully","success")}}catch(s){t((null==(i=null==(e=s.response)?void 0:e.data)?void 0:i.error)||"Failed to assign teller","error")}else t("Please select both teller and zone","error")}),className:"flex-1 px-4 py-2 rounded-lg bg-green-500 hover:bg-green-600 text-white flex items-center justify-center gap-2",children:[Nt.jsx(Ee,{size:18}),"Assign"]}),Nt.jsx("button",{onClick:()=>y(!1),className:"flex-1 px-4 py-2 rounded-lg border "+(e?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"})]})]})]})}),u?Nt.jsxs("div",{className:"text-center py-12",children:[Nt.jsx(Ae,{size:32,className:"mx-auto text-blue-500 animate-spin mb-4"}),Nt.jsx("p",{className:e?"text-gray-400":"text-gray-600",children:"Loading zones and teller data..."})]}):r.length>0?Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(e=>Nt.jsx(M,{zone:e},e._id))}):Nt.jsxs("div",{className:"text-center py-12",children:[Nt.jsx(te,{size:48,className:"mx-auto text-gray-400 mb-4"}),Nt.jsx("p",{className:e?"text-gray-400":"text-gray-600",children:'No zones created yet. Click "Add Zone" to get started!'})]})]})},yte=()=>{const{isDarkMode:e}=f.useContext($c),{addToast:t}=Kc(),n=zc(),[r,a]=f.useState([]),[i,s]=f.useState([]),[o,d]=f.useState(!1),[u,p]=f.useState(!1),[m,g]=f.useState(!1),[x,y]=f.useState({name:"",type:"betting_threshold",threshold:5e4,condition:"greater_than",channels:["in_app"],enabled:!0}),[v,b]=f.useState({emailNotifications:!0,smsNotifications:!1,inAppNotifications:!0,emailAddress:"",phoneNumber:""});f.useEffect(()=>{w();const e=setInterval(N,1e4);return()=>clearInterval(e)},[]);const w=()=>h(null,null,function*(){var e,r;d(!0);try{const e={Authorization:`Bearer ${localStorage.getItem("authToken")}`},t=yield pt.get(`${n}/api/notifications/list`,{headers:e});t.data.success&&a(t.data.data);const r=yield pt.get(`${n}/api/notifications/rules`,{headers:e});r.data.success&&s(r.data.data);const i=yield pt.get(`${n}/api/notifications/settings`,{headers:e});i.data.success&&b(i.data.data)}catch(i){const n=(null==(r=null==(e=i.response)?void 0:e.data)?void 0:r.error)||"Failed to fetch data";t(n,"error")}finally{d(!1)}}),N=()=>h(null,null,function*(){try{const e=localStorage.getItem("authToken"),t=yield pt.get(`${n}/api/notifications/list`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&a(t.data.data)}catch(e){}}),S=({notification:i})=>{const s=t=>t?"opacity-50":e?"bg-gray-700":"bg-blue-50";return Nt.jsxs("div",{className:`p-4 rounded-lg border ${e?`${s(i.read)} border-gray-700`:`${s(i.read)} border-gray-200`} flex items-start justify-between`,children:[Nt.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[Nt.jsx("div",{className:"mt-1",children:(e=>{switch(e){case"betting_threshold":return Nt.jsx(K,{className:"text-orange-500"});case"activity_change":return Nt.jsx(M,{className:"text-yellow-500"});case"performance_drop":return Nt.jsx(K,{className:"text-red-500 rotate-180"});default:return Nt.jsx(We,{className:"text-blue-500"})}})(i.type)}),Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("h4",{className:"font-semibold "+(e?"text-white":"text-gray-900"),children:i.title}),Nt.jsx("p",{className:"text-sm mt-1 "+(e?"text-gray-400":"text-gray-600"),children:i.message}),Nt.jsx("p",{className:"text-xs mt-2 text-gray-500",children:new Date(i.createdAt).toLocaleString()})]})]}),Nt.jsx("button",{onClick:()=>{return e=i._id,h(null,null,function*(){var i,s;try{const i=localStorage.getItem("authToken");yield pt.delete(`${n}/api/notifications/${e}`,{headers:{Authorization:`Bearer ${i}`}}),a(r.filter(t=>t._id!==e)),t("Notification deleted","success")}catch(o){t((null==(s=null==(i=o.response)?void 0:i.data)?void 0:s.error)||"Failed to delete notification","error")}});var e},className:"p-2 hover:bg-red-500 hover:bg-opacity-20 text-red-500 rounded ml-2",children:Nt.jsx(R,{size:16})})]})},j=({rule:r})=>{var a;return Nt.jsx("div",{className:"p-4 rounded-lg border "+(e?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:Nt.jsxs("div",{className:"flex items-start justify-between",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("h4",{className:"font-semibold "+(e?"text-white":"text-gray-900"),children:r.name}),Nt.jsx("p",{className:"text-sm mt-1 "+(e?"text-gray-400":"text-gray-600"),children:{betting_threshold:"Betting Threshold Alert",activity_change:"Activity Change Alert",performance_drop:"Performance Drop Alert"}[r.type]||r.type}),Nt.jsxs("div",{className:"flex gap-2 mt-2",children:[r.channels.includes("email")&&Nt.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-purple-500 bg-opacity-20 text-purple-500",children:[Nt.jsx(Ve,{size:12}),"Email"]}),r.channels.includes("sms")&&Nt.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-green-500 bg-opacity-20 text-green-500",children:[Nt.jsx($e,{size:12}),"SMS"]}),r.channels.includes("in_app")&&Nt.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-blue-500 bg-opacity-20 text-blue-500",children:[Nt.jsx(We,{size:12}),"In-App"]})]}),"betting_threshold"===r.type&&Nt.jsxs("p",{className:"text-xs mt-2 text-gray-500",children:["Threshold: ",null==(a=r.threshold)?void 0:a.toLocaleString()," (",r.condition,")"]})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("button",{onClick:()=>{return e=r._id,a=r.enabled,h(null,null,function*(){var r,o;try{const t=localStorage.getItem("authToken");(yield pt.put(`${n}/api/notifications/rules/${e}`,{enabled:!a},{headers:{Authorization:`Bearer ${t}`}})).data.success&&s(i.map(t=>t._id===e?c(l({},t),{enabled:!a}):t))}catch(d){t((null==(o=null==(r=d.response)?void 0:r.data)?void 0:o.error)||"Failed to update rule","error")}});var e,a},className:"px-3 py-1 rounded text-sm font-medium "+(r.enabled?"bg-green-500 text-white":"bg-gray-500 text-white"),children:r.enabled?"Enabled":"Disabled"}),Nt.jsx("button",{onClick:()=>{return e=r._id,h(null,null,function*(){var r,a;if(window.confirm("Delete this alert rule?"))try{const r=localStorage.getItem("authToken");yield pt.delete(`${n}/api/notifications/rules/${e}`,{headers:{Authorization:`Bearer ${r}`}}),s(i.filter(t=>t._id!==e)),t("Rule deleted successfully","success")}catch(o){t((null==(a=null==(r=o.response)?void 0:r.data)?void 0:a.error)||"Failed to delete rule","error")}});var e},className:"p-2 hover:bg-red-500 hover:bg-opacity-20 text-red-500 rounded",children:Nt.jsx(R,{size:16})})]})]})})};return Nt.jsxs("div",{className:"min-h-screen p-8 "+(e?"bg-gray-900":"bg-gray-50"),children:[Nt.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold "+(e?"text-white":"text-gray-900"),children:"Notification Center"}),Nt.jsx("p",{className:e?"text-gray-400":"text-gray-600",children:"Manage alerts and real-time notifications for betting activity"})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2 rounded-lg bg-gray-500 hover:bg-gray-600 text-white flex items-center gap-2",children:[Nt.jsx(L,{size:18}),"Settings"]}),Nt.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white flex items-center gap-2",children:[Nt.jsx(le,{size:18}),"Add Alert Rule"]})]})]}),m&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-lg w-full max-w-md "+(e?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-bold "+(e?"text-white":"text-gray-900"),children:"Notification Settings"}),Nt.jsx("button",{onClick:()=>g(!1),className:"p-1 hover:bg-gray-700 rounded",children:Nt.jsx(ce,{size:20})})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:v.inAppNotifications,onChange:e=>b(c(l({},v),{inAppNotifications:e.target.checked})),className:"w-4 h-4"}),Nt.jsx("span",{className:e?"text-gray-300":"text-gray-700",children:"In-App Notifications"})]}),Nt.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:v.emailNotifications,onChange:e=>b(c(l({},v),{emailNotifications:e.target.checked})),className:"w-4 h-4"}),Nt.jsx("span",{className:e?"text-gray-300":"text-gray-700",children:"Email Notifications"})]}),v.emailNotifications&&Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Email Address"}),Nt.jsx("input",{type:"email",value:v.emailAddress,onChange:e=>b(c(l({},v),{emailAddress:e.target.value})),placeholder:"your@email.com",className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:v.smsNotifications,onChange:e=>b(c(l({},v),{smsNotifications:e.target.checked})),className:"w-4 h-4"}),Nt.jsx("span",{className:e?"text-gray-300":"text-gray-700",children:"SMS Notifications"})]}),v.smsNotifications&&Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Phone Number"}),Nt.jsx("input",{type:"tel",value:v.phoneNumber,onChange:e=>b(c(l({},v),{phoneNumber:e.target.value})),placeholder:"+63 9XX XXX XXXX",className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("div",{className:"flex gap-3 pt-4",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,r;try{const e=localStorage.getItem("authToken");(yield pt.put(`${n}/api/notifications/settings`,v,{headers:{Authorization:`Bearer ${e}`}})).data.success&&(t("Settings saved successfully","success"),g(!1))}catch(a){t((null==(r=null==(e=a.response)?void 0:e.data)?void 0:r.error)||"Failed to save settings","error")}}),className:"flex-1 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center gap-2",children:[Nt.jsx(Ee,{size:18}),"Save Settings"]}),Nt.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 rounded-lg border "+(e?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"})]})]})]})}),u&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-lg w-full max-w-md max-h-96 overflow-y-auto "+(e?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-bold "+(e?"text-white":"text-gray-900"),children:"Create Alert Rule"}),Nt.jsx("button",{onClick:()=>p(!1),className:"p-1 hover:bg-gray-700 rounded",children:Nt.jsx(ce,{size:20})})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Rule Name *"}),Nt.jsx("input",{type:"text",value:x.name,onChange:e=>y(c(l({},x),{name:e.target.value})),placeholder:"e.g., High Betting Alert",className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Alert Type *"}),Nt.jsxs("select",{value:x.type,onChange:e=>y(c(l({},x),{type:e.target.value})),className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"betting_threshold",children:"Betting Threshold"}),Nt.jsx("option",{value:"activity_change",children:"Activity Change"}),Nt.jsx("option",{value:"performance_drop",children:"Performance Drop"})]})]}),"betting_threshold"===x.type&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Threshold Amount ()"}),Nt.jsx("input",{type:"number",value:x.threshold,onChange:e=>y(c(l({},x),{threshold:parseInt(e.target.value)})),className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Condition"}),Nt.jsxs("select",{value:x.condition,onChange:e=>y(c(l({},x),{condition:e.target.value})),className:"w-full px-3 py-2 rounded-lg border "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"greater_than",children:"Greater Than"}),Nt.jsx("option",{value:"less_than",children:"Less Than"}),Nt.jsx("option",{value:"equals",children:"Equals"})]})]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Notification Channels *"}),Nt.jsx("div",{className:"space-y-2",children:["in_app","email","sms"].map(t=>Nt.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:x.channels.includes(t),onChange:e=>{e.target.checked?y(c(l({},x),{channels:[...x.channels,t]})):y(c(l({},x),{channels:x.channels.filter(e=>e!==t)}))},className:"w-4 h-4"}),Nt.jsx("span",{className:e?"text-gray-300":"text-gray-700",children:"in_app"===t?"In-App":t.toUpperCase()})]},t))})]}),Nt.jsxs("div",{className:"flex gap-3 pt-4",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,r;if(x.name.trim())if(0!==x.channels.length)try{const e=localStorage.getItem("authToken"),r=yield pt.post(`${n}/api/notifications/rules/create`,x,{headers:{Authorization:`Bearer ${e}`}});r.data.success&&(s([...i,r.data.data]),y({name:"",type:"betting_threshold",threshold:5e4,condition:"greater_than",channels:["in_app"],enabled:!0}),p(!1),t("Alert rule created successfully","success"))}catch(a){t((null==(r=null==(e=a.response)?void 0:e.data)?void 0:r.error)||"Failed to create rule","error")}else t("Select at least one notification channel","error");else t("Rule name is required","error")}),className:"flex-1 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center gap-2",children:[Nt.jsx(Ee,{size:18}),"Create Rule"]}),Nt.jsx("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 rounded-lg border "+(e?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"})]})]})]})}),Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[Nt.jsxs("div",{className:"lg:col-span-2",children:[Nt.jsxs("h2",{className:"text-xl font-semibold mb-4 "+(e?"text-white":"text-gray-900"),children:["Recent Notifications (",r.length,")"]}),Nt.jsx("div",{className:"space-y-3",children:r.length>0?r.slice(0,10).map(e=>Nt.jsx(S,{notification:e},e._id)):Nt.jsx("p",{className:e?"text-gray-400":"text-gray-600",children:"No notifications yet"})})]}),Nt.jsxs("div",{children:[Nt.jsxs("h2",{className:"text-xl font-semibold mb-4 "+(e?"text-white":"text-gray-900"),children:["Active Rules (",i.filter(e=>e.enabled).length,")"]}),Nt.jsx("div",{className:"space-y-3",children:i.length>0?i.map(e=>Nt.jsx(j,{rule:e},e._id)):Nt.jsx("p",{className:e?"text-gray-400":"text-gray-600",children:"No alert rules created yet"})})]})]})]})};function vte(){var e;const[t,n]=f.useState(null),[r,a]=f.useState(!0),[i,s]=f.useState(null),[o,l]=f.useState(new Date),[c,d]=f.useState("betAmount"),u=(()=>{try{return JSON.parse(localStorage.getItem("user")||"{}").role||"supervisor"}catch(bI){return"supervisor"}})(),p="admin"===u||"super_admin"===u,m="teller"===u;f.useEffect(()=>{g();const e=setInterval(()=>{g()},18e4);return()=>clearInterval(e)},[]);const g=()=>h(null,null,function*(){var e,t,r,i;try{a(!0),s(null);const e=localStorage.getItem("token");if(!e)return s("Authentication token not found. Please log in again."),void a(!1);const t=`${zc()}/api/reports/betting-event`,r=yield pt.get(t,{headers:{Authorization:`Bearer ${e}`}});r.data.success?(n({data:r.data.data.data||r.data.data,filtered:r.data.data.filtered,dateRange:r.data.data.dateRange}),l(new Date)):s("Failed to fetch betting event data")}catch(o){console.error("Error fetching betting event data:",o);const n=(null==(t=null==(e=o.response)?void 0:e.data)?void 0:t.message)||401===(null==(r=o.response)?void 0:r.status)?"Unauthorized - Please log in again":403===(null==(i=o.response)?void 0:i.status)?"Forbidden - You do not have permission to access this report":o.message||"Failed to fetch betting event data";s(n)}finally{a(!1)}}),x=e=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e||0),y=e=>e?new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Not completed",v=e=>.055*(e||0),b=e=>{const t=e;if(!t)return"";const n=t%100;if(n>=11&&n<=13)return`${t}th`;switch(t%10){case 1:return`${t}st`;case 2:return`${t}nd`;case 3:return`${t}rd`;default:return`${t}th`}};if(r)return Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"flex items-center justify-center h-64",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),Nt.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Loading betting event report..."})]})});if(i){const n=i.includes("no betting API mapping")||(null==t?void 0:t.isTellerData)&&(!(null==(e=null==t?void 0:t.data)?void 0:e.staffReports)||0===t.data.staffReports.length);return Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:(n?"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800")+" rounded-lg p-4",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:Nt.jsx("svg",{className:"h-5 w-5 "+(n?"text-yellow-400":"text-red-400"),viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium "+(n?"text-yellow-800 dark:text-yellow-200":"text-red-800 dark:text-red-200"),children:n?"Not Mapped to Betting System":"Error Loading Report"}),Nt.jsx("div",{className:"mt-2 text-sm "+(n?"text-yellow-700 dark:text-yellow-300":"text-red-700 dark:text-red-300"),children:n?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("p",{children:"Your account is not yet mapped to the betting system."}),Nt.jsx("p",{className:"mt-1",children:"Please contact your supervisor or administrator to set up your betting account mapping."})]}):i}),Nt.jsx("button",{onClick:g,className:`mt-3 ${n?"bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 hover:bg-yellow-200 dark:hover:bg-yellow-700":"bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-700"} px-3 py-1 rounded text-sm`,children:"Retry"})]})]})})})}if(!t)return Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400",children:"No betting event data available"})});const{data:w}=t;return!m||(null==w?void 0:w.staffReports)&&0!==w.staffReports.length?Nt.jsxs("div",{className:"p-6 space-y-6",children:[Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:" Betting Event Report"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:w.title}),Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[" Auto-refresh every 3 minutes  Last updated: ",o.toLocaleTimeString()]})]}),Nt.jsxs("button",{onClick:g,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2",children:[Nt.jsx(Ae,{size:16}),"Refresh"]})]}),Nt.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created:"}),Nt.jsx("p",{className:"font-medium",children:y(w.createdAt)})]}),Nt.jsxs("div",{children:[Nt.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Completed:"}),Nt.jsx("p",{className:"font-medium",children:y(w.completedAt)})]})]})]}),p&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:" Financial Summary"}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[Nt.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"Total Starting Balance"}),Nt.jsx("div",{className:"text-2xl font-bold text-green-800 dark:text-green-200",children:x(w.totalStartingBalance)})]}),Nt.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:"Total System Balance"}),Nt.jsx("div",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200",children:x(w.totalSystemBalance)})]}),Nt.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-purple-600 dark:text-purple-400 font-medium",children:"Total Bet Amount"}),Nt.jsx("div",{className:"text-2xl font-bold text-purple-800 dark:text-purple-200",children:x(w.totalBetAmount)})]}),Nt.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-pink-600 dark:text-pink-400 font-medium",children:"Total Commission (5.5%)"}),Nt.jsx("div",{className:"text-2xl font-bold text-pink-800 dark:text-pink-200",children:x((w.staffReports||[]).reduce((e,t)=>e+v(t.betAmount),0))})]}),Nt.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"Total Payout"}),Nt.jsx("div",{className:"text-2xl font-bold text-red-800 dark:text-red-200",children:x(w.totalPayout)})]}),Nt.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium",children:"Total Canceled/Returned"}),Nt.jsx("div",{className:"text-2xl font-bold text-yellow-800 dark:text-yellow-200",children:x(w.totalCanceledBet)})]}),Nt.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-medium",children:"Net Profit"}),Nt.jsx("div",{className:"text-2xl font-bold text-indigo-800 dark:text-indigo-200",children:x(w.totalBetAmount-w.totalPayout-w.totalCanceledBet)})]})]})]}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:" Staff Performance"}),Nt.jsxs("div",{className:"flex items-center gap-4",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sort by:"}),Nt.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[Nt.jsx("option",{value:"betAmount",children:"Bet Amount"}),Nt.jsx("option",{value:"systemBalance",children:"System Balance"})]})]}),Nt.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:[" Sorted by ","betAmount"===c?"Bet Amount":"System Balance"," (Highest to Lowest)"]})]})]}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[Nt.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Rank"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Teller"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Starting Balance"}),!p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Points"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Bet Amount"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Payout"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"System Balance"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Commission"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Profit/Loss"})]})}),Nt.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:(N=w.staffReports||[],S=c,[...N].sort((e,t)=>"betAmount"===S?(t.betAmount||0)-(e.betAmount||0):"systemBalance"===S?(t.systemBalance||0)-(e.systemBalance||0):0)).map((e,t)=>{const n=(e.betAmount||0)-(e.payout||0)-(e.canceledBet||0),r=v(e.betAmount);return Nt.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 font-semibold",children:b(t+1)}),Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Nt.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),Nt.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.username})]}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.startingBalance)}),!p&&Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-indigo-600 dark:text-indigo-400",children:[(a=e.betAmount,((a||0)/1500).toFixed(2)).toLocaleString()," pts"]}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.betAmount)}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.payout)}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.systemBalance)}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-purple-600 dark:text-purple-400 font-medium",children:x(r)}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Nt.jsxs("span",{className:"text-sm font-medium "+(n>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[n>=0?"+":"",x(n)]})})]},t);var a})})]})})]})]}):Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("svg",{className:"h-12 w-12 text-yellow-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Nt.jsx("h3",{className:"text-lg font-medium text-yellow-800 dark:text-yellow-200 mb-2",children:"Not Mapped to Betting System"}),Nt.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:"Your account hasn't been set up in the betting system yet."}),Nt.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 mt-2",children:"Please contact your supervisor or administrator to set up your betting account mapping."})]})})});var N,S}function bte(){var e,t,n,r,a,i,s;const{user:o,settings:d}=f.useContext($c);null==(e=null==d?void 0:d.theme)||e.mode;const[u,p]=f.useState(null),[m,g]=f.useState(!0),[x,y]=f.useState(null),[v,b]=f.useState({enabled:!1,selectedDate:"",showAll:!1}),[w,N]=f.useState(!1);f.useEffect(()=>{S()},[v]);const S=()=>h(null,null,function*(){var e,t;try{g(!0),y(null);const e=new URLSearchParams;v.enabled&&v.selectedDate&&e.append("date",v.selectedDate),v.showAll&&e.append("showAll","true");const t=e.toString(),n=`${zc()}/api/reports/kpi/tellers${t?`?${t}`:""}`,r=yield pt.get(n,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});r.data.success?p(r.data.data):y("Failed to fetch KPI data")}catch(n){console.error("Error fetching KPI data:",n),y((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch KPI data")}finally{g(!1)}}),j=e=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e||0);return m?Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"flex items-center justify-center h-64",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),Nt.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Loading KPI data..."})]})}):x?Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:Nt.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error Loading KPI Data"}),Nt.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:x}),Nt.jsx("button",{onClick:S,className:"mt-3 bg-red-100 dark:bg-red-800 px-3 py-1 rounded text-sm text-red-800 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-700",children:"Retry"})]})]})})}):Nt.jsxs("div",{className:"p-6 space-y-6",children:[Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:" Key Performance Indicators"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Active Tellers Performance Dashboard - Based on Betting Event Report"})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:["super_admin"===(null==o?void 0:o.role)&&Nt.jsxs("button",{onClick:()=>N(!w),className:"px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 "+(w?"bg-orange-600 hover:bg-orange-700 text-white":"bg-green-600 hover:bg-green-700 text-white"),children:[Nt.jsx(U,{size:16}),w?"Top 5 Only":"All Tellers"]}),Nt.jsxs("button",{onClick:S,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2",children:[Nt.jsx(Ae,{size:16}),"Refresh"]})]})]})}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[Nt.jsx(W,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),Nt.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Date Filter"}),Nt.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[Nt.jsxs("label",{className:"flex items-center gap-2",children:[Nt.jsx("input",{type:"checkbox",checked:v.showAll,onChange:e=>b(t=>c(l({},t),{showAll:e.target.checked,enabled:!e.target.checked&&t.enabled})),className:"rounded"}),Nt.jsx("span",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium",children:"Show All Historical"})]}),Nt.jsxs("label",{className:"flex items-center gap-2",children:[Nt.jsx("input",{type:"checkbox",checked:v.enabled,onChange:e=>b(t=>c(l({},t),{enabled:e.target.checked,showAll:!e.target.checked&&t.showAll})),className:"rounded",disabled:v.showAll}),Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enable Single Date"})]})]})]}),Nt.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Select Date:"}),Nt.jsx("input",{type:"date",value:v.selectedDate,onChange:e=>b(t=>c(l({},t),{selectedDate:e.target.value})),disabled:!v.enabled,className:"w-full p-2 border rounded "+(v.enabled?"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white":"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-400 cursor-not-allowed")})]}),Nt.jsx("div",{className:"flex items-end",children:Nt.jsxs("button",{onClick:S,disabled:!v.enabled&&!v.showAll,className:"w-full px-4 py-2 rounded flex items-center justify-center gap-2 "+(v.enabled||v.showAll?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:[Nt.jsx(he,{className:"w-4 h-4"}),v.showAll?"Show All Data":"Apply Date Filter"]})})]})]}),(null==u?void 0:u.source)&&Nt.jsx("div",{className:"border rounded-lg p-4 "+("real_betting_data"===(null==u?void 0:u.source)?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"),children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:"real_betting_data"===(null==u?void 0:u.source)?Nt.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):Nt.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium "+("real_betting_data"===(null==u?void 0:u.source)?"text-green-800 dark:text-green-200":"text-yellow-800 dark:text-yellow-200"),children:"real_betting_data"===(null==u?void 0:u.source)?"Real Teller Data":"Demo Data Mode"}),Nt.jsx("div",{className:"mt-2 text-sm "+("real_betting_data"===(null==u?void 0:u.source)?"text-green-700 dark:text-green-300":"text-yellow-700 dark:text-yellow-300"),children:"real_betting_data"===(null==u?void 0:u.source)?`Showing ${(null==(t=u.summary)?void 0:t.activeTellers)||0} real tellers from database reports`:u.scraperStatus||"Currently showing demo data. GTArena API requires authentication updates."}),"real_betting_data"===(null==u?void 0:u.source)&&Nt.jsxs("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400",children:["Data source: Teller Reports Database (",(null==(n=u.summary)?void 0:n.activeTellers)||0," active tellers)"]})]})]})}),(null==u?void 0:u.summary)&&Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6",children:[Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active Tellers"}),Nt.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u.summary.activeTellers}),Nt.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"From betting activity"})]}),Nt.jsx(U,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Bet Amount"}),Nt.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j(u.summary.totalBetAmount)}),Nt.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"All active tellers"})]}),Nt.jsx(xe,{className:"w-8 h-8 text-green-600 dark:text-green-400"})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Profit"}),Nt.jsx("p",{className:"text-2xl font-bold "+(u.summary.totalProfit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:j(u.summary.totalProfit)}),Nt.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Net earnings"})]}),Nt.jsx(K,{className:"w-8 h-8 "+(u.summary.totalProfit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Bet/Teller"}),Nt.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j(u.summary.avgBetPerTeller)}),Nt.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Average per teller"})]}),Nt.jsx(X,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Commission"}),Nt.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:j(u.summary.totalCommission)}),Nt.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Commission earnings"})]}),Nt.jsx(Ye,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Top Performer"}),Nt.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(null==(r=u.summary.topPerformer)?void 0:r.name)||"N/A"}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[j((null==(a=u.summary.topPerformer)?void 0:a.profit)||0)," profit"]})]}),Nt.jsx(ae,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"})]})})]}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:null==(s=w?null==(i=null==u?void 0:u.tellers)?void 0:i.slice(0,5):null==u?void 0:u.tellers)?void 0:s.map((e,t)=>{return Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.name}),Nt.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["@",e.username]}),Nt.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Nt.jsxs("span",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded",children:["Rank #",e.rank]}),w&&t<5&&Nt.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded",children:" Top Performer"})]})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsx("div",{className:"text-lg font-bold "+(e.profit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:j(e.profit)}),Nt.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Profit"})]})]}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Bet Amount"}),Nt.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:j(e.betAmount)})]}),Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Payout"}),Nt.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:j(e.payout)})]}),Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Canceled/Returned"}),Nt.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:j(e.canceledBet)})]}),Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1",children:[Nt.jsx(Ye,{className:"w-3 h-3"}),"Commission"]}),Nt.jsx("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:j(e.commission)})]}),Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Profit Margin"}),Nt.jsxs("span",{className:"font-semibold "+((e.profitMargin||0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[(e.profitMargin||0).toFixed(1),"%"]})]}),Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Efficiency"}),Nt.jsxs("span",{className:"font-semibold "+(n=e.efficiency||0,r=10,n>=r?"text-green-600 dark:text-green-400":n>=.7*r?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"),children:[(e.efficiency||0).toFixed(1),"%"]})]}),Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"System Balance"}),Nt.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:j(e.systemBalance)})]})]})]},e._id||t);var n,r})}),(!(null==u?void 0:u.tellers)||0===u.tellers.length)&&Nt.jsxs("div",{className:"text-center py-12",children:[Nt.jsx(U,{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),Nt.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Active Tellers"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No tellers with betting activity found in the betting event report for the selected period."})]})]})}function wte(){const[e,t]=f.useState([]),[n,r]=f.useState(!0),[a,i]=f.useState(!1),[s,o]=f.useState(null),[l,c]=f.useState(null);f.useEffect(()=>{d()},[]);const d=()=>h(null,null,function*(){var e,n;try{r(!0),o(null);const e=yield pt.get(`${zc()}/api/reports/teller-mappings`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e.data.success?t(e.data.mappings):o("Failed to fetch teller mappings")}catch(a){console.error("Error fetching mappings:",a),o((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.message)||"Failed to fetch teller mappings")}finally{r(!1)}}),u=e=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e||0),p=e=>e?new Date(e).toLocaleString("en-PH"):"Never",m=e=>{switch(e){case"exact":return"text-green-600 bg-green-100";case"fuzzy":return"text-yellow-600 bg-yellow-100";case"manual":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return n?Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"flex items-center justify-center h-64",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),Nt.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Loading teller mappings..."})]})}):s?Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:Nt.jsxs("div",{className:"flex items-center",children:[Nt.jsx(M,{className:"h-5 w-5 text-red-400"}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error Loading Mappings"}),Nt.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:s}),Nt.jsx("button",{onClick:d,className:"mt-3 bg-red-100 dark:bg-red-800 px-3 py-1 rounded text-sm text-red-800 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-700",children:"Retry"})]})]})})}):Nt.jsxs("div",{className:"p-6 space-y-6",children:[Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[Nt.jsx(ee,{className:"text-indigo-500"}),"Teller Mappings"]}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Linking RMI Reporting tellers with RMI Betting API data"}),Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[" Last synced: ",l?p(l):"Never"]})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e,t;try{i(!0),o(null);const e=yield pt.post(`${zc()}/api/reports/sync-betting-data`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e.data.success?(c(new Date),yield d(),alert(` ${e.data.message}`)):o("Failed to sync betting data")}catch(n){console.error("Error syncing betting data:",n),o((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to sync betting data")}finally{i(!1)}}),disabled:a,className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[Nt.jsx(Ae,{className:"h-4 w-4 "+(a?"animate-spin":"")}),a?"Syncing...":"Sync Betting Data"]}),Nt.jsxs("button",{onClick:d,className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:[Nt.jsx(Ae,{className:"h-4 w-4"}),"Refresh"]})]})]})}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center",children:[Nt.jsx(U,{className:"h-8 w-8 text-blue-500"}),Nt.jsxs("div",{className:"ml-4",children:[Nt.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Mappings"}),Nt.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.length})]})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center",children:[Nt.jsx(K,{className:"h-8 w-8 text-green-500"}),Nt.jsxs("div",{className:"ml-4",children:[Nt.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Bet Amount"}),Nt.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u(e.reduce((e,t)=>{var n;return e+((null==(n=t.bettingData)?void 0:n.lastBetAmount)||0)},0))})]})]})}),Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:Nt.jsxs("div",{className:"flex items-center",children:[Nt.jsx(ee,{className:"h-8 w-8 text-purple-500"}),Nt.jsxs("div",{className:"ml-4",children:[Nt.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Active Links"}),Nt.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.filter(e=>e.lastBettingSync).length})]})]})})]}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Teller Mappings"}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[Nt.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Reporting System"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Betting API"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Match Type"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Last Bet Amount"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"System Balance"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Last Sync"})]})}),Nt.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:e.map(e=>{var t,n,r;return Nt.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Nt.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.tellerUsername}),Nt.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.tellerName})]}),Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Nt.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.bettingUsername}),Nt.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.bettingName})]}),Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Nt.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m(e.matchConfidence)}`,children:e.matchConfidence.toUpperCase()}),e.matchReason&&Nt.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.matchReason})]}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:u(null==(t=e.bettingData)?void 0:t.lastBetAmount)}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:u(null==(n=e.bettingData)?void 0:n.lastSystemBalance)}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:p(null==(r=e.bettingData)?void 0:r.lastSyncDate)})]},e.id)})})]})}),0===e.length&&Nt.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No teller mappings found. Run the matching process to create mappings."})]})]})}function Nte(){const{user:e}=f.useContext($c),[t,n]=f.useState(null),[r,a]=f.useState(1),[i,s]=f.useState({x:0,y:0}),[o,c]=f.useState(!1),[d,u]=f.useState(null),[p,m]=f.useState(""),[g,x]=f.useState(!1),y=f.useRef(null),v=f.useRef(null),b=e=>{var t,n,r,a,s,o;c(!0),u({x:null!=(r=e.clientX)?r:null==(n=null==(t=e.touches)?void 0:t[0])?void 0:n.clientX,y:null!=(o=e.clientY)?o:null==(s=null==(a=e.touches)?void 0:a[0])?void 0:s.clientY,orig:l({},i)})},w=e=>{var t,n,r,a,i,l;if(!o||!d)return;const c=null!=(r=e.clientX)?r:null==(n=null==(t=e.touches)?void 0:t[0])?void 0:n.clientX,u=null!=(l=e.clientY)?l:null==(i=null==(a=e.touches)?void 0:a[0])?void 0:i.clientY;s({x:d.orig.x+(c-d.x),y:d.orig.y+(u-d.y)})},N=()=>{c(!1),u(null)};f.useEffect(()=>(window.addEventListener("mouseup",N),window.addEventListener("touchend",N),()=>{window.removeEventListener("mouseup",N),window.removeEventListener("touchend",N)}),[]);return Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"max-w-3xl mx-auto bg-white dark:bg-gray-800 p-4 rounded shadow",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Share a photo"}),Nt.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Upload a picture, crop like TikTok / Facebook and add a caption. All roles can post."}),Nt.jsxs("div",{className:"flex gap-3 flex-col md:flex-row",children:[Nt.jsx("div",{className:"flex-1",children:Nt.jsxs("div",{className:"border rounded p-3 bg-gray-50 dark:bg-gray-900",children:[Nt.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[Nt.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return(e=>{if(!e)return;const t=new FileReader;t.onload=()=>n(t.result),t.readAsDataURL(e)})(null==(t=e.target.files)?void 0:t[0])}}),Nt.jsx("button",{className:"px-2 py-1 bg-indigo-600 text-white rounded text-sm",onClick:()=>{var e,t;return null==(t=null==(e=document.getElementById("url-input"))?void 0:e.click)?void 0:t.call(e)},children:"Choose URL"})]}),Nt.jsxs("div",{ref:y,className:"relative h-72 w-full bg-gray-100 dark:bg-gray-700 rounded overflow-hidden",onMouseDown:b,onMouseMove:w,onTouchStart:b,onTouchMove:w,children:[t?Nt.jsx("img",{ref:v,src:t,alt:"selected",className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{transform:`translate(-50%, -50%) translate(${i.x}px, ${i.y}px) scale(${r})`}}):Nt.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:"No image selected"}),Nt.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:Nt.jsx("div",{className:"w-56 h-56 border-2 border-white/70 rounded shadow-xl backdrop-blur-sm"})})]}),Nt.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[Nt.jsx("label",{className:"text-sm text-gray-600",children:"Zoom"}),Nt.jsx("input",{type:"range",min:.5,max:3,step:.01,value:r,onChange:e=>a(Number(e.target.value)),className:"flex-1"})]}),Nt.jsxs("div",{className:"mt-3",children:[Nt.jsx("label",{className:"block text-sm text-gray-500 mb-1",children:"Caption"}),Nt.jsx("input",{value:p,onChange:e=>m(e.target.value),className:"w-full p-2 rounded border dark:bg-gray-800 dark:border-gray-700",placeholder:`Say something about your photo, ${(null==e?void 0:e.name)||(null==e?void 0:e.username)||""}`})]}),Nt.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[Nt.jsx("button",{onClick:()=>{n(null),m(""),a(1),s({x:0,y:0})},className:"px-3 py-2 border rounded",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,o,l,c;if(!t)return alert("Please choose an image");x(!0);try{const l=y.current,c=v.current,d=l.getBoundingClientRect(),u=c.naturalWidth,h=c.naturalHeight,g=c.width*r,f=c.height*r,x=Math.min(d.width,d.height),b=i.x+(d.width-g)/2,w=i.y+(d.height-f)/2,N=Math.max(0,-b/g*u),S=Math.max(0,-w/f*h),j=Math.min(u-N,x/g*u),_=Math.min(h-S,x/f*h),A=1024,C=document.createElement("canvas");C.width=A,C.height=A;const M=C.getContext("2d"),k=new Image;k.crossOrigin="anonymous",k.src=t,yield new Promise((e,t)=>{k.onload=e,k.onerror=t}),M.drawImage(k,N,S,j,_,0,0,A,A);const E=yield new Promise(e=>C.toBlob(e,"image/png",.93)),T=new FileReader,P=yield new Promise(e=>{T.onload=()=>e(T.result),T.readAsDataURL(E)}),D=localStorage.getItem("token"),R=yield pt.post(`${zc()}/api/media/upload`,{image:P,caption:p},{headers:{Authorization:`Bearer ${D}`}});(null==(e=R.data)?void 0:e.success)?(alert("Upload successful"),n(null),m(""),a(1),s({x:0,y:0})):alert((null==(o=R.data)?void 0:o.message)||"Upload failed")}catch(d){console.error(d),alert("Upload error: "+((null==(c=null==(l=null==d?void 0:d.response)?void 0:l.data)?void 0:c.message)||d.message))}finally{x(!1)}}),disabled:g,className:"px-3 py-2 bg-indigo-600 text-white rounded",children:g?"Uploading":"Post"})]})]})}),Nt.jsxs("div",{className:"w-80 hidden md:block",children:[Nt.jsx("div",{className:"p-3 rounded border bg-white dark:bg-gray-900 text-xs text-gray-600",children:"Preview:"}),Nt.jsx("div",{className:"mt-3 border rounded overflow-hidden h-64 bg-black/5 dark:bg-white/5 flex items-center justify-center",children:t?Nt.jsx("img",{src:t,className:"max-h-full max-w-full",alt:"preview"}):Nt.jsx("div",{className:"text-sm text-gray-500",children:"No preview"})})]})]})]})})}const Ste=v.lazy(()=>U$(()=>import("./CommentsSection-DtMftqAU.js"),__vite__mapDeps([0,1,2,3]),import.meta.url));function jte({time:e}){return f.useMemo(()=>{try{const t=Date.now()-new Date(e).getTime(),n=Math.floor(t/1e3);if(n<60)return Nt.jsxs("span",{children:[n,"s"]});const r=Math.floor(n/60);if(r<60)return Nt.jsxs("span",{children:[r,"m"]});const a=Math.floor(r/60);if(a<24)return Nt.jsxs("span",{children:[a,"h"]});const i=Math.floor(a/24);return Nt.jsxs("span",{children:[i,"d"]})}catch(bI){return Nt.jsx("span",{children:"-"})}},[e])}function _te(){const e=y(),[t,n]=f.useState([]),[r,a]=f.useState(!1),[i,s]=f.useState(""),[o,d]=f.useState(0),[u,p]=f.useState({}),[m,g]=f.useState({}),x=(()=>{try{return JSON.parse(localStorage.getItem("user")||"null")}catch(bI){return null}})();f.useEffect(()=>{!function(){h(this,null,function*(){var e,t,r,i;a(!0),s("");try{const r=zc(),a=yield pt.get(`${r}/api/media/feed`,{timeout:15e3});(null==(e=a.data)?void 0:e.success)?n(a.data.items||[]):s((null==(t=a.data)?void 0:t.message)||"Failed to fetch feed")}catch(o){s((null==(i=null==(r=o.response)?void 0:r.data)?void 0:i.message)||o.message||"Failed to fetch")}finally{a(!1)}})}()},[o]),f.useEffect(()=>{if(t.length>0){t.slice(0,3).forEach(e=>{if(e.imageUrl){const t=new Image,n=e.imageUrl.startsWith("http")?e.imageUrl:`${zc()}${e.imageUrl}`;t.src=n}})}},[t]),window.refreshFeed=()=>d(e=>e+1);const v=f.useCallback(e=>h(null,null,function*(){var t;if(x)try{const r=zc(),a=yield pt.post(`${r}/api/media/feed/${e}/like`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});(null==(t=a.data)?void 0:t.success)&&n(t=>t.map(t=>t._id===e?c(l({},t),{likes:a.data.liked?[...t.likes,x]:t.likes.filter(e=>e._id!==x._id)}):t))}catch(r){console.error("Failed to toggle like:",r)}}),[x]),b=f.useCallback(e=>h(null,null,function*(){var t;if(confirm("Are you sure you want to delete this post?"))try{const r=zc();(null==(t=(yield pt.delete(`${r}/api/media/feed/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data)?void 0:t.success)&&n(t=>t.filter(t=>t._id!==e))}catch(r){console.error("Failed to delete post:",r),alert("Failed to delete post")}}),[]),w=f.useCallback(e=>{const t=m[e];g(n=>c(l({},n),{[e]:!t})),t||u[e]||(e=>{h(null,null,function*(){var t;try{const n=zc(),r=yield pt.get(`${n}/api/media/feed/${e}/comments`);(null==(t=r.data)?void 0:t.success)&&p(t=>c(l({},t),{[e]:r.data.comments}))}catch(n){console.error("Failed to load comments:",n)}})})(e)},[m,u]);const[N,S]=f.useState({}),[j,_]=f.useState({}),A="undefined"!=typeof navigator&&navigator.connection?navigator.connection:null,C=(null==A?void 0:A.effectiveType)||"";const[M,k]=f.useState(new Set),E=f.useRef({});return f.useEffect(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.dataset.imgId;k(e=>new Set([...e,t]))}})},{rootMargin:"50px"});return Object.values(E.current).forEach(t=>{t&&e.observe(t)}),()=>e.disconnect()},[t]),Nt.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[Nt.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Activity Feed"}),r&&Nt.jsx("div",{className:"text-sm text-gray-500",children:"Loading"}),i&&Nt.jsx("div",{className:"text-sm text-red-500 mb-3",children:i}),Nt.jsxs("div",{className:"space-y-4",children:[0===t.length&&!r&&Nt.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"No posts yet  here are some sample posts to get you started."}),(t.length>0?t:function(e=4){const t=["Alex","Marisol","Chris","Aisha","Diego","Nora","Sam","Maya"],n=["Loving this view!","Trying something new today ","Quick snap on my walk","Testing the new upload feature  hello!","Catch of the day","Coffee break ","Sunset magic"];return new Array(e).fill(0).map((e,r)=>{const a=Math.floor(1e4*Math.random())+r,i=t[Math.floor(Math.random()*t.length)],s=n[Math.floor(Math.random()*n.length)];return{_id:`placeholder-${a}`,uploader:{name:i,avatarUrl:`https://i.pravatar.cc/140?u=${a}`},createdAt:new Date(Date.now()-1e3*(r+1)*60*60).toISOString(),caption:s,imageUrl:`https://picsum.photos/seed/${a}/1200/800`,thumbUrl:`https://picsum.photos/seed/${a}/640/360`,width:1200,height:800,_placeholder:!0}})}(4)).map(t=>{var n,r,a,i,s,o,d,g,y;return Nt.jsxs("article",{className:"bg-white dark:bg-gray-800 rounded shadow-sm overflow-hidden border dark:border-gray-700",children:[Nt.jsxs("div",{className:"p-3 flex items-center gap-3",children:[Nt.jsx("img",{src:(null==(n=t.uploader)?void 0:n.avatarUrl)?t.uploader.avatarUrl.startsWith("http")?`${t.uploader.avatarUrl}?t=${Date.now()}`:`${zc()}${t.uploader.avatarUrl}?t=${Date.now()}`:"/favicon.ico",alt:"avatar",className:"w-10 h-10 rounded-full object-cover cursor-pointer hover:opacity-80 transition",onClick:()=>{var n;return e(`/users/${null==(n=t.uploader)?void 0:n._id}`)},onError:e=>e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiNFNUU3RUIiLz4KPHBhdGggZD0iTTIwIDIwQzIyLjc2MTQgMjAgMjUgMTcuNzYxNCAyNSAxNUMyNSAxMi4yMzg2IDIyLjc2MTQgMTAgMjAgMTBDMTcuMjM4NiAxMCAxNSAxMi4yMzg2IDE1IDE1QzE1IDE3Ljc2MTQgMTcuNzYxNCAyMCAyMFoiIGZpbGw9IiM5Q0E0QUYiLz4KPHBhdGggZD0iTTMwIDI4QzMwIDI0LjY4NjMgMjYuNDI3MSAyMiAyMiAyMkgxOEMxMy41NzI5IDIyIDEwIDI0LjY4NjMgMTAgMjhWMzBIMzBWMjhaIiBmaWxsPSIjOUNBNEFGIi8+Cjwvc3ZnPgo="}),Nt.jsxs("div",{className:"flex-1",children:[Nt.jsxs("div",{className:"flex items-center justify-between gap-3",children:[Nt.jsx("div",{className:"text-sm font-semibold cursor-pointer hover:text-blue-600 transition",onClick:()=>{var n;return e(`/users/${null==(n=t.uploader)?void 0:n._id}`)},children:(null==(r=t.uploader)?void 0:r.name)||(null==(a=t.uploader)?void 0:a.username)||"User"}),Nt.jsx("div",{className:"text-xs text-gray-400",children:Nt.jsx(jte,{time:t.createdAt})})]}),t.caption&&Nt.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t.caption})]})]}),t.imageUrl&&Nt.jsxs("div",{className:"w-full bg-black/5 dark:bg-white/5 relative overflow-hidden",style:{aspectRatio:t.width&&t.height?`${t.width} / ${t.height}`:"16 / 9"},children:[Nt.jsxs("picture",{children:[(t.thumbUrl||t.imageUrl)&&Nt.jsx("source",{media:"(max-width:640px)",srcSet:(t.thumbUrl||t.imageUrl).startsWith("http")||(t.thumbUrl||t.imageUrl).startsWith("data:")?t.thumbUrl||t.imageUrl:`${zc()}${t.thumbUrl||t.imageUrl}`}),Nt.jsx("source",{media:"(max-width:1024px)",srcSet:C.includes("2g")||C.includes("slow-2g")?(t.thumbUrl||t.imageUrl).startsWith("http")||(t.thumbUrl||t.imageUrl).startsWith("data:")?t.thumbUrl||t.imageUrl:`${zc()}${t.thumbUrl||t.imageUrl}`:t.imageUrl.startsWith("http")||t.imageUrl.startsWith("data:")?t.imageUrl:`${zc()}${t.imageUrl}`}),Nt.jsx("img",{ref:e=>E.current[t._id]=e,"data-img-id":t._id,src:t.imageUrl.startsWith("http")||t.imageUrl.startsWith("data:")?t.imageUrl:`${zc()}${t.imageUrl}`,alt:"feed",loading:M.has(t._id)?"eager":"lazy",onLoad:()=>{return e=t._id,void S(t=>c(l({},t),{[e]:!0}));var e},onError:e=>{var n;t.imageData&&!e.target.src.includes("data:")?e.target.src=`data:image/png;base64,${t.imageData}`:(n=t._id,_(e=>c(l({},e),{[n]:!0})),S(e=>c(l({},e),{[n]:!0})))},className:"w-full h-full object-cover transition-opacity duration-300 "+(N[t._id]?"opacity-100":"opacity-0")})]}),!N[t._id]&&Nt.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Nt.jsx("div",{className:"w-24 h-24 rounded-lg bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse"})}),j[t._id]&&Nt.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-700",children:Nt.jsxs("div",{className:"text-center text-gray-500 p-4",children:[Nt.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),Nt.jsx("p",{className:"text-sm mb-2",children:"Image failed to load"}),"admin"===(null==x?void 0:x.role)&&(null==(i=t.imageUrl)?void 0:i.startsWith("/uploads/"))&&Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e;try{const t=zc(),n=yield pt.post(`${t}/api/media/migrate-images`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});(null==(e=n.data)?void 0:e.success)&&(alert(`Migration completed: ${n.data.message}`),window.refreshFeed&&window.refreshFeed())}catch(t){alert("Migration failed: "+t.message)}}),className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",children:"Migrate Image"})]})})]}),Nt.jsxs("div",{className:"p-3 flex items-center justify-between text-sm text-gray-500",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsxs("button",{onClick:()=>v(t._id),className:"px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-1 "+((null==(s=t.likes)?void 0:s.some(e=>e._id===(null==x?void 0:x._id)))?"text-red-500":""),children:[Nt.jsx("svg",{className:"w-4 h-4",fill:(null==(o=t.likes)?void 0:o.some(e=>e._id===(null==x?void 0:x._id)))?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(null==(d=t.likes)?void 0:d.length)||0]}),Nt.jsxs("button",{onClick:()=>w(t._id),className:"px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-1",children:[Nt.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(null==(g=u[t._id])?void 0:g.length)||0]}),Nt.jsx("button",{className:"px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:"Share"}),x&&(null==(y=t.uploader)?void 0:y._id)===x._id&&Nt.jsx("button",{onClick:()=>b(t._id),className:"px-2 py-1 rounded hover:bg-red-100 dark:hover:bg-red-900 text-red-600",children:Nt.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),Nt.jsxs("div",{className:"text-xs",children:["ID: ",String(t._id).slice(-6),t._placeholder?"  sample":""]})]}),m[t._id]&&Nt.jsx(f.Suspense,{fallback:Nt.jsx("div",{className:"px-3 pb-3 text-sm text-gray-500",children:"Loading comments..."}),children:Nt.jsx(Ste,{feedId:t._id,currentUser:x,comments:u,setComments:p})})]},t._id)})]})]})}function Ate(){const[e,t]=f.useState([]),[n,r]=f.useState(!1),[a,i]=f.useState(""),s=y();return f.useEffect(()=>{h(null,null,function*(){var e,n,a;r(!0),i("");try{const e=zc(),n=localStorage.getItem("token"),r=n?{headers:{Authorization:`Bearer ${n}`},timeout:8e3}:{timeout:8e3},a=yield pt.get(`${e}/api/users`,r);t(a.data||[])}catch(s){if(401===(null==(e=null==s?void 0:s.response)?void 0:e.status))return void i("Unauthorized. Please log in again.");i((null==(a=null==(n=s.response)?void 0:n.data)?void 0:a.message)||s.message||"Failed")}finally{r(!1)}})},[]),Nt.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[Nt.jsx("h2",{className:"text-xl font-semibold mb-4",children:"People"}),n&&Nt.jsx("div",{className:"text-sm text-gray-500",children:"Loading"}),a&&Nt.jsx("div",{className:"text-sm text-red-500",children:a}),Nt.jsx("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:e.map(e=>Nt.jsxs("div",{className:"p-3 border rounded flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-gray-900 cursor-pointer",onClick:()=>s(`/users/${e._id}`),children:[Nt.jsx("img",{src:e.avatarUrl?`${zc()}${e.avatarUrl}`:"/favicon.ico",className:"w-12 h-12 rounded-full object-cover",alt:"a",onError:e=>e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjQiIGN5PSIyNCIgcj0iMjQiIGZpbGw9IiNFNUU3RUIiLz4KPHBhdGggZD0iTTI0IDI0QzI3LjMxMzcgMjQgMzAgMjAuNjg2MyAzMCAxOEMzMCAxNS4zMTM3IDI3LjMxMzcgMTIgMjQgMTJDMTkuNjg2MyAxMiAxNSAxNS4zMTM3IDE1IDE4QzE1IDIwLjY4NjMgMTkuNjg2MyAyMC42ODYzIDI0IDI0IDI0IDI0WiIgZmlsbD0iIzlDQTQ5RiIvPgo8cGF0aCBkPSJNMzYgMzJDNTYgMjguNjg2MyAzMiAyNCAyOCAyNEgyMEMxMy41NzI5IDI0IDEwIDI4LjY4NjMgMTAgMzJWNDJIMzZWMzJaIiBmaWxsPSIjOUNBNEFGIi8+Cjwvc3ZnPgo="}),Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("div",{className:"font-semibold",children:e.name||e.username}),Nt.jsxs("div",{className:"text-xs text-gray-400",children:[e.role,"  ",e.status]})]}),Nt.jsx("div",{className:"text-sm text-indigo-600",children:"View"})]},e._id))})]})}function Cte(){const{id:e}=S(),[t,n]=f.useState(null),[r,a]=f.useState([]),[i,s]=f.useState(!0),[o,l]=f.useState("");return f.useEffect(()=>{h(null,null,function*(){var t,r,i;try{const r=zc(),i=localStorage.getItem("token"),s=i?{headers:{Authorization:`Bearer ${i}`},timeout:8e3}:{timeout:8e3},[o,l]=yield Promise.all([pt.get(`${r}/api/users/${e}`,s),pt.get(`${r}/api/media/feed?userId=${e}`,s)]);n(o.data),a((null==(t=l.data)?void 0:t.items)||[])}catch(bI){l((null==(i=null==(r=bI.response)?void 0:r.data)?void 0:i.message)||bI.message||"Failed")}finally{s(!1)}})},[e]),i?Nt.jsx("div",{className:"p-6",children:"Loading"}):o?Nt.jsx("div",{className:"p-6 text-red-500",children:o}):Nt.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[Nt.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[Nt.jsx("img",{src:t.avatarUrl?`${zc()}${t.avatarUrl}?t=${Date.now()}`:"/favicon.ico",className:"w-20 h-20 rounded-full object-cover",alt:"avatar",onError:e=>e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNFNUU3RUIiLz4KPHBhdGggZD0iTTQwIDQwQzQ1LjUyMjggNDAgNTAgMzQuNDc3MiA1MCAyOUM1MCAyMy40NzcyIDQ1LjUyMjggMTggNDAgMThDMzQuNDc3MiAxOCAzMCAyMy40NzcyIDMwIDI5QzMwIDM0LjQ3NzIgMzQuNDc3MiAzNC40NzcyIDQwIDQwIDQwIDQwWiIgZmlsbD0iIzlDQTQ5RiIvPgo8cGF0aCBkPSJNNjAgNTJDNTYgNDYuODYzNiA0MCA0MiA0MCA0Mkg0MEMxMy41NzI5IDQyIDEwIDQ2Ljg2MzYgMTAgNTJWODJINjBWNTRaIiBmaWxsPSIjOUNBNEFGIi8+Cjwvc3ZnPgo="}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-xl font-semibold",children:t.name||t.username}),Nt.jsxs("div",{className:"text-sm text-gray-400",children:[t.username,"  ",t.role]})]})]}),Nt.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Posts"}),Nt.jsxs("div",{className:"space-y-3",children:[0===r.length&&Nt.jsx("div",{className:"text-sm text-gray-500",children:"No posts yet"}),r.map(e=>Nt.jsxs("div",{className:"border rounded overflow-hidden",children:[e.imageUrl&&Nt.jsx("img",{src:`${zc()}${e.imageUrl}`,alt:"post",className:"w-full object-cover max-h-[600px]"}),e.caption&&Nt.jsx("div",{className:"p-3 text-sm text-gray-700 dark:text-gray-300",children:e.caption})]},e._id))]})]})}function Mte(){const e=zc(),{user:t,setUser:n}=f.useContext($c),[r,a]=f.useState(!1),[i,s]=f.useState(null),[o,d]=f.useState(!1),u=f.useRef(null),p=f.useRef(null),m=e=>h(null,null,function*(){var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;if(!n.type.startsWith("image/")||!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(n.type.toLowerCase()))return void alert("Please select a valid image file (JPEG, PNG, GIF, or WebP)");if(n.size>10485760)return void alert("Profile picture must be  10MB");const r=new FileReader;r.onload=()=>{const e=r.result;e&&e.startsWith("data:image/")?(s(e),d(!0)):alert("Failed to read image file. Please try a different image.")},r.onerror=()=>{alert("Failed to read the selected file. Please try again.")},r.readAsDataURL(n)});return t?Nt.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[Nt.jsx("h1",{className:"text-2xl font-bold mb-6",children:"My Profile"}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Profile Picture"}),Nt.jsxs("div",{className:"flex items-center gap-6 mb-4",children:[Nt.jsx("div",{className:"relative",children:t.avatarUrl?Nt.jsx("img",{src:`${e}${t.avatarUrl}?t=${Date.now()}`,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-gray-200 dark:border-gray-600",onError:e=>e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNFNUU3RUIiLz4KPHBhdGggZD0iTTQwIDQwQzQ1LjUyMjggNDAgNTAgMzQuNDc3MiA1MCAyOUM1MCAyMy40NzcyIDQ1LjUyMjggMTggNDAgMThDMzQuNDc3MiAxOCAzMCAyMy40NzcyIDMwIDI5QzMwIDM0LjQ3NzIgMzQuNDc3MiAzNC40NzcyIDQwIDQwIDQwIDQwWiIgZmlsbD0iIzlDQTQ5RiIvPgo8cGF0aCBkPSJNNjAgNTJDNTYgNDYuODYzNiA0MCA0MiA0MCA0Mkg0MEMxMy41NzI5IDQyIDEwIDQ2Ljg2MzYgMTAgNTJWODJINjBWNTRaIiBmaWxsPSIjOUNBNEFGIi8+Cjwvc3ZnPgo="}):Nt.jsx(G,{className:"w-24 h-24 text-gray-400"})}),Nt.jsx("div",{className:"flex-1",children:Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsxs("button",{onClick:()=>{var e;null==(e=u.current)||e.click()},disabled:r,className:"w-full flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition disabled:opacity-50",children:[Nt.jsx(Ue,{size:16}),"Choose from Gallery"]}),Nt.jsxs("button",{onClick:()=>{var e;null==(e=p.current)||e.click()},disabled:r,className:"w-full flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition disabled:opacity-50",children:[Nt.jsx(Y,{size:16}),"Take Photo"]}),t.avatarUrl&&Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var r,a;if(confirm("Are you sure you want to remove your profile picture?"))try{const r=localStorage.getItem("token");yield pt.delete(`${e}/api/users/me/avatar`,{headers:{Authorization:`Bearer ${r}`}}),n(c(l({},t),{avatarUrl:"",avatarSizes:{sm:"",md:"",lg:""}})),alert("Profile picture removed successfully!"),window.refreshFeed&&window.refreshFeed()}catch(i){console.error("Failed to remove avatar:",i),alert("Failed to remove profile picture: "+((null==(a=null==(r=i.response)?void 0:r.data)?void 0:a.message)||i.message))}}),className:"w-full flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:[Nt.jsx(ce,{size:16}),"Remove Picture"]})]})})]}),r&&Nt.jsxs("div",{className:"text-center text-blue-600",children:[Nt.jsx("div",{className:"animate-spin inline-block w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}),"Uploading..."]})]}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Profile Information"}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),Nt.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded border",children:t.name||"Not set"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),Nt.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded border",children:t.username})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),Nt.jsx("div",{className:"p-2 bg-gray-50 dark:bg-gray-700 rounded border capitalize",children:t.role})]})]}),Nt.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:["To edit your name and username, go to ",Nt.jsx("strong",{children:"Settings"})," in the sidebar."]})]}),Nt.jsx("input",{ref:u,onChange:m,accept:"image/*",type:"file",className:"hidden"}),Nt.jsx("input",{ref:p,onChange:m,accept:"image/*",capture:"environment",type:"file",className:"hidden"}),o&&i&&Nt.jsx(td,{initialImage:i,onClose:()=>{d(!1),s(null)},onSaved:t=>h(null,null,function*(){var r,i,o;if(null==t?void 0:t.image){a(!0);try{const a=localStorage.getItem("token"),i=new FormData;i.append("avatar",t.image);const s=yield pt.put(`${e}/api/users/me/avatar`,i,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"}});(null==(r=s.data)?void 0:r.user)&&(n(s.data.user),alert("Profile picture updated successfully!"),window.refreshFeed&&window.refreshFeed())}catch(l){console.error("Failed to upload avatar:",l),alert("Failed to update profile picture: "+((null==(o=null==(i=l.response)?void 0:i.data)?void 0:o.message)||l.message))}finally{a(!1),d(!1),s(null)}}})})]}):Nt.jsx("div",{className:"p-6",children:"Loading..."})}const kte=()=>{const[e,t]=f.useState([]),[n,r]=f.useState(!0),[a,i]=f.useState(null),[s,o]=f.useState(null),l=()=>h(null,null,function*(){try{r(!0),i(null);const e=(yield pt.get("https://rmi-backend-zhdr.onrender.com/api/external-betting/leaderboard")).data.data||[];console.log(`Loaded ${e.length} fights for today from backend`),t(e),o(new Date)}catch(e){console.error("Error fetching leaderboard data:",e),i("Failed to load fight data")}finally{r(!1)}});f.useEffect(()=>{l();const e=setInterval(l,6e4);return()=>clearInterval(e)},[]);if(n)return Nt.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black text-white flex items-center justify-center",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),Nt.jsx("p",{className:"text-lg",children:"Loading today's fight results..."})]})});if(a)return Nt.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black text-white p-6",children:Nt.jsx("div",{className:"max-w-4xl mx-auto",children:Nt.jsxs("div",{className:"bg-red-900 border border-red-700 rounded-lg p-6 text-center",children:[Nt.jsx("h2",{className:"text-xl font-bold text-red-200 mb-2",children:"Unable to Load Data"}),Nt.jsx("p",{className:"text-red-300",children:a}),Nt.jsx("button",{onClick:l,className:"mt-4 bg-red-800 hover:bg-red-700 text-white px-4 py-2 rounded-lg",children:"Try Again"})]})})});const c=e.length,d=e.filter(e=>e.result1&&"draw"!==e.result1).length,u=e.reduce((e,t)=>{if(t.details&&t.result1&&"draw"!==t.result1){return e+.055*(t.details.redTotalBetAmount+t.details.blueTotalBetAmount+(t.details.drawTotalBetAmount||0))}return e},0);return Nt.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black text-white",children:[Nt.jsx("div",{className:"bg-gradient-to-r from-blue-900 to-purple-900 shadow-lg",children:Nt.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"RMI Chicken Fight Results"}),Nt.jsx("p",{className:"text-blue-200 text-lg",children:"Today's Live Fight Results"})]}),Nt.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[Nt.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-6 text-center",children:[Nt.jsx("div",{className:"text-3xl font-bold text-white",children:c}),Nt.jsx("div",{className:"text-blue-200",children:"Total Fights Today"})]}),Nt.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-6 text-center",children:[Nt.jsx("div",{className:"text-3xl font-bold text-green-400",children:d}),Nt.jsx("div",{className:"text-blue-200",children:"Completed Fights"})]}),Nt.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-6 text-center",children:[Nt.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:(p=u,new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(p))}),Nt.jsx("div",{className:"text-blue-200",children:"Total Commission"})]})]}),s&&Nt.jsxs("div",{className:"text-center mt-4 text-sm text-blue-300",children:["Last updated: ",s.toLocaleTimeString()]})]})}),Nt.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.length>0&&Nt.jsxs("div",{className:"mb-8",children:[Nt.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Today's Fight Numbers"}),Nt.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 border border-gray-700",children:[Nt.jsx("div",{className:"grid grid-cols-7 gap-3 justify-center max-w-2xl",children:e.slice(0,16).map((e,t)=>{var n;return Nt.jsx("div",{className:"flex items-center justify-center w-14 h-14 rounded-full bg-gradient-to-br from-blue-600 to-blue-800 border-2 border-blue-400 shadow-lg hover:shadow-blue-500/50 transition-all hover:scale-110 cursor-pointer",children:Nt.jsx("span",{className:"text-white font-bold text-lg",children:(null==(n=e.batch)?void 0:n.fightSequence)||e.id})},e.id)})}),e.length>16&&Nt.jsxs("div",{className:"text-center text-gray-400 text-sm mt-6",children:["Showing first 16 fights (Total: ",e.length,")"]})]})]}),Nt.jsx("div",{className:"grid gap-4",children:0===e.length?Nt.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[Nt.jsx("p",{className:"text-gray-400 text-lg",children:"No fights completed today yet."}),Nt.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Check back later for live results!"})]}):e.map(e=>{var t,n,r,a,i;return Nt.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 hover:border-gray-600 transition-colors",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("div",{className:"flex items-center space-x-4",children:[Nt.jsxs("div",{className:"text-2xl font-bold text-gray-300",children:["Fight #",(null==(t=e.batch)?void 0:t.fightSequence)||e.id]}),Nt.jsx("div",{className:"px-3 py-1 rounded-full text-sm font-semibold "+("red"===e.result1?"bg-red-900 text-red-200":"blue"===e.result1?"bg-blue-900 text-blue-200":"draw"===e.result1?"bg-green-900 text-green-200":"bg-gray-700 text-gray-300"),children:e.result1?"red"===e.result1?"MERON":"blue"===e.result1?"WALA":e.result1.toUpperCase():"PENDING"})]}),Nt.jsx("div",{className:"text-right",children:Nt.jsx("div",{className:"text-sm text-gray-400",children:(i=e.createdAt,new Date(i).toLocaleTimeString("en-PH",{hour:"2-digit",minute:"2-digit"}))})})]}),e.details&&Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[Nt.jsxs("div",{className:"bg-gray-700 rounded p-3",children:[Nt.jsx("div",{className:"text-red-400 font-semibold",children:"MERON (Red)"}),Nt.jsxs("div",{className:"text-white",children:["",(null==(n=e.details.redTotalBetAmount)?void 0:n.toLocaleString())||"0"]}),Nt.jsxs("div",{className:"text-gray-400 text-xs",children:["Odds: ",e.details.redOdds||"N/A"]})]}),Nt.jsxs("div",{className:"bg-gray-700 rounded p-3",children:[Nt.jsx("div",{className:"text-blue-400 font-semibold",children:"WALA (Blue)"}),Nt.jsxs("div",{className:"text-white",children:["",(null==(r=e.details.blueTotalBetAmount)?void 0:r.toLocaleString())||"0"]}),Nt.jsxs("div",{className:"text-gray-400 text-xs",children:["Odds: ",e.details.blueOdds||"N/A"]})]}),Nt.jsxs("div",{className:"bg-gray-700 rounded p-3",children:[Nt.jsx("div",{className:"text-green-400 font-semibold",children:"DRAW"}),Nt.jsxs("div",{className:"text-white",children:["",(null==(a=e.details.drawTotalBetAmount)?void 0:a.toLocaleString())||"0"]}),Nt.jsxs("div",{className:"text-gray-400 text-xs",children:["Odds: ",e.details.drawOdds||"N/A"]})]})]}),Nt.jsx("div",{className:"mt-4 pt-4 border-t border-gray-600",children:Nt.jsxs("div",{className:"flex justify-between text-sm text-gray-400",children:[Nt.jsxs("span",{children:["Total Bets: ",e.details?(e.details.redTotalBetAmount+e.details.blueTotalBetAmount+(e.details.drawTotalBetAmount||0)).toLocaleString():"0"]}),e.result1&&"draw"!==e.result1&&e.details&&Nt.jsxs("span",{children:["Commission: ",(.055*(e.details.redTotalBetAmount+e.details.blueTotalBetAmount+(e.details.drawTotalBetAmount||0))).toLocaleString()]})]})})]},e.id)})})]}),Nt.jsx("div",{className:"bg-gray-800 border-t border-gray-700 mt-12",children:Nt.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-6 text-center text-gray-400 text-sm",children:[Nt.jsx("p",{children:"RMI Teller Report System - Today's Chicken Fight Results"}),Nt.jsx("p",{className:"mt-1",children:"Data updates automatically every minute"})]})})]});var p};function Ete(){var e,t,n,r,a,i,s,o;const[l,c]=f.useState(null),[d,u]=f.useState(!0),[p,m]=f.useState(null),[g,x]=f.useState(null),y=()=>h(null,null,function*(){try{u(!0),m(null);const e=`${zc()}/api/external-betting/gta-leaderboard-proxy`,t=yield pt.get(e);if(!t.data.success||!t.data.data)throw new Error("Invalid data format from API");c(t.data.data),x(new Date)}catch(e){const t=e.message||"Failed to fetch GTA leaderboard data";m(t),console.error("Leaderboard fetch error:",t,e)}finally{u(!1)}});f.useEffect(()=>{y();const e=setInterval(y,3e4);return()=>clearInterval(e)},[]);return d?Nt.jsx("div",{className:"min-h-screen bg-black dark:bg-gray-900 text-white flex items-center justify-center",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),Nt.jsx("span",{className:"text-lg",children:"Loading GTA leaderboard..."})]})}):p?Nt.jsx("div",{className:"min-h-screen bg-black dark:bg-gray-900 text-white p-6",children:Nt.jsx("div",{className:"bg-red-900 dark:bg-red-900/30 border border-red-700 rounded-lg p-4 max-w-2xl mx-auto",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx(M,{className:"text-red-400 flex-shrink-0 mr-3",size:20}),Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"text-sm font-medium text-red-200",children:"Error Loading Data"}),Nt.jsx("div",{className:"mt-2 text-sm text-red-300",children:p}),Nt.jsx("button",{onClick:y,className:"mt-4 bg-red-800 hover:bg-red-700 text-red-200 px-3 py-2 rounded-md text-sm font-medium",children:"Try Again"})]})]})})}):Nt.jsxs("div",{className:"min-h-screen bg-black dark:bg-gray-900 text-white font-sans",children:[Nt.jsx("div",{className:"bg-gray-900 dark:bg-gray-800 border-b border-gray-700 px-6 py-4 sticky top-0 z-10",children:Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Nt.jsxs("div",{className:"flex items-center space-x-4",children:[Nt.jsx(X,{size:24,className:"text-yellow-400"}),Nt.jsx("h1",{className:"text-2xl font-bold text-white",children:" GTA Leaderboards"})]}),Nt.jsxs("button",{onClick:y,disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50",title:"Refresh data",children:[Nt.jsx(Ae,{size:18,className:d?"animate-spin":""}),"Refresh"]})]}),Nt.jsxs("div",{className:"flex justify-between items-center text-sm",children:[Nt.jsxs("div",{className:"text-gray-400",children:[(new Date).toLocaleString("en-PH",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),"  ",(new Date).toLocaleString("en-PH",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).toUpperCase()]}),g&&Nt.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",g.toLocaleTimeString()]})]})]})}),Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"max-w-7xl mx-auto",children:l?Nt.jsx("div",{className:"space-y-6",children:Array.isArray(l)&&l.length>0?Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[Nt.jsxs("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg p-4",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Total Players"}),Nt.jsx("div",{className:"text-2xl font-bold text-blue-400",children:l.length})]}),(null==(e=l[0])?void 0:e.score)&&Nt.jsxs("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg p-4",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Top Score"}),Nt.jsx("div",{className:"text-2xl font-bold text-green-400",children:null==(t=l[0].score)?void 0:t.toLocaleString()})]}),(null==(n=l[0])?void 0:n.points)&&Nt.jsxs("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg p-4",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Top Points"}),Nt.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:null==(r=l[0].points)?void 0:r.toLocaleString()})]}),Nt.jsxs("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg p-4",children:[Nt.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Last Updated"}),Nt.jsx("div",{className:"text-sm font-bold text-purple-400",children:null==g?void 0:g.toLocaleTimeString()})]})]}),Nt.jsx("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg overflow-hidden",children:Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:"bg-gray-700 dark:bg-gray-600 border-b border-gray-700",children:[Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-yellow-400",children:"Rank"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-300",children:"Player Name"}),void 0!==(null==(a=l[0])?void 0:a.score)&&Nt.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-300",children:"Score"}),void 0!==(null==(i=l[0])?void 0:i.points)&&Nt.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-300",children:"Points"}),void 0!==(null==(s=l[0])?void 0:s.wins)&&Nt.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-300",children:"Wins"}),void 0!==(null==(o=l[0])?void 0:o.losses)&&Nt.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-300",children:"Losses"})]})}),Nt.jsx("tbody",{children:l.map((e,t)=>{var n,r;return Nt.jsxs("tr",{className:`border-b border-gray-700 ${t%2==0?"bg-gray-800 dark:bg-gray-750":"bg-gray-750 dark:bg-gray-700"} hover:bg-gray-700 dark:hover:bg-gray-600 transition`,children:[Nt.jsxs("td",{className:"px-6 py-4 text-sm font-bold text-yellow-400",children:["#",t+1]}),Nt.jsx("td",{className:"px-6 py-4 text-sm",children:Nt.jsx("div",{className:"font-medium text-white",children:e.name||e.username||"Unknown"})}),void 0!==e.score&&Nt.jsx("td",{className:"px-6 py-4 text-sm text-right text-blue-400 font-medium",children:null==(n=e.score)?void 0:n.toLocaleString()}),void 0!==e.points&&Nt.jsx("td",{className:"px-6 py-4 text-sm text-right text-green-400 font-medium",children:null==(r=e.points)?void 0:r.toLocaleString()}),void 0!==e.wins&&Nt.jsx("td",{className:"px-6 py-4 text-sm text-right text-blue-400 font-medium",children:e.wins}),void 0!==e.losses&&Nt.jsx("td",{className:"px-6 py-4 text-sm text-right text-red-400 font-medium",children:e.losses})]},t)})})]})})})]}):Nt.jsx("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg p-8 text-center",children:Nt.jsx("p",{className:"text-gray-400",children:"Loading or no leaderboard data available"})})}):Nt.jsx("div",{className:"bg-gray-800 dark:bg-gray-700 border border-gray-700 rounded-lg p-8 text-center",children:Nt.jsx("p",{className:"text-gray-400",children:"No leaderboard data available"})})})})]})}function Tte(){const[e,t]=f.useState(null),[n,r]=f.useState(!0),[a,i]=f.useState(null),s=()=>h(null,null,function*(){try{r(!0),i(null);const e="https://rmi-backend-zhdr.onrender.com/api/leaderboard/gta",n=yield fetch(e);if(!n.ok){const e=yield n.json().catch(()=>({}));throw new Error(e.error||`HTTP Error: ${n.status}`)}const a=yield n.json();t(a)}catch(e){const t=e.message||"Failed to fetch betting event reports";i(t),console.error("Betting reports fetch error:",t,e)}finally{r(!1)}});f.useEffect(()=>{s();const e=setInterval(s,3e4);return()=>clearInterval(e)},[]);return Nt.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Nt.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"BETTING EVENT REPORTS"}),Nt.jsxs("div",{className:"flex gap-2",children:[e&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("button",{onClick:()=>{if(!e)return;const t=document.createElement("a"),n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});t.href=URL.createObjectURL(n),t.download=`betting-event-reports-${(new Date).getTime()}.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",title:"Download as JSON",children:[Nt.jsx(E,{size:18}),"JSON"]}),Nt.jsxs("button",{onClick:()=>{if(!e||!Array.isArray(e))return;const t=Object.keys(e[0]||{}),n=[t.join(","),...e.map(e=>t.map(t=>{const n=e[t];return"string"==typeof n&&n.includes(",")?`"${n.replace(/"/g,'""')}"`:n}).join(","))].join("\n"),r=document.createElement("a"),a=new Blob([n],{type:"text/csv"});r.href=URL.createObjectURL(a),r.download=`betting-event-reports-${(new Date).getTime()}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",title:"Download as CSV",children:[Nt.jsx(E,{size:18}),"CSV"]})]}),Nt.jsxs("button",{onClick:s,disabled:n,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[Nt.jsx(Ae,{size:18,className:n?"animate-spin":""}),"Refresh"]})]})]}),a&&Nt.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex gap-3",children:[Nt.jsx(M,{className:"text-red-600 flex-shrink-0",size:20}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold text-red-800",children:"Error fetching data"}),Nt.jsx("p",{className:"text-red-700 text-sm",children:a})]})]}),n&&!e&&Nt.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[Nt.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full mx-auto mb-4"}),Nt.jsx("p",{className:"text-gray-600",children:"Loading betting event reports..."})]}),e&&!n&&Nt.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:Nt.jsxs("div",{className:"p-6",children:[Array.isArray(e)?Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:["Events (",e.length," total)"]}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full border-collapse",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:"bg-blue-50",children:[Nt.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold",children:"Event ID"}),Nt.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold",children:"Date/Time"}),Nt.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold",children:"Type"}),Nt.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right font-semibold",children:"Amount"}),Nt.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold",children:"Status"}),Nt.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold",children:"Details"})]})}),Nt.jsx("tbody",{children:e.map((e,t)=>Nt.jsxs("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[Nt.jsx("td",{className:"border border-gray-300 px-4 py-2 font-mono text-sm",children:e.id||e.eventId||t+1}),Nt.jsx("td",{className:"border border-gray-300 px-4 py-2 text-sm",children:e.date||e.timestamp||e.createdAt||"N/A"}),Nt.jsx("td",{className:"border border-gray-300 px-4 py-2 text-sm",children:e.type||e.eventType||"Event"}),Nt.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right font-bold",children:e.amount||e.total||0}),Nt.jsx("td",{className:"border border-gray-300 px-4 py-2",children:Nt.jsx("span",{className:"inline-block px-2 py-1 rounded text-xs font-semibold "+("completed"===e.status||"finished"===e.status?"bg-green-100 text-green-800":"pending"===e.status||"active"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status||"pending"})}),Nt.jsx("td",{className:"border border-gray-300 px-4 py-2 text-xs text-gray-600",children:e.description||e.note||""})]},t))})]})})]}):Nt.jsxs("div",{children:[Nt.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Raw Data"}),Nt.jsx("div",{className:"bg-gray-100 p-4 rounded text-sm font-mono overflow-x-auto max-h-96 overflow-y-auto",children:Nt.jsx("pre",{children:JSON.stringify(e,null,2)})})]}),Nt.jsxs("div",{className:"mt-6 grid grid-cols-4 gap-4",children:[Nt.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"Total Events"}),Nt.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Array.isArray(e)?e.length:"N/A"})]}),Nt.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"Last Updated"}),Nt.jsx("p",{className:"text-sm font-bold text-green-600",children:(new Date).toLocaleTimeString()})]}),Nt.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"Data Source"}),Nt.jsx("p",{className:"text-xs font-bold text-purple-600",children:"Reverb Leaderboard"})]}),Nt.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"Report Status"}),Nt.jsx("p",{className:"text-sm font-bold text-orange-600",children:"Live"})]})]})]})}),e&&!n&&0===Object.keys(e).length&&Nt.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:Nt.jsx("p",{className:"text-yellow-800",children:"No betting event data available at this moment."})})]})})}function Pte(){var e;const{user:t,settings:n}=f.useContext($c),{showToast:r}=Kc(),a=y(),i="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),s=zc(),[o,d]=f.useState([]),[u,p]=f.useState(!1),[m,g]=f.useState(3),[x,v]=f.useState("week"),[b,w]=f.useState(!1),[N,S]=f.useState(0),[j,_]=f.useState(!1),[A,C]=f.useState(""),[M,E]=f.useState("");f.useEffect(()=>{const e=new Date,t=(e.getDay()+6)%7,n=new Date(e);n.setDate(e.getDate()-t);const r=new Date(n);r.setDate(n.getDate()+6),C(n.toISOString().slice(0,10)),E(r.toISOString().slice(0,10))},[]);const[T,P]=f.useState(!1),[D,I]=f.useState([]),[B,L]=f.useState(null),[F,z]=f.useState(!1),[H,G]=f.useState(!1),[V,$]=f.useState(""),[Y,X]=f.useState(0),[K,q]=f.useState([]),[J,Q]=f.useState([]),[Z,ee]=f.useState(null),[te,ne]=f.useState(null),[re,ae]=f.useState([]),[ie,se]=f.useState(0),[oe,le]=f.useState([]),[de,ue]=f.useState(!1),[he,pe]=f.useState(!1),[me,ge]=f.useState(null),[fe,xe]=f.useState([]),[ye,ve]=f.useState((new Date).toISOString().slice(0,10)),be=((null==t?void 0:t.username)||"").toLowerCase().includes("alfonso"),we="supervisor"===(null==t?void 0:t.role)||"admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role)||be,Ne="admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role)||be,je="admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role)||be,_e="declarator"===(null==t?void 0:t.role);f.useEffect(()=>{console.log(" useEffect triggered for todayDate:",ye),Ce(),Me(),we&&ke(),Ee();try{const e=new Date(ye),t=(e.getDay()+6)%7,n=new Date(e);n.setDate(e.getDate()-t);const r=n.toISOString().slice(0,10);ee(r)}catch(bI){console.warn("Failed to calculate week start",bI.message)}},[ye,x,j,A]),f.useEffect(()=>{const e=Vc();if(e)return e.on("scheduleUpdated",e=>{console.log(" Schedule update:",e),d(t=>t.map(t=>t.tellerId===e.tellerId?c(l({},t),{status:e.status}):t)),r({type:"present"===e.status?"success":"absent"===e.status?"warning":"info",message:`${e.tellerName} marked ${e.status}`})}),()=>{e.off("scheduleUpdated"),e.off("userPenaltyCleared")}},[]),f.useEffect(()=>{const e=Vc();if(!e)return;const t=e=>{console.log(" Penalty cleared event received:",e),ke(),Ce()};return e.on("userPenaltyCleared",t),()=>e.off("userPenaltyCleared",t)},[Z]);const Ce=()=>h(null,null,function*(){var e,t,n,a,i,o,l;try{p(!0);const n=localStorage.getItem("token");if(!n)return console.error(" No token found in localStorage"),r({type:"error",message:"Authentication required. Please log in again."}),void p(!1);if(j&&A&&M){console.log(" Fetching assignments for custom range:",A,"to",M);const e=new Date(A),t=new Date(M),r=[],a=new Date(e);for(;a<=t;){const e=a.toISOString().slice(0,10);try{const t=yield pt.get(`${s}/api/schedule/by-date/${e}`,{headers:{Authorization:`Bearer ${n}`},timeout:3e4});t.data.schedule&&t.data.schedule.length>0&&(r.push(...t.data.schedule),console.log(`   ${e}: ${t.data.schedule.length} assignments`))}catch(c){console.log(`   ${e}: No data or error`,c.message)}a.setDate(a.getDate()+1)}console.log(" Total assignments in range:",r.length),d(r)}else{let r=`?range=${x}`;console.log(" Fetching tomorrow schedule with query:",r);const a=yield pt.get(`${s}/api/schedule/tomorrow${r}`,{headers:{Authorization:`Bearer ${n}`},timeout:3e4});console.log(" /api/schedule/tomorrow response:",null==(t=null==(e=a.data)?void 0:e.schedule)?void 0:t.map(e=>({id:e._id,tellerName:e.tellerName,rangeWorkDays:e.rangeWorkDays,range:e.range}))),d(a.data.schedule||[])}}catch(c){console.error(" Failed to fetch schedule:",c);let e="Failed to load schedule data.";401===(null==(n=c.response)?void 0:n.status)?e="Session expired. Please log in again.":403===(null==(a=c.response)?void 0:a.status)?e="Permission denied to view schedule.":500===(null==(i=c.response)?void 0:i.status)?e=`Server error: ${(null==(l=null==(o=c.response)?void 0:o.data)?void 0:l.message)||"Internal server error"}`:"ECONNABORTED"===c.code?e="Request timeout (30s). Backend might be slow.":"ECONNREFUSED"===c.code?e="Cannot connect to backend.":c.message&&(e=`Error: ${c.message}`),r({type:"error",message:e})}finally{p(!1)}}),Me=(e=null)=>h(null,null,function*(){try{let e;if(j&&A)e=A;else{const t=new Date;t.setDate(t.getDate()+1),e=t.toISOString().slice(0,10)}const t=localStorage.getItem("token"),n=yield pt.get(`${s}/api/schedule/suggest/${e}`,{headers:{Authorization:`Bearer ${t}`}});q(n.data.suggestions||[])}catch(e){console.error(" Failed to load suggested tellers:",e)}}),ke=()=>h(null,null,function*(){try{const e=localStorage.getItem("token"),t=(yield pt.get(`${s}/api/admin/users`,{headers:{Authorization:`Bearer ${e}`}})).data.filter(e=>"teller"===e.role||"supervisor_teller"===e.role);Q(t||[])}catch(e){console.error(" Failed to load all tellers:",e),Q([])}}),Ee=()=>h(null,null,function*(){try{console.log(" Fetching working tellers for date:",ye);const e=localStorage.getItem("token"),t=yield pt.get(`${s}/api/schedule/today-working/${ye}`,{headers:{Authorization:`Bearer ${e}`}});console.log(" Working tellers response:",t.data),xe(t.data.tellers||[])}catch(e){console.error(" Failed to load today's working tellers:",e),xe([])}}),Te=(...e)=>h(null,[...e],function*(e=Z){if(e)try{const t=localStorage.getItem("token"),n=yield pt.get(`${s}/api/schedule/full-week/${e}`,{headers:{Authorization:`Bearer ${t}`}});ne(n.data.selection||null),n.data.selection?(ae((n.data.selection.tellerIds||[]).map(e=>e._id)),se(n.data.selection.count||(n.data.selection.tellerIds||[]).length||0)):(ae([]),se(0))}catch(t){console.error(" Failed to fetch full-week selection:",t)}}),Pe=()=>h(null,null,function*(){if(!Z)return r({type:"error",message:"Week start not set"});try{pe(!0);const e=localStorage.getItem("token"),t={weekKey:Z,tellerIds:re,count:ie,confirmApply:!0},n=yield pt.put(`${s}/api/schedule/full-week`,t,{headers:{Authorization:`Bearer ${e}`}});n.data&&n.data.applied?(ge(n.data.auditId||null),yield Te(Z),yield Ce(),ue(!1),r({type:"success",message:"Full-week applied. You can undo from the confirmation."})):r({type:"error",message:"Failed to apply full-week selection"})}catch(e){console.error(" Failed to apply full-week selection",e),r({type:"error",message:"Failed to apply full-week selection"})}finally{pe(!1)}}),De=e=>h(null,null,function*(){L(e),z(!0),P(!0);try{const t=localStorage.getItem("token"),n=yield pt.get(`${s}/api/schedule/suggest/${e.dayKey}`,{headers:{Authorization:`Bearer ${t}`}});I(n.data.suggestions||[])}catch(t){console.error("? Error fetching replacement suggestions:",t),r({type:"error",message:"Failed to load replacement suggestions."})}finally{z(!1)}}),Re=e=>h(null,null,function*(){try{if(!o.find(t=>t._id===e))return;const t=localStorage.getItem("token");yield pt.put(`${s}/api/schedule/mark-present/${e}`,{},{headers:{Authorization:`Bearer ${t}`}}),r({type:"success",message:"Marked teller as present."}),Ce(),Me()}catch(t){console.error(" Error marking present:",t),r({type:"error",message:"Failed to mark present."})}});f.useEffect(()=>{Z&&J.length&&Te(Z)},[Z,J]);const Be=e=>{const t=o.find(t=>t._id===e);t&&(e=>{L(e),$(""),X(0),G(!0)})(t)},Le=e=>h(null,null,function*(){if(window.confirm("Are you sure you want to remove this assignment?"))try{const t=localStorage.getItem("token");yield pt.delete(`${s}/api/schedule/assignment/${e}`,{headers:{Authorization:`Bearer ${t}`}}),r({type:"success",message:"Assignment removed successfully."}),Ce(),Me()}catch(t){console.error(" Error removing assignment:",t),r({type:"error",message:"Failed to remove assignment."})}}),Fe=Array.isArray(o)?o:[],Ue=Fe[N]||null;let ze=[];try{if(Array.isArray(D)&&Array.isArray(Fe)){const e=new Set(Fe.map(e=>null==e?void 0:e.tellerId).filter(Boolean).map(e=>String(e)));ze=D.filter(t=>!!(null==t?void 0:t._id)&&!e.has(String(t._id)))}}catch(He){console.error("Error filtering suggestions:",He),ze=D||[]}return Nt.jsxs("div",{className:"p-6 min-h-screen "+(i?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsxs("div",{children:[Nt.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[Nt.jsx(Se,{className:"w-6 h-6 text-indigo-500"}),"Teller Schedule Rotation"]}),Nt.jsx("p",{className:"text-sm opacity-70",children:"Manage tomorrows teller assignments and track attendance."})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[("supervisor"===(null==t?void 0:t.role)||"admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role))&&Nt.jsxs("button",{onClick:()=>a("/attendance-scheduler"),className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:[Nt.jsx(Xe,{className:"w-4 h-4"}),"AI Attendance Scheduler"]}),("admin"===(null==t?void 0:t.role)||"super_admin"===(null==t?void 0:t.role))&&Nt.jsxs("button",{onClick:()=>h(null,null,function*(){if(window.confirm("Generate tomorrows schedule now?"))try{w(!0);const e=localStorage.getItem("token"),t=yield pt.get(`${s}/api/schedule/tomorrow?range=${x}`,{headers:{Authorization:`Bearer ${e}`}});d(t.data.schedule||[]),r({type:"success",message:"Tomorrows schedule generated successfully."})}catch(He){console.error(" Failed to generate tomorrows schedule:",He),r({type:"error",message:"Failed to generate tomorrows schedule."})}finally{w(!1)}}),disabled:b,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-semibold "+(b?"bg-gray-500 text-white":"bg-green-600 hover:bg-green-700 text-white"),children:[Nt.jsx(Ke,{className:"w-4 h-4"}),b?"Generating...":"Generate Tomorrow"]}),Nt.jsxs("button",{onClick:()=>{Ce(),Me(),Ne&&ke()},className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:opacity-90",children:[Nt.jsx(Ae,{className:"w-4 h-4"})," Refresh"]})]})]}),Nt.jsx("div",{className:"mb-8",children:Nt.jsx(VL,{})}),Nt.jsxs("div",{className:"rounded-lg shadow p-4 mb-8 "+(i?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:()=>{const e=new Date(j&&A?A:new Date);e.setDate(e.getDate()-1);const t=e.toISOString().slice(0,10);_(!0),C(t),E(t)},className:"px-3 py-1.5 text-sm bg-gray-600 text-white rounded-lg hover:opacity-90",children:"? Previous Day"}),Nt.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(Ie,{className:"w-5 h-5 text-indigo-500"}),j&&A?`Assignments for ${new Date(A).toLocaleDateString()}`:"Tomorrow's Assignments"]}),Nt.jsx("button",{onClick:()=>{const e=new Date(j&&M?M:new Date);e.setDate(e.getDate()+1);const t=e.toISOString().slice(0,10);_(!0),C(t),E(t)},className:"px-3 py-1.5 text-sm bg-gray-600 text-white rounded-lg hover:opacity-90",children:"Next Day ?"})]}),Nt.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[Nt.jsx("label",{className:"text-sm text-gray-400",children:"Filter by date range:"}),Nt.jsx("button",{onClick:()=>_(!j),className:"text-xs px-3 py-1.5 rounded-lg border "+(j?"bg-indigo-600 text-white border-indigo-600":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"),children:j?"Custom Range":"Use Custom"}),j?Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("input",{type:"date",value:A,onChange:e=>C(e.target.value),className:"text-sm p-2 rounded-lg border "+(i?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-200")}),Nt.jsx("span",{className:"text-gray-400",children:"to"}),Nt.jsx("input",{type:"date",value:M,onChange:e=>E(e.target.value),className:"text-sm p-2 rounded-lg border "+(i?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-200")})]}):Nt.jsxs("select",{value:x,onChange:e=>v(e.target.value),className:"text-sm p-2 rounded-lg border "+(i?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-200"),children:[Nt.jsx("option",{value:"week",children:"Week (Mon-Sun)"}),Nt.jsx("option",{value:"month",children:"This month"}),Nt.jsx("option",{value:"year",children:"This year"}),Nt.jsx("option",{value:"all",children:"All-time"})]})]})]}),Nt.jsx("div",{className:"mb-6 p-4 rounded-lg "+(i?"bg-gray-700":"bg-gray-50"),children:Nt.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("button",{onClick:()=>S(Math.max(0,N-1)),disabled:0===N||0===o.length,className:"px-4 py-2 rounded-lg text-sm font-medium transition "+(0===N||0===o.length?"opacity-50 cursor-not-allowed":i?"bg-gray-600 hover:bg-gray-500 text-white":"bg-gray-300 hover:bg-gray-400"),children:" Previous"}),Nt.jsx("span",{className:"text-sm font-semibold px-3 py-1 rounded-lg "+(i?"bg-gray-600":"bg-gray-200"),children:0===o.length?"0 of 0":`${N+1} of ${Fe.length}`}),Nt.jsx("button",{onClick:()=>S(Math.min(Fe.length-1,N+1)),disabled:N>=Fe.length-1||0===o.length,className:"px-4 py-2 rounded-lg text-sm font-medium transition "+(N>=Fe.length-1||0===o.length?"opacity-50 cursor-not-allowed":i?"bg-gray-600 hover:bg-gray-500 text-white":"bg-gray-300 hover:bg-gray-400"),children:"Next "})]})})}),u?Nt.jsx("div",{className:"text-center text-gray-400 py-6",children:"Loading..."}):0===o.length?Nt.jsx("div",{className:"text-center text-gray-400 py-6",children:"No teller assignments found."}):Ue?Nt.jsxs("div",{className:"p-4 rounded-lg "+(i?"bg-gray-800":"bg-white"),children:[Nt.jsx("div",{className:"mb-6 p-4 rounded-lg border-2 border-indigo-500",children:Nt.jsxs("div",{className:"flex items-start justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"text-xl font-bold",children:Ue.tellerName||"Unknown"}),Nt.jsxs("p",{className:"text-sm mt-2 "+("present"===Ue.status?"text-green-500":"absent"===Ue.status?"text-red-500":"text-yellow-500"),children:["Status: ",Nt.jsx("span",{className:"font-semibold",children:(Ue.status||"pending").toUpperCase()})]}),Nt.jsxs("p",{className:"text-sm mt-1 text-gray-400",children:["Days Worked: ",Nt.jsxs("span",{className:"font-semibold",children:[Ue.rangeWorkDays||0," days"]})]})]}),!_e&&Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>Re(Ue._id),className:"flex items-center gap-1 px-3 py-2 text-xs rounded-lg bg-green-600 text-white hover:opacity-90",children:[Nt.jsx(k,{className:"w-4 h-4"})," Present"]}),je&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("button",{onClick:()=>De(Ue),className:"flex items-center gap-1 px-3 py-2 text-xs rounded-lg bg-blue-600 text-white hover:opacity-90",children:[Nt.jsx(O,{className:"w-4 h-4"})," Replace"]}),Nt.jsxs("button",{onClick:()=>Be(Ue._id),className:"flex items-center gap-1 px-3 py-2 text-xs rounded-lg bg-red-600 text-white hover:opacity-90",children:[Nt.jsx(ce,{className:"w-4 h-4"})," Absent"]}),Nt.jsxs("button",{onClick:()=>Le(Ue._id),className:"flex items-center gap-1 px-3 py-2 text-xs rounded-lg bg-orange-600 text-white hover:opacity-90",children:[Nt.jsx(R,{className:"w-4 h-4"})," Remove"]})]})]})]})}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"w-full text-sm",children:[Nt.jsx("thead",{className:(i?"bg-gray-700":"bg-gray-100")+" text-left",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-3",children:"Teller"}),Nt.jsx("th",{className:"p-3",children:"Status"}),Nt.jsxs("th",{className:"p-3",children:["Days Worked",Nt.jsxs("span",{className:"text-xs text-gray-500 font-normal ml-1",children:["(",j?`${A} to ${M}`:"week"===x?"Mon-Sun":"month"===x?"This month":"year"===x?"This year":"All-time",")"]})]}),!_e&&Ne&&Nt.jsx("th",{className:"p-3 text-center",children:"Actions"})]})}),Nt.jsx("tbody",{children:Fe.map((e,t)=>Nt.jsxs("tr",{onClick:()=>S(t),className:"cursor-pointer transition "+(t===N?i?"bg-indigo-900/50 border-l-4 border-indigo-500":"bg-indigo-50 border-l-4 border-indigo-500":i?"hover:bg-gray-700":"hover:bg-gray-50"),children:[Nt.jsxs("td",{className:"p-3 flex items-center gap-3",children:[Nt.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-500",children:Nt.jsx(Oe,{className:"w-4 h-4"})}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{className:"font-semibold",children:e.tellerName}),e.isFullWeek&&Nt.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[Nt.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:"Full-week"}),je&&Nt.jsx("button",{onClick:t=>{var n;t.stopPropagation(),n=e,h(null,null,function*(){if(n&&n.tellerId&&n.dayKey&&window.confirm(`Remove ${n.tellerName} from full-week assignments?`))try{const e=localStorage.getItem("token");yield pt.delete(`${s}/api/schedule/full-week/teller/${n.tellerId}/${n.dayKey}`,{headers:{Authorization:`Bearer ${e}`}}),r({type:"success",message:`${n.tellerName} removed from full-week`}),Ce(),Me()}catch(He){console.error(" Error removing full-week teller:",He),r({type:"error",message:"Failed to remove from full-week."})}})},className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-indigo-200 hover:bg-indigo-300 text-indigo-700 transition",title:"Remove from full-week",children:Nt.jsx(ce,{className:"w-3 h-3"})})]})]})]}),Nt.jsx("td",{className:"p-3",children:Nt.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("present"===e.status?"bg-green-100 text-green-800":"absent"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:(e.status||"pending").charAt(0).toUpperCase()+(e.status||"pending").slice(1)})}),Nt.jsx("td",{className:"p-3",children:Nt.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[void 0!==e.rangeWorkDays?e.rangeWorkDays:e.totalWorkDays||0," days"]})}),!_e&&Ne&&Nt.jsx("td",{className:"p-3 text-center",children:Nt.jsxs("div",{className:"flex justify-center gap-2",children:[Nt.jsxs("button",{onClick:t=>{t.stopPropagation(),Re(e._id)},className:"flex items-center gap-1 px-3 py-1 text-xs rounded-lg bg-green-600 text-white hover:opacity-90",children:[Nt.jsx(k,{className:"w-3 h-3"})," Present"]}),je&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("button",{onClick:t=>{t.stopPropagation(),De(e)},className:"flex items-center gap-1 px-3 py-1 text-xs rounded-lg bg-blue-600 text-white hover:opacity-90",children:[Nt.jsx(O,{className:"w-3 h-3"})," Replace"]}),Nt.jsxs("button",{onClick:t=>{t.stopPropagation(),Be(e._id)},className:"flex items-center gap-1 px-3 py-1 text-xs rounded-lg bg-red-600 text-white hover:opacity-90",children:[Nt.jsx(ce,{className:"w-3 h-3"})," Absent"]}),Nt.jsxs("button",{onClick:t=>{t.stopPropagation(),Le(e._id)},className:"flex items-center gap-1 px-3 py-1 text-xs rounded-lg bg-orange-600 text-white hover:opacity-90",children:[Nt.jsx(R,{className:"w-3 h-3"})," Remove"]})]})]})})]},e._id))})]})})]}):Nt.jsx("div",{className:"text-center text-gray-400 py-6",children:"No assignment to display."})]}),Nt.jsxs("div",{className:`p-4 mb-6 rounded-xl ${i?"bg-gray-800":"bg-white"} shadow-sm`,children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[Nt.jsx(k,{className:"w-5 h-5 text-green-500"}),"Today's Working Tellers (",ye,")"]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("button",{onClick:()=>{const e=new Date(ye);e.setDate(e.getDate()-1);const t=e.toISOString().slice(0,10);console.log(" Previous Day clicked, setting date to:",t),ve(t)},className:"px-3 py-1 text-sm bg-gray-600 text-white rounded-lg hover:opacity-90",children:" Previous Day"}),Nt.jsx("button",{onClick:()=>{const e=(new Date).toISOString().slice(0,10);console.log(" Today clicked, setting date to:",e),ve(e)},className:"px-3 py-1 text-sm bg-indigo-600 text-white rounded-lg hover:opacity-90",children:"Today"}),Nt.jsx("button",{onClick:()=>{const e=new Date(ye);e.setDate(e.getDate()+1);const t=e.toISOString().slice(0,10);console.log(" Next Day clicked, setting date to:",t),ve(t)},className:"px-3 py-1 text-sm bg-gray-600 text-white rounded-lg hover:opacity-90",children:"Next Day "}),Nt.jsxs("button",{onClick:Ee,className:"flex items-center gap-2 px-3 py-1 text-sm bg-green-600 text-white rounded-lg hover:opacity-90",children:[Nt.jsx(Ae,{className:"w-3 h-3"}),"Refresh"]})]})]}),0===fe.length?Nt.jsxs("div",{className:"text-center text-gray-400 py-4",children:["No tellers have submitted reports for ",new Date(ye).toLocaleDateString()," yet."]}):Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:fe.map(e=>Nt.jsx("div",{className:"p-3 rounded-lg border "+(i?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:Nt.jsx(k,{className:"w-4 h-4 text-green-500"})}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold",children:e.name}),Nt.jsx("p",{className:"text-xs text-gray-500",children:e.role})]})]})},e._id))})]}),Nt.jsxs("div",{className:`p-4 mb-6 rounded-xl ${i?"bg-gray-800":"bg-white"} flex flex-col sm:flex-row items-center justify-between gap-4`,children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{className:"text-sm text-gray-400",children:"Number of tellers for tomorrow:"}),Ne?Nt.jsx("input",{type:"number",min:1,value:m,onChange:e=>g(Number(e.target.value)),className:"w-20 text-center p-2 rounded-lg border "+(i?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")}):Nt.jsx("span",{className:"w-20 text-center p-2 rounded-lg border bg-gray-100 text-gray-600",children:m})]}),Ne&&Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(!(m<=0))try{const e=localStorage.getItem("token");yield pt.put(`${s}/api/schedule/set-teller-count`,{tellerCount:m},{headers:{Authorization:`Bearer ${e}`}});yield Ce(),Me(),r({type:"success",message:`Teller count updated to ${m}.`})}catch(He){console.error("Error updating teller count:",He),r({type:"error",message:"Failed to update teller count."})}}),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:opacity-90",children:"Update Count"})]}),Ne&&Nt.jsxs("div",{className:"rounded-lg shadow p-4 mb-8 "+(i?"bg-gray-800":"bg-white"),children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[Nt.jsx(W,{className:"w-5 h-5 text-indigo-500"})," Full-week Tellers"]}),Nt.jsxs("div",{className:"mb-3 text-sm text-gray-400",children:["Week starting: ",Nt.jsx("strong",{children:Z||""})]}),Nt.jsxs("div",{className:"flex gap-3 items-center mb-4",children:[Nt.jsx("label",{className:"text-sm text-gray-400",children:"Number who will work full week:"}),Nt.jsx("input",{type:"number",min:0,value:ie,onChange:e=>se(Number(e.target.value)),className:"w-20 p-2 rounded-lg border "+(i?"bg-gray-700 border-gray-600 text-gray-100":"bg-gray-50 border-gray-200")}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(!Z)return r({type:"error",message:"Week start not set"});try{localStorage.getItem("token");yield Pe()}catch(He){console.error(" Failed to save full-week selection",He),r({type:"error",message:"Failed to save full-week selection"})}}),className:"px-3 py-2 rounded-lg bg-indigo-600 text-white hover:opacity-90",children:"Save"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(Z&&window.confirm("Reset full-week selection for this week?"))try{const e=localStorage.getItem("token");yield pt.delete(`${s}/api/schedule/full-week/${Z}`,{headers:{Authorization:`Bearer ${e}`}}),ne(null),ae([]),se(0),yield Ce(),r({type:"success",message:"Full-week selection reset for this week"})}catch(He){console.error(" Failed to reset full-week selection",He),r({type:"error",message:"Failed to reset selection"})}}),className:"px-3 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",children:"Reset"})]}),Nt.jsx("div",{className:"text-sm text-gray-400 mb-3",children:"Select tellers who will work for the entire week (selection limited by the number above)"}),0===J.length?Nt.jsx("div",{className:"text-center text-gray-400 py-4",children:"No tellers available to select."}):Nt.jsx("ul",{className:"divide-y divide-gray-200 max-h-72 overflow-y-auto",children:J.map(e=>Nt.jsxs("li",{className:"flex items-center justify-between py-2 "+(i?"hover:bg-gray-700":"hover:bg-gray-50"),children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-semibold",children:e.name||e.username}),Nt.jsxs("p",{className:"text-xs text-gray-500",children:["Last worked: ",e.lastWorked?new Date(e.lastWorked).toLocaleDateString():"Never"]})]}),Nt.jsx("div",{className:"flex items-center gap-2",children:Nt.jsx("input",{type:"checkbox",checked:re.includes(e._id),disabled:!re.includes(e._id)&&ie>0&&re.length>=ie,onChange:()=>{return t=e._id,void ae(e=>e.includes(t)?e.filter(e=>e!==t):ie>0&&e.length>=ie?e:[...e,t]);var t}})})]},e._id))})]}),we&&Nt.jsxs("div",{className:"rounded-lg shadow p-4 mb-8 "+(i?"bg-gray-800":"bg-white"),children:[Nt.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[Nt.jsx(U,{className:"w-5 h-5 text-indigo-500"})," All Tellers Directory"]}),0===J.length?Nt.jsx("div",{className:"text-center text-gray-400 py-4",children:"No tellers found."}):Nt.jsx("ul",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:J.map(e=>Nt.jsxs("li",{className:"flex justify-between items-center py-3 "+(i?"hover:bg-gray-700":"hover:bg-gray-50"),children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("p",{className:"font-semibold",children:e.name||e.username}),Nt.jsxs("div",{className:"flex gap-3 text-xs mt-1",children:[Nt.jsxs("span",{className:"text-gray-500",children:["Last Worked: ",e.lastWorked?new Date(e.lastWorked).toLocaleDateString():"Never"]}),Nt.jsxs("span",{className:"text-indigo-600 font-medium",children:["Total Days: ",e.totalWorkDays||0]})]}),e.skipUntil&&new Date(e.skipUntil)>new Date&&Nt.jsxs("p",{className:"text-xs text-red-500 mt-1",children:[" Penalty until: ",new Date(e.skipUntil).toLocaleDateString()]})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{className:"px-3 py-1 text-xs rounded-full "+("approved"===e.status?"bg-green-100 text-green-700":"pending"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"),children:e.status}),Nt.jsx("span",{className:"text-xs text-gray-500",children:"supervisor_teller"===e.role?"Supervisor":"Teller"})]})]},e._id))})]}),H&&Ne&&Nt.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:Nt.jsxs("div",{className:"rounded-2xl shadow-lg p-6 w-full max-w-md "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-4",children:[Nt.jsx(ce,{className:"w-5 h-5 text-red-500"}),"Mark Teller Absent"]}),Nt.jsx("div",{className:"mb-4",children:Nt.jsxs("p",{className:"text-sm mb-2",children:["Marking ",Nt.jsx("span",{className:"font-semibold",children:null==B?void 0:B.tellerName})," as absent"]})}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Reason for Absence ",Nt.jsx("span",{className:"text-red-500",children:"*"})]}),Nt.jsxs("select",{value:V,onChange:e=>$(e.target.value),className:"w-full p-2 border rounded-lg "+(i?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"",children:"-- Select Reason --"}),Nt.jsx("option",{value:"Sick",children:"Sick"}),Nt.jsx("option",{value:"Emergency",children:"Emergency"}),Nt.jsx("option",{value:"Personal",children:"Personal Leave"}),Nt.jsx("option",{value:"Family Matter",children:"Family Matter"}),Nt.jsx("option",{value:"NCNS",children:"No Call No Show (NCNS)"}),Nt.jsx("option",{value:"Other",children:"Other"})]})]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Penalty (Skip Work Days)"}),Nt.jsxs("select",{value:Y,onChange:e=>X(parseInt(e.target.value)),className:"w-full p-2 border rounded-lg "+(i?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:0,children:"No Penalty"}),Nt.jsx("option",{value:1,children:"1 Day"}),Nt.jsx("option",{value:3,children:"3 Days"}),Nt.jsx("option",{value:5,children:"5 Days"}),Nt.jsx("option",{value:7,children:"7 Days (1 Week)"}),Nt.jsx("option",{value:14,children:"14 Days (2 Weeks)"})]}),Y>0&&Nt.jsxs("p",{className:"text-xs text-orange-500 mt-1",children:[" Teller will be skipped from schedule for ",Y," day(s)"]})]}),Nt.jsxs("div",{className:"flex gap-3 mt-6",children:[Nt.jsx("button",{onClick:()=>G(!1),className:"flex-1 px-4 py-2 rounded-lg bg-gray-500 text-white hover:opacity-90",children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(B)if(V)try{const e=localStorage.getItem("token");yield pt.post(`${s}/api/schedule/mark-absent`,{tellerId:B.tellerId,tellerName:B.tellerName,dayKey:B.dayKey,reason:V,penaltyDays:Y},{headers:{Authorization:`Bearer ${e}`}}),r({type:"success",message:`${B.tellerName} marked absent${Y>0?` with ${Y} day penalty`:""}.`}),G(!1),z(!0),P(!0);const t=yield pt.get(`${s}/api/schedule/suggest/${B.dayKey}`,{headers:{Authorization:`Bearer ${e}`}});I(t.data.suggestions||[]),z(!1),Ce(),Me()}catch(He){console.error(" Error marking absent:",He),r({type:"error",message:"Failed to mark absent."}),z(!1)}else r({type:"warning",message:"Please select an absent reason."})}),className:"flex-1 px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",children:"Confirm Absent"})]})]})}),T&&Ne&&Nt.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:Nt.jsxs("div",{className:"rounded-2xl shadow-lg p-6 w-full max-w-2xl "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-4",children:[Nt.jsx(U,{className:"w-5 h-5 text-indigo-500"}),"Suggested Replacement Tellers"]}),F?Nt.jsx("div",{className:"text-center py-4 text-gray-400",children:"Loading..."}):0===ze.length?Nt.jsx("div",{className:"text-center py-4 text-gray-400",children:"No available tellers to suggest."}):Nt.jsx("ul",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:ze.map(e=>Nt.jsxs("li",{className:"py-4 "+(i?"hover:bg-gray-700":"hover:bg-gray-50"),children:[Nt.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("p",{className:"font-semibold text-sm",children:e.name||e.username}),Nt.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Total days worked (this week): ",Nt.jsx("strong",{children:e.weeklyWorkedDays||0})]})]}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(B&&window.confirm("Assign this teller as replacement?"))try{const e=localStorage.getItem("token");yield pt.put(`${s}/api/schedule/replace/${B._id}`,{replacementId:t},{headers:{Authorization:`Bearer ${e}`}}),r({type:"success",message:"Replacement teller assigned successfully."}),P(!1),Ce(),Me()}catch(He){console.error(" Error assigning replacement:",He),r({type:"error",message:"Failed to assign replacement."})}});var t},className:"bg-indigo-600 text-white text-xs px-3 py-1.5 rounded-lg hover:bg-indigo-700 whitespace-nowrap",children:"Select"})]}),e.dailyWorkedDays&&Nt.jsxs("div",{className:"mt-2 bg-gray-100/50 dark:bg-gray-700/30 rounded p-2",children:[Nt.jsx("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Days breakdown (Mon-Sun):"}),Nt.jsx("div",{className:"grid grid-cols-7 gap-1",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(t=>Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300",children:t.slice(0,3)}),Nt.jsx("div",{className:"text-xs font-bold rounded py-1 "+(e.dailyWorkedDays[t]>0?"bg-green-500 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300"),children:e.dailyWorkedDays[t]||0})]},t))})]}),Nt.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:e.lastWorked&&Nt.jsxs("span",{children:["Last Worked: ",new Date(e.lastWorked).toLocaleDateString()]})}),e.skipUntil&&Nt.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[Nt.jsxs("p",{className:"text-xs text-red-500",children:[" Penalty until: ",new Date(e.skipUntil).toLocaleDateString()]}),Ne&&Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){if(window.confirm("Remove penalty for this teller now?"))try{const e=localStorage.getItem("token");yield pt.put(`${s}/api/admin/users/${t}/remove-penalty`,{},{headers:{Authorization:`Bearer ${e}`}}),r({type:"success",message:"Penalty removed"}),yield ke(),yield Ce()}catch(He){console.error(" Failed to remove penalty",He),r({type:"error",message:"Failed to remove penalty"})}});var t},className:"text-xs px-2 py-1 bg-red-600 text-white rounded-lg hover:opacity-90",children:"Remove Penalty"})]})]},e._id))}),Nt.jsx("div",{className:"mt-6 text-right",children:Nt.jsx("button",{onClick:()=>P(!1),className:"text-sm px-4 py-2 rounded-lg bg-gray-500 text-white hover:opacity-90",children:"Close"})})]})}),de&&Nt.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:Nt.jsxs("div",{className:"rounded-2xl shadow-lg p-6 w-full max-w-3xl "+(i?"bg-gray-800 text-gray-100":"bg-white text-gray-900"),children:[Nt.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-4",children:[Nt.jsx(W,{className:"w-5 h-5 text-indigo-500"})," Full-week changes preview"]}),Nt.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===oe.length?Nt.jsx("div",{className:"text-center py-6 text-gray-400",children:"No changes planned for this week."}):oe.map(e=>Nt.jsxs("div",{className:"mb-4 border rounded p-3",children:[Nt.jsxs("div",{className:"font-semibold mb-2",children:["Day: ",e.dayKey]}),e.replacements&&e.replacements.length>0&&Nt.jsxs("div",{className:"mb-2",children:[Nt.jsx("div",{className:"text-sm font-medium",children:"Replacements"}),Nt.jsx("ul",{className:"mt-2 space-y-1 text-sm",children:e.replacements.map((e,t)=>{var n,r,a;return Nt.jsxs("li",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[(null==(n=e.from)?void 0:n.name)||(null==(r=e.from)?void 0:r.id),"  ",Nt.jsx("strong",{children:(null==(a=J.find(t=>t._id===e.to.id))?void 0:a.name)||e.to.id})]}),Nt.jsxs("div",{className:"text-xs text-gray-400",children:["assignmentId: ",e.assignmentId]})]},t)})})]}),e.appends&&e.appends.length>0&&Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm font-medium",children:"Appends"}),Nt.jsx("ul",{className:"mt-2 text-sm",children:e.appends.map((e,t)=>{var n;return Nt.jsxs("li",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("strong",{children:(null==(n=J.find(t=>t._id===e.to.id))?void 0:n.name)||e.to.id})," will be appended"]}),Nt.jsxs("div",{className:"text-xs text-gray-400",children:["day: ",e.dayKey]})]},t)})})]})]},e.dayKey))}),Nt.jsxs("div",{className:"flex items-center justify-end gap-3 mt-4",children:[me&&Nt.jsx("button",{onClick:()=>((...e)=>h(null,[...e],function*(e=me){if(!e)return r({type:"error",message:"No audit to undo"});if(window.confirm("Undo the last full-week application? This will attempt to revert assignments."))try{const t=localStorage.getItem("token"),n=yield pt.post(`${s}/api/schedule/full-week/undo/${e}`,{},{headers:{Authorization:`Bearer ${t}`}});n.data&&n.data.reverted?(yield Ce(),r({type:"success",message:"Undo completed successfully"}),ge(null)):r({type:"error",message:"Failed to undo"})}catch(He){console.error(" Undo failed",He),r({type:"error",message:"Undo failed"})}}))(),className:"px-3 py-2 rounded-lg bg-yellow-500 text-white",children:"Undo last"}),Nt.jsx("button",{onClick:()=>ue(!1),className:"px-3 py-2 rounded-lg bg-gray-500 text-white",children:"Cancel"}),Nt.jsx("button",{onClick:Pe,disabled:he,className:"px-3 py-2 rounded-lg bg-indigo-600 text-white",children:he?"Applying...":"Confirm & Apply"})]})]})})]})}function Dte(){const[e,t]=f.useState("both"),[n,r]=f.useState("schedule");return Nt.jsxs("div",{className:"min-h-screen bg-gray-50",children:[Nt.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:Nt.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Workplace Schedule & Rotation"}),Nt.jsx("p",{className:"text-gray-600 mt-1",children:"Manage staff rotation between RMI and GTA"})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>r("schedule"),className:"px-4 py-2 rounded-lg font-medium "+("schedule"===n?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Schedule"}),Nt.jsx("button",{onClick:()=>r("settings"),className:"px-4 py-2 rounded-lg font-medium "+("settings"===n?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Settings"})]})]}),Nt.jsxs("div",{className:"flex gap-4 mt-6",children:[Nt.jsxs("button",{onClick:()=>t("both"),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition "+("both"===e?"bg-indigo-100 text-indigo-700 border-2 border-indigo-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[Nt.jsx(U,{size:20}),"Both Workplaces"]}),[{id:"rmi",name:"RMI",color:"blue",icon:""},{id:"gta",name:"GTA",color:"green",icon:""}].map(n=>Nt.jsxs("button",{onClick:()=>t(n.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition "+(e===n.id?`bg-${n.color}-100 text-${n.color}-700 border-2 border-${n.color}-600`:"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[Nt.jsx(qe,{size:20}),n.icon," ",n.name]},n.id))]})]})}),Nt.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:"schedule"===n?Nt.jsxs("div",{className:"space-y-6",children:["both"!==e&&Nt.jsx("div",{className:`bg-${"rmi"===e?"blue":"green"}-50 border-l-4 border-${"rmi"===e?"blue":"green"}-600 p-4 rounded`,children:Nt.jsxs("p",{className:"text-sm text-gray-700",children:["Scheduling for: ",Nt.jsx("span",{className:"font-bold",children:"rmi"===e?"RMI":"GTA"})]})}),Nt.jsx(Pte,{workplace:e})]}):Nt.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[Nt.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Schedule Settings"}),Nt.jsxs("div",{className:"space-y-6",children:[Nt.jsxs("div",{className:"border-l-4 border-blue-600 pl-6 py-4",children:[Nt.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:" RMI Settings"}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Staff per Shift"}),Nt.jsx("input",{type:"number",defaultValue:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Working Days per Week"}),Nt.jsx("input",{type:"number",defaultValue:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),Nt.jsxs("div",{className:"border-l-4 border-green-600 pl-6 py-4",children:[Nt.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:" GTA Settings"}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Staff per Shift"}),Nt.jsx("input",{type:"number",defaultValue:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Working Days per Week"}),Nt.jsx("input",{type:"number",defaultValue:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]})]}),Nt.jsxs("div",{className:"border-l-4 border-purple-600 pl-6 py-4",children:[Nt.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:" Rotation Rules"}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("label",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-4 h-4 rounded"}),Nt.jsx("span",{className:"text-gray-700",children:"Rotate staff between RMI and GTA monthly"})]}),Nt.jsxs("label",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-4 h-4 rounded"}),Nt.jsx("span",{className:"text-gray-700",children:"Fair distribution of shifts"})]}),Nt.jsxs("label",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded"}),Nt.jsx("span",{className:"text-gray-700",children:"Respect employee preferences"})]})]})]}),Nt.jsxs("div",{className:"flex gap-4 mt-8",children:[Nt.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:[Nt.jsx(Ee,{size:20}),"Save Settings"]}),Nt.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:[Nt.jsx(Fe,{size:20}),"Reset to Defaults"]})]})]})]})})]})}function Rte(){const{settings:e}=f.useContext($c),{showToast:t}=Kc(),n=zc(),[r,a]=f.useState([]),[i,s]=f.useState(!0),[o,d]=f.useState(!1),[u,p]=f.useState(null),[m,g]=f.useState({name:"",phone:"",email:"",position:"Teller",status:"active"});f.useEffect(()=>{h(null,null,function*(){try{s(!0);const e=yield pt.get(`${n}/api/gta-tellers`);a(e.data||[])}catch(e){console.error("Error fetching GTA tellers:",e),t({type:"error",message:"Failed to load GTA tellers"})}finally{s(!1)}})},[]);return Nt.jsx("div",{className:"p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:Nt.jsxs("div",{className:"max-w-6xl mx-auto",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"GTA Teller Management"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage tellers without RMI accounts for GTA scheduling"})]}),Nt.jsxs("button",{onClick:()=>d(!o),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:[Nt.jsx(le,{size:20}),"Add Teller"]})]}),o&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:[Nt.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:u?"Edit Teller":"Add New Teller"}),Nt.jsxs("form",{onSubmit:e=>h(null,null,function*(){if(e.preventDefault(),m.name.trim())try{if(u)yield pt.put(`${n}/api/gta-tellers/${u}`,m),a(r.map(e=>e._id===u?l(l({},e),m):e)),t({type:"success",message:"Teller updated successfully"});else{const e=yield pt.post(`${n}/api/gta-tellers`,m);a([...r,e.data]),t({type:"success",message:"Teller added successfully"})}g({name:"",phone:"",email:"",position:"Teller",status:"active"}),p(null),d(!1)}catch(i){console.error("Error saving teller:",i),t({type:"error",message:"Failed to save teller"})}else t({type:"error",message:"Name is required"})}),className:"space-y-4",children:[Nt.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Full Name *"}),Nt.jsx("input",{type:"text",value:m.name,onChange:e=>g(c(l({},m),{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter full name"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),Nt.jsx("input",{type:"tel",value:m.phone,onChange:e=>g(c(l({},m),{phone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+1 (555) 000-0000"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),Nt.jsx("input",{type:"email",value:m.email,onChange:e=>g(c(l({},m),{email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com"})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position"}),Nt.jsx("input",{type:"text",value:m.position,onChange:e=>g(c(l({},m),{position:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Teller, Supervisor"})]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),Nt.jsxs("select",{value:m.status,onChange:e=>g(c(l({},m),{status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[Nt.jsx("option",{value:"active",children:"Active"}),Nt.jsx("option",{value:"inactive",children:"Inactive"}),Nt.jsx("option",{value:"on-leave",children:"On Leave"})]})]}),Nt.jsxs("div",{className:"flex gap-2 pt-4",children:[Nt.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium",children:[Nt.jsx(Ee,{size:18}),u?"Update":"Save"]}),Nt.jsxs("button",{type:"button",onClick:()=>{g({name:"",phone:"",email:"",position:"Teller",status:"active"}),p(null),d(!1)},className:"flex items-center gap-2 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:[Nt.jsx(ce,{size:18}),"Cancel"]})]})]})]}),i?Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8 text-center",children:[Nt.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full mx-auto mb-4"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading GTA tellers..."})]}):0===r.length?Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8 text-center",children:[Nt.jsx(U,{size:48,className:"mx-auto text-gray-400 mb-4"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No GTA tellers added yet"}),Nt.jsxs("button",{onClick:()=>d(!0),className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:[Nt.jsx(le,{size:18}),"Add First Teller"]})]}):Nt.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:Nt.jsxs("table",{className:"w-full",children:[Nt.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white",children:"Name"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white",children:"Phone"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white",children:"Email"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white",children:"Position"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white",children:"Status"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white",children:"Actions"})]})}),Nt.jsx("tbody",{children:r.map((e,i)=>Nt.jsxs("tr",{className:i%2==0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700",children:[Nt.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.name}),Nt.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:e.phone?Nt.jsxs("span",{className:"flex items-center gap-1",children:[Nt.jsx(Je,{size:16,className:"text-blue-600"}),e.phone]}):Nt.jsx("span",{className:"text-gray-400",children:""})}),Nt.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:e.email?Nt.jsxs("span",{className:"flex items-center gap-1",children:[Nt.jsx(Ve,{size:16,className:"text-blue-600"}),e.email]}):Nt.jsx("span",{className:"text-gray-400",children:""})}),Nt.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:e.position}),Nt.jsx("td",{className:"px-6 py-4 text-sm",children:Nt.jsx("span",{className:"inline-block px-2 py-1 rounded text-xs font-semibold "+("active"===e.status?"bg-green-100 text-green-800":"on-leave"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status||"active"})}),Nt.jsx("td",{className:"px-6 py-4 text-sm",children:Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>(e=>{g({name:e.name,phone:e.phone||"",email:e.email||"",position:e.position||"Teller",status:e.status||"active"}),p(e._id),d(!0)})(e),className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 font-medium text-xs",children:[Nt.jsx(Q,{size:14}),"Edit"]}),Nt.jsxs("button",{onClick:()=>{return i=e._id,h(null,null,function*(){if(window.confirm("Are you sure you want to delete this teller?"))try{yield pt.delete(`${n}/api/gta-tellers/${i}`),a(r.filter(e=>e._id!==i)),t({type:"success",message:"Teller deleted successfully"})}catch(e){console.error("Error deleting teller:",e),t({type:"error",message:"Failed to delete teller"})}});var i},className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200 font-medium text-xs",children:[Nt.jsx(R,{size:14}),"Delete"]})]})})]},e._id||i))})]})}),!i&&r.length>0&&Nt.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[Nt.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"Active Tellers"}),Nt.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.filter(e=>"active"===e.status).length})]}),Nt.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"On Leave"}),Nt.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.filter(e=>"on-leave"===e.status).length})]}),Nt.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[Nt.jsx("p",{className:"text-gray-600 text-sm",children:"Total Tellers"}),Nt.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.length})]})]})]})})}function Ite(){var e;const[t,n]=f.useState(null),[r,a]=f.useState(!0),[i,s]=f.useState(null),[o,l]=f.useState(new Date),[c,d]=f.useState("betAmount"),u=(()=>{try{return JSON.parse(localStorage.getItem("user")||"{}").role||"supervisor"}catch(bI){return"supervisor"}})(),p="admin"===u||"super_admin"===u,m="teller"===u;f.useEffect(()=>{g();const e=setInterval(()=>{g()},18e4);return()=>clearInterval(e)},[]);const g=()=>h(null,null,function*(){var e,t,r,i;try{a(!0),s(null);if(!localStorage.getItem("token"))return s("Authentication token not found. Please log in again."),void a(!1);const e=`${zc()}/api/external-betting/gta-event-report-proxy`,t=yield pt.get(e);t.data.success?(n({data:t.data.data.data||t.data.data,filtered:t.data.data.filtered,dateRange:t.data.data.dateRange}),l(new Date)):s("Failed to fetch betting event data")}catch(o){console.error("Error fetching betting event data:",o);const n=(null==(t=null==(e=o.response)?void 0:e.data)?void 0:t.message)||401===(null==(r=o.response)?void 0:r.status)?"Unauthorized - Please log in again":403===(null==(i=o.response)?void 0:i.status)?"Forbidden - You do not have permission to access this report":o.message||"Failed to fetch betting event data";s(n)}finally{a(!1)}}),x=e=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e||0),y=e=>e?new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Not completed",v=e=>.055*(e||0),b=e=>{const t=e;if(!t)return"";const n=t%100;if(n>=11&&n<=13)return`${t}th`;switch(t%10){case 1:return`${t}st`;case 2:return`${t}nd`;case 3:return`${t}rd`;default:return`${t}th`}};if(r)return Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"flex items-center justify-center h-64",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),Nt.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Loading GTA betting event report..."})]})});if(i){const n=i.includes("no betting API mapping")||(null==t?void 0:t.isTellerData)&&(!(null==(e=null==t?void 0:t.data)?void 0:e.staffReports)||0===t.data.staffReports.length);return Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:(n?"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800")+" rounded-lg p-4",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:Nt.jsx("svg",{className:"h-5 w-5 "+(n?"text-yellow-400":"text-red-400"),viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium "+(n?"text-yellow-800 dark:text-yellow-200":"text-red-800 dark:text-red-200"),children:n?"Not Mapped to Betting System":"Error Loading Report"}),Nt.jsx("div",{className:"mt-2 text-sm "+(n?"text-yellow-700 dark:text-yellow-300":"text-red-700 dark:text-red-300"),children:n?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("p",{children:"Your account is not yet mapped to the betting system."}),Nt.jsx("p",{className:"mt-1",children:"Please contact your supervisor or administrator to set up your betting account mapping."})]}):i}),Nt.jsx("button",{onClick:g,className:`mt-3 ${n?"bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 hover:bg-yellow-200 dark:hover:bg-yellow-700":"bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-700"} px-3 py-1 rounded text-sm`,children:"Retry"})]})]})})})}if(!t)return Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400",children:"No GTA betting event data available"})});const{data:w}=t;return!m||(null==w?void 0:w.staffReports)&&0!==w.staffReports.length?Nt.jsxs("div",{className:"p-6 space-y-6",children:[Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:" GTA Betting Event Report"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:w.title}),Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[" Auto-refresh every 3 minutes  Last updated: ",o.toLocaleTimeString()]})]}),Nt.jsxs("button",{onClick:g,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2",children:[Nt.jsx(Ae,{size:16}),"Refresh"]})]}),Nt.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created:"}),Nt.jsx("p",{className:"font-medium",children:y(w.createdAt)})]}),Nt.jsxs("div",{children:[Nt.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Completed:"}),Nt.jsx("p",{className:"font-medium",children:y(w.completedAt)})]})]})]}),p&&Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:" Financial Summary"}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[Nt.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"Total Starting Balance"}),Nt.jsx("div",{className:"text-2xl font-bold text-green-800 dark:text-green-200",children:x(w.totalStartingBalance)})]}),Nt.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:"Total System Balance"}),Nt.jsx("div",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200",children:x(w.totalSystemBalance)})]}),Nt.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-purple-600 dark:text-purple-400 font-medium",children:"Total Bet Amount"}),Nt.jsx("div",{className:"text-2xl font-bold text-purple-800 dark:text-purple-200",children:x(w.totalBetAmount)})]}),Nt.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-pink-600 dark:text-pink-400 font-medium",children:"Total Commission (5.5%)"}),Nt.jsx("div",{className:"text-2xl font-bold text-pink-800 dark:text-pink-200",children:x((w.staffReports||[]).reduce((e,t)=>e+v(t.betAmount),0))})]}),Nt.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"Total Payout"}),Nt.jsx("div",{className:"text-2xl font-bold text-red-800 dark:text-red-200",children:x(w.totalPayout)})]}),Nt.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium",children:"Total Canceled/Returned"}),Nt.jsx("div",{className:"text-2xl font-bold text-yellow-800 dark:text-yellow-200",children:x(w.totalCanceledBet)})]}),Nt.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg",children:[Nt.jsx("div",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-medium",children:"Net Profit"}),Nt.jsx("div",{className:"text-2xl font-bold text-indigo-800 dark:text-indigo-200",children:x(w.totalBetAmount-w.totalPayout-w.totalCanceledBet)})]})]})]}),Nt.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:" Staff Performance"}),Nt.jsxs("div",{className:"flex items-center gap-4",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sort by:"}),Nt.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[Nt.jsx("option",{value:"betAmount",children:"Bet Amount"}),Nt.jsx("option",{value:"systemBalance",children:"System Balance"})]})]}),Nt.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:[" Sorted by ","betAmount"===c?"Bet Amount":"System Balance"," (Highest to Lowest)"]})]})]}),Nt.jsx("div",{className:"overflow-x-auto",children:Nt.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[Nt.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Rank"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Teller"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Starting Balance"}),!p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Points"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Bet Amount"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Payout"}),Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"System Balance"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Commission"}),p&&Nt.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Profit/Loss"})]})}),Nt.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:(N=w.staffReports||[],S=c,[...N].sort((e,t)=>"betAmount"===S?(t.betAmount||0)-(e.betAmount||0):"systemBalance"===S?(t.systemBalance||0)-(e.systemBalance||0):0)).map((e,t)=>{const n=(e.betAmount||0)-(e.payout||0)-(e.canceledBet||0),r=v(e.betAmount);return Nt.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200 font-semibold",children:b(t+1)}),Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Nt.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),Nt.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.username})]}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.startingBalance)}),!p&&Nt.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-indigo-600 dark:text-indigo-400",children:[(a=e.betAmount,((a||0)/1500).toFixed(2)).toLocaleString()," pts"]}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.betAmount)}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.payout)}),Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:x(e.systemBalance)}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-purple-600 dark:text-purple-400 font-medium",children:x(r)}),p&&Nt.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Nt.jsxs("span",{className:"text-sm font-medium "+(n>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[n>=0?"+":"",x(n)]})})]},t);var a})})]})})]})]}):Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("svg",{className:"h-12 w-12 text-yellow-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Nt.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Nt.jsx("h3",{className:"text-lg font-medium text-yellow-800 dark:text-yellow-200 mb-2",children:"Not Mapped to Betting System"}),Nt.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:"Your account hasn't been set up in the betting system yet."}),Nt.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 mt-2",children:"Please contact your supervisor or administrator to set up your betting account mapping."})]})})});var N,S}function Ote(){var e;const{user:t,settings:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),[i,s]=f.useState([]),[o,d]=f.useState(!0),[u,p]=f.useState((new Date).toISOString().split("T")[0]),[m,g]=f.useState(null),[x,y]=f.useState(null),[v,b]=f.useState([]),[w,N]=f.useState(null),[S,j]=f.useState(!1),[_,A]=f.useState("true"===localStorage.getItem("autoPrintEnabled")),[C,M]=f.useState(()=>{const e=localStorage.getItem("noBSalarDays");return e?JSON.parse(e):{}}),[k,E]=f.useState({}),T=[{key:"mon",label:"Mon"},{key:"tue",label:"Tue"},{key:"wed",label:"Wed"},{key:"thu",label:"Thu"},{key:"fri",label:"Fri"},{key:"sat",label:"Sat"},{key:"sun",label:"Sun"}],P=450,D=P*T.length,R=(e={})=>T.reduce((t,{key:n})=>t+(e[n]||0),0),I=e=>`${e.toFixed(2)}`,O=()=>m&&x?`${m.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${x.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:"Week overview",B=e=>{var t;const n=((e,t)=>{const n=O();let r=0;const a=T.map(({key:n,label:a})=>{const i=t[n]||0,s=`${e.id}-${n}`,o=C[s]?P:0;return r+=o,`<div class="row">\n  <span class="col-day">${a}</span>\n  <span class="col-over">${I(i)}</span>\n  <span class="col-base">${I(o)}</span>\n</div>`}).join(""),i=R(t),s=r+i;return`<!doctype html>\n<html>\n<head>\n  <title>${e.name} - Teller Report</title>\n  <style>\n    @media print {\n      @page { size: 58mm auto; margin: 4mm; }\n    }\n    * { box-sizing: border-box; }\n    body { \n      font-family: 'Courier New', monospace; \n      padding: 8px; \n      margin: 0; \n      width: 220px; \n      font-size: 11px;\n      line-height: 1.3;\n    }\n    h2 { \n      margin: 0 0 2px; \n      font-size: 14px; \n      font-weight: bold;\n      text-align: center;\n    }\n    p { \n      margin: 1px 0; \n      font-size: 10px; \n      text-align: center;\n    }\n    .row { \n      display: flex; \n      justify-content: space-between; \n      margin: 2px 0; \n      font-size: 11px;\n      font-family: 'Courier New', monospace;\n    }\n    .col-day { flex: 0 0 30px; }\n    .col-over { flex: 1; text-align: right; padding-right: 8px; }\n    .col-base { flex: 0 0 60px; text-align: right; }\n    .divider { \n      border-top: 1px solid #000; \n      margin: 4px 0; \n    }\n    .section-divider {\n      border-top: 1px dashed #000;\n      margin: 6px 0;\n    }\n    .signature { \n      margin-top: 12px; \n      font-size: 9px; \n    }\n    .signature-line { \n      border-top: 1px solid #000; \n      margin-top: 8px; \n      padding-top: 2px;\n      height: 20px;\n    }\n    .total-row {\n      font-weight: bold;\n      border-top: 1px solid #000;\n      padding-top: 2px;\n      margin-top: 4px;\n    }\n  </style>\n</head>\n<body>\n  <h2>${e.name}</h2>\n  <p>ID: ${e.id}</p>\n  <p>${n}</p>\n  <div class="section-divider"></div>\n  <div style="font-size: 10px; display: flex; justify-content: space-between; margin-bottom: 2px;">\n    <span style="flex: 0 0 30px;">Day</span>\n    <span style="flex: 1; text-align: right; padding-right: 8px;">Over</span>\n    <span style="flex: 0 0 60px; text-align: right;">Base</span>\n  </div>\n  ${a}\n  <div class="divider"></div>\n  <div class="row">\n    <span class="col-day" style="font-weight: bold;">OVER:</span>\n    <span class="col-over"></span>\n    <span class="col-base" style="font-weight: bold;">${I(i)}</span>\n  </div>\n  <div class="row">\n    <span class="col-day" style="font-weight: bold;">BASE:</span>\n    <span class="col-over"></span>\n    <span class="col-base" style="font-weight: bold;">${I(r)}</span>\n  </div>\n  <div class="row total-row">\n    <span class="col-day" style="font-weight: bold;">TOTAL:</span>\n    <span class="col-over"></span>\n    <span class="col-base" style="font-weight: bold;">${I(s)}</span>\n  </div>\n  <div class="signature">\n    <p>Prepared by: _________________________</p>\n    <div class="signature-line"></div>\n  </div>\n  <script>\n    window.onload = () => {\n      setTimeout(() => {\n        window.print();\n      }, 250);\n    };\n  <\/script>\n</body>\n</html>`})(e,e.over||{});if(null==(t=null==window?void 0:window.electronAPI)?void 0:t.printHTML)return window.electronAPI.printHTML(n,w),void r({type:"success",message:`Printing to ${(null==w?void 0:w.name)||"default printer"}...`});(e=>{const t=window.open("","_blank","width=340,height=640");t&&(t.document.write(e),t.document.close(),t.focus(),t.print(),t.close())})(n)},L="super_admin"===(null==t?void 0:t.role)||"supervisor"===(null==t?void 0:t.role);f.useEffect(()=>{localStorage.setItem("noBSalarDays",JSON.stringify(C))},[C]),f.useEffect(()=>{L?(F(),h(null,null,function*(){var e;if(null==(e=null==window?void 0:window.electronAPI)?void 0:e.getAvailablePrinters)try{const e=yield window.electronAPI.getAvailablePrinters();b(e||[]);const t=localStorage.getItem("selectedPrinterName");if(t){const n=e.find(e=>e.name===t);n?N(n):e.length>0&&N(e[0])}else if(e.length>0){const t=e.find(e=>e.name.toLowerCase().includes("58")||e.name.toLowerCase().includes("thermal")||e.name.toLowerCase().includes("receipt")||e.name.toLowerCase().includes("xprinter"));N(t||e[0])}}catch(t){console.error("Error fetching printers:",t)}else console.warn("Electron API not available for getting printers")})):r({type:"error",message:"Access denied. Only superadmin and supervisors can view this page."})},[u,L]);const F=()=>h(null,null,function*(){var e;try{d(!0);const n=localStorage.getItem("token"),r=n?{Authorization:`Bearer ${n}`}:{},a=new Date(u),i=a.getDay(),o=a.getDate()-i+(0===i?-6:1),l=new Date(a.setDate(o)),c=new Date(l);c.setDate(c.getDate()+6),g(l),y(c);const h=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,p=yield pt.get(`${zc()}/api/teller-salary-calculation`,{params:{weekStart:h(l),weekEnd:h(c),supervisorId:"supervisor"===(null==t?void 0:t.role)?null==t?void 0:t.id:void 0},headers:r});s((null==(e=p.data)?void 0:e.tellers)||[])}catch(n){console.error("Error fetching teller salary data:",n),r({type:"error",message:"Failed to load teller salary data"})}finally{d(!1)}});return L?o?Nt.jsx("div",{className:"flex items-center justify-center min-h-screen "+(a?"bg-gray-900":"bg-gray-50"),children:Nt.jsx(ue,{className:"animate-spin text-indigo-600",size:40})}):Nt.jsx("div",{className:`min-h-screen ${a?"bg-gray-900":"bg-gray-50"} p-6`,children:Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsxs("div",{className:"mb-8",children:[Nt.jsx("h1",{className:"text-3xl font-bold mb-2 "+(a?"text-white":"text-gray-900"),children:"Teller Salary Calculation"}),Nt.jsx("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:"Weekly overtime and salary summary"})]}),Nt.jsxs("div",{className:`mb-6 p-4 rounded-lg ${a?"bg-gray-800":"bg-white"} shadow-md`,children:[Nt.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("button",{onClick:()=>{const e=new Date(u);e.setDate(e.getDate()-7),p(e.toISOString().split("T")[0])},className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition",title:"Previous week",children:Nt.jsx(V,{size:20})}),Nt.jsx("button",{onClick:()=>{p((new Date).toISOString().split("T")[0])},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition text-sm",children:"This Week"}),Nt.jsx("button",{onClick:()=>{const e=new Date(u);e.setDate(e.getDate()+7),p(e.toISOString().split("T")[0])},className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition",title:"Next week",children:Nt.jsx($,{size:20})})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx(W,{size:18}),Nt.jsx("input",{type:"date",value:u,onChange:e=>p(e.target.value),className:"px-3 py-2 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900")})]}),Nt.jsx("div",{className:"text-sm font-semibold "+(a?"text-gray-300":"text-gray-700"),children:m&&x&&Nt.jsxs(Nt.Fragment,{children:[m.toLocaleDateString("en-US",{month:"short",day:"numeric"})," - ",x.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})}),Nt.jsxs("button",{onClick:()=>j(!S),className:"p-2 rounded-lg transition flex items-center gap-2 text-sm font-semibold "+(S?"bg-indigo-600 text-white":a?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-200 text-gray-700"),title:"Printer settings",children:[Nt.jsx(Qe,{size:18}),w&&Nt.jsx("span",{className:"hidden sm:inline",children:w.name})]}),i.length>0&&Object.keys(k).length>0&&Nt.jsxs("button",{onClick:()=>{const e=(()=>{const e=i.filter(e=>k[e.id]);if(0===e.length)return r({type:"error",message:"Please select at least one teller to print"}),null;const t=O();return`<!DOCTYPE html>\n<html>\n<head>\n  <title>Teller Reports - ${t}</title>\n  <style>\n    @media print {\n      @page { size: A4; margin: 0.5cm; }\n      body { margin: 0; padding: 0.5cm; }\n    }\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { \n      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n      background: #f5f5f5;\n      padding: 10px;\n    }\n    .page-title {\n      text-align: center;\n      margin-bottom: 15px;\n      font-size: 14px;\n      font-weight: bold;\n      padding: 10px;\n      border-bottom: 2px solid #333;\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: repeat(2, 1fr);\n      gap: 10px;\n      page-break-inside: avoid;\n    }\n    .card {\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      background: white;\n      padding: 10px;\n      page-break-inside: avoid;\n      box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n    }\n    .card-header {\n      border-bottom: 2px solid #4f46e5;\n      padding-bottom: 5px;\n      margin-bottom: 8px;\n    }\n    .card-header h4 {\n      font-size: 13px;\n      margin: 0;\n      color: #1f2937;\n    }\n    .card-header p {\n      font-size: 10px;\n      color: #6b7280;\n      margin: 2px 0 0 0;\n    }\n    .card-body {\n      font-size: 10px;\n    }\n    .daily-table {\n      width: 100%;\n      border-collapse: collapse;\n      margin-bottom: 8px;\n    }\n    .daily-table th, .daily-table td {\n      border: 1px solid #e5e7eb;\n      padding: 3px;\n      text-align: right;\n      font-size: 9px;\n    }\n    .daily-table th {\n      background: #f3f4f6;\n      font-weight: 600;\n      text-align: center;\n    }\n    .daily-table td:first-child, .daily-table th:first-child {\n      text-align: left;\n    }\n    .totals {\n      border-top: 1px solid #e5e7eb;\n      padding-top: 5px;\n    }\n    .total-row {\n      display: flex;\n      justify-content: space-between;\n      font-size: 9px;\n      margin-bottom: 3px;\n    }\n    .total-comp {\n      display: flex;\n      justify-content: space-between;\n      font-size: 10px;\n      font-weight: bold;\n      padding-top: 3px;\n      border-top: 1px solid #d1d5db;\n      margin-top: 3px;\n      color: #4f46e5;\n    }\n    @media print {\n      .cards-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }\n      .card { padding: 8px; }\n      body { background: white; }\n    }\n  </style>\n</head>\n<body>\n  <div class="page-title">Teller Salary Calculation - ${t}</div>\n  <div class="cards-container">\n    ${e.map(e=>{const t=e.over||{};let n=0;const r=T.map(({key:r,label:a})=>{const i=t[r]||0,s=`${e.id}-${r}`,o=C[s]?P:0;return n+=o,`<tr><td>${a}</td><td>${i.toFixed(2)}</td><td>${o.toFixed(2)}</td></tr>`}).join(""),a=R(t),i=n+a;return`\n        <div class="card">\n          <div class="card-header">\n            <h4>${e.name}</h4>\n            <p>ID: ${e.id}</p>\n          </div>\n          <div class="card-body">\n            <table class="daily-table">\n              <thead>\n                <tr><th>Day</th><th>Over</th><th>Base</th></tr>\n              </thead>\n              <tbody>\n                ${r}\n              </tbody>\n            </table>\n            <div class="totals">\n              <div class="total-row"><span>Over Total:</span> <strong>${a.toFixed(2)}</strong></div>\n              <div class="total-row"><span>Base Total:</span> <strong>${n.toFixed(2)}</strong></div>\n              <div class="total-comp"><span>TOTAL:</span> <strong>${i.toFixed(2)}</strong></div>\n            </div>\n          </div>\n        </div>\n      `}).join("")}\n  </div>\n  <script>\n    window.onload = () => {\n      setTimeout(() => {\n        window.print();\n      }, 250);\n    };\n  <\/script>\n</body>\n</html>`})();if(!e)return;const t=window.open("","_blank");t?(t.document.write(e),t.document.close(),t.focus()):r({type:"error",message:"Failed to open print window"})},className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition",title:"Print selected tellers on A4 paper (6 per page)",children:[Nt.jsx(de,{size:18}),Nt.jsxs("span",{children:["Print A4 (",Object.keys(k).length,")"]})]})]}),S&&Nt.jsxs("div",{className:"mt-4 p-4 rounded-lg border-2 border-indigo-600 "+(a?"bg-gray-700":"bg-indigo-50"),children:[Nt.jsxs("h3",{className:"font-semibold mb-3 "+(a?"text-white":"text-gray-900"),children:[Nt.jsx(Ze,{size:18,className:"inline mr-2"}),"USB Printer Settings"]}),0===v.length?Nt.jsx("div",{className:"text-sm p-2 rounded "+(a?"bg-gray-600 text-gray-300":"bg-white text-gray-600"),children:"No printers found. Please connect a USB printer."}):Nt.jsx("div",{className:"space-y-2 mb-4",children:v.map(e=>Nt.jsxs("button",{onClick:()=>(e=>{N(e),localStorage.setItem("selectedPrinterName",e.name),r({type:"success",message:`Printer set to: ${e.name}`})})(e),className:"w-full p-3 rounded-lg text-left transition flex items-center gap-3 "+((null==w?void 0:w.name)===e.name?"bg-indigo-600 text-white":a?"bg-gray-600 hover:bg-gray-500 text-gray-100":"bg-white hover:bg-gray-100 text-gray-900 border"),children:[Nt.jsx(Ze,{size:16}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"font-semibold text-sm",children:e.name}),e.isDefault&&Nt.jsx("div",{className:"text-xs opacity-70",children:"(Default Printer)"})]}),(null==w?void 0:w.name)===e.name&&Nt.jsx("div",{className:"ml-auto",children:""})]},e.name))}),Nt.jsxs("div",{className:`p-3 rounded-lg border ${a?"bg-gray-600 border-gray-500":"bg-white border-gray-200"} mt-3`,children:[Nt.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:_,onChange:e=>{return t=e.target.checked,A(t),localStorage.setItem("autoPrintEnabled",t.toString()),void r({type:"info",message:t?"Auto-print enabled":"Auto-print disabled"});var t},className:"rounded"}),Nt.jsx("span",{className:"text-sm font-medium "+(a?"text-gray-100":"text-gray-900"),children:"Auto-print when button clicked"})]}),Nt.jsx("p",{className:"text-xs mt-2 "+(a?"text-gray-400":"text-gray-600"),children:"When enabled, clicking print will directly send to the selected printer without showing a preview."})]}),Nt.jsx("button",{onClick:()=>j(!1),className:"w-full mt-3 px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition text-sm",children:"Close Settings"})]})]}),Nt.jsxs("div",{children:[i.length>0&&Nt.jsxs("div",{className:"mb-4 flex gap-2",children:[Nt.jsx("button",{onClick:()=>{if(i.length>0&&Object.keys(k).length===i.length)E({});else{const e={};i.forEach(t=>{e[t.id]=!0}),E(e)}},className:"px-4 py-2 rounded-lg font-semibold transition "+(i.length>0&&Object.keys(k).length===i.length?"bg-blue-600 hover:bg-blue-700 text-white":a?"bg-gray-700 hover:bg-gray-600 text-gray-300":"bg-gray-200 hover:bg-gray-300 text-gray-900"),children:i.length>0&&Object.keys(k).length===i.length?"Deselect All":"Select All"}),Object.keys(k).length>0&&Nt.jsxs("span",{className:"px-4 py-2 rounded-lg font-semibold "+(a?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-900"),children:[Object.keys(k).length," selected"]})]}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===i.length?Nt.jsx("div",{className:"col-span-full p-8 rounded-lg text-center "+(a?"bg-gray-800 text-gray-400":"bg-white text-gray-500"),children:Nt.jsx("p",{children:"No tellers found for this week"})}):i.map(e=>{const t=e.over||{},n=R(t),i=P,s=T.filter(({key:t})=>{const n=`${e.id}-${t}`;return C[n]}).length,o=P*s,d=o+n;return Nt.jsxs("div",{className:"rounded-xl shadow-lg overflow-hidden transition transform hover:shadow-xl "+(a?"bg-gray-800":"bg-white"),children:[Nt.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 p-4",children:Nt.jsxs("div",{className:"flex justify-between items-start gap-2",children:[Nt.jsx("button",{type:"button",onClick:()=>{return t=e.id,void E(e=>c(l({},e),{[t]:!e[t]}));var t},className:"flex-shrink-0 mt-0.5 text-white hover:opacity-80 transition",title:"Select for batch print",children:k[e.id]?Nt.jsx(et,{size:20}):Nt.jsx(tt,{size:20})}),Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"text-lg font-bold text-white",children:e.name}),Nt.jsxs("p",{className:"text-indigo-100 text-sm",children:["Teller ID: ",e.id]})]}),Nt.jsxs("button",{type:"button",onClick:()=>B(e),className:"inline-flex items-center gap-1 px-3 py-1 bg-white/20 hover:bg-white/30 rounded-full text-white text-xs font-semibold transition flex-shrink-0",children:[Nt.jsx(de,{size:14}),"Print"]}),Nt.jsxs("button",{type:"button",onClick:()=>(e=>{const t=e.over||{},n=O();let a=0;const i=["RMI TELLER REPORT","==================",`Teller: ${e.name}`,`ID: ${e.id}`,`Period: ${n}`,"","Day         Over Amount      Base Salary","---         -----------      -----------"];T.forEach(({key:n,label:r})=>{const s=t[n]||0,o=`${e.id}-${n}`,l=C[o]?P:0;a+=l;const c=`${r.padEnd(11)}${I(s).padStart(15)}${I(l).padStart(16)}`;i.push(c)});const s=R(t),o=a+s;i.push("---         -----------      -----------"),i.push(`OVER Total${I(s).padStart(30)}`),i.push(`BASE Total${I(a).padStart(30)}`),i.push(`TOTAL COMP${I(o).padStart(30)}`);const l=i.join("\n");navigator.clipboard.writeText(l).then(()=>{r({type:"success",message:"Report copied to clipboard!"})}).catch(()=>{r({type:"error",message:"Failed to copy report"})})})(e),className:"inline-flex items-center gap-1 px-3 py-1 bg-white/20 hover:bg-white/30 rounded-full text-white text-xs font-semibold transition flex-shrink-0",title:"Copy report to clipboard",children:[Nt.jsx(Ge,{size:14}),"Copy"]})]})}),Nt.jsxs("div",{className:"p-4",children:[Nt.jsx("div",{className:"mb-4 p-3 rounded-lg "+(a?"bg-gray-700":"bg-gray-50"),children:Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("span",{className:"text-sm font-semibold "+(a?"text-gray-300":"text-gray-700"),children:"Base Salary"}),Nt.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:["",i.toFixed(2)]})]})}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("h4",{className:"text-sm font-semibold mb-3 "+(a?"text-gray-300":"text-gray-700"),children:"Daily Over (Cash) - Click to toggle base salary per day"}),Nt.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs font-semibold text-gray-500 dark:text-gray-400 border-b pb-2",children:[Nt.jsx("span",{children:"Day"}),Nt.jsx("span",{children:"Over"}),Nt.jsx("span",{children:"Base Salary"}),Nt.jsx("span",{className:"text-center",children:"Include?"})]}),Nt.jsx("div",{className:"space-y-2 mt-3",children:T.map(({key:n,label:r})=>{const i=t[n]||0,s=e.id,o=C[`${s}-${n}`],d=o?P:0;return Nt.jsxs("div",{className:`grid grid-cols-4 gap-2 items-center p-2 rounded ${o?a?"bg-green-900/20":"bg-green-50":a?"bg-gray-800":"bg-white"} border ${o?"border-green-300":a?"border-gray-700":"border-gray-200"}`,children:[Nt.jsx("div",{className:"text-sm font-medium "+(a?"text-gray-300":"text-gray-700"),children:r}),Nt.jsxs("div",{className:"text-sm font-semibold "+(i>0?"text-green-600":i<0?"text-red-600":a?"text-gray-500":"text-gray-400"),children:["",i.toFixed(2)]}),Nt.jsxs("div",{className:"text-sm font-semibold "+(o?"text-green-600":a?"text-gray-500":"text-gray-400 line-through"),children:["",d.toFixed(2)]}),Nt.jsx("button",{onClick:()=>((e,t)=>{const n=`${e}-${t}`;M(e=>c(l({},e),{[n]:!e[n]}))})(s,n),className:"px-2 py-1 rounded text-xs font-semibold transition "+(o?"bg-green-600 text-white hover:bg-green-700":a?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-300 text-gray-600 hover:bg-gray-400"),title:o?"Click to exclude base salary":"Click to include base salary",children:o?"YES":"NO"})]},n)})})]}),Nt.jsx("div",{className:"pt-3 border-t "+(a?"border-gray-700":"border-gray-200"),children:Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("span",{className:"font-semibold "+(a?"text-gray-300":"text-gray-700"),children:"Weekly Over Total"}),Nt.jsxs("span",{className:"text-xl font-bold "+(n>0?"text-green-600":n<0?"text-red-600":"text-gray-400"),children:["",n.toFixed(2)]})]})}),Nt.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-700",children:[Nt.jsx("div",{className:"text-xs font-semibold text-indigo-700 dark:text-indigo-300 mb-2",children:"Total Compensation"}),Nt.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:["",d.toFixed(2)]}),Nt.jsxs("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 mt-1",children:["Base (",s," days  ",P,") ",o.toFixed(2)," + Over ",n.toFixed(2)]})]}),Nt.jsxs("div",{className:"mt-4 border-t border-dashed border-gray-400 pt-3 text-xs text-gray-500 dark:text-gray-400",children:[Nt.jsxs("div",{className:"flex justify-between items-center",children:[Nt.jsx("span",{children:"Prepared By"}),Nt.jsx("div",{className:"border-t border-dashed border-gray-400 w-32"})]}),Nt.jsxs("div",{className:"flex justify-between items-center mt-2",children:[Nt.jsx("span",{children:"Supervisor Signature"}),Nt.jsx("div",{className:"border-t border-dashed border-gray-400 w-32"})]})]})]})]},e.id)})})]}),i.length>0&&Nt.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-6",children:[Nt.jsxs("div",{className:`rounded-xl p-6 ${a?"bg-gray-800":"bg-white"} shadow-lg`,children:[Nt.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-2`,children:"Total Tellers"}),Nt.jsx("p",{className:"text-3xl font-bold text-indigo-600",children:i.length})]}),Nt.jsxs("div",{className:`rounded-xl p-6 ${a?"bg-gray-800":"bg-white"} shadow-lg`,children:[Nt.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-2`,children:"Weekly Base Salary (Each)"}),Nt.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["",D.toFixed(2)]})]}),Nt.jsxs("div",{className:`rounded-xl p-6 ${a?"bg-gray-800":"bg-white"} shadow-lg`,children:[Nt.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-2`,children:"Total Weekly Over"}),Nt.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["",i.reduce((e,t)=>e+R(t.over),0).toFixed(2)]})]}),Nt.jsxs("div",{className:`rounded-xl p-6 ${a?"bg-gray-800":"bg-white"} shadow-lg`,children:[Nt.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"} mb-2`,children:"Avg Weekly Over"}),Nt.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["",(i.length>0?i.reduce((e,t)=>e+R(t.over),0)/i.length:0).toFixed(2)]})]})]})]})}):Nt.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen "+(a?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Access Denied"}),Nt.jsx("p",{className:"text-sm opacity-70",children:"You do not have permission to view this page."})]})}function Bte(){const[e,t]=f.useState([]),[n,r]=f.useState(localStorage.getItem("username")||"Unknown"),[a,i]=f.useState("");f.useEffect(()=>{s()},[]);const s=()=>h(null,null,function*(){try{const e=yield pt.get(`https://rmi-backend-zhdr.onrender.com/api/transactions/supervisor/${n}`);t(e.data)}catch(e){console.error("Error fetching history:",e),i("Failed to load history. Check backend connection.")}});return Nt.jsx("div",{className:"min-h-screen bg-gray-100 p-6 fade-in",children:Nt.jsxs("div",{className:"bg-white shadow-lg p-6 rounded-xl max-w-5xl mx-auto",children:[Nt.jsx("h1",{className:"text-2xl font-bold mb-4",children:" Transaction History"}),Nt.jsxs("p",{className:"text-gray-600 mb-4",children:["Supervisor: ",n]}),a&&Nt.jsx("div",{className:"text-red-500 mb-4",children:a}),Nt.jsxs("table",{className:"w-full border border-gray-300 rounded",children:[Nt.jsx("thead",{className:"bg-gray-200",children:Nt.jsxs("tr",{children:[Nt.jsx("th",{className:"p-2 text-left",children:"Teller"}),Nt.jsx("th",{className:"p-2 text-left",children:"Type"}),Nt.jsx("th",{className:"p-2 text-right",children:"Amount"}),Nt.jsx("th",{className:"p-2 text-left",children:"Date"})]})}),Nt.jsx("tbody",{children:e.map(e=>{var t;return Nt.jsxs("tr",{className:"border-t",children:[Nt.jsx("td",{className:"p-2",children:e.teller}),Nt.jsx("td",{className:"p-2",children:e.type}),Nt.jsxs("td",{className:"p-2 text-right",children:["",null==(t=e.amount)?void 0:t.toLocaleString()]}),Nt.jsx("td",{className:"p-2 text-sm text-gray-500",children:new Date(e.date).toLocaleString()})]},e._id)})})]}),!e.length&&Nt.jsx("p",{className:"text-gray-500 text-center mt-4",children:"No transactions yet."})]})})}function Lte(){var e;const{settings:t,user:n}=f.useContext($c),r="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),[a,i]=f.useState(null),[s,o]=f.useState(!0),[l,c]=f.useState(null),[d,u]=f.useState(new Date);f.useEffect(()=>{p();const e=setInterval(()=>{p()},18e4);return()=>clearInterval(e)},[]);const p=()=>h(null,null,function*(){var e,t;try{o(!0),c(null);const e=`${zc()}/api/reports/supervisor/staff-performance`,t=yield pt.get(e,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});t.data.success?(i(t.data.data),u(new Date),t.data.message?c(t.data.message):c(null)):c("Failed to fetch staff performance data")}catch(n){console.error("Error fetching staff performance data:",n),c((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch staff performance data")}finally{o(!1)}});if(s)return Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"flex items-center justify-center h-64",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),Nt.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-300",children:"Loading staff performance..."})]})});if(l)return Nt.jsx("div",{className:"p-6",children:Nt.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:Nt.jsxs("div",{className:"flex",children:[Nt.jsx("div",{className:"flex-shrink-0",children:Nt.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:Nt.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Nt.jsxs("div",{className:"ml-3",children:[Nt.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error Loading Performance Data"}),Nt.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:l}),Nt.jsx("button",{onClick:p,className:"mt-3 bg-red-100 dark:bg-red-800 px-3 py-1 rounded text-sm text-red-800 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-700",children:"Retry"})]})]})})});if(!a||!a.staffReports||0===a.staffReports.length)return Nt.jsx("div",{className:"p-6",children:Nt.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[Nt.jsx(X,{className:"mx-auto h-12 w-12 text-gray-400"}),Nt.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"No Staff Performance Data"}),Nt.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"No betting event data available for your staff."})]})});const{staffReports:m}=a,g=(x=m)&&0!==x.length?Math.max(...x.map(e=>e.betAmount||0)):1;var x;const y=[...m].sort((e,t)=>(t.betAmount||0)-(e.betAmount||0));return Nt.jsxs("div",{className:"p-6 space-y-6",children:[Nt.jsx("div",{className:"rounded-lg shadow p-6 "+(r?"bg-gray-800":"bg-white"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:" Staff Performance"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Betting Event Performance - Your Team"}),Nt.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[" Auto-refresh every 3 minutes  Last updated: ",d.toLocaleTimeString()]})]}),Nt.jsxs("button",{onClick:p,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2",children:[Nt.jsx(Ae,{size:16}),"Refresh"]})]})}),Nt.jsxs("div",{className:"rounded-lg shadow p-6 "+(r?"bg-gray-800":"bg-white"),children:[Nt.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[Nt.jsx(X,{className:"w-6 h-6"}),"Bet Amount Performance (Highest to Lowest)"]}),Nt.jsx("div",{className:"space-y-4",children:y.map((e,t)=>{const n=(a=e.betAmount||0,0===(i=g)?0:a/i*100);var a,i;return Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsx("div",{className:"flex items-center justify-between text-sm",children:Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+(0===t?"bg-yellow-500 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"),children:t+1}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),Nt.jsxs("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:["@",e.username]})]})]})}),Nt.jsxs("div",{className:"relative",children:[Nt.jsx("div",{className:"h-8 rounded-lg "+(0===t?"bg-gradient-to-r from-yellow-400 to-yellow-500":1===t?"bg-gradient-to-r from-gray-400 to-gray-500":2===t?"bg-gradient-to-r from-orange-400 to-orange-500":"bg-gradient-to-r from-blue-400 to-blue-500"),style:{width:`${n}%`}}),Nt.jsx("div",{className:"h-8 rounded-lg border-2 border-dashed absolute top-0 right-0 "+(r?"border-gray-600":"border-gray-300"),style:{width:100-n+"%",left:`${n}%`}})]})]},t)})}),Nt.jsx("div",{className:"mt-8 p-4 rounded-lg "+(r?"bg-gray-700":"bg-gray-50"),children:Nt.jsx("div",{className:"grid grid-cols-1 gap-4 text-center",children:Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Staff"}),Nt.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.length})]})})})]})]})}function Fte(){var e,t,n,r,a,i,s,o,l,c,d,u,p,m;const{user:g,settings:x}=f.useContext($c),{showToast:y}=Kc(),v="dark"===(null==(e=null==x?void 0:x.theme)?void 0:e.mode),[b,w]=f.useState(!0),[N,S]=f.useState(!1),[j,_]=f.useState(null),[A,C]=f.useState(""),[E,T]=f.useState(!1),P=(new Date).toISOString().split("T")[0],D={teller:(null==(t=null==x?void 0:x.baseSalaries)?void 0:t.teller)||(null==(n=null==x?void 0:x.baseSalary)?void 0:n.teller)||(null==g?void 0:g.baseSalary)||450,supervisor:(null==(r=null==x?void 0:x.baseSalaries)?void 0:r.supervisor)||(null==(a=null==x?void 0:x.baseSalary)?void 0:a.supervisor)||(null==g?void 0:g.baseSalary)||600,supervisor_teller:(null==(i=null==x?void 0:x.baseSalaries)?void 0:i.supervisor_teller)||(null==(s=null==x?void 0:x.baseSalary)?void 0:s.supervisor)||(null==g?void 0:g.baseSalary)||600,admin:(null==(o=null==x?void 0:x.baseSalaries)?void 0:o.admin)||(null==(l=null==x?void 0:x.baseSalary)?void 0:l.admin)||0,head_watcher:(null==(c=null==x?void 0:x.baseSalaries)?void 0:c.head_watcher)||(null==(d=null==x?void 0:x.baseSalary)?void 0:d.head_watcher)||450,sub_watcher:(null==(u=null==x?void 0:x.baseSalaries)?void 0:u.sub_watcher)||(null==(p=null==x?void 0:x.baseSalary)?void 0:p.sub_watcher)||400};f.useEffect(()=>{g&&(R(),I())},[g]);const R=()=>h(null,null,function*(){try{w(!0);const e=yield pt.get(`${zc()}/api/shift/today/${g._id}`);e.data.shift?(_(e.data.shift),C(e.data.shift.roleWorkedAs)):C(g.role)}catch(e){console.error("Error fetching today's shift:",e),C(g.role)}finally{w(!1)}}),I=()=>h(null,null,function*(){try{const e=yield pt.get(`${zc()}/api/teller-management/capital/check-today/${g._id}`);T(e.data.hasCapital||!1)}catch(e){console.error("Error checking capital:",e)}});if(!g)return Nt.jsx("div",{className:"flex items-center justify-center min-h-screen "+(v?"bg-gray-900":"bg-gray-50"),children:Nt.jsx(ue,{className:"w-8 h-8 animate-spin"})});if(!g.role.includes("supervisor"))return Nt.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-6 "+(v?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:[Nt.jsx(M,{className:"w-16 h-16 mb-4 text-yellow-500"}),Nt.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Access Restricted"}),Nt.jsx("p",{className:"text-gray-500",children:"This feature is only available for supervisors"})]});const O=D[A]||D[g.role]||450;return Nt.jsx("div",{className:"min-h-screen p-6 "+(v?"bg-gray-900 text-gray-100":"bg-gray-50 text-gray-900"),children:Nt.jsxs("div",{className:"max-w-4xl mx-auto",children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[Nt.jsx(nt,{className:"w-8 h-8 text-purple-500"}),"My Shift"]}),Nt.jsx("p",{className:"text-gray-500 mt-2",children:"Manage your work role for today"})]}),Nt.jsxs("div",{className:"mb-6 p-6 rounded-xl shadow-lg "+(v?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[Nt.jsx(W,{className:"w-5 h-5"}),"Today's Status"]}),Nt.jsx("div",{className:"text-sm text-gray-500",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),Nt.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[Nt.jsxs("div",{className:"p-4 rounded-lg "+(v?"bg-gray-700":"bg-blue-50"),children:[Nt.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Assigned Role"}),Nt.jsx("div",{className:"font-semibold text-lg capitalize",children:g.role.replace("_"," ")})]}),Nt.jsxs("div",{className:"p-4 rounded-lg "+(v?"bg-gray-700":"bg-purple-50"),children:[Nt.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Working As"}),Nt.jsx("div",{className:"font-semibold text-lg capitalize text-purple-600",children:(null==(m=null==j?void 0:j.roleWorkedAs)?void 0:m.replace("_"," "))||g.role.replace("_"," ")})]}),Nt.jsxs("div",{className:"p-4 rounded-lg "+(v?"bg-gray-700":"bg-green-50"),children:[Nt.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Today's Base Salary"}),Nt.jsxs("div",{className:"font-semibold text-lg text-green-600",children:["",O.toLocaleString()]})]})]}),E&&Nt.jsx("div",{className:"mt-4 p-3 rounded-lg bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700",children:Nt.jsxs("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-300",children:[Nt.jsx(k,{className:"w-4 h-4"}),Nt.jsx("span",{className:"text-sm font-medium",children:"Capital assigned today"})]})})]}),Nt.jsxs("div",{className:"p-6 rounded-xl shadow-lg "+(v?"bg-gray-800":"bg-white"),children:[Nt.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[Nt.jsx(se,{className:"w-5 h-5"}),"Change Work Role"]}),Nt.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select the role you're working as today. Your base salary will automatically adjust based on the role you choose."}),Nt.jsxs("div",{className:"mb-6",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-3",children:"Select Role for Today"}),Nt.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:["supervisor","teller","supervisor_teller"].map(e=>{var t;return Nt.jsx("button",{onClick:()=>C(e),disabled:N,className:`p-4 rounded-lg border-2 transition-all ${A===e?"border-purple-500 bg-purple-50 dark:bg-purple-900/30":v?"border-gray-600 bg-gray-700 hover:border-gray-500":"border-gray-300 bg-white hover:border-gray-400"} ${N?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{className:"text-left",children:[Nt.jsx("div",{className:"font-semibold capitalize mb-1",children:e.replace("_"," ")}),Nt.jsxs("div",{className:"text-sm text-gray-500",children:["Base: ",null==(t=D[e])?void 0:t.toLocaleString()]})]}),A===e&&Nt.jsx(k,{className:"w-5 h-5 text-purple-500"})]})},e)})})]}),Nt.jsx("div",{className:"p-4 rounded-lg mb-6 "+(v?"bg-blue-900/30 border border-blue-700":"bg-blue-50 border border-blue-200"),children:Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx(xe,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),Nt.jsxs("div",{className:"text-sm",children:[Nt.jsx("p",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"How it works:"}),Nt.jsxs("ul",{className:"space-y-1 text-blue-600 dark:text-blue-400",children:[Nt.jsxs("li",{children:[" When you shift to ",Nt.jsx("strong",{children:"Teller"}),", you'll receive teller base salary (",D.teller,")"]}),Nt.jsxs("li",{children:[" When you add capital as ",Nt.jsx("strong",{children:"Teller"}),", you'll receive supervisor base salary (",D.supervisor,")"]}),Nt.jsx("li",{children:" Your payroll will automatically use the correct base salary"})]})]})]})}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;if(A)if(A!==g.role||j)try{S(!0);const e=yield pt.post(`${zc()}/api/shift/set`,{userId:g._id,roleWorkedAs:A,date:P});_(e.data.shift),y({type:"success",message:`Shift set to ${A.replace("_"," ").toUpperCase()}`}),yield R(),yield I()}catch(n){console.error("Error setting shift:",n),y({type:"error",message:(null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to set shift"})}finally{S(!1)}else y({type:"info",message:"This is already your assigned role"});else y({type:"warning",message:"Please select a role"})}),disabled:N||b||A===((null==j?void 0:j.roleWorkedAs)||g.role),className:"w-full py-3 px-4 rounded-lg bg-purple-600 text-white font-semibold hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:N?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(ue,{className:"w-5 h-5 animate-spin"}),"Updating Shift..."]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(nt,{className:"w-5 h-5"}),"Set Work Role for Today"]})}),j&&Nt.jsxs("div",{className:"mt-4 text-center text-sm text-gray-500",children:["Last updated: ",new Date(j.updatedAt).toLocaleTimeString()]})]}),Nt.jsx("div",{className:"mt-6 p-4 rounded-lg "+(v?"bg-gray-800":"bg-gray-100"),children:Nt.jsxs("div",{className:"flex items-start gap-3",children:[Nt.jsx(M,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),Nt.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Nt.jsx("p",{className:"font-medium mb-1",children:"Important Notes:"}),Nt.jsxs("ul",{className:"space-y-1",children:[Nt.jsx("li",{children:" This only affects your role for today"}),Nt.jsx("li",{children:" Your official role assignment remains unchanged"}),Nt.jsx("li",{children:" Payroll calculations will use the role you select here"}),Nt.jsx("li",{children:" You can change your shift role anytime during the day"})]})]})]})})]})})}function Ute(){var e;const{user:t,settings:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==n?void 0:n.theme)?void 0:e.mode),i=zc(),[s,o]=f.useState([]),[l,c]=f.useState([]),[d,u]=f.useState([]),[p,m]=f.useState(null),[g,x]=f.useState(!1),[y,v]=f.useState([]),[b,w]=f.useState([]),[N,S]=f.useState(!1),j=(new Date).toLocaleDateString(),_=new Date(Date.now()+864e5).toLocaleDateString();f.useEffect(()=>{A(),C()},[]);const A=()=>h(null,null,function*(){try{const e=yield pt.get(`${i}/api/attendance/tellers`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});o(e.data.tellers)}catch(e){r("Failed to fetch tellers","error"),console.error("Error fetching tellers:",e)}}),C=()=>h(null,null,function*(){try{const e=yield pt.get(`${i}/api/attendance/today`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e.data.attendance&&(m(e.data.attendance),c(e.data.attendance.presentTellers.map(e=>e.userId)),u(e.data.attendance.absentTellers))}catch(e){console.error("Error fetching attendance:",e)}});return Nt.jsx("div",{className:"min-h-screen p-6 "+(a?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"),children:Nt.jsxs("div",{className:"max-w-6xl mx-auto",children:[Nt.jsxs("div",{className:"mb-8",children:[Nt.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Nt.jsx("div",{className:"p-3 rounded-lg "+(a?"bg-blue-900/20":"bg-blue-100"),children:Nt.jsx(U,{className:"w-8 h-8 text-blue-600"})}),Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold",children:"Attendance-Based Scheduler"}),Nt.jsx("p",{className:"text-lg "+(a?"text-gray-400":"text-gray-600"),children:"Mark today's attendance to generate fair AI-powered schedules"})]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{className:"p-4 rounded-lg border "+(a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx(W,{className:"w-5 h-5 text-green-600"}),Nt.jsx("span",{className:"font-medium",children:"Today's Attendance"})]}),Nt.jsx("p",{className:"text-lg font-bold mt-1",children:j})]}),Nt.jsxs("div",{className:"p-4 rounded-lg border "+(a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx(Xe,{className:"w-5 h-5 text-purple-600"}),Nt.jsx("span",{className:"font-medium",children:"AI Schedule For"})]}),Nt.jsx("p",{className:"text-lg font-bold mt-1",children:_})]})]})]}),p&&Nt.jsxs("div",{className:"mb-6 p-4 rounded-lg border "+(a?"bg-green-900/20 border-green-700":"bg-green-50 border-green-200"),children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[Nt.jsx(k,{className:"w-5 h-5 text-green-600"}),Nt.jsx("span",{className:"font-medium",children:"Attendance Marked"})]}),Nt.jsxs("p",{className:"text-sm",children:[p.presentTellers.length,"/",p.totalTellers," tellers present (",p.attendanceRate,"% attendance rate)"]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Nt.jsx("div",{className:"lg:col-span-2",children:Nt.jsxs("div",{className:"rounded-lg border p-6 "+(a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[Nt.jsx(rt,{className:"w-5 h-5"}),"Mark Today's Attendance"]}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:s.map(e=>{const t=l.includes(e._id),n=d.some(t=>t.userId===e._id);return Nt.jsx("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all "+(t?"border-green-500 "+(a?"bg-green-900/20":"bg-green-50"):n?"border-red-500 "+(a?"bg-red-900/20":"bg-red-50"):`border-gray-300 ${a?"bg-gray-700":"bg-gray-50"} hover:border-blue-400`),onClick:()=>{return t=e._id,void c(e=>e.includes(t)?e.filter(e=>e!==t):(u(e=>e.filter(e=>e.userId!==t)),[...e,t]));var t},children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"font-medium",children:e.name}),Nt.jsxs("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:["@",e.username]})]}),Nt.jsxs("div",{className:"flex items-center gap-2",children:[t&&Nt.jsx(O,{className:"w-5 h-5 text-green-600"}),n&&Nt.jsx(ce,{className:"w-5 h-5 text-red-600"}),!t&&!n&&Nt.jsx("button",{onClick:t=>{t.stopPropagation(),((e,t="no-show",n="")=>{const r=s.find(t=>t._id===e);r&&(c(t=>t.filter(t=>t!==e)),u(r=>{const a=r.filter(t=>t.userId!==e);return[...a,{userId:e,reason:t,note:n}]}))})(e._id)},className:"text-red-600 hover:text-red-700",children:Nt.jsx(at,{className:"w-4 h-4"})})]})]})},e._id)})}),Nt.jsxs("div",{className:"flex flex-wrap gap-3",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){if(l.length){x(!0);try{const e=yield pt.post(`${i}/api/attendance/mark`,{presentTellerIds:l,absentTellers:d},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});m(e.data.attendance),r(`Attendance marked: ${e.data.stats.present}/${e.data.stats.total} present`,"success")}catch(e){r("Failed to mark attendance","error"),console.error("Error marking attendance:",e)}finally{x(!1)}}else r("Please select at least one teller as present","error")}),disabled:g||!l.length,className:`px-6 py-2 rounded-lg flex items-center gap-2 ${a?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white disabled:opacity-50 disabled:cursor-not-allowed`,children:[g?Nt.jsx(Ae,{className:"w-4 h-4 animate-spin"}):Nt.jsx(O,{className:"w-4 h-4"}),"Mark Attendance (",l.length,")"]}),p&&Nt.jsxs("button",{onClick:()=>h(null,null,function*(){if(p&&p.presentTellers.length){x(!0);try{const e=yield pt.post(`${i}/api/schedule/ai-generate`,{requiredCount:3,forceRegenerate:!0},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});w(e.data.schedule),v(e.data.alternatives||[]),S(!0),r(`AI schedule generated for ${e.data.schedule.length} tellers`,"success")}catch(e){r("Failed to generate AI schedule","error"),console.error("Error generating AI schedule:",e)}finally{x(!1)}}else r("Please mark attendance first","error")}),disabled:g,className:`px-6 py-2 rounded-lg flex items-center gap-2 ${a?"bg-purple-600 hover:bg-purple-700":"bg-purple-500 hover:bg-purple-600"} text-white disabled:opacity-50`,children:[Nt.jsx(Xe,{className:"w-4 h-4"}),"Generate AI Schedule"]})]})]})}),Nt.jsx("div",{children:Nt.jsxs("div",{className:"rounded-lg border p-6 "+(a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[Nt.jsx(K,{className:"w-5 h-5"}),"Quick Stats"]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Total Tellers:"}),Nt.jsx("span",{className:"font-bold",children:s.length})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Present Today:"}),Nt.jsx("span",{className:"font-bold text-green-600",children:l.length})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Absent Today:"}),Nt.jsx("span",{className:"font-bold text-red-600",children:d.length})]}),p&&Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{children:"Attendance Rate:"}),Nt.jsxs("span",{className:"font-bold text-blue-600",children:[p.attendanceRate,"%"]})]})]}),p&&p.presentTellers.length>=3&&Nt.jsx("div",{className:"mt-4 p-3 rounded-lg "+(a?"bg-green-900/20":"bg-green-50"),children:Nt.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[Nt.jsx(k,{className:"w-4 h-4"}),Nt.jsx("span",{className:"text-sm font-medium",children:"Ready for AI scheduling"})]})})]})})]}),N&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Nt.jsxs("div",{className:"rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto "+(a?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[Nt.jsx(it,{className:"w-6 h-6 text-purple-600"}),Nt.jsx("h2",{className:"text-2xl font-bold",children:"AI-Generated Schedule"})]}),Nt.jsx("div",{className:"space-y-4 mb-6",children:b.map((e,t)=>Nt.jsx("div",{className:"p-4 rounded-lg border "+(a?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsxs("p",{className:"font-bold",children:["#",e.rank," ",e.tellerName]}),Nt.jsx("p",{className:"text-sm text-gray-500",children:e.reason})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["Score: ",e.aiScore]}),Nt.jsx("p",{className:"text-sm text-gray-500",children:"AI Method"})]})]})},e.tellerId))}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("button",{onClick:()=>{r("AI schedule confirmed and applied!","success"),S(!1)},className:`flex-1 py-3 rounded-lg ${a?"bg-purple-600 hover:bg-purple-700":"bg-purple-500 hover:bg-purple-600"} text-white font-medium`,children:"Confirm AI Schedule"}),Nt.jsx("button",{onClick:()=>S(!1),className:"px-6 py-3 rounded-lg border "+(a?"border-gray-600 hover:bg-gray-700":"border-gray-300 hover:bg-gray-100"),children:"Cancel"})]})]})})]})})}function zte(){const e=y(),{isDarkMode:t,user:n}=f.useContext($c),r=(null==n?void 0:n.role)||"admin",{fights:a,setFights:i,fightNumber:s,setFightNumber:o,today:l,syncing:c,loadTodaysFights:d,recordEntryResults:u,addFight:p,removeFight:m,updateFight:g,entries:x}=f.useContext(qc),[v,b]=f.useState(""),[w,N]=f.useState(""),[S,j]=f.useState(null),[_,A]=f.useState([]),[C,k]=f.useState(!1),[E,P]=f.useState([]),[D,R]=f.useState(!1),[I,B]=f.useState(!1),[L,F]=f.useState(""),[U,z]=f.useState(!1),[H,G]=f.useState(300),[V,$]=f.useState(300),[W,Y]=f.useState(!1),[X,K]=f.useState(!1),[q,J]=f.useState(""),[Q,Z]=f.useState(""),[ee,te]=f.useState(""),[ne,re]=f.useState([]),[ae,ie]=f.useState(""),[se,oe]=f.useState(""),[le,de]=f.useState(""),[ue,he]=f.useState([]),[pe,me]=f.useState(!1),[ge,fe]=f.useState([]),[xe,ye]=f.useState(null),[ve,be]=f.useState([]);f.useEffect(()=>{d(),Pe()},[]),f.useEffect(()=>{we()},[]),f.useEffect(()=>{const e=(new Date).getDay(),t=4===e?300:6===e?500:300,n=localStorage.getItem("chicken-fight-global-2wins-fee");if(n){const r=parseInt(n,10);isNaN(r)?(console.log(`No valid saved fee, using day-based default: ${t} (day ${e})`),$(t)):(console.log("Loaded global2WinsFee from localStorage:",r),$(r))}else console.log(`No saved global2WinsFee, using day-based default: ${t} (day ${e})`),$(t)},[]),f.useEffect(()=>{console.log("Saving global2WinsFee to localStorage:",V),localStorage.setItem("chicken-fight-global-2wins-fee",V.toString())},[V]);const we=()=>{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);if(n&&n.startsWith("chicken-fight-")&&!n.includes("number")){const t=n.replace("chicken-fight-","");t===l||e.includes(t)||e.push(t)}}fe(e.sort().reverse())},Ne="unknown"===q?{_id:"unknown",entryName:"Unknown Entry",gameType:"2wins",legBandNumbers:[]}:_.find(e=>e._id===q),Se=(null==Ne?void 0:Ne.legBandNumbers)||[],je="unknown"===ae?{_id:"unknown",entryName:"Unknown Entry",gameType:"2wins",legBandNumbers:[]}:_.find(e=>e._id===ae),_e=(null==je?void 0:je.legBandNumbers)||[];new Set(a.map(e=>e.legNumber).filter(Boolean));const Ae=new Set(a.filter(e=>"cancelled"!==e.result).map(e=>e.legBandFought).filter(Boolean));Se.filter(e=>!Ae.has(e)),_e.filter(e=>!Ae.has(e));const Ce=_.filter(e=>!0),Me=Ce.filter(e=>{if(e._id===ae)return!1;if(e.legBandNumbers&&e.legBandNumbers.length>0){return e.legBandNumbers.filter(e=>!Ae.has(e)).length>0}return!0}),ke=Ce.filter(e=>{if(e._id===q)return!1;if(e.legBandNumbers&&e.legBandNumbers.length>0){return e.legBandNumbers.filter(e=>!Ae.has(e)).length>0}return!0}),[Ee,Te]=f.useState(null);f.useEffect(()=>{h(null,null,function*(){yield De(),yield new Promise(e=>setTimeout(e,300)),yield Re(),yield new Promise(e=>setTimeout(e,300)),yield Ie(),yield new Promise(e=>setTimeout(e,300)),yield Be()})},[]);const Pe=()=>h(null,null,function*(){try{const e=localStorage.getItem("token");if(!e)return;const t=yield pt.get(`${zc()}/api/chicken-fight/fights/today`,{headers:{Authorization:`Bearer ${e}`}});if(t.data.success&&t.data.game&&(j(t.data.game),console.log(" Game data loaded:",t.data.game),t.data.game.entryResults&&t.data.game.entryResults.length>0)){const e=[],n=t.data.game.entryResults.flatMap(e=>{var t;return(null==(t=e.legResults)?void 0:t.map(e=>e.legNumber))||[]}),r=n.length>0?Math.max(...n):0;console.log(" Leg numbers found:",n,"Max:",r),t.data.game.entryResults.forEach(t=>{var n;null==(n=t.legResults)||n.forEach(n=>{const r="win"===n.result?1:"draw"===n.result?.5:"cancelled"===n.result?-1:0;e.push({legNumber:n.legNumber,entryId:t.entryId,entryName:t.entryName,gameType:t.gameType,result:r})})}),console.log(" Syncing fights from gameData:",e),i(e);const a=Number.isFinite(r)?r:0;console.log(" Setting fight number to:",a),o(a)}}catch(e){console.error("Error loading game data:",e)}}),De=()=>h(null,null,function*(){k(!0);try{const e=yield pt.get(`${zc()}/api/chicken-fight/entries`);e.data.success&&A(e.data.entries||[])}catch(e){console.error("Error fetching entries:",e),b("Failed to load entries")}finally{k(!1)}}),Re=()=>h(null,null,function*(){var e,t;R(!0);try{console.log(` Fetching registrations for date: ${l}`);const e=yield pt.get(`${zc()}/api/chicken-fight-registration/registrations`,{params:{gameDate:l},timeout:1e4});console.log(" Registrations response:",e.data),e.data.success?(P(e.data.registrations||[]),console.log(` Loaded ${e.data.count} registrations`)):(console.warn(" API returned success: false"),P([]))}catch(n){429!==(null==(e=n.response)?void 0:e.status)&&(console.error(" Error fetching registrations:",n.message),console.error("  Status:",null==(t=n.response)?void 0:t.status)),P([])}finally{R(!1)}}),Ie=()=>h(null,null,function*(){var e;try{const e=yield pt.get(`${zc()}/api/chicken-fight-registration/registrations-stats`,{params:{gameDate:l},timeout:1e4});e.data.success&&Te(e.data.stats)}catch(t){429!==(null==(e=t.response)?void 0:e.status)&&console.error("Error fetching stats:",t.message)}}),Oe=(e,t)=>h(null,null,function*(){var n,r;try{yield pt.put(`${zc()}/api/chicken-fight-registration/registrations/${e}/pay`,{gameType:t}),N(`Payment recorded for ${t}`),Re(),Ie(),setTimeout(()=>N(""),2e3)}catch(a){b((null==(r=null==(n=a.response)?void 0:n.data)?void 0:r.message)||"Failed to mark payment")}}),Be=()=>h(null,null,function*(){var e;try{const e=yield pt.get(`${zc()}/api/chicken-fight/entries`,{timeout:1e4});if(e.data.success&&e.data.entries){console.log(` Auto-registering ${e.data.entries.length} entries...`);const n=200;for(let r=0;r<e.data.entries.length;r++){const a=e.data.entries[r];try{yield pt.post(`${zc()}/api/chicken-fight-registration/registrations`,{entryId:a._id,entryName:a.entryName,gameTypes:["2wins","3wins"],gameDate:l},{timeout:1e4}).then(()=>{console.log(` Registered: ${a.entryName}`)}).catch(e=>{var t,n;409!==(null==(t=e.response)?void 0:t.status)&&console.warn(` Registration skipped for ${a.entryName}:`,null==(n=e.response)?void 0:n.status)}),r<e.data.entries.length-1&&(yield new Promise(e=>setTimeout(e,n)))}catch(t){console.error(` Error registering ${a.entryName}:`,t.message)}}console.log(" Auto-registration complete, fetching updated data..."),yield Re(),yield Ie()}}catch(t){429!==(null==(e=t.response)?void 0:e.status)&&console.error("Auto-registration error:",t.message)}}),Le=(e,t)=>h(null,null,function*(){var n,r;try{yield pt.put(`${zc()}/api/chicken-fight-registration/registrations/${e}/withdraw`,{gameType:t}),N(`Payment withdrawn for ${t}`),Re(),Ie(),setTimeout(()=>N(""),2e3)}catch(a){b((null==(r=null==(n=a.response)?void 0:n.data)?void 0:r.message)||"Failed to withdraw payment")}});return Nt.jsxs("div",{className:"min-h-screen flex "+(t?"bg-gray-900":"bg-white"),children:[Nt.jsxs("div",{className:`w-48 ${t?"bg-gray-800":"bg-gray-900"} text-white p-4 overflow-y-auto`,children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsx("button",{onClick:()=>e(`/${r}/chicken-fight-results`),className:"w-full font-bold text-white bg-gray-700 hover:bg-gray-600 p-3 rounded mb-2 text-center transition duration-200 cursor-pointer",title:"Click to edit/delete fight results",children:"RESULT"}),Nt.jsxs("div",{className:"text-center p-3 rounded mb-4 font-bold "+(t?"bg-gray-700 text-yellow-300":"bg-gray-200 text-yellow-700"),children:[Nt.jsx("div",{className:"text-xs opacity-75",children:"FIGHT #"}),Nt.jsx("div",{className:"text-2xl",children:Number.isFinite(s)?s:0})]}),Nt.jsx("div",{className:`text-sm ${t?"text-gray-300":"text-gray-400"} mb-4 space-y-2`,children:(()=>{const e={};a.forEach(t=>{1===t.result&&(e[t.entryName]=(e[t.entryName]||0)+1)}),Object.entries(e).filter(([e,t])=>{const n=a.find(t=>t.entryName===e),r=E.find(t=>t.entryName===e);return"2wins"===(null==n?void 0:n.gameType)&&t>=2&&!1!==(null==r?void 0:r.isValidChampion)}).map(([e])=>e),Object.entries(e).filter(([e,t])=>{const n=a.find(t=>t.entryName===e),r=E.find(t=>t.entryName===e);return"3wins"===(null==n?void 0:n.gameType)&&t>=3&&!1!==(null==r?void 0:r.isValidChampion)}).map(([e])=>e);const t=a.filter(e=>"2wins"===e.gameType&&1===e.result).length,n=a.filter(e=>"3wins"===e.gameType&&1===e.result).length,r=a.filter(e=>"2wins"===e.gameType),i=a.filter(e=>"3wins"===e.gameType);return Nt.jsxs(Nt.Fragment,{children:[Nt.jsxs("div",{className:"bg-red-700 p-3 rounded font-medium",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-2",children:[Nt.jsx("span",{children:"MERON"}),Nt.jsx("span",{children:t})]}),Nt.jsx("div",{className:"flex gap-1 flex-wrap",children:r.map((e,t)=>Nt.jsx("span",{className:"font-bold text-sm",children:e.result},t))})]}),Nt.jsxs("div",{className:"bg-blue-700 p-3 rounded font-medium",children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-2",children:[Nt.jsx("span",{children:"WALA"}),Nt.jsx("span",{children:n})]}),Nt.jsx("div",{className:"flex gap-1 flex-wrap",children:i.map((e,t)=>Nt.jsx("span",{className:"font-bold text-sm",children:e.result},t))})]})]})})()})]}),Nt.jsx("div",{className:"text-xs space-y-1",children:0===a.length?Nt.jsx("div",{className:"p-2 text-center "+(t?"text-gray-500":"text-gray-600"),children:"No fights recorded"}):(()=>{let e={};a.forEach(t=>{const n=_.find(e=>e.entryName===t.entryName);n&&(e[t.entryName]=n.gameType)});const t=[],n=new Set;return a.forEach(r=>{n.has(r.entryName)||(n.add(r.entryName),t.push({name:r.entryName,gameType:e[r.entryName]}))}),t.map(e=>{const t=_.find(t=>t.entryName===e.name),n=E.find(t=>t.entryName===e.name),r=a.filter(t=>t.entryName===e.name),i=r.filter(e=>1===e.result).length,s="2wins"===(null==t?void 0:t.gameType)&&i>=2&&!1!==(null==n?void 0:n.isValidChampion),o="3wins"===(null==t?void 0:t.gameType)&&i>=3&&!1!==(null==n?void 0:n.isValidChampion),l=s||o;return Nt.jsxs("div",{className:"p-2 rounded font-medium flex items-center justify-between gap-2 "+("2wins"===(null==t?void 0:t.gameType)?"bg-red-700":"bg-blue-700"),children:[Nt.jsxs("div",{className:"flex items-center gap-1 truncate flex-1",children:[l&&Nt.jsx("span",{children:""}),Nt.jsx("span",{className:"truncate",children:e.name})]}),Nt.jsx("div",{className:"flex gap-1 items-center flex-shrink-0",children:r.map((e,t)=>Nt.jsx("span",{className:"font-bold text-sm "+(1===e.result?"text-white":.5===e.result?"text-yellow-200":"cancelled"===e.result?"text-gray-400":"text-red-200"),children:.5===e.result?"1/2":"cancelled"===e.result?"X":e.result},t))})]},e.name)})})()})]}),Nt.jsxs("div",{className:"flex-1 p-8 overflow-y-auto "+(t?"bg-gray-900":"bg-white"),children:[Nt.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[Nt.jsxs("h1",{className:"text-4xl font-bold "+(t?"text-white":"text-gray-900"),children:["RMI ",(new Date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}).toUpperCase()]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>me(!pe),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium",children:pe?"Hide History":"View History"}),Nt.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to reset today's records? This action cannot be undone.")&&(i([]),o(0),P([]),J(""),Z(""),te(""),re([]),ie(""),oe(""),de(""),he([]),localStorage.removeItem(`chicken-fight-${l}`),localStorage.removeItem(`chicken-fight-number-${l}`),N("Today's records have been reset"),setTimeout(()=>N(""),2e3))},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium",children:"Reset Today"})]})]}),v&&Nt.jsxs("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded flex items-center gap-3",children:[Nt.jsx(M,{size:20}),Nt.jsx("span",{className:"flex-1",children:v}),Nt.jsx("button",{onClick:()=>b(""),children:Nt.jsx(ce,{size:18})})]}),w&&Nt.jsxs("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded flex items-center gap-3",children:[Nt.jsx(O,{size:20}),Nt.jsx("span",{children:w})]}),pe&&Nt.jsxs("div",{className:"mb-6 rounded-xl border shadow-lg "+(t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[Nt.jsxs("div",{className:"flex justify-between items-center p-6 border-b "+(t?"border-gray-700":"border-gray-200"),children:[Nt.jsxs("div",{children:[Nt.jsx("h2",{className:"text-2xl font-bold "+(t?"text-white":"text-gray-900"),children:" Fight History"}),Nt.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"} mt-1`,children:"Review past records and fights"})]}),Nt.jsx("button",{onClick:()=>me(!1),className:"p-2 rounded-lg transition "+(t?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:Nt.jsx(ce,{size:24})})]}),Nt.jsx("div",{className:"p-6",children:0===ge.length?Nt.jsx("div",{className:"text-center py-12 "+(t?"text-gray-400":"text-gray-600"),children:Nt.jsx("p",{className:"text-lg",children:"No history records found"})}):Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Nt.jsxs("div",{className:`lg:col-span-1 ${t?"bg-gray-700/50":"bg-gray-50"} rounded-lg p-4 max-h-96 overflow-y-auto`,children:[Nt.jsx("h3",{className:"font-bold mb-3 text-sm "+(t?"text-gray-300":"text-gray-700"),children:"AVAILABLE DATES"}),Nt.jsx("div",{className:"space-y-2",children:ge.map(e=>Nt.jsx("button",{onClick:()=>(e=>{const t=localStorage.getItem(`chicken-fight-${e}`);t&&(be(JSON.parse(t)),ye(e))})(e),className:"w-full text-left px-4 py-3 rounded-lg transition font-medium text-sm "+(xe===e?t?"bg-blue-600 text-white shadow-lg":"bg-blue-500 text-white shadow-lg":t?"bg-gray-600 hover:bg-gray-500 text-gray-100":"bg-white hover:bg-gray-100 text-gray-900 border border-gray-200"),children:new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})},e))})]}),Nt.jsx("div",{className:"lg:col-span-2",children:Nt.jsxs("div",{className:"rounded-lg p-4 "+(t?"bg-gray-700/50":"bg-gray-50"),children:[Nt.jsx("h3",{className:"font-bold mb-4 text-sm "+(t?"text-gray-300":"text-gray-700"),children:xe?`FIGHTS - ${new Date(xe).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})}`:"SELECT A DATE TO VIEW FIGHTS"}),Nt.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:xe&&ve.length>0?Nt.jsx("div",{className:"space-y-2",children:(()=>{const e={};return ve.forEach(t=>{e[t.entryName]||(e[t.entryName]=[]),e[t.entryName].push(t)}),Object.entries(e).map(([e,n])=>{const r=_.find(t=>t.entryName===e),a=n.filter(e=>1===e.result).length,i=n.filter(e=>0===e.result).length;return Nt.jsxs("div",{className:"p-4 rounded-lg border-l-4 "+("2wins"===(null==r?void 0:r.gameType)?t?"bg-red-900/30 border-red-600 text-red-200":"bg-red-50 border-red-400 text-red-900":t?"bg-blue-900/30 border-blue-600 text-blue-200":"bg-blue-50 border-blue-400 text-blue-900"),children:[Nt.jsxs("div",{className:"flex justify-between items-start gap-3 mb-3",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Nt.jsx("span",{className:"font-bold text-sm "+(t?"text-white":""),children:e}),r&&Nt.jsx("span",{className:"px-2 py-0.5 text-xs font-bold rounded "+("2wins"===r.gameType?t?"bg-red-900/50 text-red-200":"bg-red-200 text-red-800":t?"bg-blue-900/50 text-blue-200":"bg-blue-200 text-blue-800"),children:"2wins"===r.gameType?"2-WINS":"3-WINS"})]}),Nt.jsxs("div",{className:"text-xs",children:["Record: ",Nt.jsxs("span",{className:"font-bold",children:[a,"W - ",i,"L"]})]})]}),Nt.jsx("div",{className:"flex gap-1",children:n.map((e,n)=>Nt.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold "+(1===e.result?t?"bg-green-600 text-white":"bg-green-500 text-white":t?"bg-red-600 text-white":"bg-red-500 text-white"),children:1===e.result?"W":"L"},n))})]}),Nt.jsx("div",{className:"text-xs space-y-1",children:n.map((e,t)=>Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("span",{children:["Fight ",t+1,":"]}),Nt.jsx("span",{className:"font-mono",children:e.legBand})]},t))})]},e)})})()}):xe?Nt.jsx("p",{className:"text-center py-8 text-gray-500",children:"No fights recorded on this date"}):Nt.jsx("p",{className:"text-center py-8 text-gray-500",children:"Select a date to view fight records"})})]})})]})})]}),Nt.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[Nt.jsxs("div",{className:"bg-red-700 text-white rounded-lg p-8",children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-4",children:"MERON"}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Search Leg Band"}),Nt.jsx("input",{type:"text",value:ee,onChange:e=>(e=>{if(te(e),!e.trim())return J(""),Z(""),void re([]);const t=e.trim();if("000"===t)return J("unknown"),Z("unknown"),void re([]);const n=Me.filter(e=>{var n;return(null==(n=e.legBandNumbers)?void 0:n.includes(t))&&!Ae.has(t)});1===n.length?(J(n[0]._id),Z(t),re([])):n.length>1?(re(n),J(""),Z(t)):(J(""),Z(""),re([]))})(e.target.value),placeholder:"Enter leg band number or '000' for unknown...",className:"w-full px-4 py-2 rounded-lg bg-red-600 text-white border border-red-500 placeholder-red-300"}),ne.length>1&&Nt.jsxs("div",{className:"mt-2",children:[Nt.jsx("label",{className:"block text-xs font-medium mb-1",children:"Multiple entries found - select one:"}),Nt.jsxs("select",{value:q,onChange:e=>{J(e.target.value),re([])},className:"w-full px-3 py-1 rounded bg-red-600 text-white border border-red-500 text-sm",children:[Nt.jsx("option",{value:"",children:"Choose entry..."}),ne.map(e=>Nt.jsxs("option",{value:e._id,children:[e.entryName," (",e.gameType,")"]},e._id))]})]}),ee&&q&&ne.length<=1&&Nt.jsxs("div",{className:"mt-2 p-2 bg-red-600 rounded text-sm",children:[Nt.jsx("div",{className:"font-medium",children:null==Ne?void 0:Ne.entryName}),Nt.jsxs("div",{className:"text-xs",children:["Leg Band: ","000"===ee?"Unknown (000)":Q]})]})]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Or Select Entry"}),Nt.jsxs("select",{value:q,onChange:e=>{if(J(e.target.value),Z(""),te(""),re([]),e.target.value){const t=_.find(t=>t._id===e.target.value);if(t&&t.legBandNumbers&&t.legBandNumbers.length>0){const e=t.legBandNumbers.filter(e=>!Ae.has(e));e.length>0&&Z(e[0])}}},className:"w-full px-4 py-2 rounded-lg bg-red-600 text-white border border-red-500",children:[Nt.jsx("option",{value:"",children:"Choose an entry..."}),Me.map(e=>Nt.jsxs("option",{value:e._id,children:[e.entryName," (",e.legBandNumbers&&e.legBandNumbers.length>0?`${e.legBandNumbers.length} leg band(s)`:"Unknown",")"]},e._id))]})]}),q&&Ne&&Nt.jsxs("div",{className:"mb-4 p-3 bg-red-600 rounded text-sm",children:[Nt.jsx("div",{className:"font-medium mb-2",children:"Entry Score"}),Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsx("div",{className:"text-sm font-bold",children:Ne.entryName}),Nt.jsxs("div",{className:"text-xs text-red-100",children:["Type: ",Ne.gameType]}),Nt.jsxs("div",{className:"border-t border-red-500 pt-2 mt-2",children:[Nt.jsxs("div",{className:"flex justify-between mb-1",children:[Nt.jsx("span",{className:"text-xs",children:"Total Fights:"}),Nt.jsx("span",{className:"text-sm font-bold",children:a.filter(e=>e.entryName===Ne.entryName).length})]}),Nt.jsxs("div",{className:"flex justify-between mb-2",children:[Nt.jsx("span",{className:"text-xs",children:"Wins:"}),Nt.jsx("span",{className:"text-lg font-bold text-yellow-300",children:a.filter(e=>e.entryName===Ne.entryName&&1===e.result).length})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-xs text-red-200 mb-1",children:"Sequence:"}),Nt.jsx("div",{className:"text-2xl font-bold tracking-wider",children:a.filter(e=>e.entryName===Ne.entryName).map(e=>1===e.result?"1":.5===e.result?"":"0").join("")||"-"})]})]})]})]}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){const e=q&&Q,t=ae&&se;if(!q||!ae||!e&&!t)return void b("Please select both Meron and Wala entries, with at least one having a leg band");if(e&&Ae.has(Q))return void b(`Leg band ${Q} (Meron) has already fought`);if(t&&Ae.has(se))return void b(`Leg band ${se} (Wala) has already fought`);const n={id:s+1,entryName:Ne.entryName,legBand:e?Q:"unknown",legBandFought:e?Q:"unknown",result:1},r={id:s+1,entryName:je.entryName,legBand:t?se:"unknown",legBandFought:t?se:"unknown",result:0},l=[];"unknown"!==Ne._id&&l.push({entryId:Ne._id,entryName:Ne.entryName,gameType:Ne.gameType,legResults:[{legNumber:s+1,result:"win"}]}),"unknown"!==je._id&&l.push({entryId:je._id,entryName:je.entryName,gameType:je.gameType,legResults:[{legNumber:s+1,result:"loss"}]});const c=[...a,n,r];i(c),o(s+1);let d=!0;if(l.length>0&&(d=yield u(l)),!d)return b("Failed to record results to server. Please try again."),void setTimeout(()=>b(""),3e3);N(`Meron (${Ne.entryName}) defeats Wala (${je.entryName})`),J(""),Z(""),te(""),re([]),ie(""),oe(""),de(""),he([]),setTimeout(()=>N(""),2e3),yield Pe()}),disabled:!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se),className:"w-full py-3 font-bold rounded-lg text-lg transition "+(!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se)?"bg-red-900 text-gray-400 cursor-not-allowed opacity-50":"bg-red-500 hover:bg-red-600 text-white cursor-pointer"),children:"MERON WINS"})]}),Nt.jsxs("div",{className:"bg-gray-800 text-white rounded-lg p-8 flex flex-col items-center justify-center",children:[Nt.jsx("div",{className:"text-7xl font-bold mb-4",children:Number.isFinite(s)?s:0}),Nt.jsx("div",{className:"text-lg font-bold mb-6",children:"FIGHT"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(q&&Q&&ae&&se){if(Ae.has(Q))return void b(`Leg band ${Q} (Meron) has already fought`);if(Ae.has(se))return void b(`Leg band ${se} (Wala) has already fought`);const e=[];"unknown"!==Ne._id&&e.push({entryId:Ne._id,entryName:Ne.entryName,gameType:Ne.gameType,legResults:[{legNumber:s+1,result:"draw"}]}),"unknown"!==je._id&&e.push({entryId:je._id,entryName:je.entryName,gameType:je.gameType,legResults:[{legNumber:s+1,result:"draw"}]});const t={id:s+1,entryName:Ne.entryName,legBand:Q||"unknown",legBandFought:Q||"unknown",result:.5},n={id:s+1,entryName:je.entryName,legBand:se||"unknown",legBandFought:se||"unknown",result:.5},r=[...a,t,n];i(r);let l=!0;if(e.length>0&&(l=yield u(e)),!l)return b("Failed to record draw. Please try again."),void setTimeout(()=>b(""),3e3);o(s+1),J(""),Z(""),te(""),ie(""),oe(""),de(""),N("Draw recorded! Moving to next fight."),setTimeout(()=>N(""),3e3),yield Pe()}}),disabled:!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se),className:"w-full py-3 font-bold rounded-lg text-lg transition "+(!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se)?"bg-green-900 text-gray-400 cursor-not-allowed opacity-50":"bg-green-500 hover:bg-green-600 text-white cursor-pointer"),children:"DRAW"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(q&&ae){if(Ae.has(Q))return void b(`Leg band ${Q} (Meron) has already fought`);if(Ae.has(se))return void b(`Leg band ${se} (Wala) has already fought`);const e=[];e.push({entryId:(null==Ne?void 0:Ne._id)||`unknown-meron-${Date.now()}`,entryName:(null==Ne?void 0:Ne.entryName)||"Unknown Entry (Meron)",gameType:(null==Ne?void 0:Ne.gameType)||"unknown",legResults:[{legNumber:s+1,result:"cancelled"}]}),e.push({entryId:(null==je?void 0:je._id)||`unknown-wala-${Date.now()}`,entryName:(null==je?void 0:je.entryName)||"Unknown Entry (Wala)",gameType:(null==je?void 0:je.gameType)||"unknown",legResults:[{legNumber:s+1,result:"cancelled"}]});const t={id:s+1,entryName:(null==Ne?void 0:Ne.entryName)||"Unknown Entry (Meron)",gameType:(null==Ne?void 0:Ne.gameType)||"unknown",legBand:Q||"unknown",legBandFought:Q||"unknown",result:"cancelled"},n={id:s+1,entryName:(null==je?void 0:je.entryName)||"Unknown Entry (Wala)",gameType:(null==je?void 0:je.gameType)||"unknown",legBand:se||"unknown",legBandFought:se||"unknown",result:"cancelled"},r=[...a,t,n];i(r);if(!(yield u(e)))return b("Failed to record cancellation. Please try again."),void setTimeout(()=>b(""),3e3);o(s+1),J(""),Z(""),te(""),re([]),ie(""),oe(""),de(""),he([]),N("Fight cancelled! Entries can be reused."),setTimeout(()=>N(""),3e3),yield Pe()}}),disabled:!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se),className:"w-full py-3 font-bold rounded-lg text-lg transition mt-2 "+(!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se)?"bg-red-900 text-gray-400 cursor-not-allowed opacity-50":"bg-red-600 hover:bg-red-700 text-white cursor-pointer"),children:"CANCEL FIGHT"})]}),Nt.jsxs("div",{className:"bg-blue-700 text-white rounded-lg p-8",children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-4",children:"WALA"}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Search Leg Band"}),Nt.jsx("input",{type:"text",value:le,onChange:e=>(e=>{if(de(e),!e.trim())return ie(""),oe(""),void he([]);const t=e.trim();if("000"===t)return ie("unknown"),oe("unknown"),void he([]);const n=ke.filter(e=>{var n;return(null==(n=e.legBandNumbers)?void 0:n.includes(t))&&!Ae.has(t)});1===n.length?(ie(n[0]._id),oe(t),he([])):n.length>1?(he(n),ie(""),oe(t)):(ie(""),oe(""),he([]))})(e.target.value),placeholder:"Enter leg band number or '000' for unknown...",className:"w-full px-4 py-2 rounded-lg bg-blue-600 text-white border border-blue-500 placeholder-blue-300"}),ue.length>1&&Nt.jsxs("div",{className:"mt-2",children:[Nt.jsx("label",{className:"block text-xs font-medium mb-1",children:"Multiple entries found - select one:"}),Nt.jsxs("select",{value:ae,onChange:e=>{ie(e.target.value),he([])},className:"w-full px-3 py-1 rounded bg-blue-600 text-white border border-blue-500 text-sm",children:[Nt.jsx("option",{value:"",children:"Choose entry..."}),ue.map(e=>Nt.jsxs("option",{value:e._id,children:[e.entryName," (",e.gameType,")"]},e._id))]})]}),le&&ae&&ue.length<=1&&Nt.jsxs("div",{className:"mt-2 p-2 bg-blue-600 rounded text-sm",children:[Nt.jsx("div",{className:"font-medium",children:null==je?void 0:je.entryName}),Nt.jsxs("div",{className:"text-xs",children:["Leg Band: ","000"===le?"Unknown (000)":se]})]})]}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2",children:"Or Select Entry"}),Nt.jsxs("select",{value:ae,onChange:e=>{if(ie(e.target.value),oe(""),de(""),he([]),e.target.value){const t=_.find(t=>t._id===e.target.value);if(t&&t.legBandNumbers&&t.legBandNumbers.length>0){const e=t.legBandNumbers.filter(e=>!Ae.has(e));e.length>0&&oe(e[0])}}},className:"w-full px-4 py-2 rounded-lg bg-blue-600 text-white border border-blue-500",children:[Nt.jsx("option",{value:"",children:"Choose an entry..."}),ke.map(e=>Nt.jsxs("option",{value:e._id,children:[e.entryName," (",e.legBandNumbers&&e.legBandNumbers.length>0?`${e.legBandNumbers.length} leg band(s)`:"Unknown",")"]},e._id))]})]}),ae&&je&&Nt.jsxs("div",{className:"mb-4 p-3 bg-blue-600 rounded text-sm",children:[Nt.jsx("div",{className:"font-medium mb-2",children:"Entry Score"}),Nt.jsxs("div",{className:"space-y-2",children:[Nt.jsx("div",{className:"text-sm font-bold",children:je.entryName}),Nt.jsxs("div",{className:"text-xs text-blue-100",children:["Type: ",je.gameType]}),Nt.jsxs("div",{className:"border-t border-blue-500 pt-2 mt-2",children:[Nt.jsxs("div",{className:"flex justify-between mb-1",children:[Nt.jsx("span",{className:"text-xs",children:"Total Fights:"}),Nt.jsx("span",{className:"text-sm font-bold",children:a.filter(e=>e.entryName===je.entryName).length})]}),Nt.jsxs("div",{className:"flex justify-between mb-2",children:[Nt.jsx("span",{className:"text-xs",children:"Wins:"}),Nt.jsx("span",{className:"text-lg font-bold text-yellow-300",children:a.filter(e=>e.entryName===je.entryName&&1===e.result).length})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-xs text-blue-200 mb-1",children:"Sequence:"}),Nt.jsx("div",{className:"text-2xl font-bold tracking-wider",children:a.filter(e=>e.entryName===je.entryName).map(e=>1===e.result?"1":.5===e.result?"":"0").join("")||"-"})]})]})]})]}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){const e=q&&Q,t=ae&&se;if(!q||!ae||!e&&!t)return void b("Please select both Meron and Wala entries, with at least one having a leg band");if(e&&Ae.has(Q))return void b(`Leg band ${Q} (Meron) has already fought`);if(t&&Ae.has(se))return void b(`Leg band ${se} (Wala) has already fought`);const n={id:s+1,entryName:Ne.entryName,legBand:e?Q:"unknown",legBandFought:e?Q:"unknown",result:0},r={id:s+1,entryName:je.entryName,legBand:t?se:"unknown",legBandFought:t?se:"unknown",result:1},l=[];"unknown"!==Ne._id&&l.push({entryId:Ne._id,entryName:Ne.entryName,gameType:Ne.gameType,legResults:[{legNumber:s+1,result:"loss"}]}),"unknown"!==je._id&&l.push({entryId:je._id,entryName:je.entryName,gameType:je.gameType,legResults:[{legNumber:s+1,result:"win"}]});const c=[...a,n,r];i(c),o(s+1);let d=!0;if(l.length>0&&(d=yield u(l)),!d)return b("Failed to record results to server. Please try again."),void setTimeout(()=>b(""),3e3);N(`Wala (${je.entryName}) defeats Meron (${Ne.entryName})`),J(""),Z(""),te(""),re([]),ie(""),oe(""),de(""),he([]),setTimeout(()=>N(""),2e3),yield Pe()}),disabled:!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se),className:"w-full py-3 font-bold rounded-lg text-lg transition "+(!q||!ae||Q&&Ae.has(Q)||se&&Ae.has(se)?"bg-blue-900 text-gray-400 cursor-not-allowed opacity-50":"bg-blue-500 hover:bg-blue-600 text-white cursor-pointer"),children:"WALA WINS"})]})]}),Ee&&Nt.jsxs("div",{className:"mb-8",children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-4 "+(t?"text-white":"text-gray-900"),children:" Statistics"}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-4",children:[Nt.jsxs("div",{className:`p-4 rounded-lg border ${t?"bg-gradient-to-br from-gray-800 to-gray-900 border-gray-700":"bg-gradient-to-br from-white to-gray-50 border-gray-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-gray-400":"text-gray-600"),children:"TOTAL REGISTERED"}),Nt.jsx("div",{className:"text-4xl font-bold mt-2 "+(t?"text-blue-400":"text-blue-600"),children:_.length})]}),Nt.jsxs("div",{className:`p-4 rounded-lg border ${t?"bg-gradient-to-br from-red-900/30 to-red-900/20 border-red-700":"bg-gradient-to-br from-red-50 to-red-100 border-red-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-red-300":"text-red-700"),children:"2-WINS REGISTERED"}),Nt.jsx("div",{className:"text-3xl font-bold mt-2 "+(t?"text-red-400":"text-red-600"),children:(()=>{const e=_.filter(e=>"2wins"===e.gameType).length,t=E.filter(e=>{const t=_.find(t=>t.entryName===e.entryName);return"2wins"===(null==t?void 0:t.gameType)&&e.registrations.find(e=>"2wins"===e.gameType&&e.isPaid)}).length;return`${t}/${e}`})()}),Nt.jsxs("div",{className:"text-xs mt-1 font-mono "+(t?"text-red-300":"text-red-600"),children:["",(()=>{const e=E.reduce((e,t)=>{const n=_.find(e=>e.entryName===t.entryName),r=t.registrations.find(e=>"2wins"===e.gameType&&e.isPaid),a=null==r?void 0:r.registrationFee;return console.log(`Registration fee for ${t.entryName}:`,a,typeof a),"2wins"===(null==n?void 0:n.gameType)&&r?e+(Number(a)||300):e},0);return console.log("Total 2-wins revenue:",e),e})()]})]}),Nt.jsxs("div",{className:`p-4 rounded-lg border ${t?"bg-gradient-to-br from-blue-900/30 to-blue-900/20 border-blue-700":"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-blue-300":"text-blue-700"),children:"3-WINS REGISTERED"}),Nt.jsx("div",{className:"text-3xl font-bold mt-2 "+(t?"text-blue-400":"text-blue-600"),children:(()=>{const e=_.filter(e=>"3wins"===e.gameType).length,t=E.filter(e=>{const t=_.find(t=>t.entryName===e.entryName);return"3wins"===(null==t?void 0:t.gameType)&&e.registrations.find(e=>"3wins"===e.gameType&&e.isPaid)}).length;return`${t}/${e}`})()}),Nt.jsxs("div",{className:"text-xs mt-1 font-mono "+(t?"text-blue-300":"text-blue-600"),children:["",(()=>{const e=E.filter(e=>{const t=_.find(t=>t.entryName===e.entryName);return"3wins"===(null==t?void 0:t.gameType)&&e.registrations.find(e=>"3wins"===e.gameType&&e.isPaid)}).length;return 1e3*e})()]})]}),Nt.jsxs("div",{className:`p-4 rounded-lg border ${t?"bg-gradient-to-br from-orange-900/30 to-orange-900/20 border-orange-700":"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-orange-300":"text-orange-700"),children:"CHAMPION 2-WINS"}),Nt.jsxs("div",{className:"text-3xl font-bold mt-2 "+(t?"text-orange-400":"text-orange-600"),children:["",(()=>{const e=Object.entries(a.reduce((e,t)=>{const n=_.find(e=>e.entryName===t.entryName),r=E.find(e=>e.entryName===t.entryName);return"2wins"===(null==n?void 0:n.gameType)&&1===t.result&&!1!==(null==r?void 0:r.isValidChampion)&&(e[t.entryName]=(e[t.entryName]||0)+1),e},{})).filter(([e,t])=>t>=2).length;return 5e3*e})()]})]}),Nt.jsxs("div",{className:`p-4 rounded-lg border ${t?"bg-gradient-to-br from-cyan-900/30 to-cyan-900/20 border-cyan-700":"bg-gradient-to-br from-cyan-50 to-cyan-100 border-cyan-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-cyan-300":"text-cyan-700"),children:"CHAMPION 3-WINS"}),Nt.jsxs("div",{className:"text-3xl font-bold mt-2 "+(t?"text-cyan-400":"text-cyan-600"),children:["",(()=>{const e=Object.entries(a.reduce((e,t)=>{const n=_.find(e=>e.entryName===t.entryName),r=E.find(e=>e.entryName===t.entryName);return"3wins"===(null==n?void 0:n.gameType)&&1===t.result&&!1!==(null==r?void 0:r.isValidChampion)&&(e[t.entryName]=(e[t.entryName]||0)+1),e},{})).filter(([e,t])=>t>=3).length;return 2e4*e})()]})]}),Nt.jsxs("div",{className:`p-4 rounded-lg border ${t?"bg-gradient-to-br from-purple-900/30 to-purple-900/20 border-purple-700":"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-purple-300":"text-purple-700"),children:"INSURANCE"}),Nt.jsxs("div",{className:"text-3xl font-bold mt-2 "+(t?"text-purple-400":"text-purple-600"),children:["",(()=>{const e=E.filter(e=>e.insurancePaid).length;return 5e3*e})()]}),Nt.jsxs("div",{className:"text-xs mt-1 "+(t?"text-purple-300":"text-purple-600"),children:[E.filter(e=>e.insurancePaid).length," entries"]})]}),Nt.jsxs("div",{className:`p-4 rounded-lg border md:col-span-2 lg:col-span-1 ${t?"bg-gradient-to-br from-green-900/30 to-green-900/20 border-green-700":"bg-gradient-to-br from-green-50 to-green-100 border-green-200"} shadow-md hover:shadow-lg transition`,children:[Nt.jsx("div",{className:"text-xs font-bold "+(t?"text-green-300":"text-green-700"),children:"NET REVENUE"}),Nt.jsxs("div",{className:"text-3xl font-bold mt-2 "+(t?"text-green-400":"text-green-600"),children:["",(()=>{const e=Ee.totalRevenue||0,t=Object.entries(a.reduce((e,t)=>{const n=_.find(e=>e.entryName===t.entryName),r=E.find(e=>e.entryName===t.entryName);return"2wins"===(null==n?void 0:n.gameType)&&1===t.result&&!1!==(null==r?void 0:r.isValidChampion)&&(e[t.entryName]=(e[t.entryName]||0)+1),e},{})).filter(([e,t])=>t>=2).length,n=5e3*t,r=Object.entries(a.reduce((e,t)=>{const n=_.find(e=>e.entryName===t.entryName),r=E.find(e=>e.entryName===t.entryName);return"3wins"===(null==n?void 0:n.gameType)&&1===t.result&&!1!==(null==r?void 0:r.isValidChampion)&&(e[t.entryName]=(e[t.entryName]||0)+1),e},{})).filter(([e,t])=>t>=3).length,i=2e4*r,s=E.filter(e=>e.insurancePaid).length,o=e-n-i-5e3*s;return Math.max(0,o)})()]}),Nt.jsx("div",{className:"text-xs mt-1 font-mono "+(t?"text-gray-400":"text-gray-600"),children:"Gross - Payouts"})]})]})]}),I&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"rounded-lg p-6 w-full max-w-md "+(t?"bg-gray-800":"bg-white"),children:[Nt.jsx("h3",{className:"text-lg font-bold mb-4 "+(t?"text-white":"text-gray-900"),children:"Register Entry"}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(t?"text-gray-300":"text-gray-700"),children:"Select Entry"}),Nt.jsxs("select",{value:L,onChange:e=>F(e.target.value),className:"w-full px-4 py-2 rounded-lg border "+(t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"",children:"Choose an entry..."}),_.map(e=>Nt.jsxs("option",{value:e._id,children:[e.entryName," (",e.gameType.toUpperCase(),")"]},e._id))]})]}),Nt.jsxs("div",{className:"mb-6 space-y-3",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",id:"2wins",checked:U,onChange:e=>z(e.target.checked),className:"w-4 h-4"}),Nt.jsx("label",{htmlFor:"2wins",className:"font-medium "+(t?"text-gray-300":"text-gray-700"),children:"2-Wins"}),U&&Nt.jsxs("div",{className:"ml-auto flex gap-2",children:[Nt.jsx("button",{onClick:()=>G(300),className:"px-3 py-1 text-sm rounded "+(300===H?t?"bg-red-600 text-white":"bg-red-500 text-white":t?"bg-gray-600 text-gray-300":"bg-gray-200"),children:"300"}),Nt.jsx("button",{onClick:()=>G(500),className:"px-3 py-1 text-sm rounded "+(500===H?t?"bg-red-600 text-white":"bg-red-500 text-white":t?"bg-gray-600 text-gray-300":"bg-gray-200"),children:"500"})]})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",id:"3wins",checked:W,onChange:e=>Y(e.target.checked),className:"w-4 h-4"}),Nt.jsx("label",{htmlFor:"3wins",className:"font-medium "+(t?"text-gray-300":"text-gray-700"),children:"3-Wins (1,000)"})]})]}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("button",{onClick:()=>{B(!1),F(""),z(!1),G(500),Y(!1)},className:"flex-1 px-4 py-2 rounded-lg font-medium "+(t?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Cancel"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t,n,r,a;if(!L||!U&&!W)return void b("Please select an entry and at least one game type");const i=_.find(e=>e._id===L)||("unknown"===L?{_id:"unknown",entryName:"Unknown",gameType:U?"2wins":"3wins"}:null);if(!i)return void b("Selected entry not found");const s=[],o=[];U&&(s.push("2wins"),o.push({gameType:"2wins",registrationFee:V}),console.log("Adding 2wins registration with fee:",V)),W&&(s.push("3wins"),o.push({gameType:"3wins",registrationFee:1e3})),K(!0);try{console.log("Sending registration request:",{entryId:L,entryName:i.entryName,gameTypes:s,registrations:o,gameDate:l}),yield pt.post(`${zc()}/api/chicken-fight-registration/registrations`,{entryId:L,entryName:i.entryName,gameTypes:s,registrations:o,gameDate:l}),N(`Entry "${i.entryName}" registered successfully!`),F(""),z(!1),G(500),Y(!1),B(!1),Re(),Ie(),setTimeout(()=>N(""),3e3)}catch(c){console.error("Registration error:",null==(e=c.response)?void 0:e.data,null==(t=c.response)?void 0:t.status,c.message),b((null==(r=null==(n=c.response)?void 0:n.data)?void 0:r.message)||`Failed to register entry (${null==(a=c.response)?void 0:a.status})`)}finally{K(!1)}}),disabled:X||!L||!U&&!W,className:"flex-1 px-4 py-2 rounded-lg font-medium text-white "+(X||!L||!U&&!W?t?"bg-blue-900 cursor-not-allowed":"bg-blue-300 cursor-not-allowed":t?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"),children:X?"Registering...":"Register"})]})]})}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:`rounded-lg p-4 mb-4 ${t?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"} border`,children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"text-sm font-bold mb-1 "+(t?"text-gray-300":"text-gray-700"),children:"2-Wins Registration Fee (Global Default)"}),Nt.jsx("p",{className:"text-xs text-gray-500",children:"Choose the default fee for all 2-Wins registrations"})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>$(300),className:"px-4 py-2 rounded-lg font-bold transition "+(300===V?t?"bg-red-600 text-white":"bg-red-500 text-white":t?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-100"),children:"300"}),Nt.jsx("button",{onClick:()=>$(500),className:"px-4 py-2 rounded-lg font-bold transition "+(500===V?t?"bg-red-600 text-white":"bg-red-500 text-white":t?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-100"),children:"500"})]})]})}),Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsx("h2",{className:"text-2xl font-bold "+(t?"text-white":"text-gray-900"),children:"Registrations"}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(window.confirm("Mark ALL unpaid registrations as paid?")){K(!0);try{const t=E.filter(e=>e.registrations.some(e=>!e.isPaid));let n=0;for(const r of t)for(const t of r.registrations)if(!t.isPaid)try{yield pt.put(`${zc()}/api/chicken-fight-registration/registrations/${r._id}/pay`,{gameType:t.gameType}),n++}catch(e){console.error(`Failed to mark ${r.entryName} - ${t.gameType} as paid`)}N(`Marked ${n} payments as paid!`),Re(),Ie(),setTimeout(()=>N(""),3e3)}catch(e){b("Failed to mark all payments")}finally{K(!1)}}}),disabled:X||0===E.length||!E.some(e=>e.registrations.some(e=>!e.isPaid)),className:"px-4 py-2 rounded-lg font-medium text-white transition "+(X||0===E.length||!E.some(e=>e.registrations.some(e=>!e.isPaid))?t?"bg-green-900 cursor-not-allowed opacity-50":"bg-green-300 cursor-not-allowed opacity-50":t?"bg-green-600 hover:bg-green-700":"bg-green-500 hover:bg-green-600"),children:X?"Processing...":"Mark All Paid"}),Nt.jsx("button",{onClick:()=>h(null,null,function*(){if(window.confirm("Withdraw ALL paid registrations?")){K(!0);try{const t=E.filter(e=>e.registrations.some(e=>e.isPaid));let n=0;for(const r of t)for(const t of r.registrations)if(t.isPaid)try{yield pt.put(`${zc()}/api/chicken-fight-registration/registrations/${r._id}/withdraw`,{gameType:t.gameType}),n++}catch(e){console.error(`Failed to withdraw ${r.entryName} - ${t.gameType} payment`)}N(`Withdrew ${n} payments!`),Re(),Ie(),setTimeout(()=>N(""),3e3)}catch(e){b("Failed to withdraw all payments")}finally{K(!1)}}}),disabled:X||0===E.length||!E.some(e=>e.registrations.some(e=>e.isPaid)),className:"px-4 py-2 rounded-lg font-medium text-white transition "+(X||0===E.length||!E.some(e=>e.registrations.some(e=>e.isPaid))?t?"bg-red-900 cursor-not-allowed opacity-50":"bg-red-300 cursor-not-allowed opacity-50":t?"bg-red-600 hover:bg-red-700":"bg-red-500 hover:bg-red-600"),children:X?"Processing...":"Withdraw All"}),Nt.jsx("button",{onClick:()=>B(!0),className:"px-4 py-2 rounded-lg font-medium text-white transition "+(t?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"),children:"+ Register Entry"})]})]}),D?Nt.jsx("div",{className:"flex justify-center py-12",children:Nt.jsx(T,{className:"animate-spin text-blue-600",size:32})}):0===E.length?Nt.jsx("div",{className:"p-8 text-center rounded-lg "+(t?"bg-gray-800":"bg-gray-100"),children:Nt.jsx("p",{className:t?"text-gray-400":"text-gray-600",children:"No registrations yet"})}):Nt.jsx("div",{className:`rounded-lg overflow-hidden shadow ${t?"bg-gray-800":"bg-white"} border ${t?"border-gray-700":"border-gray-200"}`,children:Nt.jsxs("table",{className:"w-full",children:[Nt.jsx("thead",{children:Nt.jsxs("tr",{className:t?"bg-gray-700":"bg-gray-100",children:[Nt.jsx("th",{className:"px-6 py-3 text-left font-semibold "+(t?"text-gray-300":"text-gray-900"),children:"Entry Name"}),Nt.jsxs("th",{className:"px-6 py-3 text-center font-semibold "+(t?"text-gray-300":"text-gray-900"),children:["2-Wins (",V,")"]}),Nt.jsx("th",{className:"px-6 py-3 text-center font-semibold "+(t?"text-gray-300":"text-gray-900"),children:"3-Wins (1,000)"}),Nt.jsx("th",{className:"px-6 py-3 text-center font-semibold "+(t?"text-gray-300":"text-gray-900"),children:"Insurance"}),Nt.jsx("th",{className:"px-6 py-3 text-left font-semibold "+(t?"text-gray-300":"text-gray-900"),children:"Actions"})]})}),Nt.jsx("tbody",{children:(()=>{const e=new Map;E.forEach(t=>{const n=t.entryName,r=e.get(n);if(r){const a=new Date(r.updatedAt||r.createdAt||0).getTime();new Date(t.updatedAt||t.createdAt||0).getTime()>a&&e.set(n,t)}else e.set(n,t)});const n=new Set(_.map(e=>e.entryName));return Array.from(e.values()).filter(e=>n.has(e.entryName)).map(e=>{const n=e.registrations.find(e=>"2wins"===e.gameType),r=e.registrations.find(e=>"3wins"===e.gameType),a=_.find(t=>t.entryName===e.entryName);return Nt.jsxs("tr",{className:"border-t "+(t?"border-gray-700":"border-gray-200"),children:[Nt.jsx("td",{className:"px-6 py-4 font-medium "+(t?"text-white":"text-gray-900"),children:Nt.jsxs("div",{className:"flex items-center gap-2",children:[Nt.jsx("span",{children:e.entryName}),a&&Nt.jsx("span",{className:"px-2 py-1 text-xs font-bold rounded "+("2wins"===a.gameType?t?"bg-red-900/50 text-red-300":"bg-red-100 text-red-700":t?"bg-blue-900/50 text-blue-300":"bg-blue-100 text-blue-700"),children:"2wins"===a.gameType?"2-WINS":"3-WINS"})]})}),Nt.jsx("td",{className:"px-6 py-4 text-center",children:n&&"2wins"===(null==a?void 0:a.gameType)?n.isPaid?Nt.jsx("button",{onClick:()=>Le(e._id,"2wins"),className:"px-3 py-1 text-xs rounded font-medium "+(t?"bg-yellow-900 text-yellow-200 hover:bg-yellow-800":"bg-yellow-100 text-yellow-700"),children:"Withdraw"}):Nt.jsx("button",{onClick:()=>Oe(e._id,"2wins"),className:"px-3 py-1 text-xs rounded font-medium "+(t?"bg-green-900 text-green-200 hover:bg-green-800":"bg-green-100 text-green-700"),children:"Mark Paid"}):Nt.jsx("span",{className:t?"text-gray-500":"text-gray-400",children:"-"})}),Nt.jsx("td",{className:"px-6 py-4 text-center",children:r&&"3wins"===(null==a?void 0:a.gameType)?r.isPaid?Nt.jsx("button",{onClick:()=>Le(e._id,"3wins"),className:"px-3 py-1 text-xs rounded font-medium "+(t?"bg-yellow-900 text-yellow-200 hover:bg-yellow-800":"bg-yellow-100 text-yellow-700"),children:"Withdraw"}):Nt.jsx("button",{onClick:()=>Oe(e._id,"3wins"),className:"px-3 py-1 text-xs rounded font-medium "+(t?"bg-green-900 text-green-200 hover:bg-green-800":"bg-green-100 text-green-700"),children:"Mark Paid"}):Nt.jsx("span",{className:t?"text-gray-500":"text-gray-400",children:"-"})}),Nt.jsx("td",{className:"px-6 py-4 text-center",children:"3wins"===(null==a?void 0:a.gameType)?Nt.jsxs("div",{className:"flex flex-col items-center gap-2",children:[Nt.jsx("span",{className:e.insurancePaid?"text-purple-600 font-bold text-sm":"text-gray-600 text-sm",children:e.insurancePaid?"":""}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){var e,n;try{yield pt.put(`${zc()}/api/chicken-fight-registration/registrations/${t}/insurance`,{}),N("Insurance recorded"),Re(),Ie(),setTimeout(()=>N(""),2e3)}catch(r){b((null==(n=null==(e=r.response)?void 0:e.data)?void 0:n.message)||"Failed to record insurance")}});var t},className:"px-3 py-1 text-xs rounded font-medium "+(e.insurancePaid?"bg-green-100 text-green-700":t?"bg-purple-900 text-purple-200 hover:bg-purple-800":"bg-purple-100 text-purple-700"),children:e.insurancePaid?"":"Add"})]}):Nt.jsx("span",{className:t?"text-gray-500":"text-gray-400",children:"-"})}),Nt.jsx("td",{className:"px-6 py-4",children:Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>{return t=e._id,n=e.isValidChampion,h(null,null,function*(){var e,r;const a=!n,i=a?"valid":"invalid";if(window.confirm(`Mark this entry as ${i} champion?`))try{yield pt.put(`${zc()}/api/chicken-fight-registration/registrations/${t}/valid-champion`,{isValidChampion:a}),N(`Entry marked as ${i} champion`),Re(),Ie(),setTimeout(()=>N(""),2e3)}catch(s){b((null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.message)||`Failed to mark as ${i} champion`)}});var t,n},className:"px-3 py-1 text-xs rounded font-medium "+(!1===e.isValidChampion?t?"bg-red-900 text-red-200 hover:bg-red-800":"bg-red-100 text-red-700":t?"bg-green-900 text-green-200 hover:bg-green-800":"bg-green-100 text-green-700"),title:!1===e.isValidChampion?"Mark as valid champion":"Mark as invalid champion",children:!1===e.isValidChampion?"":""}),Nt.jsx("button",{onClick:()=>{return t=e._id,h(null,null,function*(){var e,n;if(window.confirm("Delete this registration?"))try{yield pt.delete(`${zc()}/api/chicken-fight-registration/registrations/${t}`),N("Registration deleted"),Re(),Ie(),setTimeout(()=>N(""),2e3)}catch(r){b((null==(n=null==(e=r.response)?void 0:e.data)?void 0:n.message)||"Failed to delete registration")}});var t},className:"px-3 py-1 text-xs rounded font-medium "+(t?"bg-red-900 text-red-200 hover:bg-red-800":"bg-red-100 text-red-700"),children:"Delete"}),Nt.jsx("button",{onClick:()=>{var t,n;const r=[];(null==(t=e.registrations.find(e=>"2wins"===e.gameType))?void 0:t.isPaid)&&r.push("2wins"),(null==(n=e.registrations.find(e=>"3wins"===e.gameType))?void 0:n.isPaid)&&r.push("3wins"),r.length>0&&r.forEach(t=>Le(e._id,t))},disabled:!e.registrations.some(e=>e.isPaid),className:"px-3 py-1 text-xs rounded font-medium "+(e.registrations.some(e=>e.isPaid)?t?"bg-yellow-900 text-yellow-200 hover:bg-yellow-800":"bg-yellow-100 text-yellow-700":t?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:"Withdraw"})]})})]},e._id)})})()})]})})]})]})]})}function Hte(){const{isDarkMode:e}=f.useContext($c),[t,n]=f.useState([]),[r,a]=f.useState(!1),[i,s]=f.useState(""),[o,l]=f.useState(""),[c,d]=f.useState("2wins"),[u,p]=f.useState(""),[m,g]=f.useState(["",""]),[x,y]=f.useState([{legBand:"",featherType:""},{legBand:"",featherType:""}]),[v,b]=f.useState(!1),[w,N]=f.useState(null),[S,j]=f.useState(null),[_,A]=f.useState(null),C=()=>h(null,null,function*(){var e,t;a(!0);try{const e=yield pt.get(`${zc()}/api/chicken-fight/entries`);e.data.success&&n(e.data.entries||[])}catch(r){s((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.message)||"Failed to fetch entries")}finally{a(!1)}});f.useEffect(()=>{C()},[]);const k=e=>{d(e),"2wins"===e?(g(["",""]),y([{legBand:"",featherType:""},{legBand:"",featherType:""}])):"3wins"===e&&(g(["","",""]),y([{legBand:"",featherType:""},{legBand:"",featherType:""},{legBand:"",featherType:""}]))},E=e=>h(null,null,function*(){var t,n;if(window.confirm("Are you sure you want to delete this entry?")){N(e);try{(yield pt.delete(`${zc()}/api/chicken-fight/entries/${e}`)).data.success&&(l("Entry deleted successfully!"),C(),setTimeout(()=>l(""),3e3))}catch(r){s((null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||"Failed to delete entry")}finally{N(null)}}}),P=e=>{j(e._id),p(e.entryName),d(e.gameType),g(e.legBandNumbers),y(e.legBandDetails||e.legBandNumbers.map(e=>({legBand:e,featherType:""})))},D=t.filter(e=>"2wins"===e.gameType),I=t.filter(e=>"3wins"===e.gameType);return Nt.jsxs("div",{className:"min-h-screen "+(e?"bg-gray-900":"bg-white"),children:[Nt.jsx("div",{className:(e?"bg-gradient-to-r from-gray-800 to-gray-900 border-gray-700":"bg-gradient-to-r from-white to-gray-50 border-gray-200")+" border-b sticky top-0 z-10 shadow-lg",children:Nt.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[Nt.jsx("h1",{className:"text-4xl font-bold "+(e?"text-white":"text-gray-900"),children:" Manage Entries"}),Nt.jsx("p",{className:(e?"text-gray-400":"text-gray-600")+" mt-2 text-lg",children:"Add, manage, and organize entries for 2-Wins and 3-Wins competitions"})]})}),Nt.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-3",children:[i&&Nt.jsxs("div",{className:"p-4 rounded-lg flex items-center gap-3 border "+(e?"bg-red-900/30 text-red-300 border-red-600":"bg-red-50 text-red-800 border-red-300"),children:[Nt.jsx(M,{size:20}),Nt.jsx("span",{className:"flex-1",children:i}),Nt.jsx("button",{onClick:()=>s(""),className:"hover:opacity-70",children:Nt.jsx(ce,{size:18})})]}),o&&Nt.jsxs("div",{className:"p-4 rounded-lg flex items-center gap-3 border "+(e?"bg-green-900/30 text-green-300 border-green-600":"bg-green-50 text-green-800 border-green-300"),children:[Nt.jsx(O,{size:20}),Nt.jsx("span",{className:"flex-1",children:o}),Nt.jsx("button",{onClick:()=>l(""),className:"hover:opacity-70",children:Nt.jsx(ce,{size:18})})]})]}),Nt.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Nt.jsxs("div",{className:`lg:col-span-1 ${e?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border rounded-xl p-8 h-fit shadow-lg hover:shadow-xl transition`,children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2 "+(e?"text-white":"text-gray-900"),children:S?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(Q,{size:24,className:"text-blue-500"}),"Edit Entry"]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(le,{size:24,className:"text-green-500"}),"Add Entry"]})}),Nt.jsxs("form",{onSubmit:e=>h(null,null,function*(){var n,r;e.preventDefault(),b(!0),s(""),l("");try{if(!u.trim())return s("Entry name is required"),void b(!1);if(m.some(e=>!e.trim()))return s("All leg band numbers are required"),void b(!1);if(t.some(e=>e.entryName.toLowerCase()===u.trim().toLowerCase()&&e._id!==S))return s(`Entry name "${u}" already exists`),void b(!1);const e=t.filter(e=>e.gameType===c&&e._id!==S).flatMap(e=>e.legBandNumbers),n=m.map(e=>e.trim()).filter(t=>e.includes(t));if(n.length>0)return s(`Leg band(s) ${n.join(", ")} already exist in other ${c} entries`),void b(!1);if(S){(yield pt.put(`${zc()}/api/chicken-fight/entries/${S}`,{entryName:u.trim(),legBandNumbers:m.map(e=>e.trim()),legBandDetails:x})).data.success&&(l(`Entry "${u}" updated successfully!`),j(null),p(""),g("2wins"===c?["",""]:["","",""]),y("2wins"===c?[{legBand:"",featherType:""},{legBand:"",featherType:""}]:[{legBand:"",featherType:""},{legBand:"",featherType:""},{legBand:"",featherType:""}]),C(),setTimeout(()=>l(""),3e3))}else{(yield pt.post(`${zc()}/api/chicken-fight/entries`,{entryName:u.trim(),gameType:c,legBandNumbers:m.map(e=>e.trim()),legBandDetails:x})).data.success&&(l(`Entry "${u}" created successfully!`),p(""),g("2wins"===c?["",""]:["","",""]),y("2wins"===c?[{legBand:"",featherType:""},{legBand:"",featherType:""}]:[{legBand:"",featherType:""},{legBand:"",featherType:""},{legBand:"",featherType:""}]),C(),setTimeout(()=>l(""),3e3))}}catch(a){s((null==(r=null==(n=a.response)?void 0:n.data)?void 0:r.message)||"Failed to save entry")}finally{b(!1)}}),className:"space-y-5",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-bold mb-2 "+(e?"text-gray-300":"text-gray-700"),children:"Entry Name"}),Nt.jsx("input",{type:"text",value:u,onChange:e=>p(e.target.value),placeholder:"e.g., Red Tiger",className:"w-full px-4 py-3 rounded-lg border transition "+(e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500 focus:border-blue-500 focus:bg-gray-600":"bg-white border-gray-300 text-gray-900 placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500")})]}),Nt.jsxs("div",{children:[Nt.jsxs("label",{className:"block text-sm font-bold mb-3 "+(e?"text-gray-300":"text-gray-700"),children:["Competition Type ",S&&Nt.jsx("span",{className:"text-xs opacity-75",children:"(cannot change)"})]}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsx("button",{type:"button",onClick:()=>k("2wins"),disabled:null!==S,className:`flex-1 py-3 rounded-lg font-bold text-sm transition duration-200 ${S?"opacity-50 cursor-not-allowed":""} ${"2wins"===c?e?"bg-red-600 text-white shadow-lg shadow-red-600/50":"bg-red-500 text-white shadow-lg shadow-red-500/50":e?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"2-Wins"}),Nt.jsx("button",{type:"button",onClick:()=>k("3wins"),disabled:null!==S,className:`flex-1 py-3 rounded-lg font-bold text-sm transition duration-200 ${S?"opacity-50 cursor-not-allowed":""} ${"3wins"===c?e?"bg-blue-600 text-white shadow-lg shadow-blue-600/50":"bg-blue-500 text-white shadow-lg shadow-blue-500/50":e?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"3-Wins"})]})]}),Nt.jsxs("div",{children:[Nt.jsxs("label",{className:"block text-sm font-bold mb-3 "+(e?"text-gray-300":"text-gray-700"),children:["Leg Band Numbers & Feather Types (",m.length,")"]}),Nt.jsx("div",{className:"space-y-3",children:m.map((t,n)=>{var r;return Nt.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Nt.jsx("input",{type:"text",value:t,onChange:e=>((e,t)=>{const n=[...m];n[e]=t,g(n);const r=[...x];r[e].legBand=t,y(r)})(n,e.target.value),placeholder:`Band ${n+1}`,className:"px-4 py-3 rounded-lg border transition font-mono "+(e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500 focus:border-blue-500 focus:bg-gray-600":"bg-white border-gray-300 text-gray-900 placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500")}),Nt.jsx("input",{type:"text",value:(null==(r=x[n])?void 0:r.featherType)||"",onChange:e=>((e,t)=>{const n=[...x];n[e].featherType=t,y(n)})(n,e.target.value),placeholder:"Feather type",className:"px-4 py-3 rounded-lg border transition "+(e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500 focus:border-blue-500 focus:bg-gray-600":"bg-white border-gray-300 text-gray-900 placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500")})]},n)})})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{type:"submit",disabled:v,className:"flex-1 py-3 rounded-lg font-bold transition duration-200 flex items-center justify-center gap-2 "+(v?e?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-300 text-gray-500 cursor-not-allowed":e?"bg-green-600 hover:bg-green-700 text-white shadow-lg hover:shadow-green-600/50":"bg-green-500 hover:bg-green-600 text-white shadow-lg hover:shadow-green-500/50"),children:v?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(T,{size:18,className:"animate-spin"}),S?"Updating...":"Adding..."]}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(le,{size:18}),S?"Update Entry":"Add Entry"]})}),S&&Nt.jsx("button",{type:"button",onClick:()=>{j(null),p(""),d("2wins"),g(["",""]),y([{legBand:"",featherType:""},{legBand:"",featherType:""}])},className:"px-4 py-3 rounded-lg font-bold transition "+(e?"bg-gray-700 hover:bg-gray-600 text-gray-300":"bg-gray-200 hover:bg-gray-300 text-gray-700"),children:"Cancel"})]})]})]}),Nt.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[Nt.jsxs("div",{className:(e?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border rounded-xl p-8 shadow-lg hover:shadow-xl transition",children:[Nt.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-3 "+(e?"text-red-400":"text-red-600"),children:[Nt.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full"}),"2-Wins ",Nt.jsxs("span",{className:"text-sm font-normal "+(e?"text-gray-400":"text-gray-600"),children:["(",D.length,")"]})]}),r?Nt.jsx("div",{className:"flex justify-center py-12",children:Nt.jsx(T,{size:28,className:"animate-spin text-red-500"})}):0===D.length?Nt.jsx("div",{className:"text-center py-12 "+(e?"text-gray-500":"text-gray-400"),children:Nt.jsx("p",{className:"text-lg",children:"No entries yet"})}):Nt.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:D.map(t=>Nt.jsxs("div",{className:(e?"bg-red-900/20 hover:bg-red-900/30 border-red-700":"bg-red-50 hover:bg-red-100 border-red-200")+" border rounded-lg p-4 flex justify-between items-start gap-3 group transition",children:[Nt.jsxs("div",{className:"flex-1 min-w-0",children:[Nt.jsx("h3",{className:"font-bold text-lg "+(e?"text-red-300":"text-red-700"),children:t.entryName}),Nt.jsx("div",{className:"flex gap-2 mt-3 flex-wrap",children:t.legBandNumbers.map((n,r)=>{var a;const i=null==(a=t.legBandDetails)?void 0:a.find(e=>e.legBand===n),s=(null==i?void 0:i.featherType)||"Unknown";return Nt.jsxs("div",{className:"px-2 py-1 text-xs rounded-lg "+(e?"bg-red-900/50 text-red-200 border border-red-700":"bg-red-200 text-red-800 border border-red-300"),children:[Nt.jsxs("div",{className:"font-mono font-bold",children:["#",n]}),Nt.jsx("div",{className:"text-xs opacity-75",children:s})]},r)})})]}),Nt.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition",children:[Nt.jsx("button",{onClick:()=>P(t),className:"p-2 rounded-lg transition "+(e?"text-blue-400 hover:bg-blue-900/40 hover:text-blue-300":"text-blue-600 hover:bg-blue-200"),title:"Edit entry",children:Nt.jsx(Q,{size:18})}),Nt.jsx("button",{onClick:()=>E(t._id),disabled:w===t._id,className:"p-2 rounded-lg transition "+(w===t._id?"opacity-100 text-gray-500 cursor-not-allowed":e?"text-red-400 hover:bg-red-900/40 hover:text-red-300":"text-red-600 hover:bg-red-200"),title:"Delete entry",children:w===t._id?Nt.jsx(T,{size:18,className:"animate-spin"}):Nt.jsx(R,{size:18})})]})]},t._id))})]}),Nt.jsxs("div",{className:(e?"bg-gray-800 border-gray-700":"bg-white border-gray-200")+" border rounded-xl p-8 shadow-lg hover:shadow-xl transition",children:[Nt.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-3 "+(e?"text-blue-400":"text-blue-600"),children:[Nt.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),"3-Wins ",Nt.jsxs("span",{className:"text-sm font-normal "+(e?"text-gray-400":"text-gray-600"),children:["(",I.length,")"]})]}),r?Nt.jsx("div",{className:"flex justify-center py-12",children:Nt.jsx(T,{size:28,className:"animate-spin text-blue-500"})}):0===I.length?Nt.jsx("div",{className:"text-center py-12 "+(e?"text-gray-500":"text-gray-400"),children:Nt.jsx("p",{className:"text-lg",children:"No entries yet"})}):Nt.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:I.map(t=>Nt.jsxs("div",{className:(e?"bg-blue-900/20 hover:bg-blue-900/30 border-blue-700":"bg-blue-50 hover:bg-blue-100 border-blue-200")+" border rounded-lg p-4 flex justify-between items-start gap-3 group transition",children:[Nt.jsxs("div",{className:"flex-1 min-w-0",children:[Nt.jsx("h3",{className:"font-bold text-lg "+(e?"text-blue-300":"text-blue-700"),children:t.entryName}),Nt.jsx("div",{className:"flex gap-2 mt-3 flex-wrap",children:t.legBandNumbers.map((n,r)=>{var a;const i=null==(a=t.legBandDetails)?void 0:a.find(e=>e.legBand===n),s=(null==i?void 0:i.featherType)||"Unknown";return Nt.jsxs("div",{className:"px-2 py-1 text-xs rounded-lg "+(e?"bg-blue-900/50 text-blue-200 border border-blue-700":"bg-blue-200 text-blue-800 border border-blue-300"),children:[Nt.jsxs("div",{className:"font-mono font-bold",children:["#",n]}),Nt.jsx("div",{className:"text-xs opacity-75",children:s})]},r)})})]}),Nt.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition",children:[Nt.jsx("button",{onClick:()=>P(t),className:"p-2 rounded-lg transition "+(e?"text-blue-400 hover:bg-blue-900/40 hover:text-blue-300":"text-blue-600 hover:bg-blue-200"),title:"Edit entry",children:Nt.jsx(Q,{size:18})}),Nt.jsx("button",{onClick:()=>E(t._id),disabled:w===t._id,className:"p-2 rounded-lg transition "+(w===t._id?"opacity-100 text-gray-500 cursor-not-allowed":e?"text-red-400 hover:bg-red-900/40 hover:text-red-300":"text-red-600 hover:bg-red-200"),title:"Delete entry",children:w===t._id?Nt.jsx(T,{size:18,className:"animate-spin"}):Nt.jsx(R,{size:18})})]})]},t._id))})]})]})]})})]})}function Gte(){var e,t,n,r,a,i,s;const{isDarkMode:o}=f.useContext($c),[d,u]=f.useState(null),[p,m]=f.useState(!1),[g,x]=f.useState(""),[y,v]=f.useState(""),[b,w]=f.useState(0),[N,S]=f.useState(""),[j,_]=f.useState(""),[A,C]=f.useState([]),[k,E]=f.useState(!1),[T,P]=f.useState(null),[D,I]=f.useState(null),O=()=>h(null,null,function*(){var e,t;m(!0),x("");try{const e=localStorage.getItem("token"),t=yield pt.get(`${zc()}/api/chicken-fight/fights/today`,{headers:{Authorization:`Bearer ${e}`}});t.data.success&&t.data.game?(u(t.data.game),w(1)):x("No game data found for today")}catch(n){x((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to load game data")}finally{m(!1)}});f.useEffect(()=>{O()},[]);const B=(()=>{if(!(null==d?void 0:d.entryResults))return{};const e={};return d.entryResults.forEach(t=>{var n;null==(n=t.legResults)||n.forEach(n=>{e[n.legNumber]||(e[n.legNumber]=[]),e[n.legNumber].push(c(l({},t),{legResult:n}))})}),e})(),L=(null==d?void 0:d.entryResults)?Math.max(...d.entryResults.flatMap(e=>{var t;return(null==(t=e.legResults)?void 0:t.map(e=>e.legNumber))||[]}),0):0,F=Array.from({length:L},(e,t)=>t+1),U=()=>{const e=N.trim().toLowerCase();if(!e)return;x(""),_(""),C([]);const t=parseInt(e);if(!isNaN(t)&&t>0&&t<=L)return w(t),void S("");for(const n of F){const t=B[n];if(t)for(const n of t){if(n.entryName.toLowerCase().includes(e)){const e=n.entryName,t=[];for(const n of F){const r=B[n];if(r)for(const a of r)a.entryName===e&&t.push({legNumber:n,fight:a})}return t.sort((e,t)=>e.legNumber-t.legNumber),_(e),C(t),w(t[0].legNumber),void S("")}if(n.legBandNumbers&&n.legBandNumbers.length>0)for(let t=0;t<n.legBandNumbers.length;t++){const r=n.legBandNumbers[t];if(r&&r.toString()===e){const e=t+1;if(B[e])return w(e),_(""),C([]),void S("")}}}}x(`No fight found for: "${N}"`)},z=(e,t=b)=>{P(t),I({legNumber:t,meron:e[0],wala:e[1]}),E(!0)},H=(...e)=>h(null,[...e],function*(e=b){var t,n;if(window.confirm(`Delete fight #${e}? This cannot be undone.`)){x(""),v("");try{const t=localStorage.getItem("token"),n=d.entryResults.map(t=>{const n=l({},t);return n.legResults=n.legResults.filter(t=>t.legNumber!==e),n}).filter(e=>e.legResults.length>0);(yield pt.put(`${zc()}/api/chicken-fight/game/results`,{gameDate:d.gameDate,entryResults:n,fightNumber:d.fightNumber-1},{headers:{Authorization:`Bearer ${t}`}})).data.success&&(v("Fight deleted successfully!"),setTimeout(()=>v(""),2e3),e===b&&b>1&&w(b-1),O())}catch(r){x((null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||"Failed to delete fight")}}}),G=(()=>{const e=B[b];return!e||e.length<2?null:e})();return p?Nt.jsx("div",{className:"flex justify-center items-center h-screen",children:Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):Nt.jsxs("div",{className:"min-h-screen "+(o?"bg-gray-900":"bg-white"),children:[Nt.jsx("div",{className:(o?"bg-gradient-to-r from-gray-800 to-gray-900 border-gray-700":"bg-gradient-to-r from-white to-gray-50 border-gray-200")+" border-b sticky top-0 z-10 shadow-lg",children:Nt.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[Nt.jsx("h1",{className:"text-4xl font-bold "+(o?"text-white":"text-gray-900"),children:" Edit/Delete Fight Results"}),Nt.jsx("p",{className:(o?"text-gray-400":"text-gray-600")+" mt-2 text-lg",children:"Manage individual fight results"})]})}),Nt.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[g&&Nt.jsxs("div",{className:"p-4 rounded-lg flex items-center gap-3 border mb-4 "+(o?"bg-red-900/30 text-red-300 border-red-600":"bg-red-50 text-red-800 border-red-300"),children:[Nt.jsx(M,{size:20}),Nt.jsx("span",{className:"flex-1",children:g}),Nt.jsx("button",{onClick:()=>x(""),className:"hover:opacity-70",children:Nt.jsx(ce,{size:18})})]}),d&&Nt.jsxs("div",{className:"rounded-lg shadow p-6 mb-8 "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-6 "+(o?"text-white":"text-gray-900"),children:" Fight Summary"}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[Nt.jsxs("div",{className:"p-4 rounded-lg text-center "+(o?"bg-blue-900/30 border border-blue-700":"bg-blue-50 border border-blue-200"),children:[Nt.jsx("div",{className:"text-2xl font-bold "+(o?"text-blue-400":"text-blue-600"),children:L}),Nt.jsx("div",{className:"text-sm "+(o?"text-blue-300":"text-blue-600"),children:"Total Fights"})]}),Nt.jsxs("div",{className:"p-4 rounded-lg text-center "+(o?"bg-green-900/30 border border-green-700":"bg-green-50 border border-green-200"),children:[Nt.jsx("div",{className:"text-2xl font-bold "+(o?"text-green-400":"text-green-600"),children:(null==(e=d.entryResults)?void 0:e.filter(e=>{var t;return null==(t=e.legResults)?void 0:t.some(e=>"win"===e.result)}).length)||0}),Nt.jsx("div",{className:"text-sm "+(o?"text-green-300":"text-green-600"),children:"Active Entries"})]}),Nt.jsxs("div",{className:"p-4 rounded-lg text-center "+(o?"bg-purple-900/30 border border-purple-700":"bg-purple-50 border border-purple-200"),children:[Nt.jsx("div",{className:"text-2xl font-bold "+(o?"text-purple-400":"text-purple-600"),children:Object.values(B).flat().filter(e=>{var t;return"win"===(null==(t=e.legResult)?void 0:t.result)}).length}),Nt.jsx("div",{className:"text-sm "+(o?"text-purple-300":"text-purple-600"),children:"Total Wins"})]}),Nt.jsxs("div",{className:"p-4 rounded-lg text-center "+(o?"bg-orange-900/30 border border-orange-700":"bg-orange-50 border border-orange-200"),children:[Nt.jsx("div",{className:"text-2xl font-bold "+(o?"text-orange-400":"text-orange-600"),children:Object.values(B).flat().filter(e=>{var t;return"cancelled"===(null==(t=e.legResult)?void 0:t.result)}).length}),Nt.jsx("div",{className:"text-sm "+(o?"text-orange-300":"text-orange-600"),children:"Cancelled"})]})]}),(()=>{const e={};Object.values(B).flat().forEach(t=>{var n;"win"===(null==(n=t.legResult)?void 0:n.result)&&(e[t.entryName]=(e[t.entryName]||0)+1)});const t=Object.entries(e).filter(([e,t])=>{var n;const r=null==(n=d.entryResults)?void 0:n.find(t=>t.entryName===e);return"2wins"===(null==r?void 0:r.gameType)&&t>=2}).sort(([,e],[,t])=>t-e),n=Object.entries(e).filter(([e,t])=>{var n;const r=null==(n=d.entryResults)?void 0:n.find(t=>t.entryName===e);return"3wins"===(null==r?void 0:r.gameType)&&t>=3}).sort(([,e],[,t])=>t-e);return(t.length>0||n.length>0)&&Nt.jsxs("div",{className:"border-t pt-6",children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-4 "+(o?"text-white":"text-gray-900"),children:" Champions"}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.length>0&&Nt.jsxs("div",{children:[Nt.jsx("h4",{className:"font-medium mb-2 "+(o?"text-red-400":"text-red-600"),children:"2-Wins Champions"}),Nt.jsx("div",{className:"space-y-1",children:t.map(([e,t],n)=>Nt.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(o?"bg-red-900/20":"bg-red-50"),children:[Nt.jsxs("span",{className:"font-medium "+(o?"text-red-300":"text-red-700"),children:[0===n?"":1===n?"":2===n?"":""," ",e]}),Nt.jsxs("span",{className:"text-sm "+(o?"text-red-400":"text-red-600"),children:[t," wins"]})]},e))})]}),n.length>0&&Nt.jsxs("div",{children:[Nt.jsx("h4",{className:"font-medium mb-2 "+(o?"text-blue-400":"text-blue-600"),children:"3-Wins Champions"}),Nt.jsx("div",{className:"space-y-1",children:n.map(([e,t],n)=>Nt.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(o?"bg-blue-900/20":"bg-blue-50"),children:[Nt.jsxs("span",{className:"font-medium "+(o?"text-blue-300":"text-blue-700"),children:[0===n?"":1===n?"":2===n?"":""," ",e]}),Nt.jsxs("span",{className:"text-sm "+(o?"text-blue-400":"text-blue-600"),children:[t," wins"]})]},e))})]})]})]})})()]}),d&&F.length>0&&Nt.jsxs("div",{className:"rounded-lg shadow p-6 mb-8 "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-6 "+(o?"text-white":"text-gray-900"),children:" Fight Timeline"}),Nt.jsx("div",{className:"space-y-4",children:Array.from({length:L},(e,t)=>t+1).map(e=>{var t,n,r,a;const i=B[e];if(!(i&&i.length>=2))return Nt.jsxs("div",{className:"p-4 rounded-lg border-2 transition-all "+(o?"border-gray-600 bg-gray-900/30":"border-gray-300 bg-gray-50"),children:[Nt.jsx("div",{className:"flex items-center justify-between mb-3",children:Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm "+(o?"bg-gray-700 text-gray-400":"bg-gray-300 text-gray-600"),children:e}),Nt.jsxs("span",{className:"font-medium "+(o?"text-gray-400":"text-gray-600"),children:["Fight #",e]}),Nt.jsx("span",{className:"text-xs px-2 py-1 rounded "+(o?"bg-gray-700 text-gray-400":"bg-gray-200 text-gray-600"),children:"No Data"})]})}),Nt.jsxs("div",{className:"text-center py-8",children:[Nt.jsx("div",{className:"text-sm "+(o?"text-gray-500":"text-gray-400"),children:"This fight has no recorded data"}),Nt.jsx("div",{className:"text-xs mt-2 "+(o?"text-gray-600":"text-gray-500"),children:"Fight may have been cancelled or not recorded properly"})]})]},e);const[s,l]=i,c=null==(t=s.legResult)?void 0:t.result,d=null==(n=l.legResult)?void 0:n.result;return Nt.jsxs("div",{className:"p-4 rounded-lg border-2 transition-all hover:shadow-md "+("cancelled"===c||"cancelled"===d?o?"border-gray-600 bg-gray-900/50":"border-gray-300 bg-gray-50":o?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm "+("cancelled"===c||"cancelled"===d?o?"bg-gray-700 text-gray-400":"bg-gray-300 text-gray-600":o?"bg-blue-600 text-white":"bg-blue-500 text-white"),children:e}),Nt.jsxs("span",{className:"font-medium "+(o?"text-white":"text-gray-900"),children:["Fight #",e]})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>w(e),className:"px-3 py-1 rounded text-sm transition "+(o?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:"View Details"}),Nt.jsxs("button",{onClick:()=>z(i,e),className:"px-3 py-1 rounded text-sm transition flex items-center gap-1 "+(o?"bg-green-600 hover:bg-green-700 text-white":"bg-green-500 hover:bg-green-600 text-white"),title:"Edit fight results",children:[Nt.jsx(Q,{size:14}),"Edit"]}),Nt.jsxs("button",{onClick:()=>H(e),className:"px-3 py-1 rounded text-sm transition flex items-center gap-1 "+(o?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"),title:"Delete this fight",children:[Nt.jsx(R,{size:14}),"Delete"]})]})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{className:"p-3 rounded border "+("win"===c?o?"bg-green-900/30 border-green-700":"bg-green-50 border-green-300":"loss"===c?o?"bg-red-900/30 border-red-700":"bg-red-50 border-red-300":"cancelled"===c?o?"bg-gray-900/30 border-gray-700":"bg-gray-50 border-gray-300":o?"bg-yellow-900/30 border-yellow-700":"bg-yellow-50 border-yellow-300"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Nt.jsx("span",{className:"font-medium "+(o?"text-red-400":"text-red-600"),children:"MERON"}),Nt.jsx("span",{className:"text-sm font-bold "+("win"===c?o?"text-green-400":"text-green-600":"loss"===c?o?"text-red-400":"text-red-600":"cancelled"===c?o?"text-gray-400":"text-gray-600":o?"text-yellow-400":"text-yellow-600"),children:"win"===c?" WIN":"loss"===c?" LOSS":"draw"===c?" DRAW":"cancelled"===c?" CANCELLED":"UNKNOWN"})]}),Nt.jsxs("div",{className:"text-sm "+(o?"text-gray-300":"text-gray-700"),children:[Nt.jsx("div",{className:"font-medium",children:s.entryName}),Nt.jsx("div",{className:"text-xs opacity-75",children:s.gameType}),(null==(r=s.legBandNumbers)?void 0:r[e-1])&&Nt.jsxs("div",{className:"text-xs font-mono mt-1",children:["Leg Band: #",s.legBandNumbers[e-1]]})]})]}),Nt.jsxs("div",{className:"p-3 rounded border "+("win"===d?o?"bg-green-900/30 border-green-700":"bg-green-50 border-green-300":"loss"===d?o?"bg-red-900/30 border-red-700":"bg-red-50 border-red-300":"cancelled"===d?o?"bg-gray-900/30 border-gray-700":"bg-gray-50 border-gray-300":o?"bg-yellow-900/30 border-yellow-700":"bg-yellow-50 border-yellow-300"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Nt.jsx("span",{className:"font-medium "+(o?"text-blue-400":"text-blue-600"),children:"WALA"}),Nt.jsx("span",{className:"text-sm font-bold "+("win"===d?o?"text-green-400":"text-green-600":"loss"===d?o?"text-red-400":"text-red-600":"cancelled"===d?o?"text-gray-400":"text-gray-600":o?"text-yellow-400":"text-yellow-600"),children:"win"===d?" WIN":"loss"===d?" LOSS":"draw"===d?" DRAW":"cancelled"===d?" CANCELLED":"UNKNOWN"})]}),Nt.jsxs("div",{className:"text-sm "+(o?"text-gray-300":"text-gray-700"),children:[Nt.jsx("div",{className:"font-medium",children:l.entryName}),Nt.jsx("div",{className:"text-xs opacity-75",children:l.gameType}),(null==(a=l.legBandNumbers)?void 0:a[e-1])&&Nt.jsxs("div",{className:"text-xs font-mono mt-1",children:["Leg Band: #",l.legBandNumbers[e-1]]})]})]})]})]},e)})})]}),!j&&Nt.jsxs("div",{className:"rounded-lg shadow p-6 mb-8 "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-6 "+(o?"text-white":"text-gray-900"),children:" Navigate & Search"}),Nt.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-6",children:[Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-3 "+(o?"text-white":"text-gray-900"),children:"Fight Navigation"}),Nt.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[Nt.jsx("button",{onClick:()=>w(Math.max(1,b-1)),disabled:b<=1,className:"p-3 rounded-lg transition "+(b<=1?o?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":o?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),title:"Previous Fight",children:Nt.jsx(V,{size:24})}),Nt.jsxs("div",{className:"text-center px-6 py-3 rounded-lg "+(o?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("div",{className:"text-sm opacity-75 "+(o?"text-gray-400":"text-gray-600"),children:"Current Fight"}),Nt.jsx("div",{className:"text-3xl font-bold "+(o?"text-white":"text-gray-900"),children:b}),Nt.jsxs("div",{className:"text-xs text-gray-500",children:["of ",L]})]}),Nt.jsx("button",{onClick:()=>w(Math.min(L,b+1)),disabled:b>=L,className:"p-3 rounded-lg transition "+(b>=L?o?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":o?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),title:"Next Fight",children:Nt.jsx($,{size:24})})]}),Nt.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+(o?"bg-gray-700":"bg-gray-200"),children:Nt.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(o?"bg-blue-600":"bg-blue-500"),style:{width:(L>0?b/L*100:0)+"%"}})})]}),Nt.jsxs("div",{className:"flex-1",children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-3 "+(o?"text-white":"text-gray-900"),children:"Search Fights"}),Nt.jsxs("div",{className:"space-y-3",children:[Nt.jsxs("div",{className:"relative",children:[Nt.jsx(pe,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+(o?"text-gray-500":"text-gray-400")}),Nt.jsx("input",{type:"text",value:N,onChange:e=>S(e.target.value),placeholder:"Search by fight #, entry name, or leg band",onKeyPress:e=>"Enter"===e.key&&U(),className:"w-full pl-10 pr-4 py-3 rounded-lg border transition "+(o?"bg-gray-700 border-gray-600 text-white placeholder-gray-500 focus:border-blue-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400 focus:border-blue-500")})]}),Nt.jsx("button",{onClick:U,className:"w-full py-2 rounded-lg font-medium transition "+(o?"bg-green-600 hover:bg-green-700 text-white":"bg-green-500 hover:bg-green-600 text-white"),children:" Search"})]})]})]}),Nt.jsx("div",{className:"border-t pt-4 "+(o?"border-gray-700":"border-gray-200"),children:Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-lg font-bold "+(o?"text-white":"text-gray-900"),children:L}),Nt.jsx("div",{className:"text-sm "+(o?"text-gray-400":"text-gray-600"),children:"Total Fights"})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-lg font-bold "+(o?"text-green-400":"text-green-600"),children:Object.values(B).flat().filter(e=>{var t;return"win"===(null==(t=e.legResult)?void 0:t.result)}).length}),Nt.jsx("div",{className:"text-sm "+(o?"text-gray-400":"text-gray-600"),children:"Wins Recorded"})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-lg font-bold "+(o?"text-yellow-400":"text-yellow-600"),children:Object.values(B).flat().filter(e=>{var t;return"draw"===(null==(t=e.legResult)?void 0:t.result)}).length}),Nt.jsx("div",{className:"text-sm "+(o?"text-gray-400":"text-gray-600"),children:"Draws"})]}),Nt.jsxs("div",{children:[Nt.jsx("div",{className:"text-lg font-bold "+(o?"text-red-400":"text-red-600"),children:Object.values(B).flat().filter(e=>{var t;return"cancelled"===(null==(t=e.legResult)?void 0:t.result)}).length}),Nt.jsx("div",{className:"text-sm "+(o?"text-gray-400":"text-gray-600"),children:"Cancelled"})]})]})})]}),j&&A.length>0&&Nt.jsxs("div",{className:"rounded-lg shadow p-8 mb-8 "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsxs("h2",{className:"text-2xl font-bold mb-6 "+(o?"text-white":"text-gray-900"),children:['All Fights for "',j,'"']}),Nt.jsx("div",{className:"grid grid-cols-1 gap-6",children:A.map((e,t)=>{var n,r,a,i,s,l;const c=B[e.legNumber];return Nt.jsxs("div",{className:"p-6 rounded-lg border-2 "+(o?"bg-gray-700 border-gray-600":"bg-white border-gray-300"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h3",{className:"text-xl font-bold "+(o?"text-white":"text-gray-900"),children:["Fight #",e.legNumber]}),Nt.jsx("div",{className:"text-sm font-medium px-3 py-1 rounded "+("win"===(null==(n=e.fight.legResult)?void 0:n.result)?o?"bg-green-900/50 text-green-400":"bg-green-100 text-green-700":"loss"===(null==(r=e.fight.legResult)?void 0:r.result)?o?"bg-red-900/50 text-red-400":"bg-red-100 text-red-700":o?"bg-yellow-900/50 text-yellow-400":"bg-yellow-100 text-yellow-700"),children:"win"===(null==(a=e.fight.legResult)?void 0:a.result)?" WIN":"loss"===(null==(i=e.fight.legResult)?void 0:i.result)?" LOSS":"draw"===(null==(s=e.fight.legResult)?void 0:s.result)?" DRAW":"cancelled"===(null==(l=e.fight.legResult)?void 0:l.result)?" CANCELLED":"UNKNOWN"})]}),c&&Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map((t,n)=>{var r,a,i;const s=((null==(r=t.legResult)?void 0:r.legNumber)||e.legNumber)-1,l=null==(a=t.legBandNumbers)?void 0:a[s],c=null==(i=t.legBandDetails)?void 0:i[s];return Nt.jsxs("div",{className:"p-4 rounded "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsx("div",{className:"font-medium mb-2 "+(o?"text-white":"text-gray-900"),children:t.entryName}),Nt.jsxs("div",{className:"text-sm space-y-1 mb-3 "+(o?"text-gray-300":"text-gray-700"),children:[Nt.jsxs("div",{children:[Nt.jsx("span",{className:"opacity-75",children:"Game Type:"})," ",t.gameType]}),l&&Nt.jsxs("div",{className:"font-mono",children:[Nt.jsx("span",{className:"opacity-75",children:"Leg Band:"})," #",l,(null==c?void 0:c.featherType)&&Nt.jsx("div",{className:"text-xs opacity-75 ml-2",children:c.featherType})]})]}),Nt.jsx("button",{onClick:()=>{_(""),C([]),w(e.legNumber)},className:"text-sm px-2 py-1 rounded transition "+(o?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:"View Details"})]},n)})})]},t)})}),Nt.jsx("button",{onClick:()=>{_(""),C([])},className:"mt-6 px-4 py-2 rounded-lg font-medium transition "+(o?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-300 hover:bg-gray-400 text-gray-900"),children:"Clear Search"})]}),G?Nt.jsxs("div",{className:"rounded-lg shadow p-8 mb-8 "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-8",children:[Nt.jsxs("div",{children:[Nt.jsxs("h2",{className:"text-3xl font-bold "+(o?"text-white":"text-gray-900"),children:["Fight #",b]}),G&&G[0]&&G[0].legResult&&Nt.jsx("div",{className:"mt-3 flex flex-wrap gap-3",children:G.map((e,t)=>{var n,r,a;const i=((null==(n=e.legResult)?void 0:n.legNumber)||b)-1,s=null==(r=e.legBandNumbers)?void 0:r[i],l=null==(a=e.legBandDetails)?void 0:a[i];return Nt.jsxs("div",{className:"px-3 py-2 rounded-lg "+(o?"bg-purple-900/50 border border-purple-700":"bg-purple-100 border border-purple-300"),children:[Nt.jsx("div",{className:"text-xs opacity-75",children:"Leg Band:"}),Nt.jsx("div",{className:"font-bold text-lg",children:s?`#${s}`:"N/A"}),(null==l?void 0:l.featherType)&&Nt.jsx("div",{className:"text-xs opacity-75",children:l.featherType})]},t)})})]}),Nt.jsxs("div",{className:"flex gap-3",children:[Nt.jsxs("button",{onClick:()=>z(G),className:"px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition "+(o?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:[Nt.jsx(Q,{size:18}),"Edit"]}),Nt.jsxs("button",{onClick:H,className:"px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition "+(o?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:[Nt.jsx(R,{size:18}),"Delete"]})]})]}),Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:G.map((e,t)=>Nt.jsxs("div",{className:"p-6 rounded-lg border-2 "+("win"===e.legResult.result?o?"bg-green-900/30 border-green-700":"bg-green-50 border-green-300":"loss"===e.legResult.result?o?"bg-red-900/30 border-red-700":"bg-red-50 border-red-300":o?"bg-yellow-900/30 border-yellow-700":"bg-yellow-50 border-yellow-300"),children:[Nt.jsx("div",{className:"text-sm font-medium mb-2 "+("win"===e.legResult.result?o?"text-green-400":"text-green-600":"loss"===e.legResult.result?o?"text-red-400":"text-red-600":o?"text-yellow-400":"text-yellow-600"),children:"win"===e.legResult.result?" WIN":"loss"===e.legResult.result?" LOSS":"draw"===e.legResult.result?" DRAW":"cancelled"===e.legResult.result?" CANCELLED":"UNKNOWN"}),Nt.jsx("div",{className:"text-2xl font-bold mb-4 "+(o?"text-white":"text-gray-900"),children:e.entryName}),Nt.jsxs("div",{className:"space-y-2 text-sm "+(o?"text-gray-300":"text-gray-600"),children:[Nt.jsxs("div",{children:[Nt.jsx("span",{className:"font-medium",children:"Game Type:"}),Nt.jsx("span",{className:"ml-2",children:e.gameType})]}),e.legResults&&e.legResults[0]&&Nt.jsxs(Nt.Fragment,{children:[(()=>{var t,n;const r=e.legResults[0].legNumber,a=r-1,i=null==(t=e.legBandNumbers)?void 0:t[a],s=null==(n=e.legBandDetails)?void 0:n[a];return Nt.jsxs("div",{children:[Nt.jsxs("span",{className:"font-medium",children:["Leg Band (Fight #",r,"):"]}),Nt.jsx("div",{className:"ml-2 mt-1 flex flex-wrap gap-2",children:Nt.jsxs("span",{className:"px-3 py-2 rounded font-mono "+(o?"bg-purple-900/50 border border-purple-700":"bg-purple-100 border border-purple-300"),children:[Nt.jsx("div",{className:"font-bold",children:i?`#${i}`:"N/A"}),(null==s?void 0:s.featherType)&&Nt.jsx("div",{className:"text-xs opacity-75",children:s.featherType})]})})]})})(),e.legBandNumbers&&e.legBandNumbers.length>0&&Nt.jsxs("div",{children:[Nt.jsx("span",{className:"font-medium",children:"All Leg Bands:"}),Nt.jsx("div",{className:"ml-2 flex flex-wrap gap-2 mt-1",children:e.legBandNumbers.map((e,t)=>Nt.jsx("span",{className:"px-2 py-1 rounded font-mono text-xs "+(o?"bg-blue-900/50 border border-blue-700":"bg-blue-100 border border-blue-300"),children:e?`#${e}`:"N/A"},t))})]})]})]})]},t))})]}):b>0?Nt.jsx("div",{className:"rounded-lg shadow p-8 text-center "+(o?"bg-gray-800":"bg-white"),children:Nt.jsxs("p",{className:"text-lg "+(o?"text-gray-400":"text-gray-600"),children:["No fight data for Fight #",b]})}):Nt.jsx("div",{className:"rounded-lg shadow p-8 text-center "+(o?"bg-gray-800":"bg-white"),children:Nt.jsx("p",{className:"text-lg "+(o?"text-gray-400":"text-gray-600"),children:"Select a fight to view details"})})]}),k&&D&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"p-6 rounded-lg w-full max-w-2xl max-h-96 overflow-y-auto "+(o?"bg-gray-800":"bg-white"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h2",{className:"text-xl font-bold "+(o?"text-white":"text-gray-900"),children:["Edit Fight #",b]}),Nt.jsx("button",{onClick:()=>E(!1),className:"p-1 hover:bg-gray-700 rounded",children:Nt.jsx(ce,{size:20})})]}),Nt.jsxs("div",{className:"space-y-6",children:[Nt.jsxs("div",{children:[Nt.jsxs("label",{className:"block text-sm font-medium mb-2 "+(o?"text-gray-300":"text-gray-700"),children:[null==(t=D.meron)?void 0:t.entryName," - Result"]}),Nt.jsxs("select",{value:(null==(r=null==(n=D.meron)?void 0:n.legResult)?void 0:r.result)||"",onChange:e=>I(c(l({},D),{meron:c(l({},D.meron),{legResult:c(l({},D.meron.legResult),{result:e.target.value})})})),className:"w-full px-4 py-2 rounded-lg border "+(o?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"win",children:"Win"}),Nt.jsx("option",{value:"loss",children:"Loss"}),Nt.jsx("option",{value:"draw",children:"Draw"})]})]}),Nt.jsxs("div",{children:[Nt.jsxs("label",{className:"block text-sm font-medium mb-2 "+(o?"text-gray-300":"text-gray-700"),children:[null==(a=D.wala)?void 0:a.entryName," - Result"]}),Nt.jsxs("select",{value:(null==(s=null==(i=D.wala)?void 0:i.legResult)?void 0:s.result)||"",onChange:e=>I(c(l({},D),{wala:c(l({},D.wala),{legResult:c(l({},D.wala.legResult),{result:e.target.value})})})),className:"w-full px-4 py-2 rounded-lg border "+(o?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"),children:[Nt.jsx("option",{value:"win",children:"Win"}),Nt.jsx("option",{value:"loss",children:"Loss"}),Nt.jsx("option",{value:"draw",children:"Draw"})]})]})]}),Nt.jsxs("div",{className:"flex gap-3 mt-8",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){var e,t;if(D){x(""),v("");try{const e=localStorage.getItem("token"),t=d.entryResults.map(e=>{var t,n;const r=l({},e);return(null==(t=D.meron)?void 0:t.entryId)===e._id&&(r.legResults=r.legResults.map(e=>e.legNumber===D.legNumber?c(l({},e),{result:D.meron.legResult.result}):e)),(null==(n=D.wala)?void 0:n.entryId)===e._id&&(r.legResults=r.legResults.map(e=>e.legNumber===D.legNumber?c(l({},e),{result:D.wala.legResult.result}):e)),r});(yield pt.put(`${zc()}/api/chicken-fight/game/results`,{gameDate:d.gameDate,entryResults:t},{headers:{Authorization:`Bearer ${e}`}})).data.success&&(v("Fight updated successfully!"),E(!1),setTimeout(()=>v(""),2e3),O())}catch(n){x((null==(t=null==(e=n.response)?void 0:e.data)?void 0:t.message)||"Failed to update fight")}}}),className:"flex-1 px-4 py-2 rounded-lg font-medium transition "+(o?"bg-green-600 hover:bg-green-700 text-white":"bg-green-500 hover:bg-green-600 text-white"),children:"Save Changes"}),Nt.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-2 rounded-lg border font-medium transition "+(o?"bg-gray-700 hover:bg-gray-600 text-white border-gray-600":"bg-white hover:bg-gray-100 text-gray-900 border-gray-300"),children:"Cancel"})]})]})})]})}function Vte(){var e;const{settings:t,user:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),i=f.useRef(null),s=f.useRef(null),o=f.useRef(null),[d,u]=f.useState(null),[p,m]=f.useState(!1),[g,x]=f.useState(!1),[y,v]=f.useState(null),[b,w]=f.useState([]),[N,S]=f.useState(""),[j,_]=f.useState(`Cockfight-${(new Date).getTime()}`),[A,C]=f.useState(!1),[M,k]=f.useState(0),[E,T]=f.useState(null),P=f.useRef([]),[R,I]=f.useState({quality:"720",frameRate:30,bitrate:2500,broadcast:!1}),[O,B]=f.useState(!1),[F,U]=f.useState(1);f.useEffect(()=>{h(null,null,function*(){try{const e=(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);w(e),e.length>0&&S(e[0].deviceId)}catch(e){console.error("Error getting cameras:",e),v("Failed to access camera list")}})},[]),f.useEffect(()=>{if(!i.current||!d)return;console.log(" Setting stream to video element..."),i.current.srcObject=d;const e=i.current.play();void 0!==e&&e.then(()=>{console.log(" Video playing successfully")}).catch(e=>{console.error(" Auto-play failed:",e),setTimeout(()=>{var e;(null==(e=i.current)?void 0:e.srcObject)===d&&i.current.play().catch(e=>{console.error(" Retry failed:",e)})},500)})},[d]);f.useEffect(()=>{if(!A)return;const e=setInterval(()=>{k(e=>e+1)},1e3);return()=>clearInterval(e)},[A]);const z=e=>{const t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=e%60;return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},H=()=>h(null,null,function*(){const e=document.getElementById("camera-container");if(document.fullscreenElement)document.exitFullscreen(),x(!1);else try{yield null==e?void 0:e.requestFullscreen(),x(!0)}catch(t){console.error("Fullscreen error:",t)}});return Nt.jsxs("div",{id:"camera-container",className:`min-h-screen ${a?"bg-gray-900":"bg-gray-50"} p-4 md:p-6`,children:[Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsx("div",{className:"mb-6",children:Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx(Y,{size:32,className:"text-red-600"}),Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold "+(a?"text-white":"text-gray-900"),children:" Live Cock Fight Camera"}),Nt.jsxs("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:["Deployed by: ",(null==n?void 0:n.name)||(null==n?void 0:n.username)]})]})]}),Nt.jsx("button",{onClick:()=>B(!O),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition",title:"Settings",children:Nt.jsx(L,{size:24,className:"text-gray-600 dark:text-gray-300"})})]})}),Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg overflow-hidden mb-6",children:[Nt.jsx("div",{className:"relative bg-black aspect-video flex items-center justify-center",children:p?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("video",{ref:i,autoPlay:!0,muted:!0,playsInline:!0,disablePictureInPicture:!0,style:{display:"block",width:"100%",height:"100%",objectFit:"cover",backgroundColor:"#000",transform:`scale(${F})`,transformOrigin:"center",transition:"transform 0.2s ease-out"}}),A&&Nt.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-red-600 text-white px-3 py-1 rounded-full animate-pulse",children:[Nt.jsx(D,{size:12,fill:"white"}),Nt.jsxs("span",{className:"font-semibold",children:["Recording: ",z(M)]})]}),Nt.jsx("button",{onClick:H,className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/75 rounded-lg transition text-white",children:g?Nt.jsx(st,{size:20}):Nt.jsx(ot,{size:20})}),Nt.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2 bg-black/50 p-2 rounded-lg",children:[Nt.jsx("button",{onClick:()=>{const e=Math.max(F-.2,1);U(e),r({type:"info",message:` Zoom: ${(100*e).toFixed(0)}%`})},disabled:F<=1,className:"p-2 bg-white/20 hover:bg-white/30 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition text-white",title:"Zoom Out",children:Nt.jsx(He,{size:20})}),Nt.jsxs("div",{className:"flex items-center px-3 text-white text-sm font-semibold min-w-12",children:[(100*F).toFixed(0),"%"]}),Nt.jsx("button",{onClick:()=>{const e=Math.min(F+.2,3);U(e),r({type:"info",message:` Zoom: ${(100*e).toFixed(0)}%`})},disabled:F>=3,className:"p-2 bg-white/20 hover:bg-white/30 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition text-white",title:"Zoom In",children:Nt.jsx(ze,{size:20})})]})]}):Nt.jsxs("div",{className:"text-center",children:[Nt.jsx(Y,{size:64,className:"text-gray-600 mx-auto mb-4"}),Nt.jsx("p",{className:"text-gray-500 text-lg",children:"Camera not active"}),Nt.jsx("p",{className:"text-gray-600 text-sm mt-2",children:'Click "Start Camera" to begin'})]})}),Nt.jsxs("div",{className:"p-6 "+(a?"bg-gray-800 border-t border-gray-700":"bg-white border-t border-gray-200"),children:[y&&Nt.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-lg text-red-800 dark:text-red-200",children:y}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Select Camera"}),Nt.jsx("select",{value:N,onChange:e=>S(e.target.value),disabled:p,className:`w-full px-3 py-2 rounded-lg border ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} disabled:opacity-50`,children:b.map(e=>Nt.jsx("option",{value:e.deviceId,children:e.label||`Camera ${b.indexOf(e)+1}`},e.deviceId))})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Stream Name"}),Nt.jsx("input",{type:"text",value:j,onChange:e=>_(e.target.value),disabled:p,className:`w-full px-3 py-2 rounded-lg border ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} disabled:opacity-50`})]})]}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[Nt.jsx("button",{onClick:p?()=>{o.current&&(o.current.getTracks().forEach(e=>e.stop()),o.current=null),i.current&&(i.current.srcObject=null),u(null),m(!1),C(!1),k(0),r({type:"info",message:" Camera stopped"})}:()=>h(null,null,function*(){try{v(null),console.log(" Starting camera with device:",N);const e={video:{deviceId:N?{exact:N}:void 0,width:{ideal:parseInt(R.quality)},frameRate:{ideal:R.frameRate}},audio:!0},t=yield navigator.mediaDevices.getUserMedia(e);if(console.log(" Media stream acquired:",t.getTracks()),o.current=t,i.current){i.current.srcObject=t,console.log(" Stream assigned to video element");const e=i.current.play();void 0!==e&&e.catch(e=>console.error("Play error:",e))}u(t),m(!0),r({type:"success",message:" Camera started successfully"})}catch(e){console.error("Error accessing camera:",e);const t="NotAllowedError"===e.name?"Camera permission denied. Please allow camera access.":"NotFoundError"===e.name?"No camera found. Please check your device.":"Failed to start camera";v(t),r({type:"error",message:t})}}),className:"py-2 px-4 rounded-lg font-medium transition text-white "+(p?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"),children:p?" Stop Camera":" Start Camera"}),Nt.jsx("button",{onClick:A?()=>{E&&A&&(E.stop(),C(!1),k(0))}:()=>{if(d){P.current=[];try{R.bitrate;const e=["video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm","video/mp4"];let t=null;for(const r of e)if(MediaRecorder.isTypeSupported(r)){t=r;break}if(!t)return void r({type:"error",message:"Browser does not support video recording"});const n=new MediaRecorder(d,{mimeType:t});n.ondataavailable=e=>{e.data.size>0&&P.current.push(e.data)},n.onstop=()=>{const e=new Blob(P.current,{type:t}),n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=`cockfight-${j}-${(new Date).getTime()}.webm`,a.click(),r({type:"success",message:" Recording saved"})},n.start(),T(n),C(!0),k(0),r({type:"success",message:" Recording started"})}catch(e){console.error("Error starting recording:",e),r({type:"error",message:"Failed to start recording"})}}else r({type:"error",message:"Camera not active"})},disabled:!p,className:"py-2 px-4 rounded-lg font-medium transition text-white "+(A?"bg-orange-600 hover:bg-orange-700":"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"),children:A?" Stop Recording":" Record"}),Nt.jsx("button",{onClick:()=>{if(!i.current||!s.current)return;const e=s.current.getContext("2d"),t=i.current;s.current.width=t.videoWidth,s.current.height=t.videoHeight,e.drawImage(t,0,0),s.current.toBlob(e=>{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`cockfight-screenshot-${(new Date).getTime()}.png`,n.click(),r({type:"success",message:" Screenshot saved"})})},disabled:!p,className:"py-2 px-4 rounded-lg font-medium bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white transition",children:" Screenshot"}),Nt.jsx("button",{onClick:H,disabled:!p,className:"py-2 px-4 rounded-lg font-medium bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed text-white transition",children:" Fullscreen"})]})]})]}),O&&Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6 mb-6",children:[Nt.jsx("h2",{className:"text-xl font-bold mb-4 "+(a?"text-white":"text-gray-900"),children:" Stream Settings"}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Video Quality"}),Nt.jsxs("select",{value:R.quality,onChange:e=>I(c(l({},R),{quality:e.target.value})),className:"w-full px-3 py-2 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:[Nt.jsx("option",{value:"480",children:"480p"}),Nt.jsx("option",{value:"720",children:"720p (HD)"}),Nt.jsx("option",{value:"1080",children:"1080p (Full HD)"})]})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Frame Rate (fps)"}),Nt.jsx("input",{type:"number",value:R.frameRate,onChange:e=>I(c(l({},R),{frameRate:parseInt(e.target.value)})),min:"15",max:"60",step:"5",className:"w-full px-3 py-2 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900")})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Bitrate (kbps)"}),Nt.jsx("input",{type:"number",value:R.bitrate,onChange:e=>I(c(l({},R),{bitrate:parseInt(e.target.value)})),min:"1000",max:"5000",step:"500",className:"w-full px-3 py-2 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900")})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("input",{type:"checkbox",checked:R.broadcast,onChange:e=>I(c(l({},R),{broadcast:e.target.checked})),id:"broadcast-checkbox",className:"rounded"}),Nt.jsx("label",{htmlFor:"broadcast-checkbox",className:"text-sm font-medium "+(a?"text-gray-300":"text-gray-700"),children:"Enable Public Broadcast"})]})]})]}),Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6",children:[Nt.jsx("h2",{className:"text-lg font-bold mb-4 "+(a?"text-white":"text-gray-900"),children:" Camera Information"}),Nt.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm "+(a?"text-gray-300":"text-gray-600"),children:[Nt.jsxs("div",{children:[Nt.jsx("span",{className:"font-semibold",children:"Status"}),Nt.jsx("p",{className:p?"text-green-600 font-bold":"text-gray-500",children:p?" Active":" Inactive"})]}),Nt.jsxs("div",{children:[Nt.jsx("span",{className:"font-semibold",children:"Recording"}),Nt.jsx("p",{className:A?"text-red-600 font-bold":"text-gray-500",children:A?` ${z(M)}`:" Off"})]}),Nt.jsxs("div",{children:[Nt.jsx("span",{className:"font-semibold",children:"Quality"}),Nt.jsxs("p",{children:[R.quality,"p"]})]}),Nt.jsxs("div",{children:[Nt.jsx("span",{className:"font-semibold",children:"Frame Rate"}),Nt.jsxs("p",{children:[R.frameRate," fps"]})]})]})]})]}),Nt.jsx("canvas",{ref:s,className:"hidden"})]})}function $te(){var e;const{settings:t,user:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),i=f.useRef(null),s=f.useRef(null);f.useRef(null);const o=f.useRef(null),[l,c]=f.useState(null),[d,u]=f.useState(!1),[p,m]=f.useState(null),[g,x]=f.useState([]),[y,v]=f.useState(""),[b,w]=f.useState(null),[N,S]=f.useState(null);f.useEffect(()=>{h(null,null,function*(){try{const e=(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);x(e),e.length>0&&v(e[0].deviceId)}catch(e){console.error("Error getting cameras:",e),m("Failed to access camera list")}})},[]),f.useEffect(()=>{if(!i.current||!l)return;console.log(" Setting stream to video element..."),i.current.srcObject=l;const e=i.current.play();void 0!==e&&e.then(()=>{console.log(" Video playing successfully")}).catch(e=>{console.error(" Auto-play failed:",e),setTimeout(()=>{var e;(null==(e=i.current)?void 0:e.srcObject)===l&&i.current.play().catch(e=>{console.error(" Retry failed:",e)})},500)})},[l]);return Nt.jsxs("div",{className:`min-h-screen ${a?"bg-gray-900":"bg-gray-50"} p-4 md:p-6`,children:[Nt.jsxs("div",{className:"max-w-6xl mx-auto",children:[Nt.jsx("div",{className:"mb-6",children:Nt.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Nt.jsx(Y,{size:32,className:"text-red-600"}),Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold "+(a?"text-white":"text-gray-900"),children:" Betting Capture Screen"}),Nt.jsxs("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:["Full screen capture with Meron/Wala labels - Deployed by: ",(null==n?void 0:n.name)||(null==n?void 0:n.username)]})]})]})}),Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Nt.jsx("div",{className:"lg:col-span-2",children:Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg overflow-hidden",children:[Nt.jsx("div",{className:"relative bg-black w-full aspect-video flex items-center justify-center",children:b?Nt.jsx("img",{src:b,alt:"Capture",style:{width:"100%",height:"100%",objectFit:"contain"}}):d?Nt.jsx("video",{ref:i,autoPlay:!0,muted:!0,playsInline:!0,disablePictureInPicture:!0,style:{display:"block",width:"100%",height:"100%",objectFit:"cover",backgroundColor:"#000"}}):Nt.jsxs("div",{className:"text-center",children:[Nt.jsx(Y,{size:64,className:"text-gray-600 mx-auto mb-4"}),Nt.jsx("p",{className:"text-gray-500 text-lg",children:"Camera not active"}),Nt.jsx("p",{className:"text-gray-600 text-sm mt-2",children:'Click "Start Camera" to begin'})]})}),b&&N&&Nt.jsx("div",{className:"p-4 "+(a?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("div",{className:"flex items-center justify-between",children:[Nt.jsx("span",{className:"px-4 py-2 rounded-lg font-bold text-white "+("meron"===N?"bg-red-600":"bg-blue-600"),children:"meron"===N?" MERON":" WALA"}),Nt.jsx("span",{className:"text-sm "+(a?"text-gray-300":"text-gray-600"),children:(new Date).toLocaleString()})]})})]})}),Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6",children:[Nt.jsx("h2",{className:"text-xl font-bold mb-4 "+(a?"text-white":"text-gray-900"),children:"Controls"}),p&&Nt.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-lg text-red-800 dark:text-red-200 text-sm",children:p}),Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Select Camera"}),Nt.jsx("select",{value:y,onChange:e=>v(e.target.value),disabled:d,className:`w-full px-3 py-2 rounded-lg border ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} disabled:opacity-50 text-sm`,children:g.map(e=>Nt.jsx("option",{value:e.deviceId,children:e.label||`Camera ${g.indexOf(e)+1}`},e.deviceId))})]}),Nt.jsxs("div",{className:"flex gap-2 mb-4",children:[Nt.jsx("button",{onClick:()=>h(null,null,function*(){try{m(null),console.log(" Starting camera with device:",y);const e={video:{deviceId:y?{exact:y}:void 0,width:{ideal:1920},frameRate:{ideal:30}},audio:!1},t=yield navigator.mediaDevices.getUserMedia(e);if(console.log(" Media stream acquired"),o.current=t,i.current){i.current.srcObject=t;const e=i.current.play();void 0!==e&&e.catch(e=>console.error("Play error:",e))}c(t),u(!0),r({type:"success",message:" Camera started successfully"})}catch(e){console.error("Error accessing camera:",e);const t="NotAllowedError"===e.name?"Camera permission denied. Please allow camera access.":"NotFoundError"===e.name?"No camera found. Please check your device.":"Failed to start camera";m(t),r({type:"error",message:t})}}),disabled:d,className:"flex-1 px-4 py-2 rounded-lg font-medium transition text-white "+(d?"bg-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:"Start"}),Nt.jsx("button",{onClick:()=>{o.current&&(o.current.getTracks().forEach(e=>e.stop()),o.current=null),i.current&&(i.current.srcObject=null),c(null),u(!1),w(null),r({type:"info",message:" Camera stopped"})},disabled:!d,className:"flex-1 px-4 py-2 rounded-lg font-medium transition text-white "+(d?"bg-red-600 hover:bg-red-700":"bg-gray-500 cursor-not-allowed"),children:"Stop"})]}),d&&!b&&Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Select Bet"}),Nt.jsxs("div",{className:"flex gap-2 mb-3",children:[Nt.jsx("button",{onClick:()=>S("meron"),className:"flex-1 px-4 py-3 rounded-lg font-bold transition text-white "+("meron"===N?"bg-red-600 ring-2 ring-red-400":"bg-red-500 hover:bg-red-600"),children:" MERON"}),Nt.jsx("button",{onClick:()=>S("wala"),className:"flex-1 px-4 py-3 rounded-lg font-bold transition text-white "+("wala"===N?"bg-blue-600 ring-2 ring-blue-400":"bg-blue-500 hover:bg-blue-600"),children:" WALA"})]}),Nt.jsxs("button",{onClick:()=>{if(!i.current)return void r({type:"error",message:"Camera not active"});const e=s.current,t=i.current,n=e.getContext("2d");if(e.width=t.videoWidth,e.height=t.videoHeight,n.drawImage(t,0,0),N){n.fillStyle="meron"===N?"rgba(220, 38, 38, 0.85)":"rgba(37, 99, 235, 0.85)";const t=.05*e.height,r=.15*e.height;n.fillRect(0,t,e.width,r),n.font=`bold ${.12*e.height}px Arial`,n.fillStyle="white",n.textAlign="center",n.textBaseline="middle";const a="meron"===N?"MERON":"WALA";n.fillText(a,e.width/2,t+r/2),n.font=.04*e.height+"px Arial",n.fillStyle="rgba(255, 255, 255, 0.9)",n.textAlign="right";const i=(new Date).toLocaleTimeString();n.fillText(i,e.width-20,e.height-20)}const a=e.toDataURL("image/png");w(a),r({type:"success",message:" Screenshot captured"})},disabled:!N||b,className:"w-full px-4 py-3 rounded-lg font-bold transition text-white flex items-center justify-center gap-2 "+(!N||b?"bg-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"),children:[Nt.jsx(Y,{size:20}),"Capture"]})]}),b&&Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>{if(!b)return void r({type:"error",message:"No capture available"});const e=document.createElement("a");e.href=b,e.download=`cockfight-${N}-${(new Date).getTime()}.png`,e.click(),r({type:"success",message:" Image saved"})},className:"flex-1 px-4 py-3 rounded-lg font-bold transition text-white bg-green-600 hover:bg-green-700 flex items-center justify-center gap-2",children:[Nt.jsx(E,{size:20}),"Download"]}),Nt.jsxs("button",{onClick:()=>{w(null),S(null)},className:"flex-1 px-4 py-3 rounded-lg font-bold transition text-white bg-gray-600 hover:bg-gray-700 flex items-center justify-center gap-2",children:[Nt.jsx(Fe,{size:20}),"Reset"]})]}),Nt.jsxs("div",{className:"mt-4 p-4 rounded-lg text-sm "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsxs("p",{className:""+(a?"text-gray-300":"text-gray-600"),children:[Nt.jsx("strong",{children:"MERON:"})," The favorite side - typically gets smaller payout"]}),Nt.jsxs("p",{className:(a?"text-gray-300":"text-gray-600")+" mt-2",children:[Nt.jsx("strong",{children:"WALA:"})," The underdog side - typically gets larger payout"]})]})]})]})]}),Nt.jsx("canvas",{ref:s,style:{display:"none"}})]})}var Wte,Yte,Xte=Object.defineProperty,Kte=Object.getOwnPropertySymbols,qte=Object.prototype.hasOwnProperty,Jte=Object.prototype.propertyIsEnumerable,Qte=(e,t,n)=>t in e?Xte(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Zte=(e,t)=>{for(var n in t||(t={}))qte.call(t,n)&&Qte(e,n,t[n]);if(Kte)for(var n of Kte(t))Jte.call(t,n)&&Qte(e,n,t[n]);return e},ene=(e,t)=>{var n={};for(var r in e)qte.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Kte)for(var r of Kte(e))t.indexOf(r)<0&&Jte.call(e,r)&&(n[r]=e[r]);return n};(e=>{const t=class t{constructor(e,n,r,i){if(this.version=e,this.errorCorrectionLevel=n,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=4*e+17;let s=[];for(let t=0;t<this.size;t++)s.push(!1);for(let t=0;t<this.size;t++)this.modules.push(s.slice()),this.isFunction.push(s.slice());this.drawFunctionPatterns();const o=this.addEccAndInterleave(r);if(this.drawCodewords(o),-1==i){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const n=this.getPenaltyScore();n<e&&(i=t,e=n),this.applyMask(t)}}a(0<=i&&i<=7),this.mask=i,this.applyMask(i),this.drawFormatBits(i),this.isFunction=[]}static encodeText(n,r){const a=e.QrSegment.makeSegments(n);return t.encodeSegments(a,r)}static encodeBinary(n,r){const a=e.QrSegment.makeBytes(n);return t.encodeSegments([a],r)}static encodeSegments(e,r,i=1,o=40,l=-1,c=!0){if(!(t.MIN_VERSION<=i&&i<=o&&o<=t.MAX_VERSION)||l<-1||l>7)throw new RangeError("Invalid value");let d,u;for(d=i;;d++){const n=8*t.getNumDataCodewords(d,r),a=s.getTotalBits(e,d);if(a<=n){u=a;break}if(d>=o)throw new RangeError("Data too long")}for(const n of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])c&&u<=8*t.getNumDataCodewords(d,n)&&(r=n);let h=[];for(const t of e){n(t.mode.modeBits,4,h),n(t.numChars,t.mode.numCharCountBits(d),h);for(const e of t.getData())h.push(e)}a(h.length==u);const p=8*t.getNumDataCodewords(d,r);a(h.length<=p),n(0,Math.min(4,p-h.length),h),n(0,(8-h.length%8)%8,h),a(h.length%8==0);for(let t=236;h.length<p;t^=253)n(t,8,h);let m=[];for(;8*m.length<h.length;)m.push(0);return h.forEach((e,t)=>m[t>>>3]|=e<<7-(7&t)),new t(d,r,m,l)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let n=0;n<this.size;n++)this.setFunctionModule(6,n,n%2==0),this.setFunctionModule(n,6,n%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let n=0;n<t;n++)for(let r=0;r<t;r++)0==n&&0==r||0==n&&r==t-1||n==t-1&&0==r||this.drawAlignmentPattern(e[n],e[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.errorCorrectionLevel.formatBits<<3|e;let n=t;for(let r=0;r<10;r++)n=n<<1^1335*(n>>>9);const i=21522^(t<<10|n);a(i>>>15==0);for(let a=0;a<=5;a++)this.setFunctionModule(8,a,r(i,a));this.setFunctionModule(8,7,r(i,6)),this.setFunctionModule(8,8,r(i,7)),this.setFunctionModule(7,8,r(i,8));for(let a=9;a<15;a++)this.setFunctionModule(14-a,8,r(i,a));for(let a=0;a<8;a++)this.setFunctionModule(this.size-1-a,8,r(i,a));for(let a=8;a<15;a++)this.setFunctionModule(8,this.size-15+a,r(i,a));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let n=0;n<12;n++)e=e<<1^7973*(e>>>11);const t=this.version<<12|e;a(t>>>18==0);for(let n=0;n<18;n++){const e=r(t,n),a=this.size-11+n%3,i=Math.floor(n/3);this.setFunctionModule(a,i,e),this.setFunctionModule(i,a,e)}}drawFinderPattern(e,t){for(let n=-4;n<=4;n++)for(let r=-4;r<=4;r++){const a=Math.max(Math.abs(r),Math.abs(n)),i=e+r,s=t+n;0<=i&&i<this.size&&0<=s&&s<this.size&&this.setFunctionModule(i,s,2!=a&&4!=a)}}drawAlignmentPattern(e,t){for(let n=-2;n<=2;n++)for(let r=-2;r<=2;r++)this.setFunctionModule(e+r,t+n,1!=Math.max(Math.abs(r),Math.abs(n)))}setFunctionModule(e,t,n){this.modules[t][e]=n,this.isFunction[t][e]=!0}addEccAndInterleave(e){const n=this.version,r=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(n,r))throw new RangeError("Invalid argument");const i=t.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][n],s=t.ECC_CODEWORDS_PER_BLOCK[r.ordinal][n],o=Math.floor(t.getNumRawDataModules(n)/8),l=i-o%i,c=Math.floor(o/i);let d=[];const u=t.reedSolomonComputeDivisor(s);for(let a=0,p=0;a<i;a++){let n=e.slice(p,p+c-s+(a<l?0:1));p+=n.length;const r=t.reedSolomonComputeRemainder(n,u);a<l&&n.push(0),d.push(n.concat(r))}let h=[];for(let t=0;t<d[0].length;t++)d.forEach((e,n)=>{(t!=c-s||n>=l)&&h.push(e[t])});return a(h.length==o),h}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let a=0;a<this.size;a++)for(let i=0;i<2;i++){const s=t-i,o=!(t+1&2)?this.size-1-a:a;!this.isFunction[o][s]&&n<8*e.length&&(this.modules[o][s]=r(e[n>>>3],7-(7&n)),n++)}}a(n==8*e.length)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let n=0;n<this.size;n++){let r;switch(e){case 0:r=(n+t)%2==0;break;case 1:r=t%2==0;break;case 2:r=n%3==0;break;case 3:r=(n+t)%3==0;break;case 4:r=(Math.floor(n/3)+Math.floor(t/2))%2==0;break;case 5:r=n*t%2+n*t%3==0;break;case 6:r=(n*t%2+n*t%3)%2==0;break;case 7:r=((n+t)%2+n*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][n]&&r&&(this.modules[t][n]=!this.modules[t][n])}}getPenaltyScore(){let e=0;for(let a=0;a<this.size;a++){let n=!1,r=0,i=[0,0,0,0,0,0,0];for(let s=0;s<this.size;s++)this.modules[a][s]==n?(r++,5==r?e+=t.PENALTY_N1:r>5&&e++):(this.finderPenaltyAddHistory(r,i),n||(e+=this.finderPenaltyCountPatterns(i)*t.PENALTY_N3),n=this.modules[a][s],r=1);e+=this.finderPenaltyTerminateAndCount(n,r,i)*t.PENALTY_N3}for(let a=0;a<this.size;a++){let n=!1,r=0,i=[0,0,0,0,0,0,0];for(let s=0;s<this.size;s++)this.modules[s][a]==n?(r++,5==r?e+=t.PENALTY_N1:r>5&&e++):(this.finderPenaltyAddHistory(r,i),n||(e+=this.finderPenaltyCountPatterns(i)*t.PENALTY_N3),n=this.modules[s][a],r=1);e+=this.finderPenaltyTerminateAndCount(n,r,i)*t.PENALTY_N3}for(let a=0;a<this.size-1;a++)for(let n=0;n<this.size-1;n++){const r=this.modules[a][n];r==this.modules[a][n+1]&&r==this.modules[a+1][n]&&r==this.modules[a+1][n+1]&&(e+=t.PENALTY_N2)}let n=0;for(const t of this.modules)n=t.reduce((e,t)=>e+(t?1:0),n);const r=this.size*this.size,i=Math.ceil(Math.abs(20*n-10*r)/r)-1;return a(0<=i&&i<=9),e+=i*t.PENALTY_N4,a(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{const e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2));let n=[6];for(let r=this.size-7;n.length<e;r-=t)n.splice(1,0,r);return n}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");let n=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;n-=(25*t-10)*t-55,e>=7&&(n-=36)}return a(208<=n&&n<=29648),n}static getNumDataCodewords(e,n){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let n=[];for(let t=0;t<e-1;t++)n.push(0);n.push(1);let r=1;for(let a=0;a<e;a++){for(let e=0;e<n.length;e++)n[e]=t.reedSolomonMultiply(n[e],r),e+1<n.length&&(n[e]^=n[e+1]);r=t.reedSolomonMultiply(r,2)}return n}static reedSolomonComputeRemainder(e,n){let r=n.map(e=>0);for(const a of e){const e=a^r.shift();r.push(0),n.forEach((n,a)=>r[a]^=t.reedSolomonMultiply(n,e))}return r}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");let n=0;for(let r=7;r>=0;r--)n=n<<1^285*(n>>>7),n^=(t>>>r&1)*e;return a(n>>>8==0),n}finderPenaltyCountPatterns(e){const t=e[1];a(t<=3*this.size);const n=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(n&&e[0]>=4*t&&e[6]>=t?1:0)+(n&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,n){return e&&(this.finderPenaltyAddHistory(t,n),t=0),t+=this.size,this.finderPenaltyAddHistory(t,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};function n(e,t,n){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(let r=t-1;r>=0;r--)n.push(e>>>r&1)}function r(e,t){return!!(e>>>t&1)}function a(e){if(!e)throw new Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;const i=class e{constructor(e,t,n){if(this.mode=e,this.numChars=t,this.bitData=n,t<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}static makeBytes(t){let r=[];for(const e of t)n(e,8,r);return new e(e.Mode.BYTE,t.length,r)}static makeNumeric(t){if(!e.isNumeric(t))throw new RangeError("String contains non-numeric characters");let r=[];for(let e=0;e<t.length;){const a=Math.min(t.length-e,3);n(parseInt(t.substring(e,e+a),10),3*a+1,r),e+=a}return new e(e.Mode.NUMERIC,t.length,r)}static makeAlphanumeric(t){if(!e.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r,a=[];for(r=0;r+2<=t.length;r+=2){let i=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r));i+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r+1)),n(i,11,a)}return r<t.length&&n(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r)),6,a),new e(e.Mode.ALPHANUMERIC,t.length,a)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let r=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)n(t,8,r);else if(t<16384)n(2,2,r),n(t,14,r);else{if(!(t<1e6))throw new RangeError("ECI assignment value out of range");n(6,3,r),n(t,21,r)}return new e(e.Mode.ECI,0,r)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let n=0;for(const r of e){const e=r.mode.numCharCountBits(t);if(r.numChars>=1<<e)return 1/0;n+=4+e+r.bitData.length}return n}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let n=0;n<e.length;n++)"%"!=e.charAt(n)?t.push(e.charCodeAt(n)):(t.push(parseInt(e.substring(n+1,n+3),16)),n+=2);return t}};i.NUMERIC_REGEX=/^[0-9]*$/,i.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,i.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let s=i;e.QrSegment=i})(Wte||(Wte={})),(e=>{const t=class{constructor(e,t){this.ordinal=e,this.formatBits=t}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})((Yte=Wte||(Wte={})).QrCode||(Yte.QrCode={})),(e=>{(e=>{const t=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Wte||(Wte={}));var tne=Wte,nne={L:tne.QrCode.Ecc.LOW,M:tne.QrCode.Ecc.MEDIUM,Q:tne.QrCode.Ecc.QUARTILE,H:tne.QrCode.Ecc.HIGH},rne=128,ane="L",ine="#FFFFFF",sne="#000000",one=!1,lne=1;
/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */function cne(e,t=0){const n=[];return e.forEach(function(e,r){let a=null;e.forEach(function(i,s){if(!i&&null!==a)return n.push(`M${a+t} ${r+t}h${s-a}v1H${a+t}z`),void(a=null);if(s!==e.length-1)i&&null===a&&(a=s);else{if(!i)return;null===a?n.push(`M${s+t},${r+t} h1v1H${s+t}z`):n.push(`M${a+t},${r+t} h${s+1-a}v1H${a+t}z`)}})}),n.join("")}function dne(e,t){return e.slice().map((e,n)=>n<t.y||n>=t.y+t.h?e:e.map((e,n)=>(n<t.x||n>=t.x+t.w)&&e))}function une({value:e,level:t,minVersion:n,includeMargin:r,marginSize:a,imageSettings:i,size:s,boostLevel:o}){let l=v.useMemo(()=>{const r=(Array.isArray(e)?e:[e]).reduce((e,t)=>(e.push(...tne.QrSegment.makeSegments(t)),e),[]);return tne.QrCode.encodeSegments(r,nne[t],n,void 0,void 0,o)},[e,t,n,o]);const{cells:c,margin:d,numCells:u,calculatedImageSettings:h}=v.useMemo(()=>{let e=l.getModules();const t=function(e,t){return null!=t?Math.max(Math.floor(t),0):e?4:0}(r,a),n=e.length+2*t,o=function(e,t,n,r){if(null==r)return null;const a=e.length+2*n,i=Math.floor(.1*t),s=a/t,o=(r.width||i)*s,l=(r.height||i)*s,c=null==r.x?e.length/2-o/2:r.x*s,d=null==r.y?e.length/2-l/2:r.y*s,u=null==r.opacity?1:r.opacity;let h=null;if(r.excavate){let e=Math.floor(c),t=Math.floor(d);h={x:e,y:t,w:Math.ceil(o+c-e),h:Math.ceil(l+d-t)}}return{x:c,y:d,h:l,w:o,excavation:h,opacity:u,crossOrigin:r.crossOrigin}}(e,s,t,i);return{cells:e,margin:t,numCells:n,calculatedImageSettings:o}},[l,s,i,r,a]);return{qrcode:l,margin:d,cells:c,numCells:u,calculatedImageSettings:h}}var hne=function(){try{(new Path2D).addPath(new Path2D)}catch(bI){return!1}return!0}(),pne=v.forwardRef(function(e,t){const n=e,{value:r,size:a=rne,level:i=ane,bgColor:s=ine,fgColor:o=sne,includeMargin:l=one,minVersion:c=lne,boostLevel:d,marginSize:u,imageSettings:h}=n,p=ene(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:m}=p,g=ene(p,["style"]),f=null==h?void 0:h.src,x=v.useRef(null),y=v.useRef(null),b=v.useCallback(e=>{x.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]),[w,N]=v.useState(!1),{margin:S,cells:j,numCells:_,calculatedImageSettings:A}=une({value:r,level:i,minVersion:c,boostLevel:d,includeMargin:l,marginSize:u,imageSettings:h,size:a});v.useEffect(()=>{if(null!=x.current){const e=x.current,t=e.getContext("2d");if(!t)return;let n=j;const r=y.current,i=null!=A&&null!==r&&r.complete&&0!==r.naturalHeight&&0!==r.naturalWidth;i&&null!=A.excavation&&(n=dne(j,A.excavation));const l=window.devicePixelRatio||1;e.height=e.width=a*l;const c=a/_*l;t.scale(c,c),t.fillStyle=s,t.fillRect(0,0,_,_),t.fillStyle=o,hne?t.fill(new Path2D(cne(n,S))):j.forEach(function(e,n){e.forEach(function(e,r){e&&t.fillRect(r+S,n+S,1,1)})}),A&&(t.globalAlpha=A.opacity),i&&t.drawImage(r,A.x+S,A.y+S,A.w,A.h)}}),v.useEffect(()=>{N(!1)},[f]);const C=Zte({height:a,width:a},m);let M=null;return null!=f&&(M=v.createElement("img",{src:f,key:f,style:{display:"none"},onLoad:()=>{N(!0)},ref:y,crossOrigin:null==A?void 0:A.crossOrigin})),v.createElement(v.Fragment,null,v.createElement("canvas",Zte({style:C,height:a,width:a,ref:b,role:"img"},g)),M)});pne.displayName="QRCodeCanvas";var mne=v.forwardRef(function(e,t){const n=e,{value:r,size:a=rne,level:i=ane,bgColor:s=ine,fgColor:o=sne,includeMargin:l=one,minVersion:c=lne,boostLevel:d,title:u,marginSize:h,imageSettings:p}=n,m=ene(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:g,cells:f,numCells:x,calculatedImageSettings:y}=une({value:r,level:i,minVersion:c,boostLevel:d,includeMargin:l,marginSize:h,imageSettings:p,size:a});let b=f,w=null;null!=p&&null!=y&&(null!=y.excavation&&(b=dne(f,y.excavation)),w=v.createElement("image",{href:p.src,height:y.h,width:y.w,x:y.x+g,y:y.y+g,preserveAspectRatio:"none",opacity:y.opacity,crossOrigin:y.crossOrigin}));const N=cne(b,g);return v.createElement("svg",Zte({height:a,width:a,viewBox:`0 0 ${x} ${x}`,ref:t,role:"img"},m),!!u&&v.createElement("title",null,u),v.createElement("path",{fill:s,d:`M0,0 h${x}v${x}H0z`,shapeRendering:"crispEdges"}),v.createElement("path",{fill:o,d:N,shapeRendering:"crispEdges"}),w)});mne.displayName="QRCodeSVG";const gne=Object.freeze(Object.defineProperty({__proto__:null,QRCodeCanvas:pne,QRCodeSVG:mne},Symbol.toStringTag,{value:"Module"}));function fne(){var e;const{settings:t,user:n}=f.useContext($c),{showToast:r}=Kc(),a="dark"===(null==(e=null==t?void 0:t.theme)?void 0:e.mode),i=f.useRef(null),s=f.useRef(null),o=f.useRef(null),l=f.useRef(null),c=f.useRef(null),[d,u]=f.useState("select"),[p,m]=f.useState(""),[g,x]=f.useState(!1),[y,v]=f.useState(!1),[b,w]=f.useState(null),[N,S]=f.useState(null),[j,_]=f.useState([]),[A,C]=f.useState(""),[M,k]=f.useState(null),[E,T]=f.useState(null),[P,D]=f.useState("medium");f.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("broadcast");e&&(console.log(` Auto-detecting broadcast code: ${e}`),m(e),u("viewer"),r({type:"info",message:" Auto-joining broadcast..."}));h(null,null,function*(){try{const e=(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);_(e),e.length>0&&C(e[0].deviceId)}catch(e){console.error("Error getting cameras:",e),S("Failed to access camera list")}})},[]);const R=(e,t=!0)=>{try{const a="https:"===window.location.protocol?"wss:":"ws:",i=`${a}${zc().replace(/^https?:/,"").replace(/\/$/,"").split("/")[2]}/ws/camera/${e}`;console.log(` Connecting to WebSocket: ${i}`);const s=setTimeout(()=>{console.log(" WebSocket connection timeout - using local mode"),l.current=null,v(!0),r(t?{type:"warning",message:" Broadcasting in local mode (no backend)"}:{type:"warning",message:" Backend unavailable - manual code entry needed"})},3e3);l.current=new WebSocket(i),l.current.onopen=()=>{clearTimeout(s),console.log(" WebSocket connected"),v(!0),l.current.send(JSON.stringify({type:"init",role:t?"broadcaster":"viewer",user:(null==n?void 0:n.name)||(null==n?void 0:n.username)})),r({type:"success",message:` Connected to broadcast ${e}`})},l.current.onmessage=e=>{try{const t=JSON.parse(e.data);"frame"!==t.type||g?"status"===t.type&&console.log(" Status:",t.data):T(`data:image/jpeg;base64,${t.data}`)}catch(t){console.error("Error parsing message:",t)}},l.current.onerror=e=>{clearTimeout(s),console.error(" WebSocket error:",e),v(!1),t&&(console.log(" Switching to local broadcast mode"),l.current=null,v(!0),r({type:"warning",message:" Broadcasting locally (backend unavailable)"}))},l.current.onclose=()=>{clearTimeout(s),console.log(" WebSocket disconnected"),v(!1),t||r({type:"info",message:"Broadcast ended"})}}catch(a){console.error("Error setting up WebSocket:",a),r({type:"error",message:"Failed to connect to stream server"})}},I=()=>{if(!i.current||!l.current||l.current.readyState!==WebSocket.OPEN)return void(c.current=setTimeout(I,"high"===P?200:"medium"===P?300:500));const e=s.current,t=i.current,n=e.getContext("2d"),r="high"===P?1:"medium"===P?.75:.5;e.width=(t.videoWidth||1280)*r,e.height=(t.videoHeight||720)*r,n.drawImage(t,0,0,e.width,e.height);const a="high"===P?.8:"medium"===P?.6:.4;e.toBlob(e=>{if(!e)return;const t=new FileReader;t.onload=()=>{const e={type:"frame",data:t.result.split(",")[1],timestamp:Date.now()};l.current&&l.current.readyState===WebSocket.OPEN?l.current.send(JSON.stringify(e)):"undefined"!=typeof window&&window.sessionStorage&&sessionStorage.setItem(`broadcast_${broadcastIdRef.current}`,JSON.stringify(e))},t.readAsDataURL(e)},"image/jpeg",a);const o="high"===P?100:"medium"===P?150:300;c.current=setTimeout(I,o)},O=e=>{const t=setInterval(()=>{if("undefined"!=typeof window&&window.sessionStorage){const n=sessionStorage.getItem(`broadcast_${e}`);if(n)try{const e=JSON.parse(n);e.data&&T(`data:image/jpeg;base64,${e.data}`)}catch(t){console.error("Error parsing frame:",t)}}},100);c.current&&clearInterval(c.current),c.current=t},L=()=>{o.current&&(o.current.getTracks().forEach(e=>e.stop()),o.current=null),i.current&&(i.current.srcObject=null),c.current&&clearTimeout(c.current),l.current&&l.current.readyState===WebSocket.OPEN&&l.current.close(),w(null),x(!1),v(!1),u("select"),m(""),T(null),r({type:"info",message:" Stream stopped"})};return Nt.jsxs("div",{className:`min-h-screen ${a?"bg-gray-900":"bg-gray-50"} p-4 md:p-6`,children:[Nt.jsxs("div",{className:"max-w-6xl mx-auto",children:[Nt.jsx("div",{className:"mb-6",children:Nt.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Nt.jsx(q,{size:32,className:y?"text-green-600":"text-gray-400"}),Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-3xl font-bold "+(a?"text-white":"text-gray-900"),children:" Stream Camera Broadcaster"}),Nt.jsx("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:"Broadcast Android phone camera to other devices"})]})]})}),"select"===d&&Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6 cursor-pointer hover:shadow-xl transition",onClick:()=>u("setup-broadcast"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("h2",{className:"text-2xl font-bold "+(a?"text-white":"text-gray-900"),children:" Broadcast Camera"}),Nt.jsx("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:"Start streaming from this device"})]}),Nt.jsx(B,{size:40,className:"text-blue-500"})]}),Nt.jsxs("ul",{className:"text-sm space-y-2 "+(a?"text-gray-300":"text-gray-600"),children:[Nt.jsx("li",{children:" Share camera with other devices"}),Nt.jsx("li",{children:" Get unique broadcast code"}),Nt.jsx("li",{children:" Real-time video streaming"})]})]}),Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6 cursor-pointer hover:shadow-xl transition",onClick:()=>u("setup-viewer"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("h2",{className:"text-2xl font-bold "+(a?"text-white":"text-gray-900"),children:" Watch Stream"}),Nt.jsx("p",{className:"text-sm "+(a?"text-gray-400":"text-gray-600"),children:"View someone else's camera"})]}),Nt.jsx(ye,{size:40,className:"text-green-500"})]}),Nt.jsxs("ul",{className:"text-sm space-y-2 "+(a?"text-gray-300":"text-gray-600"),children:[Nt.jsx("li",{children:" Enter broadcast code"}),Nt.jsx("li",{children:" Live view from remote camera"}),Nt.jsx("li",{children:" No camera required"})]})]})]}),"setup-broadcast"===d&&!g&&Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6 max-w-2xl",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsx("h2",{className:"text-2xl font-bold "+(a?"text-white":"text-gray-900"),children:" Setup Broadcast"}),Nt.jsx("button",{onClick:()=>u("select"),className:"text-gray-500 hover:text-gray-700",children:""})]}),N&&Nt.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-lg text-red-800 dark:text-red-200",children:N}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Select Camera"}),Nt.jsx("select",{value:A,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:j.map(e=>Nt.jsx("option",{value:e.deviceId,children:e.label||`Camera ${j.indexOf(e)+1}`},e.deviceId))})]}),Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Stream Quality"}),Nt.jsxs("select",{value:P,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 rounded-lg border "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:[Nt.jsx("option",{value:"low",children:"Low (Fast, mobile friendly)"}),Nt.jsx("option",{value:"medium",children:"Medium (Balanced)"}),Nt.jsx("option",{value:"high",children:"High (Best quality, more bandwidth)"})]})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){try{S(null);const e=Math.random().toString(36).substring(2,15).toUpperCase();m(e),R(e,!0);const t={video:{deviceId:A?{exact:A}:void 0,width:{ideal:1280},frameRate:{ideal:15}},audio:!1},n=yield navigator.mediaDevices.getUserMedia(t);o.current=n,i.current&&(i.current.srcObject=n,i.current.play().catch(e=>console.error("Play error:",e))),w(n),x(!0),u("broadcast"),r({type:"success",message:` Broadcasting started (ID: ${e})`}),I()}catch(e){console.error("Error starting broadcast:",e);const t="NotAllowedError"===e.name?"Camera permission denied":"Failed to start camera";S(t),r({type:"error",message:t})}}),className:"flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition flex items-center justify-center gap-2",children:[Nt.jsx(lt,{size:20}),"Start Broadcasting"]}),Nt.jsx("button",{onClick:()=>u("select"),className:"flex-1 px-4 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition",children:"Cancel"})]})]})]}),"broadcast"===d&&g&&Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Nt.jsx("div",{className:"lg:col-span-2",children:Nt.jsx("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg overflow-hidden",children:Nt.jsxs("div",{className:"relative bg-black aspect-video",children:[Nt.jsx("video",{ref:i,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover",backgroundColor:"#000"}}),Nt.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-red-600 text-white px-3 py-1 rounded-full animate-pulse",children:[Nt.jsx("div",{className:"w-2 h-2 bg-white rounded-full"}),Nt.jsx("span",{className:"font-semibold",children:"BROADCASTING"})]}),Nt.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 bg-black/50 text-white px-3 py-1 rounded-full",children:[Nt.jsx(q,{size:16,className:y?"text-green-400":"text-red-400"}),Nt.jsx("span",{className:"text-sm",children:y?"Connected":"Connecting..."})]})]})})}),Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6",children:[Nt.jsx("h3",{className:"text-lg font-bold mb-4 "+(a?"text-white":"text-gray-900"),children:" Broadcast ID"}),Nt.jsx("div",{className:"mb-4",children:Nt.jsx("div",{className:"p-4 rounded-lg text-center font-mono font-bold text-xl "+(a?"bg-gray-700 text-blue-300":"bg-blue-50 text-blue-600"),children:p})}),p&&Nt.jsxs("div",{className:"mb-4 p-4 rounded-lg bg-white flex flex-col items-center",children:[Nt.jsx("p",{className:"text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Scan to join broadcast:"}),Nt.jsx(gne,{value:`${window.location.origin}${window.location.pathname}?broadcast=${p}`,size:200,level:"H",includeMargin:!0})]}),Nt.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(p),r({type:"success",message:" Broadcast ID copied!"})},className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition flex items-center justify-center gap-2 mb-4",children:[Nt.jsx(Ge,{size:18}),"Copy ID"]}),Nt.jsxs("div",{className:"p-4 rounded-lg mb-4 "+(a?"bg-gray-700":"bg-gray-100"),children:[Nt.jsx("p",{className:"text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Share Options:"}),Nt.jsxs("ul",{className:"text-sm space-y-1 "+(a?"text-gray-400":"text-gray-600"),children:[Nt.jsx("li",{children:" Show QR code to viewers to scan"}),Nt.jsx("li",{children:" Copy & share broadcast ID"}),Nt.jsx("li",{children:' Viewers enter ID in "Watch Stream"'})]})]}),Nt.jsxs("button",{onClick:L,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition flex items-center justify-center gap-2",children:[Nt.jsx(tt,{size:18}),"Stop Broadcasting"]})]})]}),"setup-viewer"===d&&Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6 max-w-2xl",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsx("h2",{className:"text-2xl font-bold "+(a?"text-white":"text-gray-900"),children:" Join Broadcast"}),Nt.jsx("button",{onClick:()=>u("select"),className:"text-gray-500 hover:text-gray-700",children:""})]}),Nt.jsxs("div",{className:"space-y-4",children:[Nt.jsxs("div",{children:[Nt.jsx("label",{className:"block text-sm font-medium mb-2 "+(a?"text-gray-300":"text-gray-700"),children:"Broadcast ID"}),Nt.jsx("input",{type:"text",value:p,onChange:e=>m(e.target.value.toUpperCase()),placeholder:"Enter broadcast code here...",className:"w-full px-4 py-2 rounded-lg border text-lg font-mono tracking-widest "+(a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900")})]}),Nt.jsx("div",{className:"p-4 rounded-lg "+(a?"bg-gray-700":"bg-blue-50"),children:Nt.jsx("p",{className:"text-sm "+(a?"text-gray-300":"text-blue-800"),children:" Ask the broadcaster to share their ID with you"})}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsxs("button",{onClick:()=>h(null,null,function*(){if(p.trim())try{R(p.toUpperCase(),!1),O(p.toUpperCase()),u("viewer"),r({type:"info",message:" Connecting to broadcast..."})}catch(e){console.error("Error joining broadcast:",e),r({type:"error",message:"Failed to join broadcast"})}else r({type:"error",message:"Please enter broadcast ID"})}),disabled:!p.trim(),className:"flex-1 px-4 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-500 text-white font-bold rounded-lg transition flex items-center justify-center gap-2",children:[Nt.jsx(ye,{size:20}),"Join Broadcast"]}),Nt.jsx("button",{onClick:()=>u("select"),className:"flex-1 px-4 py-3 bg-gray-500 hover:bg-gray-600 text-white font-bold rounded-lg transition",children:"Cancel"})]})]})]}),"viewer"===d&&Nt.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Nt.jsx("div",{className:"lg:col-span-2",children:Nt.jsx("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg overflow-hidden",children:Nt.jsx("div",{className:"relative bg-black aspect-video flex items-center justify-center",children:E?Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("img",{src:E,alt:"Stream",style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"#000"}}),Nt.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-green-600 text-white px-3 py-1 rounded-full animate-pulse",children:[Nt.jsx("div",{className:"w-2 h-2 bg-white rounded-full"}),Nt.jsx("span",{className:"font-semibold",children:"LIVE"})]})]}):Nt.jsxs("div",{className:"text-center",children:[Nt.jsx(q,{size:64,className:"text-gray-600 mx-auto mb-4"}),Nt.jsx("p",{className:"text-gray-500 text-lg",children:"Waiting for stream..."}),Nt.jsx("p",{className:"text-gray-600 text-sm mt-2",children:y?"Connected, waiting for broadcaster":"Connecting..."})]})})})}),Nt.jsxs("div",{className:(a?"bg-gray-800":"bg-white")+" rounded-lg shadow-lg p-6",children:[Nt.jsx("h3",{className:"text-lg font-bold mb-4 "+(a?"text-white":"text-gray-900"),children:" Connection"}),Nt.jsxs("div",{className:"space-y-3 mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm font-medium "+(a?"text-gray-300":"text-gray-700"),children:"Broadcast ID"}),Nt.jsx("p",{className:"font-mono text-lg font-bold text-blue-600",children:p})]}),Nt.jsxs("div",{children:[Nt.jsx("p",{className:"text-sm font-medium "+(a?"text-gray-300":"text-gray-700"),children:"Status"}),Nt.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Nt.jsx("div",{className:`w-3 h-3 rounded-full ${y?"bg-green-500":"bg-red-500"} animate-pulse`}),Nt.jsx("span",{className:y?"text-green-600":"text-red-600",children:y?"Connected":"Disconnected"})]})]}),!l.current&&y&&Nt.jsx("div",{className:"p-3 rounded-lg text-sm "+(a?"bg-yellow-900/30 border border-yellow-700":"bg-yellow-50 border border-yellow-200"),children:Nt.jsx("p",{className:a?"text-yellow-200":"text-yellow-800",children:" Using local fallback mode. Make sure broadcaster is on same network."})})]}),Nt.jsxs("button",{onClick:L,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition flex items-center justify-center gap-2",children:[Nt.jsx(ct,{size:18}),"Disconnect"]})]})]})]}),Nt.jsx("canvas",{ref:s,style:{display:"none"}})]})}function xne(){var e,t;const{isDarkMode:n}=f.useContext($c),r=y(),[a,i]=f.useState({currentFight:null,fights:[],bets:[],entries:[],bettingStatus:"open",externalTotalBets:0,externalTotalAmount:0,lastUpdate:null}),[s,o]=f.useState(!0),[l,c]=f.useState(""),[d,u]=f.useState(new Date),p=e=>{const t=parseFloat(e)||0;return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:`${t.toLocaleString()}`};f.useEffect(()=>{const e=localStorage.getItem("token");if(!e)return console.log("No token found, redirecting to login"),void r("/login");h(null,null,function*(){try{yield pt.get(`${zc()}/api/auth/verify`,{headers:{Authorization:`Bearer ${e}`}})}catch(t){return console.log("Token invalid, redirecting to login"),localStorage.removeItem("token"),void r("/login")}})},[r]),f.useEffect(()=>{const e=setInterval(()=>{u(new Date)},1e3);return()=>clearInterval(e)},[]);const m=()=>h(null,null,function*(){try{const e={Authorization:`Bearer ${localStorage.getItem("token")}`},[t,n,r]=yield Promise.all([pt.get(`${zc()}/api/chicken-fight/fights/today`,{headers:e}),pt.get(`${zc()}/api/chicken-fight/bets?gameDate=${(new Date).toISOString().split("T")[0]}`,{headers:e}),pt.get(`${zc()}/api/chicken-fight/entries`,{headers:e})]);i({currentFight:t.data.fightNumber||0,fights:t.data.fights||[],bets:n.data.bets||[],entries:r.data.entries||[],lastUpdate:new Date})}catch(e){if(console.error("Failed to load live data:",e),e.response&&401===e.response.status)return console.log("Authentication failed, redirecting to login"),localStorage.removeItem("token"),void r("/login");c("Failed to load live data")}finally{o(!1)}});f.useEffect(()=>{m();const e=Vc();if(e)return e.on("chickenFightUpdated",e=>{console.log(" Live chicken fight update:",e),i({currentFight:e.currentFight||0,fights:e.fights||[],bets:e.bets||[],entries:e.entries||[],bettingStatus:e.bettingStatus||"open",externalTotalBets:e.externalTotalBets||0,externalTotalAmount:e.externalTotalAmount||0,lastUpdate:new Date})}),()=>{e.off("chickenFightUpdated")}},[]),f.useEffect(()=>{const e=setInterval(()=>{h(null,null,function*(){try{const e={Authorization:`Bearer ${localStorage.getItem("token")}`},[t,n,r]=yield Promise.all([pt.get(`${zc()}/api/chicken-fight/fights/today`,{headers:e}),pt.get(`${zc()}/api/chicken-fight/bets?gameDate=${(new Date).toISOString().split("T")[0]}`,{headers:e}),pt.get(`${zc()}/api/chicken-fight/entries`,{headers:e})]);i({currentFight:t.data.fightNumber||0,fights:t.data.fights||[],bets:n.data.bets||[],entries:r.data.entries||[],lastUpdate:new Date})}catch(e){console.error("Failed to update live data:",e)}})},5e3);return()=>clearInterval(e)},[]);const g=(()=>{const e=a.bets.length,t=a.bets.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),n=a.bets.filter(e=>"meron"===e.side),r=a.bets.filter(e=>"wala"===e.side);return{totalBets:e,totalAmount:t,meronCount:n.length,walaCount:r.length,meronAmount:n.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),walaAmount:r.reduce((e,t)=>e+(parseFloat(t.amount)||0),0)}})();return s?Nt.jsx("div",{className:"flex items-center justify-center min-h-screen",children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),Nt.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading live data..."})]})}):l?Nt.jsx("div",{className:"flex items-center justify-center min-h-screen",children:Nt.jsxs("div",{className:"text-center text-red-600",children:[Nt.jsx("p",{className:"text-lg font-semibold mb-2",children:"Connection Error"}),Nt.jsx("p",{children:l})]})}):Nt.jsx("div",{className:"min-h-screen p-6 "+(n?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"),children:Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsx(sd,{children:Nt.jsxs("div",{className:"mb-8",children:[Nt.jsx("h1",{className:"text-3xl font-bold mb-2",children:" Live Chicken Fight Dashboard"}),Nt.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[Nt.jsxs("span",{children:["Current Fight: #",a.currentFight||"None"]}),Nt.jsx("span",{children:""}),Nt.jsxs("span",{children:["Last Update: ",null==(e=a.lastUpdate)?void 0:e.toLocaleTimeString()]}),Nt.jsx("span",{children:""}),Nt.jsx("span",{className:"font-mono font-bold text-blue-600",children:d.toLocaleTimeString()}),Nt.jsx("span",{children:""}),Nt.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold "+("open"===a.bettingStatus?"bg-green-100 text-green-800":"closed"===a.bettingStatus?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:(null==(t=a.bettingStatus)?void 0:t.toUpperCase())||"OPEN"}),Nt.jsx("button",{onClick:()=>{o(!0),m()},className:"px-3 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",children:" Refresh"}),Nt.jsx(ud,{children:Nt.jsx("span",{className:"text-green-600 font-semibold",children:" LIVE"})})]})]})}),Nt.jsxs(ld,{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[Nt.jsx(cd,{children:Nt.jsx("div",{className:`p-6 rounded-xl shadow-lg ${n?"bg-gray-800":"bg-white"} card-hover`,children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-3xl font-bold text-indigo-600 mb-2",children:g.totalBets}),Nt.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Bets"})]})})}),Nt.jsx(cd,{children:Nt.jsx("div",{className:`p-6 rounded-xl shadow-lg ${n?"bg-gray-800":"bg-white"} card-hover`,children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:p(g.totalAmount)}),Nt.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Amount"})]})})}),Nt.jsx(cd,{children:Nt.jsx("div",{className:`p-6 rounded-xl shadow-lg ${n?"bg-red-50 dark:bg-red-900/20":"bg-red-50"} border-l-4 border-red-500`,children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:g.meronCount}),Nt.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Meron Bets"}),Nt.jsx("div",{className:"text-lg font-semibold text-red-600",children:p(g.meronAmount)})]})})}),Nt.jsx(cd,{children:Nt.jsx("div",{className:`p-6 rounded-xl shadow-lg ${n?"bg-blue-50 dark:bg-blue-900/20":"bg-blue-50"} border-l-4 border-blue-500`,children:Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:g.walaCount}),Nt.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Wala Bets"}),Nt.jsx("div",{className:"text-lg font-semibold text-blue-600",children:p(g.walaAmount)})]})})})]}),(a.externalTotalBets>0||a.externalTotalAmount>0)&&Nt.jsx(sd,{delay:.15,children:Nt.jsxs("div",{className:`p-6 rounded-xl shadow-lg mb-8 ${n?"bg-purple-900/20 border-purple-500":"bg-purple-50 border-purple-200"} border-l-4`,children:[Nt.jsx("h2",{className:"text-xl font-bold mb-4 text-purple-600",children:" External Source Data"}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:a.externalTotalBets}),Nt.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"External Bets"})]}),Nt.jsxs("div",{className:"text-center",children:[Nt.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:p(a.externalTotalAmount)}),Nt.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"External Amount"})]})]})]})}),Nt.jsx(sd,{delay:.2,children:Nt.jsxs("div",{className:"p-6 rounded-xl shadow-lg mb-8 "+(n?"bg-gray-800":"bg-white"),children:[Nt.jsx("h2",{className:"text-xl font-bold mb-4",children:" Current Fight Status"}),a.fights.length>0?Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.fights.slice(-3).map((e,t)=>Nt.jsxs("div",{className:"p-4 rounded-lg "+(n?"bg-gray-700":"bg-gray-50"),children:[Nt.jsxs("div",{className:"flex justify-between items-center mb-2",children:[Nt.jsxs("span",{className:"font-semibold",children:["Fight #",e.fightNumber||"N/A"]}),Nt.jsx("span",{className:"px-2 py-1 rounded text-xs "+("completed"===e.status?"bg-green-100 text-green-800":"active"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status||"pending"})]}),e.meron&&e.wala&&Nt.jsxs("div",{className:"space-y-1 text-sm",children:[Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{className:"text-red-600",children:" Meron:"}),Nt.jsx("span",{children:e.meron.entryName})]}),Nt.jsxs("div",{className:"flex justify-between",children:[Nt.jsx("span",{className:"text-blue-600",children:" Wala:"}),Nt.jsx("span",{children:e.wala.entryName})]}),e.winner&&Nt.jsx("div",{className:"mt-2 p-2 bg-green-100 dark:bg-green-900/20 rounded text-center",children:Nt.jsxs("span",{className:"font-bold text-green-600",children:[" Winner: ",e.winner.toUpperCase()," (",e.meron.entryName,")"]})})]})]},t))}):Nt.jsx("div",{className:"text-center py-8 text-gray-500",children:Nt.jsx("p",{children:"No fights scheduled for today"})})]})}),Nt.jsx(sd,{delay:.4,children:Nt.jsxs("div",{className:"p-6 rounded-xl shadow-lg "+(n?"bg-gray-800":"bg-white"),children:[Nt.jsx("h2",{className:"text-xl font-bold mb-4",children:" Live Betting Activity"}),a.bets.length>0?Nt.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:a.bets.slice(-10).reverse().map((e,t)=>Nt.jsxs("div",{className:`p-3 rounded-lg ${n?"bg-gray-700":"bg-gray-50"} flex justify-between items-center`,children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold "+("meron"===e.side?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.side.toUpperCase()}),Nt.jsxs("div",{className:"flex flex-col",children:[Nt.jsx("span",{className:"font-medium",children:e.entryName}),Nt.jsxs("span",{className:"text-xs text-gray-500",children:["by ",e.createdByName]})]}),Nt.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Fight #",e.gameType]})]}),Nt.jsxs("div",{className:"text-right",children:[Nt.jsx("div",{className:"font-bold text-green-600",children:p(e.amount)}),Nt.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString()})]})]},t))}):Nt.jsx("div",{className:"text-center py-8 text-gray-500",children:Nt.jsx("p",{children:"No betting activity yet"})})]})}),Nt.jsx(sd,{delay:.6,children:Nt.jsxs("div",{className:"p-6 rounded-xl shadow-lg mt-8 "+(n?"bg-gray-800":"bg-white"),children:[Nt.jsxs("h2",{className:"text-xl font-bold mb-4",children:[" Active Entries (",a.entries.length,")"]}),a.entries.length>0?Nt.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.entries.map((e,t)=>{var r;return Nt.jsxs("div",{className:"p-4 rounded-lg "+(n?"bg-gray-700":"bg-gray-50"),children:[Nt.jsx("div",{className:"font-semibold mb-2",children:e.entryName}),Nt.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[Nt.jsxs("div",{children:["Game Type: ",Nt.jsx("span",{className:"font-medium",children:e.gameType})]}),Nt.jsxs("div",{children:["Leg Bands: ",Nt.jsx("span",{className:"font-medium",children:null==(r=e.legBandNumbers)?void 0:r.join(", ")})]}),Nt.jsxs("div",{className:"text-xs",children:["Created: ",new Date(e.createdAt).toLocaleTimeString()]})]})]},t)})}):Nt.jsx("div",{className:"text-center py-8 text-gray-500",children:Nt.jsx("p",{children:"No entries registered yet"})})]})})]})})}function yne({onSubmit:e}){const[t,n]=v.useState("");return Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("input",{value:t,onChange:e=>n(e.target.value),placeholder:'{"d":"<deploymentId>","a":"<assetId>","s":"<seed>"}',className:"flex-1 px-3 py-2 border rounded"}),Nt.jsx("button",{onClick:()=>t&&e(t),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Submit"})]})}var vne,bne,wne,Nne,Sne,jne,_ne,Ane,Cne,Mne,kne,Ene,Tne,Pne,Dne,Rne,Ine,One,Bne,Lne,Fne,Une,zne,Hne={},Gne={exports:{}};function Vne(){if(bne)return vne;bne=1;return vne="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function $ne(){if(Nne)return wne;Nne=1;var e=Vne();function t(){}function n(){}return n.resetWarningCache=t,wne=function(){function r(t,n,r,a,i,s){if(s!==e){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function a(){return r}r.isRequired=r;var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return i.PropTypes=i,i}}function Wne(){return Sne||(Sne=1,Gne.exports=$ne()()),Gne.exports}function Yne(){return _ne?jne:(_ne=1,jne={L:1,M:0,Q:3,H:2})}function Xne(){return Cne?Ane:(Cne=1,Ane={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8})}function Kne(){if(Ine)return Rne;Ine=1;for(var e={glog:function(t){if(t<1)throw new Error("glog("+t+")");return e.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},t=0;t<8;t++)e.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)e.EXP_TABLE[t]=e.EXP_TABLE[t-4]^e.EXP_TABLE[t-5]^e.EXP_TABLE[t-6]^e.EXP_TABLE[t-8];for(t=0;t<255;t++)e.LOG_TABLE[e.EXP_TABLE[t]]=t;return Rne=e}function qne(){if(Bne)return One;Bne=1;var e=Kne();function t(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var r=0;r<e.length-n;r++)this.num[r]=e[r+n]}return t.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(n){for(var r=new Array(this.getLength()+n.getLength()-1),a=0;a<this.getLength();a++)for(var i=0;i<n.getLength();i++)r[a+i]^=e.gexp(e.glog(this.get(a))+e.glog(n.get(i)));return new t(r,0)},mod:function(n){if(this.getLength()-n.getLength()<0)return this;for(var r=e.glog(this.get(0))-e.glog(n.get(0)),a=new Array(this.getLength()),i=0;i<this.getLength();i++)a[i]=this.get(i);for(i=0;i<n.getLength();i++)a[i]^=e.gexp(e.glog(n.get(i))+r);return new t(a,0).mod(n)}},One=t}function Jne(){if(zne)return Une;zne=1;var e=function(){if(kne)return Mne;kne=1;var e=Xne();function t(t){this.mode=e.MODE_8BIT_BYTE,this.data=t}return t.prototype={getLength:function(e){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++)e.put(this.data.charCodeAt(t),8)}},Mne=t}(),t=function(){if(Tne)return Ene;Tne=1;var e=Yne();function t(e,t){this.totalCount=e,this.dataCount=t}return t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t.getRSBlocks=function(e,n){var r=t.getRsBlockTable(e,n);if(null==r)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+n);for(var a=r.length/3,i=new Array,s=0;s<a;s++)for(var o=r[3*s+0],l=r[3*s+1],c=r[3*s+2],d=0;d<o;d++)i.push(new t(l,c));return i},t.getRsBlockTable=function(n,r){switch(r){case e.L:return t.RS_BLOCK_TABLE[4*(n-1)+0];case e.M:return t.RS_BLOCK_TABLE[4*(n-1)+1];case e.Q:return t.RS_BLOCK_TABLE[4*(n-1)+2];case e.H:return t.RS_BLOCK_TABLE[4*(n-1)+3];default:return}},Ene=t}(),n=function(){if(Dne)return Pne;function e(){this.buffer=new Array,this.length=0}return Dne=1,e.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},Pne=e}(),r=function(){if(Fne)return Lne;Fne=1;var e=Xne(),t=qne(),n=Kne(),r=0,a=1,i=2,s=3,o=4,l=5,c=6,d=7,u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;u.getBCHDigit(t)-u.getBCHDigit(u.G15)>=0;)t^=u.G15<<u.getBCHDigit(t)-u.getBCHDigit(u.G15);return(e<<10|t)^u.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;u.getBCHDigit(t)-u.getBCHDigit(u.G18)>=0;)t^=u.G18<<u.getBCHDigit(t)-u.getBCHDigit(u.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return u.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case r:return(t+n)%2==0;case a:return t%2==0;case i:return n%3==0;case s:return(t+n)%3==0;case o:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case l:return t*n%2+t*n%3==0;case c:return(t*n%2+t*n%3)%2==0;case d:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var r=new t([1],0),a=0;a<e;a++)r=r.multiply(new t([1,n.gexp(a)],0));return r},getLengthInBits:function(t,n){if(1<=n&&n<10)switch(t){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:case e.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(n<27)switch(t){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(n<41))throw new Error("type:"+n);switch(t){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,r=0;r<t;r++)for(var a=0;a<t;a++){for(var i=0,s=e.isDark(r,a),o=-1;o<=1;o++)if(!(r+o<0||t<=r+o))for(var l=-1;l<=1;l++)a+l<0||t<=a+l||0==o&&0==l||s==e.isDark(r+o,a+l)&&i++;i>5&&(n+=3+i-5)}for(r=0;r<t-1;r++)for(a=0;a<t-1;a++){var c=0;e.isDark(r,a)&&c++,e.isDark(r+1,a)&&c++,e.isDark(r,a+1)&&c++,e.isDark(r+1,a+1)&&c++,0!=c&&4!=c||(n+=3)}for(r=0;r<t;r++)for(a=0;a<t-6;a++)e.isDark(r,a)&&!e.isDark(r,a+1)&&e.isDark(r,a+2)&&e.isDark(r,a+3)&&e.isDark(r,a+4)&&!e.isDark(r,a+5)&&e.isDark(r,a+6)&&(n+=40);for(a=0;a<t;a++)for(r=0;r<t-6;r++)e.isDark(r,a)&&!e.isDark(r+1,a)&&e.isDark(r+2,a)&&e.isDark(r+3,a)&&e.isDark(r+4,a)&&!e.isDark(r+5,a)&&e.isDark(r+6,a)&&(n+=40);var d=0;for(a=0;a<t;a++)for(r=0;r<t;r++)e.isDark(r,a)&&d++;return n+Math.abs(100*d/t/t-50)/5*10}};return Lne=u}(),a=qne();function i(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var s=i.prototype;return s.addData=function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},s.isDark=function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},s.getModuleCount=function(){return this.moduleCount},s.make=function(){if(this.typeNumber<1){var e=1;for(e=1;e<40;e++){for(var a=t.getRSBlocks(e,this.errorCorrectLevel),i=new n,s=0,o=0;o<a.length;o++)s+=a[o].dataCount;for(o=0;o<this.dataList.length;o++){var l=this.dataList[o];i.put(l.mode,4),i.put(l.getLength(),r.getLengthInBits(l.mode,e)),l.write(i)}if(i.getLengthInBits()<=8*s)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())},s.makeImpl=function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[n][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=i.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},s.setupPositionProbePattern=function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var r=-1;r<=7;r++)t+r<=-1||this.moduleCount<=t+r||(this.modules[e+n][t+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},s.getBestMaskPattern=function(){for(var e=0,t=0,n=0;n<8;n++){this.makeImpl(!0,n);var a=r.getLostPoint(this);(0==n||e>a)&&(e=a,t=n)}return t},s.createMovieClip=function(e,t,n){var r=e.createEmptyMovieClip(t,n);this.make();for(var a=0;a<this.modules.length;a++)for(var i=1*a,s=0;s<this.modules[a].length;s++){var o=1*s;this.modules[a][s]&&(r.beginFill(0,100),r.moveTo(o,i),r.lineTo(o+1,i),r.lineTo(o+1,i+1),r.lineTo(o,i+1),r.endFill())}return r},s.setupTimingPattern=function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},s.setupPositionAdjustPattern=function(){for(var e=r.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var a=e[t],i=e[n];if(null==this.modules[a][i])for(var s=-2;s<=2;s++)for(var o=-2;o<=2;o++)this.modules[a+s][i+o]=-2==s||2==s||-2==o||2==o||0==s&&0==o}},s.setupTypeNumber=function(e){for(var t=r.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var a=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=a}for(n=0;n<18;n++){a=!e&&1==(t>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=a}},s.setupTypeInfo=function(e,t){for(var n=this.errorCorrectLevel<<3|t,a=r.getBCHTypeInfo(n),i=0;i<15;i++){var s=!e&&1==(a>>i&1);i<6?this.modules[i][8]=s:i<8?this.modules[i+1][8]=s:this.modules[this.moduleCount-15+i][8]=s}for(i=0;i<15;i++){s=!e&&1==(a>>i&1);i<8?this.modules[8][this.moduleCount-i-1]=s:i<9?this.modules[8][15-i-1+1]=s:this.modules[8][15-i-1]=s}this.modules[this.moduleCount-8][8]=!e},s.mapData=function(e,t){for(var n=-1,a=this.moduleCount-1,i=7,s=0,o=this.moduleCount-1;o>0;o-=2)for(6==o&&o--;;){for(var l=0;l<2;l++)if(null==this.modules[a][o-l]){var c=!1;s<e.length&&(c=1==(e[s]>>>i&1)),r.getMask(t,a,o-l)&&(c=!c),this.modules[a][o-l]=c,-1==--i&&(s++,i=7)}if((a+=n)<0||this.moduleCount<=a){a-=n,n=-n;break}}},i.PAD0=236,i.PAD1=17,i.createData=function(e,a,s){for(var o=t.getRSBlocks(e,a),l=new n,c=0;c<s.length;c++){var d=s[c];l.put(d.mode,4),l.put(d.getLength(),r.getLengthInBits(d.mode,e)),d.write(l)}var u=0;for(c=0;c<o.length;c++)u+=o[c].dataCount;if(l.getLengthInBits()>8*u)throw new Error("code length overflow. ("+l.getLengthInBits()+">"+8*u+")");for(l.getLengthInBits()+4<=8*u&&l.put(0,4);l.getLengthInBits()%8!=0;)l.putBit(!1);for(;!(l.getLengthInBits()>=8*u||(l.put(i.PAD0,8),l.getLengthInBits()>=8*u));)l.put(i.PAD1,8);return i.createBytes(l,o)},i.createBytes=function(e,t){for(var n=0,i=0,s=0,o=new Array(t.length),l=new Array(t.length),c=0;c<t.length;c++){var d=t[c].dataCount,u=t[c].totalCount-d;i=Math.max(i,d),s=Math.max(s,u),o[c]=new Array(d);for(var h=0;h<o[c].length;h++)o[c][h]=255&e.buffer[h+n];n+=d;var p=r.getErrorCorrectPolynomial(u),m=new a(o[c],p.getLength()-1).mod(p);l[c]=new Array(p.getLength()-1);for(h=0;h<l[c].length;h++){var g=h+m.getLength()-l[c].length;l[c][h]=g>=0?m.get(g):0}}var f=0;for(h=0;h<t.length;h++)f+=t[h].totalCount;var x=new Array(f),y=0;for(h=0;h<i;h++)for(c=0;c<t.length;c++)h<o[c].length&&(x[y++]=o[c][h]);for(h=0;h<s;h++)for(c=0;c<t.length;c++)h<l[c].length&&(x[y++]=l[c][h]);return x},Une=i}var Qne,Zne,ere={};function tre(){if(Qne)return ere;Qne=1,Object.defineProperty(ere,"__esModule",{value:!0});var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t=a(Wne()),n=p(),r=a(n);function a(e){return e&&e.__esModule?e:{default:e}}var i={bgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,bgD:t.default.string.isRequired,fgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,fgD:t.default.string.isRequired,size:t.default.number.isRequired,title:t.default.string,viewBoxSize:t.default.number.isRequired,xmlns:t.default.string},s=(0,n.forwardRef)(function(t,n){var a=t.bgColor,i=t.bgD,s=t.fgD,o=t.fgColor,l=t.size,c=t.title,d=t.viewBoxSize,u=t.xmlns,h=void 0===u?"http://www.w3.org/2000/svg":u,p=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return r.default.createElement("svg",e({},p,{height:l,ref:n,viewBox:"0 0 "+d+" "+d,width:l,xmlns:h}),c?r.default.createElement("title",null,c):null,r.default.createElement("path",{d:i,fill:a}),r.default.createElement("path",{d:s,fill:o}))});return s.displayName="QRCodeSvg",s.propTypes=i,ere.default=s,ere}var nre=function(){if(Zne)return Hne;Zne=1,Object.defineProperty(Hne,"__esModule",{value:!0}),Hne.QRCode=void 0;var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t=o(Wne()),n=o(Yne()),r=o(Jne()),a=p(),i=o(a),s=o(tre());function o(e){return e&&e.__esModule?e:{default:e}}var l={bgColor:t.default.oneOfType([t.default.object,t.default.string]),fgColor:t.default.oneOfType([t.default.object,t.default.string]),level:t.default.string,size:t.default.number,value:t.default.string.isRequired},c=(0,a.forwardRef)(function(t,a){var o=t.bgColor,l=void 0===o?"#FFFFFF":o,c=t.fgColor,d=void 0===c?"#000000":c,u=t.level,h=void 0===u?"L":u,p=t.size,m=void 0===p?256:p,g=t.value,f=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["bgColor","fgColor","level","size","value"]),x=new r.default(-1,n.default[h]);x.addData(g),x.make();var y=x.modules;return i.default.createElement(s.default,e({},f,{bgColor:l,bgD:y.map(function(e,t){return e.map(function(e,n){return e?"":"M "+n+" "+t+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:d,fgD:y.map(function(e,t){return e.map(function(e,n){return e?"M "+n+" "+t+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:a,size:m,viewBoxSize:y.length}))});return Hne.QRCode=c,c.displayName="QRCode",c.propTypes=l,Hne.default=c,Hne}();const rre=g(nre),are=["Printer","Tablet","Key","Charger","Cash Box","Stand"];function ire({assetType:e,assetId:t}){const n=JSON.stringify({type:e,id:t});return Nt.jsxs("div",{style:{border:"1px solid #ccc",padding:12,margin:8,display:"inline-block",width:160,textAlign:"center",background:"white"},children:[Nt.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:e}),Nt.jsx(rre,{value:n,size:96}),Nt.jsxs("div",{style:{fontSize:12,marginTop:4},children:["ID: ",t]})]})}function sre({type:e,status:t,onScan:n,onAssign:r}){return Nt.jsxs("div",{className:"flex items-center gap-4 p-2 border-b",children:[Nt.jsx("span",{className:"font-semibold w-32",children:e}),Nt.jsx("span",{className:"px-2 py-1 rounded "+("deployed"===t?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:t}),Nt.jsx("button",{className:"ml-auto px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:n,children:"Scan"}),Nt.jsx("button",{className:"ml-2 px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",onClick:r,children:"Assign"})]})}function ore({viewOnly:e=!1}){const[t,n]=f.useState([]),[r,a]=f.useState(null),[i,s]=f.useState(!1),[o,d]=f.useState(are.reduce((e,t)=>(e[t]=1,e),{})),[u,p]=f.useState(!1),[m,g]=f.useState(!1),[x,y]=f.useState(null),[v,b]=f.useState([]),[w,N]=f.useState(""),[S,j]=f.useState(1),[_,A]=f.useState(""),[C,M]=f.useState(!1);f.useEffect(()=>{g(!0),fetch("/api/assets/all").then(e=>e.json()).then(e=>{e.success&&n(e.assets)}).finally(()=>g(!1))},[]),f.useEffect(()=>{fetch("/api/tellers/all").then(e=>e.json()).then(e=>{e.success&&b(e.tellers)})},[]);return Nt.jsxs("div",{className:"max-w-xl mx-auto p-6",children:[Nt.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Deployment Management"}),Nt.jsx("button",{className:"mb-4 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:()=>s(!0),children:"Generate QR Stickers"}),Nt.jsx("div",{className:"bg-white rounded shadow p-4",children:m?Nt.jsx("div",{className:"text-center text-gray-500",children:"Loading assets..."}):0===t.length?Nt.jsx("div",{className:"text-center text-gray-500",children:"No assets found. Generate and save QR stickers."}):t.map((e,t)=>Nt.jsx(sre,{type:e.assetType,status:e.status,onScan:()=>(e=>{a(e)})(t),onAssign:()=>y(t)},e.assetId))}),null!==r&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-96",children:[Nt.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Scan ",t[r].type]}),Nt.jsx(yne,{onSubmit:e=>{const i=t[r];fetch("/api/assets/scan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assetId:i.assetId,scannedBy:"teller"})}).then(e=>e.json()).then(e=>{e.success&&n(t=>t.map((t,n)=>n===r?e.asset:t))}),a(null)}}),Nt.jsx("button",{className:"mt-4 px-3 py-1 bg-gray-300 rounded",onClick:()=>a(null),children:"Cancel"})]})}),i&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-[600px] max-h-[80vh] overflow-auto",children:[Nt.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Generate QR Stickers"}),Nt.jsx("div",{className:"mb-4",children:are.map(e=>Nt.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[Nt.jsx("span",{className:"w-32 font-semibold",children:e}),Nt.jsx("input",{type:"number",min:1,value:o[e],onChange:t=>((e,t)=>{d(n=>c(l({},n),{[e]:Math.max(1,Number(t)||1)}))})(e,t.target.value),className:"w-16 px-2 py-1 border rounded"}),Nt.jsx("span",{className:"text-xs text-gray-500",children:"Quantity"})]},e))}),Nt.jsx("div",{id:"qr-sticker-print-area",className:"flex flex-wrap gap-2 justify-center",children:are.flatMap(e=>Array.from({length:o[e]},(t,n)=>Nt.jsx(ire,{assetType:e,assetId:e+"-"+(n+1)},e+"-"+(n+1))))}),Nt.jsxs("div",{className:"flex gap-2 mt-6",children:[Nt.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:()=>{const e=document.getElementById("qr-sticker-print-area").innerHTML,t=window.open("","","height=600,width=800");t.document.write("<html><head><title>Print QR Stickers</title>"),t.document.write("<style>body{background:white;} div{display:inline-block;margin:8px;}</style>"),t.document.write("</head><body >"),t.document.write(e),t.document.write("</body></html>"),t.document.close(),t.focus(),setTimeout(()=>{t.print(),t.close()},500)},children:"Print Stickers"}),Nt.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:u,onClick:()=>{p(!0);const e=are.flatMap(e=>Array.from({length:o[e]},(t,n)=>({assetType:e,assetId:`${e}-${n+1}`,qrData:JSON.stringify({type:e,id:`${e}-${n+1}`})})));fetch("/api/assets/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assets:e})}).then(e=>e.json()).then(e=>{e.success&&(n(e.assets),s(!1))}).finally(()=>p(!1))},children:u?"Saving...":"Save to System"}),Nt.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>s(!1),children:"Close"})]})]})}),null!==x&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-96",children:[Nt.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Assign ",t[x].type]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("label",{className:"block mb-1 font-medium",children:"Select Teller"}),Nt.jsxs("select",{className:"w-full px-2 py-1 border rounded",value:w,onChange:e=>N(e.target.value),children:[Nt.jsx("option",{value:"",children:"-- Select Teller --"}),v.map(e=>Nt.jsx("option",{value:e._id,children:e.name||e.username},e._id))]})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("label",{className:"block mb-1 font-medium",children:"Quantity"}),Nt.jsx("input",{type:"number",min:1,value:S,onChange:e=>j(Number(e.target.value)),className:"w-full px-2 py-1 border rounded"})]}),Nt.jsxs("div",{className:"mb-3",children:[Nt.jsx("label",{className:"block mb-1 font-medium",children:"Expected Return Date"}),Nt.jsx("input",{type:"date",value:_,onChange:e=>A(e.target.value),className:"w-full px-2 py-1 border rounded"})]}),Nt.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:C||!w||!_,onClick:()=>h(null,null,function*(){M(!0);const e=t[x];yield fetch("/api/deployments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemName:e.assetType,itemType:e.assetType,quantity:S,expectedReturnDate:_,assignedTellers:[{tellerId:w,acknowledged:!1}],assetId:e.assetId})}),M(!1),y(null)}),children:C?"Assigning...":"Assign"}),Nt.jsx("button",{className:"mt-4 px-3 py-1 bg-gray-300 rounded",onClick:()=>y(null),children:"Cancel"})]})})]})}function lre(){const[e,t]=f.useState([]),[n,r]=f.useState([]),[a,i]=f.useState(!1),[s,o]=f.useState(""),[l,c]=f.useState(""),[d,u]=f.useState(null),[p,m]=f.useState(!0),g=zc();f.useEffect(()=>{h(null,null,function*(){try{const e=yield pt.get(`${g}/api/deployments`);t(e.data.deployments);const n=yield pt.get(`${g}/api/assets/all`);r(n.data.assets.filter(e=>e.scannedBy))}catch(e){}finally{m(!1)}})},[g]);const x=e=>h(null,null,function*(){});return p?Nt.jsx("div",{className:"flex justify-center items-center h-64",children:Nt.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):Nt.jsxs("div",{className:"p-6",children:[Nt.jsxs("div",{className:"mb-6",children:[Nt.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"My Deployments"}),Nt.jsx("p",{className:"text-gray-600",children:"View and manage your assigned equipment and items"})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[Nt.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[Nt.jsx("h3",{className:"text-sm font-medium text-blue-600",children:"Total Assigned"}),Nt.jsx("p",{className:"text-2xl font-bold text-blue-700",children:e.length})]}),Nt.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[Nt.jsx("h3",{className:"text-sm font-medium text-yellow-600",children:"Pending Acknowledgment"}),Nt.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:e.filter(e=>{var t;return!(null==(t=e.assignedTellers.find(e=>{var t;return e.tellerId===(null==(t=JSON.parse(localStorage.getItem("user")))?void 0:t._id)}))?void 0:t.acknowledged)}).length})]}),Nt.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[Nt.jsx("h3",{className:"text-sm font-medium text-orange-600",children:"Pending Completion"}),Nt.jsx("p",{className:"text-2xl font-bold text-orange-700",children:e.filter(e=>{var t;return!(null==(t=e.tellerCompleteness.find(e=>{var t;return e.tellerId===(null==(t=JSON.parse(localStorage.getItem("user")))?void 0:t._id)}))?void 0:t.isComplete)}).length})]}),Nt.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[Nt.jsx("h3",{className:"text-sm font-medium text-red-600",children:"Overdue"}),Nt.jsx("p",{className:"text-2xl font-bold text-red-700",children:e.filter(e=>(e.expectedReturnDate,void e.status)).length})]})]}),Nt.jsx("div",{className:"space-y-4",children:0===e.length?Nt.jsx("div",{className:"text-center py-12",children:Nt.jsx("div",{className:"text-gray-400 text-lg",children:"No deployments assigned to you"})}):e.map(e=>{const t=JSON.parse(localStorage.getItem("user")),n=e.assignedTellers.find(e=>e.tellerId===(null==t?void 0:t._id)),r=e.tellerCompleteness.find(e=>e.tellerId===(null==t?void 0:t._id)),i="borrowed"===e.assetStatus;return Nt.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 "+(i?"border-green-600 bg-green-50":(e.expectedReturnDate,void e.status?"border-red-500 bg-red-50":(null==r?void 0:r.isComplete)?"border-green-500":(null==n?void 0:n.acknowledged)?"border-blue-500":"border-yellow-500")),children:[Nt.jsxs("div",{className:"flex flex-wrap justify-between items-start mb-4",children:[Nt.jsxs("div",{children:[Nt.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e.itemName}),Nt.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[Nt.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${void e.status}`,children:e.status.replace("_"," ")}),Nt.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${void e.priority}`,children:[e.priority," priority"]}),"borrowed"===e.assetStatus&&Nt.jsxs("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:["Borrowed by ",e.borrowedBy||"Teller"]}),(e.expectedReturnDate,void e.status&&Nt.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"OVERDUE"}))]})]}),Nt.jsx("div",{className:"text-right",children:Nt.jsxs("div",{className:"text-sm text-gray-600",children:[Nt.jsxs("p",{children:[Nt.jsx("span",{className:"font-medium",children:"Type:"})," ",e.itemType]}),Nt.jsxs("p",{children:[Nt.jsx("span",{className:"font-medium",children:"Quantity:"})," ",e.quantity]}),Nt.jsxs("p",{children:[Nt.jsx("span",{className:"font-medium",children:"Expected Return:"})," ",new Date(e.expectedReturnDate).toLocaleDateString()]})]})})]}),e.itemDescription&&Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Description:"}),Nt.jsx("p",{className:"text-gray-600 bg-gray-50 p-3 rounded",children:e.itemDescription})]}),e.notes&&Nt.jsxs("div",{className:"mb-4",children:[Nt.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Notes:"}),Nt.jsx("p",{className:"text-gray-600 bg-gray-50 p-3 rounded",children:e.notes})]}),Nt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("span",{className:"font-medium text-gray-700",children:"Acknowledgment:"}),(null==n?void 0:n.acknowledged)?Nt.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[Nt.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:Nt.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Acknowledged on ",new Date(n.acknowledgedAt).toLocaleDateString()]}):Nt.jsx("span",{className:"text-yellow-600",children:"Pending acknowledgment"})]}),Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx("span",{className:"font-medium text-gray-700",children:"Completion:"}),(null==r?void 0:r.isComplete)?Nt.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[Nt.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:Nt.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Completed on ",new Date(r.verifiedAt).toLocaleDateString()]}):Nt.jsx("span",{className:"text-red-600",children:"Not completed"})]})]}),Nt.jsxs("div",{className:"flex flex-wrap gap-3",children:[!(null==n?void 0:n.acknowledged)&&"preparing"!==e.status&&Nt.jsx("button",{onClick:()=>(e._id,h(null,null,function*(){})),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Acknowledge Receipt"}),(null==n?void 0:n.acknowledged)&&!(null==r?void 0:r.isComplete)&&"returned"!==e.status&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsx("button",{onClick:()=>{prompt("Add completion notes (optional):"),e._id,h(null,null,function*(){})},className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Mark as Complete"}),Nt.jsx("button",{onClick:()=>(e=>{u(e)})(e),className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-4 rounded-xl font-semibold shadow-md text-lg w-full md:w-auto",style:{minWidth:180,marginTop:8},children:"Scan to Borrow"})]})]}),d&&d._id===e._id&&Nt.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Nt.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg w-full max-w-md mx-2 flex flex-col items-center",children:[Nt.jsx("h3",{className:"text-2xl font-bold mb-2 text-purple-700 text-center",children:"Scan Asset QR to Borrow"}),Nt.jsx("p",{className:"mb-4 text-gray-600 text-center",children:"Scan the QR code on the asset to borrow it. Paste or scan the code below."}),Nt.jsx("div",{className:"w-full mb-4",children:Nt.jsx(yne,{onSubmit:x})}),a&&Nt.jsx("div",{className:"mt-4 text-center",children:Nt.jsx("span",{className:"animate-spin inline-block w-8 h-8 border-4 border-purple-300 border-t-transparent rounded-full"})}),s&&Nt.jsx("div",{className:"mt-4 text-green-600 font-semibold text-center text-lg",children:s}),l&&Nt.jsx("div",{className:"mt-4 text-red-600 font-semibold text-center text-lg",children:l}),Nt.jsx("button",{className:"mt-6 px-6 py-3 bg-gray-300 rounded-xl w-full text-lg",onClick:()=>u(null),disabled:a,children:"Cancel"})]})}),(null==r?void 0:r.notes)&&Nt.jsxs("div",{className:"mt-4 pt-4 border-t",children:[Nt.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Your Completion Notes:"}),Nt.jsx("p",{className:"text-gray-600 bg-green-50 p-3 rounded",children:r.notes})]}),Nt.jsxs("div",{className:"mt-2 p-2 bg-gray-100 text-xs rounded",children:[Nt.jsx("strong",{children:"Debug Info:"}),Nt.jsx("br",{}),"myTellerAssignment: ",JSON.stringify(n),Nt.jsx("br",{}),"myCompletion: ",JSON.stringify(r),Nt.jsx("br",{}),"deployment.status: ",e.status]})]},e._id)})}),Nt.jsxs("div",{className:"mt-8",children:[Nt.jsx("h2",{className:"text-xl font-bold mb-2 text-gray-700",children:"Recent Scan Events"}),0===n.length?Nt.jsx("div",{className:"text-gray-400",children:"No recent scan events."}):Nt.jsx("div",{className:"space-y-2",children:n.slice(-5).reverse().map((e,t)=>Nt.jsxs("div",{className:"bg-gray-50 rounded p-2 flex justify-between items-center",children:[Nt.jsxs("span",{className:"font-semibold text-gray-700",children:[e.assetType," ",Nt.jsxs("span",{className:"text-xs text-gray-500",children:["(",e.assetId,")"]})]}),Nt.jsxs("span",{className:"text-green-700",children:["Borrowed by: ",e.scannedBy]}),Nt.jsx("span",{className:"text-xs text-gray-500",children:e.scannedAt?new Date(e.scannedAt).toLocaleString():""})]},e.assetId+t))})]})]})}const cre=[{id:"dashboard",label:"Dashboard",icon:Nt.jsx(F,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator","supervisor_teller"]},{id:"teller-management",label:"Teller Management",icon:Nt.jsx(U,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"supervisor-report",label:"Supervisor Reports",icon:Nt.jsx(z,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"teller-reports",label:"Teller Reports",icon:Nt.jsx(z,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller"]},{id:"teller-reports-viewer",label:"Reports Viewer",icon:Nt.jsx(H,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller"]},{id:"teller-overview",label:"Teller Overview",icon:Nt.jsx(H,{size:16}),allowedRoles:["super_admin","admin"]},{id:"report",label:"Admin Report",icon:Nt.jsx(H,{size:16}),allowedRoles:["super_admin","admin"]},{id:"cashflow",label:"Cashflow",icon:Nt.jsx(K,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"user-approval",label:"User Approvals",icon:Nt.jsx(U,{size:16}),allowedRoles:["super_admin","admin"]},{id:"withdrawals",label:"Withdrawal Approvals",icon:Nt.jsx(Z,{size:16}),allowedRoles:["super_admin","admin"]},{id:"employees",label:"Employee Management",icon:Nt.jsx(se,{size:16}),allowedRoles:["super_admin","admin"]},{id:"salary",label:"My Salary",icon:Nt.jsx(Z,{size:16}),allowedRoles:["super_admin","admin"]},{id:"payroll",label:"Payroll",icon:Nt.jsx(xe,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller"]},{id:"payroll-fixer",label:"Payroll Base Salary Fixer",icon:Nt.jsx(xe,{size:16}),allowedRoles:["super_admin","admin"]},{id:"my-shift",label:"My Shift",icon:Nt.jsx(U,{size:16}),allowedRoles:["supervisor","supervisor_teller"]},{id:"history",label:"History",icon:Nt.jsx(z,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller"]},{id:"teller-month",label:"Teller of the Month",icon:Nt.jsx(U,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller"]},{id:"suggested-schedule",label:"Suggested Schedule",icon:Nt.jsx(W,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller"]},{id:"attendance-scheduler",label:"Attendance Scheduler",icon:Nt.jsx(W,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"deployments",label:"Deployment Management",icon:Nt.jsx(z,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator"]},{id:"assistant",label:"Admin Assistant",icon:Nt.jsx(U,{size:16}),allowedRoles:["super_admin","admin"]},{id:"settings",label:"Settings",icon:Nt.jsx(L,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator"]},{id:"upload",label:"Upload",icon:Nt.jsx(Y,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator","supervisor_teller"]},{id:"feed",label:"Feed",icon:Nt.jsx(z,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator","supervisor_teller"]},{id:"users",label:"People / Users",icon:Nt.jsx(U,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator","supervisor_teller"]},{id:"chat",label:"Chat / Messages",icon:Nt.jsx(z,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator","supervisor_teller"]},{id:"key-performance-indicator",label:"Key Performance Indicator",icon:Nt.jsx(X,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"betting-analytics",label:"Betting Analytics",icon:Nt.jsx(K,{size:16}),allowedRoles:["super_admin","admin"]},{id:"betting-event-report",label:"Betting Event Report",icon:Nt.jsx(K,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"chicken-fight",label:"Chicken Fight",icon:Nt.jsx(K,{size:16}),allowedRoles:["super_admin","admin","supervisor","declarator"]},{id:"chicken-fight-entries",label:"Chicken Fight Entries",icon:Nt.jsx(L,{size:16}),allowedRoles:["super_admin","admin","supervisor","declarator"]},{id:"live-cockfight-camera",label:"Live Cockfight Camera",icon:Nt.jsx(Y,{size:16}),allowedRoles:["super_admin","admin","supervisor","declarator"]},{id:"betting-capture-screen",label:"Betting Capture Screen",icon:Nt.jsx(Y,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator"]},{id:"stream-broadcaster",label:"Stream Broadcaster",icon:Nt.jsx(q,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator"]},{id:"staff-performance",label:"Staff Performance",icon:Nt.jsx(X,{size:16}),allowedRoles:["super_admin","admin","supervisor"]},{id:"menu-config",label:"Menu Permissions",icon:Nt.jsx(ne,{size:16}),allowedRoles:["super_admin","admin"]},{id:"manage-sidebars",label:"Sidebar Control",icon:Nt.jsx(L,{size:16}),allowedRoles:["super_admin","admin"]},{id:"live-map",label:"Live Map",icon:Nt.jsx(te,{size:16}),allowedRoles:["super_admin","admin","supervisor","teller","declarator"]},{id:"map-editor",label:"Map Editor",icon:Nt.jsx(ut,{size:16}),allowedRoles:["super_admin","admin","declarator"]},{id:"teller-betting",label:"Teller Betting Data",icon:Nt.jsx(K,{size:16}),allowedRoles:["super_admin","admin"]},{id:"manage-betting",label:"Manage Betting Data",icon:Nt.jsx(L,{size:16}),allowedRoles:["super_admin","admin"]},{id:"leaderboard",label:"External Leaderboard",icon:Nt.jsx(X,{size:16}),allowedRoles:["super_admin","admin"]},{id:"gta-leaderboard",label:"GTA Leaderboards",icon:Nt.jsx(X,{size:16}),allowedRoles:["super_admin","admin"]},{id:"betting-event-reports",label:"Betting Event Reports",icon:Nt.jsx(X,{size:16}),allowedRoles:["super_admin","admin"]},{id:"gta-betting-event-report",label:"GTA Betting Event Report",icon:Nt.jsx(X,{size:16}),allowedRoles:["super_admin","admin"]},{id:"workplace-schedule",label:"Workplace Schedule",icon:Nt.jsx(W,{size:16}),allowedRoles:["super_admin","admin"]},{id:"gta-teller-management",label:"GTA Teller Management",icon:Nt.jsx(U,{size:16}),allowedRoles:["super_admin","admin"]},{id:"teller-mappings",label:"Teller Mappings",icon:Nt.jsx(ee,{size:16}),allowedRoles:["super_admin"]},{id:"supervisor-reports",label:"Supervisor Reports (Legacy)",icon:Nt.jsx(z,{size:16})},{id:"teller-report",label:"Teller Report (Legacy)",icon:Nt.jsx(z,{size:16})},{id:"submit-report",label:"Submit Report (Legacy)",icon:Nt.jsx(z,{size:16})},{id:"schedule",label:"Schedule/Rotation (Legacy)",icon:Nt.jsx(W,{size:16})},{id:"teller-of-month",label:"Teller of the Month (Legacy)",icon:Nt.jsx(U,{size:16})}],dre=[{id:"super_admin",label:"Super Admin",color:"red"},{id:"admin",label:"Admin",color:"blue"},{id:"supervisor",label:"Supervisor",color:"purple"},{id:"teller",label:"Teller",color:"green"},{id:"supervisor_teller",label:"Supervisor Teller",color:"indigo"},{id:"declarator",label:"Declarator",color:"orange"}];function ure(){var e,t,n;const{settings:r,user:a}=f.useContext($c),{showToast:i}=Kc(),s="dark"===(null==(e=null==r?void 0:r.theme)?void 0:e.mode),[o,d]=f.useState({}),[u,p]=f.useState(!0),[m,g]=f.useState(!1),[x,y]=f.useState("admin");f.useEffect(()=>{v()},[]);const v=()=>h(null,null,function*(){p(!0);try{const e=localStorage.getItem("token"),t=e?{headers:{Authorization:`Bearer ${e}`}}:{},n=yield pt.get(`${zc()}/api/menu-permissions`,t),r={};n.data.forEach(e=>{const t=(e.menuItems||[]).map(e=>"approvals"===e?"user-approval":e);r[e.role]=Array.from(new Set(t))}),d(r)}catch(e){console.error("Failed to load menu permissions:",e),i({type:"error",message:"Failed to load menu permissions"})}finally{p(!1)}}),b=o[x]||[];return Nt.jsx("div",{className:"min-h-screen p-6 "+(s?"bg-gray-900 text-white":"bg-gray-100 text-gray-900"),children:Nt.jsxs("div",{className:"max-w-7xl mx-auto",children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Nt.jsxs("div",{className:"flex items-center gap-3",children:[Nt.jsx(ne,{className:"w-8 h-8 text-indigo-500"}),Nt.jsxs("div",{children:[Nt.jsx("h1",{className:"text-2xl font-bold",children:"Menu Permissions Manager"}),Nt.jsx("p",{className:"text-sm text-gray-500",children:"Configure sidebar menu items for each role"})]})]}),Nt.jsxs("div",{className:"flex gap-2 items-center",children:[Nt.jsxs("button",{onClick:v,disabled:u,className:`px-4 py-2 rounded flex items-center gap-2 ${s?"bg-gray-700 hover:bg-gray-600":"bg-white hover:bg-gray-50"} border ${s?"border-gray-600":"border-gray-300"}`,children:[Nt.jsx(Ae,{size:16,className:u?"animate-spin":""}),"Refresh"]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){if(window.confirm("Reset all roles to default menu permissions?")){g(!0);try{const e=localStorage.getItem("token"),t=e?{headers:{Authorization:`Bearer ${e}`}}:{};yield pt.post(`${zc()}/api/menu-permissions/initialize`,{},t),i({type:"success",message:"Initialized default permissions"}),v()}catch(e){console.error("Failed to initialize defaults:",e),i({type:"error",message:"Failed to initialize defaults"})}finally{g(!1)}}}),disabled:m,className:"px-4 py-2 rounded flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white",children:[Nt.jsx(Ae,{size:16}),"Reset to Defaults"]}),Nt.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded border bg-gray-50 dark:bg-gray-700 text-sm",children:[Nt.jsx("label",{className:"text-xs mr-2",children:"Enforce explicit menu permissions for Super Admin"}),Nt.jsx("input",{type:"checkbox",checked:"true"===localStorage.getItem("superAdminStrict"),onChange:e=>{const t=e.target.checked?"true":"false";localStorage.setItem("superAdminStrict",t),i({type:"info",message:"super_admin strict mode "+(e.target.checked?"enabled":"disabled")});try{window.location.reload()}catch(n){}},className:"h-4 w-4"})]}),Nt.jsxs("button",{onClick:()=>h(null,null,function*(){var e;g(!0);try{const e=localStorage.getItem("token"),t=e?{headers:{Authorization:`Bearer ${e}`}}:{};for(const n of dre)yield pt.put(`${zc()}/api/menu-permissions/${n.id}`,{menuItems:o[n.id]||[],updatedBy:(null==a?void 0:a.username)||"super_admin"},t);i({type:"success",message:"Saved all menu permissions"})}catch(t){console.error("Failed to save all permissions:",t),401===(null==(e=null==t?void 0:t.response)?void 0:e.status)?i({type:"error",message:"Unauthorized  must be signed in as super_admin to save all role permissions."}):i({type:"error",message:"Failed to save all permissions"})}finally{g(!1)}}),disabled:m,className:"px-4 py-2 rounded flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white",children:[Nt.jsx(Ee,{size:16}),m?"Saving...":"Save All Roles"]})]})]}),u?Nt.jsxs("div",{className:"text-center py-20",children:[Nt.jsx(Ae,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-indigo-500"}),Nt.jsx("p",{children:"Loading menu permissions..."})]}):Nt.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[Nt.jsxs("div",{className:"rounded-lg p-4 "+(s?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Role"}),Nt.jsx("div",{className:"space-y-2",children:dre.map(e=>{const t=(o[e.id]||[]).length;return Nt.jsxs("button",{onClick:()=>y(e.id),className:"w-full text-left px-4 py-3 rounded flex items-center justify-between transition "+(x===e.id?`bg-${e.color}-600 text-white`:s?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"),children:[Nt.jsx("span",{className:"font-medium",children:e.label}),Nt.jsxs("span",{className:"text-xs px-2 py-1 rounded "+(x===e.id?"bg-white/20":s?"bg-gray-600":"bg-gray-300"),children:[t," items"]})]},e.id)})})]}),Nt.jsxs("div",{className:"lg:col-span-2 rounded-lg p-4 "+(s?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Nt.jsxs("h2",{className:"text-lg font-semibold",children:["Menu Items for ",Nt.jsx("span",{className:"text-indigo-500",children:null==(t=dre.find(e=>e.id===x))?void 0:t.label})]}),Nt.jsxs("div",{className:"flex gap-2",children:[Nt.jsx("button",{onClick:()=>{return e=x,void d(t=>c(l({},t),{[e]:cre.map(e=>e.id)}));var e},className:"px-3 py-1 text-sm rounded "+(s?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Select All"}),Nt.jsx("button",{onClick:()=>{return e=x,void d(t=>c(l({},t),{[e]:[]}));var e},className:"px-3 py-1 text-sm rounded "+(s?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"),children:"Deselect All"}),Nt.jsxs("button",{onClick:()=>{return e=x,h(null,null,function*(){var t;g(!0);try{const t=localStorage.getItem("token"),n=t?{headers:{Authorization:`Bearer ${t}`}}:{};yield pt.put(`${zc()}/api/menu-permissions/${e}`,{menuItems:o[e]||[],updatedBy:(null==a?void 0:a.username)||"super_admin"},n),i({type:"success",message:`Saved menu permissions for ${e}`})}catch(n){console.error("Failed to save menu permissions:",n),401===(null==(t=null==n?void 0:n.response)?void 0:t.status)?i({type:"error",message:"Unauthorized  you must be signed in as super_admin to change menu permissions."}):i({type:"error",message:"Failed to save menu permissions"})}finally{g(!1)}});var e},disabled:m,className:"px-3 py-1 text-sm rounded bg-indigo-600 hover:bg-indigo-700 text-white",children:[Nt.jsx(Ee,{size:14,className:"inline mr-1"}),"Save"]})]})]}),Nt.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:cre.map(e=>{const t=b.indexOf(e.id),n=-1!==t;return Nt.jsxs("button",{onClick:()=>{return t=x,n=e.id,void d(e=>{const r=e[t]||[],a=r.includes(n)?r.filter(e=>e!==n):[...r,n];return c(l({},e),{[t]:a})});var t,n},className:"flex items-center gap-3 p-3 rounded border transition "+(n?"bg-indigo-50 border-indigo-500 dark:bg-indigo-900/30":s?"bg-gray-700 border-gray-600 hover:bg-gray-600":"bg-gray-50 border-gray-300 hover:bg-gray-100"),draggable:n,onDragStart:t=>n&&((e,t,n)=>{try{e.dataTransfer.setData("text/plain",n)}catch(r){}})(t,0,e.id),onDragOver:e=>n&&e.preventDefault(),onDrop:t=>((e,t,n)=>{e.preventDefault();let r="";try{r=e.dataTransfer.getData("text/plain")}catch(a){}r&&r!==n&&d(e=>{const a=e[t]||[],i=a.indexOf(r),s=a.indexOf(n);if(-1===i||-1===s)return e;const o=a.slice(),[d]=o.splice(i,1);return o.splice(s,0,d),c(l({},e),{[t]:o})})})(t,x,e.id),children:[Nt.jsxs("div",{className:"relative flex-shrink-0",children:[n?Nt.jsx(et,{size:20,className:"text-indigo-600"}):Nt.jsx(tt,{size:20,className:"text-gray-400"}),n&&Nt.jsx("span",{className:"absolute -top-2 -right-2 text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center "+(s?"bg-indigo-600 text-white":"bg-indigo-500 text-white"),children:t+1})]}),Nt.jsxs("div",{className:"flex items-center gap-2 flex-1 text-left",children:[e.icon,Nt.jsx("span",{className:"text-sm font-medium",children:e.label})]}),n&&t>0&&Nt.jsxs("span",{onClick:t=>{var n,r;t.stopPropagation(),n=x,r=e.id,d(e=>{const t=e[n]||[],a=t.includes(r),i=t.filter(e=>e!==r),s=[r,...a?i:t];return c(l({},e),{[n]:s})})},className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded border "+(s?"border-indigo-500 text-indigo-300 hover:bg-indigo-900/40":"border-indigo-500 text-indigo-700 hover:bg-indigo-50"),title:"Make #1",children:[Nt.jsx(dt,{size:14}),"Make #1"]})]},e.id)})}),Nt.jsx("div",{className:"mt-4 p-3 rounded "+(s?"bg-gray-700":"bg-gray-100"),children:Nt.jsxs("p",{className:"text-sm text-gray-500",children:[Nt.jsx("strong",{children:b.length})," menu items selected for ",null==(n=dre.find(e=>e.id===x))?void 0:n.label]})})]})]}),u?null:Nt.jsxs("div",{className:"mt-8 rounded-lg p-6",style:{backgroundColor:s?"#1f2937":"#ffffff",border:"1px solid "+(s?"#374151":"#e5e7eb")},children:[Nt.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Page Access Control by Role"}),Nt.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Choose which roles can access each page"}),Nt.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:cre.map(e=>Nt.jsxs("div",{className:"p-4 rounded border "+(s?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"),children:[Nt.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.icon,Nt.jsx("h3",{className:"font-medium",children:e.label})]}),Nt.jsx("div",{className:"space-y-2",children:dre.map(t=>{const n=(e.allowedRoles||[]).includes(t.id);return Nt.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[Nt.jsx("input",{type:"checkbox",checked:n,onChange:e=>{},disabled:!0,className:"rounded"}),Nt.jsxs("span",{className:"text-sm "+(n?"font-medium text-indigo-600":"text-gray-600"),children:[t.label," ",n&&""]})]},t.id)})})]},e.id))}),Nt.jsxs("div",{className:"mt-4 p-3 rounded text-sm "+(s?"bg-blue-900/30 text-blue-200":"bg-blue-50 text-blue-700"),children:[Nt.jsx("strong",{children:"Note:"})," Role-based access is controlled via the menu item configuration in SidebarLayout.jsx and backend middleware. Adjust roles in the code to customize access per feature."]})]})]})})}const hre=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);h(null,null,function*(){try{const e=zc();return console.log(` Pre-flight health check to ${e}/api/health`),yield pt.get(`${e}/api/health`,{timeout:15e3}),console.log(" Backend is healthy, proceeding with app load"),!0}catch(e){return console.warn(" Pre-flight health check failed, but app will retry on demand:",e.message),!1}});const pre=hre()?6e4:3e4;pt.defaults.timeout=pre,console.log(` Axios timeout set to ${pre}ms (Mobile: ${hre()})`);const mre=pt.request;pt.request=function(e){return"GET"===e.method||"get"===e.method?((e,t=3,n=1e3)=>h(null,null,function*(){for(let a=0;a<t;a++)try{return yield pt.request(e)}catch(r){if(r.response&&r.response.status>=400&&r.response.status<500)throw r;if(!(a<t-1))throw r;{const e=n*Math.pow(2,a);console.warn(` Request failed, retrying in ${e}ms (attempt ${a+1}/${t})...`),yield new Promise(t=>setTimeout(t,e))}}}))(e,hre()?4:2,hre()?1500:1e3):mre.call(this,e)},pt.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e.timeout=pre,console.log(` ${e.method.toUpperCase()} ${e.url}`),e},e=>Promise.reject(e)),pt.interceptors.response.use(e=>(console.log(` ${e.status} ${e.config.url}`),e),e=>{var t,n,r,a,i,s,o,l,c;const d=e.message||"Unknown error",u=(null==(t=e.config)?void 0:t.url)||"unknown";return"ECONNABORTED"===e.code?console.error(` Timeout on ${null==(r=null==(n=e.config)?void 0:n.method)?void 0:r.toUpperCase()} ${u}`):"ECONNREFUSED"===e.code?console.error(` Connection refused on ${null==(i=null==(a=e.config)?void 0:a.method)?void 0:i.toUpperCase()} ${u}`):e.response?console.error(` ${e.response.status} on ${null==(o=null==(s=e.config)?void 0:s.method)?void 0:o.toUpperCase()} ${u}: ${e.response.statusText}`):console.error(` Network error on ${null==(c=null==(l=e.config)?void 0:l.method)?void 0:c.toUpperCase()} ${u}: ${d}`),Promise.reject(e)});const gre=()=>Nt.jsx("div",{className:"p-8 text-center text-gray-500",children:"404  Page Not Found"});function fre({role:e,allowedRoles:t,children:n}){const{user:r}=f.useContext($c),a=x();if(!localStorage.getItem("token"))return Nt.jsx(C,{to:"/login",replace:!0});const i=Array.isArray(t)&&t.length>0?t:e?[e]:[],s=null==r?void 0:r.role,o="admin"===(null==r?void 0:r.username),l=((null==r?void 0:r.username)||"").toLowerCase().includes("alfonso"),c="super_admin"===s,d=i.includes(s)||"supervisor_teller"===s&&(i.includes("teller")||i.includes("supervisor"))||(o||c)&&i.includes("super_admin")||(o||c)&&i.includes("admin");return!d&&l&&(a.pathname.includes("suggested-schedule")||a.pathname.includes("attendance-scheduler"))||d?n:Nt.jsx(C,{to:`/${s||""}/dashboard`,replace:!0})}function xre({children:e}){return localStorage.getItem("token")?e:Nt.jsx(C,{to:"/login",replace:!0})}function yre(){return Nt.jsx(id,{children:Nt.jsx(Wc,{children:Nt.jsx(Xc,{children:Nt.jsx(Jc,{children:Nt.jsx(j,{children:Nt.jsxs(Fc,{children:[Nt.jsx(Uc,{}),Nt.jsxs(_,{children:[Nt.jsx(A,{path:"/",element:Nt.jsx(C,{to:"/login"})}),Nt.jsx(A,{path:"/login",element:Nt.jsx(pd,{})}),Nt.jsx(A,{path:"/register",element:Nt.jsx(md,{})}),Nt.jsx(A,{path:"/mobile-debug",element:Nt.jsx(gd,{})}),Nt.jsx(A,{path:"/connectivity-test",element:Nt.jsx(fd,{})}),Nt.jsx(A,{path:"/leaderboard",element:Nt.jsx(kte,{})}),Nt.jsx(A,{path:"/upload",element:Nt.jsx(xre,{children:Nt.jsx(nd,{children:Nt.jsx(Nte,{})})})}),Nt.jsx(A,{path:"/users",element:Nt.jsx(xre,{children:Nt.jsx(nd,{children:Nt.jsx(Ate,{})})})}),Nt.jsx(A,{path:"/users/:id",element:Nt.jsx(xre,{children:Nt.jsx(nd,{children:Nt.jsx(Cte,{})})})}),Nt.jsx(A,{path:"/profile",element:Nt.jsx(xre,{children:Nt.jsx(nd,{children:Nt.jsx(Mte,{})})})}),Nt.jsx(A,{path:"/feed",element:Nt.jsx(xre,{children:Nt.jsx(nd,{children:Nt.jsx(_te,{})})})}),Nt.jsx(A,{path:"/forgot-password",element:Nt.jsx("div",{className:"text-center p-8 text-gray-700",children:"Forgot Password Page (Coming Soon)"})}),Nt.jsx(A,{path:"/admin/*",element:Nt.jsx(fre,{allowedRoles:["admin","super_admin"],children:Nt.jsx(nd,{role:"admin",children:Nt.jsxs(_,{children:[Nt.jsx(A,{index:!0,element:Nt.jsx(C,{to:"dashboard"})}),Nt.jsx(A,{path:"dashboard",element:Nt.jsx(WL,{overrideRole:"admin"})}),Nt.jsx(A,{path:"supervisor-report",element:Nt.jsx(aF,{userRole:"admin"})}),Nt.jsx(A,{path:"teller-reports",element:Nt.jsx(XL,{userRole:"admin"})}),Nt.jsx(A,{path:"teller-reports/viewer",element:Nt.jsx(qL,{userRole:"admin"})}),Nt.jsx(A,{path:"teller-management",element:Nt.jsx(iF,{userRole:"admin"})}),Nt.jsx(A,{path:"teller-salary-calculation",element:Nt.jsx(Ote,{})}),Nt.jsx(A,{path:"teller-overview",element:Nt.jsx(mF,{})}),Nt.jsx(A,{path:"report",element:Nt.jsx(oF,{})}),Nt.jsx(A,{path:"cashflow",element:Nt.jsx(hF,{})}),Nt.jsx(A,{path:"financial-summary",element:Nt.jsx(ute,{})}),Nt.jsx(A,{path:"leaderboard",element:Nt.jsx(pte,{})}),Nt.jsx(A,{path:"gta-leaderboard",element:Nt.jsx(Ete,{})}),Nt.jsx(A,{path:"betting-event-reports",element:Nt.jsx(Tte,{})}),Nt.jsx(A,{path:"workplace-schedule",element:Nt.jsx(Dte,{})}),Nt.jsx(A,{path:"gta-teller-management",element:Nt.jsx(Rte,{})}),Nt.jsx(A,{path:"gta-betting-event-report",element:Nt.jsx(Ite,{})}),Nt.jsx(A,{path:"user-approval",element:Nt.jsx(pF,{})}),Nt.jsx(A,{path:"salary",element:Nt.jsx(rF,{})}),Nt.jsx(A,{path:"payroll",element:Nt.jsx(z$,{})}),Nt.jsx(A,{path:"payroll-management",element:Nt.jsx(z$,{})}),Nt.jsx(A,{path:"payroll-fixer",element:Nt.jsx(V$,{})}),Nt.jsx(A,{path:"withdrawals",element:Nt.jsx(W$,{})}),Nt.jsx(A,{path:"assistant",element:Nt.jsx(dF,{})}),Nt.jsx(A,{path:"deployments",element:Nt.jsx(ore,{})}),Nt.jsx(A,{path:"employees",element:Nt.jsx(L$,{})}),Nt.jsx(A,{path:"history",element:Nt.jsx(D$,{})}),Nt.jsx(A,{path:"settings",element:Nt.jsx(I$,{})}),Nt.jsx(A,{path:"teller-month",element:Nt.jsx(tF,{userRole:"admin"})}),Nt.jsx(A,{path:"suggested-schedule",element:Nt.jsx(Pte,{})}),Nt.jsx(A,{path:"attendance-scheduler",element:Nt.jsx(Ute,{})}),Nt.jsx(A,{path:"menu-config",element:Nt.jsx(ure,{})}),Nt.jsx(A,{path:"manage-sidebars",element:Nt.jsx(ed,{})}),Nt.jsx(A,{path:"live-map",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"map-editor",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"teller-betting",element:Nt.jsx(mte,{})}),Nt.jsx(A,{path:"manage-betting",element:Nt.jsx(gte,{})}),Nt.jsx(A,{path:"betting-analytics",element:Nt.jsx(fte,{})}),Nt.jsx(A,{path:"teller-assignment",element:Nt.jsx(xte,{})}),Nt.jsx(A,{path:"notifications",element:Nt.jsx(yte,{})}),Nt.jsx(A,{path:"key-performance-indicator",element:Nt.jsx(bte,{})}),Nt.jsx(A,{path:"betting-event-report",element:Nt.jsx(vte,{})}),Nt.jsx(A,{path:"chicken-fight",element:Nt.jsx(zte,{})}),Nt.jsx(A,{path:"chicken-fight-entries",element:Nt.jsx(Hte,{})}),Nt.jsx(A,{path:"chicken-fight-results",element:Nt.jsx(Gte,{})}),Nt.jsx(A,{path:"live-cockfight-camera",element:Nt.jsx(Vte,{})}),Nt.jsx(A,{path:"betting-capture-screen",element:Nt.jsx($te,{})}),Nt.jsx(A,{path:"stream-broadcaster",element:Nt.jsx(fne,{})}),Nt.jsx(A,{path:"*",element:Nt.jsx(gre,{})})]})})})}),Nt.jsx(A,{path:"/supervisor/*",element:Nt.jsx(fre,{allowedRoles:["supervisor","supervisor_teller"],children:Nt.jsx(nd,{role:"supervisor",children:Nt.jsxs(_,{children:[Nt.jsx(A,{index:!0,element:Nt.jsx(C,{to:"dashboard"})}),Nt.jsx(A,{path:"dashboard",element:Nt.jsx(WL,{overrideRole:"supervisor"})}),Nt.jsx(A,{path:"supervisor-report",element:Nt.jsx(aF,{userRole:"supervisor"})}),Nt.jsx(A,{path:"teller-reports",element:Nt.jsx(XL,{userRole:"supervisor"})}),Nt.jsx(A,{path:"teller-reports/viewer",element:Nt.jsx(qL,{userRole:"supervisor"})}),Nt.jsx(A,{path:"teller-management",element:Nt.jsx(iF,{userRole:"supervisor"})}),Nt.jsx(A,{path:"teller-salary-calculation",element:Nt.jsx(Ote,{})}),Nt.jsx(A,{path:"staff-performance",element:Nt.jsx(Lte,{})}),Nt.jsx(A,{path:"payroll",element:Nt.jsx(rF,{})}),Nt.jsx(A,{path:"my-shift",element:Nt.jsx(Fte,{})}),Nt.jsx(A,{path:"teller-month",element:Nt.jsx(tF,{userRole:"supervisor"})}),Nt.jsx(A,{path:"history",element:Nt.jsx(Bte,{})}),Nt.jsx(A,{path:"settings",element:Nt.jsx(I$,{})}),Nt.jsx(A,{path:"deployments",element:Nt.jsx(ore,{viewOnly:!0})}),Nt.jsx(A,{path:"suggested-schedule",element:Nt.jsx(Pte,{})}),Nt.jsx(A,{path:"attendance-scheduler",element:Nt.jsx(Ute,{})}),Nt.jsx(A,{path:"live-map",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"map-editor",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"key-performance-indicator",element:Nt.jsx(bte,{})}),Nt.jsx(A,{path:"betting-event-report",element:Nt.jsx(vte,{})}),Nt.jsx(A,{path:"chicken-fight",element:Nt.jsx(zte,{})}),Nt.jsx(A,{path:"chicken-fight-entries",element:Nt.jsx(Hte,{})}),Nt.jsx(A,{path:"chicken-fight-results",element:Nt.jsx(Gte,{})}),Nt.jsx(A,{path:"live-cockfight-camera",element:Nt.jsx(Vte,{})}),Nt.jsx(A,{path:"betting-capture-screen",element:Nt.jsx($te,{})}),Nt.jsx(A,{path:"stream-broadcaster",element:Nt.jsx(fne,{})}),Nt.jsx(A,{path:"*",element:Nt.jsx(gre,{})})]})})})}),Nt.jsx(A,{path:"/teller/*",element:Nt.jsx(fre,{allowedRoles:["teller","supervisor_teller"],children:Nt.jsx(nd,{role:"teller",children:Nt.jsxs(_,{children:[Nt.jsx(A,{index:!0,element:Nt.jsx(C,{to:"dashboard"})}),Nt.jsx(A,{path:"dashboard",element:Nt.jsx(WL,{overrideRole:"teller"})}),Nt.jsx(A,{path:"teller-reports",element:Nt.jsx(XL,{userRole:"teller"})}),Nt.jsx(A,{path:"teller-reports/viewer",element:Nt.jsx(qL,{userRole:"teller"})}),Nt.jsx(A,{path:"reports-history",element:Nt.jsx(JL,{})}),Nt.jsx(A,{path:"payroll",element:Nt.jsx(rF,{})}),Nt.jsx(A,{path:"teller-month",element:Nt.jsx(tF,{userRole:"teller"})}),Nt.jsx(A,{path:"history",element:Nt.jsx(JL,{})}),Nt.jsx(A,{path:"settings",element:Nt.jsx(I$,{})}),Nt.jsx(A,{path:"deployments",element:Nt.jsx(lre,{})}),Nt.jsx(A,{path:"live-map",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"betting-event-report",element:Nt.jsx(vte,{})}),Nt.jsx(A,{path:"betting-capture-screen",element:Nt.jsx($te,{})}),Nt.jsx(A,{path:"stream-broadcaster",element:Nt.jsx(fne,{})}),Nt.jsx(A,{path:"suggested-schedule",element:Nt.jsx(Pte,{})}),Nt.jsx(A,{path:"*",element:Nt.jsx(gre,{})})]})})})}),Nt.jsx(A,{path:"/declarator/*",element:Nt.jsx(fre,{role:"declarator",children:Nt.jsx(nd,{role:"declarator",children:Nt.jsxs(_,{children:[Nt.jsx(A,{index:!0,element:Nt.jsx(C,{to:"deployments"})}),Nt.jsx(A,{path:"dashboard",element:Nt.jsx(C,{to:"deployments"})}),Nt.jsx(A,{path:"upload",element:Nt.jsx(Nte,{})}),Nt.jsx(A,{path:"feed",element:Nt.jsx(_te,{})}),Nt.jsx(A,{path:"users",element:Nt.jsx(Ate,{})}),Nt.jsx(A,{path:"deployments",element:Nt.jsx(ore,{})}),Nt.jsx(A,{path:"suggested-schedule",element:Nt.jsx(Pte,{})}),Nt.jsx(A,{path:"payroll",element:Nt.jsx(rF,{})}),Nt.jsx(A,{path:"live-map",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"map-editor",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"chicken-fight",element:Nt.jsx(zte,{})}),Nt.jsx(A,{path:"chicken-fight-entries",element:Nt.jsx(Hte,{})}),Nt.jsx(A,{path:"chicken-fight-results",element:Nt.jsx(Gte,{})}),Nt.jsx(A,{path:"live-cockfight-camera",element:Nt.jsx(Vte,{})}),Nt.jsx(A,{path:"betting-capture-screen",element:Nt.jsx($te,{})}),Nt.jsx(A,{path:"stream-broadcaster",element:Nt.jsx(fne,{})}),Nt.jsx(A,{path:"settings",element:Nt.jsx(I$,{})}),Nt.jsx(A,{path:"*",element:Nt.jsx(gre,{})})]})})})}),Nt.jsx(A,{path:"/super_admin/*",element:Nt.jsx(fre,{role:"super_admin",children:Nt.jsx(nd,{role:"super_admin",children:Nt.jsxs(_,{children:[Nt.jsx(A,{index:!0,element:Nt.jsx(C,{to:"dashboard"})}),Nt.jsx(A,{path:"dashboard",element:Nt.jsx(WL,{overrideRole:"super_admin"})}),Nt.jsx(A,{path:"supervisor-report",element:Nt.jsx(aF,{userRole:"super_admin"})}),Nt.jsx(A,{path:"teller-reports",element:Nt.jsx(XL,{userRole:"super_admin"})}),Nt.jsx(A,{path:"teller-reports/viewer",element:Nt.jsx(qL,{userRole:"super_admin"})}),Nt.jsx(A,{path:"teller-management",element:Nt.jsx(iF,{userRole:"super_admin"})}),Nt.jsx(A,{path:"teller-salary-calculation",element:Nt.jsx(Ote,{})}),Nt.jsx(A,{path:"teller-overview",element:Nt.jsx(mF,{})}),Nt.jsx(A,{path:"report",element:Nt.jsx(oF,{})}),Nt.jsx(A,{path:"cashflow",element:Nt.jsx(hF,{})}),Nt.jsx(A,{path:"financial-summary",element:Nt.jsx(ute,{})}),Nt.jsx(A,{path:"leaderboard",element:Nt.jsx(pte,{})}),Nt.jsx(A,{path:"gta-leaderboard",element:Nt.jsx(Ete,{})}),Nt.jsx(A,{path:"betting-event-reports",element:Nt.jsx(Tte,{})}),Nt.jsx(A,{path:"workplace-schedule",element:Nt.jsx(Dte,{})}),Nt.jsx(A,{path:"gta-teller-management",element:Nt.jsx(Rte,{})}),Nt.jsx(A,{path:"gta-betting-event-report",element:Nt.jsx(Ite,{})}),Nt.jsx(A,{path:"user-approval",element:Nt.jsx(pF,{})}),Nt.jsx(A,{path:"salary",element:Nt.jsx(rF,{})}),Nt.jsx(A,{path:"payroll",element:Nt.jsx(z$,{})}),Nt.jsx(A,{path:"payroll-management",element:Nt.jsx(z$,{})}),Nt.jsx(A,{path:"payroll-fixer",element:Nt.jsx(V$,{})}),Nt.jsx(A,{path:"withdrawals",element:Nt.jsx(W$,{})}),Nt.jsx(A,{path:"assistant",element:Nt.jsx(dF,{})}),Nt.jsx(A,{path:"deployments",element:Nt.jsx(ore,{})}),Nt.jsx(A,{path:"history",element:Nt.jsx(D$,{})}),Nt.jsx(A,{path:"settings",element:Nt.jsx(I$,{})}),Nt.jsx(A,{path:"teller-month",element:Nt.jsx(tF,{userRole:"super_admin"})}),Nt.jsx(A,{path:"suggested-schedule",element:Nt.jsx(Pte,{})}),Nt.jsx(A,{path:"attendance-scheduler",element:Nt.jsx(Ute,{})}),Nt.jsx(A,{path:"live-map",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"map-editor",element:Nt.jsx(dte,{})}),Nt.jsx(A,{path:"teller-betting",element:Nt.jsx(mte,{})}),Nt.jsx(A,{path:"manage-betting",element:Nt.jsx(gte,{})}),Nt.jsx(A,{path:"betting-analytics",element:Nt.jsx(fte,{})}),Nt.jsx(A,{path:"teller-assignment",element:Nt.jsx(xte,{})}),Nt.jsx(A,{path:"notifications",element:Nt.jsx(yte,{})}),Nt.jsx(A,{path:"betting-event-report",element:Nt.jsx(vte,{})}),Nt.jsx(A,{path:"chicken-fight",element:Nt.jsx(zte,{})}),Nt.jsx(A,{path:"chicken-fight-entries",element:Nt.jsx(Hte,{})}),Nt.jsx(A,{path:"chicken-fight-results",element:Nt.jsx(Gte,{})}),Nt.jsx(A,{path:"live-chicken-fight-dashboard",element:Nt.jsx(xne,{})}),Nt.jsx(A,{path:"live-cockfight-camera",element:Nt.jsx(Vte,{})}),Nt.jsx(A,{path:"betting-capture-screen",element:Nt.jsx($te,{})}),Nt.jsx(A,{path:"stream-broadcaster",element:Nt.jsx(fne,{})}),Nt.jsx(A,{path:"key-performance-indicator",element:Nt.jsx(bte,{})}),Nt.jsx(A,{path:"teller-mappings",element:Nt.jsx(wte,{})}),Nt.jsx(A,{path:"manage-sidebars",element:Nt.jsx(ed,{})}),Nt.jsx(A,{path:"menu-config",element:Nt.jsx(ure,{})}),Nt.jsx(A,{path:"*",element:Nt.jsx(gre,{})})]})})})}),Nt.jsx(A,{path:"/admin",element:Nt.jsx(C,{to:"/admin/dashboard"})}),Nt.jsx(A,{path:"/supervisor",element:Nt.jsx(C,{to:"/supervisor/dashboard"})}),Nt.jsx(A,{path:"/teller",element:Nt.jsx(C,{to:"/teller/dashboard"})}),Nt.jsx(A,{path:"/declarator",element:Nt.jsx(C,{to:"/declarator/deployments"})}),Nt.jsx(A,{path:"*",element:Nt.jsx(gre,{})})]})]})})})})})})}kt.createRoot(document.getElementById("root")).render(Nt.jsx(yre,{}));export{zc as g,Nt as j};
